(self.webpackChunkjifdas=self.webpackChunkjifdas||[]).push([[677],{3872:function(t,e,i){!function(t,e){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(t,e,i){return t(i={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},i.exports),i.exports}function o(t){return t&&t.default||t}var r=function(t){return t&&t.Math==Math&&t},s=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof i&&i)||Function("return this")(),a=function(t){try{return!!t()}catch(t){return!0}},l=!a(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),c={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,d={f:h&&!c.call({1:2},1)?function(t){var e=h(this,t);return!!e&&e.enumerable}:c},u=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},f={}.toString,p=function(t){return f.call(t).slice(8,-1)},g="".split,m=a(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==p(t)?g.call(t,""):Object(t)}:Object,v=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},y=function(t){return m(v(t))},b=function(t){return"object"==typeof t?null!==t:"function"==typeof t},w=function(t,e){if(!b(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!b(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!b(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!b(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},k={}.hasOwnProperty,_=function(t,e){return k.call(t,e)},x=s.document,C=b(x)&&b(x.createElement),E=function(t){return C?x.createElement(t):{}},T=!l&&!a(function(){return 7!=Object.defineProperty(E("div"),"a",{get:function(){return 7}}).a}),S=Object.getOwnPropertyDescriptor,A={f:l?S:function(t,e){if(t=y(t),e=w(e,!0),T)try{return S(t,e)}catch(t){}if(_(t,e))return u(!d.f.call(t,e),t[e])}},O=/#|\.prototype\./,I=function(t,e){var i=M[P(t)];return i==N||i!=D&&("function"==typeof e?a(e):!!e)},P=I.normalize=function(t){return String(t).replace(O,".").toLowerCase()},M=I.data={},D=I.NATIVE="N",N=I.POLYFILL="P",R=I,z={},F=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},L=function(t,e,i){if(F(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}},B=function(t){if(!b(t))throw TypeError(String(t)+" is not an object");return t},j=Object.defineProperty,V={f:l?j:function(t,e,i){if(B(t),e=w(e,!0),B(i),T)try{return j(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},H=l?function(t,e,i){return V.f(t,e,u(1,i))}:function(t,e,i){return t[e]=i,t},W=A.f,q=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},U=function(t,e){var i,n,o,r,a,l,c,h,d=t.target,u=t.global,f=t.stat,p=t.proto,g=u?s:f?s[d]:(s[d]||{}).prototype,m=u?z:z[d]||(z[d]={}),v=m.prototype;for(o in e)i=!R(u?o:d+(f?".":"#")+o,t.forced)&&g&&_(g,o),a=m[o],i&&(l=t.noTargetGet?(h=W(g,o))&&h.value:g[o]),r=i&&l?l:e[o],i&&typeof a==typeof r||(c=t.bind&&i?L(r,s):t.wrap&&i?q(r):p&&"function"==typeof r?L(Function.call,r):r,(t.sham||r&&r.sham||a&&a.sham)&&H(c,"sham",!0),m[o]=c,p&&(_(z,n=d+"Prototype")||H(z,n,{}),z[n][o]=r,t.real&&v&&!v[o]&&H(v,o,r)))},Y=[].slice,G={},Z=function(t,e,i){if(!(e in G)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";G[e]=Function("C,a","return new C("+n.join(",")+")")}return G[e](t,i)},$=Function.bind||function(t){var e=F(this),i=Y.call(arguments,1),n=function(){var o=i.concat(Y.call(arguments));return this instanceof n?Z(e,o.length,o):e.apply(t,o)};return b(e.prototype)&&(n.prototype=e.prototype),n};U({target:"Function",proto:!0},{bind:$});var X=function(t){return z[t+"Prototype"]},K=X("Function").bind,Q=Function.prototype,J=function(t){var e=t.bind;return t===Q||t instanceof Function&&e===Q.bind?K:e},tt=Math.ceil,et=Math.floor,it=function(t){return isNaN(t=+t)?0:(t>0?et:tt)(t)},nt=Math.min,ot=function(t){return t>0?nt(it(t),9007199254740991):0},rt=Math.max,st=Math.min,at=function(t,e){var i=it(t);return i<0?rt(i+e,0):st(i,e)},lt=function(t){return function(e,i,n){var o,r=y(e),s=ot(r.length),a=at(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},ct={includes:lt(!0),indexOf:lt(!1)},ht={},dt=ct.indexOf,ut=function(t,e){var i,n=y(t),o=0,r=[];for(i in n)!_(ht,i)&&_(n,i)&&r.push(i);for(;e.length>o;)_(n,i=e[o++])&&(~dt(r,i)||r.push(i));return r},ft=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],pt=Object.keys||function(t){return ut(t,ft)},gt={f:Object.getOwnPropertySymbols},mt=function(t){return Object(v(t))},vt=Object.assign,yt=Object.defineProperty,bt=!vt||a(function(){if(l&&1!==vt({b:1},vt(yt({},"a",{enumerable:!0,get:function(){yt(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol();return t[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=vt({},t)[i]||"abcdefghijklmnopqrst"!=pt(vt({},e)).join("")})?function(t,e){for(var i=mt(t),n=arguments.length,o=1,r=gt.f,s=d.f;n>o;)for(var a,c=m(arguments[o++]),h=r?pt(c).concat(r(c)):pt(c),u=h.length,f=0;u>f;)a=h[f++],l&&!s.call(c,a)||(i[a]=c[a]);return i}:vt;U({target:"Object",stat:!0,forced:Object.assign!==bt},{assign:bt});var wt=z.Object.assign;function kt(t,e,i,n){t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!1),t.closePath()}function _t(t,e,i,n,o,r){var s=Math.PI/180;n-2*r<0&&(r=n/2),o-2*r<0&&(r=o/2),t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.arc(e+n-r,i+r,r,270*s,360*s,!1),t.lineTo(e+n,i+o-r),t.arc(e+n-r,i+o-r,r,0,90*s,!1),t.lineTo(e+r,i+o),t.arc(e+r,i+o-r,r,90*s,180*s,!1),t.lineTo(e,i+r),t.arc(e+r,i+r,r,180*s,270*s,!1),t.closePath()}function xt(t,e,i,n,o){var r=n/2*.5522848,s=o/2*.5522848,a=e+n,l=i+o,c=e+n/2,h=i+o/2;t.beginPath(),t.moveTo(e,h),t.bezierCurveTo(e,h-s,c-r,i,c,i),t.bezierCurveTo(c+r,i,a,h-s,a,h),t.bezierCurveTo(a,h+s,c+r,l,c,l),t.bezierCurveTo(c-r,l,e,h+s,e,h),t.closePath()}function Ct(t,e,i,n,o){var r=o*(1/3),s=n/2*.5522848,a=r/2*.5522848,l=e+n,c=i+r,h=e+n/2,d=i+r/2,u=i+(o-r/2),f=i+o;t.beginPath(),t.moveTo(l,d),t.bezierCurveTo(l,d+a,h+s,c,h,c),t.bezierCurveTo(h-s,c,e,d+a,e,d),t.bezierCurveTo(e,d-a,h-s,i,h,i),t.bezierCurveTo(h+s,i,l,d-a,l,d),t.lineTo(l,u),t.bezierCurveTo(l,u+a,h+s,f,h,f),t.bezierCurveTo(h-s,f,e,u+a,e,u),t.lineTo(e,d)}function Et(t,e,i,n,o,r){t.beginPath(),t.moveTo(e,i);for(var s=r.length,a=n-e,l=o-i,c=l/a,h=Math.sqrt(a*a+l*l),d=0,u=!0,f=0,p=+r[0];h>=.1;)(p=+r[d++%s])>h&&(p=h),f=Math.sqrt(p*p/(1+c*c)),e+=f=a<0?-f:f,i+=c*f,!0===u?t.lineTo(e,i):t.moveTo(e,i),h-=p,u=!u}var Tt={circle:kt,dashedLine:Et,database:Ct,diamond:function(t,e,i,n){t.beginPath(),t.lineTo(e,i+n),t.lineTo(e+n,i),t.lineTo(e,i-n),t.lineTo(e-n,i),t.closePath()},ellipse:xt,ellipse_vis:xt,hexagon:function(t,e,i,n){t.beginPath();var o=2*Math.PI/6;t.moveTo(e+n,i);for(var r=1;r<6;r++)t.lineTo(e+n*Math.cos(o*r),i+n*Math.sin(o*r));t.closePath()},roundRect:_t,square:function(t,e,i,n){t.beginPath(),t.rect(e-n,i-n,2*n,2*n),t.closePath()},star:function(t,e,i,n){t.beginPath(),i+=.1*(n*=.82);for(var o=0;o<10;o++){var r=o%2==0?1.3*n:.5*n;t.lineTo(e+r*Math.sin(2*o*Math.PI/10),i-r*Math.cos(2*o*Math.PI/10))}t.closePath()},triangle:function(t,e,i,n){t.beginPath(),i+=.275*(n*=1.15);var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i-(a-s)),t.lineTo(e+r,i+s),t.lineTo(e-r,i+s),t.lineTo(e,i-(a-s)),t.closePath()},triangleDown:function(t,e,i,n){t.beginPath(),i-=.275*(n*=1.15);var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i+(a-s)),t.lineTo(e+r,i-s),t.lineTo(e-r,i-s),t.lineTo(e,i+(a-s)),t.closePath()}},St=n(function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}});U({target:"Object",stat:!0,forced:!l,sham:!l},{defineProperty:V.f});var At=n(function(t){var e=z.Object,i=t.exports=function(t,i,n){return e.defineProperty(t,i,n)};e.defineProperty.sham&&(i.sham=!0)}),Ot=At,It=l?Object.defineProperties:function(t,e){B(t);for(var i,n=pt(e),o=n.length,r=0;o>r;)V.f(t,i=n[r++],e[i]);return t};U({target:"Object",stat:!0,forced:!l,sham:!l},{defineProperties:It});var Pt=n(function(t){var e=z.Object,i=t.exports=function(t,i){return e.defineProperties(t,i)};e.defineProperties.sham&&(i.sham=!0)}),Mt=function(t){return"function"==typeof t?t:void 0},Dt=function(t,e){return arguments.length<2?Mt(z[t])||Mt(s[t]):z[t]&&z[t][e]||s[t]&&s[t][e]},Nt=ft.concat("length","prototype"),Rt={f:Object.getOwnPropertyNames||function(t){return ut(t,Nt)}},zt=Dt("Reflect","ownKeys")||function(t){var e=Rt.f(B(t)),i=gt.f;return i?e.concat(i(t)):e},Ft=function(t,e,i){var n=w(e);n in t?V.f(t,n,u(0,i)):t[n]=i};U({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(t){for(var e,i,n=y(t),o=A.f,r=zt(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&Ft(s,e,i);return s}});var Lt=z.Object.getOwnPropertyDescriptors,Bt=A.f,jt=a(function(){Bt(1)});U({target:"Object",stat:!0,forced:!l||jt,sham:!l},{getOwnPropertyDescriptor:function(t,e){return Bt(y(t),e)}});var Vt,Ht=n(function(t){var e=z.Object,i=t.exports=function(t,i){return e.getOwnPropertyDescriptor(t,i)};e.getOwnPropertyDescriptor.sham&&(i.sham=!0)}),Wt=Ht,qt=!!Object.getOwnPropertySymbols&&!a(function(){return!String(Symbol())}),Ut=qt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Yt=Array.isArray||function(t){return"Array"==p(t)},Gt=Dt("document","documentElement"),Zt=s["__core-js_shared__"]||function(t,e){try{H(s,t,e)}catch(i){s[t]=e}return e}("__core-js_shared__",{}),$t=n(function(t){(t.exports=function(t,e){return Zt[t]||(Zt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.4",mode:"pure",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})}),Xt=0,Kt=Math.random(),Qt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++Xt+Kt).toString(36)},Jt=$t("keys"),te=function(t){return Jt[t]||(Jt[t]=Qt(t))},ee=te("IE_PROTO"),ie=function(){},ne=function(t){return"<script>"+t+"<\/script>"},oe=function(){try{Vt=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;oe=Vt?function(t){t.write(ne("")),t.close();var e=t.parentWindow.Object;return t=null,e}(Vt):((e=E("iframe")).style.display="none",Gt.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ne("document.F=Object")),t.close(),t.F);for(var i=ft.length;i--;)delete oe.prototype[ft[i]];return oe()};ht[ee]=!0;var re=Object.create||function(t,e){var i;return null!==t?(ie.prototype=B(t),i=new ie,ie.prototype=null,i[ee]=t):i=oe(),void 0===e?i:It(i,e)},se=Rt.f,ae={}.toString,le="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],ce={f:function(t){return le&&"[object Window]"==ae.call(t)?function(t){try{return se(t)}catch(t){return le.slice()}}(t):se(y(t))}},he=function(t,e,i,n){n&&n.enumerable?t[e]=i:H(t,e,i)},de=$t("wks"),ue=s.Symbol,fe=Ut?ue:ue&&ue.withoutSetter||Qt,pe=function(t){return _(de,t)||(de[t]=qt&&_(ue,t)?ue[t]:fe("Symbol."+t)),de[t]},ge={f:pe},me=V.f,ve=function(t){var e=z.Symbol||(z.Symbol={});_(e,t)||me(e,t,{value:ge.f(t)})},ye={};ye[pe("toStringTag")]="z";var be="[object z]"===String(ye),we=pe("toStringTag"),ke="Arguments"==p(function(){return arguments}()),_e=be?p:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),we))?i:ke?p(e):"Object"==(n=p(e))&&"function"==typeof e.callee?"Arguments":n},xe=be?{}.toString:function(){return"[object "+_e(this)+"]"},Ce=V.f,Ee=pe("toStringTag"),Te=function(t,e,i,n){if(t){var o=i?t:t.prototype;_(o,Ee)||Ce(o,Ee,{configurable:!0,value:e}),n&&!be&&H(o,"toString",xe)}},Se=Function.toString;"function"!=typeof Zt.inspectSource&&(Zt.inspectSource=function(t){return Se.call(t)});var Ae,Oe,Ie,Pe=s.WeakMap;if("function"==typeof Pe&&/native code/.test((0,Zt.inspectSource)(Pe))){var Me=new(0,s.WeakMap),De=Me.get,Ne=Me.has,Re=Me.set;Ae=function(t,e){return Re.call(Me,t,e),e},Oe=function(t){return De.call(Me,t)||{}},Ie=function(t){return Ne.call(Me,t)}}else{var ze=te("state");ht[ze]=!0,Ae=function(t,e){return H(t,ze,e),e},Oe=function(t){return _(t,ze)?t[ze]:{}},Ie=function(t){return _(t,ze)}}var Fe={set:Ae,get:Oe,has:Ie,enforce:function(t){return Ie(t)?Oe(t):Ae(t,{})},getterFor:function(t){return function(e){var i;if(!b(e)||(i=Oe(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},Le=pe("species"),Be=function(t,e){var i;return Yt(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!Yt(i.prototype)?b(i)&&null===(i=i[Le])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)},je=[].push,Ve=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,r=6==t,s=5==t||r;return function(a,l,c,h){for(var d,u,f=mt(a),p=m(f),g=L(l,c,3),v=ot(p.length),y=0,b=h||Be,w=e?b(a,v):i?b(a,0):void 0;v>y;y++)if((s||y in p)&&(u=g(d=p[y],y,f),t))if(e)w[y]=u;else if(u)switch(t){case 3:return!0;case 5:return d;case 6:return y;case 2:je.call(w,d)}else if(o)return!1;return r?-1:n||o?o:w}},He={forEach:Ve(0),map:Ve(1),filter:Ve(2),some:Ve(3),every:Ve(4),find:Ve(5),findIndex:Ve(6)},We=He.forEach,qe=te("hidden"),Ue=pe("toPrimitive"),Ye=Fe.set,Ge=Fe.getterFor("Symbol"),Ze=Object.prototype,$e=s.Symbol,Xe=Dt("JSON","stringify"),Ke=A.f,Qe=V.f,Je=ce.f,ti=d.f,ei=$t("symbols"),ii=$t("op-symbols"),ni=$t("string-to-symbol-registry"),oi=$t("symbol-to-string-registry"),ri=$t("wks"),si=s.QObject,ai=!si||!si.prototype||!si.prototype.findChild,li=l&&a(function(){return 7!=re(Qe({},"a",{get:function(){return Qe(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=Ke(Ze,e);n&&delete Ze[e],Qe(t,e,i),n&&t!==Ze&&Qe(Ze,e,n)}:Qe,ci=function(t,e){var i=ei[t]=re($e.prototype);return Ye(i,{type:"Symbol",tag:t,description:e}),l||(i.description=e),i},hi=Ut?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof $e},di=function(t,e,i){t===Ze&&di(ii,e,i),B(t);var n=w(e,!0);return B(i),_(ei,n)?(i.enumerable?(_(t,qe)&&t[qe][n]&&(t[qe][n]=!1),i=re(i,{enumerable:u(0,!1)})):(_(t,qe)||Qe(t,qe,u(1,{})),t[qe][n]=!0),li(t,n,i)):Qe(t,n,i)},ui=function(t,e){B(t);var i=y(e),n=pt(i).concat(mi(i));return We(n,function(e){l&&!fi.call(i,e)||di(t,e,i[e])}),t},fi=function(t){var e=w(t,!0),i=ti.call(this,e);return!(this===Ze&&_(ei,e)&&!_(ii,e))&&(!(i||!_(this,e)||!_(ei,e)||_(this,qe)&&this[qe][e])||i)},pi=function(t,e){var i=y(t),n=w(e,!0);if(i!==Ze||!_(ei,n)||_(ii,n)){var o=Ke(i,n);return!o||!_(ei,n)||_(i,qe)&&i[qe][n]||(o.enumerable=!0),o}},gi=function(t){var e=Je(y(t)),i=[];return We(e,function(t){_(ei,t)||_(ht,t)||i.push(t)}),i},mi=function(t){var e=t===Ze,i=Je(e?ii:y(t)),n=[];return We(i,function(t){!_(ei,t)||e&&!_(Ze,t)||n.push(ei[t])}),n};if(qt||(he(($e=function(){if(this instanceof $e)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=Qt(t),i=function(t){this===Ze&&i.call(ii,t),_(this,qe)&&_(this[qe],e)&&(this[qe][e]=!1),li(this,e,u(1,t))};return l&&ai&&li(Ze,e,{configurable:!0,set:i}),ci(e,t)}).prototype,"toString",function(){return Ge(this).tag}),he($e,"withoutSetter",function(t){return ci(Qt(t),t)}),d.f=fi,V.f=di,A.f=pi,Rt.f=ce.f=gi,gt.f=mi,ge.f=function(t){return ci(pe(t),t)},l&&Qe($e.prototype,"description",{configurable:!0,get:function(){return Ge(this).description}})),U({global:!0,wrap:!0,forced:!qt,sham:!qt},{Symbol:$e}),We(pt(ri),function(t){ve(t)}),U({target:"Symbol",stat:!0,forced:!qt},{for:function(t){var e=String(t);if(_(ni,e))return ni[e];var i=$e(e);return ni[e]=i,oi[i]=e,i},keyFor:function(t){if(!hi(t))throw TypeError(t+" is not a symbol");if(_(oi,t))return oi[t]},useSetter:function(){ai=!0},useSimple:function(){ai=!1}}),U({target:"Object",stat:!0,forced:!qt,sham:!l},{create:function(t,e){return void 0===e?re(t):ui(re(t),e)},defineProperty:di,defineProperties:ui,getOwnPropertyDescriptor:pi}),U({target:"Object",stat:!0,forced:!qt},{getOwnPropertyNames:gi,getOwnPropertySymbols:mi}),U({target:"Object",stat:!0,forced:a(function(){gt.f(1)})},{getOwnPropertySymbols:function(t){return gt.f(mt(t))}}),Xe){var vi=!qt||a(function(){var t=$e();return"[null]"!=Xe([t])||"{}"!=Xe({a:t})||"{}"!=Xe(Object(t))});U({target:"JSON",stat:!0,forced:vi},{stringify:function(t,e,i){for(var n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e,(b(e)||void 0!==t)&&!hi(t))return Yt(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!hi(e))return e}),o[1]=e,Xe.apply(null,o)}})}$e.prototype[Ue]||H($e.prototype,Ue,$e.prototype.valueOf),Te($e,"Symbol"),ht[qe]=!0;var yi,bi,wi,ki=z.Object.getOwnPropertySymbols,_i={},xi=!a(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Ci=te("IE_PROTO"),Ei=Object.prototype,Ti=xi?Object.getPrototypeOf:function(t){return t=mt(t),_(t,Ci)?t[Ci]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Ei:null},Si=(pe("iterator"),!1);[].keys&&("next"in(wi=[].keys())?(bi=Ti(Ti(wi)))!==Object.prototype&&(yi=bi):Si=!0),null==yi&&(yi={});var Ai={IteratorPrototype:yi,BUGGY_SAFARI_ITERATORS:Si},Oi=Ai.IteratorPrototype,Ii=function(){return this},Pi=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return B(i),function(t){if(!b(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0),Mi=Ai.IteratorPrototype,Di=Ai.BUGGY_SAFARI_ITERATORS,Ni=pe("iterator"),Ri=function(){return this},zi=function(t,e,i,n,o,r,s){!function(t,e,i){var n=e+" Iterator";t.prototype=re(Oi,{next:u(1,i)}),Te(t,n,!1,!0),_i[n]=Ii}(i,e,n);var a,l,c,h=function(t){if(t===o&&m)return m;if(!Di&&t in p)return p[t];switch(t){case"keys":case"values":case"entries":return function(){return new i(this,t)}}return function(){return new i(this)}},d=e+" Iterator",f=!1,p=t.prototype,g=p[Ni]||p["@@iterator"]||o&&p[o],m=!Di&&g||h(o),v="Array"==e&&p.entries||g;if(v&&(a=Ti(v.call(new t)),Mi!==Object.prototype&&a.next&&(Te(a,d,!0,!0),_i[d]=Ri)),"values"==o&&g&&"values"!==g.name&&(f=!0,m=function(){return g.call(this)}),s&&p[Ni]!==m&&H(p,Ni,m),_i[e]=m,o)if(l={values:h("values"),keys:r?m:h("keys"),entries:h("entries")},s)for(c in l)(Di||f||!(c in p))&&he(p,c,l[c]);else U({target:e,proto:!0,forced:Di||f},l);return l},Fi=Fe.set,Li=Fe.getterFor("Array Iterator");zi(Array,"Array",function(t,e){Fi(this,{type:"Array Iterator",target:y(t),index:0,kind:e})},function(){var t=Li(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),_i.Arguments=_i.Array;var Bi=pe("toStringTag");for(var ji in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Vi=s[ji],Hi=Vi&&Vi.prototype;Hi&&_e(Hi)!==Bi&&H(Hi,Bi,ji),_i[ji]=_i.Array}var Wi=function(t){return function(e,i){var n,o,r=String(v(e)),s=it(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):n:t?r.slice(s,s+2):o-56320+(n-55296<<10)+65536}},qi=(Wi(!1),Wi(!0)),Ui=Fe.set,Yi=Fe.getterFor("String Iterator");zi(String,"String",function(t){Ui(this,{type:"String Iterator",string:String(t),index:0})},function(){var t,e=Yi(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=qi(i,n),e.index+=t.length,{value:t,done:!1})});var Gi=pe("iterator"),Zi=function(t){if(null!=t)return t[Gi]||t["@@iterator"]||_i[_e(t)]},$i=function(t){var e=Zi(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return B(e.call(t))},Xi=Zi,Ki=function(t,e,i,n){try{return n?e(B(i)[0],i[1]):e(i)}catch(e){var o=t.return;throw void 0!==o&&B(o.call(t)),e}},Qi=pe("iterator"),Ji=Array.prototype,tn=function(t){return void 0!==t&&(_i.Array===t||Ji[Qi]===t)},en=pe("iterator"),nn=!1;try{var on=0,rn={next:function(){return{done:!!on++}},return:function(){nn=!0}};rn[en]=function(){return this},Array.from(rn,function(){throw 2})}catch(t){}var sn=!function(t,e){if(!nn)return!1;var i=!1;try{var n={};n[en]=function(){return{next:function(){return{done:i=!0}}}},function(t){Array.from(t)}(n)}catch(t){}return i}();U({target:"Array",stat:!0,forced:sn},{from:function(t){var e,i,n,o,r,s,a=mt(t),l="function"==typeof this?this:Array,c=arguments.length,h=c>1?arguments[1]:void 0,d=void 0!==h,u=Zi(a),f=0;if(d&&(h=L(h,c>2?arguments[2]:void 0,2)),null==u||l==Array&&tn(u))for(i=new l(e=ot(a.length));e>f;f++)s=d?h(a[f],f):a[f],Ft(i,f,s);else for(r=(o=u.call(a)).next,i=new l;!(n=r.call(o)).done;f++)s=d?Ki(o,h,[n.value,f],!0):n.value,Ft(i,f,s);return i.length=f,i}});var an=z.Array.from,ln=an;U({target:"Object",stat:!0,sham:!l},{create:re});var cn,hn=z.Object,dn=function(t,e){return hn.create(t,e)},un=dn,fn=At,pn=function(t,e,i){return e in t?fn(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},gn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",mn="["+gn+"]",vn=RegExp("^"+mn+mn+"*"),yn=RegExp(mn+mn+"*$"),bn=function(t){return function(e){var i=String(v(e));return 1&t&&(i=i.replace(vn,"")),2&t&&(i=i.replace(yn,"")),i}},wn={start:bn(1),end:bn(2),trim:bn(3)},kn=wn.trim;U({target:"String",proto:!0,forced:(cn="trim",a(function(){return!!gn[cn]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[cn]()||gn[cn].name!==cn}))},{trim:function(){return kn(this)}}),X("String");var _n=function(t,e){var i=[][t];return!!i&&a(function(){i.call(null,e||function(){throw 1},1)})},xn=Object.defineProperty,Cn={},En=function(t){throw t},Tn=function(t,e){if(_(Cn,t))return Cn[t];e||(e={});var i=[][t],n=!!_(e,"ACCESSORS")&&e.ACCESSORS,o=_(e,0)?e[0]:En,r=_(e,1)?e[1]:void 0;return Cn[t]=!!i&&!a(function(){if(n&&!l)return!0;var t={length:-1};n?xn(t,1,{enumerable:!0,get:En}):t[1]=1,i.call(t,o,r)})},Sn=He.forEach,An=_n("forEach"),On=Tn("forEach"),In=An&&On?[].forEach:function(t){return Sn(this,t,arguments.length>1?arguments[1]:void 0)};U({target:"Array",proto:!0,forced:[].forEach!=In},{forEach:In});var Pn=X("Array").forEach,Mn=Array.prototype,Dn={DOMTokenList:!0,NodeList:!0},Nn=function(t){var e=t.forEach;return t===Mn||t instanceof Array&&e===Mn.forEach||Dn.hasOwnProperty(_e(t))?Pn:e},Rn=wn.trim,zn=s.parseInt,Fn=/^[+-]?0[Xx]/,Ln=8!==zn(gn+"08")||22!==zn(gn+"0x16")?function(t,e){var i=Rn(String(t));return zn(i,e>>>0||(Fn.test(i)?16:10))}:zn;U({global:!0,forced:parseInt!=Ln},{parseInt:Ln});var Bn=z.parseInt,jn=d.f,Vn=function(t){return function(e){for(var i,n=y(e),o=pt(n),r=o.length,s=0,a=[];r>s;)i=o[s++],l&&!jn.call(n,i)||a.push(t?[i,n[i]]:n[i]);return a}},Hn=(Vn(!0),Vn(!1));U({target:"Object",stat:!0},{values:function(t){return Hn(t)}});var Wn,qn,Un=Dt("navigator","userAgent")||"",Yn=s.process,Gn=Yn&&Yn.versions,Zn=Gn&&Gn.v8;Zn?qn=(Wn=Zn.split("."))[0]+Wn[1]:Un&&(!(Wn=Un.match(/Edge\/(\d+)/))||Wn[1]>=74)&&(Wn=Un.match(/Chrome\/(\d+)/))&&(qn=Wn[1]);var $n=qn&&+qn,Xn=pe("species"),Kn=function(t){return $n>=51||!a(function(){var e=[];return(e.constructor={})[Xn]=function(){return{foo:1}},1!==e[t](Boolean).foo})},Qn=He.filter,Jn=Kn("filter"),to=Tn("filter");U({target:"Array",proto:!0,forced:!Jn||!to},{filter:function(t){return Qn(this,t,arguments.length>1?arguments[1]:void 0)}});var eo=X("Array").filter,io=Array.prototype,no=function(t){var e=t.filter;return t===io||t instanceof Array&&e===io.filter?eo:e},oo=a(function(){Ti(1)});U({target:"Object",stat:!0,forced:oo,sham:!xi},{getPrototypeOf:function(t){return Ti(mt(t))}});var ro=z.Object.getPrototypeOf,so=ro,ao=ct.indexOf,lo=[].indexOf,co=!!lo&&1/[1].indexOf(1,-0)<0,ho=_n("indexOf"),uo=Tn("indexOf",{ACCESSORS:!0,1:0});U({target:"Array",proto:!0,forced:co||!ho||!uo},{indexOf:function(t){return co?lo.apply(this,arguments)||0:ao(this,t,arguments.length>1?arguments[1]:void 0)}});var fo=X("Array").indexOf,po=Array.prototype,go=function(t){var e=t.indexOf;return t===po||t instanceof Array&&e===po.indexOf?fo:e};U({target:"Array",stat:!0},{isArray:Yt});var mo=z.Array.isArray,vo=mo,yo=pe("iterator"),bo=function(t){var e=Object(t);return void 0!==e[yo]||"@@iterator"in e||_i.hasOwnProperty(_e(e))},wo=pe("isConcatSpreadable"),ko=$n>=51||!a(function(){var t=[];return t[wo]=!1,t.concat()[0]!==t}),_o=Kn("concat"),xo=function(t){if(!b(t))return!1;var e=t[wo];return void 0!==e?!!e:Yt(t)};U({target:"Array",proto:!0,forced:!ko||!_o},{concat:function(t){var e,i,n,o,r,s=mt(this),a=Be(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(xo(r=-1===e?s:arguments[e])){if(l+(o=ot(r.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(i=0;i<o;i++,l++)i in r&&Ft(a,l,r[i])}else{if(l>=9007199254740991)throw TypeError("Maximum allowed index exceeded");Ft(a,l++,r)}return a.length=l,a}});var Co=Object.freeze({__proto__:null});ve("asyncIterator");var Eo=Object.freeze({__proto__:null});ve("hasInstance"),ve("isConcatSpreadable"),ve("iterator"),ve("match"),ve("matchAll"),ve("replace"),ve("search"),ve("species"),ve("split"),ve("toPrimitive"),ve("toStringTag"),ve("unscopables"),Te(Math,"Math",!0),Te(s.JSON,"JSON",!0),o(Co),o(Eo);var To=z.Symbol;ve("asyncDispose"),ve("dispose"),ve("observable"),ve("patternMatch"),ve("replaceAll");var So=To,Ao=an,Oo=Kn("slice"),Io=Tn("slice",{ACCESSORS:!0,0:0,1:2}),Po=pe("species"),Mo=[].slice,Do=Math.max;U({target:"Array",proto:!0,forced:!Oo||!Io},{slice:function(t,e){var i,n,o,r=y(this),s=ot(r.length),a=at(t,s),l=at(void 0===e?s:e,s);if(Yt(r)&&("function"!=typeof(i=r.constructor)||i!==Array&&!Yt(i.prototype)?b(i)&&null===(i=i[Po])&&(i=void 0):i=void 0,i===Array||void 0===i))return Mo.call(r,a,l);for(n=new(void 0===i?Array:i)(Do(l-a,0)),o=0;a<l;a++,o++)a in r&&Ft(n,o,r[a]);return n.length=o,n}});var No=X("Array").slice,Ro=Array.prototype,zo=function(t){var e=t.slice;return t===Ro||t instanceof Array&&e===Ro.slice?No:e},Fo=zo,Lo=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},Bo=function(t,e){var i;if(t){if("string"==typeof t)return Lo(t,e);var n=Fo(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Ao(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Lo(t,e):void 0}},jo=function(t,e){return function(t){if(vo(t))return t}(t)||function(t,e){if(void 0!==So&&bo(Object(t))){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=$i(t);!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return i}}(t,e)||Bo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()};U({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Vo=z.Date.now,Ho=a(function(){pt(1)});U({target:"Object",stat:!0,forced:Ho},{keys:function(t){return pt(mt(t))}});var Wo=z.Object.keys,qo=He.map,Uo=Kn("map"),Yo=Tn("map");U({target:"Array",proto:!0,forced:!Uo||!Yo},{map:function(t){return qo(this,t,arguments.length>1?arguments[1]:void 0)}});var Go=X("Array").map,Zo=Array.prototype,$o=function(t){var e=t.map;return t===Zo||t instanceof Array&&e===Zo.map?Go:e},Xo=mo,Ko=ge.f("iterator"),Qo=n(function(t){function e(i){return t.exports=e="function"==typeof So&&"symbol"==typeof Ko?function(t){return typeof t}:function(t){return t&&"function"==typeof So&&t.constructor===So&&t!==So.prototype?"symbol":typeof t},e(i)}t.exports=e});U({target:"Reflect",stat:!0},{ownKeys:zt});var Jo=zo,tr=X("Array").concat,er=Array.prototype,ir=function(t){var e=t.concat;return t===er||t instanceof Array&&e===er.concat?tr:e},nr=To;function or(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function rr(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return sr(e.length?e:[Vo()])}function sr(t){var e=function(){for(var t=ar(),e=t(" "),i=t(" "),n=t(" "),o=0;o<arguments.length;o++)(e-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(e+=1),(i-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(i+=1),(n-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(n+=1);return[e,i,n]}(t),i=jo(e,3),n=i[0],o=i[1],r=i[2],s=1,a=function(){var t=2091639*n+2.3283064365386963e-10*s;return n=o,o=r,r=t-(s=0|t)};return a.uint32=function(){return 4294967296*a()},a.fract53=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.algorithm="Alea",a.seed=t,a.version="0.9",a}function ar(){var t=4022871197;return function(e){for(var i=e.toString(),n=0;n<i.length;n++){var o=.02519603282416938*(t+=i.charCodeAt(n));o-=t=o>>>0,t=(o*=t)>>>0,t+=4294967296*(o-=t)}return 2.3283064365386963e-10*(t>>>0)}}nr("DELETE");var lr=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,cr=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,hr=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,dr=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function ur(t){if(t)for(;!0===t.hasChildNodes();){var e=t.firstChild;e&&(ur(e),t.removeChild(e))}}function fr(t){return t instanceof String||"string"==typeof t}function pr(t){return"object"===Qo(t)&&null!==t}function gr(t,e,i,n){var o=!1;!0===n&&(o=null===e[i]&&void 0!==t[i]),o?delete t[i]:t[i]=e[i]}function mr(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in t)if(void 0!==e[n])if(null===e[n]||"object"!==Qo(e[n]))gr(t,e,n,i);else{var o=t[n],r=e[n];pr(o)&&pr(r)&&mr(o,r,i)}}function vr(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Xo(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o=0;o<t.length;o++){var r=t[o];if(Object.prototype.hasOwnProperty.call(i,r))if(i[r]&&i[r].constructor===Object)void 0===e[r]&&(e[r]={}),e[r].constructor===Object?br(e[r],i[r],!1,n):gr(e,i,r,n);else{if(Xo(i[r]))throw new TypeError("Arrays are not supported by deepExtend");gr(e,i,r,n)}}return e}function yr(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Xo(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)&&-1===go(t).call(t,o))if(i[o]&&i[o].constructor===Object)void 0===e[o]&&(e[o]={}),e[o].constructor===Object?br(e[o],i[o]):gr(e,i,o,n);else if(Xo(i[o])){e[o]=[];for(var r=0;r<i[o].length;r++)e[o].push(i[o][r])}else gr(e,i,o,n);return e}function br(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)||!0===i)if("object"===Qo(e[o])&&null!==e[o]&&so(e[o])===Object.prototype)void 0===t[o]?t[o]=br({},e[o],i):"object"===Qo(t[o])&&null!==t[o]&&so(t[o])===Object.prototype?br(t[o],e[o],i):gr(t,e,o,n);else if(Xo(e[o])){var r;t[o]=Jo(r=e[o]).call(r)}else gr(t,e,o,n);return t}function wr(t,e){var i;return ir(i=[]).call(i,function(t){return function(t){if(vo(t))return Lo(t)}(t)||function(t){if(void 0!==So&&bo(Object(t)))return Ao(t)}(t)||Bo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t),[e])}function kr(t){return Jo(t).call(t)}function _r(t){return t.getBoundingClientRect().top}function xr(t,e){if(Xo(t))for(var i=t.length,n=0;n<i;n++)e(t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e(t[o],o,t)}function Cr(t){var e;switch(t.length){case 3:case 4:return(e=cr.exec(t))?{r:Bn(e[1]+e[1],16),g:Bn(e[2]+e[2],16),b:Bn(e[3]+e[3],16)}:null;case 6:case 7:return(e=lr.exec(t))?{r:Bn(e[1],16),g:Bn(e[2],16),b:Bn(e[3],16)}:null;default:return null}}function Er(t,e){if(-1!==go(t).call(t,"rgba"))return t;if(-1!==go(t).call(t,"rgb")){var i=t.substr(go(t).call(t,"(")+1).replace(")","").split(",");return"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"}var n=Cr(t);return null==n?t:"rgba("+n.r+","+n.g+","+n.b+","+e+")"}function Tr(t,e,i){var n;return"#"+Jo(n=((1<<24)+(t<<16)+(e<<8)+i).toString(16)).call(n,1)}function Sr(t,e){if(fr(t)){var i=t;if(Mr(i)){var n,o=$o(n=i.substr(4).substr(0,i.length-5).split(",")).call(n,function(t){return Bn(t)});i=Tr(o[0],o[1],o[2])}if(!0===Pr(i)){var r=function(t){var e=Cr(t);if(!e)throw new TypeError("'".concat(t,"' is not a valid color."));return Ar(e.r,e.g,e.b)}(i),s={h:r.h,s:.8*r.s,v:Math.min(1,1.02*r.v)},a={h:r.h,s:Math.min(1,1.25*r.s),v:.8*r.v},l=Ir(a.h,a.s,a.v),c=Ir(s.h,s.s,s.v);return{background:i,border:l,highlight:{background:c,border:l},hover:{background:c,border:l}}}return{background:i,border:i,highlight:{background:i,border:i},hover:{background:i,border:i}}}return e?{background:t.background||e.background,border:t.border||e.border,highlight:fr(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||e.highlight.background,border:t.highlight&&t.highlight.border||e.highlight.border},hover:fr(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||e.hover.border,background:t.hover&&t.hover.background||e.hover.background}}:{background:t.background||void 0,border:t.border||void 0,highlight:fr(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||void 0,border:t.highlight&&t.highlight.border||void 0},hover:fr(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||void 0,background:t.hover&&t.hover.background||void 0}}}function Ar(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,Math.min(e,i)),o=Math.max(t,Math.max(e,i));return n===o?{h:0,s:0,v:n}:{h:60*((t===n?3:i===n?1:5)-(t===n?e-i:i===n?t-e:i-t)/(o-n))/360,s:(o-n)/o,v:o}}function Or(t,e,i){var n,o,r,s=Math.floor(6*t),a=6*t-s,l=i*(1-e),c=i*(1-a*e),h=i*(1-(1-a)*e);switch(s%6){case 0:n=i,o=h,r=l;break;case 1:n=c,o=i,r=l;break;case 2:n=l,o=i,r=h;break;case 3:n=l,o=c,r=i;break;case 4:n=h,o=l,r=i;break;case 5:n=i,o=l,r=c}return{r:Math.floor(255*n),g:Math.floor(255*o),b:Math.floor(255*r)}}function Ir(t,e,i){var n=Or(t,e,i);return Tr(n.r,n.g,n.b)}function Pr(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}function Mr(t){return hr.test(t)}function Dr(t){return dr.test(t)}function Nr(t){if(null===t||"object"!==Qo(t))return null;if(t instanceof Element)return t;var e=un(t);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&"object"==Qo(t[i])&&(e[i]=Nr(t[i]));return e}function Rr(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=function(t){return null!=t},r=function(t){return null!==t&&"object"===Qo(t)},s=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0};if(!r(t))throw new Error("Parameter mergeTarget must be an object");if(!r(e))throw new Error("Parameter options must be an object");if(!o(i))throw new Error("Parameter option must have a value");if(!r(n))throw new Error("Parameter globalOptions must be an object");var a=function(t,e,i){r(t[i])||(t[i]={});var n=e[i],o=t[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])},l=e[i],c=r(n)&&!s(n)?n[i]:void 0,h=c?c.enabled:void 0;if(void 0!==l){if("boolean"==typeof l)return r(t[i])||(t[i]={}),void(t[i].enabled=l);if(null===l&&!r(t[i])){if(!o(c))return;t[i]=un(c)}if(r(l)){var d=!0;void 0!==l.enabled?d=l.enabled:void 0!==h&&(d=c.enabled),a(t,e,i),t[i].enabled=d}}}var zr={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};function Fr(t,e){var i;Xo(e)||(e=[e]);var n,o=function(t,e){var i;if(void 0===nr||null==Xi(t)){if(Xo(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return or(t,e);var n=Jo(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?ln(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?or(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=$i(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r){i=r[e[0]];for(var s=1;s<e.length;s++)i&&(i=i[e[s]]);if(void 0!==i)break}}}catch(t){o.e(t)}finally{o.f()}return i}var Lr=Kn("splice"),Br=Tn("splice",{ACCESSORS:!0,0:0,1:2}),jr=Math.max,Vr=Math.min;U({target:"Array",proto:!0,forced:!Lr||!Br},{splice:function(t,e){var i,n,o,r,s,a,l=mt(this),c=ot(l.length),h=at(t,c),d=arguments.length;if(0===d?i=n=0:1===d?(i=0,n=c-h):(i=d-2,n=Vr(jr(it(e),0),c-h)),c+i-n>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(o=Be(l,n),r=0;r<n;r++)(s=h+r)in l&&Ft(o,r,l[s]);if(o.length=n,i<n){for(r=h;r<c-n;r++)a=r+i,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=c;r>c-n+i;r--)delete l[r-1]}else if(i>n)for(r=c-n;r>h;r--)a=r+i-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<i;r++)l[r+h]=arguments[r+2];return l.length=c-n+i,o}});var Hr=X("Array").splice,Wr=Array.prototype,qr=function(t){var e=t.splice;return t===Wr||t instanceof Array&&e===Wr.splice?Hr:e},Ur=ct.includes,Yr=Tn("indexOf",{ACCESSORS:!0,1:0});U({target:"Array",proto:!0,forced:!Yr},{includes:function(t){return Ur(this,t,arguments.length>1?arguments[1]:void 0)}});var Gr=X("Array").includes,Zr=pe("match"),$r=function(t){if(function(t){var e;return b(t)&&(void 0!==(e=t[Zr])?!!e:"RegExp"==p(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},Xr=pe("match");U({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[Xr]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~String(v(this)).indexOf($r(t),arguments.length>1?arguments[1]:void 0)}});var Kr=X("String").includes,Qr=Array.prototype,Jr=String.prototype,ts=function(t){var e=t.includes;return t===Qr||t instanceof Array&&e===Qr.includes?Gr:"string"==typeof t||t===Jr||t instanceof String&&e===Jr.includes?Kr:e};function es(t){return ss=t,function(){var t={};if(as=0,ls=ss.charAt(0),ws(),"strict"===cs&&(t.strict=!0,ws()),"graph"!==cs&&"digraph"!==cs||(t.type=cs,ws()),hs===os&&(t.id=cs,ws()),"{"!=cs)throw Ts("Angle bracket { expected");if(ws(),ks(t),"}"!=cs)throw Ts("Angle bracket } expected");if(ws(),""!==cs)throw Ts("End of file expected");return ws(),delete t.node,delete t.edge,delete t.graph,t}()}var is={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"},ns=un(is);ns.color="color.color",ns.style="dashes";var os=2,rs={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},ss="",as=0,ls="",cs="",hs=0;function ds(){as++,ls=ss.charAt(as)}function us(){return ss.charAt(as+1)}var fs=/[a-zA-Z_0-9.:#]/;function ps(t){return fs.test(t)}function gs(t,e){if(t||(t={}),e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function ms(t,e,i){for(var n=e.split("."),o=t;n.length;){var r=n.shift();n.length?(o[r]||(o[r]={}),o=o[r]):o[r]=i}}function vs(t,e){for(var i,n,o=null,r=[t],s=t;s.parent;)r.push(s.parent),s=s.parent;if(s.nodes)for(i=0,n=s.nodes.length;i<n;i++)if(e.id===s.nodes[i].id){o=s.nodes[i];break}for(o||(o={id:e.id},t.node&&(o.attr=gs(o.attr,t.node))),i=r.length-1;i>=0;i--){var a,l=r[i];l.nodes||(l.nodes=[]),-1===go(a=l.nodes).call(a,o)&&l.nodes.push(o)}e.attr&&(o.attr=gs(o.attr,e.attr))}function ys(t,e){if(t.edges||(t.edges=[]),t.edges.push(e),t.edge){var i=gs({},t.edge);e.attr=gs(i,e.attr)}}function bs(t,e,i,n,o){var r={from:e,to:i,type:n};return t.edge&&(r.attr=gs({},t.edge)),r.attr=gs(r.attr||{},o),null!=o&&o.hasOwnProperty("arrows")&&null!=o.arrows&&(r.arrows={to:{enabled:!0,type:o.arrows.type}},o.arrows=null),r}function ws(){for(hs=0,cs="";" "===ls||"\t"===ls||"\n"===ls||"\r"===ls;)ds();do{var t=!1;if("#"===ls){for(var e=as-1;" "===ss.charAt(e)||"\t"===ss.charAt(e);)e--;if("\n"===ss.charAt(e)||""===ss.charAt(e)){for(;""!=ls&&"\n"!=ls;)ds();t=!0}}if("/"===ls&&"/"===us()){for(;""!=ls&&"\n"!=ls;)ds();t=!0}if("/"===ls&&"*"===us()){for(;""!=ls;){if("*"===ls&&"/"===us()){ds(),ds();break}ds()}t=!0}for(;" "===ls||"\t"===ls||"\n"===ls||"\r"===ls;)ds()}while(t);if(""!==ls){var i=ls+us();if(rs[i])return hs=1,cs=i,ds(),void ds();if(rs[ls])return hs=1,cs=ls,void ds();if(ps(ls)||"-"===ls){for(cs+=ls,ds();ps(ls);)cs+=ls,ds();return"false"===cs?cs=!1:"true"===cs?cs=!0:isNaN(Number(cs))||(cs=Number(cs)),void(hs=os)}if('"'===ls){for(ds();""!=ls&&('"'!=ls||'"'===ls&&'"'===us());)'"'===ls?(cs+=ls,ds()):"\\"===ls&&"n"===us()?(cs+="\n",ds()):cs+=ls,ds();if('"'!=ls)throw Ts('End of string " expected');return ds(),void(hs=os)}for(hs=3;""!=ls;)cs+=ls,ds();throw new SyntaxError('Syntax error in part "'+Ss(cs,30)+'"')}hs=1}function ks(t){for(;""!==cs&&"}"!=cs;)_s(t),";"===cs&&ws()}function _s(t){var e=xs(t);if(e)Cs(t,e);else if(!function(t){return"node"===cs?(ws(),t.node=Es(),"node"):"edge"===cs?(ws(),t.edge=Es(),"edge"):"graph"===cs?(ws(),t.graph=Es(),"graph"):null}(t)){if(hs!=os)throw Ts("Identifier expected");var i=cs;if(ws(),"="===cs){if(ws(),hs!=os)throw Ts("Identifier expected");t[i]=cs,ws()}else!function(t,e){var i={id:e},n=Es();n&&(i.attr=n),vs(t,i),Cs(t,e)}(t,i)}}function xs(t){var e=null;if("subgraph"===cs&&((e={}).type="subgraph",ws(),hs===os&&(e.id=cs,ws())),"{"===cs){if(ws(),e||(e={}),e.parent=t,e.node=t.node,e.edge=t.edge,e.graph=t.graph,ks(e),"}"!=cs)throw Ts("Angle bracket } expected");ws(),delete e.node,delete e.edge,delete e.graph,delete e.parent,t.subgraphs||(t.subgraphs=[]),t.subgraphs.push(e)}return e}function Cs(t,e){for(;"->"===cs||"--"===cs;){var i,n=cs;ws();var o=xs(t);if(o)i=o;else{if(hs!=os)throw Ts("Identifier or subgraph expected");vs(t,{id:i=cs}),ws()}ys(t,bs(t,e,i,n,Es())),e=i}}function Es(){for(var t,e,i=null,n={dashed:!0,solid:!1,dotted:[1,5]},o={dot:"circle",box:"box",crow:"crow",curve:"curve",icurve:"inv_curve",normal:"triangle",inv:"inv_triangle",diamond:"diamond",tee:"bar",vee:"vee"},r=new Array,s=new Array;"["===cs;){for(ws(),i={};""!==cs&&"]"!=cs;){if(hs!=os)throw Ts("Attribute name expected");var a=cs;if(ws(),"="!=cs)throw Ts("Equal sign = expected");if(ws(),hs!=os)throw Ts("Attribute value expected");var l=cs;"style"===a&&(l=n[l]),"arrowhead"===a&&(a="arrows",l={to:{enabled:!0,type:o[l]}}),"arrowtail"===a&&(a="arrows",l={from:{enabled:!0,type:o[l]}}),r.push({attr:i,name:a,value:l}),s.push(a),ws(),","==cs&&ws()}if("]"!=cs)throw Ts("Bracket ] expected");ws()}if(ts(s).call(s,"dir")){var c={arrows:{}};for(t=0;t<r.length;t++)if("arrows"===r[t].name)if(null!=r[t].value.to)c.arrows.to=t;else{if(null==r[t].value.from)throw Ts("Invalid value of arrows");c.arrows.from=t}else"dir"===r[t].name&&(c.dir=t);var h,d,u=r[c.dir].value;if(!ts(s).call(s,"arrows"))if("both"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),c.arrows.to=r.length-1,r.push({attr:r[c.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),c.arrows.from=r.length-1;else if("forward"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),c.arrows.to=r.length-1;else if("back"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),c.arrows.from=r.length-1;else{if("none"!==u)throw Ts('Invalid dir type "'+u+'"');r.push({attr:r[c.dir].attr,name:"arrows",value:""}),c.arrows.to=r.length-1}if("both"===u)c.arrows.to&&c.arrows.from?(r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}},qr(r).call(r,c.arrows.from,1)):c.arrows.to?r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h="arrow"}}}:c.arrows.from&&(r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d="arrow"},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}});else if("back"===u)c.arrows.to&&c.arrows.from?r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}}:c.arrows.to?(d="",h="arrow",c.arrows.from=c.arrows.to,r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:h}}}):c.arrows.from&&(r[c.arrows.to]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}}),r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{from:{enabled:!0,type:r[c.arrows.from].value.from.type}}};else if("none"===u){var f;r[f=c.arrows.to?c.arrows.to:c.arrows.from]={attr:r[f].attr,name:r[f].name,value:""}}else{if("forward"!==u)throw Ts('Invalid dir type "'+u+'"');c.arrows.to&&c.arrows.from||c.arrows.to?r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h=""}}}:c.arrows.from&&(d="arrow",h="",c.arrows.to=c.arrows.from,r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:h}}}),r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:r[c.arrows.to].value.to.type}}}}qr(r).call(r,c.dir,1)}if(ts(s).call(s,"penwidth")){var p=[];for(e=r.length,t=0;t<e;t++)"width"!==r[t].name&&("penwidth"===r[t].name&&(r[t].name="width"),p.push(r[t]));r=p}for(e=r.length,t=0;t<e;t++)ms(r[t].attr,r[t].name,r[t].value);return i}function Ts(t){return new SyntaxError(t+', got "'+Ss(cs,30)+'" (char '+as+")")}function Ss(t,e){return t.length<=e?t:t.substr(0,27)+"..."}function As(t,e,i){for(var n=e.split("."),o=n.pop(),r=t,s=0;s<n.length;s++){var a=n[s];a in r||(r[a]={}),r=r[a]}return r[o]=i,t}function Os(t,e){var i={};for(var n in t)if(t.hasOwnProperty(n)){var o=e[n];Xo(o)?Nn(o).call(o,function(e){As(i,e,t[n])}):As(i,"string"==typeof o?o:n,t[n])}return i}function Is(t){var e,i=es(t),n={nodes:[],edges:[],options:{}};if(i.nodes&&Nn(e=i.nodes).call(e,function(t){var e={id:t.id,label:String(t.label||t.id)};gs(e,Os(t.attr,is)),e.image&&(e.shape="image"),n.nodes.push(e)}),i.edges){var o,r=function(t){var e={from:t.from,to:t.to};return gs(e,Os(t.attr,ns)),null==e.arrows&&"->"===t.type&&(e.arrows="to"),e};Nn(o=i.edges).call(o,function(t){var e,i,o,s,a,l,c;e=t.from instanceof Object?t.from.nodes:{id:t.from},i=t.to instanceof Object?t.to.nodes:{id:t.to},t.from instanceof Object&&t.from.edges&&Nn(o=t.from.edges).call(o,function(t){var e=r(t);n.edges.push(e)}),a=i,l=function(e,i){var o=bs(n,e.id,i.id,t.type,t.attr),s=r(o);n.edges.push(s)},Xo(s=e)?Nn(s).call(s,function(t){Xo(a)?Nn(a).call(a,function(e){l(t,e)}):l(t,a)}):Xo(a)?Nn(a).call(a,function(t){l(s,t)}):l(s,a),t.to instanceof Object&&t.to.edges&&Nn(c=t.to.edges).call(c,function(t){var e=r(t);n.edges.push(e)})})}return i.attr&&(n.options=i.attr),n}var Ps=Object.freeze({__proto__:null,parseDOT:es,DOTToGraph:Is});function Ms(t,e){var i,n={edges:{inheritColor:!1},nodes:{fixed:!1,parseColor:!1}};null!=e&&(null!=e.fixed&&(n.nodes.fixed=e.fixed),null!=e.parseColor&&(n.nodes.parseColor=e.parseColor),null!=e.inheritColor&&(n.edges.inheritColor=e.inheritColor));var o=t.edges,r=$o(o).call(o,function(t){var e={from:t.source,id:t.id,to:t.target};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),"Directed"===t.type&&(e.arrows="to"),t.color&&!1===n.edges.inheritColor&&(e.color=t.color),e});return{nodes:$o(i=t.nodes).call(i,function(t){var e={id:t.id,fixed:n.nodes.fixed&&null!=t.x&&null!=t.y};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.size&&(e.size=t.size),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),null!=t.title&&(e.title=t.title),null!=t.x&&(e.x=t.x),null!=t.y&&(e.y=t.y),null!=t.color&&(e.color=!0===n.nodes.parseColor?t.color:{background:t.color,border:t.color,highlight:{background:t.color,border:t.color},hover:{background:t.color,border:t.color}}),e}),edges:r}}var Ds=Object.freeze({__proto__:null,parseGephi:Ms}),Ns=n(function(t,e){t.exports=function(t){var e,i=t&&t.preventDefault||!1,n=t&&t.container||window,o={},r={keydown:{},keyup:{}},s={};for(e=97;e<=122;e++)s[String.fromCharCode(e)]={code:e-97+65,shift:!1};for(e=65;e<=90;e++)s[String.fromCharCode(e)]={code:e,shift:!0};for(e=0;e<=9;e++)s[""+e]={code:48+e,shift:!1};for(e=1;e<=12;e++)s["F"+e]={code:111+e,shift:!1};for(e=0;e<=9;e++)s["num"+e]={code:96+e,shift:!1};s["num*"]={code:106,shift:!1},s["num+"]={code:107,shift:!1},s["num-"]={code:109,shift:!1},s["num/"]={code:111,shift:!1},s["num."]={code:110,shift:!1},s.left={code:37,shift:!1},s.up={code:38,shift:!1},s.right={code:39,shift:!1},s.down={code:40,shift:!1},s.space={code:32,shift:!1},s.enter={code:13,shift:!1},s.shift={code:16,shift:void 0},s.esc={code:27,shift:!1},s.backspace={code:8,shift:!1},s.tab={code:9,shift:!1},s.ctrl={code:17,shift:!1},s.alt={code:18,shift:!1},s.delete={code:46,shift:!1},s.pageup={code:33,shift:!1},s.pagedown={code:34,shift:!1},s["="]={code:187,shift:!1},s["-"]={code:189,shift:!1},s["]"]={code:221,shift:!1},s["["]={code:219,shift:!1};var a=function(t){c(t,"keydown")},l=function(t){c(t,"keyup")},c=function(t,e){if(void 0!==r[e][t.keyCode]){for(var n=r[e][t.keyCode],o=0;o<n.length;o++)(void 0===n[o].shift||1==n[o].shift&&1==t.shiftKey||0==n[o].shift&&0==t.shiftKey)&&n[o].fn(t);1==i&&t.preventDefault()}};return o.bind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw new Error("unsupported key: "+t);void 0===r[i][s[t].code]&&(r[i][s[t].code]=[]),r[i][s[t].code].push({fn:e,shift:s[t].shift})},o.bindAll=function(t,e){for(var i in void 0===e&&(e="keydown"),s)s.hasOwnProperty(i)&&o.bind(i,t,e)},o.getKey=function(t){for(var e in s)if(s.hasOwnProperty(e)){if(1==t.shiftKey&&1==s[e].shift&&t.keyCode==s[e].code)return e;if(0==t.shiftKey&&0==s[e].shift&&t.keyCode==s[e].code)return e;if(t.keyCode==s[e].code&&"shift"==e)return e}return"unknown key, currently not supported"},o.unbind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw new Error("unsupported key: "+t);if(void 0!==e){var n=[],o=r[i][s[t].code];if(void 0!==o)for(var a=0;a<o.length;a++)o[a].fn==e&&o[a].shift==s[t].shift||n.push(r[i][s[t].code][a]);r[i][s[t].code]=n}else r[i][s[t].code]=[]},o.reset=function(){r={keydown:{},keyup:{}}},o.destroy=function(){r={keydown:{},keyup:{}},n.removeEventListener("keydown",a,!0),n.removeEventListener("keyup",l,!0)},n.addEventListener("keydown",a,!0),n.addEventListener("keyup",l,!0),o}});function Rs(){return(Rs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function zs(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Fs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ls,Bs="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,js=["","webkit","Moz","MS","ms","o"],Vs="undefined"==typeof document?{style:{}}:document.createElement("div"),Hs=Math.round,Ws=Math.abs,qs=Date.now;function Us(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<js.length;){if((n=(i=js[r])?i+o:e)in t)return n;r++}}Ls="undefined"==typeof window?{}:window;var Ys=Us(Vs.style,"touchAction"),Gs=void 0!==Ys,Zs=function(){if(!Gs)return!1;var t={},e=Ls.CSS&&Ls.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||Ls.CSS.supports("touch-action",i)}),t}(),$s="ontouchstart"in Ls,Xs=void 0!==Us(Ls,"PointerEvent"),Ks=$s&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Qs=["x","y"],Js=["clientX","clientY"];function ta(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function ea(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function ia(t,e){return t.indexOf(e)>-1}var na=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){"compute"===t&&(t=this.compute()),Gs&&this.manager.element.style&&Zs[t]&&(this.manager.element.style[Ys]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return ta(this.manager.recognizers,function(e){ea(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(ia(t,"none"))return"none";var e=ia(t,"pan-x"),i=ia(t,"pan-y");return e&&i?"none":e||i?e?"pan-x":"pan-y":ia(t,"manipulation")?"manipulation":"auto"}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,o=ia(n,"none")&&!Zs.none,r=ia(n,"pan-y")&&!Zs["pan-y"],s=ia(n,"pan-x")&&!Zs["pan-x"];if(o&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!s||!r)return o||r&&6&i||s&&24&i?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function oa(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function ra(t){var e=t.length;if(1===e)return{x:Hs(t[0].clientX),y:Hs(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:Hs(i/e),y:Hs(n/e)}}function sa(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Hs(t.pointers[i].clientX),clientY:Hs(t.pointers[i].clientY)},i++;return{timeStamp:qs(),pointers:e,center:ra(e),deltaX:t.deltaX,deltaY:t.deltaY}}function aa(t,e,i){i||(i=Qs);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function la(t,e,i){return i||(i=Qs),180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function ca(t,e){return t===e?1:Ws(t)>=Ws(e)?t<0?2:4:e<0?8:16}function ha(t,e,i){return{x:e/t||0,y:i/t||0}}function da(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=1&e&&n-o==0,s=12&e&&n-o==0;i.isFirst=!!r,i.isFinal=!!s,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=sa(e)),o>1&&!i.firstMultiple?i.firstMultiple=sa(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,a=s?s.center:r.center,l=e.center=ra(n);e.timeStamp=qs(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=la(a,l),e.distance=aa(a,l),function(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}(i,e),e.offsetDirection=ca(e.deltaX,e.deltaY);var c,h,d=ha(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=Ws(d.x)>Ws(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,aa((h=n)[0],h[1],Js)/aa(c[0],c[1],Js)):1,e.rotation=s?function(t,e){return la(e[1],e[0],Js)+la(t[1],t[0],Js)}(s.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=ha(a,l,c);n=h.x,o=h.y,i=Ws(h.x)>Ws(h.y)?h.x:h.y,r=ca(l,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(i,e);var u,f=t.element,p=e.srcEvent;oa(u=p.composedPath?p.composedPath()[0]:p.path?p.path[0]:p.target,f)&&(f=u),e.target=f}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function ua(t){return t.trim().split(/\s+/g)}function fa(t,e,i){ta(ua(e),function(e){t.addEventListener(e,i,!1)})}function pa(t,e,i){ta(ua(e),function(e){t.removeEventListener(e,i,!1)})}function ga(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var ma=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){ea(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&fa(this.element,this.evEl,this.domHandler),this.evTarget&&fa(this.target,this.evTarget,this.domHandler),this.evWin&&fa(ga(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&pa(this.element,this.evEl,this.domHandler),this.evTarget&&pa(this.target,this.evTarget,this.domHandler),this.evWin&&pa(ga(this.element),this.evWin,this.domHandler)},t}();function va(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}var ya={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ba={2:"touch",3:"pen",4:"mouse",5:"kinect"},wa="pointerdown",ka="pointermove pointerup pointercancel";Ls.MSPointerEvent&&!Ls.PointerEvent&&(wa="MSPointerDown",ka="MSPointerMove MSPointerUp MSPointerCancel");var _a=function(t){function e(){var i,n=e.prototype;return n.evEl=wa,n.evWin=ka,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return zs(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=ya[n],r=ba[t.pointerType]||t.pointerType,s="touch"===r,a=va(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))},e}(ma);function xa(t){return Array.prototype.slice.call(t,0)}function Ca(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];va(o,s)<0&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var Ea={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Ta=function(t){function e(){var i;return e.prototype.evTarget="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).targetIds={},i}return zs(e,t),e.prototype.handler=function(t){var e=Ea[t.type],i=Sa.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})},e}(ma);function Sa(t,e){var i,n,o=xa(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=xa(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return oa(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[Ca(n.concat(a),"identifier",!0),a]:void 0}var Aa={mousedown:1,mousemove:2,mouseup:4},Oa=function(t){function e(){var i,n=e.prototype;return n.evEl="mousedown",n.evWin="mousemove mouseup",(i=t.apply(this,arguments)||this).pressed=!1,i}return zs(e,t),e.prototype.handler=function(t){var e=Aa[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))},e}(ma);function Ia(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function Pa(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,Ia.call(this,e)):12&t&&Ia.call(this,e)}function Ma(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var Da=function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o="mouse"===i.pointerType;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if("touch"===i.pointerType)Pa.call(Fs(Fs(n)),e,i);else if(o&&Ma.call(Fs(Fs(n)),i))return;n.callback(t,e,i)}},n.touch=new Ta(n.manager,n.handler),n.mouse=new Oa(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return zs(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(ma);function Na(t,e,i){return!!Array.isArray(t)&&(ta(t,i[e],i),!0)}var Ra=1;function za(t,e){var i=e.manager;return i?i.get(t):t}function Fa(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var La=function(){function t(t){void 0===t&&(t={}),this.options=Rs({enable:!0},t),this.id=Ra++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return Bs(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(Na(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=za(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return Na(t,"dropRecognizeWith",this)||(t=za(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(Na(t,"requireFailure",this))return this;var e=this.requireFail;return-1===va(e,t=za(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(Na(t,"dropRequireFailure",this))return this;t=za(t,this);var e=va(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+Fa(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+Fa(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=32},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=Bs({},t);if(!ea(this.options.enable,[this,e]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),Ba=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Rs({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){return["manipulation"]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||aa(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return 32},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=32},this.options.interval),32},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(La),ja=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Rs({pointers:1},e))||this}zs(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:32},e}(La);function Va(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var Ha=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Rs({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push("pan-y"),24&t&&e.push("pan-x"),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return ja.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=Va(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(ja),Wa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Rs({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){return Ha.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&Ws(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=Va(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(ja),qa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Rs({event:"pinch",threshold:0,pointers:2},e))||this}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){return["none"]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),t.prototype.emit.call(this,e)},e}(ja),Ua=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Rs({event:"rotate",threshold:0,pointers:2},e))||this}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){return["none"]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(ja),Ya=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Rs({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}zs(e,t);var i=e.prototype;return i.getTouchAction=function(){return["auto"]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,!o||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8;return 32},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=qs(),this.manager.emit(this.options.event,this._input)))},e}(La),Ga={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Za=[[Ua,{enable:!1}],[qa,{enable:!1},["rotate"]],[Wa,{direction:6}],[Ha,{direction:6},["swipe"]],[Ba],[Ba,{event:"doubletap",taps:2},["tap"]],[Ya]];function $a(t,e){var i,n=t.element;n.style&&(ta(t.options.cssProps,function(o,r){i=Us(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var Xa=function(){function t(t,e){var i=this;this.options=Bs({},Ga,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(Xs?_a:Ks?Ta:$s?Da:Oa))(this,da),this.touchAction=new na(this,this.options.touchAction),$a(this,!0),ta(this.options.recognizers,function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return Bs(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(e.curRecognizer=null,o=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||o&&i!==o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&14&i.state&&(e.curRecognizer=i,o=i),r++}},e.get=function(t){if(t instanceof La)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(Na(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(Na(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=va(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return ta(ua(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return ta(ua(t),function(t){e?i[t]&&i[t].splice(va(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},e.destroy=function(){this.element&&$a(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),Ka={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Qa=function(t){function e(){var i,n=e.prototype;return n.evTarget="touchstart",n.evWin="touchstart touchmove touchend touchcancel",(i=t.apply(this,arguments)||this).started=!1,i}return zs(e,t),e.prototype.handler=function(t){var e=Ka[t.type];if(1===e&&(this.started=!0),this.started){var i=Ja.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}},e}(ma);function Ja(t,e){var i=xa(t.touches),n=xa(t.changedTouches);return 12&e&&(i=Ca(i.concat(n),"identifier",!0)),[i,n]}function tl(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var el=tl(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),il=tl(function(t,e){return el(t,e,!0)},"merge","Use `assign`.");function nl(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&Bs(n,i)}function ol(t,e){return function(){return t.apply(e,arguments)}}var rl=function(){var t=function(t,e){return void 0===e&&(e={}),new Xa(t,Rs({recognizers:Za.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=16,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=24,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=16,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=32,t.Manager=Xa,t.Input=ma,t.TouchAction=na,t.TouchInput=Ta,t.MouseInput=Oa,t.PointerEventInput=_a,t.TouchMouseInput=Da,t.SingleTouchInput=Qa,t.Recognizer=La,t.AttrRecognizer=ja,t.Tap=Ba,t.Pan=Ha,t.Swipe=Wa,t.Pinch=qa,t.Rotate=Ua,t.Press=Ya,t.on=fa,t.off=pa,t.each=ta,t.merge=il,t.extend=el,t.bindFn=ol,t.assign=Bs,t.inherit=nl,t.bindFn=ol,t.prefixed=Us,t.toArray=xa,t.inArray=va,t.uniqueArray=Ca,t.splitStr=ua,t.boolOrFn=ea,t.hasParent=oa,t.addEventListeners=fa,t.removeEventListeners=pa,t.defaults=Bs({},Ga,{preset:Za}),t}(),sl=o(Object.freeze({__proto__:null,default:rl,INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Xa,Input:ma,TouchAction:na,TouchInput:Ta,MouseInput:Oa,PointerEventInput:_a,TouchMouseInput:Da,SingleTouchInput:Qa,Recognizer:La,AttrRecognizer:ja,Tap:Ba,Pan:Ha,Swipe:Wa,Pinch:qa,Rotate:Ua,Press:Ya,on:fa,off:pa,each:ta,merge:il,extend:el,assign:Bs,inherit:nl,bindFn:ol,prefixed:Us,toArray:xa,inArray:va,uniqueArray:Ca,splitStr:ua,boolOrFn:ea,hasParent:oa,addEventListeners:fa,removeEventListeners:pa,defaults:rl.defaults})),al=n(function(t){if("undefined"!=typeof window){var e=window.Hammer||sl;t.exports=e}else t.exports=function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(e){return{set:t}}};var t}});function ll(t){var e,i,n=this;this.active=!1,this.dom={container:t},this.dom.overlay=document.createElement("div"),this.dom.overlay.className="vis-overlay",this.dom.container.appendChild(this.dom.overlay),this.hammer=al(this.dom.overlay),this.hammer.on("tap",J(e=this._onTapOverlay).call(e,this));var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Nn(o).call(o,function(t){n.hammer.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this.onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||n.deactivate()},document.body.addEventListener("click",this.onClick)),void 0!==this.keycharm&&this.keycharm.destroy(),this.keycharm=Ns(),this.escListener=J(i=this.deactivate).call(i,this)}St(ll.prototype),ll.current=null,ll.prototype.destroy=function(){this.deactivate(),this.dom.overlay.parentNode.removeChild(this.dom.overlay),this.onClick&&document.body.removeEventListener("click",this.onClick),void 0!==this.keycharm&&this.keycharm.destroy(),this.keycharm=null,this.hammer.destroy(),this.hammer=null},ll.prototype.activate=function(){var t,e,i,n;ll.current&&ll.current.deactivate(),ll.current=this,this.active=!0,this.dom.overlay.style.display="none",i=(e=this.dom.container).className.split(" "),n="vis-active".split(" "),i=ir(i).call(i,no(n).call(n,function(t){return go(i).call(i,t)<0})),e.className=i.join(" "),this.emit("change"),this.emit("activate"),J(t=this.keycharm).call(t,"esc",this.escListener)},ll.prototype.deactivate=function(){var t,e,i;this.active=!1,this.dom.overlay.style.display="block",e=(t=this.dom.container).className.split(" "),i="vis-active".split(" "),e=no(e).call(e,function(t){return go(i).call(i,t)<0}),t.className=e.join(" "),this.keycharm.unbind("esc",this.escListener),this.emit("change"),this.emit("deactivate")},ll.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var cl=Object.freeze({__proto__:null,en:{addDescription:"Click in an empty space to place a new node.",addEdge:"Add Edge",addNode:"Add Node",back:"Back",createEdgeError:"Cannot link edges to a cluster.",del:"Delete selected",deleteClusterError:"Clusters cannot be deleted.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",edit:"Edit",editClusterError:"Clusters cannot be edited.",editEdge:"Edit Edge",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",editNode:"Edit Node"},de:{addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",addEdge:"Kante hinzuf\xfcgen",addNode:"Knoten hinzuf\xfcgen",back:"Zur\xfcck",createEdgeError:"Es ist nicht m\xf6glich, Kanten mit Clustern zu verbinden.",del:"L\xf6sche Auswahl",deleteClusterError:"Cluster k\xf6nnen nicht gel\xf6scht werden.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",edit:"Editieren",editClusterError:"Cluster k\xf6nnen nicht editiert werden.",editEdge:"Kante editieren",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",editNode:"Knoten editieren"},es:{addDescription:"Haga clic en un lugar vac\xedo para colocar un nuevo nodo.",addEdge:"A\xf1adir arista",addNode:"A\xf1adir nodo",back:"Atr\xe1s",createEdgeError:"No se puede conectar una arista a un grupo.",del:"Eliminar selecci\xf3n",deleteClusterError:"No es posible eliminar grupos.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",edit:"Editar",editClusterError:"No es posible editar grupos.",editEdge:"Editar arista",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",editNode:"Editar nodo"},it:{addDescription:"Clicca per aggiungere un nuovo nodo",addEdge:"Aggiungi un vertice",addNode:"Aggiungi un nodo",back:"Indietro",createEdgeError:"Non si possono collegare vertici ad un cluster",del:"Cancella la selezione",deleteClusterError:"I cluster non possono essere cancellati",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",edit:"Modifica",editClusterError:"I clusters non possono essere modificati.",editEdge:"Modifica il vertice",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",editNode:"Modifica il nodo"},nl:{addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",addEdge:"Link toevoegen",addNode:"Node toevoegen",back:"Terug",createEdgeError:"Kan geen link maken naar een cluster.",del:"Selectie verwijderen",deleteClusterError:"Clusters kunnen niet worden verwijderd.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",edit:"Wijzigen",editClusterError:"Clusters kunnen niet worden aangepast.",editEdge:"Link wijzigen",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",editNode:"Node wijzigen"},pt:{addDescription:"Clique em um espa\xe7o em branco para adicionar um novo n\xf3",addEdge:"Adicionar aresta",addNode:"Adicionar n\xf3",back:"Voltar",createEdgeError:"N\xe3o foi poss\xedvel linkar arestas a um cluster.",del:"Remover selecionado",deleteClusterError:"Clusters n\xe3o puderam ser removidos.",edgeDescription:"Clique em um n\xf3 e arraste a aresta at\xe9 outro n\xf3 para conect\xe1-los",edit:"Editar",editClusterError:"Clusters n\xe3o puderam ser editados.",editEdge:"Editar aresta",editEdgeDescription:"Clique nos pontos de controle e os arraste para um n\xf3 para conect\xe1-los",editNode:"Editar n\xf3"},ru:{addDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0443\u0437\u0435\u043b.",addEdge:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u043e",addNode:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",back:"\u041d\u0430\u0437\u0430\u0434",createEdgeError:"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440.",del:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435",deleteClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u044b",edgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u0443\u0437\u0435\u043b \u0438 \u043f\u0440\u043e\u0442\u044f\u043d\u0438\u0442\u0435 \u0440\u0435\u0431\u0440\u043e \u043a \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0443\u0437\u043b\u0443, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0438\u0445.",edit:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",editClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0431\u0440\u043e",editEdgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0443\u0437\u0435\u043b, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u043d\u0435\u043c\u0443.",editNode:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0437\u0435\u043b"},cn:{addDescription:"\u5355\u51fb\u7a7a\u767d\u5904\u653e\u7f6e\u65b0\u8282\u70b9\u3002",addEdge:"\u6dfb\u52a0\u8fde\u63a5\u7ebf",addNode:"\u6dfb\u52a0\u8282\u70b9",back:"\u8fd4\u56de",createEdgeError:"\u65e0\u6cd5\u5c06\u8fde\u63a5\u7ebf\u8fde\u63a5\u5230\u7fa4\u96c6\u3002",del:"\u5220\u9664\u9009\u5b9a",deleteClusterError:"\u65e0\u6cd5\u5220\u9664\u7fa4\u96c6\u3002",edgeDescription:"\u5355\u51fb\u67d0\u4e2a\u8282\u70b9\u5e76\u5c06\u8be5\u8fde\u63a5\u7ebf\u62d6\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u4ee5\u8fde\u63a5\u5b83\u4eec\u3002",edit:"\u7f16\u8f91",editClusterError:"\u65e0\u6cd5\u7f16\u8f91\u7fa4\u96c6\u3002",editEdge:"\u7f16\u8f91\u8fde\u63a5\u7ebf",editEdgeDescription:"\u5355\u51fb\u63a7\u5236\u8282\u70b9\u5e76\u5c06\u5b83\u4eec\u62d6\u5230\u8282\u70b9\u4e0a\u8fde\u63a5\u3002",editNode:"\u7f16\u8f91\u8282\u70b9"},uk:{addDescription:"K\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0456\u043b\u044c\u043d\u0435 \u043c\u0456\u0441\u0446\u0435, \u0449\u043e\u0431 \u0434\u043e\u0434\u0430\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0432\u0443\u0437\u043e\u043b.",addEdge:"\u0414\u043e\u0434\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",addNode:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b",back:"\u041d\u0430\u0437\u0430\u0434",createEdgeError:"\u041d\u0435 \u043c\u043e\u0436\u043b\u0438\u0432\u043e \u043e\u0431'\u0454\u0434\u043d\u0430\u0442\u0438 \u043a\u0440\u0430\u0457 \u0432 \u0433\u0440\u0443\u043f\u0443.",del:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043e\u0431\u0440\u0430\u043d\u0435",deleteClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435 \u043c\u043e\u0436\u0443\u0442\u044c \u0431\u0443\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u0456.",edgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0443\u0437\u043e\u043b \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u043a\u0440\u0430\u0439 \u0434\u043e \u0456\u043d\u0448\u043e\u0433\u043e \u0432\u0443\u0437\u043b\u0430, \u0449\u043e\u0431 \u0457\u0445 \u0437'\u0454\u0434\u043d\u0430\u0442\u0438.",edit:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438",editClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456 \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",editEdgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u0456 \u0442\u043e\u0447\u043a\u0438 \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u0457\u0445 \u0443 \u0432\u0443\u0437\u043e\u043b, \u0449\u043e\u0431 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044f \u0434\u043e \u043d\u044c\u043e\u0433\u043e.",editNode:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b"},fr:{addDescription:"Cliquez dans un endroit vide pour placer un n\u0153ud.",addEdge:"Ajouter un lien",addNode:"Ajouter un n\u0153ud",back:"Retour",createEdgeError:"Impossible de cr\xe9er un lien vers un cluster.",del:"Effacer la s\xe9lection",deleteClusterError:"Les clusters ne peuvent pas \xeatre effac\xe9s.",edgeDescription:"Cliquez sur un n\u0153ud et glissez le lien vers un autre n\u0153ud pour les connecter.",edit:"\xc9diter",editClusterError:"Les clusters ne peuvent pas \xeatre \xe9dit\xe9s.",editEdge:"\xc9diter le lien",editEdgeDescription:"Cliquez sur les points de contr\xf4le et glissez-les pour connecter un n\u0153ud.",editNode:"\xc9diter le n\u0153ud"},cs:{addDescription:"Kluknut\xedm do pr\xe1zdn\xe9ho prostoru m\u016f\u017eete p\u0159idat nov\xfd vrchol.",addEdge:"P\u0159idat hranu",addNode:"P\u0159idat vrchol",back:"Zp\u011bt",createEdgeError:"Nelze p\u0159ipojit hranu ke shluku.",del:"Smazat v\xfdb\u011br",deleteClusterError:"Nelze mazat shluky.",edgeDescription:"P\u0159eta\u017een\xedm z jednoho vrcholu do druh\xe9ho m\u016f\u017eete spojit tyto vrcholy novou hranou.",edit:"Upravit",editClusterError:"Nelze upravovat shluky.",editEdge:"Upravit hranu",editEdgeDescription:"P\u0159eta\u017een\xedm kontroln\xedho vrcholu hrany ji m\u016f\u017eete p\u0159ipojit k jin\xe9mu vrcholu.",editNode:"Upravit vrchol"}}),hl=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function dl(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),fn(t,n.key,n)}}var ul=function(t,e,i){return e&&dl(t.prototype,e),i&&dl(t,i),t},fl=function(){function t(){hl(this,t),this.NUM_ITERATIONS=4,this.image=new Image,this.canvas=document.createElement("canvas")}return ul(t,[{key:"init",value:function(){if(!this.initialized()){this.src=this.image.src;var t=this.image.width,e=this.image.height;this.width=t,this.height=e;var i=Math.floor(e/2),n=Math.floor(e/4),o=Math.floor(e/8),r=Math.floor(e/16),s=Math.floor(t/2),a=Math.floor(t/4),l=Math.floor(t/8),c=Math.floor(t/16);this.canvas.width=3*a,this.canvas.height=i,this.coordinates=[[0,0,s,i],[s,0,a,n],[s,n,l,o],[5*l,n,c,r]],this._fillMipMap()}}},{key:"initialized",value:function(){return void 0!==this.coordinates}},{key:"_fillMipMap",value:function(){var t=this.canvas.getContext("2d"),e=this.coordinates[0];t.drawImage(this.image,e[0],e[1],e[2],e[3]);for(var i=1;i<this.NUM_ITERATIONS;i++){var n=this.coordinates[i-1],o=this.coordinates[i];t.drawImage(this.canvas,n[0],n[1],n[2],n[3],o[0],o[1],o[2],o[3])}}},{key:"drawImageAtPosition",value:function(t,e,i,n,o,r){if(this.initialized())if(e>2){e*=.5;for(var s=0;e>2&&s<this.NUM_ITERATIONS;)e*=.5,s+=1;s>=this.NUM_ITERATIONS&&(s=this.NUM_ITERATIONS-1);var a=this.coordinates[s];t.drawImage(this.canvas,a[0],a[1],a[2],a[3],i,n,o,r)}else t.drawImage(this.image,i,n,o,r)}}]),t}(),pl=function(){function t(e){hl(this,t),this.images={},this.imageBroken={},this.callback=e}return ul(t,[{key:"_tryloadBrokenUrl",value:function(t,e,i){void 0!==t&&void 0!==i&&(void 0!==e?(i.image.onerror=function(){console.error("Could not load brokenImage:",e)},i.image.src=e):console.warn("No broken url image defined"))}},{key:"_redrawWithImage",value:function(t){this.callback&&this.callback(t)}},{key:"load",value:function(t,e){var i=this,n=this.images[t];if(n)return n;var o=new fl;return this.images[t]=o,o.image.onload=function(){i._fixImageCoordinates(o.image),o.init(),i._redrawWithImage(o)},o.image.onerror=function(){console.error("Could not load image:",t),i._tryloadBrokenUrl(t,e,o)},o.image.src=t,o}},{key:"_fixImageCoordinates",value:function(t){0===t.width&&(document.body.appendChild(t),t.width=t.offsetWidth,t.height=t.offsetHeight,document.body.removeChild(t))}}]),t}(),gl=function(){function t(){hl(this,t),this.clear(),this.defaultIndex=0,this.groupsArray=[],this.groupIndex=0,this.defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}],this.options={},this.defaultOptions={useDefaultGroups:!0},wt(this.options,this.defaultOptions)}return ul(t,[{key:"setOptions",value:function(t){var e=["useDefaultGroups"];if(void 0!==t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&-1===go(e).call(e,i)&&this.add(i,t[i])}},{key:"clear",value:function(){this.groups={},this.groupsArray=[]}},{key:"get",value:function(t){var e=this.groups[t];if(void 0===e&&(!(arguments.length>1&&void 0!==arguments[1])||arguments[1]))if(!1===this.options.useDefaultGroups&&this.groupsArray.length>0){var i=this.groupIndex%this.groupsArray.length;this.groupIndex++,(e={}).color=this.groups[this.groupsArray[i]],this.groups[t]=e}else{var n=this.defaultIndex%this.defaultGroups.length;this.defaultIndex++,(e={}).color=this.defaultGroups[n],this.groups[t]=e}return e}},{key:"add",value:function(t,e){return this.groups[t]=e,this.groupsArray.push(t),e}}]),t}(),ml=[].slice,vl=/MSIE .\./.test(Un),yl=function(t){return function(e,i){var n=arguments.length>2,o=n?ml.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,i)}};U({global:!0,bind:!0,forced:vl},{setTimeout:yl(s.setTimeout),setInterval:yl(s.setInterval)});var bl=z.setTimeout,wl=He.some,kl=_n("some"),_l=Tn("some");U({target:"Array",proto:!0,forced:!kl||!_l},{some:function(t){return wl(this,t,arguments.length>1?arguments[1]:void 0)}});var xl=X("Array").some,Cl=Array.prototype,El=s.isFinite;U({target:"Number",stat:!0},{isFinite:Number.isFinite||function(t){return"number"==typeof t&&El(t)}});var Tl=z.Number.isFinite;U({target:"Number",stat:!0},{isNaN:function(t){return t!=t}});var Sl=z.Number.isNaN,Al=ce.f,Ol=a(function(){return!Object.getOwnPropertyNames(1)});U({target:"Object",stat:!0,forced:Ol},{getOwnPropertyNames:Al});var Il=z.Object,Pl=wn.trim,Ml=s.parseFloat,Dl=1/Ml(gn+"-0")!=-1/0?function(t){var e=Pl(String(t)),i=Ml(e);return 0===i&&"-"==e.charAt(0)?-0:i}:Ml;U({global:!0,forced:parseFloat!=Dl},{parseFloat:Dl});var Nl=z.parseFloat;function Rl(t,e){var i=["node","edge","label"],n=!0,o=Fr(e,"chosen");if("boolean"==typeof o)n=o;else if("object"===Qo(o)){if(-1===go(i).call(i,t))throw new Error("choosify: subOption '"+t+"' should be one of '"+i.join("', '")+"'");var r=Fr(e,["chosen",t]);"boolean"!=typeof r&&"function"!=typeof r||(n=r)}return n}function zl(t,e,i){if(t.width<=0||t.height<=0)return!1;if(void 0!==i){var n={x:e.x-i.x,y:e.y-i.y};if(0!==i.angle){var o=-i.angle;e={x:Math.cos(o)*n.x-Math.sin(o)*n.y,y:Math.sin(o)*n.x+Math.cos(o)*n.y}}else e=n}return t.left<e.x&&t.x+t.width>e.x&&t.top<e.y&&t.y+t.width>e.y}function Fl(t){return"string"==typeof t&&""!==t}function Ll(t,e,i,n){var o=n.x,r=n.y;if("function"==typeof n.distanceToBorder){var s=n.distanceToBorder(t,e),a=Math.sin(e)*s,l=Math.cos(e)*s;l===s?(o+=s,r=n.y):a===s?(o=n.x,r-=s):(o+=l,r-=a)}else n.shape.width>n.shape.height?(o=n.x+.5*n.shape.width,r=n.y-i):(o=n.x+i,r=n.y-.5*n.shape.height);return{x:o,y:r}}var Bl=X("Array").values,jl=Array.prototype,Vl={DOMTokenList:!0,NodeList:!0},Hl=function(t){var e=t.values;return t===jl||t instanceof Array&&e===jl.values||Vl.hasOwnProperty(_e(t))?Bl:e},Wl=function(){function t(e){hl(this,t),this.measureText=e,this.current=0,this.width=0,this.height=0,this.lines=[]}return ul(t,[{key:"_add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";void 0===this.lines[t]&&(this.lines[t]={width:0,height:0,blocks:[]});var n=e;void 0!==e&&""!==e||(n=" ");var o=this.measureText(n,i),r=wt({},Hl(o));r.text=e,r.width=o.width,r.mod=i,void 0!==e&&""!==e||(r.width=0),this.lines[t].blocks.push(r),this.lines[t].width+=r.width}},{key:"curWidth",value:function(){var t=this.lines[this.current];return void 0===t?0:t.width}},{key:"append",value:function(t){this._add(this.current,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal")}},{key:"newLine",value:function(t){this._add(this.current,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal"),this.current++}},{key:"determineLineHeights",value:function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t],i=0;if(void 0!==e.blocks)for(var n=0;n<e.blocks.length;n++){var o=e.blocks[n];i<o.height&&(i=o.height)}e.height=i}}},{key:"determineLabelSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.width>t&&(t=n.width),e+=n.height}this.width=t,this.height=e}},{key:"removeEmptyBlocks",value:function(){for(var t=[],e=0;e<this.lines.length;e++){var i=this.lines[e];if(0!==i.blocks.length&&(e!==this.lines.length-1||0!==i.width)){var n={};wt(n,i),n.blocks=[];for(var o=void 0,r=[],s=0;s<i.blocks.length;s++){var a=i.blocks[s];0!==a.width?r.push(a):void 0===o&&(o=a)}0===r.length&&void 0!==o&&r.push(o),n.blocks=r,t.push(n)}}return t}},{key:"finalize",value:function(){this.determineLineHeights(),this.determineLabelSize();var t=this.removeEmptyBlocks();return{width:this.width,height:this.height,lines:t}}}]),t}(),ql={"<b>":/<b>/,"<i>":/<i>/,"<code>":/<code>/,"</b>":/<\/b>/,"</i>":/<\/i>/,"</code>":/<\/code>/,"*":/\*/,_:/\_/,"`":/`/,afterBold:/[^\*]/,afterItal:/[^_]/,afterMono:/[^`]/},Ul=function(){function t(e){hl(this,t),this.text=e,this.bold=!1,this.ital=!1,this.mono=!1,this.spacing=!1,this.position=0,this.buffer="",this.modStack=[],this.blocks=[]}return ul(t,[{key:"mod",value:function(){return 0===this.modStack.length?"normal":this.modStack[0]}},{key:"modName",value:function(){return 0===this.modStack.length?"normal":"mono"===this.modStack[0]?"mono":this.bold&&this.ital?"boldital":this.bold?"bold":this.ital?"ital":void 0}},{key:"emitBlock",value:function(){this.spacing&&(this.add(" "),this.spacing=!1),this.buffer.length>0&&(this.blocks.push({text:this.buffer,mod:this.modName()}),this.buffer="")}},{key:"add",value:function(t){" "===t&&(this.spacing=!0),this.spacing&&(this.buffer+=" ",this.spacing=!1)," "!=t&&(this.buffer+=t)}},{key:"parseWS",value:function(t){return!!/[ \t]/.test(t)&&(this.mono?this.add(t):this.spacing=!0,!0)}},{key:"setTag",value:function(t){this.emitBlock(),this[t]=!0,this.modStack.unshift(t)}},{key:"unsetTag",value:function(t){this.emitBlock(),this[t]=!1,this.modStack.shift()}},{key:"parseStartTag",value:function(t,e){return!(this.mono||this[t]||!this.match(e)||(this.setTag(t),0))}},{key:"match",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.prepareRegExp(t),n=jo(i,2),o=n[1],r=n[0].test(this.text.substr(this.position,o));return r&&e&&(this.position+=o-1),r}},{key:"parseEndTag",value:function(t,e,i){var n=this.mod()===t;return!(!(n="mono"===t?n&&this.mono:n&&!this.mono)||!this.match(e)||(void 0!==i?(this.position===this.text.length-1||this.match(i,!1))&&this.unsetTag(t):this.unsetTag(t),0))}},{key:"replace",value:function(t,e){return!!this.match(t)&&(this.add(e),this.position+=length-1,!0)}},{key:"prepareRegExp",value:function(t){var e,i;if(t instanceof RegExp)i=t,e=1;else{var n=ql[t];i=void 0!==n?n:new RegExp(t),e=t.length}return[i,e]}}]),t}(),Yl=function(){function t(e,i,n,o){var r=this;hl(this,t),this.ctx=e,this.parent=i,this.selected=n,this.hover=o,this.lines=new Wl(function(t,i){if(void 0===t)return 0;var s=r.parent.getFormattingValues(e,n,o,i),a=0;return""!==t&&(a=r.ctx.measureText(t).width),{width:a,values:s}})}return ul(t,[{key:"process",value:function(t){if(!Fl(t))return this.lines.finalize();var e=this.parent.fontOptions;t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");var i=String(t).split("\n"),n=i.length;if(e.multi)for(var o=0;o<n;o++){var r=this.splitBlocks(i[o],e.multi);if(void 0!==r)if(0!==r.length){if(e.maxWdt>0)for(var s=0;s<r.length;s++)this.splitStringIntoLines(r[s].text,r[s].mod,!0);else for(var a=0;a<r.length;a++)this.lines.append(r[a].text,r[a].mod);this.lines.newLine()}else this.lines.newLine("")}else if(e.maxWdt>0)for(var l=0;l<n;l++)this.splitStringIntoLines(i[l]);else for(var c=0;c<n;c++)this.lines.newLine(i[c]);return this.lines.finalize()}},{key:"decodeMarkupSystem",value:function(t){var e="none";return"markdown"===t||"md"===t?e="markdown":!0!==t&&"html"!==t||(e="html"),e}},{key:"splitHtmlBlocks",value:function(t){for(var e=new Ul(t),i=function(t){return!!/&/.test(t)&&(e.replace(e.text,"&lt;","<")||e.replace(e.text,"&amp;","&")||e.add("&"),!0)};e.position<e.text.length;){var n=e.text.charAt(e.position);e.parseWS(n)||/</.test(n)&&(e.parseStartTag("bold","<b>")||e.parseStartTag("ital","<i>")||e.parseStartTag("mono","<code>")||e.parseEndTag("bold","</b>")||e.parseEndTag("ital","</i>")||e.parseEndTag("mono","</code>"))||i(n)||e.add(n),e.position++}return e.emitBlock(),e.blocks}},{key:"splitMarkdownBlocks",value:function(t){for(var e=this,i=new Ul(t),n=!0,o=function(t){return!!/\\/.test(t)&&(i.position<e.text.length+1&&(i.position++,t=e.text.charAt(i.position),/ \t/.test(t)?i.spacing=!0:(i.add(t),n=!1)),!0)};i.position<i.text.length;){var r=i.text.charAt(i.position);i.parseWS(r)||o(r)||(n||i.spacing)&&(i.parseStartTag("bold","*")||i.parseStartTag("ital","_")||i.parseStartTag("mono","`"))||i.parseEndTag("bold","*","afterBold")||i.parseEndTag("ital","_","afterItal")||i.parseEndTag("mono","`","afterMono")||(i.add(r),n=!1),i.position++}return i.emitBlock(),i.blocks}},{key:"splitBlocks",value:function(t,e){var i=this.decodeMarkupSystem(e);return"none"===i?[{text:t,mod:"normal"}]:"markdown"===i?this.splitMarkdownBlocks(t):"html"===i?this.splitHtmlBlocks(t):void 0}},{key:"overMaxWidth",value:function(t){var e=this.ctx.measureText(t).width;return this.lines.curWidth()+e>this.parent.fontOptions.maxWdt}},{key:"getLongestFit",value:function(t){for(var e="",i=0;i<t.length;){var n=e+(""===e?"":" ")+t[i];if(this.overMaxWidth(n))break;e=n,i++}return i}},{key:"getLongestFitWord",value:function(t){for(var e=0;e<t.length&&!this.overMaxWidth(Jo(t).call(t,0,e));)e++;return e}},{key:"splitStringIntoLines",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.parent.getFormattingValues(this.ctx,this.selected,this.hover,e);for(var n=(t=(t=t.replace(/^( +)/g,"$1\r")).replace(/([^\r][^ ]*)( +)/g,"$1\r$2\r")).split("\r");n.length>0;){var o=this.getLongestFit(n);if(0===o){var r=n[0],s=this.getLongestFitWord(r);this.lines.newLine(Jo(r).call(r,0,s),e),n[0]=Jo(r).call(r,s)}else{var a=o;" "===n[o-1]?o--:" "===n[a]&&a++;var l=Jo(n).call(n,0,o).join("");o==n.length&&i?this.lines.append(l,e):this.lines.newLine(l,e),n=Jo(n).call(n,a)}}}}]),t}(),Gl=["bold","ital","boldital","mono"],Zl=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];hl(this,t),this.body=e,this.pointToSelf=!1,this.baseSize=void 0,this.fontOptions={},this.setOptions(i),this.size={top:0,left:0,width:0,height:0,yLine:0},this.isEdgeLabel=n}return ul(t,[{key:"setOptions",value:function(t){if(this.elementOptions=t,this.initFontOptions(t.font),Fl(t.label)?this.labelDirty=!0:t.label=void 0,null!=t.font)if("string"==typeof t.font)this.baseSize=this.fontOptions.size;else if("object"===Qo(t.font)){var e=t.font.size;void 0!==e&&(this.baseSize=e)}}},{key:"initFontOptions",value:function(e){var i=this;xr(Gl,function(t){i.fontOptions[t]={}}),t.parseFontString(this.fontOptions,e)?this.fontOptions.vadjust=0:xr(e,function(t,e){null!=t&&"object"!==Qo(t)&&(i.fontOptions[e]=t)})}},{key:"constrain",value:function(t){var e={constrainWidth:!1,maxWdt:-1,minWdt:-1,constrainHeight:!1,minHgt:-1,valign:"middle"},i=Fr(t,"widthConstraint");if("number"==typeof i)e.maxWdt=Number(i),e.minWdt=Number(i);else if("object"===Qo(i)){var n=Fr(t,["widthConstraint","maximum"]);"number"==typeof n&&(e.maxWdt=Number(n));var o=Fr(t,["widthConstraint","minimum"]);"number"==typeof o&&(e.minWdt=Number(o))}var r=Fr(t,"heightConstraint");if("number"==typeof r)e.minHgt=Number(r);else if("object"===Qo(r)){var s=Fr(t,["heightConstraint","minimum"]);"number"==typeof s&&(e.minHgt=Number(s));var a=Fr(t,["heightConstraint","valign"]);"string"==typeof a&&("top"!==a&&"bottom"!==a||(e.valign=a))}return e}},{key:"update",value:function(t,e){this.setOptions(t,!0),this.propagateFonts(e),br(this.fontOptions,this.constrain(e)),this.fontOptions.chooser=Rl("label",e)}},{key:"adjustSizes",value:function(t){var e=t?t.right+t.left:0;this.fontOptions.constrainWidth&&(this.fontOptions.maxWdt-=e,this.fontOptions.minWdt-=e),this.fontOptions.constrainHeight&&(this.fontOptions.minHgt-=t?t.top+t.bottom:0)}},{key:"addFontOptionsToPile",value:function(t,e){for(var i=0;i<e.length;++i)this.addFontToPile(t,e[i])}},{key:"addFontToPile",value:function(t,e){void 0!==e&&null!=e.font&&t.push(e.font)}},{key:"getBasicOptions",value:function(e){for(var i={},n=0;n<e.length;++n){var o=e[n],r={};t.parseFontString(r,o)&&(o=r),xr(o,function(t,e){void 0!==t&&(Object.prototype.hasOwnProperty.call(i,e)||(i[e]=-1!==go(Gl).call(Gl,e)?{}:t))})}return i}},{key:"getFontOption",value:function(e,i,n){for(var o,r=0;r<e.length;++r){var s=e[r];if(Object.prototype.hasOwnProperty.call(s,i)){if(null==(o=s[i]))continue;var a={};if(t.parseFontString(a,o)&&(o=a),Object.prototype.hasOwnProperty.call(o,n))return o[n]}}if(Object.prototype.hasOwnProperty.call(this.fontOptions,n))return this.fontOptions[n];throw new Error("Did not find value for multi-font for property: '"+n+"'")}},{key:"getFontOptions",value:function(t,e){for(var i={},n=["color","size","face","mod","vadjust"],o=0;o<n.length;++o){var r=n[o];i[r]=this.getFontOption(t,e,r)}return i}},{key:"propagateFonts",value:function(t){var e=this,i=[];this.addFontOptionsToPile(i,t),this.fontOptions=this.getBasicOptions(i);for(var n=function(t){var n=Gl[t],o=e.fontOptions[n];xr(e.getFontOptions(i,n),function(t,e){o[e]=t}),o.size=Number(o.size),o.vadjust=Number(o.vadjust)},o=0;o<Gl.length;++o)n(o)}},{key:"draw",value:function(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";if(void 0!==this.elementOptions.label){var s=this.fontOptions.size*this.body.view.scale;this.elementOptions.label&&s<this.elementOptions.scaling.label.drawThreshold-1||(s>=this.elementOptions.scaling.label.maxVisible&&(s=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale),this.calculateLabelSize(t,n,o,e,i,r),this._drawBackground(t),this._drawText(t,e,this.size.yLine,r,s))}}},{key:"_drawBackground",value:function(t){if(void 0!==this.fontOptions.background&&"none"!==this.fontOptions.background){t.fillStyle=this.fontOptions.background;var e=this.getSize();t.fillRect(e.left,e.top,e.width,e.height)}}},{key:"_drawText",value:function(t,e,i){var n=arguments.length>4?arguments[4]:void 0,o=this._setAlignment(t,e,i,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle"),r=jo(o,2);e=r[0],i=r[1],t.textAlign="left",e-=this.size.width/2,this.fontOptions.valign&&this.size.height>this.size.labelHeight&&("top"===this.fontOptions.valign&&(i-=(this.size.height-this.size.labelHeight)/2),"bottom"===this.fontOptions.valign&&(i+=(this.size.height-this.size.labelHeight)/2));for(var s=0;s<this.lineCount;s++){var a=this.lines[s];if(a&&a.blocks){var l=0;this.isEdgeLabel||"center"===this.fontOptions.align?l+=(this.size.width-a.width)/2:"right"===this.fontOptions.align&&(l+=this.size.width-a.width);for(var c=0;c<a.blocks.length;c++){var h=a.blocks[c];t.font=h.font;var d=this._getColor(h.color,n,h.strokeColor),u=jo(d,2),f=u[0],p=u[1];h.strokeWidth>0&&(t.lineWidth=h.strokeWidth,t.strokeStyle=p,t.lineJoin="round"),t.fillStyle=f,h.strokeWidth>0&&t.strokeText(h.text,e+l,i+h.vadjust),t.fillText(h.text,e+l,i+h.vadjust),l+=h.width}i+=a.height}}}},{key:"_setAlignment",value:function(t,e,i,n){return this.isEdgeLabel&&"horizontal"!==this.fontOptions.align&&!1===this.pointToSelf?(e=0,i=0,"top"===this.fontOptions.align?(t.textBaseline="alphabetic",i-=4):"bottom"===this.fontOptions.align?(t.textBaseline="hanging",i+=4):t.textBaseline="middle"):t.textBaseline=n,[e,i]}},{key:"_getColor",value:function(t,e,i){var n=t||"#000000",o=i||"#ffffff";if(e<=this.elementOptions.scaling.label.drawThreshold){var r=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-e)));n=Er(n,r),o=Er(o,r)}return[n,o]}},{key:"getTextSize",value:function(t){return this._processLabel(t,arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]),{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"getSize",value:function(){var t=this.size.left,e=this.size.top-1;if(this.isEdgeLabel){var i=.5*-this.size.width;switch(this.fontOptions.align){case"middle":t=i,e=.5*-this.size.height;break;case"top":t=i,e=-(this.size.height+2);break;case"bottom":t=i,e=2}}return{left:t,top:e,width:this.size.width,height:this.size.height}}},{key:"calculateLabelSize",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";this._processLabel(t,e,i),this.size.left=n-.5*this.size.width,this.size.top=o-.5*this.size.height,this.size.yLine=o+.5*(1-this.lineCount)*this.fontOptions.size,"hanging"===r&&(this.size.top+=.5*this.fontOptions.size,this.size.top+=4,this.size.yLine+=4)}},{key:"getFormattingValues",value:function(t,e,i,n){var o=function(t,e,i){return"normal"===e?"mod"===i?"":t[i]:void 0!==t[e][i]?t[e][i]:t[i]},r={color:o(this.fontOptions,n,"color"),size:o(this.fontOptions,n,"size"),face:o(this.fontOptions,n,"face"),mod:o(this.fontOptions,n,"mod"),vadjust:o(this.fontOptions,n,"vadjust"),strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};(e||i)&&("normal"===n&&!0===this.fontOptions.chooser&&this.elementOptions.labelHighlightBold?r.mod="bold":"function"==typeof this.fontOptions.chooser&&this.fontOptions.chooser(r,this.elementOptions.id,e,i));var s="";return void 0!==r.mod&&""!==r.mod&&(s+=r.mod+" "),t.font=(s+=r.size+"px "+r.face).replace(/"/g,""),r.font=t.font,r.height=r.size,r}},{key:"differentState",value:function(t,e){return t!==this.selectedState||e!==this.hoverState}},{key:"_processLabelText",value:function(t,e,i,n){return new Yl(t,this,e,i).process(n)}},{key:"_processLabel",value:function(t,e,i){if(!1!==this.labelDirty||this.differentState(e,i)){var n=this._processLabelText(t,e,i,this.elementOptions.label);this.fontOptions.minWdt>0&&n.width<this.fontOptions.minWdt&&(n.width=this.fontOptions.minWdt),this.size.labelHeight=n.height,this.fontOptions.minHgt>0&&n.height<this.fontOptions.minHgt&&(n.height=this.fontOptions.minHgt),this.lines=n.lines,this.lineCount=n.lines.length,this.size.width=n.width,this.size.height=n.height,this.selectedState=e,this.hoverState=i,this.labelDirty=!1}}},{key:"visible",value:function(){return 0!==this.size.width&&0!==this.size.height&&void 0!==this.elementOptions.label&&!(this.fontOptions.size*this.body.view.scale<this.elementOptions.scaling.label.drawThreshold-1)}}],[{key:"parseFontString",value:function(t,e){if(!e||"string"!=typeof e)return!1;var i=e.split(" ");return t.size=+i[0].replace("px",""),t.face=i[1],t.color=i[2],!0}}]),t}(),$l=Dt("Reflect","construct"),Xl=a(function(){function t(){}return!($l(function(){},[],t)instanceof t)}),Kl=!a(function(){$l(function(){})}),Ql=Xl||Kl;U({target:"Reflect",stat:!0,forced:Ql,sham:Ql},{construct:function(t,e){F(t),B(e);var i=arguments.length<3?t:F(arguments[2]);if(Kl&&!Xl)return $l(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new($.apply(t,n))}var o=i.prototype,r=re(b(o)?o:Object.prototype),s=Function.apply.call(t,r,e);return b(s)?s:r}});var Jl=z.Reflect.construct,tc=dn;U({target:"Object",stat:!0},{setPrototypeOf:Pi});var ec=z.Object.setPrototypeOf,ic=n(function(t){function e(i,n){return t.exports=e=ec||function(t,e){return t.__proto__=e,t},e(i,n)}t.exports=e}),nc=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=tc(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ic(t,e)},oc=function(t,e){return!e||"object"!==Qo(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e},rc=ro,sc=n(function(t){function e(i){return t.exports=e=ec?rc:function(t){return t.__proto__||rc(t)},e(i)}t.exports=e});U({target:"Array",proto:!0},{fill:function(t){for(var e=mt(this),i=ot(e.length),n=arguments.length,o=at(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:at(r,i);s>o;)e[o++]=t;return e}});var ac=X("Array").fill,lc=Array.prototype,cc=function(t){var e=t.fill;return t===lc||t instanceof Array&&e===lc.fill?ac:e},hc=function(){function t(e,i,n){hl(this,t),this.body=i,this.labelModule=n,this.setOptions(e),this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.radius=void 0,this.margin=void 0,this.refreshNeeded=!0,this.boundingBox={top:0,left:0,right:0,bottom:0}}return ul(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"_setMargins",value:function(t){this.margin={},this.options.margin&&("object"==Qo(this.options.margin)?(this.margin.top=this.options.margin.top,this.margin.right=this.options.margin.right,this.margin.bottom=this.options.margin.bottom,this.margin.left=this.options.margin.left):(this.margin.top=this.options.margin,this.margin.right=this.options.margin,this.margin.bottom=this.options.margin,this.margin.left=this.options.margin)),t.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function(t,e){var i=this.options.borderWidth;return t&&this.resize(t),Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}},{key:"enableShadow",value:function(t,e){e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"enableBorderDashes",value:function(t,e){if(!1!==e.borderDashes)if(void 0!==t.setLineDash){var i=e.borderDashes;!0===i&&(i=[5,15]),t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1}},{key:"disableBorderDashes",value:function(t,e){!1!==e.borderDashes&&(void 0!==t.setLineDash?t.setLineDash([0]):(console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1))}},{key:"needsRefresh",value:function(t,e){return!0===this.refreshNeeded?(this.refreshNeeded=!1,!0):void 0===this.width||this.labelModule.differentState(t,e)}},{key:"initContextForDraw",value:function(t,e){t.lineWidth=Math.min(this.width,e.borderWidth/this.body.view.scale),t.strokeStyle=e.borderColor,t.fillStyle=e.color}},{key:"performStroke",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.save(),i>0&&(this.enableBorderDashes(t,e),t.stroke(),this.disableBorderDashes(t,e)),t.restore()}},{key:"performFill",value:function(t,e){t.save(),t.fillStyle=e.color,this.enableShadow(t,e),cc(t).call(t),this.disableShadow(t,e),t.restore(),this.performStroke(t,e)}},{key:"_addBoundingBoxMargin",value:function(t){this.boundingBox.left-=t,this.boundingBox.top-=t,this.boundingBox.bottom+=t,this.boundingBox.right+=t}},{key:"_updateBoundingBox",value:function(t,e,i,n,o){void 0!==i&&this.resize(i,n,o),this.left=t-this.width/2,this.top=e-this.height/2,this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o)}},{key:"getDimensionsFromLabel",value:function(t,e,i){this.textSize=this.labelModule.getTextSize(t,e,i);var n=this.textSize.width,o=this.textSize.height;return 0===n&&(n=14,o=14),{width:n,height:o}}}]),t}(),dc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.width=n.width+this.margin.right+this.margin.left,this.height=n.height+this.margin.top+this.margin.bottom,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),_t(t,this.left,this.top,this.width,this.height,r.borderRadius),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o),this._addBoundingBoxMargin(this.options.shapeProperties.borderRadius)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}}]),i}(hc),uc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o)).labelOffset=0,r.selected=!1,r}return ul(i,[{key:"setOptions",value:function(t,e,i){this.options=t,void 0===e&&void 0===i||this.setImages(e,i)}},{key:"setImages",value:function(t,e){e&&this.selected?(this.imageObj=e,this.imageObjAlt=t):(this.imageObj=t,this.imageObjAlt=e)}},{key:"switchImages",value:function(t){var e=t&&!this.selected||!t&&this.selected;if(this.selected=t,void 0!==this.imageObjAlt&&e){var i=this.imageObj;this.imageObj=this.imageObjAlt,this.imageObjAlt=i}}},{key:"_getImagePadding",value:function(){var t={top:0,right:0,bottom:0,left:0};if(this.options.imagePadding){var e=this.options.imagePadding;"object"==Qo(e)?(t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left):(t.top=e,t.right=e,t.bottom=e,t.left=e)}return t}},{key:"_resizeImage",value:function(){var t,e;if(!1===this.options.shapeProperties.useImageSize){var i=1,n=1;this.imageObj.width&&this.imageObj.height&&(this.imageObj.width>this.imageObj.height?i=this.imageObj.width/this.imageObj.height:n=this.imageObj.height/this.imageObj.width),t=2*this.options.size*i,e=2*this.options.size*n}else{var o=this._getImagePadding();t=this.imageObj.width+o.left+o.right,e=this.imageObj.height+o.top+o.bottom}this.width=t,this.height=e,this.radius=.5*this.width}},{key:"_drawRawCircle",value:function(t,e,i,n){this.initContextForDraw(t,n),kt(t,e,i,n.size),this.performFill(t,n)}},{key:"_drawImageAtPosition",value:function(t,e){if(0!=this.imageObj.width){t.globalAlpha=void 0!==e.opacity?e.opacity:1,this.enableShadow(t,e);var i=1;!0===this.options.shapeProperties.interpolation&&(i=this.imageObj.width/this.width/this.body.view.scale);var n=this._getImagePadding();this.imageObj.drawImageAtPosition(t,i,this.left+n.left,this.top+n.top,this.width-n.left-n.right,this.height-n.top-n.bottom),this.disableShadow(t,e)}}},{key:"_drawImageLabel",value:function(t,e,i,n,o){var r=0;if(void 0!==this.height){r=.5*this.height;var s=this.labelModule.getTextSize(t,n,o);s.lineCount>=1&&(r+=s.height/2)}var a=i+r;this.options.label&&(this.labelOffset=r),this.labelModule.draw(t,e,a,n,o,"hanging")}}]),i}(hc),fc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i),o=Math.max(n.width+this.margin.right+this.margin.left,n.height+this.margin.top+this.margin.bottom);this.options.size=o/2,this.width=o,this.height=o,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this._drawRawCircle(t,e,i,r),this.updateBoundingBox(e,i),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,i,n,o)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size}},{key:"distanceToBorder",value:function(t,e){return t&&this.resize(t),.5*this.width}}]),i}(uc),pc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o,r,s){var a;return hl(this,i),(a=e.call(this,t,n,o)).setImages(r,s),a}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;return this.width=n,this.height=n,void(this.radius=.5*this.width)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){this.switchImages(n),this.resize();var s=e,a=i;"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),this._drawRawCircle(t,s,a,r),t.save(),t.clip(),this._drawImageAtPosition(t,r),t.restore(),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i)}},{key:"updateBoundingBox",value:function(t,e){"top-left"===this.options.shapeProperties.coordinateOrigin?(this.boundingBox.top=e,this.boundingBox.left=t,this.boundingBox.right=t+2*this.options.size,this.boundingBox.bottom=e+2*this.options.size):(this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size),this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function(t,e){return t&&this.resize(t),.5*this.width}}]),i}(uc);function gc(t,e){var i=Wo(t);if(ki){var n=ki(t);e&&(n=no(n).call(n,function(e){return Wt(t,e).enumerable})),i.push.apply(i,n)}return i}function mc(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nn(i=gc(Object(n),!0)).call(i,function(e){pn(t,e,n[e])});else if(Lt)Pt(t,Lt(n));else{var o;Nn(o=gc(Object(n))).call(o,function(e){Ot(t,e,Wt(n,e))})}}return t}var vc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:this.options.size};if(this.needsRefresh(e,i)){this.labelModule.getTextSize(t,e,i);var o=2*n.size;this.width=o,this.height=o,this.radius=.5*this.width}}},{key:"_drawShape",value:function(t,e,i,n,o,r,s,a,l){if(this.resize(t,r,s,a),this.left=n-this.width/2,this.top=o-this.height/2,"custom"===e)return t.save(),l({ctx:t,x:n,y:o,state:{selected:r,hover:s},style:mc({},a),label:this.options.label}),void t.restore();var c;this.initContextForDraw(t,a),(c=e,Object.prototype.hasOwnProperty.call(Tt,c)?Tt[c]:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];CanvasRenderingContext2D.prototype[c].call(t,i)})(t,n,o,a.size),this.performFill(t,a),void 0!==this.options.icon&&void 0!==this.options.icon.code&&(t.font=(r?"bold ":"")+this.height/2+"px "+(this.options.icon.face||"FontAwesome"),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.options.icon.code,n,o)),void 0!==this.options.label&&(this.labelModule.calculateLabelSize(t,r,s,n,o,"hanging"),this.labelModule.draw(t,n,o+.5*this.height+.5*this.labelModule.size.height,r,s,"hanging")),this.updateBoundingBox(n,o)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height))}}]),i}(hc),yc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o,r){var s;return hl(this,i),(s=e.call(this,t,n,o,r)).ctxRenderer=r,s}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"custom",4,e,i,n,o,r,this.ctxRenderer)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),bc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return ul(i,[{key:"resize",value:function(t,e,i){if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i).width+this.margin.right+this.margin.left;this.width=n,this.height=n,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),Ct(t,e-this.width/2,i-this.height/2,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(hc),wc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"diamond",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),kc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"circle",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return t&&this.resize(t),this.options.size}}]),i}(vc),_c=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.height=2*n.height,this.width=n.width+n.height,this.radius=.5*this.width}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-.5*this.width,this.top=i-.5*this.height,this.initContextForDraw(t,r),xt(t,this.left,this.top,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,e,i,n,o)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=.5*this.width,n=.5*this.height,o=Math.sin(e)*i,r=Math.cos(e)*n;return i*n/Math.sqrt(o*o+r*r)}}]),i}(hc),xc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return ul(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)},this.width=this.iconSize.width+this.margin.right+this.margin.left,this.height=this.iconSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.options.icon.size=this.options.icon.size||50,this.left=e-this.width/2,this.top=i-this.height/2,this._icon(t,e,i,n,o,r),void 0!==this.options.label&&this.labelModule.draw(t,this.left+this.iconSize.width/2+this.margin.left,i+this.height/2+5,n),this.updateBoundingBox(e,i)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-.5*this.options.icon.size,this.boundingBox.left=t-.5*this.options.icon.size,this.boundingBox.right=t+.5*this.options.icon.size,this.boundingBox.bottom=e+.5*this.options.icon.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+5))}},{key:"_icon",value:function(t,e,i,n,o,r){var s=Number(this.options.icon.size);void 0!==this.options.icon.code?(t.font=[null!=this.options.icon.weight?this.options.icon.weight:n?"bold":"",(null!=this.options.icon.weight&&n?5:0)+s+"px",this.options.icon.face].join(" "),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",this.enableShadow(t,r),t.fillText(this.options.icon.code,e,i),this.disableShadow(t,r)):console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(hc),Cc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o,r,s){var a;return hl(this,i),(a=e.call(this,t,n,o)).setImages(r,s),a}return ul(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;return this.width=n,void(this.height=n)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){t.save(),this.switchImages(n),this.resize();var s=e,a=i;if("top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),!0===this.options.shapeProperties.useBorderWithImage){t.lineWidth=Math.min(this.width,(n?this.options.borderWidthSelected||2*this.options.borderWidth:this.options.borderWidth)/this.body.view.scale),t.beginPath();var l=n?this.options.color.highlight.border:o?this.options.color.hover.border:this.options.color.border,c=n?this.options.color.highlight.background:o?this.options.color.hover.background:this.options.color.background;void 0!==r.opacity&&(l=Er(l,r.opacity),c=Er(c,r.opacity)),t.strokeStyle=l,t.fillStyle=c,t.rect(this.left-.5*t.lineWidth,this.top-.5*t.lineWidth,this.width+t.lineWidth,this.height+t.lineWidth),cc(t).call(t),this.performStroke(t,r),t.closePath()}this._drawImageAtPosition(t,r),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i),t.restore()}},{key:"updateBoundingBox",value:function(t,e){this.resize(),"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=e):(this.left=t-this.width/2,this.top=e-this.height/2),this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset))}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(uc),Ec=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"square",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),Tc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"hexagon",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),Sc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"star",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),Ac=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return ul(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.textSize=this.labelModule.getTextSize(t,e,i),this.width=this.textSize.width+this.margin.right+this.margin.left,this.height=this.textSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.enableShadow(t,r),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o),this.disableShadow(t,r),this.updateBoundingBox(e,i,t,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(hc),Oc=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"triangle",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),Ic=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"draw",value:function(t,e,i,n,o,r){this._drawShape(t,"triangleDown",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(vc),Pc=Dt("JSON","stringify"),Mc=/[\uD800-\uDFFF]/g,Dc=/^[\uD800-\uDBFF]$/,Nc=/^[\uDC00-\uDFFF]$/,Rc=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return Dc.test(t)&&!Nc.test(o)||Nc.test(t)&&!Dc.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},zc=a(function(){return'"\\udf06\\ud834"'!==Pc("\udf06\ud834")||'"\\udead"'!==Pc("\udead")});Pc&&U({target:"JSON",stat:!0,forced:zc},{stringify:function(t,e,i){var n=Pc.apply(null,arguments);return"string"==typeof n?n.replace(Mc,Rc):n}}),z.JSON||(z.JSON={stringify:JSON.stringify});var Fc,Lc=function(t,e,i){return z.JSON.stringify.apply(null,arguments)},Bc=!1,jc="background: #FFeeee; color: #dd0000",Vc=function(){function t(){hl(this,t)}return ul(t,null,[{key:"validate",value:function(e,i,n){Bc=!1,Fc=i;var o=i;return void 0!==n&&(o=i[n]),t.parse(e,o,[]),Bc}},{key:"parse",value:function(e,i,n){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.check(o,e,i,n)}},{key:"check",value:function(e,i,n,o){if(void 0!==n[e]||void 0!==n.__any__){var r=e,s=!0;void 0===n[e]&&void 0!==n.__any__&&(r="__any__",s="object"===t.getType(i[e]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,n,r,a,o)}else t.getSuggestion(e,n,o)}},{key:"checkFields",value:function(e,i,n,o,r,s){var a=function(i){console.log("%c"+i+t.printLocation(s,e),jc)},l=t.getType(i[e]),c=r[l];void 0!==c?"array"===t.getType(c)&&-1===go(c).call(c,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(c)+' not "'+i[e]+'". '),Bc=!0):"object"===l&&"__any__"!==o&&(s=wr(s,e),t.parse(i[e],n[o],s)):void 0===r.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(Wo(r))+". Received ["+l+'] "'+i[e]+'"'),Bc=!0)}},{key:"getType",value:function(t){var e=Qo(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Xo(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,n){var o,r=t.findInOptions(e,i,n,!1),s=t.findInOptions(e,Fc,[],!0);o=void 0!==r.indexMatch?" in "+t.printLocation(r.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+t.printLocation(r.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+t.printLocation(r.path,e):". Did you mean one of these: "+t.print(Wo(i))+t.printLocation(n,e),console.log('%cUnknown option detected: "'+e+'"'+o,jc),Bc=!0}},{key:"findInOptions",value:function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=e.toLowerCase(),c=void 0;for(var h in i){var d=void 0;if(void 0!==i[h].__type__&&!0===o){var u=t.findInOptions(e,i[h],wr(n,h));r>u.distance&&(s=u.closestMatch,a=u.path,r=u.distance,c=u.indexMatch)}else{var f;-1!==go(f=h.toLowerCase()).call(f,l)&&(c=h),r>(d=t.levenshteinDistance(e,h))&&(s=h,a=kr(n),r=d)}}return{closestMatch:s,path:a,distance:r,indexMatch:c}}},{key:"printLocation",value:function(t,e){for(var i="\n\n"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n")+"options = {\n",n=0;n<t.length;n++){for(var o=0;o<n+1;o++)i+="  ";i+=t[n]+": {\n"}for(var r=0;r<t.length+1;r++)i+="  ";i+=e+"\n";for(var s=0;s<t.length+1;s++){for(var a=0;a<t.length-s;a++)i+="  ";i+="}\n"}return i+"\n\n"}},{key:"print",value:function(t){return Lc(t).replace(/(\")|(\[)|(\])|(,"__type__")/g,"").replace(/(\,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n,o=[];for(i=0;i<=e.length;i++)o[i]=[i];for(n=0;n<=t.length;n++)o[0][n]=n;for(i=1;i<=e.length;i++)for(n=1;n<=t.length;n++)o[i][n]=e.charAt(i-1)==t.charAt(n-1)?o[i-1][n-1]:Math.min(o[i-1][n-1]+1,Math.min(o[i][n-1]+1,o[i-1][n]+1));return o[e.length][t.length]}}]),t}();function Hc(t,e){var i=Wo(t);if(ki){var n=ki(t);e&&(n=no(n).call(n,function(e){return Wt(t,e).enumerable})),i.push.apply(i,n)}return i}function Wc(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nn(i=Hc(Object(n),!0)).call(i,function(e){pn(t,e,n[e])});else if(Lt)Pt(t,Lt(n));else{var o;Nn(o=Hc(Object(n))).call(o,function(e){Ot(t,e,Wt(n,e))})}}return t}var qc=function(){function t(e,i,n,o,r,s){hl(this,t),this.options=Nr(r),this.globalOptions=r,this.defaultOptions=s,this.body=i,this.edges=[],this.id=void 0,this.imagelist=n,this.grouplist=o,this.x=void 0,this.y=void 0,this.baseSize=this.options.size,this.baseFontSize=this.options.font.size,this.predefinedPosition=!1,this.selected=!1,this.hover=!1,this.labelModule=new Zl(this.body,this.options,!1),this.setOptions(e)}return ul(t,[{key:"attachEdge",value:function(t){var e;-1===go(e=this.edges).call(e,t)&&this.edges.push(t)}},{key:"detachEdge",value:function(t){var e,i,n=go(e=this.edges).call(e,t);-1!=n&&qr(i=this.edges).call(i,n,1)}},{key:"setOptions",value:function(e){var i=this.options.shape;if(e){if(void 0!==e.color&&(this._localColor=e.color),void 0!==e.id&&(this.id=e.id),void 0===this.id)throw new Error("Node must have an id");return t.checkMass(e,this.id),void 0!==e.x&&(null===e.x?(this.x=void 0,this.predefinedPosition=!1):(this.x=Bn(e.x),this.predefinedPosition=!0)),void 0!==e.y&&(null===e.y?(this.y=void 0,this.predefinedPosition=!1):(this.y=Bn(e.y),this.predefinedPosition=!0)),void 0!==e.size&&(this.baseSize=e.size),void 0!==e.value&&(e.value=Nl(e.value)),t.parseOptions(this.options,e,!0,this.globalOptions,this.grouplist),this.chooser=Rl("node",[e,this.options,this.defaultOptions]),this._load_images(),this.updateLabelModule(e),void 0!==e.opacity&&t.checkOpacity(e.opacity)&&(this.options.opacity=e.opacity),this.updateShape(i),void 0!==e.hidden||void 0!==e.physics}}},{key:"_load_images",value:function(){if(("circularImage"===this.options.shape||"image"===this.options.shape)&&void 0===this.options.image)throw new Error("Option image must be defined for node type '"+this.options.shape+"'");if(void 0!==this.options.image){if(void 0===this.imagelist)throw new Error("Internal Error: No images provided");if("string"==typeof this.options.image)this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id);else{if(void 0===this.options.image.unselected)throw new Error("No unselected image provided");this.imageObj=this.imagelist.load(this.options.image.unselected,this.options.brokenImage,this.id),this.imageObjAlt=void 0!==this.options.image.selected?this.imagelist.load(this.options.image.selected,this.options.brokenImage,this.id):void 0}}}},{key:"getFormattingValues",value:function(){var t={color:this.options.color.background,opacity:this.options.opacity,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover?!0===this.chooser?this.selected?(t.borderWidth*=2,t.color=this.options.color.highlight.background,t.borderColor=this.options.color.highlight.border,t.shadow=this.options.shadow.enabled):this.hover&&(t.color=this.options.color.hover.background,t.borderColor=this.options.color.hover.border,t.shadow=this.options.shadow.enabled):"function"==typeof this.chooser&&(this.chooser(t,this.options.id,this.selected,this.hover),!1===t.shadow&&(t.shadowColor===this.options.shadow.color&&t.shadowSize===this.options.shadow.size&&t.shadowX===this.options.shadow.x&&t.shadowY===this.options.shadow.y||(t.shadow=!0))):t.shadow=this.options.shadow.enabled,void 0!==this.options.opacity){var e=this.options.opacity;t.borderColor=Er(t.borderColor,e),t.color=Er(t.color,e),t.shadowColor=Er(t.shadowColor,e)}return t}},{key:"updateLabelModule",value:function(e){null!=this.options.label||(this.options.label=""),t.updateGroupOptions(this.options,Wc(Wc({},e),{},{color:e&&e.color||this._localColor||void 0}),this.grouplist);var i=this.grouplist.get(this.options.group,!1);this.labelModule.update(this.options,[e,this.options,i,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateShape",value:function(t){if(t===this.options.shape&&this.shape)this.shape.setOptions(this.options,this.imageObj,this.imageObjAlt);else switch(this.options.shape){case"box":this.shape=new dc(this.options,this.body,this.labelModule);break;case"circle":this.shape=new fc(this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new pc(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"custom":this.shape=new yc(this.options,this.body,this.labelModule,this.options.ctxRenderer);break;case"database":this.shape=new bc(this.options,this.body,this.labelModule);break;case"diamond":this.shape=new wc(this.options,this.body,this.labelModule);break;case"dot":this.shape=new kc(this.options,this.body,this.labelModule);break;case"ellipse":this.shape=new _c(this.options,this.body,this.labelModule);break;case"icon":this.shape=new xc(this.options,this.body,this.labelModule);break;case"image":this.shape=new Cc(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"square":this.shape=new Ec(this.options,this.body,this.labelModule);break;case"hexagon":this.shape=new Tc(this.options,this.body,this.labelModule);break;case"star":this.shape=new Sc(this.options,this.body,this.labelModule);break;case"text":this.shape=new Ac(this.options,this.body,this.labelModule);break;case"triangle":this.shape=new Oc(this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new Ic(this.options,this.body,this.labelModule);break;default:this.shape=new _c(this.options,this.body,this.labelModule)}this.needsRefresh()}},{key:"select",value:function(){this.selected=!0,this.needsRefresh()}},{key:"unselect",value:function(){this.selected=!1,this.needsRefresh()}},{key:"needsRefresh",value:function(){this.shape.refreshNeeded=!0}},{key:"getTitle",value:function(){return this.options.title}},{key:"distanceToBorder",value:function(t,e){return this.shape.distanceToBorder(t,e)}},{key:"isFixed",value:function(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"getLabelSize",value:function(){return this.labelModule.size()}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.size=this.options.scaling.min+n*o}else this.options.size=this.baseSize,this.options.font.size=this.baseFontSize;this.updateLabelModule()}},{key:"draw",value:function(t){var e=this.getFormattingValues();this.shape.draw(t,this.x,this.y,this.selected,this.hover,e)}},{key:"updateBoundingBox",value:function(t){this.shape.updateBoundingBox(this.x,this.y,t)}},{key:"resize",value:function(t){var e=this.getFormattingValues();this.shape.resize(t,this.selected,this.hover,e)}},{key:"getItemsOnPoint",value:function(t){var e=[];return this.labelModule.visible()&&zl(this.labelModule.getSize(),t)&&e.push({nodeId:this.id,labelId:0}),zl(this.shape.boundingBox,t)&&e.push({nodeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return this.shape.left<t.right&&this.shape.left+this.shape.width>t.left&&this.shape.top<t.bottom&&this.shape.top+this.shape.height>t.top}},{key:"isBoundingBoxOverlappingWith",value:function(t){return this.shape.boundingBox.left<t.right&&this.shape.boundingBox.right>t.left&&this.shape.boundingBox.top<t.bottom&&this.shape.boundingBox.bottom>t.top}}],[{key:"checkOpacity",value:function(t){return 0<=t&&t<=1}},{key:"checkCoordinateOrigin",value:function(t){return void 0===t||"center"===t||"top-left"===t}},{key:"updateGroupOptions",value:function(e,i,n){var o;if(void 0!==n){var r=e.group;if(void 0!==i&&void 0!==i.group&&r!==i.group)throw new Error("updateGroupOptions: group values in options don't match.");if("number"==typeof r||"string"==typeof r&&""!=r){var s=n.get(r);void 0!==s.opacity&&void 0===i.opacity&&(t.checkOpacity(s.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+s.opacity),s.opacity=void 0));var a=no(o=function(t){return Il.getOwnPropertyNames(t)}(i)).call(o,function(t){return null!=i[t]});a.push("font"),yr(a,e,s),e.color=Sr(e.color)}}}},{key:"parseOptions",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;if(yr(["color","fixed","shadow"],e,i,n),t.checkMass(i),void 0!==e.opacity&&(t.checkOpacity(e.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+e.opacity),e.opacity=void 0)),void 0!==i.opacity&&(t.checkOpacity(i.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+i.opacity),i.opacity=void 0)),i.shapeProperties&&!t.checkCoordinateOrigin(i.shapeProperties.coordinateOrigin)&&console.error("Invalid option for node coordinateOrigin, found: "+i.shapeProperties.coordinateOrigin),Rr(e,i,"shadow",o),null!=i.color){var s=Sr(i.color);mr(e.color,s)}else!0===n&&null===i.color&&(e.color=Nr(o.color));null!=i.fixed&&("boolean"==typeof i.fixed?(e.fixed.x=i.fixed,e.fixed.y=i.fixed):(void 0!==i.fixed.x&&"boolean"==typeof i.fixed.x&&(e.fixed.x=i.fixed.x),void 0!==i.fixed.y&&"boolean"==typeof i.fixed.y&&(e.fixed.y=i.fixed.y))),!0===n&&null===i.font&&(e.font=Nr(o.font)),t.updateGroupOptions(e,i,r),void 0!==i.scaling&&Rr(e.scaling,i.scaling,"label",o.scaling)}},{key:"checkMass",value:function(t,e){if(void 0!==t.mass&&t.mass<=0){var i="";void 0!==e&&(i=" in node id: "+e),console.log("%cNegative or zero mass disallowed"+i+", setting mass to 1.",jc),t.mass=1}}}]),t}();function Uc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Yc=function(){function t(e,i,n,o){var r,s=this;if(hl(this,t),this.body=e,this.images=i,this.groups=n,this.layoutEngine=o,this.body.functions.createNode=J(r=this.create).call(r,this),this.nodesListeners={add:function(t,e){s.add(e.items)},update:function(t,e){s.update(e.items,e.data,e.oldData)},remove:function(t,e){s.remove(e.items)}},this.defaultOptions={borderWidth:1,borderWidthSelected:2,brokenImage:void 0,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},opacity:void 0,fixed:{x:!1,y:!1},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:!1,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"monospace",vadjust:2}},group:void 0,hidden:!1,icon:{face:"FontAwesome",code:void 0,size:50,color:"#2B7CE9"},image:void 0,imagePadding:{top:0,right:0,bottom:0,left:0},label:void 0,labelHighlightBold:!0,level:void 0,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:!0,scaling:{min:10,max:30,label:{enabled:!1,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:!1,borderRadius:6,interpolation:!0,useImageSize:!1,useBorderWithImage:!1,coordinateOrigin:"center"},size:25,title:void 0,value:void 0,x:void 0,y:void 0},this.defaultOptions.mass<=0)throw"Internal error: mass in defaultOptions of NodesHandler may not be zero or negative";this.options=Nr(this.defaultOptions),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("refreshNodes",J(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",J(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){xr(i.nodesListeners,function(t,e){i.body.data.nodes&&i.body.data.nodes.off(e,t)}),delete i.body.functions.createNode,delete i.nodesListeners.add,delete i.nodesListeners.update,delete i.nodesListeners.remove,delete i.nodesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){if(qc.parseOptions(this.options,t),void 0!==t.opacity&&(Sl(t.opacity)||!Tl(t.opacity)||t.opacity<0||t.opacity>1?console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+t.opacity):this.options.opacity=t.opacity),void 0!==t.shape)for(var e in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&this.body.nodes[e].updateShape();if(void 0!==t.font||void 0!==t.widthConstraint||void 0!==t.heightConstraint)for(var i=0,n=Wo(this.body.nodes);i<n.length;i++){var o=n[i];this.body.nodes[o].updateLabelModule(),this.body.nodes[o].needsRefresh()}if(void 0!==t.size)for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.body.nodes[r].needsRefresh();void 0===t.hidden&&void 0===t.physics||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.data.nodes;if(t instanceof e.DataSet||t instanceof e.DataView)this.body.data.nodes=t;else if(Xo(t))this.body.data.nodes=new e.DataSet,this.body.data.nodes.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.nodes=new e.DataSet}if(n&&xr(this.nodesListeners,function(t,e){n.off(e,t)}),this.body.nodes={},this.body.data.nodes){var o=this;xr(this.nodesListeners,function(t,e){o.body.data.nodes.on(e,t)});var r=this.body.data.nodes.getIds();this.add(r,!0)}!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],o=0;o<t.length;o++){var r=this.body.data.nodes.get(e=t[o]),s=this.create(r);n.push(s),this.body.nodes[e]=s}this.layoutEngine.positionInitially(n),!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t,e,i){for(var n=this.body.nodes,o=!1,r=0;r<t.length;r++){var s=t[r],a=n[s],l=e[r];void 0!==a?a.setOptions(l)&&(o=!0):(o=!0,a=this.create(l),n[s]=a)}o||void 0===i||(o=function(t){var e=t.some;return t===Cl||t instanceof Array&&e===Cl.some?xl:e}(e).call(e,function(t,e){var n=i[e];return n&&n.level!==t.level})),this.body.emitter.emit(!0===o?"_dataChanged":"_dataUpdated")}},{key:"remove",value:function(t){for(var e=this.body.nodes,i=0;i<t.length;i++)delete e[t[i]];this.body.emitter.emit("_dataChanged")}},{key:"create",value:function(t){return new(arguments.length>1&&void 0!==arguments[1]?arguments[1]:qc)(t,this.body,this.images,this.groups,this.options,this.defaultOptions)}},{key:"refresh",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];xr(this.body.nodes,function(i,n){var o=t.body.data.nodes.get(n);void 0!==o&&(!0===e&&i.setOptions({x:null,y:null}),i.setOptions({fixed:!1}),i.setOptions(o))})}},{key:"getPositions",value:function(t){var e={};if(void 0!==t){if(!0===Xo(t)){for(var i=0;i<t.length;i++)if(void 0!==this.body.nodes[t[i]]){var n=this.body.nodes[t[i]];e[t[i]]={x:Math.round(n.x),y:Math.round(n.y)}}}else if(void 0!==this.body.nodes[t]){var o=this.body.nodes[t];e[t]={x:Math.round(o.x),y:Math.round(o.y)}}}else for(var r=0;r<this.body.nodeIndices.length;r++){var s=this.body.nodes[this.body.nodeIndices[r]];e[this.body.nodeIndices[r]]={x:Math.round(s.x),y:Math.round(s.y)}}return e}},{key:"getPosition",value:function(t){if(null==t)throw new TypeError("No id was specified for getPosition method.");if(null==this.body.nodes[t])throw new ReferenceError("NodeId provided for getPosition does not exist. Provided: ".concat(t));return{x:Math.round(this.body.nodes[t].x),y:Math.round(this.body.nodes[t].y)}}},{key:"storePositions",value:function(){var t,e=[],i=this.body.data.nodes.getDataSet(),n=function(t,e){var i;if(void 0===nr||null==Xi(t)){if(Xo(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Uc(t,e);var n=Jo(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?ln(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Uc(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=$i(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(i.get());try{for(n.s();!(t=n.n()).done;){var o=t.value,r=o.id,s=this.body.nodes[r],a=Math.round(s.x),l=Math.round(s.y);o.x===a&&o.y===l||e.push({id:r,x:a,y:l})}}catch(t){n.e(t)}finally{n.f()}i.update(e)}},{key:"getBoundingBox",value:function(t){if(void 0!==this.body.nodes[t])return this.body.nodes[t].shape.boundingBox}},{key:"getConnectedNodes",value:function(t,e){var i=[];if(void 0!==this.body.nodes[t])for(var n=this.body.nodes[t],o={},r=0;r<n.edges.length;r++){var s=n.edges[r];"to"!==e&&s.toId==n.id?void 0===o[s.fromId]&&(i.push(s.fromId),o[s.fromId]=!0):"from"!==e&&s.fromId==n.id&&void 0===o[s.toId]&&(i.push(s.toId),o[s.toId]=!0)}return i}},{key:"getConnectedEdges",value:function(t){var e=[];if(void 0!==this.body.nodes[t])for(var i=this.body.nodes[t],n=0;n<i.edges.length;n++)e.push(i.edges[n].id);else console.log("NodeId provided for getConnectedEdges does not exist. Provided: ",t);return e}},{key:"moveNode",value:function(t,e,i){var n=this;void 0!==this.body.nodes[t]?(this.body.nodes[t].x=Number(e),this.body.nodes[t].y=Number(i),bl(function(){n.body.emitter.emit("startSimulation")},0)):console.log("Node id supplied to moveNode does not exist. Provided: ",t)}}]),t}(),Gc=Ht;U({target:"Reflect",stat:!0},{get:function t(e,i){var n,o,r=arguments.length<3?e:arguments[2];return B(e)===r?e[i]:(n=A.f(e,i))?_(n,"value")?n.value:void 0===n.get?void 0:n.get.call(r):b(o=Ti(e))?t(o,i,r):void 0}});var Zc=z.Reflect.get,$c=n(function(t){function e(i,n,o){return t.exports=e="undefined"!=typeof Reflect&&Zc?Zc:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sc(t)););return t}(t,e);if(n){var o=Gc(n,e);return o.get?o.get.call(i):o.value}},e(i,n,o||i)}t.exports=e}),Xc=Math.hypot,Kc=Math.abs,Qc=Math.sqrt,Jc=!!Xc&&Xc(1/0,NaN)!==1/0;U({target:"Math",stat:!0,forced:Jc},{hypot:function(t,e){for(var i,n,o=0,r=0,s=arguments.length,a=0;r<s;)a<(i=Kc(arguments[r++]))?(o=o*(n=a/i)*n+1,a=i):o+=i>0?(n=i/a)*n:i;return a===1/0?1/0:a*Qc(o)}});var th=z.Math.hypot;function eh(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}var ih=function(){function t(){hl(this,t)}return ul(t,null,[{key:"transform",value:function(t,e){Xo(t)||(t=[t]);for(var i=e.point.x,n=e.point.y,o=e.angle,r=e.length,s=0;s<t.length;++s){var a=t[s],l=a.x*Math.cos(o)-a.y*Math.sin(o),c=a.x*Math.sin(o)+a.y*Math.cos(o);a.x=i+r*l,a.y=n+r*c}}},{key:"drawPath",value:function(t,e){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath()}}]),t}(),nh=function(t){nc(i,t);var e=eh(i);function i(){return hl(this,i),e.apply(this,arguments)}return ul(i,null,[{key:"draw",value:function(t,e){if(e.image){t.save(),t.translate(e.point.x,e.point.y),t.rotate(Math.PI/2+e.angle);var i=null!=e.imageWidth?e.imageWidth:e.image.width;e.image.drawImageAtPosition(t,1,-i/2,0,i,null!=e.imageHeight?e.imageHeight:e.image.height),t.restore()}return!1}}]),i}(ih),oh=function(t){nc(i,t);var e=eh(i);function i(){return hl(this,i),e.apply(this,arguments)}return ul(i,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-1,y:.3},{x:-.9,y:0},{x:-1,y:-.3}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),i}(ih),rh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:0},{x:0,y:.3},{x:-.4,y:0},{x:0,y:-.3}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),sh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};ih.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle-n/2,r=e.angle+n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),ah=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i={x:-.3,y:0};ih.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle+n/2,r=e.angle+3*n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),lh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:.02,y:0},{x:-1,y:.3},{x:-1,y:-.3}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),ch=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-1,y:0}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),hh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};return ih.transform(i,e),kt(t,i.x,i.y,.4*e.length),!0}}]),t}(),dh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.5},{x:0,y:-.5},{x:-.15,y:-.5},{x:-.15,y:.5}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),uh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-.6,y:-.3},{x:-.6,y:.3}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),fh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-.5,y:-.3},{x:-1,y:0},{x:-.5,y:.3}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),ph=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:.3},{x:-.5,y:0},{x:-1,y:-.3},{x:0,y:0}];return ih.transform(i,e),ih.drawPath(t,i),!0}}]),t}(),gh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"draw",value:function(t,e){var i;switch(e.type&&(i=e.type.toLowerCase()),i){case"image":return nh.draw(t,e);case"circle":return hh.draw(t,e);case"box":return uh.draw(t,e);case"crow":return rh.draw(t,e);case"curve":return sh.draw(t,e);case"diamond":return fh.draw(t,e);case"inv_curve":return ah.draw(t,e);case"triangle":return lh.draw(t,e);case"inv_triangle":return ch.draw(t,e);case"bar":return dh.draw(t,e);case"vee":return ph.draw(t,e);case"arrow":default:return oh.draw(t,e)}}}]),t}();function mh(t,e){var i=Wo(t);if(ki){var n=ki(t);e&&(n=no(n).call(n,function(e){return Wt(t,e).enumerable})),i.push.apply(i,n)}return i}function vh(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nn(i=mh(Object(n),!0)).call(i,function(e){pn(t,e,n[e])});else if(Lt)Pt(t,Lt(n));else{var o;Nn(o=mh(Object(n))).call(o,function(e){Ot(t,e,Wt(n,e))})}}return t}var yh=function(){function t(e,i,n){hl(this,t),this._body=i,this._labelModule=n,this.color={},this.colorDirty=!0,this.hoverWidth=1.5,this.selectionWidth=2,this.setOptions(e),this.fromPoint=this.from,this.toPoint=this.to}return ul(t,[{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to]}},{key:"cleanup",value:function(){return!1}},{key:"setOptions",value:function(t){this.options=t,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.id=this.options.id}},{key:"drawLine",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getViaNode();t.strokeStyle=this.getColor(t,e),t.lineWidth=e.width,!1!==e.dashes?this._drawDashedLine(t,e,o):this._drawLine(t,e,o)}},{key:"_drawLine",value:function(t,e,i,n,o){if(this.from!=this.to)this._line(t,e,i,n,o);else{var r=this._getCircleData(t),s=jo(r,3);this._circle(t,e,s[0],s[1],s[2])}}},{key:"_drawDashedLine",value:function(t,e,i,n,o){t.lineCap="round";var r=Xo(e.dashes)?e.dashes:[5,5];if(void 0!==t.setLineDash){if(t.save(),t.setLineDash(r),t.lineDashOffset=0,this.from!=this.to)this._line(t,e,i);else{var s=this._getCircleData(t),a=jo(s,3);this._circle(t,e,a[0],a[1],a[2])}t.setLineDash([0]),t.lineDashOffset=0,t.restore()}else{if(this.from!=this.to)Et(t,this.from.x,this.from.y,this.to.x,this.to.y,r);else{var l=this._getCircleData(t),c=jo(l,3);this._circle(t,e,c[0],c[1],c[2])}this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}}},{key:"findBorderPosition",value:function(t,e,i){return this.from!=this.to?this._findBorderPosition(t,e,i):this._findBorderPositionCircle(t,e,i)}},{key:"findBorderPositions",value:function(t){if(this.from!=this.to)return{from:this._findBorderPosition(this.from,t),to:this._findBorderPosition(this.to,t)};var e,i=Jo(e=this._getCircleData(t)).call(e,0,2),n=jo(i,2),o=n[0],r=n[1];return{from:this._findBorderPositionCircle(this.from,t,{x:o,y:r,low:.25,high:.6,direction:-1}),to:this._findBorderPositionCircle(this.from,t,{x:o,y:r,low:.6,high:.8,direction:1})}}},{key:"_getCircleData",value:function(t){var e=this.options.selfReference.size;void 0!==t&&void 0===this.from.shape.width&&this.from.shape.resize(t);var i=Ll(t,this.options.selfReference.angle,e,this.from);return[i.x,i.y,e]}},{key:"_pointOnCircle",value:function(t,e,i,n){var o=2*n*Math.PI;return{x:t+i*Math.cos(o),y:e-i*Math.sin(o)}}},{key:"_findBorderPositionCircle",value:function(t,e,i){var n,o=i.x,r=i.y,s=i.low,a=i.high,l=i.direction,c=this.options.selfReference.size,h=.5*(s+a),d=0;!0===this.options.arrowStrikethrough&&(-1===l?d=this.options.endPointOffset.from:1===l&&(d=this.options.endPointOffset.to));var u=0;do{n=this._pointOnCircle(o,r,c,h=.5*(s+a));var f=Math.atan2(t.y-n.y,t.x-n.x),p=t.distanceToBorder(e,f)+d-Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));if(Math.abs(p)<.05)break;p>0?l>0?s=h:a=h:l>0?a=h:s=h,++u}while(s<=a&&u<10);return vh(vh({},n),{},{t:h})}},{key:"getLineWidth",value:function(t,e){return!0===t?Math.max(this.selectionWidth,.3/this._body.view.scale):!0===e?Math.max(this.hoverWidth,.3/this._body.view.scale):Math.max(this.options.width,.3/this._body.view.scale)}},{key:"getColor",value:function(t,e){if(!1!==e.inheritsColor){if("both"===e.inheritsColor&&this.from.id!==this.to.id){var i=t.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y),n=this.from.options.color.highlight.border,o=this.to.options.color.highlight.border;return!1===this.from.selected&&!1===this.to.selected?(n=Er(this.from.options.color.border,e.opacity),o=Er(this.to.options.color.border,e.opacity)):!0===this.from.selected&&!1===this.to.selected?o=this.to.options.color.border:!1===this.from.selected&&!0===this.to.selected&&(n=this.from.options.color.border),i.addColorStop(0,n),i.addColorStop(1,o),i}return Er("to"===e.inheritsColor?this.to.options.color.border:this.from.options.color.border,e.opacity)}return Er(e.color,e.opacity)}},{key:"_circle",value:function(t,e,i,n,o){this.enableShadow(t,e);var r=0,s=2*Math.PI;if(!this.options.selfReference.renderBehindTheNode){var a=this.options.selfReference.angle,l=this.options.selfReference.angle+Math.PI,c=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:-1}),h=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:1});r=Math.atan2(c.y-n,c.x-i),s=Math.atan2(h.y-n,h.x-i)}t.beginPath(),t.arc(i,n,o,r,s,!1),t.stroke(),this.disableShadow(t,e)}},{key:"getDistanceToEdge",value:function(t,e,i,n,o,r){if(this.from!=this.to)return this._getDistanceToEdge(t,e,i,n,o,r);var s=this._getCircleData(void 0),a=jo(s,3),l=a[2],c=a[0]-o,h=a[1]-r;return Math.abs(Math.sqrt(c*c+h*h)-l)}},{key:"_getDistanceToLine",value:function(t,e,i,n,o,r){var s=i-t,a=n-e,l=((o-t)*s+(r-e)*a)/(s*s+a*a);l>1?l=1:l<0&&(l=0);var c=t+l*s-o,h=e+l*a-r;return Math.sqrt(c*c+h*h)}},{key:"getArrowData",value:function(t,e,i,n,o,r){var s,a,l,c,h,d,u,f=r.width;"from"===e?(l=this.from,c=this.to,h=r.fromArrowScale<0,d=Math.abs(r.fromArrowScale),u=r.fromArrowType):"to"===e?(l=this.to,c=this.from,h=r.toArrowScale<0,d=Math.abs(r.toArrowScale),u=r.toArrowType):(l=this.to,c=this.from,h=r.middleArrowScale<0,d=Math.abs(r.middleArrowScale),u=r.middleArrowType);var p=15*d+3*f;if(l!=c){var g=p/th(l.x-c.x,l.y-c.y);if("middle"!==e)if(!0===this.options.smooth.enabled){var m=this._findBorderPosition(l,t,{via:i}),v=this.getPoint(m.t+g*("from"===e?1:-1),i);s=Math.atan2(m.y-v.y,m.x-v.x),a=m}else s=Math.atan2(l.y-c.y,l.x-c.x),a=this._findBorderPosition(l,t);else{var y=(h?-g:g)/2,b=this.getPoint(.5+y,i),w=this.getPoint(.5-y,i);s=Math.atan2(b.y-w.y,b.x-w.x),a=this.getPoint(.5,i)}}else{var k=this._getCircleData(t),_=jo(k,3),x=_[0],C=_[1],E=_[2];if("from"===e){var T=this.options.selfReference.angle+Math.PI,S=this._findBorderPositionCircle(this.from,t,{x:x,y:C,low:this.options.selfReference.angle,high:T,direction:-1});s=-2*S.t*Math.PI+1.5*Math.PI+.1*Math.PI,a=S}else if("to"===e){var A=this.options.selfReference.angle+Math.PI,O=this._findBorderPositionCircle(this.from,t,{x:x,y:C,low:this.options.selfReference.angle,high:A,direction:1});s=-2*O.t*Math.PI+1.5*Math.PI-1.1*Math.PI,a=O}else{var I=this.options.selfReference.angle/(2*Math.PI);a=this._pointOnCircle(x,C,E,I),s=-2*I*Math.PI+1.5*Math.PI+.1*Math.PI}}return{point:a,core:{x:a.x-.9*p*Math.cos(s),y:a.y-.9*p*Math.sin(s)},angle:s,length:p,type:u}}},{key:"drawArrowHead",value:function(t,e,i,n,o){t.strokeStyle=this.getColor(t,e),t.fillStyle=t.strokeStyle,t.lineWidth=e.width,gh.draw(t,o)&&(this.enableShadow(t,e),cc(t).call(t),this.disableShadow(t,e))}},{key:"enableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"drawBackground",value:function(t,e){if(!1!==e.background){var i={strokeStyle:t.strokeStyle,lineWidth:t.lineWidth,dashes:t.dashes};t.strokeStyle=e.backgroundColor,t.lineWidth=e.backgroundSize,this.setStrokeDashed(t,e.backgroundDashes),t.stroke(),t.strokeStyle=i.strokeStyle,t.lineWidth=i.lineWidth,t.dashes=i.dashes,this.setStrokeDashed(t,e.dashes)}}},{key:"setStrokeDashed",value:function(t,e){if(!1!==e)if(void 0!==t.setLineDash){var i=Xo(e)?e:[5,5];t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.");else void 0!==t.setLineDash?t.setLineDash([]):console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}}]),t}();function bh(t,e){var i=Wo(t);if(ki){var n=ki(t);e&&(n=no(n).call(n,function(e){return Wt(t,e).enumerable})),i.push.apply(i,n)}return i}function wh(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nn(i=bh(Object(n),!0)).call(i,function(e){pn(t,e,n[e])});else if(Lt)Pt(t,Lt(n));else{var o;Nn(o=bh(Object(n))).call(o,function(e){Ot(t,e,Wt(n,e))})}}return t}var kh=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_findBorderPositionBezier",value:function(t,e){var i,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getViaCoordinates(),r=10,s=.2,a=!1,l=1,c=0,h=this.to,d=this.options.endPointOffset?this.options.endPointOffset.to:0;t.id===this.from.id&&(h=this.from,a=!0,d=this.options.endPointOffset?this.options.endPointOffset.from:0),!1===this.options.arrowStrikethrough&&(d=0);var u=0;do{i=this.getPoint(n=.5*(c+l),o);var f=Math.atan2(h.y-i.y,h.x-i.x),p=h.distanceToBorder(e,f)+d-Math.sqrt(Math.pow(i.x-h.x,2)+Math.pow(i.y-h.y,2));if(Math.abs(p)<s)break;p<0?!1===a?c=n:l=n:!1===a?l=n:c=n,++u}while(c<=l&&u<r);return wh(wh({},i),{},{t:n})}},{key:"_getDistanceToBezierEdge",value:function(t,e,i,n,o,r,s){var a,l,c,h,d,u=1e9,f=t,p=e;for(l=1;l<10;l++)c=.1*l,h=Math.pow(1-c,2)*t+2*c*(1-c)*s.x+Math.pow(c,2)*i,d=Math.pow(1-c,2)*e+2*c*(1-c)*s.y+Math.pow(c,2)*n,l>0&&(u=(a=this._getDistanceToLine(f,p,h,d,o,r))<u?a:u),f=h,p=d;return u}},{key:"_bezierCurve",value:function(t,e,i,n){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),null!=i&&null!=i.x?null!=n&&null!=n.x?t.bezierCurveTo(i.x,i.y,n.x,n.y,this.toPoint.x,this.toPoint.y):t.quadraticCurveTo(i.x,i.y,this.toPoint.x,this.toPoint.y):t.lineTo(this.toPoint.x,this.toPoint.y),this.drawBackground(t,e),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}}]),i}(yh),_h=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o)).via=r.via,r._boundFunction=function(){r.positionBezierNode()},r._body.emitter.on("_repositionBezierNodes",r._boundFunction),r}return ul(i,[{key:"setOptions",value:function(t){$c(sc(i.prototype),"setOptions",this).call(this,t);var e=!1;this.options.physics!==t.physics&&(e=!0),this.options=t,this.id=this.options.id,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.setupSupportNode(),this.connect(),!0===e&&(this.via.setOptions({physics:this.options.physics}),this.positionBezierNode())}},{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.via.setOptions(void 0===this.from||void 0===this.to||!1===this.options.physics||this.from.id===this.to.id?{physics:!1}:{physics:!0})}},{key:"cleanup",value:function(){return this._body.emitter.off("_repositionBezierNodes",this._boundFunction),void 0!==this.via&&(delete this._body.nodes[this.via.id],this.via=void 0,!0)}},{key:"setupSupportNode",value:function(){if(void 0===this.via){var t="edgeId:"+this.id,e=this._body.functions.createNode({id:t,shape:"circle",physics:!0,hidden:!0});this._body.nodes[t]=e,this.via=e,this.via.parentEdgeId=this.id,this.positionBezierNode()}}},{key:"positionBezierNode",value:function(){void 0!==this.via&&void 0!==this.from&&void 0!==this.to?(this.via.x=.5*(this.from.x+this.to.x),this.via.y=.5*(this.from.y+this.to.y)):void 0!==this.via&&(this.via.x=0,this.via.y=0)}},{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"_getViaCoordinates",value:function(){return this.via}},{key:"getViaNode",value:function(){return this.via}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.via;if(this.from===this.to){var i=this._getCircleData(),n=jo(i,3),o=n[1],r=n[2],s=2*Math.PI*(1-t);return{x:n[0]+r*Math.sin(s),y:o+r-r*(1-Math.cos(s))}}return{x:Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*e.x+Math.pow(t,2)*this.toPoint.x,y:Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*e.y+Math.pow(t,2)*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,this.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToBezierEdge(t,e,i,n,o,r,this.via)}}]),i}(kh),xh=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function(){var t,e,i=this.options.smooth.roundness,n=this.options.smooth.type,o=Math.abs(this.from.x-this.to.x),r=Math.abs(this.from.y-this.to.y);if("discrete"===n||"diagonalCross"===n){var s,a;s=a=o<=r?i*r:i*o,this.from.x>this.to.x&&(s=-s),this.from.y>=this.to.y&&(a=-a);var l=this.from.x+s,c=this.from.y+a;return"discrete"===n&&(o<=r?l=o<i*r?this.from.x:l:c=r<i*o?this.from.y:c),{x:l,y:c}}if("straightCross"===n){var h=(1-i)*o,d=(1-i)*r;return o<=r?(h=0,this.from.y<this.to.y&&(d=-d)):(this.from.x<this.to.x&&(h=-h),d=0),{x:this.to.x+h,y:this.to.y+d}}if("horizontal"===n){var u=(1-i)*o;return this.from.x<this.to.x&&(u=-u),{x:this.to.x+u,y:this.from.y}}if("vertical"===n){var f=(1-i)*r;return this.from.y<this.to.y&&(f=-f),{x:this.from.x,y:this.to.y+f}}if("curvedCW"===n){o=this.to.x-this.from.x,r=this.from.y-this.to.y;var p=Math.sqrt(o*o+r*r),g=Math.PI,m=(Math.atan2(r,o)+(.5*i+.5)*g)%(2*g);return{x:this.from.x+(.5*i+.5)*p*Math.sin(m),y:this.from.y+(.5*i+.5)*p*Math.cos(m)}}if("curvedCCW"===n){o=this.to.x-this.from.x,r=this.from.y-this.to.y;var v=Math.sqrt(o*o+r*r),y=Math.PI,b=(Math.atan2(r,o)+(.5*-i+.5)*y)%(2*y);return{x:this.from.x+(.5*i+.5)*v*Math.sin(b),y:this.from.y+(.5*i+.5)*v*Math.cos(b)}}t=e=o<=r?i*r:i*o,this.from.x>this.to.x&&(t=-t),this.from.y>=this.to.y&&(e=-e);var w=this.from.x+t,k=this.from.y+e;return o<=r?w=this.from.x<=this.to.x?this.to.x<w?this.to.x:w:this.to.x>w?this.to.x:w:k=this.from.y>=this.to.y?this.to.y>k?this.to.y:k:this.to.y<k?this.to.y:k,{x:w,y:k}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(t,e,i,n,o,r,s)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),i=t;return{x:Math.pow(1-i,2)*this.fromPoint.x+2*i*(1-i)*e.x+Math.pow(i,2)*this.toPoint.x,y:Math.pow(1-i,2)*this.fromPoint.y+2*i*(1-i)*e.y+Math.pow(i,2)*this.toPoint.y}}}]),i}(kh),Ch=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i[0],i[1])}},{key:"_getViaCoordinates",value:function(){var t,e,i,n,o=this.from.x-this.to.x,r=this.from.y-this.to.y,s=this.options.smooth.roundness;return(Math.abs(o)>Math.abs(r)||!0===this.options.smooth.forceDirection||"horizontal"===this.options.smooth.forceDirection)&&"vertical"!==this.options.smooth.forceDirection?(e=this.from.y,n=this.to.y,t=this.from.x-s*o,i=this.to.x+s*o):(e=this.from.y-s*r,n=this.to.y+s*r,t=this.from.x,i=this.to.x),[{x:t,y:e},{x:i,y:n}]}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates(),a=jo(s,2);return this._getDistanceToBezierEdge2(t,e,i,n,o,r,a[0],a[1])}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),i=jo(e,2),n=i[0],o=i[1],r=t,s=[Math.pow(1-r,3),3*r*Math.pow(1-r,2),3*Math.pow(r,2)*(1-r),Math.pow(r,3)];return{x:s[0]*this.fromPoint.x+s[1]*n.x+s[2]*o.x+s[3]*this.toPoint.x,y:s[0]*this.fromPoint.y+s[1]*n.y+s[2]*o.y+s[3]*this.toPoint.y}}}]),i}(function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_getDistanceToBezierEdge2",value:function(t,e,i,n,o,r,s,a){for(var l=1e9,c=t,h=e,d=[0,0,0,0],u=1;u<10;u++){var f=.1*u;d[0]=Math.pow(1-f,3),d[1]=3*f*Math.pow(1-f,2),d[2]=3*Math.pow(f,2)*(1-f),d[3]=Math.pow(f,3);var p=d[0]*t+d[1]*s.x+d[2]*a.x+d[3]*i,g=d[0]*e+d[1]*s.y+d[2]*a.y+d[3]*n;if(u>0){var m=this._getDistanceToLine(c,h,p,g,o,r);l=m<l?m:l}c=p,h=g}return l}}]),i}(kh)),Eh=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_line",value:function(t,e){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),t.lineTo(this.toPoint.x,this.toPoint.y),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){}},{key:"getPoint",value:function(t){return{x:(1-t)*this.fromPoint.x+t*this.toPoint.x,y:(1-t)*this.fromPoint.y+t*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){var i=this.to,n=this.from;t.id===this.from.id&&(i=this.from,n=this.to);var o=Math.atan2(i.y-n.y,i.x-n.x),r=i.x-n.x,s=i.y-n.y,a=Math.sqrt(r*r+s*s),l=(a-t.distanceToBorder(e,o))/a;return{x:(1-l)*n.x+l*i.x,y:(1-l)*n.y+l*i.y,t:0}}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToLine(t,e,i,n,o,r)}}]),i}(yh),Th=function(){function t(e,i,n,o,r){if(hl(this,t),void 0===i)throw new Error("No body provided");this.options=Nr(o),this.globalOptions=o,this.defaultOptions=r,this.body=i,this.imagelist=n,this.id=void 0,this.fromId=void 0,this.toId=void 0,this.selected=!1,this.hover=!1,this.labelDirty=!0,this.baseWidth=this.options.width,this.baseFontSize=this.options.font.size,this.from=void 0,this.to=void 0,this.edgeType=void 0,this.connected=!1,this.labelModule=new Zl(this.body,this.options,!0),this.setOptions(e)}return ul(t,[{key:"setOptions",value:function(e){if(e){var i=void 0!==e.physics&&this.options.physics!==e.physics||void 0!==e.hidden&&(this.options.hidden||!1)!==(e.hidden||!1)||void 0!==e.from&&this.options.from!==e.from||void 0!==e.to&&this.options.to!==e.to;return t.parseOptions(this.options,e,!0,this.globalOptions),void 0!==e.id&&(this.id=e.id),void 0!==e.from&&(this.fromId=e.from),void 0!==e.to&&(this.toId=e.to),void 0!==e.title&&(this.title=e.title),void 0!==e.value&&(e.value=Nl(e.value)),this.chooser=Rl("edge",[e,this.options,this.defaultOptions]),this.updateLabelModule(e),i=this.updateEdgeType()||i,this._setInteractionWidths(),this.connect(),i}}},{key:"getFormattingValues",value:function(){var t=this.options.color.inherit,e={toArrow:!0===this.options.arrows.to||!0===this.options.arrows.to.enabled,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,toArrowSrc:this.options.arrows.to.src,toArrowImageWidth:this.options.arrows.to.imageWidth,toArrowImageHeight:this.options.arrows.to.imageHeight,middleArrow:!0===this.options.arrows.middle||!0===this.options.arrows.middle.enabled,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,middleArrowSrc:this.options.arrows.middle.src,middleArrowImageWidth:this.options.arrows.middle.imageWidth,middleArrowImageHeight:this.options.arrows.middle.imageHeight,fromArrow:!0===this.options.arrows.from||!0===this.options.arrows.from.enabled,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,fromArrowSrc:this.options.arrows.from.src,fromArrowImageWidth:this.options.arrows.from.imageWidth,fromArrowImageHeight:this.options.arrows.from.imageHeight,arrowStrikethrough:this.options.arrowStrikethrough,color:t?void 0:this.options.color.color,inheritsColor:t,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width,background:this.options.background.enabled,backgroundColor:this.options.background.color,backgroundSize:this.options.background.size,backgroundDashes:this.options.background.dashes};if(this.selected||this.hover)if(!0===this.chooser){if(this.selected){var i=this.options.selectionWidth;"function"==typeof i?e.width=i(e.width):"number"==typeof i&&(e.width+=i),e.width=Math.max(e.width,.3/this.body.view.scale),e.color=this.options.color.highlight,e.shadow=this.options.shadow.enabled}else if(this.hover){var n=this.options.hoverWidth;"function"==typeof n?e.width=n(e.width):"number"==typeof n&&(e.width+=n),e.width=Math.max(e.width,.3/this.body.view.scale),e.color=this.options.color.hover,e.shadow=this.options.shadow.enabled}}else"function"==typeof this.chooser&&(this.chooser(e,this.options.id,this.selected,this.hover),void 0!==e.color&&(e.inheritsColor=!1),!1===e.shadow&&(e.shadowColor===this.options.shadow.color&&e.shadowSize===this.options.shadow.size&&e.shadowX===this.options.shadow.x&&e.shadowY===this.options.shadow.y||(e.shadow=!0)));else e.shadow=this.options.shadow.enabled,e.width=Math.max(e.width,.3/this.body.view.scale);return e}},{key:"updateLabelModule",value:function(t){this.labelModule.update(this.options,[t,this.options,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateEdgeType",value:function(){var t=this.options.smooth,e=!1,i=!0;return void 0!==this.edgeType&&((this.edgeType instanceof _h&&!0===t.enabled&&"dynamic"===t.type||this.edgeType instanceof Ch&&!0===t.enabled&&"cubicBezier"===t.type||this.edgeType instanceof xh&&!0===t.enabled&&"dynamic"!==t.type&&"cubicBezier"!==t.type||this.edgeType instanceof Eh&&!1===t.type.enabled)&&(i=!1),!0===i&&(e=this.cleanup())),!0===i?!0===t.enabled?"dynamic"===t.type?(e=!0,this.edgeType=new _h(this.options,this.body,this.labelModule)):this.edgeType="cubicBezier"===t.type?new Ch(this.options,this.body,this.labelModule):new xh(this.options,this.body,this.labelModule):this.edgeType=new Eh(this.options,this.body,this.labelModule):this.edgeType.setOptions(this.options),e}},{key:"connect",value:function(){this.disconnect(),this.from=this.body.nodes[this.fromId]||void 0,this.to=this.body.nodes[this.toId]||void 0,this.connected=void 0!==this.from&&void 0!==this.to,!0===this.connected?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this)),this.edgeType.connect()}},{key:"disconnect",value:function(){this.from&&(this.from.detachEdge(this),this.from=void 0),this.to&&(this.to.detachEdge(this),this.to=void 0),this.connected=!1}},{key:"getTitle",value:function(){return this.title}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.width=this.options.scaling.min+n*o}else this.options.width=this.baseWidth,this.options.font.size=this.baseFontSize;this._setInteractionWidths(),this.updateLabelModule()}},{key:"_setInteractionWidths",value:function(){this.edgeType.hoverWidth="function"==typeof this.options.hoverWidth?this.options.hoverWidth(this.options.width):this.options.hoverWidth+this.options.width,this.edgeType.selectionWidth="function"==typeof this.options.selectionWidth?this.options.selectionWidth(this.options.width):this.options.selectionWidth+this.options.width}},{key:"draw",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode();this.edgeType.drawLine(t,e,this.selected,this.hover,i),this.drawLabel(t,i)}}},{key:"drawArrows",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode(),n={};this.edgeType.fromPoint=this.edgeType.from,this.edgeType.toPoint=this.edgeType.to,e.fromArrow&&(n.from=this.edgeType.getArrowData(t,"from",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.fromPoint=n.from.core),e.fromArrowSrc&&(n.from.image=this.imagelist.load(e.fromArrowSrc)),e.fromArrowImageWidth&&(n.from.imageWidth=e.fromArrowImageWidth),e.fromArrowImageHeight&&(n.from.imageHeight=e.fromArrowImageHeight)),e.toArrow&&(n.to=this.edgeType.getArrowData(t,"to",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.toPoint=n.to.core),e.toArrowSrc&&(n.to.image=this.imagelist.load(e.toArrowSrc)),e.toArrowImageWidth&&(n.to.imageWidth=e.toArrowImageWidth),e.toArrowImageHeight&&(n.to.imageHeight=e.toArrowImageHeight)),e.middleArrow&&(n.middle=this.edgeType.getArrowData(t,"middle",i,this.selected,this.hover,e),e.middleArrowSrc&&(n.middle.image=this.imagelist.load(e.middleArrowSrc)),e.middleArrowImageWidth&&(n.middle.imageWidth=e.middleArrowImageWidth),e.middleArrowImageHeight&&(n.middle.imageHeight=e.middleArrowImageHeight)),e.fromArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.from),e.middleArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.middle),e.toArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.to)}}},{key:"drawLabel",value:function(t,e){if(void 0!==this.options.label){var i,n=this.from,o=this.to;if(this.labelModule.differentState(this.selected,this.hover)&&this.labelModule.getTextSize(t,this.selected,this.hover),n.id!=o.id){this.labelModule.pointToSelf=!1,i=this.edgeType.getPoint(.5,e),t.save();var r=this._getRotation(t);0!=r.angle&&(t.translate(r.x,r.y),t.rotate(r.angle)),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover),t.restore()}else{this.labelModule.pointToSelf=!0;var s=Ll(t,this.options.selfReference.angle,this.options.selfReference.size,n);i=this._pointOnCircle(s.x,s.y,this.options.selfReference.size,this.options.selfReference.angle),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover)}}}},{key:"getItemsOnPoint",value:function(t){var e=[];if(this.labelModule.visible()){var i=this._getRotation();zl(this.labelModule.getSize(),t,i)&&e.push({edgeId:this.id,labelId:0})}return this.isOverlappingWith({left:t.x,top:t.y})&&e.push({edgeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return!!this.connected&&this.edgeType.getDistanceToEdge(this.from.x,this.from.y,this.to.x,this.to.y,t.left,t.top)<10}},{key:"_getRotation",value:function(t){var e=this.edgeType.getViaNode(),i=this.edgeType.getPoint(.5,e);void 0!==t&&this.labelModule.calculateLabelSize(t,this.selected,this.hover,i.x,i.y);var n={x:i.x,y:this.labelModule.size.yLine,angle:0};if(!this.labelModule.visible())return n;if("horizontal"===this.options.font.align)return n;var o=this.from.x-this.to.x,r=Math.atan2(this.from.y-this.to.y,o);return(r<-1&&o<0||r>0&&o<0)&&(r+=Math.PI),n.angle=r,n}},{key:"_pointOnCircle",value:function(t,e,i,n){return{x:t+i*Math.cos(n),y:e-i*Math.sin(n)}}},{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"cleanup",value:function(){return this.edgeType.cleanup()}},{key:"remove",value:function(){this.cleanup(),this.disconnect(),delete this.body.edges[this.id]}},{key:"endPointsValid",value:function(){return void 0!==this.body.nodes[this.fromId]&&void 0!==this.body.nodes[this.toId]}}],[{key:"parseOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(vr(["endPointOffset","arrowStrikethrough","id","from","hidden","hoverWidth","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","selfReference","to","title","value","width","font","chosen","widthConstraint"],t,e,i),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.from&&(Tl(e.endPointOffset.from)?t.endPointOffset.from=e.endPointOffset.from:(t.endPointOffset.from=void 0!==n.endPointOffset.from?n.endPointOffset.from:0,console.error("endPointOffset.from is not a valid number"))),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.to&&(Tl(e.endPointOffset.to)?t.endPointOffset.to=e.endPointOffset.to:(t.endPointOffset.to=void 0!==n.endPointOffset.to?n.endPointOffset.to:0,console.error("endPointOffset.to is not a valid number"))),Fl(e.label)?t.label=e.label:Fl(t.label)||(t.label=void 0),Rr(t,e,"smooth",n),Rr(t,e,"shadow",n),Rr(t,e,"background",n),null!=e.dashes?t.dashes=e.dashes:!0===i&&null===e.dashes&&(t.dashes=un(n.dashes)),null!=e.scaling?(void 0!==e.scaling.min&&(t.scaling.min=e.scaling.min),void 0!==e.scaling.max&&(t.scaling.max=e.scaling.max),Rr(t.scaling,e.scaling,"label",n.scaling)):!0===i&&null===e.scaling&&(t.scaling=un(n.scaling)),null!=e.arrows)if("string"==typeof e.arrows){var r=e.arrows.toLowerCase();t.arrows.to.enabled=-1!=go(r).call(r,"to"),t.arrows.middle.enabled=-1!=go(r).call(r,"middle"),t.arrows.from.enabled=-1!=go(r).call(r,"from")}else{if("object"!==Qo(e.arrows))throw new Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+Lc(e.arrows));Rr(t.arrows,e.arrows,"to",n.arrows),Rr(t.arrows,e.arrows,"middle",n.arrows),Rr(t.arrows,e.arrows,"from",n.arrows)}else!0===i&&null===e.arrows&&(t.arrows=un(n.arrows));if(null!=e.color){var s=fr(e.color)?{color:e.color,highlight:e.color,hover:e.color,inherit:!1,opacity:1}:e.color,a=t.color;if(o)br(a,n.color,!1,i);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&delete a[l];if(fr(a))a.color=a,a.highlight=a,a.hover=a,a.inherit=!1,void 0===s.opacity&&(a.opacity=1);else{var c=!1;void 0!==s.color&&(a.color=s.color,c=!0),void 0!==s.highlight&&(a.highlight=s.highlight,c=!0),void 0!==s.hover&&(a.hover=s.hover,c=!0),void 0!==s.inherit&&(a.inherit=s.inherit),void 0!==s.opacity&&(a.opacity=Math.min(1,Math.max(0,s.opacity))),!0===c?a.inherit=!1:void 0===a.inherit&&(a.inherit="from")}}else!0===i&&null===e.color&&(t.color=Nr(n.color));!0===i&&null===e.font&&(t.font=Nr(n.font)),Object.prototype.hasOwnProperty.call(e,"selfReferenceSize")&&(console.log("The selfReferenceSize property has been deprecated. Please use selfReference property instead. The selfReference can be set like thise selfReference:{size:30, angle:Math.PI / 4}"),t.selfReference.size=e.selfReferenceSize)}}]),t}(),Sh=function(){function t(e,i,n){var o,r=this;hl(this,t),this.body=e,this.images=i,this.groups=n,this.body.functions.createEdge=J(o=this.create).call(o,this),this.edgesListeners={add:function(t,e){r.add(e.items)},update:function(t,e){r.update(e.items)},remove:function(t,e){r.remove(e.items)}},this.options={},this.defaultOptions={arrows:{to:{enabled:!1,scaleFactor:1,type:"arrow"},middle:{enabled:!1,scaleFactor:1,type:"arrow"},from:{enabled:!1,scaleFactor:1,type:"arrow"}},endPointOffset:{from:0,to:0},arrowStrikethrough:!0,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:!1,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:!1,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:!1,hoverWidth:1.5,label:void 0,labelHighlightBold:!0,length:void 0,physics:!0,scaling:{min:1,max:15,label:{enabled:!0,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},selectionWidth:1.5,selfReference:{size:20,angle:Math.PI/4,renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},background:{enabled:!1,color:"rgba(111,111,111,1)",size:10,dashes:!1},smooth:{enabled:!0,type:"dynamic",forceDirection:"none",roundness:.5},title:void 0,width:1,value:void 0},br(this.options,this.defaultOptions),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("_forceDisableDynamicCurves",function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"dynamic"===t&&(t="continuous");var n=!1;for(var o in i.body.edges)if(Object.prototype.hasOwnProperty.call(i.body.edges,o)){var r=i.body.edges[o],s=i.body.data.edges.get(o);if(null!=s){var a=s.smooth;void 0!==a&&!0===a.enabled&&"dynamic"===a.type&&(r.setOptions(void 0===t?{smooth:!1}:{smooth:{type:t}}),n=!0)}}!0===e&&!0===n&&i.body.emitter.emit("_dataChanged")}),this.body.emitter.on("_dataUpdated",function(){i.reconnectEdges()}),this.body.emitter.on("refreshEdges",J(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",J(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){xr(i.edgesListeners,function(t,e){i.body.data.edges&&i.body.data.edges.off(e,t)}),delete i.body.functions.createEdge,delete i.edgesListeners.add,delete i.edgesListeners.update,delete i.edgesListeners.remove,delete i.edgesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){Th.parseOptions(this.options,t,!0,this.defaultOptions,!0);var e=!1;if(void 0!==t.smooth)for(var i in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,i)&&(e=this.body.edges[i].updateEdgeType()||e);if(void 0!==t.font)for(var n in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,n)&&this.body.edges[n].updateLabelModule();void 0===t.hidden&&void 0===t.physics&&!0!==e||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.data.edges;if(t instanceof e.DataSet||t instanceof e.DataView)this.body.data.edges=t;else if(Xo(t))this.body.data.edges=new e.DataSet,this.body.data.edges.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.edges=new e.DataSet}if(o&&xr(this.edgesListeners,function(t,e){o.off(e,t)}),this.body.edges={},this.body.data.edges){xr(this.edgesListeners,function(t,e){i.body.data.edges.on(e,t)});var r=this.body.data.edges.getIds();this.add(r,!0)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===n&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.edges,n=this.body.data.edges,o=0;o<t.length;o++){var r=t[o],s=i[r];s&&s.disconnect();var a=n.get(r,{showInternalIds:!0});i[r]=this.create(a)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===e&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t){for(var e=this.body.edges,i=this.body.data.edges,n=!1,o=0;o<t.length;o++){var r=t[o],s=i.get(r),a=e[r];void 0!==a?(a.disconnect(),n=a.setOptions(s)||n,a.connect()):(this.body.edges[r]=this.create(s),n=!0)}!0===n?(this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),this.body.emitter.emit("_dataChanged")):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==t.length){var i=this.body.edges;xr(t,function(t){var e=i[t];void 0!==e&&e.remove()}),e&&this.body.emitter.emit("_dataChanged")}}},{key:"refresh",value:function(){var t=this;xr(this.body.edges,function(e,i){var n=t.body.data.edges.get(i);void 0!==n&&e.setOptions(n)})}},{key:"create",value:function(t){return new Th(t,this.body,this.images,this.options,this.defaultOptions)}},{key:"reconnectEdges",value:function(){var t,e=this.body.nodes,i=this.body.edges;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t].edges=[]);for(t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var n=i[t];n.from=null,n.to=null,n.connect()}}},{key:"getConnectedNodes",value:function(t){var e=[];if(void 0!==this.body.edges[t]){var i=this.body.edges[t];void 0!==i.fromId&&e.push(i.fromId),void 0!==i.toId&&e.push(i.toId)}return e}},{key:"_updateState",value:function(){this._addMissingEdges(),this._removeInvalidEdges()}},{key:"_removeInvalidEdges",value:function(){var t=this,e=[];xr(this.body.edges,function(i,n){var o=t.body.nodes[i.toId],r=t.body.nodes[i.fromId];void 0!==o&&!0===o.isCluster||void 0!==r&&!0===r.isCluster||void 0!==o&&void 0!==r||e.push(n)}),this.remove(e,!1)}},{key:"_addMissingEdges",value:function(){var t=this.body.data.edges;if(null!=t){var e=this.body.edges,i=[];Nn(t).call(t,function(t,n){void 0===e[n]&&i.push(n)}),this.add(i,!0)}}}]),t}(),Ah=function(){function t(e,i,n){hl(this,t),this.body=e,this.physicsBody=i,this.setOptions(n),this._rng=rr("BARNES HUT SOLVER")}return ul(t,[{key:"setOptions",value:function(t){this.options=t,this.thetaInversed=1/this.options.theta,this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"solve",value:function(){if(0!==this.options.gravitationalConstant&&this.physicsBody.physicsNodeIndices.length>0){var t,e=this.body.nodes,i=this.physicsBody.physicsNodeIndices,n=i.length,o=this._formBarnesHutTree(e,i);this.barnesHutTree=o;for(var r=0;r<n;r++)(t=e[i[r]]).options.mass>0&&this._getForceContributions(o.root,t)}}},{key:"_getForceContributions",value:function(t,e){this._getForceContribution(t.children.NW,e),this._getForceContribution(t.children.NE,e),this._getForceContribution(t.children.SW,e),this._getForceContribution(t.children.SE,e)}},{key:"_getForceContribution",value:function(t,e){if(t.childrenCount>0){var i=t.centerOfMass.x-e.x,n=t.centerOfMass.y-e.y,o=Math.sqrt(i*i+n*n);o*t.calcSize>this.thetaInversed?this._calculateForces(o,i,n,e,t):4===t.childrenCount?this._getForceContributions(t,e):t.children.data.id!=e.id&&this._calculateForces(o,i,n,e,t)}}},{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=this.options.gravitationalConstant*o.mass*n.options.mass/Math.pow(t,3),s=i*r;this.physicsBody.forces[n.id].x+=e*r,this.physicsBody.forces[n.id].y+=s}},{key:"_formBarnesHutTree",value:function(t,e){for(var i,n=e.length,o=t[e[0]].x,r=t[e[0]].y,s=t[e[0]].x,a=t[e[0]].y,l=1;l<n;l++){var c=t[e[l]],h=c.x,d=c.y;c.options.mass>0&&(h<o&&(o=h),h>s&&(s=h),d<r&&(r=d),d>a&&(a=d))}var u=Math.abs(s-o)-Math.abs(a-r);u>0?(r-=.5*u,a+=.5*u):(o+=.5*u,s-=.5*u);var f=Math.max(1e-5,Math.abs(s-o)),p=.5*f,g=.5*(o+s),m=.5*(r+a),v={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:g-p,maxX:g+p,minY:m-p,maxY:m+p},size:f,calcSize:1/f,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(v.root);for(var y=0;y<n;y++)(i=t[e[y]]).options.mass>0&&this._placeInTree(v.root,i);return v}},{key:"_updateBranchMass",value:function(t,e){var i=t.centerOfMass,n=t.mass+e.options.mass,o=1/n;i.x=i.x*t.mass+e.x*e.options.mass,i.x*=o,i.y=i.y*t.mass+e.y*e.options.mass,i.y*=o,t.mass=n;var r=Math.max(Math.max(e.height,e.radius),e.width);t.maxWidth=t.maxWidth<r?r:t.maxWidth}},{key:"_placeInTree",value:function(t,e,i){1==i&&void 0!==i||this._updateBranchMass(t,e);var n=t.children.NW.range;this._placeInRegion(t,e,n.maxX>e.x?n.maxY>e.y?"NW":"SW":n.maxY>e.y?"NE":"SE")}},{key:"_placeInRegion",value:function(t,e,i){var n=t.children[i];switch(n.childrenCount){case 0:n.children.data=e,n.childrenCount=1,this._updateBranchMass(n,e);break;case 1:n.children.data.x===e.x&&n.children.data.y===e.y?(e.x+=this._rng(),e.y+=this._rng()):(this._splitBranch(n),this._placeInTree(n,e));break;case 4:this._placeInTree(n,e)}}},{key:"_splitBranch",value:function(t){var e=null;1===t.childrenCount&&(e=t.children.data,t.mass=0,t.centerOfMass.x=0,t.centerOfMass.y=0),t.childrenCount=4,t.children.data=null,this._insertRegion(t,"NW"),this._insertRegion(t,"NE"),this._insertRegion(t,"SW"),this._insertRegion(t,"SE"),null!=e&&this._placeInTree(t,e)}},{key:"_insertRegion",value:function(t,e){var i,n,o,r,s=.5*t.size;switch(e){case"NW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY,r=t.range.minY+s;break;case"NE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY,r=t.range.minY+s;break;case"SW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY+s,r=t.range.maxY;break;case"SE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY+s,r=t.range.maxY}t.children[e]={centerOfMass:{x:0,y:0},mass:0,range:{minX:i,maxX:n,minY:o,maxY:r},size:.5*t.size,calcSize:2*t.calcSize,children:{data:null},maxWidth:0,level:t.level+1,childrenCount:0}}},{key:"_debug",value:function(t,e){void 0!==this.barnesHutTree&&(t.lineWidth=1,this._drawBranch(this.barnesHutTree.root,t,e))}},{key:"_drawBranch",value:function(t,e,i){void 0===i&&(i="#FF0000"),4===t.childrenCount&&(this._drawBranch(t.children.NW,e),this._drawBranch(t.children.NE,e),this._drawBranch(t.children.SE,e),this._drawBranch(t.children.SW,e)),e.strokeStyle=i,e.beginPath(),e.moveTo(t.range.minX,t.range.minY),e.lineTo(t.range.maxX,t.range.minY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.minY),e.lineTo(t.range.maxX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.maxY),e.lineTo(t.range.minX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.minX,t.range.maxY),e.lineTo(t.range.minX,t.range.minY),e.stroke()}}]),t}(),Oh=function(){function t(e,i,n){hl(this,t),this._rng=rr("REPULSION SOLVER"),this.body=e,this.physicsBody=i,this.setOptions(n)}return ul(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l=this.body.nodes,c=this.physicsBody.physicsNodeIndices,h=this.physicsBody.forces,d=this.options.nodeDistance,u=-2/3/d,f=0;f<c.length-1;f++){s=l[c[f]];for(var p=f+1;p<c.length;p++)t=(a=l[c[p]]).x-s.x,e=a.y-s.y,0===(i=Math.sqrt(t*t+e*e))&&(t=i=.1*this._rng()),i<2*d&&(r=i<.5*d?1:u*i+4/3,n=t*(r/=i),o=e*r,h[s.id].x-=n,h[s.id].y-=o,h[a.id].x+=n,h[a.id].y+=o)}}}]),t}(),Ih=function(){function t(e,i,n){hl(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return ul(t,[{key:"setOptions",value:function(t){this.options=t,this.overlapAvoidanceFactor=Math.max(0,Math.min(1,this.options.avoidOverlap||0))}},{key:"solve",value:function(){for(var t=this.body.nodes,e=this.physicsBody.physicsNodeIndices,i=this.physicsBody.forces,n=this.options.nodeDistance,o=0;o<e.length-1;o++)for(var r=t[e[o]],s=o+1;s<e.length;s++){var a=t[e[s]];if(r.level===a.level){var l=n+this.overlapAvoidanceFactor*((r.shape.radius||0)/2+(a.shape.radius||0)/2),c=a.x-r.x,h=a.y-r.y,d=Math.sqrt(c*c+h*h),u=void 0;u=d<l?-Math.pow(.05*d,2)+Math.pow(.05*l,2):0,0!==d&&(u/=d);var f=c*u,p=h*u;i[r.id].x-=f,i[r.id].y-=p,i[a.id].x+=f,i[a.id].y+=p}}}}]),t}(),Ph=function(){function t(e,i,n){hl(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return ul(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o=this.physicsBody.physicsEdgeIndices,r=this.body.edges,s=0;s<o.length;s++)!0===(e=r[o[s]]).connected&&e.toId!==e.fromId&&void 0!==this.body.nodes[e.toId]&&void 0!==this.body.nodes[e.fromId]&&(void 0!==e.edgeType.via?(n=e.from,this._calculateSpringForce(e.to,i=e.edgeType.via,.5*(t=void 0===e.options.length?this.options.springLength:e.options.length)),this._calculateSpringForce(i,n,.5*t)):this._calculateSpringForce(e.from,e.to,t=void 0===e.options.length?1.5*this.options.springLength:e.options.length))}},{key:"_calculateSpringForce",value:function(t,e,i){var n=t.x-e.x,o=t.y-e.y,r=Math.max(Math.sqrt(n*n+o*o),.01),s=this.options.springConstant*(i-r)/r,a=n*s,l=o*s;void 0!==this.physicsBody.forces[t.id]&&(this.physicsBody.forces[t.id].x+=a,this.physicsBody.forces[t.id].y+=l),void 0!==this.physicsBody.forces[e.id]&&(this.physicsBody.forces[e.id].x-=a,this.physicsBody.forces[e.id].y-=l)}}]),t}(),Mh=function(){function t(e,i,n){hl(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return ul(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l,c,h=this.body.edges,d=this.physicsBody.physicsEdgeIndices,u=this.physicsBody.physicsNodeIndices,f=this.physicsBody.forces,p=0;p<u.length;p++){var g=u[p];f[g].springFx=0,f[g].springFy=0}for(var m=0;m<d.length;m++)!0===(e=h[d[m]]).connected&&(t=void 0===e.options.length?this.options.springLength:e.options.length,i=e.from.x-e.to.x,n=e.from.y-e.to.y,a=0===(a=Math.sqrt(i*i+n*n))?.01:a,o=i*(s=this.options.springConstant*(t-a)/a),r=n*s,e.to.level!=e.from.level?(void 0!==f[e.toId]&&(f[e.toId].springFx-=o,f[e.toId].springFy-=r),void 0!==f[e.fromId]&&(f[e.fromId].springFx+=o,f[e.fromId].springFy+=r)):(void 0!==f[e.toId]&&(f[e.toId].x-=.5*o,f[e.toId].y-=.5*r),void 0!==f[e.fromId]&&(f[e.fromId].x+=.5*o,f[e.fromId].y+=.5*r)));s=1;for(var v=0;v<u.length;v++){var y=u[v];l=Math.min(s,Math.max(-s,f[y].springFx)),c=Math.min(s,Math.max(-s,f[y].springFy)),f[y].x+=l,f[y].y+=c}for(var b=0,w=0,k=0;k<u.length;k++){var _=u[k];b+=f[_].x,w+=f[_].y}for(var x=b/u.length,C=w/u.length,E=0;E<u.length;E++){var T=u[E];f[T].x-=x,f[T].y-=C}}}]),t}(),Dh=function(){function t(e,i,n){hl(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return ul(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o=this.body.nodes,r=this.physicsBody.physicsNodeIndices,s=this.physicsBody.forces,a=0;a<r.length;a++)t=-(n=o[r[a]]).x,e=-n.y,i=Math.sqrt(t*t+e*e),this._calculateForces(i,t,e,s,n)}},{key:"_calculateForces",value:function(t,e,i,n,o){var r=0===t?0:this.options.centralGravity/t;n[o.id].x=e*r,n[o.id].y=i*r}}]),t}(),Nh=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){var r;return hl(this,i),(r=e.call(this,t,n,o))._rng=rr("FORCE ATLAS 2 BASED REPULSION SOLVER"),r}return ul(i,[{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1*this._rng()),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=this.options.gravitationalConstant*o.mass*n.options.mass*(n.edges.length+1)/Math.pow(t,2),s=i*r;this.physicsBody.forces[n.id].x+=e*r,this.physicsBody.forces[n.id].y+=s}}]),i}(Ah),Rh=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o){return hl(this,i),e.call(this,t,n,o)}return ul(i,[{key:"_calculateForces",value:function(t,e,i,n,o){if(t>0){var r=this.options.centralGravity*(o.edges.length+1)*o.options.mass;n[o.id].x=e*r,n[o.id].y=i*r}}}]),i}(Dh),zh=function(){function t(e){hl(this,t),this.body=e,this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}},this.physicsEnabled=!0,this.simulationInterval=1e3/60,this.requiresTimeout=!0,this.previousStates={},this.referenceState={},this.freezeCache={},this.renderTimer=void 0,this.adaptiveTimestep=!1,this.adaptiveTimestepEnabled=!1,this.adaptiveCounter=0,this.adaptiveInterval=3,this.stabilized=!1,this.startedStabilization=!1,this.stabilizationIterations=0,this.ready=!1,this.options={},this.defaultOptions={enabled:!0,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:!0,iterations:1e3,updateInterval:50,onlyDynamicEdges:!1,fit:!0},timestep:.5,adaptiveTimestep:!0,wind:{x:0,y:0}},wt(this.options,this.defaultOptions),this.timestep=.5,this.layoutFailed=!1,this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("initPhysics",function(){t.initPhysics()}),this.body.emitter.on("_layoutFailed",function(){t.layoutFailed=!0}),this.body.emitter.on("resetPhysics",function(){t.stopSimulation(),t.ready=!1}),this.body.emitter.on("disablePhysics",function(){t.physicsEnabled=!1,t.stopSimulation()}),this.body.emitter.on("restorePhysics",function(){t.setOptions(t.options),!0===t.ready&&t.startSimulation()}),this.body.emitter.on("startSimulation",function(){!0===t.ready&&t.startSimulation()}),this.body.emitter.on("stopSimulation",function(){t.stopSimulation()}),this.body.emitter.on("destroy",function(){t.stopSimulation(!1),t.body.emitter.off()}),this.body.emitter.on("_dataChanged",function(){t.updatePhysicsData()})}},{key:"setOptions",value:function(t){if(void 0!==t)if(!1===t)this.options.enabled=!1,this.physicsEnabled=!1,this.stopSimulation();else if(!0===t)this.options.enabled=!0,this.physicsEnabled=!0,this.startSimulation();else{this.physicsEnabled=!0,yr(["stabilization"],this.options,t),Rr(this.options,t,"stabilization"),void 0===t.enabled&&(this.options.enabled=!0),!1===this.options.enabled&&(this.physicsEnabled=!1,this.stopSimulation());var e=this.options.wind;e&&(("number"!=typeof e.x||Sl(e.x))&&(e.x=0),("number"!=typeof e.y||Sl(e.y))&&(e.y=0)),this.timestep=this.options.timestep}this.init()}},{key:"init",value:function(){var t;"forceAtlas2Based"===this.options.solver?(this.nodesSolver=new Nh(this.body,this.physicsBody,t=this.options.forceAtlas2Based),this.edgesSolver=new Ph(this.body,this.physicsBody,t),this.gravitySolver=new Rh(this.body,this.physicsBody,t)):"repulsion"===this.options.solver?(this.nodesSolver=new Oh(this.body,this.physicsBody,t=this.options.repulsion),this.edgesSolver=new Ph(this.body,this.physicsBody,t),this.gravitySolver=new Dh(this.body,this.physicsBody,t)):"hierarchicalRepulsion"===this.options.solver?(this.nodesSolver=new Ih(this.body,this.physicsBody,t=this.options.hierarchicalRepulsion),this.edgesSolver=new Mh(this.body,this.physicsBody,t),this.gravitySolver=new Dh(this.body,this.physicsBody,t)):(this.nodesSolver=new Ah(this.body,this.physicsBody,t=this.options.barnesHut),this.edgesSolver=new Ph(this.body,this.physicsBody,t),this.gravitySolver=new Dh(this.body,this.physicsBody,t)),this.modelOptions=t}},{key:"initPhysics",value:function(){!0===this.physicsEnabled&&!0===this.options.enabled?!0===this.options.stabilization.enabled?this.stabilize():(this.stabilized=!1,this.ready=!0,this.body.emitter.emit("fit",{},this.layoutFailed),this.startSimulation()):(this.ready=!0,this.body.emitter.emit("fit"))}},{key:"startSimulation",value:function(){var t;!0===this.physicsEnabled&&!0===this.options.enabled?(this.stabilized=!1,this.adaptiveTimestep=!1,this.body.emitter.emit("_resizeNodes"),void 0===this.viewFunction&&(this.viewFunction=J(t=this.simulationStep).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))):this.body.emitter.emit("_redraw")}},{key:"stopSimulation",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stabilized=!0,!0===t&&this._emitStabilized(),void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.viewFunction=void 0,!0===t&&this.body.emitter.emit("_stopRendering"))}},{key:"simulationStep",value:function(){var t=Vo();this.physicsTick(),(Vo()-t<.4*this.simulationInterval||!0===this.runDoubleSpeed)&&!1===this.stabilized&&(this.physicsTick(),this.runDoubleSpeed=!0),!0===this.stabilized&&this.stopSimulation()}},{key:"_emitStabilized",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stabilizationIterations;(this.stabilizationIterations>1||!0===this.startedStabilization)&&bl(function(){t.body.emitter.emit("stabilized",{iterations:e}),t.startedStabilization=!1,t.stabilizationIterations=0},0)}},{key:"physicsStep",value:function(){this.gravitySolver.solve(),this.nodesSolver.solve(),this.edgesSolver.solve(),this.moveNodes()}},{key:"adjustTimeStep",value:function(){!0===this._evaluateStepQuality()?this.timestep=1.2*this.timestep:this.timestep/1.2<this.options.timestep?this.timestep=this.options.timestep:(this.adaptiveCounter=-1,this.timestep=Math.max(this.options.timestep,this.timestep/1.2))}},{key:"physicsTick",value:function(){this._startStabilizing(),!0!==this.stabilized&&(!0===this.adaptiveTimestep&&!0===this.adaptiveTimestepEnabled?(this.adaptiveCounter%this.adaptiveInterval==0?(this.timestep=2*this.timestep,this.physicsStep(),this.revert(),this.timestep=.5*this.timestep,this.physicsStep(),this.physicsStep(),this.adjustTimeStep()):this.physicsStep(),this.adaptiveCounter+=1):(this.timestep=this.options.timestep,this.physicsStep()),!0===this.stabilized&&this.revert(),this.stabilizationIterations++)}},{key:"updatePhysicsData",value:function(){this.physicsBody.forces={},this.physicsBody.physicsNodeIndices=[],this.physicsBody.physicsEdgeIndices=[];var t=this.body.nodes,e=this.body.edges;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&!0===t[i].options.physics&&this.physicsBody.physicsNodeIndices.push(t[i].id);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&!0===e[n].options.physics&&this.physicsBody.physicsEdgeIndices.push(e[n].id);for(var o=0;o<this.physicsBody.physicsNodeIndices.length;o++){var r=this.physicsBody.physicsNodeIndices[o];this.physicsBody.forces[r]={x:0,y:0},void 0===this.physicsBody.velocities[r]&&(this.physicsBody.velocities[r]={x:0,y:0})}for(var s in this.physicsBody.velocities)void 0===t[s]&&delete this.physicsBody.velocities[s]}},{key:"revert",value:function(){var t=Wo(this.previousStates),e=this.body.nodes,i=this.physicsBody.velocities;this.referenceState={};for(var n=0;n<t.length;n++){var o=t[n];void 0!==e[o]?!0===e[o].options.physics&&(this.referenceState[o]={positions:{x:e[o].x,y:e[o].y}},i[o].x=this.previousStates[o].vx,i[o].y=this.previousStates[o].vy,e[o].x=this.previousStates[o].x,e[o].y=this.previousStates[o].y):delete this.previousStates[o]}}},{key:"_evaluateStepQuality",value:function(){var t,e=this.body.nodes,i=this.referenceState;for(var n in this.referenceState)if(Object.prototype.hasOwnProperty.call(this.referenceState,n)&&void 0!==e[n]&&(t=e[n].y-i[n].positions.y,Math.sqrt(Math.pow(e[n].x-i[n].positions.x,2)+Math.pow(t,2))>.3))return!1;return!0}},{key:"moveNodes",value:function(){for(var t=this.physicsBody.physicsNodeIndices,e=0,i=0,n=0;n<t.length;n++){var o=this._performStep(t[n]);e=Math.max(e,o),i+=o}this.adaptiveTimestepEnabled=i/t.length<5,this.stabilized=e<this.options.minVelocity}},{key:"calculateComponentVelocity",value:function(t,e,i){t+=(e-this.modelOptions.damping*t)/i*this.timestep;var n=this.options.maxVelocity||1e9;return Math.abs(t)>n&&(t=t>0?n:-n),t}},{key:"_performStep",value:function(t){var e=this.body.nodes[t],i=this.physicsBody.forces[t];this.options.wind&&(i.x+=this.options.wind.x,i.y+=this.options.wind.y);var n=this.physicsBody.velocities[t];return this.previousStates[t]={x:e.x,y:e.y,vx:n.x,vy:n.y},!1===e.options.fixed.x?(n.x=this.calculateComponentVelocity(n.x,i.x,e.options.mass),e.x+=n.x*this.timestep):(i.x=0,n.x=0),!1===e.options.fixed.y?(n.y=this.calculateComponentVelocity(n.y,i.y,e.options.mass),e.y+=n.y*this.timestep):(i.y=0,n.y=0),Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}},{key:"_freezeNodes",value:function(){var t=this.body.nodes;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].x&&t[e].y){var i=t[e].options.fixed;this.freezeCache[e]={x:i.x,y:i.y},i.x=!0,i.y=!0}}},{key:"_restoreFrozenNodes",value:function(){var t=this.body.nodes;for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&void 0!==this.freezeCache[e]&&(t[e].options.fixed.x=this.freezeCache[e].x,t[e].options.fixed.y=this.freezeCache[e].y);this.freezeCache={}}},{key:"stabilize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.stabilization.iterations;"number"!=typeof e&&(e=this.options.stabilization.iterations,console.log("The stabilize method needs a numeric amount of iterations. Switching to default: ",e)),0!==this.physicsBody.physicsNodeIndices.length?(this.adaptiveTimestep=this.options.adaptiveTimestep,this.body.emitter.emit("_resizeNodes"),this.stopSimulation(),this.stabilized=!1,this.body.emitter.emit("_blockRedraw"),this.targetIterations=e,!0===this.options.stabilization.onlyDynamicEdges&&this._freezeNodes(),this.stabilizationIterations=0,bl(function(){return t._stabilizationBatch()},0)):this.ready=!0}},{key:"_startStabilizing",value:function(){return!0!==this.startedStabilization&&(this.body.emitter.emit("startStabilizing"),this.startedStabilization=!0,!0)}},{key:"_stabilizationBatch",value:function(){var t=this,e=function(){return!1===t.stabilized&&t.stabilizationIterations<t.targetIterations},i=function(){t.body.emitter.emit("stabilizationProgress",{iterations:t.stabilizationIterations,total:t.targetIterations})};this._startStabilizing()&&i();for(var n,o=0;e()&&o<this.options.stabilization.updateInterval;)this.physicsTick(),o++;i(),e()?bl(J(n=this._stabilizationBatch).call(n,this),0):this._finalizeStabilization()}},{key:"_finalizeStabilization",value:function(){this.body.emitter.emit("_allowRedraw"),!0===this.options.stabilization.fit&&this.body.emitter.emit("fit"),!0===this.options.stabilization.onlyDynamicEdges&&this._restoreFrozenNodes(),this.body.emitter.emit("stabilizationIterationsDone"),this.body.emitter.emit("_requestRedraw"),!0===this.stabilized?this._emitStabilized():this.startSimulation(),this.ready=!0}},{key:"_drawForces",value:function(t){for(var e=0;e<this.physicsBody.physicsNodeIndices.length;e++){var i=this.physicsBody.physicsNodeIndices[e],n=this.body.nodes[i],o=this.physicsBody.forces[i],r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.x,2)),s=Math.min(Math.max(5,r),15),a=3*s,l=Ir((180-180*Math.min(1,Math.max(0,.03*r)))/360,1,1),c={x:n.x+20*o.x,y:n.y+20*o.y};t.lineWidth=s,t.strokeStyle=l,t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(c.x,c.y),t.stroke();var h=Math.atan2(o.y,o.x);t.fillStyle=l,gh.draw(t,{type:"arrow",point:c,angle:h,length:a}),cc(t).call(t)}}}]),t}(),Fh=[].reverse,Lh=[1,2];U({target:"Array",proto:!0,forced:String(Lh)===String(Lh.reverse())},{reverse:function(){return Yt(this)&&(this.length=this.length),Fh.call(this)}});var Bh=X("Array").reverse,jh=Array.prototype,Vh=function(t){var e=t.reverse;return t===jh||t instanceof Array&&e===jh.reverse?Bh:e},Hh="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Wh=new Uint8Array(16);function qh(){if(!Hh)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hh(Wh)}for(var Uh=[],Yh=0;Yh<256;++Yh)Uh.push((Yh+256).toString(16).substr(1));function Gh(t,e,i){var n=(t=t||{}).random||(t.rng||qh)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){i=i||0;for(var o=0;o<16;++o)e[i+o]=n[o];return e}return function(t,e){return(Uh[t[0]]+Uh[t[1]]+Uh[t[2]]+Uh[t[3]]+"-"+Uh[t[4]]+Uh[t[5]]+"-"+Uh[t[6]]+Uh[t[7]]+"-"+Uh[t[8]]+Uh[t[9]]+"-"+Uh[t[10]]+Uh[t[11]]+Uh[t[12]]+Uh[t[13]]+Uh[t[14]]+Uh[t[15]]).toLowerCase()}(n)}var Zh=function(){function t(){hl(this,t)}return ul(t,null,[{key:"getRange",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).shape.boundingBox.left&&(r=e.shape.boundingBox.left),s<e.shape.boundingBox.right&&(s=e.shape.boundingBox.right),n>e.shape.boundingBox.top&&(n=e.shape.boundingBox.top),o<e.shape.boundingBox.bottom&&(o=e.shape.boundingBox.bottom);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"getRangeCore",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).x&&(r=e.x),s<e.x&&(s=e.x),n>e.y&&(n=e.y),o<e.y&&(o=e.y);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"findCenter",value:function(t){return{x:.5*(t.maxX+t.minX),y:.5*(t.maxY+t.minY)}}},{key:"cloneOptions",value:function(t,e){var i={};return void 0===e||"node"===e?(br(i,t.options,!0),i.x=t.x,i.y=t.y,i.amountOfConnections=t.edges.length):br(i,t.options,!0),i}}]),t}(),$h=function(t){nc(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}(i);function i(t,n,o,r,s,a){var l;return hl(this,i),(l=e.call(this,t,n,o,r,s,a)).isCluster=!0,l.containedNodes={},l.containedEdges={},l}return ul(i,[{key:"_openChildCluster",value:function(t){var e=this,i=this.body.nodes[t];if(void 0===this.containedNodes[t])throw new Error("node with id: "+t+" not in current cluster");if(!i.isCluster)throw new Error("node with id: "+t+" is not a cluster");delete this.containedNodes[t],xr(i.edges,function(t){delete e.containedEdges[t.id]}),xr(i.containedNodes,function(t,i){e.containedNodes[i]=t}),i.containedNodes={},xr(i.containedEdges,function(t,i){e.containedEdges[i]=t}),i.containedEdges={},xr(i.edges,function(t){xr(e.edges,function(i){var n,o,r=go(n=i.clusteringEdgeReplacingIds).call(n,t.id);-1!==r&&(xr(t.clusteringEdgeReplacingIds,function(t){i.clusteringEdgeReplacingIds.push(t),e.body.edges[t].edgeReplacedById=i.id}),qr(o=i.clusteringEdgeReplacingIds).call(o,r,1))})}),i.edges=[]}}]),i}(qc),Xh=function(){function t(e){var i=this;hl(this,t),this.body=e,this.clusteredNodes={},this.clusteredEdges={},this.options={},this.defaultOptions={},wt(this.options,this.defaultOptions),this.body.emitter.on("_resetData",function(){i.clusteredNodes={},i.clusteredEdges={}})}return ul(t,[{key:"clusterByHubsize",value:function(t,e){void 0===t?t=this._getHubSize():"object"===Qo(t)&&(e=this._checkOptions(t),t=this._getHubSize());for(var i=[],n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodes[this.body.nodeIndices[n]];o.edges.length>=t&&i.push(o.id)}for(var r=0;r<i.length;r++)this.clusterByConnection(i[r],e,!0);this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e.joinCondition)throw new Error("Cannot call clusterByNodeData without a joinCondition function in the options.");e=this._checkOptions(e);var n={},o={};xr(this.body.nodes,function(i,r){i.options&&!0===e.joinCondition(i.options)&&(n[r]=i,xr(i.edges,function(e){void 0===t.clusteredEdges[e.id]&&(o[e.id]=e)}))}),this._cluster(n,o,e,i)}},{key:"clusterByEdgeCount",value:function(t,e){var i=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=this._checkOptions(e);for(var o,r,s,a=[],l={},c=function(n){var c={},h={},d=i.body.nodeIndices[n],u=i.body.nodes[d];if(void 0===l[d]){s=0,r=[];for(var f=0;f<u.edges.length;f++)void 0===i.clusteredEdges[(o=u.edges[f]).id]&&(o.toId!==o.fromId&&s++,r.push(o));if(s===t){for(var p=function(t){if(null==e.joinCondition)return!0;var i=Zh.cloneOptions(t);return e.joinCondition(i)},g=!0,m=0;m<r.length;m++){var v=i._getConnectedId(o=r[m],d);if(!p(u)){g=!1;break}h[o.id]=o,c[d]=u,c[v]=i.body.nodes[v],l[d]=!0}if(Wo(c).length>0&&Wo(h).length>0&&!0===g){var y=function(){for(var t=0;t<a.length;++t)for(var e in c)if(void 0!==a[t].nodes[e])return a[t]}();if(void 0!==y){for(var b in c)void 0===y.nodes[b]&&(y.nodes[b]=c[b]);for(var w in h)void 0===y.edges[w]&&(y.edges[w]=h[w])}else a.push({nodes:c,edges:h})}}}},h=0;h<this.body.nodeIndices.length;h++)c(h);for(var d=0;d<a.length;d++)this._cluster(a[d].nodes,a[d].edges,e,!1);!0===n&&this.body.emitter.emit("_dataChanged")}},{key:"clusterOutliers",value:function(t){this.clusterByEdgeCount(1,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"clusterBridges",value:function(t){this.clusterByEdgeCount(2,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"clusterByConnection",value:function(t,e){var i,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No nodeId supplied to clusterByConnection!");if(void 0===this.body.nodes[t])throw new Error("The nodeId given to clusterByConnection does not exist!");var o=this.body.nodes[t];void 0===(e=this._checkOptions(e,o)).clusterNodeProperties.x&&(e.clusterNodeProperties.x=o.x),void 0===e.clusterNodeProperties.y&&(e.clusterNodeProperties.y=o.y),void 0===e.clusterNodeProperties.fixed&&(e.clusterNodeProperties.fixed={},e.clusterNodeProperties.fixed.x=o.options.fixed.x,e.clusterNodeProperties.fixed.y=o.options.fixed.y);var r={},s={},a=o.id,l=Zh.cloneOptions(o);r[a]=o;for(var c=0;c<o.edges.length;c++){var h=o.edges[c];if(void 0===this.clusteredEdges[h.id]){var d=this._getConnectedId(h,a);if(void 0===this.clusteredNodes[d])if(d!==a)if(void 0===e.joinCondition)s[h.id]=h,r[d]=this.body.nodes[d];else{var u=Zh.cloneOptions(this.body.nodes[d]);!0===e.joinCondition(l,u)&&(s[h.id]=h,r[d]=this.body.nodes[d])}else s[h.id]=h}}var f=$o(i=Wo(r)).call(i,function(t){return r[t].id});for(var p in r)if(Object.prototype.hasOwnProperty.call(r,p))for(var g=r[p],m=0;m<g.edges.length;m++){var v=g.edges[m];go(f).call(f,this._getConnectedId(v,g.id))>-1&&(s[v.id]=v)}this._cluster(r,s,e,n)}},{key:"_createClusterEdges",value:function(t,e,i,n){for(var o,r,s,a,l,c,h=Wo(t),d=[],u=0;u<h.length;u++){s=t[r=h[u]];for(var f=0;f<s.edges.length;f++)void 0===this.clusteredEdges[(o=s.edges[f]).id]&&(o.toId==o.fromId?e[o.id]=o:o.toId==r?(a=i.id,c=l=o.fromId):(l=i.id,c=a=o.toId),void 0===t[c]&&d.push({edge:o,fromId:l,toId:a}))}for(var p=[],g=function(t){for(var e=0;e<p.length;e++){var i=p[e];if(t.fromId===i.fromId&&t.toId===i.toId||t.fromId===i.toId&&t.toId===i.fromId)return i}return null},m=0;m<d.length;m++){var v=d[m],y=v.edge,b=g(v);null===b?(b=this._createClusteredEdge(v.fromId,v.toId,y,n),p.push(b)):b.clusteringEdgeReplacingIds.push(y.id),this.body.edges[y.id].edgeReplacedById=b.id,this._backupEdgeOptions(y),y.setOptions({physics:!1})}}},{key:"_checkOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.clusterEdgeProperties&&(t.clusterEdgeProperties={}),void 0===t.clusterNodeProperties&&(t.clusterNodeProperties={}),t}},{key:"_cluster",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&void 0!==this.clusteredNodes[r]&&o.push(r);for(var s=0;s<o.length;++s)delete t[o[s]];if(0!=Wo(t).length&&(1!=Wo(t).length||1==i.clusterNodeProperties.allowSingleNodeCluster)){var a=br({},i.clusterNodeProperties);if(void 0!==i.processProperties){var l=[];for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var h=Zh.cloneOptions(t[c]);l.push(h)}var d=[];for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)&&"clusterEdge:"!==u.substr(0,12)){var f=Zh.cloneOptions(e[u],"edge");d.push(f)}if(!(a=i.processProperties(a,l,d)))throw new Error("The processProperties function does not return properties!")}void 0===a.id&&(a.id="cluster:"+Gh());var p=a.id;void 0===a.label&&(a.label="cluster");var g=void 0;void 0===a.x&&(g=this._getClusterPosition(t),a.x=g.x),void 0===a.y&&(void 0===g&&(g=this._getClusterPosition(t)),a.y=g.y),a.id=p;var m=this.body.functions.createNode(a,$h);m.containedNodes=t,m.containedEdges=e,m.clusterEdgeProperties=i.clusterEdgeProperties,this.body.nodes[a.id]=m,this._clusterEdges(t,e,a,i.clusterEdgeProperties),a.id=void 0,!0===n&&this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function(t){void 0===this.clusteredEdges[t.id]&&(this.clusteredEdges[t.id]={physics:t.options.physics})}},{key:"_restoreEdge",value:function(t){var e=this.clusteredEdges[t.id];void 0!==e&&(t.setOptions({physics:e.physics}),delete this.clusteredEdges[t.id])}},{key:"isCluster",value:function(t){return void 0!==this.body.nodes[t]?!0===this.body.nodes[t].isCluster:(console.log("Node does not exist."),!1)}},{key:"_getClusterPosition",value:function(t){for(var e,i=Wo(t),n=t[i[0]].x,o=t[i[0]].x,r=t[i[0]].y,s=t[i[0]].y,a=1;a<i.length;a++)n=(e=t[i[a]]).x<n?e.x:n,o=e.x>o?e.x:o,r=e.y<r?e.y:r,s=e.y>s?e.y:s;return{x:.5*(n+o),y:.5*(r+s)}}},{key:"openCluster",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No clusterNodeId supplied to openCluster.");var n=this.body.nodes[t];if(void 0===n)throw new Error("The clusterNodeId supplied to openCluster does not exist.");if(!0!==n.isCluster||void 0===n.containedNodes||void 0===n.containedEdges)throw new Error("The node:"+t+" is not a valid cluster.");var o=this.findNode(t),r=go(o).call(o,t)-1;if(r>=0)return this.body.nodes[o[r]]._openChildCluster(t),delete this.body.nodes[t],void(!0===i&&this.body.emitter.emit("_dataChanged"));var s=n.containedNodes,a=n.containedEdges;if(void 0!==e&&void 0!==e.releaseFunction&&"function"==typeof e.releaseFunction){var l={},c={x:n.x,y:n.y};for(var h in s)if(Object.prototype.hasOwnProperty.call(s,h)){var d=this.body.nodes[h];l[h]={x:d.x,y:d.y}}var u=e.releaseFunction(c,l);for(var f in s)if(Object.prototype.hasOwnProperty.call(s,f)){var p=this.body.nodes[f];void 0!==u[f]&&(p.x=void 0===u[f].x?n.x:u[f].x,p.y=void 0===u[f].y?n.y:u[f].y)}}else xr(s,function(t){!1===t.options.fixed.x&&(t.x=n.x),!1===t.options.fixed.y&&(t.y=n.y)});for(var g in s)if(Object.prototype.hasOwnProperty.call(s,g)){var m=this.body.nodes[g];m.vx=n.vx,m.vy=n.vy,m.setOptions({physics:!0}),delete this.clusteredNodes[g]}for(var v=[],y=0;y<n.edges.length;y++)v.push(n.edges[y]);for(var b=0;b<v.length;b++){for(var w=v[b],k=this._getConnectedId(w,t),_=this.clusteredNodes[k],x=0;x<w.clusteringEdgeReplacingIds.length;x++){var C=this.body.edges[w.clusteringEdgeReplacingIds[x]];if(void 0!==C)if(void 0!==_){var E=this.body.nodes[_.clusterId];E.containedEdges[C.id]=C,delete a[C.id];var T=C.fromId,S=C.toId;C.toId==k?S=_.clusterId:T=_.clusterId,this._createClusteredEdge(T,S,C,E.clusterEdgeProperties,{hidden:!1,physics:!0})}else this._restoreEdge(C)}w.remove()}for(var A in a)Object.prototype.hasOwnProperty.call(a,A)&&this._restoreEdge(a[A]);delete this.body.nodes[t],!0===i&&this.body.emitter.emit("_dataChanged")}},{key:"getNodesInCluster",value:function(t){var e=[];if(!0===this.isCluster(t)){var i=this.body.nodes[t].containedNodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.push(this.body.nodes[n].id)}return e}},{key:"findNode",value:function(t){for(var e,i=[],n=0;void 0!==this.clusteredNodes[t]&&n<100;){if(void 0===(e=this.body.nodes[t]))return[];i.push(e.id),t=this.clusteredNodes[t].clusterId,n++}return void 0===(e=this.body.nodes[t])?[]:(i.push(e.id),Vh(i).call(i),i)}},{key:"updateClusteredNode",value:function(t,e){if(void 0===t)throw new Error("No clusteredNodeId supplied to updateClusteredNode.");if(void 0===e)throw new Error("No newOptions supplied to updateClusteredNode.");if(void 0===this.body.nodes[t])throw new Error("The clusteredNodeId supplied to updateClusteredNode does not exist.");this.body.nodes[t].setOptions(e),this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function(t,e){if(void 0===t)throw new Error("No startEdgeId supplied to updateEdge.");if(void 0===e)throw new Error("No newOptions supplied to updateEdge.");if(void 0===this.body.edges[t])throw new Error("The startEdgeId supplied to updateEdge does not exist.");for(var i=this.getClusteredEdges(t),n=0;n<i.length;n++)this.body.edges[i[n]].setOptions(e);this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function(t){for(var e=[],i=0;void 0!==t&&void 0!==this.body.edges[t]&&i<100;)e.push(this.body.edges[t].id),t=this.body.edges[t].edgeReplacedById,i++;return Vh(e).call(e),e}},{key:"getBaseEdge",value:function(t){return this.getBaseEdges(t)[0]}},{key:"getBaseEdges",value:function(t){for(var e=[t],i=[],n=[],o=0;e.length>0&&o<100;){var r=e.pop();if(void 0!==r){var s=this.body.edges[r];if(void 0!==s){o++;var a=s.clusteringEdgeReplacingIds;if(void 0===a)n.push(r);else for(var l=0;l<a.length;++l){var c=a[l];-1===go(e).call(e,a)&&-1===go(i).call(i,a)&&e.push(c)}i.push(r)}}}return n}},{key:"_getConnectedId",value:function(t,e){return t.toId!=e?t.toId:t.fromId}},{key:"_getHubSize",value:function(){for(var t=0,e=0,i=0,n=0,o=0;o<this.body.nodeIndices.length;o++){var r=this.body.nodes[this.body.nodeIndices[o]];r.edges.length>n&&(n=r.edges.length),t+=r.edges.length,e+=Math.pow(r.edges.length,2),i+=1}t/=i;var s=(e/=i)-Math.pow(t,2),a=Math.sqrt(s),l=Math.floor(t+2*a);return l>n&&(l=n),l}},{key:"_createClusteredEdge",value:function(t,e,i,n,o){var r=Zh.cloneOptions(i,"edge");br(r,n),r.from=t,r.to=e,r.id="clusterEdge:"+Gh(),void 0!==o&&br(r,o);var s=this.body.functions.createEdge(r);return s.clusteringEdgeReplacingIds=[i.id],s.connect(),this.body.edges[s.id]=s,s}},{key:"_clusterEdges",value:function(t,e,i,n){if(e instanceof Th){var o={};o[e.id]=e,e=o}if(t instanceof qc){var r={};r[t.id]=t,t=r}if(null==i)throw new Error("_clusterEdges: parameter clusterNode required");for(var s in void 0===n&&(n=i.clusterEdgeProperties),this._createClusterEdges(t,e,i,n),e)if(Object.prototype.hasOwnProperty.call(e,s)&&void 0!==this.body.edges[s]){var a=this.body.edges[s];this._backupEdgeOptions(a),a.setOptions({physics:!1})}for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(this.clusteredNodes[l]={clusterId:i.id,node:this.body.nodes[l]},this.body.nodes[l].setOptions({physics:!1}))}},{key:"_getClusterNodeForNode",value:function(t){if(void 0!==t){var e=this.clusteredNodes[t];if(void 0!==e){var i=e.clusterId;if(void 0!==i)return this.body.nodes[i]}}}},{key:"_filter",value:function(t,e){var i=[];return xr(t,function(t){e(t)&&i.push(t)}),i}},{key:"_updateState",value:function(){var t,e=this,i=[],n={},o=function(t){xr(e.body.nodes,function(e){!0===e.isCluster&&t(e)})};for(t in this.clusteredNodes)Object.prototype.hasOwnProperty.call(this.clusteredNodes,t)&&void 0===this.body.nodes[t]&&i.push(t);o(function(t){for(var e=0;e<i.length;e++)delete t.containedNodes[i[e]]});for(var r=0;r<i.length;r++)delete this.clusteredNodes[i[r]];xr(this.clusteredEdges,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()||(n[t]=t)}),o(function(t){xr(t.containedEdges,function(t,e){t.endPointsValid()||n[e]||(n[e]=e)})}),xr(this.body.edges,function(t,i){var o=!0,r=t.clusteringEdgeReplacingIds;if(void 0!==r){var s=0;xr(r,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()&&(s+=1)}),o=s>0}t.endPointsValid()&&o||(n[i]=i)}),o(function(t){xr(n,function(i){delete t.containedEdges[i],xr(t.edges,function(o,r){o.id!==i?o.clusteringEdgeReplacingIds=e._filter(o.clusteringEdgeReplacingIds,function(t){return!n[t]}):t.edges[r]=null}),t.edges=e._filter(t.edges,function(t){return null!==t})})}),xr(n,function(t){delete e.clusteredEdges[t]}),xr(n,function(t){delete e.body.edges[t]}),xr(Wo(this.body.edges),function(t){var i=e.body.edges[t],n=e._isClusteredNode(i.fromId)||e._isClusteredNode(i.toId);if(n!==e._isClusteredEdge(i.id))if(n){var o=e._getClusterNodeForNode(i.fromId);void 0!==o&&e._clusterEdges(e.body.nodes[i.fromId],i,o);var r=e._getClusterNodeForNode(i.toId);void 0!==r&&e._clusterEdges(e.body.nodes[i.toId],i,r)}else delete e._clusterEdges[t],e._restoreEdge(i)});for(var s=!1,a=!0,l=function(){var t=[];o(function(e){var i=Wo(e.containedNodes).length,n=!0===e.options.allowSingleNodeCluster;(n&&i<1||!n&&i<2)&&t.push(e.id)});for(var i=0;i<t.length;++i)e.openCluster(t[i],{},!1);a=t.length>0,s=s||a};a;)l();s&&this._updateState()}},{key:"_isClusteredNode",value:function(t){return void 0!==this.clusteredNodes[t]}},{key:"_isClusteredEdge",value:function(t){return void 0!==this.clusteredEdges[t]}}]),t}(),Kh=function(){function t(e,i){var n;hl(this,t),void 0!==window&&(n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),window.requestAnimationFrame=void 0===n?function(t){t()}:n,this.body=e,this.canvas=i,this.redrawRequested=!1,this.renderTimer=void 0,this.requiresTimeout=!0,this.renderingActive=!1,this.renderRequests=0,this.allowRedraw=!0,this.dragging=!1,this.zooming=!1,this.options={},this.defaultOptions={hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1},wt(this.options,this.defaultOptions),this._determineBrowserMethod(),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.on("dragStart",function(){e.dragging=!0}),this.body.emitter.on("dragEnd",function(){e.dragging=!1}),this.body.emitter.on("zoom",function(){e.zooming=!0,window.clearTimeout(e.zoomTimeoutId),e.zoomTimeoutId=window.setTimeout(function(){var t;e.zooming=!1,J(t=e._requestRedraw).call(t,e)()},250)}),this.body.emitter.on("_resizeNodes",function(){e._resizeNodes()}),this.body.emitter.on("_redraw",function(){!1===e.renderingActive&&e._redraw()}),this.body.emitter.on("_blockRedraw",function(){e.allowRedraw=!1}),this.body.emitter.on("_allowRedraw",function(){e.allowRedraw=!0,e.redrawRequested=!1}),this.body.emitter.on("_requestRedraw",J(t=this._requestRedraw).call(t,this)),this.body.emitter.on("_startRendering",function(){e.renderRequests+=1,e.renderingActive=!0,e._startRendering()}),this.body.emitter.on("_stopRendering",function(){e.renderRequests-=1,e.renderingActive=e.renderRequests>0,e.renderTimer=void 0}),this.body.emitter.on("destroy",function(){e.renderRequests=0,e.allowRedraw=!1,e.renderingActive=!1,!0===e.requiresTimeout?clearTimeout(e.renderTimer):window.cancelAnimationFrame(e.renderTimer),e.body.emitter.off()})}},{key:"setOptions",value:function(t){void 0!==t&&vr(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag"],this.options,t)}},{key:"_requestNextFrame",value:function(t,e){if("undefined"!=typeof window){var i,n=window;return!0===this.requiresTimeout?i=n.setTimeout(t,e):n.requestAnimationFrame&&(i=n.requestAnimationFrame(t)),i}}},{key:"_startRendering",value:function(){var t;!0===this.renderingActive&&void 0===this.renderTimer&&(this.renderTimer=this._requestNextFrame(J(t=this._renderStep).call(t,this),this.simulationInterval))}},{key:"_renderStep",value:function(){!0===this.renderingActive&&(this.renderTimer=void 0,!0===this.requiresTimeout&&this._startRendering(),this._redraw(),!1===this.requiresTimeout&&this._startRendering())}},{key:"redraw",value:function(){this.body.emitter.emit("setSize"),this._redraw()}},{key:"_requestRedraw",value:function(){var t=this;!0!==this.redrawRequested&&!1===this.renderingActive&&!0===this.allowRedraw&&(this.redrawRequested=!0,this._requestNextFrame(function(){t._redraw(!1)},0))}},{key:"_redraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.allowRedraw){this.body.emitter.emit("initRedraw"),this.redrawRequested=!1,0!==this.canvas.frame.canvas.width&&0!==this.canvas.frame.canvas.height||this.canvas.setSize(),this.canvas.setTransform();var e=this.canvas.getContext(),i=this.canvas.frame.canvas.clientWidth,n=this.canvas.frame.canvas.clientHeight;if(e.clearRect(0,0,i,n),0===this.canvas.frame.clientWidth)return;e.save(),e.translate(this.body.view.translation.x,this.body.view.translation.y),e.scale(this.body.view.scale,this.body.view.scale),e.beginPath(),this.body.emitter.emit("beforeDrawing",e),e.closePath(),!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawEdges(e),(!1===this.dragging||!0===this.dragging&&!1===this.options.hideNodesOnDrag)&&this._drawNodes(e,t),!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawArrows(e),!1===t&&this._drawSelectionBox(e),e.beginPath(),this.body.emitter.emit("afterDrawing",e),e.closePath(),e.restore(),!0===t&&e.clearRect(0,0,i,n)}}},{key:"_resizeNodes",value:function(){this.canvas.setTransform();var t=this.canvas.getContext();t.save(),t.translate(this.body.view.translation.x,this.body.view.translation.y),t.scale(this.body.view.scale,this.body.view.scale);var e,i=this.body.nodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&((e=i[n]).resize(t),e.updateBoundingBox(t,e.selected));t.restore()}},{key:"_drawNodes",value:function(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.nodes,r=this.body.nodeIndices,s=[],a=[],l=20,c=this.canvas.DOMtoCanvas({x:-l,y:-l}),h=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+l,y:this.canvas.frame.canvas.clientHeight+l}),d={top:c.y,left:c.x,bottom:h.y,right:h.x},u=0;u<r.length;u++)(e=o[r[u]]).hover?a.push(r[u]):e.isSelected()?s.push(r[u]):!0===n||!0===e.isBoundingBoxOverlappingWith(d)?e.draw(t):e.updateBoundingBox(t,e.selected);var f=s.length,p=a.length;for(i=0;i<f;i++)(e=o[s[i]]).draw(t);for(i=0;i<p;i++)(e=o[a[i]]).draw(t)}},{key:"_drawEdges",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.draw(t)}}},{key:"_drawArrows",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.drawArrows(t)}}},{key:"_determineBrowserMethod",value:function(){if("undefined"!=typeof window){var t=navigator.userAgent.toLowerCase();this.requiresTimeout=!1,(-1!=go(t).call(t,"msie 9.0")||-1!=go(t).call(t,"safari")&&go(t).call(t,"chrome")<=-1)&&(this.requiresTimeout=!0)}else this.requiresTimeout=!0}},{key:"_drawSelectionBox",value:function(t){if(this.body.selectionBox.show){t.beginPath();var e=this.body.selectionBox.position.end.x-this.body.selectionBox.position.start.x,i=this.body.selectionBox.position.end.y-this.body.selectionBox.position.start.y;t.rect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.fillStyle="rgba(151, 194, 252, 0.2)",t.fillRect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.strokeStyle="rgba(151, 194, 252, 1)",t.stroke()}else t.closePath()}}]),t}(),Qh=z.setInterval;function Jh(t,e){e.inputHandler=function(t){t.isFirst&&e(t)},t.on("hammer.input",e.inputHandler)}function td(t,e){return e.inputHandler=function(t){t.isFinal&&e(t)},t.on("hammer.input",e.inputHandler)}var ed=function(){function t(e){var i;hl(this,t),this.body=e,this.pixelRatio=1,this.resizeTimer=void 0,this.resizeFunction=J(i=this._onResize).call(i,this),this.cameraState={},this.initialized=!1,this.canvasViewCenter={},this.options={},this.defaultOptions={autoResize:!0,height:"100%",width:"100%"},wt(this.options,this.defaultOptions),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.once("resize",function(t){0!==t.width&&(e.body.view.translation.x=.5*t.width),0!==t.height&&(e.body.view.translation.y=.5*t.height)}),this.body.emitter.on("setSize",J(t=this.setSize).call(t,this)),this.body.emitter.on("destroy",function(){e.hammerFrame.destroy(),e.hammer.destroy(),e._cleanUp()})}},{key:"setOptions",value:function(t){var e,i,n,o,r,s,a=this;void 0!==t&&vr(["width","height","autoResize"],this.options,t),!0===this.options.autoResize&&(this._cleanUp(),this.resizeTimer=Qh(function(){!0===a.setSize()&&a.body.emitter.emit("_requestRedraw")},1e3),this.resizeFunction=J(e=this._onResize).call(e,this),i=window,n="resize",o=this.resizeFunction,i.addEventListener?(void 0===r&&(r=!1),"mousewheel"===n&&go(s=navigator.userAgent).call(s,"Firefox")>=0&&(n="DOMMouseScroll"),i.addEventListener(n,o,r)):i.attachEvent("on"+n,o))}},{key:"_cleanUp",value:function(){var t,e,i,n,o;void 0!==this.resizeTimer&&clearInterval(this.resizeTimer),t=window,e="resize",i=this.resizeFunction,t.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&go(o=navigator.userAgent).call(o,"Firefox")>=0&&(e="DOMMouseScroll"),t.removeEventListener(e,i,n)):t.detachEvent("on"+e,i),this.resizeFunction=void 0}},{key:"_onResize",value:function(){this.setSize(),this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pixelRatio;!0===this.initialized&&(this.cameraState.previousWidth=this.frame.canvas.width/t,this.cameraState.previousHeight=this.frame.canvas.height/t,this.cameraState.scale=this.body.view.scale,this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/t,y:.5*this.frame.canvas.height/t}))}},{key:"_setCameraState",value:function(){if(void 0!==this.cameraState.scale&&0!==this.frame.canvas.clientWidth&&0!==this.frame.canvas.clientHeight&&0!==this.pixelRatio&&this.cameraState.previousWidth>0&&this.cameraState.previousHeight>0){var t=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth,e=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight,i=this.cameraState.scale;1!=t&&1!=e?i=.5*this.cameraState.scale*(t+e):1!=t?i=this.cameraState.scale*t:1!=e&&(i=this.cameraState.scale*e),this.body.view.scale=i;var n=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight}),o={x:n.x-this.cameraState.position.x,y:n.y-this.cameraState.position.y};this.body.view.translation.x+=o.x*this.body.view.scale,this.body.view.translation.y+=o.y*this.body.view.scale}}},{key:"_prepareValue",value:function(t){if("number"==typeof t)return t+"px";if("string"==typeof t){if(-1!==go(t).call(t,"%")||-1!==go(t).call(t,"px"))return t;if(-1===go(t).call(t,"%"))return t+"px"}throw new Error("Could not use the value supplied for width or height:"+t)}},{key:"_create",value:function(){for(;this.body.container.hasChildNodes();)this.body.container.removeChild(this.body.container.firstChild);if(this.frame=document.createElement("div"),this.frame.className="vis-network",this.frame.style.position="relative",this.frame.style.overflow="hidden",this.frame.tabIndex=900,this.frame.canvas=document.createElement("canvas"),this.frame.canvas.style.position="relative",this.frame.appendChild(this.frame.canvas),this.frame.canvas.getContext)this._setPixelRatio(),this.setTransform();else{var t=document.createElement("DIV");t.style.color="red",t.style.fontWeight="bold",t.style.padding="10px",t.innerHTML="Error: your browser does not support HTML canvas",this.frame.canvas.appendChild(t)}this.body.container.appendChild(this.frame),this.body.view.scale=1,this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight},this._bindHammer()}},{key:"_bindHammer",value:function(){var t=this;void 0!==this.hammer&&this.hammer.destroy(),this.drag={},this.pinch={},this.hammer=new al(this.frame.canvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.get("pan").set({threshold:5,direction:al.DIRECTION_ALL}),Jh(this.hammer,function(e){t.body.eventListeners.onTouch(e)}),this.hammer.on("tap",function(e){t.body.eventListeners.onTap(e)}),this.hammer.on("doubletap",function(e){t.body.eventListeners.onDoubleTap(e)}),this.hammer.on("press",function(e){t.body.eventListeners.onHold(e)}),this.hammer.on("panstart",function(e){t.body.eventListeners.onDragStart(e)}),this.hammer.on("panmove",function(e){t.body.eventListeners.onDrag(e)}),this.hammer.on("panend",function(e){t.body.eventListeners.onDragEnd(e)}),this.hammer.on("pinch",function(e){t.body.eventListeners.onPinch(e)}),this.frame.canvas.addEventListener("wheel",function(e){t.body.eventListeners.onMouseWheel(e)}),this.frame.canvas.addEventListener("mousemove",function(e){t.body.eventListeners.onMouseMove(e)}),this.frame.canvas.addEventListener("contextmenu",function(e){t.body.eventListeners.onContext(e)}),this.hammerFrame=new al(this.frame),td(this.hammerFrame,function(e){t.body.eventListeners.onRelease(e)})}},{key:"setSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.height;t=this._prepareValue(t),e=this._prepareValue(e);var i=!1,n=this.frame.canvas.width,o=this.frame.canvas.height,r=this.pixelRatio;if(this._setPixelRatio(),t!=this.options.width||e!=this.options.height||this.frame.style.width!=t||this.frame.style.height!=e)this._getCameraState(r),this.frame.style.width=t,this.frame.style.height=e,this.frame.canvas.style.width="100%",this.frame.canvas.style.height="100%",this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio),this.options.width=t,this.options.height=e,this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight},i=!0;else{var s=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),a=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);this.frame.canvas.width===s&&this.frame.canvas.height===a||this._getCameraState(r),this.frame.canvas.width!==s&&(this.frame.canvas.width=s,i=!0),this.frame.canvas.height!==a&&(this.frame.canvas.height=a,i=!0)}return!0===i&&(this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(n/this.pixelRatio),oldHeight:Math.round(o/this.pixelRatio)}),this._setCameraState()),this.initialized=!0,i}},{key:"getContext",value:function(){return this.frame.canvas.getContext("2d")}},{key:"_determinePixelRatio",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");var e=1;return"undefined"!=typeof window&&(e=window.devicePixelRatio||1),e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},{key:"_setPixelRatio",value:function(){this.pixelRatio=this._determinePixelRatio()}},{key:"setTransform",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"_XconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function(t){return{x:this._XconvertCanvasToDOM(t.x),y:this._YconvertCanvasToDOM(t.y)}}},{key:"DOMtoCanvas",value:function(t){return{x:this._XconvertDOMtoCanvas(t.x),y:this._YconvertDOMtoCanvas(t.y)}}}]),t}(),id=function(){function t(e,i){var n,o,r=this;hl(this,t),this.body=e,this.canvas=i,this.animationSpeed=1/this.renderRefreshRate,this.animationEasingFunction="easeInOutQuint",this.easingTime=0,this.sourceScale=0,this.targetScale=0,this.sourceTranslation=0,this.targetTranslation=0,this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0,this.touchTime=0,this.viewFunction=void 0,this.body.emitter.on("fit",J(n=this.fit).call(n,this)),this.body.emitter.on("animationFinished",function(){r.body.emitter.emit("_stopRendering")}),this.body.emitter.on("unlockNode",J(o=this.releaseNode).call(o,this))}return ul(t,[{key:"setOptions",value:function(){this.options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}},{key:"fit",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{nodes:[]},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];void 0!==(i=wt({},i)).nodes&&0!==i.nodes.length||(i.nodes=this.body.nodeIndices);var o=this.canvas.frame.canvas.clientWidth,r=this.canvas.frame.canvas.clientHeight;if(0===o||0===r)e=1,t=Zh.getRange(this.body.nodes,i.nodes);else if(!0===n){var s=0;for(var a in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,a)&&!0===this.body.nodes[a].predefinedPosition&&(s+=1);if(s>.5*this.body.nodeIndices.length)return void this.fit(i,!1);t=Zh.getRange(this.body.nodes,i.nodes),e=12.662/(this.body.nodeIndices.length+7.4147)+.0964822,e*=Math.min(o/600,r/600)}else{this.body.emitter.emit("_resizeNodes"),t=Zh.getRange(this.body.nodes,i.nodes);var l=o/(1.1*Math.abs(t.maxX-t.minX)),c=r/(1.1*Math.abs(t.maxY-t.minY));e=l<=c?l:c}(e>1||0===e)&&(e=1);var h=Zh.findCenter(t);this.moveTo({position:h,scale:e,animation:i.animation})}},{key:"focus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0!==this.body.nodes[t]?(e.position={x:this.body.nodes[t].x,y:this.body.nodes[t].y},e.lockedOnNode=t,this.moveTo(e)):console.log("Node: "+t+" cannot be found.")}},{key:"moveTo",value:function(t){if(void 0!==t){if(null!=t.offset){if(null!=t.offset.x){if(t.offset.x=+t.offset.x,!Tl(t.offset.x))throw new TypeError('The option "offset.x" has to be a finite number.')}else t.offset.x=0;if(null!=t.offset.y){if(t.offset.y=+t.offset.y,!Tl(t.offset.y))throw new TypeError('The option "offset.y" has to be a finite number.')}else t.offset.x=0}else t.offset={x:0,y:0};if(null!=t.position){if(null!=t.position.x){if(t.position.x=+t.position.x,!Tl(t.position.x))throw new TypeError('The option "position.x" has to be a finite number.')}else t.position.x=0;if(null!=t.position.y){if(t.position.y=+t.position.y,!Tl(t.position.y))throw new TypeError('The option "position.y" has to be a finite number.')}else t.position.x=0}else t.position=this.getViewPosition();if(null!=t.scale){if(t.scale=+t.scale,!(t.scale>0))throw new TypeError('The option "scale" has to be a number greater than zero.')}else t.scale=this.body.view.scale;void 0===t.animation&&(t.animation={duration:0}),!1===t.animation&&(t.animation={duration:0}),!0===t.animation&&(t.animation={}),void 0===t.animation.duration&&(t.animation.duration=1e3),void 0===t.animation.easingFunction&&(t.animation.easingFunction="easeInOutQuad"),this.animateView(t)}else t={}}},{key:"animateView",value:function(t){if(void 0!==t){this.animationEasingFunction=t.animation.easingFunction,this.releaseNode(),!0===t.locked&&(this.lockedOnNodeId=t.lockedOnNode,this.lockedOnNodeOffset=t.offset),0!=this.easingTime&&this._transitionRedraw(!0),this.sourceScale=this.body.view.scale,this.sourceTranslation=this.body.view.translation,this.targetScale=t.scale,this.body.view.scale=this.targetScale;var e,i,n=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight});this.targetTranslation={x:this.sourceTranslation.x+(n.x-t.position.x)*this.targetScale+t.offset.x,y:this.sourceTranslation.y+(n.y-t.position.y)*this.targetScale+t.offset.y},0===t.animation.duration?null!=this.lockedOnNodeId?(this.viewFunction=J(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)):(this.body.view.scale=this.targetScale,this.body.view.translation=this.targetTranslation,this.body.emitter.emit("_requestRedraw")):(this.animationSpeed=1/(60*t.animation.duration*.001)||1/60,this.animationEasingFunction=t.animation.easingFunction,this.viewFunction=J(i=this._transitionRedraw).call(i,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))}}},{key:"_lockedRedraw",value:function(){var t=this.body.nodes[this.lockedOnNodeId].x,e=this.body.nodes[this.lockedOnNodeId].y,i=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),n=this.body.view.translation;this.body.view.translation={x:n.x+(i.x-t)*this.body.view.scale+this.lockedOnNodeOffset.x,y:n.y+(i.y-e)*this.body.view.scale+this.lockedOnNodeOffset.y}}},{key:"releaseNode",value:function(){void 0!==this.lockedOnNodeId&&void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0)}},{key:"_transitionRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.easingTime+=this.animationSpeed,this.easingTime=!0===t?1:this.easingTime;var e,i=zr[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*i,this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*i,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*i},this.easingTime>=1&&(this.body.emitter.off("initRedraw",this.viewFunction),this.easingTime=0,null!=this.lockedOnNodeId&&(this.viewFunction=J(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)),this.body.emitter.emit("animationFinished"))}},{key:"getScale",value:function(){return this.body.view.scale}},{key:"getViewPosition",value:function(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]),t}(),nd=function(){function t(e,i){var n=this;hl(this,t),this.body=e,this.canvas=i,this.iconsCreated=!1,this.navigationHammers=[],this.boundFunctions={},this.touchTime=0,this.activated=!1,this.body.emitter.on("activate",function(){n.activated=!0,n.configureKeyboardBindings()}),this.body.emitter.on("deactivate",function(){n.activated=!1,n.configureKeyboardBindings()}),this.body.emitter.on("destroy",function(){void 0!==n.keycharm&&n.keycharm.destroy()}),this.options={}}return ul(t,[{key:"setOptions",value:function(t){void 0!==t&&(this.options=t,this.create())}},{key:"create",value:function(){!0===this.options.navigationButtons?!1===this.iconsCreated&&this.loadNavigationElements():!0===this.iconsCreated&&this.cleanNavigation(),this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function(){if(0!=this.navigationHammers.length){for(var t=0;t<this.navigationHammers.length;t++)this.navigationHammers[t].destroy();this.navigationHammers=[]}this.navigationDOM&&this.navigationDOM.wrapper&&this.navigationDOM.wrapper.parentNode&&this.navigationDOM.wrapper.parentNode.removeChild(this.navigationDOM.wrapper),this.iconsCreated=!1}},{key:"loadNavigationElements",value:function(){var t=this;this.cleanNavigation(),this.navigationDOM={};var e=["up","down","left","right","zoomIn","zoomOut","zoomExtends"],i=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM.wrapper=document.createElement("div"),this.navigationDOM.wrapper.className="vis-navigation",this.canvas.frame.appendChild(this.navigationDOM.wrapper);for(var n=0;n<e.length;n++){this.navigationDOM[e[n]]=document.createElement("div"),this.navigationDOM[e[n]].className="vis-button vis-"+e[n],this.navigationDOM.wrapper.appendChild(this.navigationDOM[e[n]]);var o,r,s=new al(this.navigationDOM[e[n]]);Jh(s,"_fit"===i[n]?J(o=this._fit).call(o,this):J(r=this.bindToRedraw).call(r,this,i[n])),this.navigationHammers.push(s)}var a=new al(this.canvas.frame);td(a,function(){t._stopMovement()}),this.navigationHammers.push(a),this.iconsCreated=!0}},{key:"bindToRedraw",value:function(t){var e;void 0===this.boundFunctions[t]&&(this.boundFunctions[t]=J(e=this[t]).call(e,this),this.body.emitter.on("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_startRendering"))}},{key:"unbindFromRedraw",value:function(t){void 0!==this.boundFunctions[t]&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"),delete this.boundFunctions[t])}},{key:"_fit",value:function(){(new Date).valueOf()-this.touchTime>700&&(this.body.emitter.emit("fit",{duration:700}),this.touchTime=(new Date).valueOf())}},{key:"_stopMovement",value:function(){for(var t in this.boundFunctions)Object.prototype.hasOwnProperty.call(this.boundFunctions,t)&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"));this.boundFunctions={}}},{key:"_moveUp",value:function(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function(){var t=this.body.view.scale*(1+this.options.keyboard.speed.zoom),e=this.body.view.translation,i=t/this.body.view.scale,n=(1-i)*this.canvas.canvasViewCenter.x+e.x*i,o=(1-i)*this.canvas.canvasViewCenter.y+e.y*i;this.body.view.scale=t,this.body.view.translation={x:n,y:o},this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:null})}},{key:"_zoomOut",value:function(){var t=this.body.view.scale/(1+this.options.keyboard.speed.zoom),e=this.body.view.translation,i=t/this.body.view.scale,n=(1-i)*this.canvas.canvasViewCenter.x+e.x*i,o=(1-i)*this.canvas.canvasViewCenter.y+e.y*i;this.body.view.scale=t,this.body.view.translation={x:n,y:o},this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:null})}},{key:"configureKeyboardBindings",value:function(){var t,e,i,n,o,r,s,a,l,c,h,d,u,f,p,g,m,v,y,b,w,k,_,x,C=this;void 0!==this.keycharm&&this.keycharm.destroy(),!0===this.options.keyboard.enabled&&(this.keycharm=Ns(!0===this.options.keyboard.bindToWindow?{container:window,preventDefault:!0}:{container:this.canvas.frame,preventDefault:!0}),this.keycharm.reset(),!0===this.activated&&(J(t=this.keycharm).call(t,"up",function(){C.bindToRedraw("_moveUp")},"keydown"),J(e=this.keycharm).call(e,"down",function(){C.bindToRedraw("_moveDown")},"keydown"),J(i=this.keycharm).call(i,"left",function(){C.bindToRedraw("_moveLeft")},"keydown"),J(n=this.keycharm).call(n,"right",function(){C.bindToRedraw("_moveRight")},"keydown"),J(o=this.keycharm).call(o,"=",function(){C.bindToRedraw("_zoomIn")},"keydown"),J(r=this.keycharm).call(r,"num+",function(){C.bindToRedraw("_zoomIn")},"keydown"),J(s=this.keycharm).call(s,"num-",function(){C.bindToRedraw("_zoomOut")},"keydown"),J(a=this.keycharm).call(a,"-",function(){C.bindToRedraw("_zoomOut")},"keydown"),J(l=this.keycharm).call(l,"[",function(){C.bindToRedraw("_zoomOut")},"keydown"),J(c=this.keycharm).call(c,"]",function(){C.bindToRedraw("_zoomIn")},"keydown"),J(h=this.keycharm).call(h,"pageup",function(){C.bindToRedraw("_zoomIn")},"keydown"),J(d=this.keycharm).call(d,"pagedown",function(){C.bindToRedraw("_zoomOut")},"keydown"),J(u=this.keycharm).call(u,"up",function(){C.unbindFromRedraw("_moveUp")},"keyup"),J(f=this.keycharm).call(f,"down",function(){C.unbindFromRedraw("_moveDown")},"keyup"),J(p=this.keycharm).call(p,"left",function(){C.unbindFromRedraw("_moveLeft")},"keyup"),J(g=this.keycharm).call(g,"right",function(){C.unbindFromRedraw("_moveRight")},"keyup"),J(m=this.keycharm).call(m,"=",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),J(v=this.keycharm).call(v,"num+",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),J(y=this.keycharm).call(y,"num-",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),J(b=this.keycharm).call(b,"-",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),J(w=this.keycharm).call(w,"[",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),J(k=this.keycharm).call(k,"]",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),J(_=this.keycharm).call(_,"pageup",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),J(x=this.keycharm).call(x,"pagedown",function(){C.unbindFromRedraw("_zoomOut")},"keyup")))}}]),t}(),od=function(){function t(e,i){hl(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return ul(t,[{key:"setPosition",value:function(t,e){this.x=Bn(t),this.y=Bn(e)}},{key:"setText",value:function(t){t instanceof Element?(this.frame.innerHTML="",this.frame.appendChild(t)):this.frame.innerHTML=t}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-e<this.padding&&(l=!1),this.x+i>o-this.padding&&(a=!0),r=a?this.x-i:this.x,s=l?this.y-e:this.y}else(s=this.y-e)+e+this.padding>n&&(s=n-e-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+i+this.padding>o&&(r=o-i-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),rd=function(){function t(e,i,n){var o,r,s,a,l,c,h,d,u,f,p,g,m;hl(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.navigationHandler=new nd(e,i),this.body.eventListeners.onTap=J(o=this.onTap).call(o,this),this.body.eventListeners.onTouch=J(r=this.onTouch).call(r,this),this.body.eventListeners.onDoubleTap=J(s=this.onDoubleTap).call(s,this),this.body.eventListeners.onHold=J(a=this.onHold).call(a,this),this.body.eventListeners.onDragStart=J(l=this.onDragStart).call(l,this),this.body.eventListeners.onDrag=J(c=this.onDrag).call(c,this),this.body.eventListeners.onDragEnd=J(h=this.onDragEnd).call(h,this),this.body.eventListeners.onMouseWheel=J(d=this.onMouseWheel).call(d,this),this.body.eventListeners.onPinch=J(u=this.onPinch).call(u,this),this.body.eventListeners.onMouseMove=J(f=this.onMouseMove).call(f,this),this.body.eventListeners.onRelease=J(p=this.onRelease).call(p,this),this.body.eventListeners.onContext=J(g=this.onContext).call(g,this),this.touchTime=0,this.drag={},this.pinch={},this.popup=void 0,this.popupObj=void 0,this.popupTimer=void 0,this.body.functions.getPointer=J(m=this.getPointer).call(m,this),this.options={},this.defaultOptions={dragNodes:!0,dragView:!0,hover:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0},navigationButtons:!1,tooltipDelay:300,zoomView:!0,zoomSpeed:1},wt(this.options,this.defaultOptions),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("destroy",function(){clearTimeout(t.popupTimer),delete t.body.functions.getPointer})}},{key:"setOptions",value:function(t){void 0!==t&&(yr(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"],this.options,t),Rr(this.options,t,"keyboard"),t.tooltip&&(wt(this.options.tooltip,t.tooltip),t.tooltip.color&&(this.options.tooltip.color=Sr(t.tooltip.color)))),this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function(t){return{x:t.x-(e=this.canvas.frame.canvas,e.getBoundingClientRect().left),y:t.y-_r(this.canvas.frame.canvas)};var e}},{key:"onTouch",value:function(t){(new Date).valueOf()-this.touchTime>50&&(this.drag.pointer=this.getPointer(t.center),this.drag.pinched=!1,this.pinch.scale=this.body.view.scale,this.touchTime=(new Date).valueOf())}},{key:"onTap",value:function(t){var e=this.getPointer(t.center);this.checkSelectionChanges(e,t,this.selectionHandler.options.multiselect&&(t.changedPointers[0].ctrlKey||t.changedPointers[0].metaKey)),this.selectionHandler._generateClickEvent("click",t,e)}},{key:"onDoubleTap",value:function(t){var e=this.getPointer(t.center);this.selectionHandler._generateClickEvent("doubleClick",t,e)}},{key:"onHold",value:function(t){var e=this.getPointer(t.center);this.checkSelectionChanges(e,t,this.selectionHandler.options.multiselect),this.selectionHandler._generateClickEvent("click",t,e),this.selectionHandler._generateClickEvent("hold",t,e)}},{key:"onRelease",value:function(t){if((new Date).valueOf()-this.touchTime>10){var e=this.getPointer(t.center);this.selectionHandler._generateClickEvent("release",t,e),this.touchTime=(new Date).valueOf()}}},{key:"onContext",value:function(t){var e=this.getPointer({x:t.clientX,y:t.clientY});this.selectionHandler._generateClickEvent("oncontext",t,e)}},{key:"checkSelectionChanges",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.selectionHandler.getSelection(),o=!1;o=!0===i?this.selectionHandler.selectAdditionalOnPoint(t):this.selectionHandler.selectOnPoint(t);var r=this.selectionHandler.getSelection(),s=this._determineDifference(n,r),a=this._determineDifference(r,n);s.edges.length>0&&(this.selectionHandler._generateClickEvent("deselectEdge",e,t,n),o=!0),s.nodes.length>0&&(this.selectionHandler._generateClickEvent("deselectNode",e,t,n),o=!0),a.nodes.length>0&&(this.selectionHandler._generateClickEvent("selectNode",e,t),o=!0),a.edges.length>0&&(this.selectionHandler._generateClickEvent("selectEdge",e,t),o=!0),!0===o&&this.selectionHandler._generateClickEvent("select",e,t)}},{key:"_determineDifference",value:function(t,e){var i=function(t,e){for(var i=[],n=0;n<t.length;n++){var o=t[n];-1===go(e).call(e,o)&&i.push(o)}return i};return{nodes:i(t.nodes,e.nodes),edges:i(t.edges,e.edges)}}},{key:"onDragStart",value:function(t){if(!this.drag.dragging){void 0===this.drag.pointer&&this.onTouch(t);var e=this.selectionHandler.getNodeAt(this.drag.pointer);if(this.drag.dragging=!0,this.drag.selection=[],this.drag.translation=wt({},this.body.view.translation),this.drag.nodeId=void 0,t.srcEvent.shiftKey){this.body.selectionBox.show=!0;var i=this.getPointer(t.center);this.body.selectionBox.position.start={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)}}if(void 0!==e&&!0===this.options.dragNodes){this.drag.nodeId=e.id,!1===e.isSelected()&&(this.selectionHandler.unselectAll(),this.selectionHandler.selectObject(e)),this.selectionHandler._generateClickEvent("dragStart",t,this.drag.pointer);var n=this.selectionHandler.selectionObj.nodes;for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o],s={id:r.id,node:r,x:r.x,y:r.y,xFixed:r.options.fixed.x,yFixed:r.options.fixed.y};r.options.fixed.x=!0,r.options.fixed.y=!0,this.drag.selection.push(s)}}else this.selectionHandler._generateClickEvent("dragStart",t,this.drag.pointer,void 0,!0)}}},{key:"onDrag",value:function(t){var e=this;if(!0!==this.drag.pinched){this.body.emitter.emit("unlockNode");var i=this.getPointer(t.center),n=this.drag.selection;if(n&&n.length&&!0===this.options.dragNodes){this.selectionHandler._generateClickEvent("dragging",t,i);var o=i.x-this.drag.pointer.x,r=i.y-this.drag.pointer.y;Nn(n).call(n,function(t){var i=t.node;!1===t.xFixed&&(i.x=e.canvas._XconvertDOMtoCanvas(e.canvas._XconvertCanvasToDOM(t.x)+o)),!1===t.yFixed&&(i.y=e.canvas._YconvertDOMtoCanvas(e.canvas._YconvertCanvasToDOM(t.y)+r))}),this.body.emitter.emit("startSimulation")}else{if(t.srcEvent.shiftKey){if(this.selectionHandler._generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.emitter.emit("_requestRedraw")}if(!0===this.options.dragView&&!t.srcEvent.shiftKey){if(this.selectionHandler._generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);this.body.view.translation={x:this.drag.translation.x+(i.x-this.drag.pointer.x),y:this.drag.translation.y+(i.y-this.drag.pointer.y)},this.body.emitter.emit("_requestRedraw")}}}}},{key:"onDragEnd",value:function(t){var e=this;if(this.drag.dragging=!1,this.body.selectionBox.show){var i;this.body.selectionBox.show=!1;var n=this.body.selectionBox.position,o={minX:Math.min(n.start.x,n.end.x),minY:Math.min(n.start.y,n.end.y),maxX:Math.max(n.start.x,n.end.x),maxY:Math.max(n.start.y,n.end.y)},r=no(i=this.body.nodeIndices).call(i,function(t){var i=e.body.nodes[t];return i.x>=o.minX&&i.x<=o.maxX&&i.y>=o.minY&&i.y<=o.maxY});Nn(r).call(r,function(t){return e.selectionHandler.selectObject(e.body.nodes[t])}),this.selectionHandler._generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw")}else{var s=this.drag.selection;s&&s.length?(Nn(s).call(s,function(t){t.node.options.fixed.x=t.xFixed,t.node.options.fixed.y=t.yFixed}),this.selectionHandler._generateClickEvent("dragEnd",t,this.getPointer(t.center)),this.body.emitter.emit("startSimulation")):(this.selectionHandler._generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw"))}}},{key:"onPinch",value:function(t){var e=this.getPointer(t.center);this.drag.pinched=!0,void 0===this.pinch.scale&&(this.pinch.scale=1),this.zoom(this.pinch.scale*t.scale,e)}},{key:"zoom",value:function(t,e){if(!0===this.options.zoomView){var i=this.body.view.scale;t<1e-5&&(t=1e-5),t>10&&(t=10);var n=void 0;void 0!==this.drag&&!0===this.drag.dragging&&(n=this.canvas.DOMtoCanvas(this.drag.pointer));var o=this.body.view.translation,r=t/i,s=(1-r)*e.x+o.x*r,a=(1-r)*e.y+o.y*r;if(this.body.view.scale=t,this.body.view.translation={x:s,y:a},null!=n){var l=this.canvas.canvasToDOM(n);this.drag.pointer.x=l.x,this.drag.pointer.y=l.y}this.body.emitter.emit("_requestRedraw"),this.body.emitter.emit("zoom",i<t?{direction:"+",scale:this.body.view.scale,pointer:e}:{direction:"-",scale:this.body.view.scale,pointer:e})}}},{key:"onMouseWheel",value:function(t){if(!0===this.options.zoomView){if(0!==t.deltaY){var e=this.body.view.scale;e*=1+.1*this.options.zoomSpeed*(t.deltaY<0?1:-1);var i=this.getPointer({x:t.clientX,y:t.clientY});this.zoom(e,i)}t.preventDefault()}}},{key:"onMouseMove",value:function(t){var e=this,i=this.getPointer({x:t.clientX,y:t.clientY}),n=!1;void 0!==this.popup&&(!1===this.popup.hidden&&this._checkHidePopup(i),!1===this.popup.hidden&&(n=!0,this.popup.setPosition(i.x+3,i.y-5),this.popup.show())),!1===this.options.keyboard.bindToWindow&&!0===this.options.keyboard.enabled&&this.canvas.frame.focus(),!1===n&&(void 0!==this.popupTimer&&(clearInterval(this.popupTimer),this.popupTimer=void 0),this.drag.dragging||(this.popupTimer=bl(function(){return e._checkShowPopup(i)},this.options.tooltipDelay))),!0===this.options.hover&&this.selectionHandler.hoverObject(t,i)}},{key:"_checkShowPopup",value:function(t){var e=this.canvas._XconvertDOMtoCanvas(t.x),i=this.canvas._YconvertDOMtoCanvas(t.y),n={left:e,top:i,right:e,bottom:i},o=void 0===this.popupObj?void 0:this.popupObj.id,r=!1,s="node";if(void 0===this.popupObj){for(var a,l=this.body.nodeIndices,c=this.body.nodes,h=[],d=0;d<l.length;d++)!0===(a=c[l[d]]).isOverlappingWith(n)&&(r=!0,void 0!==a.getTitle()&&h.push(l[d]));h.length>0&&(this.popupObj=c[h[h.length-1]],r=!0)}if(void 0===this.popupObj&&!1===r){for(var u,f=this.body.edgeIndices,p=this.body.edges,g=[],m=0;m<f.length;m++)!0===(u=p[f[m]]).isOverlappingWith(n)&&!0===u.connected&&void 0!==u.getTitle()&&g.push(f[m]);g.length>0&&(this.popupObj=p[g[g.length-1]],s="edge")}void 0!==this.popupObj?this.popupObj.id!==o&&(void 0===this.popup&&(this.popup=new od(this.canvas.frame)),this.popup.popupTargetType=s,this.popup.popupTargetId=this.popupObj.id,this.popup.setPosition(t.x+3,t.y-5),this.popup.setText(this.popupObj.getTitle()),this.popup.show(),this.body.emitter.emit("showPopup",this.popupObj.id)):void 0!==this.popup&&(this.popup.hide(),this.body.emitter.emit("hidePopup"))}},{key:"_checkHidePopup",value:function(t){var e=this.selectionHandler._pointerToPositionObject(t),i=!1;if("node"===this.popup.popupTargetType){if(void 0!==this.body.nodes[this.popup.popupTargetId]&&!0===(i=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(e))){var n=this.selectionHandler.getNodeAt(t);i=void 0!==n&&n.id===this.popup.popupTargetId}}else void 0===this.selectionHandler.getNodeAt(t)&&void 0!==this.body.edges[this.popup.popupTargetId]&&(i=this.body.edges[this.popup.popupTargetId].isOverlappingWith(e));!1===i&&(this.popupObj=void 0,this.popup.hide(),this.body.emitter.emit("hidePopup"))}}]),t}(),sd=function(){function t(e,i){var n=this;hl(this,t),this.body=e,this.canvas=i,this.selectionObj={nodes:[],edges:[]},this.hoverObj={nodes:{},edges:{}},this.options={},this.defaultOptions={multiselect:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0},wt(this.options,this.defaultOptions),this.body.emitter.on("_dataChanged",function(){n.updateSelection()})}return ul(t,[{key:"setOptions",value:function(t){void 0!==t&&vr(["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"],this.options,t)}},{key:"selectOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);this.unselectAll(),void 0!==i&&(e=this.selectObject(i)),this.body.emitter.emit("_requestRedraw")}return e}},{key:"selectAdditionalOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);void 0!==i&&(e=!0,!0===i.isSelected()?this.deselectObject(i):this.selectObject(i),this.body.emitter.emit("_requestRedraw"))}return e}},{key:"_initBaseEvent",value:function(t,e){var i={};return i.pointer={DOM:{x:e.x,y:e.y},canvas:this.canvas.DOMtoCanvas(e)},i.event=t,i}},{key:"_generateClickEvent",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this._initBaseEvent(e,i);if(!0===o)r.nodes=[],r.edges=[];else{var s=this.getSelection();r.nodes=s.nodes,r.edges=s.edges}void 0!==n&&(r.previousSelection=n),"click"==t&&(r.items=this.getClickedItems(i)),void 0!==e.controlEdge&&(r.controlEdge=e.controlEdge),this.body.emitter.emit(t,r)}},{key:"selectObject",value:function(t){return void 0!==t&&(t instanceof qc&&!0===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.selectConnectedEdges)&&this._selectConnectedEdges(t),t.select(),this._addToSelection(t),!0)}},{key:"deselectObject",value:function(t){!0===t.isSelected()&&(t.selected=!1,this._removeFromSelection(t))}},{key:"_getAllNodesOverlappingWith",value:function(t){for(var e=[],i=this.body.nodes,n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}return e}},{key:"_pointerToPositionObject",value:function(t){var e=this.canvas.DOMtoCanvas(t);return{left:e.x-1,top:e.y+1,right:e.x+1,bottom:e.y-1}}},{key:"getNodeAt",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._pointerToPositionObject(t),n=this._getAllNodesOverlappingWith(i);return n.length>0?!0===e?this.body.nodes[n[n.length-1]]:n[n.length-1]:void 0}},{key:"_getEdgesOverlappingWith",value:function(t,e){for(var i=this.body.edges,n=0;n<this.body.edgeIndices.length;n++){var o=this.body.edgeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}}},{key:"_getAllEdgesOverlappingWith",value:function(t){var e=[];return this._getEdgesOverlappingWith(t,e),e}},{key:"getEdgeAt",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.canvas.DOMtoCanvas(t),n=10,o=null,r=this.body.edges,s=0;s<this.body.edgeIndices.length;s++){var a=this.body.edgeIndices[s],l=r[a];if(l.connected){var c=l.edgeType.getDistanceToEdge(l.from.x,l.from.y,l.to.x,l.to.y,i.x,i.y);c<n&&(o=a,n=c)}}return null!==o?!0===e?this.body.edges[o]:o:void 0}},{key:"_addToSelection",value:function(t){t instanceof qc?this.selectionObj.nodes[t.id]=t:this.selectionObj.edges[t.id]=t}},{key:"_addToHover",value:function(t){t instanceof qc?this.hoverObj.nodes[t.id]=t:this.hoverObj.edges[t.id]=t}},{key:"_removeFromSelection",value:function(t){t instanceof qc?(delete this.selectionObj.nodes[t.id],this._unselectConnectedEdges(t)):delete this.selectionObj.edges[t.id]}},{key:"unselectAll",value:function(){for(var t in this.selectionObj.nodes)Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,t)&&this.selectionObj.nodes[t].unselect();for(var e in this.selectionObj.edges)Object.prototype.hasOwnProperty.call(this.selectionObj.edges,e)&&this.selectionObj.edges[e].unselect();this.selectionObj={nodes:{},edges:{}}}},{key:"_getSelectedNodeCount",value:function(){var t=0;for(var e in this.selectionObj.nodes)Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,e)&&(t+=1);return t}},{key:"_getSelectedNode",value:function(){for(var t in this.selectionObj.nodes)if(Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,t))return this.selectionObj.nodes[t]}},{key:"_getSelectedEdge",value:function(){for(var t in this.selectionObj.edges)if(Object.prototype.hasOwnProperty.call(this.selectionObj.edges,t))return this.selectionObj.edges[t]}},{key:"_getSelectedEdgeCount",value:function(){var t=0;for(var e in this.selectionObj.edges)Object.prototype.hasOwnProperty.call(this.selectionObj.edges,e)&&(t+=1);return t}},{key:"_getSelectedObjectCount",value:function(){var t=0;for(var e in this.selectionObj.nodes)Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,e)&&(t+=1);for(var i in this.selectionObj.edges)Object.prototype.hasOwnProperty.call(this.selectionObj.edges,i)&&(t+=1);return t}},{key:"_selectionIsEmpty",value:function(){for(var t in this.selectionObj.nodes)if(Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,t))return!1;for(var e in this.selectionObj.edges)if(Object.prototype.hasOwnProperty.call(this.selectionObj.edges,e))return!1;return!0}},{key:"_clusterInSelection",value:function(){for(var t in this.selectionObj.nodes)if(Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,t)&&this.selectionObj.nodes[t].clusterSize>1)return!0;return!1}},{key:"_selectConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.select(),this._addToSelection(i)}}},{key:"_hoverConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.hover=!0,this._addToHover(i)}}},{key:"_unselectConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.unselect(),this._removeFromSelection(i)}}},{key:"emitBlurEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e);!0===i.hover&&(i.hover=!1,i instanceof qc?(n.node=i.id,this.body.emitter.emit("blurNode",n)):(n.edge=i.id,this.body.emitter.emit("blurEdge",n)))}},{key:"emitHoverEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e),o=!1;return!1===i.hover&&(i.hover=!0,this._addToHover(i),o=!0,i instanceof qc?(n.node=i.id,this.body.emitter.emit("hoverNode",n)):(n.edge=i.id,this.body.emitter.emit("hoverEdge",n))),o}},{key:"hoverObject",value:function(t,e){var i=this.getNodeAt(e);void 0===i&&(i=this.getEdgeAt(e));var n=!1;for(var o in this.hoverObj.nodes)Object.prototype.hasOwnProperty.call(this.hoverObj.nodes,o)&&(void 0===i||i instanceof qc&&i.id!=o||i instanceof Th)&&(this.emitBlurEvent(t,e,this.hoverObj.nodes[o]),delete this.hoverObj.nodes[o],n=!0);for(var r in this.hoverObj.edges)Object.prototype.hasOwnProperty.call(this.hoverObj.edges,r)&&(!0===n?(this.hoverObj.edges[r].hover=!1,delete this.hoverObj.edges[r]):(void 0===i||i instanceof Th&&i.id!=r||i instanceof qc&&!i.hover)&&(this.emitBlurEvent(t,e,this.hoverObj.edges[r]),delete this.hoverObj.edges[r],n=!0));if(void 0!==i){var s=Wo(this.hoverObj.edges).length,a=Wo(this.hoverObj.nodes).length;(n||i instanceof Th&&0===s&&0===a||i instanceof qc&&0===s&&0===a)&&(n=this.emitHoverEvent(t,e,i)),i instanceof qc&&!0===this.options.hoverConnectedEdges&&this._hoverConnectedEdges(i)}!0===n&&this.body.emitter.emit("_requestRedraw")}},{key:"getSelection",value:function(){return{nodes:this.getSelectedNodes(),edges:this.getSelectedEdges()}}},{key:"getSelectedNodes",value:function(){var t=[];if(!0===this.options.selectable)for(var e in this.selectionObj.nodes)Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,e)&&t.push(this.selectionObj.nodes[e].id);return t}},{key:"getSelectedEdges",value:function(){var t=[];if(!0===this.options.selectable)for(var e in this.selectionObj.edges)Object.prototype.hasOwnProperty.call(this.selectionObj.edges,e)&&t.push(this.selectionObj.edges[e].id);return t}},{key:"setSelection",value:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!t.nodes&&!t.edges)throw"Selection must be an object with nodes and/or edges properties";if((n.unselectAll||void 0===n.unselectAll)&&this.unselectAll(),t.nodes)for(e=0;e<t.nodes.length;e++){var o=this.body.nodes[i=t.nodes[e]];if(!o)throw new RangeError('Node with id "'+i+'" not found');this.selectObject(o,n.highlightEdges)}if(t.edges)for(e=0;e<t.edges.length;e++){var r=this.body.edges[i=t.edges[e]];if(!r)throw new RangeError('Edge with id "'+i+'" not found');this.selectObject(r)}this.body.emitter.emit("_requestRedraw")}},{key:"selectNodes",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({nodes:t},{highlightEdges:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]})}},{key:"selectEdges",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({edges:t})}},{key:"updateSelection",value:function(){for(var t in this.selectionObj.nodes)Object.prototype.hasOwnProperty.call(this.selectionObj.nodes,t)&&(Object.prototype.hasOwnProperty.call(this.body.nodes,t)||delete this.selectionObj.nodes[t]);for(var e in this.selectionObj.edges)Object.prototype.hasOwnProperty.call(this.selectionObj.edges,e)&&(Object.prototype.hasOwnProperty.call(this.body.edges,e)||delete this.selectionObj.edges[e])}},{key:"getClickedItems",value:function(t){for(var e=this.canvas.DOMtoCanvas(t),i=[],n=this.body.nodeIndices,o=this.body.nodes,r=n.length-1;r>=0;r--){var s=o[n[r]].getItemsOnPoint(e);i.push.apply(i,s)}for(var a=this.body.edgeIndices,l=this.body.edges,c=a.length-1;c>=0;c--){var h=l[a[c]].getItemsOnPoint(e);i.push.apply(i,h)}return i}}]),t}(),ad=!a(function(){return Object.isExtensible(Object.preventExtensions({}))}),ld=n(function(t){var e=V.f,i=Qt("meta"),n=0,o=Object.isExtensible||function(){return!0},r=function(t){e(t,i,{value:{objectID:"O"+ ++n,weakData:{}}})},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!b(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!_(t,i)){if(!o(t))return"F";if(!e)return"E";r(t)}return t[i].objectID},getWeakData:function(t,e){if(!_(t,i)){if(!o(t))return!0;if(!e)return!1;r(t)}return t[i].weakData},onFreeze:function(t){return ad&&s.REQUIRED&&o(t)&&!_(t,i)&&r(t),t}};ht[i]=!0}),cd=n(function(t){var e=function(t,e){this.stopped=t,this.result=e};(t.exports=function(t,i,n,o,r){var s,a,l,c,h,d,u,f=L(i,n,o?2:1);if(r)s=t;else{if("function"!=typeof(a=Zi(t)))throw TypeError("Target is not iterable");if(tn(a)){for(l=0,c=ot(t.length);c>l;l++)if((h=o?f(B(u=t[l])[0],u[1]):f(t[l]))&&h instanceof e)return h;return new e(!1)}s=a.call(t)}for(d=s.next;!(u=d.call(s)).done;)if("object"==typeof(h=Ki(s,f,u.value,o))&&h&&h instanceof e)return h;return new e(!1)}).stop=function(t){return new e(!0,t)}}),hd=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t},dd=V.f,ud=He.forEach,fd=Fe.set,pd=Fe.getterFor,gd=function(t,e,i){var n,o=-1!==t.indexOf("Map"),r=-1!==t.indexOf("Weak"),c=o?"set":"add",h=s[t],d=h&&h.prototype,u={};if(l&&"function"==typeof h&&(r||d.forEach&&!a(function(){(new h).entries().next()}))){n=e(function(e,i){fd(hd(e,n,t),{type:t,collection:new h}),null!=i&&cd(i,e[c],e,o)});var f=pd(t);ud(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"==t||"set"==t;!(t in d)||r&&"clear"==t||H(n.prototype,t,function(i,n){var o=f(this).collection;if(!e&&r&&!b(i))return"get"==t&&void 0;var s=o[t](0===i?0:i,n);return e?this:s})}),r||dd(n.prototype,"size",{configurable:!0,get:function(){return f(this).collection.size}})}else n=i.getConstructor(e,t,o,c),ld.REQUIRED=!0;return Te(n,t,!1,!0),u[t]=n,U({global:!0,forced:!0},u),r||i.setStrong(n,t,o),n},md=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:he(t,n,e[n],i);return t},vd=pe("species"),yd=V.f,bd=ld.fastKey,wd=Fe.set,kd=Fe.getterFor,_d={getConstructor:function(t,e,i,n){var o=t(function(t,r){hd(t,o,e),wd(t,{type:e,index:re(null),first:void 0,last:void 0,size:0}),l||(t.size=0),null!=r&&cd(r,t[n],t,i)}),r=kd(e),s=function(t,e,i){var n,o,s=r(t),c=a(t,e);return c?c.value=i:(s.last=c={index:o=bd(e,!0),key:e,value:i,previous:n=s.last,next:void 0,removed:!1},s.first||(s.first=c),n&&(n.next=c),l?s.size++:t.size++,"F"!==o&&(s.index[o]=c)),t},a=function(t,e){var i,n=r(t),o=bd(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key==e)return i};return md(o.prototype,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,l?t.size=0:this.size=0},delete:function(t){var e=r(this),i=a(this,t);if(i){var n=i.next,o=i.previous;delete e.index[i.index],i.removed=!0,o&&(o.next=n),n&&(n.previous=o),e.first==i&&(e.first=n),e.last==i&&(e.last=o),l?e.size--:this.size--}return!!i},forEach:function(t){for(var e,i=r(this),n=L(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),md(o.prototype,i?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return s(this,0===t?0:t,e)}}:{add:function(t){return s(this,t=0===t?0:t,t)}}),l&&yd(o.prototype,"size",{get:function(){return r(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=kd(e),r=kd(n);zi(t,e,function(t,e){wd(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),function(t){var e=Dt(t);l&&e&&!e[vd]&&(0,V.f)(e,vd,{configurable:!0,get:function(){return this}})}(e)}},xd=(gd("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},_d),z.Map),Cd=function(t){return function(e,i,n,o){F(i);var r=mt(e),s=m(r),a=ot(r.length),l=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=c;break}if(l+=c,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=c)l in s&&(o=i(o,s[l],l,r));return o}},Ed=[Cd(!1),Cd(!0)][0],Td=_n("reduce"),Sd=Tn("reduce",{1:0});U({target:"Array",proto:!0,forced:!Td||!Sd},{reduce:function(t){return Ed(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Ad=X("Array").reduce,Od=Array.prototype,Id=[],Pd=Id.sort,Md=a(function(){Id.sort(void 0)}),Dd=a(function(){Id.sort(null)}),Nd=_n("sort");U({target:"Array",proto:!0,forced:Md||!Dd||!Nd},{sort:function(t){return void 0===t?Pd.call(mt(this)):Pd.call(mt(this),F(t))}});var Rd=X("Array").sort,zd=Array.prototype,Fd=function(t){var e=t.sort;return t===zd||t instanceof Array&&e===zd.sort?Rd:e},Ld=n(function(t,e){!function(t){t.__esModule=!0,t.sort=function(t,e,i,s){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");e?"function"!=typeof e&&(s=i,i=e,e=n):e=n,i||(i=0),s||(s=t.length);var a=s-i;if(!(a<2)){var c=0;if(a<32)return void r(t,i,s,i+(c=o(t,i,s,e)),e);var h=new l(t,e),d=function(t){for(var e=0;t>=32;)e|=1&t,t>>=1;return t+e}(a);do{if((c=o(t,i,s,e))<d){var u=a;u>d&&(u=d),r(t,i,i+u,i+c,e),c=u}h.pushRun(i,c),h.mergeRuns(),a-=c,i+=c}while(0!==a);h.forceMergeRuns()}};var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function i(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function n(t,n){if(t===n)return 0;if(~~t===t&&~~n===n){if(0===t||0===n)return t<n?-1:1;if(t<0||n<0){if(n>=0)return-1;if(t>=0)return 1;t=-t,n=-n}var o=i(t),r=i(n),s=0;return o<r?(t*=e[r-o-1],n/=10,s=-1):o>r&&(n*=e[o-r-1],t/=10,s=1),t===n?s:t<n?-1:1}var a=String(t),l=String(n);return a===l?0:a<l?-1:1}function o(t,e,i,n){var o=e+1;if(o===i)return 1;if(n(t[o++],t[e])<0){for(;o<i&&n(t[o],t[o-1])<0;)o++;!function(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}(t,e,o)}else for(;o<i&&n(t[o],t[o-1])>=0;)o++;return o-e}function r(t,e,i,n,o){for(n===e&&n++;n<i;n++){for(var r=t[n],s=e,a=n;s<a;){var l=s+a>>>1;o(r,t[l])<0?a=l:s=l+1}var c=n-s;switch(c){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;c>0;)t[s+c]=t[s+c-1],c--}t[s]=r}}function s(t,e,i,n,o,r){var s=0,a=0,l=1;if(r(t,e[i+o])>0){for(a=n-o;l<a&&r(t,e[i+o+l])>0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=o,l+=o}else{for(a=o+1;l<a&&r(t,e[i+o-l])<=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var c=s;s=o-l,l=o-c}for(s++;s<l;){var h=s+(l-s>>>1);r(t,e[i+h])>0?s=h+1:l=h}return l}function a(t,e,i,n,o,r){var s=0,a=0,l=1;if(r(t,e[i+o])<0){for(a=o+1;l<a&&r(t,e[i+o-l])<0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var c=s;s=o-l,l=o-c}else{for(a=n-o;l<a&&r(t,e[i+o+l])>=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=o,l+=o}for(s++;s<l;){var h=s+(l-s>>>1);r(t,e[i+h])<0?l=h:s=h+1}return l}var l=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=null,this.compare=null,this.minGallop=7,this.length=0,this.tmpStorageLength=256,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=e,this.compare=i,this.length=e.length,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return t.prototype.pushRun=function(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1},t.prototype.mergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}},t.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}},t.prototype.mergeAt=function(t){var e=this.compare,i=this.array,n=this.runStart[t],o=this.runLength[t],r=this.runStart[t+1],l=this.runLength[t+1];this.runLength[t]=o+l,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;var c=a(i[r],i,n,o,0,e);n+=c,0!=(o-=c)&&0!==(l=s(i[n+o-1],i,r,l,l-1,e))&&(o<=l?this.mergeLow(n,o,r,l):this.mergeHigh(n,o,r,l))},t.prototype.mergeLow=function(t,e,i,n){var o=this.compare,r=this.array,l=this.tmp,c=0;for(c=0;c<e;c++)l[c]=r[t+c];var h=0,d=i,u=t;if(r[u++]=r[d++],0!=--n)if(1!==e){for(var f=this.minGallop;;){var p=0,g=0,m=!1;do{if(o(r[d],l[h])<0){if(r[u++]=r[d++],g++,p=0,0==--n){m=!0;break}}else if(r[u++]=l[h++],p++,g=0,1==--e){m=!0;break}}while((p|g)<f);if(m)break;do{if(0!==(p=a(r[d],l,h,e,0,o))){for(c=0;c<p;c++)r[u+c]=l[h+c];if(u+=p,h+=p,(e-=p)<=1){m=!0;break}}if(r[u++]=r[d++],0==--n){m=!0;break}if(0!==(g=s(l[h],r,d,n,0,o))){for(c=0;c<g;c++)r[u+c]=r[d+c];if(u+=g,d+=g,0==(n-=g)){m=!0;break}}if(r[u++]=l[h++],1==--e){m=!0;break}f--}while(p>=7||g>=7);if(m)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),1===e){for(c=0;c<n;c++)r[u+c]=r[d+c];r[u+n]=l[h]}else{if(0===e)throw new Error("mergeLow preconditions were not respected");for(c=0;c<e;c++)r[u+c]=l[h+c]}}else{for(c=0;c<n;c++)r[u+c]=r[d+c];r[u+n]=l[h]}else for(c=0;c<e;c++)r[u+c]=l[h+c]},t.prototype.mergeHigh=function(t,e,i,n){var o=this.compare,r=this.array,l=this.tmp,c=0;for(c=0;c<n;c++)l[c]=r[i+c];var h=t+e-1,d=n-1,u=i+n-1,f=0,p=0;if(r[u--]=r[h--],0!=--e)if(1!==n){for(var g=this.minGallop;;){var m=0,v=0,y=!1;do{if(o(l[d],r[h])<0){if(r[u--]=r[h--],m++,v=0,0==--e){y=!0;break}}else if(r[u--]=l[d--],v++,m=0,1==--n){y=!0;break}}while((m|v)<g);if(y)break;do{if(0!=(m=e-a(l[d],r,t,e,e-1,o))){for(e-=m,p=1+(u-=m),f=1+(h-=m),c=m-1;c>=0;c--)r[p+c]=r[f+c];if(0===e){y=!0;break}}if(r[u--]=l[d--],1==--n){y=!0;break}if(0!=(v=n-s(r[h],l,0,n,n-1,o))){for(n-=v,p=1+(u-=v),f=1+(d-=v),c=0;c<v;c++)r[p+c]=l[f+c];if(n<=1){y=!0;break}}if(r[u--]=r[h--],0==--e){y=!0;break}g--}while(m>=7||v>=7);if(y)break;g<0&&(g=0),g+=2}if(this.minGallop=g,g<1&&(this.minGallop=1),1===n){for(p=1+(u-=e),f=1+(h-=e),c=e-1;c>=0;c--)r[p+c]=r[f+c];r[u]=l[d]}else{if(0===n)throw new Error("mergeHigh preconditions were not respected");for(f=u-(n-1),c=0;c<n;c++)r[f+c]=l[c]}}else{for(p=1+(u-=e),f=1+(h-=e),c=e-1;c>=0;c--)r[p+c]=r[f+c];r[u]=l[d]}else for(f=u-(n-1),c=0;c<n;c++)r[f+c]=l[c]},t}()}(e)});function Bd(t){var e=function(){if("undefined"==typeof Reflect||!Jl)return!1;if(Jl.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Jl(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=sc(t);if(e){var o=sc(this).constructor;i=Jl(n,arguments,o)}else i=n.apply(this,arguments);return oc(this,i)}}var jd=function(){function t(){hl(this,t)}return ul(t,[{key:"abstract",value:function(){throw new Error("Can't instantiate abstract class!")}},{key:"fake_use",value:function(){}},{key:"curveType",value:function(){return this.abstract()}},{key:"getPosition",value:function(t){return this.fake_use(t),this.abstract()}},{key:"setPosition",value:function(t,e){this.fake_use(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0),this.abstract()}},{key:"getTreeSize",value:function(t){return this.fake_use(t),this.abstract()}},{key:"sort",value:function(t){this.fake_use(t),this.abstract()}},{key:"fix",value:function(t,e){this.fake_use(t,e),this.abstract()}},{key:"shift",value:function(t,e){this.fake_use(t,e),this.abstract()}}]),t}(),Vd=function(t){nc(i,t);var e=Bd(i);function i(t){var n;return hl(this,i),(n=e.call(this)).layout=t,n}return ul(i,[{key:"curveType",value:function(){return"horizontal"}},{key:"getPosition",value:function(t){return t.x}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.x=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_x,max:e.max_x}}},{key:"sort",value:function(t){Ld.sort(t,function(t,e){return t.x-e.x})}},{key:"fix",value:function(t,e){t.y=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.y=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].x+=e}}]),i}(jd),Hd=function(t){nc(i,t);var e=Bd(i);function i(t){var n;return hl(this,i),(n=e.call(this)).layout=t,n}return ul(i,[{key:"curveType",value:function(){return"vertical"}},{key:"getPosition",value:function(t){return t.y}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.y=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_y,max:e.max_y}}},{key:"sort",value:function(t){Ld.sort(t,function(t,e){return t.y-e.y})}},{key:"fix",value:function(t,e){t.x=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.x=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].y+=e}}]),i}(jd),Wd=He.every,qd=_n("every"),Ud=Tn("every");U({target:"Array",proto:!0,forced:!qd||!Ud},{every:function(t){return Wd(this,t,arguments.length>1?arguments[1]:void 0)}});var Yd=X("Array").every,Gd=Array.prototype,Zd=function(t){var e=t.every;return t===Gd||t instanceof Array&&e===Gd.every?Yd:e},$d=(gd("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},_d),z.Set);function Xd(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Kd(t,e){var i=new $d;return Nn(t).call(t,function(t){var e;Nn(e=t.edges).call(e,function(t){t.connected&&i.add(t)})}),Nn(i).call(i,function(t){var i=t.from.id,n=t.to.id;null==e[i]&&(e[i]=0),(null==e[n]||e[i]>=e[n])&&(e[n]=e[i]+1)}),e}function Qd(t,e,i,n,o){var r,s=n.size,a=i+"Id",l="to"===i?1:-1,c=function(t,e){var i;if(void 0===nr||null==Xi(t)){if(Xo(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Xd(t,e);var n=Jo(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?ln(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xd(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=$i(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(n);try{var h=function(){var c=jo(r.value,2),h=c[0],d=c[1];if(!n.has(h)||!t(d))return"continue";o[h]=0;for(var u=[d],f=0,p=void 0,g=function(){var t,r;if(!n.has(h))return"continue";var c=o[p.id]+l;if(Nn(t=no(r=p.edges).call(r,function(t){return t.connected&&t.to!==t.from&&t[i]!==p&&n.has(t.toId)&&n.has(t.fromId)})).call(t,function(t){var n=t[a],r=o[n];(null==r||e(c,r))&&(o[n]=c,u.push(t[i]))}),f>s)return{v:{v:Kd(n,o)}};++f};p=u.pop();){var m=g();switch(m){case"continue":continue;default:if("object"===Qo(m))return m.v}}};for(c.s();!(r=c.n()).done;){var d=h();switch(d){case"continue":continue;default:if("object"===Qo(d))return d.v}}}catch(t){c.e(t)}finally{c.f()}return o}var Jd=function(){function t(){hl(this,t),this.childrenReference={},this.parentReference={},this.trees={},this.distributionOrdering={},this.levels={},this.distributionIndex={},this.isTree=!1,this.treeIndex=-1}return ul(t,[{key:"addRelation",value:function(t,e){void 0===this.childrenReference[t]&&(this.childrenReference[t]=[]),this.childrenReference[t].push(e),void 0===this.parentReference[e]&&(this.parentReference[e]=[]),this.parentReference[e].push(t)}},{key:"checkIfTree",value:function(){for(var t in this.parentReference)if(this.parentReference[t].length>1)return void(this.isTree=!1);this.isTree=!0}},{key:"numTrees",value:function(){return this.treeIndex+1}},{key:"setTreeIndex",value:function(t,e){void 0!==e&&void 0===this.trees[t.id]&&(this.trees[t.id]=e,this.treeIndex=Math.max(e,this.treeIndex))}},{key:"ensureLevel",value:function(t){void 0===this.levels[t]&&(this.levels[t]=0)}},{key:"getMaxLevel",value:function(t){var e=this,i={};return function t(n){if(void 0!==i[n])return i[n];var o=e.levels[n];if(e.childrenReference[n]){var r=e.childrenReference[n];if(r.length>0)for(var s=0;s<r.length;s++)o=Math.max(o,t(r[s]))}return i[n]=o,o}(t)}},{key:"levelDownstream",value:function(t,e){void 0===this.levels[e.id]&&(void 0===this.levels[t.id]&&(this.levels[t.id]=0),this.levels[e.id]=this.levels[t.id]+1)}},{key:"setMinLevelToZero",value:function(t){var e=1e9;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&void 0!==this.levels[i]&&(e=Math.min(this.levels[i],e));for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==this.levels[n]&&(this.levels[n]-=e)}},{key:"getTreeSize",value:function(t,e){var i=1e9,n=-1e9,o=1e9,r=-1e9;for(var s in this.trees)if(Object.prototype.hasOwnProperty.call(this.trees,s)&&this.trees[s]===e){var a=t[s];i=Math.min(a.x,i),n=Math.max(a.x,n),o=Math.min(a.y,o),r=Math.max(a.y,r)}return{min_x:i,max_x:n,min_y:o,max_y:r}}},{key:"hasSameParent",value:function(t,e){var i=this.parentReference[t.id],n=this.parentReference[e.id];if(void 0===i||void 0===n)return!1;for(var o=0;o<i.length;o++)for(var r=0;r<n.length;r++)if(i[o]==n[r])return!0;return!1}},{key:"inSameSubNetwork",value:function(t,e){return this.trees[t.id]===this.trees[e.id]}},{key:"getLevels",value:function(){return Wo(this.distributionOrdering)}},{key:"addToOrdering",value:function(t,e){void 0===this.distributionOrdering[e]&&(this.distributionOrdering[e]=[]);var i=!1,n=this.distributionOrdering[e];for(var o in n)if(n[o]===t){i=!0;break}i||(this.distributionOrdering[e].push(t),this.distributionIndex[t.id]=this.distributionOrdering[e].length-1)}}]),t}(),tu=function(){function t(e){hl(this,t),this.body=e,this._resetRNG(Math.random()+":"+Vo()),this.setPhysics=!1,this.options={},this.optionsBackup={physics:{}},this.defaultOptions={randomSeed:void 0,improvedLayout:!0,clusterThreshold:150,hierarchical:{enabled:!1,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:"UD",sortMethod:"hubsize"}},wt(this.options,this.defaultOptions),this.bindEventListeners()}return ul(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_dataLoaded",function(){t.layoutNetwork()}),this.body.emitter.on("_resetHierarchicalLayout",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_adjustEdgesForHierarchicalLayout",function(){if(!0===t.options.hierarchical.enabled){var e=t.direction.curveType();t.body.emitter.emit("_forceDisableDynamicCurves",e,!1)}})}},{key:"setOptions",value:function(t,e){if(void 0!==t){var i=this.options.hierarchical,n=i.enabled;if(vr(["randomSeed","improvedLayout","clusterThreshold"],this.options,t),Rr(this.options,t,"hierarchical"),void 0!==t.randomSeed&&this._resetRNG(t.randomSeed),!0===i.enabled)return!0===n&&this.body.emitter.emit("refresh",!0),"RL"===i.direction||"DU"===i.direction?i.levelSeparation>0&&(i.levelSeparation*=-1):i.levelSeparation<0&&(i.levelSeparation*=-1),this.setDirectionStrategy(),this.body.emitter.emit("_resetHierarchicalLayout"),this.adaptAllOptionsForHierarchicalLayout(e);if(!0===n)return this.body.emitter.emit("refresh"),br(e,this.optionsBackup)}return e}},{key:"_resetRNG",value:function(t){this.initialRandomSeed=t,this._rng=rr(this.initialRandomSeed)}},{key:"adaptAllOptionsForHierarchicalLayout",value:function(t){if(!0===this.options.hierarchical.enabled){var e=this.optionsBackup.physics;void 0===t.physics||!0===t.physics?(t.physics={enabled:void 0===e.enabled||e.enabled,solver:"hierarchicalRepulsion"},e.enabled=void 0===e.enabled||e.enabled,e.solver=e.solver||"barnesHut"):"object"===Qo(t.physics)?(e.enabled=void 0===t.physics.enabled||t.physics.enabled,e.solver=t.physics.solver||"barnesHut",t.physics.solver="hierarchicalRepulsion"):!1!==t.physics&&(e.solver="barnesHut",t.physics={solver:"hierarchicalRepulsion"});var i=this.direction.curveType();if(void 0===t.edges)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges={smooth:!1};else if(void 0===t.edges.smooth)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges.smooth=!1;else if("boolean"==typeof t.edges.smooth)this.optionsBackup.edges={smooth:t.edges.smooth},t.edges.smooth={enabled:t.edges.smooth,type:i};else{var n=t.edges.smooth;void 0!==n.type&&"dynamic"!==n.type&&(i=n.type),this.optionsBackup.edges={smooth:{enabled:void 0===n.enabled||n.enabled,type:void 0===n.type?"dynamic":n.type,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}},t.edges.smooth={enabled:void 0===n.enabled||n.enabled,type:i,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}}this.body.emitter.emit("_forceDisableDynamicCurves",i)}return t}},{key:"positionInitially",value:function(t){if(!0!==this.options.hierarchical.enabled){this._resetRNG(this.initialRandomSeed);for(var e=t.length+50,i=0;i<t.length;i++){var n=t[i],o=2*Math.PI*this._rng();void 0===n.x&&(n.x=e*Math.cos(o)),void 0===n.y&&(n.y=e*Math.sin(o))}}}},{key:"layoutNetwork",value:function(){if(!0!==this.options.hierarchical.enabled&&!0===this.options.improvedLayout){for(var t=this.body.nodeIndices,e=0,i=0;i<t.length;i++)!0===this.body.nodes[t[i]].predefinedPosition&&(e+=1);if(e<.5*t.length){var n=0,o=this.options.clusterThreshold,r={clusterNodeProperties:{shape:"ellipse",label:"",group:"",font:{multi:!1}},clusterEdgeProperties:{label:"",font:{multi:!1},smooth:{enabled:!1}}};if(t.length>o){for(var s=t.length;t.length>o&&n<=10;){var a=t.length;if((n+=1)%3==0?this.body.modules.clustering.clusterBridges(r):this.body.modules.clustering.clusterOutliers(r),a==t.length&&n%3!=0)return this._declusterAll(),this.body.emitter.emit("_layoutFailed"),void console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.")}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*s)})}n>10&&console.info("The clustering didn't succeed within the amount of interations allowed, progressing with partial result."),this.body.modules.kamadaKawai.solve(t,this.body.edgeIndices,!0),this._shiftToCenter();for(var l=0;l<t.length;l++){var c=this.body.nodes[t[l]];!1===c.predefinedPosition&&(c.x+=70*(.5-this._rng()),c.y+=70*(.5-this._rng()))}this._declusterAll(),this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function(){for(var t=Zh.getRangeCore(this.body.nodes,this.body.nodeIndices),e=Zh.findCenter(t),i=0;i<this.body.nodeIndices.length;i++){var n=this.body.nodes[this.body.nodeIndices[i]];n.x-=e.x,n.y-=e.y}}},{key:"_declusterAll",value:function(){for(var t=!0;!0===t;){t=!1;for(var e=0;e<this.body.nodeIndices.length;e++)!0===this.body.nodes[this.body.nodeIndices[e]].isCluster&&(t=!0,this.body.modules.clustering.openCluster(this.body.nodeIndices[e],{},!1));!0===t&&this.body.emitter.emit("_dataChanged")}}},{key:"getSeed",value:function(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function(){if(!0===this.options.hierarchical.enabled&&this.body.nodeIndices.length>0){var t,e,i=!1,n=!1;for(e in this.lastNodeOnLevel={},this.hierarchical=new Jd,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&(void 0!==(t=this.body.nodes[e]).options.level?(i=!0,this.hierarchical.levels[e]=t.options.level):n=!0);if(!0===n&&!0===i)throw new Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");if(!0===n){var o=this.options.hierarchical.sortMethod;"hubsize"===o?this._determineLevelsByHubsize():"directed"===o?this._determineLevelsDirected():"custom"===o&&this._determineLevelsCustomCallback()}for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.hierarchical.ensureLevel(r);var s=this._getDistribution();this._generateMap(),this._placeNodesByHierarchy(s),this._condenseHierarchy(),this._shiftToCenter()}}},{key:"_condenseHierarchy",value:function(){var t=this,e=!1,i={},n=function(e,i){var n=t.hierarchical.trees;for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&n[o]===e&&t.direction.shift(o,i)},o=function e(i,n){if(!n[i.id]&&(n[i.id]=!0,t.hierarchical.childrenReference[i.id])){var o=t.hierarchical.childrenReference[i.id];if(o.length>0)for(var r=0;r<o.length;r++)e(t.body.nodes[o[r]],n)}},r=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e9,n=1e9,o=1e9,r=1e9,s=-1e9;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=t.body.nodes[a],c=t.hierarchical.levels[l.id],h=t.direction.getPosition(l),d=t._getSpaceAroundNode(l,e),u=jo(d,2),f=u[1];n=Math.min(u[0],n),o=Math.min(f,o),c<=i&&(r=Math.min(h,r),s=Math.max(h,s))}return[r,s,n,o]},s=function(e,i){var n=t.hierarchical.getMaxLevel(e.id),o=t.hierarchical.getMaxLevel(i.id);return Math.min(n,o)},a=function(e,i,n){for(var o=t.hierarchical,r=0;r<i.length;r++){var s=o.distributionOrdering[i[r]];if(s.length>1)for(var a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];o.hasSameParent(l,c)&&o.inSameSubNetwork(l,c)&&e(l,c,n)}}},l=function(i,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=t.direction.getPosition(i),c=t.direction.getPosition(n),h=Math.abs(c-l),d=t.options.hierarchical.nodeSpacing;if(h>d){var u={},f={};o(i,u),o(n,f);var p=s(i,n),g=r(u,p),m=r(f,p),v=g[1],y=m[0],b=m[2];if(Math.abs(v-y)>d){var w=v-y+d;w<-b+d&&(w=-b+d),w<0&&(t._shiftBlock(n.id,w),e=!0,!0===a&&t._centerParent(n))}}},c=function(n,s){for(var a=s.id,l=s.edges,c=t.hierarchical.levels[s.id],h=t.options.hierarchical.levelSeparation*t.options.hierarchical.levelSeparation,d={},u=[],f=0;f<l.length;f++){var p=l[f];if(p.toId!=p.fromId){var g=p.toId==a?p.from:p.to;d[l[f].id]=g,t.hierarchical.levels[g.id]<c&&u.push(p)}}var m=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==d[i[o].id]){var r=t.direction.getPosition(d[i[o].id])-e;n+=r/Math.sqrt(r*r+h)}return n},v=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==d[i[o].id]){var r=t.direction.getPosition(d[i[o].id])-e;n-=h*Math.pow(r*r+h,-1.5)}return n},y=function(e,i){for(var n=t.direction.getPosition(s),o={},r=0;r<e;r++){var a=m(n,i),l=v(n,i);if(void 0!==o[n-=Math.max(-40,Math.min(40,Math.round(a/l)))])break;o[n]=r}return n},b=y(n,u);!function(n){var a=t.direction.getPosition(s);if(void 0===i[s.id]){var l={};o(s,l),i[s.id]=l}var c=r(i[s.id]),h=c[2],d=n-a,u=0;d>0?u=Math.min(d,c[3]-t.options.hierarchical.nodeSpacing):d<0&&(u=-Math.min(-d,h-t.options.hierarchical.nodeSpacing)),0!=u&&(t._shiftBlock(s.id,u),e=!0)}(b),function(i){var n=t.direction.getPosition(s),o=t._getSpaceAroundNode(s),r=jo(o,2),a=r[0],l=i-n,c=n;l>0?c=Math.min(n+(r[1]-t.options.hierarchical.nodeSpacing),i):l<0&&(c=Math.max(n-(a-t.options.hierarchical.nodeSpacing),i)),c!==n&&(t.direction.setPosition(s,c),e=!0)}(b=y(n,l))};!0===this.options.hierarchical.blockShifting&&(function(i){var n=t.hierarchical.getLevels();n=Vh(n).call(n);for(var o=0;o<5&&(e=!1,a(l,n,!0),!0===e);o++);}(),function(){for(var e in t.body.nodes)Object.prototype.hasOwnProperty.call(t.body.nodes,e)&&t._centerParent(t.body.nodes[e])}()),!0===this.options.hierarchical.edgeMinimization&&function(i){var n=t.hierarchical.getLevels();n=Vh(n).call(n);for(var o=0;o<20;o++){e=!1;for(var r=0;r<n.length;r++)for(var s=t.hierarchical.distributionOrdering[n[r]],a=0;a<s.length;a++)c(1e3,s[a]);if(!0!==e)break}}(),!0===this.options.hierarchical.parentCentralization&&function(){var e=t.hierarchical.getLevels();e=Vh(e).call(e);for(var i=0;i<e.length;i++)for(var n=t.hierarchical.distributionOrdering[e[i]],o=0;o<n.length;o++)t._centerParent(n[o])}(),function(){for(var e=function(){for(var e=[],i=0;i<t.hierarchical.numTrees();i++)e.push(t.direction.getTreeSize(i));return e}(),i=0,o=0;o<e.length-1;o++)n(o+1,i+=e[o].max-e[o+1].min+t.options.hierarchical.treeSpacing)}()}},{key:"_getSpaceAroundNode",value:function(t,e){var i=!0;void 0===e&&(i=!1);var n=this.hierarchical.levels[t.id];if(void 0!==n){var o=this.hierarchical.distributionIndex[t.id],r=this.direction.getPosition(t),s=this.hierarchical.distributionOrdering[n],a=1e9,l=1e9;if(0!==o){var c=s[o-1];(!0===i&&void 0===e[c.id]||!1===i)&&(a=r-this.direction.getPosition(c))}if(o!=s.length-1){var h=s[o+1];if(!0===i&&void 0===e[h.id]||!1===i){var d=this.direction.getPosition(h);l=Math.min(l,d-r)}}return[a,l]}return[0,0]}},{key:"_centerParent",value:function(t){if(this.hierarchical.parentReference[t.id])for(var e=this.hierarchical.parentReference[t.id],i=0;i<e.length;i++){var n=e[i],o=this.body.nodes[n],r=this.hierarchical.childrenReference[n];if(void 0!==r){var s=this._getCenterPosition(r),a=this.direction.getPosition(o),l=this._getSpaceAroundNode(o),c=jo(l,2),h=c[0],d=c[1],u=a-s;(u<0&&Math.abs(u)<d-this.options.hierarchical.nodeSpacing||u>0&&Math.abs(u)<h-this.options.hierarchical.nodeSpacing)&&this.direction.setPosition(o,s)}}}},{key:"_placeNodesByHierarchy",value:function(t){for(var e in this.positionedNodes={},t)if(Object.prototype.hasOwnProperty.call(t,e)){var i,n=Wo(t[e]);n=this._indexArrayToNodes(n),Fd(i=this.direction).call(i,n);for(var o=0,r=0;r<n.length;r++){var s=n[r];if(void 0===this.positionedNodes[s.id]){var a=this.options.hierarchical.nodeSpacing,l=a*o;o>0&&(l=this.direction.getPosition(n[r-1])+a),this.direction.setPosition(s,l,e),this._validatePositionAndContinue(s,e,l),o++}}}}},{key:"_placeBranchNodes",value:function(t,e){var i,n=this.hierarchical.childrenReference[t];if(void 0!==n){for(var o=[],r=0;r<n.length;r++)o.push(this.body.nodes[n[r]]);Fd(i=this.direction).call(i,o);for(var s=0;s<o.length;s++){var a=o[s],l=this.hierarchical.levels[a.id];if(!(l>e&&void 0===this.positionedNodes[a.id]))return;var c,h=this.options.hierarchical.nodeSpacing;c=0===s?this.direction.getPosition(this.body.nodes[t]):this.direction.getPosition(o[s-1])+h,this.direction.setPosition(a,c,l),this._validatePositionAndContinue(a,l,c)}var d=this._getCenterPosition(o);this.direction.setPosition(this.body.nodes[t],d,e)}}},{key:"_validatePositionAndContinue",value:function(t,e,i){if(this.hierarchical.isTree){if(void 0!==this.lastNodeOnLevel[e]){var n=this.direction.getPosition(this.body.nodes[this.lastNodeOnLevel[e]]);if(i-n<this.options.hierarchical.nodeSpacing){var o=n+this.options.hierarchical.nodeSpacing-i,r=this._findCommonParent(this.lastNodeOnLevel[e],t.id);this._shiftBlock(r.withChild,o)}}this.lastNodeOnLevel[e]=t.id,this.positionedNodes[t.id]=!0,this._placeBranchNodes(t.id,e)}}},{key:"_indexArrayToNodes",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.body.nodes[t[i]]);return e}},{key:"_getDistribution",value:function(){var t,e,i={};for(t in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,t)){var n=void 0===this.hierarchical.levels[t]?0:this.hierarchical.levels[t];this.direction.fix(e=this.body.nodes[t],n),void 0===i[n]&&(i[n]={}),i[n][t]=e}return i}},{key:"_getActiveEdges",value:function(t){var e=this,i=[];return xr(t.edges,function(t){var n;-1!==go(n=e.body.edgeIndices).call(n,t.id)&&i.push(t)}),i}},{key:"_getHubSizes",value:function(){var t=this,e={};xr(this.body.nodeIndices,function(i){var n=t._getActiveEdges(t.body.nodes[i]).length;e[n]=!0});var i=[];return xr(e,function(t){i.push(Number(t))}),Fd(Ld).call(Ld,i,function(t,e){return e-t}),i}},{key:"_determineLevelsByHubsize",value:function(){for(var t=this,e=function(e,i){t.hierarchical.levelDownstream(e,i)},i=this._getHubSizes(),n=function(n){var o=i[n];if(0===o)return"break";xr(t.body.nodeIndices,function(i){o===t._getActiveEdges(t.body.nodes[i]).length&&t._crawlNetwork(e,i)})},o=0;o<i.length&&"break"!==n(o);++o);}},{key:"_determineLevelsCustomCallback",value:function(){var t=this;this._crawlNetwork(function(e,i,n){var o=t.hierarchical.levels[e.id];void 0===o&&(o=t.hierarchical.levels[e.id]=1e5);var r=(Zh.cloneOptions(e,"node"),Zh.cloneOptions(i,"node"),void Zh.cloneOptions(n,"edge"));t.hierarchical.levels[i.id]=o+r}),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_determineLevelsDirected",value:function(){var t,e=this,i=function(t){var e=t.reduce;return t===Od||t instanceof Array&&e===Od.reduce?Ad:e}(t=this.body.nodeIndices).call(t,function(t,i){return t.set(i,e.body.nodes[i]),t},new xd),n=this.hierarchical.levels;this.hierarchical.levels="roots"===this.options.hierarchical.shakeTowards?function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un(null);return Qd(function(e){var i,n;return Zd(i=no(n=e.edges).call(n,function(e){return t.has(e.toId)})).call(i,function(t){return t.from===e})},function(t,e){return e<t},"to",t,e)}(i,n):function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:un(null);return Qd(function(e){var i,n;return Zd(i=no(n=e.edges).call(n,function(e){return t.has(e.toId)})).call(i,function(t){return t.to===e})},function(t,e){return e>t},"from",t,e)}(i,n),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_generateMap",value:function(){var t=this;this._crawlNetwork(function(e,i){t.hierarchical.levels[i.id]>t.hierarchical.levels[e.id]&&t.hierarchical.addRelation(e.id,i.id)}),this.hierarchical.checkIfTree()}},{key:"_crawlNetwork",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments.length>1?arguments[1]:void 0,n={},o=function i(o,r){if(void 0===n[o.id]){var s;t.hierarchical.setTreeIndex(o,r),n[o.id]=!0;for(var a=t._getActiveEdges(o),l=0;l<a.length;l++){var c=a[l];!0===c.connected&&o.id!=(s=c.toId==o.id?c.from:c.to).id&&(e(o,s,c),i(s,r))}}};if(void 0===i)for(var r=0,s=0;s<this.body.nodeIndices.length;s++){var a=this.body.nodeIndices[s];void 0===n[a]&&(o(this.body.nodes[a],r),r+=1)}else{var l=this.body.nodes[i];if(void 0===l)return void console.error("Node not found:",i);o(l)}}},{key:"_shiftBlock",value:function(t,e){var i=this,n={};!function t(o){if(!n[o]){n[o]=!0,i.direction.shift(o,e);var r=i.hierarchical.childrenReference[o];if(void 0!==r)for(var s=0;s<r.length;s++)t(r[s])}}(t)}},{key:"_findCommonParent",value:function(t,e){var i=this,n={};return function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];e[s]=!0,t(e,s)}}(n,t),function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];if(void 0!==e[s])return{foundParent:s,withChild:n};var a=t(e,s);if(null!==a.foundParent)return a}return{foundParent:null,withChild:n}}(n,e)}},{key:"setDirectionStrategy",value:function(){this.direction="UD"===this.options.hierarchical.direction||"DU"===this.options.hierarchical.direction?new Vd(this):new Hd(this)}},{key:"_getCenterPosition",value:function(t){for(var e=1e9,i=-1e9,n=0;n<t.length;n++){var o=this.direction.getPosition(void 0!==t[n].id?t[n]:this.body.nodes[t[n]]);e=Math.min(e,o),i=Math.max(i,o)}return.5*(e+i)}}]),t}(),eu=function(){function t(e,i,n,o){var r,s,a=this;hl(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.interactionHandler=o,this.editMode=!1,this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0,this.manipulationHammers=[],this.temporaryUIFunctions={},this.temporaryEventFunctions=[],this.touchTime=0,this.temporaryIds={nodes:[],edges:[]},this.guiEnabled=!1,this.inMode=!1,this.selectedControlNode=void 0,this.options={},this.defaultOptions={enabled:!1,initiallyActive:!1,addNode:!0,addEdge:!0,editNode:void 0,editEdge:!0,deleteNode:!0,deleteEdge:!0,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}},wt(this.options,this.defaultOptions),this.body.emitter.on("destroy",function(){a._clean()}),this.body.emitter.on("_dataChanged",J(r=this._restore).call(r,this)),this.body.emitter.on("_resetData",J(s=this._restore).call(s,this))}return ul(t,[{key:"_restore",value:function(){!1!==this.inMode&&(!0===this.options.initiallyActive?this.enableEditMode():this.disableEditMode())}},{key:"setOptions",value:function(t,e,i){void 0!==e&&(this.options.locale=void 0!==e.locale?e.locale:i.locale,this.options.locales=void 0!==e.locales?e.locales:i.locales),void 0!==t&&("boolean"==typeof t?this.options.enabled=t:(this.options.enabled=!0,br(this.options,t)),!0===this.options.initiallyActive&&(this.editMode=!0),this._setup())}},{key:"toggleEditMode",value:function(){!0===this.editMode?this.disableEditMode():this.enableEditMode()}},{key:"enableEditMode",value:function(){this.editMode=!0,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="block",this.closeDiv.style.display="block",this.editModeDiv.style.display="none",this.showManipulatorToolbar())}},{key:"disableEditMode",value:function(){this.editMode=!1,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="none",this.closeDiv.style.display="none",this.editModeDiv.style.display="block",this._createEditButton())}},{key:"showManipulatorToolbar",value:function(){if(this._clean(),this.manipulationDOM={},!0===this.guiEnabled){var t,e;this.editMode=!0,this.manipulationDiv.style.display="block",this.closeDiv.style.display="block";var i=this.selectionHandler._getSelectedNodeCount(),n=this.selectionHandler._getSelectedEdgeCount(),o=i+n,r=this.options.locales[this.options.locale],s=!1;!1!==this.options.addNode&&(this._createAddNodeButton(r),s=!0),!1!==this.options.addEdge&&(!0===s?this._createSeperator(1):s=!0,this._createAddEdgeButton(r)),1===i&&"function"==typeof this.options.editNode?(!0===s?this._createSeperator(2):s=!0,this._createEditNodeButton(r)):1===n&&0===i&&!1!==this.options.editEdge&&(!0===s?this._createSeperator(3):s=!0,this._createEditEdgeButton(r)),0!==o&&(i>0&&!1!==this.options.deleteNode||0===i&&!1!==this.options.deleteEdge)&&(!0===s&&this._createSeperator(4),this._createDeleteButton(r)),this._bindHammerToDiv(this.closeDiv,J(t=this.toggleEditMode).call(t,this)),this._temporaryBindEvent("select",J(e=this.showManipulatorToolbar).call(e,this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function(){var t;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addNode",!0===this.guiEnabled){var e,i=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(i),this._createSeperator(),this._createDescription(i.addDescription||this.options.locales.en.addDescription),this._bindHammerToDiv(this.closeDiv,J(e=this.toggleEditMode).call(e,this))}this._temporaryBindEvent("click",J(t=this._performAddNode).call(t,this))}},{key:"editNode",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean();var e=this.selectionHandler._getSelectedNode();if(void 0!==e){if(this.inMode="editNode","function"!=typeof this.options.editNode)throw new Error("No function has been configured to handle the editing of nodes.");if(!0!==e.isCluster){var i=br({},e.options,!1);if(i.x=e.x,i.y=e.y,2!==this.options.editNode.length)throw new Error("The function for edit does not support two arguments (data, callback)");this.options.editNode(i,function(e){null!=e&&"editNode"===t.inMode&&t.body.data.nodes.getDataSet().update(e),t.showManipulatorToolbar()})}else alert(this.options.locales[this.options.locale].editClusterError||this.options.locales.en.editClusterError)}else this.showManipulatorToolbar()}},{key:"addEdgeMode",value:function(){var t,e,i,n,o;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addEdge",!0===this.guiEnabled){var r,s=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(s),this._createSeperator(),this._createDescription(s.edgeDescription||this.options.locales.en.edgeDescription),this._bindHammerToDiv(this.closeDiv,J(r=this.toggleEditMode).call(r,this))}this._temporaryBindUI("onTouch",J(t=this._handleConnect).call(t,this)),this._temporaryBindUI("onDragEnd",J(e=this._finishConnect).call(e,this)),this._temporaryBindUI("onDrag",J(i=this._dragControlNode).call(i,this)),this._temporaryBindUI("onRelease",J(n=this._finishConnect).call(n,this)),this._temporaryBindUI("onDragStart",J(o=this._dragStartEdge).call(o,this)),this._temporaryBindUI("onHold",function(){})}},{key:"editEdgeMode",value:function(){if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="editEdge","object"!==Qo(this.options.editEdge)||"function"!=typeof this.options.editEdge.editWithoutDrag||(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdges()[0],void 0===this.edgeBeingEditedId)){if(!0===this.guiEnabled){var t,e=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(e),this._createSeperator(),this._createDescription(e.editEdgeDescription||this.options.locales.en.editEdgeDescription),this._bindHammerToDiv(this.closeDiv,J(t=this.toggleEditMode).call(t,this))}if(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdges()[0],void 0!==this.edgeBeingEditedId){var i,n,o,r,s=this.body.edges[this.edgeBeingEditedId],a=this._getNewTargetNode(s.from.x,s.from.y),l=this._getNewTargetNode(s.to.x,s.to.y);this.temporaryIds.nodes.push(a.id),this.temporaryIds.nodes.push(l.id),this.body.nodes[a.id]=a,this.body.nodeIndices.push(a.id),this.body.nodes[l.id]=l,this.body.nodeIndices.push(l.id),this._temporaryBindUI("onTouch",J(i=this._controlNodeTouch).call(i,this)),this._temporaryBindUI("onTap",function(){}),this._temporaryBindUI("onHold",function(){}),this._temporaryBindUI("onDragStart",J(n=this._controlNodeDragStart).call(n,this)),this._temporaryBindUI("onDrag",J(o=this._controlNodeDrag).call(o,this)),this._temporaryBindUI("onDragEnd",J(r=this._controlNodeDragEnd).call(r,this)),this._temporaryBindUI("onMouseMove",function(){}),this._temporaryBindEvent("beforeDrawing",function(t){var e=s.edgeType.findBorderPositions(t);!1===a.selected&&(a.x=e.from.x,a.y=e.from.y),!1===l.selected&&(l.x=e.to.x,l.y=e.to.y)}),this.body.emitter.emit("_redraw")}else this.showManipulatorToolbar()}else{var c=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(c.from.id,c.to.id)}}},{key:"deleteSelected",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="delete";var e=this.selectionHandler.getSelectedNodes(),i=this.selectionHandler.getSelectedEdges(),n=void 0;if(e.length>0){for(var o=0;o<e.length;o++)if(!0===this.body.nodes[e[o]].isCluster)return void alert(this.options.locales[this.options.locale].deleteClusterError||this.options.locales.en.deleteClusterError);"function"==typeof this.options.deleteNode&&(n=this.options.deleteNode)}else i.length>0&&"function"==typeof this.options.deleteEdge&&(n=this.options.deleteEdge);if("function"==typeof n){var r={nodes:e,edges:i};if(2!==n.length)throw new Error("The function for delete does not support two arguments (data, callback)");n(r,function(e){null!=e&&"delete"===t.inMode?(t.body.data.edges.getDataSet().remove(e.edges),t.body.data.nodes.getDataSet().remove(e.nodes),t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar()):(t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().remove(i),this.body.data.nodes.getDataSet().remove(e),this.body.emitter.emit("startSimulation"),this.showManipulatorToolbar()}},{key:"_setup",value:function(){!0===this.options.enabled?(this.guiEnabled=!0,this._createWrappers(),!1===this.editMode?this._createEditButton():this.showManipulatorToolbar()):(this._removeManipulationDOM(),this.guiEnabled=!1)}},{key:"_createWrappers",value:function(){void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="vis-manipulation",this.manipulationDiv.style.display=!0===this.editMode?"block":"none",this.canvas.frame.appendChild(this.manipulationDiv)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="vis-edit-mode",this.editModeDiv.style.display=!0===this.editMode?"none":"block",this.canvas.frame.appendChild(this.editModeDiv)),void 0===this.closeDiv&&(this.closeDiv=document.createElement("div"),this.closeDiv.className="vis-close",this.closeDiv.style.display=this.manipulationDiv.style.display,this.canvas.frame.appendChild(this.closeDiv))}},{key:"_getNewTargetNode",value:function(t,e){var i=br({},this.options.controlNodeStyle);i.id="targetNode"+Gh(),i.hidden=!1,i.physics=!1,i.x=t,i.y=e;var n=this.body.functions.createNode(i);return n.shape.boundingBox={left:t,right:t,top:e,bottom:e},n}},{key:"_createEditButton",value:function(){var t;this._clean(),this.manipulationDOM={},ur(this.editModeDiv);var e=this._createButton("editMode","vis-button vis-edit vis-edit-mode",this.options.locales[this.options.locale].edit||this.options.locales.en.edit);this.editModeDiv.appendChild(e),this._bindHammerToDiv(e,J(t=this.toggleEditMode).call(t,this))}},{key:"_clean",value:function(){this.inMode=!1,!0===this.guiEnabled&&(ur(this.editModeDiv),ur(this.manipulationDiv),this._cleanManipulatorHammers()),this._cleanupTemporaryNodesAndEdges(),this._unbindTemporaryUIs(),this._unbindTemporaryEvents(),this.body.emitter.emit("restorePhysics")}},{key:"_cleanManipulatorHammers",value:function(){if(0!=this.manipulationHammers.length){for(var t=0;t<this.manipulationHammers.length;t++)this.manipulationHammers[t].destroy();this.manipulationHammers=[]}}},{key:"_removeManipulationDOM",value:function(){this._clean(),ur(this.manipulationDiv),ur(this.editModeDiv),ur(this.closeDiv),this.manipulationDiv&&this.canvas.frame.removeChild(this.manipulationDiv),this.editModeDiv&&this.canvas.frame.removeChild(this.editModeDiv),this.closeDiv&&this.canvas.frame.removeChild(this.closeDiv),this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0}},{key:"_createSeperator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+t]=document.createElement("div"),this.manipulationDOM["seperatorLineDiv"+t].className="vis-separator-line",this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+t])}},{key:"_createAddNodeButton",value:function(t){var e,i=this._createButton("addNode","vis-button vis-add",t.addNode||this.options.locales.en.addNode);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.addNodeMode).call(e,this))}},{key:"_createAddEdgeButton",value:function(t){var e,i=this._createButton("addEdge","vis-button vis-connect",t.addEdge||this.options.locales.en.addEdge);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.addEdgeMode).call(e,this))}},{key:"_createEditNodeButton",value:function(t){var e,i=this._createButton("editNode","vis-button vis-edit",t.editNode||this.options.locales.en.editNode);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.editNode).call(e,this))}},{key:"_createEditEdgeButton",value:function(t){var e,i=this._createButton("editEdge","vis-button vis-edit",t.editEdge||this.options.locales.en.editEdge);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.editEdgeMode).call(e,this))}},{key:"_createDeleteButton",value:function(t){var e,i=this._createButton("delete",this.options.rtl?"vis-button vis-delete-rtl":"vis-button vis-delete",t.del||this.options.locales.en.del);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.deleteSelected).call(e,this))}},{key:"_createBackButton",value:function(t){var e,i=this._createButton("back","vis-button vis-back",t.back||this.options.locales.en.back);this.manipulationDiv.appendChild(i),this._bindHammerToDiv(i,J(e=this.showManipulatorToolbar).call(e,this))}},{key:"_createButton",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vis-label";return this.manipulationDOM[t+"Div"]=document.createElement("div"),this.manipulationDOM[t+"Div"].className=e,this.manipulationDOM[t+"Label"]=document.createElement("div"),this.manipulationDOM[t+"Label"].className=n,this.manipulationDOM[t+"Label"].innerHTML=i,this.manipulationDOM[t+"Div"].appendChild(this.manipulationDOM[t+"Label"]),this.manipulationDOM[t+"Div"]}},{key:"_createDescription",value:function(t){this.manipulationDiv.appendChild(this._createButton("description","vis-button vis-none",t))}},{key:"_temporaryBindEvent",value:function(t,e){this.temporaryEventFunctions.push({event:t,boundFunction:e}),this.body.emitter.on(t,e)}},{key:"_temporaryBindUI",value:function(t,e){if(void 0===this.body.eventListeners[t])throw new Error("This UI function does not exist. Typo? You tried: "+t+" possible are: "+Lc(Wo(this.body.eventListeners)));this.temporaryUIFunctions[t]=this.body.eventListeners[t],this.body.eventListeners[t]=e}},{key:"_unbindTemporaryUIs",value:function(){for(var t in this.temporaryUIFunctions)Object.prototype.hasOwnProperty.call(this.temporaryUIFunctions,t)&&(this.body.eventListeners[t]=this.temporaryUIFunctions[t],delete this.temporaryUIFunctions[t]);this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function(){for(var t=0;t<this.temporaryEventFunctions.length;t++)this.body.emitter.off(this.temporaryEventFunctions[t].event,this.temporaryEventFunctions[t].boundFunction);this.temporaryEventFunctions=[]}},{key:"_bindHammerToDiv",value:function(t,e){var i=new al(t,{});Jh(i,e),this.manipulationHammers.push(i)}},{key:"_cleanupTemporaryNodesAndEdges",value:function(){for(var t=0;t<this.temporaryIds.edges.length;t++){var e;this.body.edges[this.temporaryIds.edges[t]].disconnect(),delete this.body.edges[this.temporaryIds.edges[t]];var i,n=go(e=this.body.edgeIndices).call(e,this.temporaryIds.edges[t]);-1!==n&&qr(i=this.body.edgeIndices).call(i,n,1)}for(var o=0;o<this.temporaryIds.nodes.length;o++){var r;delete this.body.nodes[this.temporaryIds.nodes[o]];var s,a=go(r=this.body.nodeIndices).call(r,this.temporaryIds.nodes[o]);-1!==a&&qr(s=this.body.nodeIndices).call(s,a,1)}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function(t){this.selectionHandler.unselectAll(),this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=wt({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function(t){var e=this.selectionHandler._pointerToPositionObject(this.lastTouch),i=this.body.nodes[this.temporaryIds.nodes[0]],n=this.body.nodes[this.temporaryIds.nodes[1]],o=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=void 0;var r=i.isOverlappingWith(e),s=n.isOverlappingWith(e);!0===r?(this.selectedControlNode=i,o.edgeType.from=i):!0===s&&(this.selectedControlNode=n,o.edgeType.to=n),void 0!==this.selectedControlNode&&this.selectionHandler.selectObject(this.selectedControlNode),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function(t){this.body.emitter.emit("disablePhysics");var e=this.body.functions.getPointer(t.center),i=this.canvas.DOMtoCanvas(e);void 0!==this.selectedControlNode?(this.selectedControlNode.x=i.x,this.selectedControlNode.y=i.y):this.interactionHandler.onDrag(t),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=this.body.edges[this.edgeBeingEditedId];if(void 0!==this.selectedControlNode){this.selectionHandler.unselectAll();for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--)if(o[s]!==this.selectedControlNode.id){r=this.body.nodes[o[s]];break}void 0!==r&&void 0!==this.selectedControlNode?!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):this.selectedControlNode.id===this.body.nodes[this.temporaryIds.nodes[0]].id?this._performEditEdge(r.id,n.to.id):this._performEditEdge(n.from.id,r.id):(n.updateEdgeType(),this.body.emitter.emit("restorePhysics")),this.body.emitter.emit("_redraw")}}},{key:"_handleConnect",value:function(t){if((new Date).valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=wt({},this.body.view.translation),this.interactionHandler.drag.pointer=this.lastTouch,this.interactionHandler.drag.translation=this.lastTouch.translation;var e=this.selectionHandler.getNodeAt(this.lastTouch);if(void 0!==e)if(!0===e.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var i=this._getNewTargetNode(e.x,e.y);this.body.nodes[i.id]=i,this.body.nodeIndices.push(i.id);var n=this.body.functions.createEdge({id:"connectionEdge"+Gh(),from:e.id,to:i.id,physics:!1,smooth:{enabled:!0,type:"continuous",roundness:.5}});this.body.edges[n.id]=n,this.body.edgeIndices.push(n.id),this.temporaryIds.nodes.push(i.id),this.temporaryIds.edges.push(n.id)}this.touchTime=(new Date).valueOf()}}},{key:"_dragControlNode",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--){var a;if(-1===go(a=this.temporaryIds.nodes).call(a,o[s])){r=this.body.nodes[o[s]];break}}if(t.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler._generateClickEvent("controlNodeDragging",t,e),void 0!==this.temporaryIds.nodes[0]){var l=this.body.nodes[this.temporaryIds.nodes[0]];l.x=this.canvas._XconvertDOMtoCanvas(e.x),l.y=this.canvas._YconvertDOMtoCanvas(e.y),this.body.emitter.emit("_redraw")}else this.interactionHandler.onDrag(t)}},{key:"_finishConnect",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--){var a;if(-1===go(a=this.temporaryIds.nodes).call(a,o[s])){r=this.body.nodes[o[s]];break}}this._cleanupTemporaryNodesAndEdges(),void 0!==r&&(!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):void 0!==this.body.nodes[n]&&void 0!==this.body.nodes[r.id]&&this._performAddEdge(n,r.id)),t.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler._generateClickEvent("controlNodeDragEnd",t,e),this.body.emitter.emit("_redraw")}},{key:"_dragStartEdge",value:function(t){this.selectionHandler._generateClickEvent("dragStart",t,this.lastTouch,void 0,!0)}},{key:"_performAddNode",value:function(t){var e=this,i={id:Gh(),x:t.pointer.canvas.x,y:t.pointer.canvas.y,label:"new"};if("function"==typeof this.options.addNode){if(2!==this.options.addNode.length)throw this.showManipulatorToolbar(),new Error("The function for add does not support two arguments (data,callback)");this.options.addNode(i,function(t){null!=t&&"addNode"===e.inMode&&e.body.data.nodes.getDataSet().add(t),e.showManipulatorToolbar()})}else this.body.data.nodes.getDataSet().add(i),this.showManipulatorToolbar()}},{key:"_performAddEdge",value:function(t,e){var i=this,n={from:t,to:e};if("function"==typeof this.options.addEdge){if(2!==this.options.addEdge.length)throw new Error("The function for connect does not support two arguments (data,callback)");this.options.addEdge(n,function(t){null!=t&&"addEdge"===i.inMode&&(i.body.data.edges.getDataSet().add(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().add(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}},{key:"_performEditEdge",value:function(t,e){var i=this,n={id:this.edgeBeingEditedId,from:t,to:e,label:this.body.data.edges.get(this.edgeBeingEditedId).label},o=this.options.editEdge;if("object"===Qo(o)&&(o=o.editWithoutDrag),"function"==typeof o){if(2!==o.length)throw new Error("The function for edit does not support two arguments (data, callback)");o(n,function(t){null==t||"editEdge"!==i.inMode?(i.body.edges[n.id].updateEdgeType(),i.body.emitter.emit("_redraw"),i.showManipulatorToolbar()):(i.body.data.edges.getDataSet().update(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().update(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}}]),t}(),iu={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},nu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;hl(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return ul(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=t}},{key:"setCloseCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=t}},{key:"_isColorString",value:function(t){if("string"==typeof t)return iu[t]}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==t){var i,n=this._isColorString(t);if(void 0!==n&&(t=n),!0===fr(t)){if(!0===Mr(t)){var o=t.substr(4).substr(0,t.length-5).split(",");i={r:o[0],g:o[1],b:o[2],a:1}}else if(!0===Dr(t)){var r=t.substr(5).substr(0,t.length-6).split(",");i={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===Pr(t)){var s=Cr(t);i={r:s.r,g:s.g,b:s.b,a:1}}}else t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&(i={r:t.r,g:t.g,b:t.b,a:void 0!==t.a?t.a:"1.0"});if(void 0===i)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+Lc(t));this._setColor(i,e)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this;!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.previousColor=wt({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",bl(function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){!0===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.initialColor=wt({},t)),this.color=t;var e=Ar(t.r,t.g,t.b),i=2*Math.PI,n=this.r*e.s,o=this.centerCoordinates.x+n*Math.sin(i*e.h),r=this.centerCoordinates.y+n*Math.cos(i*e.h);this.colorPickerSelector.style.left=o-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=r-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=Ar(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=Or(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=Ar(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),i.clearRect(0,0,this.colorPickerCanvas.clientWidth,this.colorPickerCanvas.clientHeight),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),cc(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var t,e,i,n;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var o=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerHTML="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerHTML="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerHTML="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerHTML="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerHTML="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerHTML="cancel",this.cancelButton.onclick=J(t=this._hide).call(t,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerHTML="apply",this.applyButton.onclick=J(e=this._apply).call(e,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerHTML="save",this.saveButton.onclick=J(i=this._save).call(i,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerHTML="load last",this.loadButton.onclick=J(n=this._loadLast).call(n,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new al(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),Jh(this.hammer,function(e){t._moveSelector(e)}),this.hammer.on("tap",function(e){t._moveSelector(e)}),this.hammer.on("panstart",function(e){t._moveSelector(e)}),this.hammer.on("panmove",function(e){t._moveSelector(e)}),this.hammer.on("panend",function(e){t._moveSelector(e)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var e,i,n,o,r=this.colorPickerCanvas.clientWidth,s=this.colorPickerCanvas.clientHeight;t.clearRect(0,0,r,s),this.centerCoordinates={x:.5*r,y:.5*s},this.r=.49*r;var a,l=2*Math.PI/360,c=1/this.r;for(n=0;n<360;n++)for(o=0;o<this.r;o++)e=this.centerCoordinates.x+o*Math.sin(l*n),i=this.centerCoordinates.y+o*Math.cos(l*n),a=Or(n*(1/360),o*c,1),t.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",t.fillRect(e-.5,i-.5,2,2);t.strokeStyle="rgba(0,0,0,1)",t.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),t.stroke(),this.hueCircle=t.getImageData(0,0,r,s)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=.5*this.colorPickerDiv.clientHeight,n=.5*this.colorPickerDiv.clientWidth,o=t.center.x-e.left-n,r=t.center.y-e.top-i,s=Math.atan2(o,r),a=.98*Math.min(Math.sqrt(o*o+r*r),n),l=Math.cos(s)*a+i,c=Math.sin(s)*a+n;this.colorPickerSelector.style.top=l-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=c-.5*this.colorPickerSelector.clientWidth+"px";var h=s/(2*Math.PI);h=h<0?h+1:h;var d=a/this.r,u=Ar(this.color.r,this.color.g,this.color.b);u.h=h,u.s=d;var f=Or(u.h,u.s,u.v);f.a=this.color.a,this.color=f,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}(),ou=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;hl(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},wt(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new nu(o),this.wrapper=void 0}return ul(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(t instanceof Array)this.options.filter=t.join();else if("object"===Qo(t)){if(null==t)throw new TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==no(t)&&(this.options.filter=no(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===no(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=no(this.options),e=0,i=!1;for(var n in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,n)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):!0!==t&&-1===go(t).call(t,n)||(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++){if(void 0===e[t[i]]){e=void 0;break}e=e[t[i]]}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Nn(n).call(n,function(t){e.appendChild(t)}),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerHTML=t,this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");return n.className="vis-configuration vis-config-label vis-config-s"+e.length,n.innerHTML=!0===i?"<i><b>"+t+":</b></i>":t+":",n}},{key:"_makeDropdown",value:function(t,e,i){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var o=0;void 0!==e&&-1!==go(t).call(t,e)&&(o=go(t).call(t,e));for(var r=0;r<t.length;r++){var s=document.createElement("option");s.value=t[r],r===o&&(s.selected="selected"),s.innerHTML=t[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,n)}},{key:"_makeRange",value:function(t,e,i){var n=t[0],o=t[1],r=t[2],s=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=o,a.max=r}catch(t){}a.step=s;var l="",c=0;void 0!==e?(e<0&&1.2*e<o?(a.min=Math.ceil(1.2*e),c=a.min,l="range increased"):e/1.2<o&&(a.min=Math.ceil(e/1.2),c=a.min,l="range increased"),1.2*e>r&&1!==r&&(a.max=Math.ceil(1.2*e),c=a.max,l="range increased"),a.value=e):a.value=n;var h=document.createElement("input");h.className="vis-configuration vis-config-rangeinput",h.value=a.value;var d=this;a.onchange=function(){h.value=this.value,d._update(Number(this.value),i)},a.oninput=function(){h.value=this.value};var u=this._makeLabel(i[i.length-1],i),f=this._makeItem(i,u,a,h);""!==l&&this.popupHistory[f]!==c&&(this.popupHistory[f]=c,this._setupPopup(l,f))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerHTML="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerHTML=t,n.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=bl(function(){t.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=bl(function(){t._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=t,void 0!==e&&(n.checked=e,e!==t&&("object"===Qo(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var o=this;n.onchange=function(){o._update(this.checked,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeTextInput",value:function(t,e,i){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var o=this;n.onchange=function(){o._update(this.value,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeColorField",value:function(t,e,i){var n=this,o=t[1],r=document.createElement("div");"none"!==(e=void 0===e?o:e)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=e):r.className="vis-configuration vis-config-colorBlock none",e=void 0===e?o:e,r.onclick=function(){n._showColorPicker(e,r,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,r)}},{key:"_showColorPicker",value:function(t,e,i){var n=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback(function(t){var o="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=o,n._update(o,i)}),this.colorPicker.setCloseCallback(function(){e.onclick=function(){n._showColorPicker(t,e,i)}})}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=no(this.options),r=!1;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){n=!0;var a=t[s],l=wr(e,s);if("function"==typeof o&&!1===(n=o(s,e))&&!(a instanceof Array)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==n){r=!0;var c=this._getValue(l);if(a instanceof Array)this._handleArray(a,c,l);else if("string"==typeof a)this._makeTextInput(a,c,l);else if("boolean"==typeof a)this._makeCheckbox(a,c,l);else if(a instanceof Object){var h=!0;if(-1!==go(e).call(e,"physics")&&this.moduleOptions.physics.solver!==s&&"wind"!==s&&(h=!1),!0===h)if(void 0!==a.enabled){var d=wr(l,"enabled"),u=this._getValue(d);if(!0===u){var f=this._makeLabel(s,l,!0);this._makeItem(l,f),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,u,l)}else{var p=this._makeLabel(s,l,!0);this._makeItem(l,p),r=this._handleObject(a,l)||r}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i;t="false"!==(t="true"===t||t)&&t;for(var o=0;o<e.length;o++)"global"!==e[o]&&(void 0===n[e[o]]&&(n[e[o]]={}),o!==e.length-1?n=n[e[o]]:n[e[o]]=t);return i}},{key:"_printOptions",value:function(){var t=this.getOptions();this.optionsContainer.innerHTML="<pre>var options = "+Lc(t,null,2)+"</pre>"}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),ru="string",su="boolean",au="number",lu="object",cu=["arrow","bar","box","circle","crow","curve","diamond","image","inv_curve","inv_triangle","triangle","vee"],hu={configure:{enabled:{boolean:su},filter:{boolean:su,string:ru,array:"array",function:"function"},container:{dom:"dom"},showButton:{boolean:su},__type__:{object:lu,boolean:su,string:ru,array:"array",function:"function"}},edges:{arrows:{to:{enabled:{boolean:su},scaleFactor:{number:au},type:{string:cu},imageHeight:{number:au},imageWidth:{number:au},src:{string:ru},__type__:{object:lu,boolean:su}},middle:{enabled:{boolean:su},scaleFactor:{number:au},type:{string:cu},imageWidth:{number:au},imageHeight:{number:au},src:{string:ru},__type__:{object:lu,boolean:su}},from:{enabled:{boolean:su},scaleFactor:{number:au},type:{string:cu},imageWidth:{number:au},imageHeight:{number:au},src:{string:ru},__type__:{object:lu,boolean:su}},__type__:{string:["from","to","middle"],object:lu}},endPointOffset:{from:{number:au},to:{number:au},__type__:{object:lu,number:au}},arrowStrikethrough:{boolean:su},background:{enabled:{boolean:su},color:{string:ru},size:{number:au},dashes:{boolean:su,array:"array"},__type__:{object:lu,boolean:su}},chosen:{label:{boolean:su,function:"function"},edge:{boolean:su,function:"function"},__type__:{object:lu,boolean:su}},color:{color:{string:ru},highlight:{string:ru},hover:{string:ru},inherit:{string:["from","to","both"],boolean:su},opacity:{number:au},__type__:{object:lu,string:ru}},dashes:{boolean:su,array:"array"},font:{color:{string:ru},size:{number:au},face:{string:ru},background:{string:ru},strokeWidth:{number:au},strokeColor:{string:ru},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:au},multi:{boolean:su,string:ru},bold:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},boldital:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},ital:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},mono:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},__type__:{object:lu,string:ru}},hidden:{boolean:su},hoverWidth:{function:"function",number:au},label:{string:ru,undefined:"undefined"},labelHighlightBold:{boolean:su},length:{number:au,undefined:"undefined"},physics:{boolean:su},scaling:{min:{number:au},max:{number:au},label:{enabled:{boolean:su},min:{number:au},max:{number:au},maxVisible:{number:au},drawThreshold:{number:au},__type__:{object:lu,boolean:su}},customScalingFunction:{function:"function"},__type__:{object:lu}},selectionWidth:{function:"function",number:au},selfReferenceSize:{number:au},selfReference:{size:{number:au},angle:{number:au},renderBehindTheNode:{boolean:su},__type__:{object:lu}},shadow:{enabled:{boolean:su},color:{string:ru},size:{number:au},x:{number:au},y:{number:au},__type__:{object:lu,boolean:su}},smooth:{enabled:{boolean:su},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:au},forceDirection:{string:["horizontal","vertical","none"],boolean:su},__type__:{object:lu,boolean:su}},title:{string:ru,undefined:"undefined"},width:{number:au},widthConstraint:{maximum:{number:au},__type__:{object:lu,boolean:su,number:au}},value:{number:au,undefined:"undefined"},__type__:{object:lu}},groups:{useDefaultGroups:{boolean:su},__any__:"get from nodes, will be overwritten below",__type__:{object:lu}},interaction:{dragNodes:{boolean:su},dragView:{boolean:su},hideEdgesOnDrag:{boolean:su},hideEdgesOnZoom:{boolean:su},hideNodesOnDrag:{boolean:su},hover:{boolean:su},keyboard:{enabled:{boolean:su},speed:{x:{number:au},y:{number:au},zoom:{number:au},__type__:{object:lu}},bindToWindow:{boolean:su},__type__:{object:lu,boolean:su}},multiselect:{boolean:su},navigationButtons:{boolean:su},selectable:{boolean:su},selectConnectedEdges:{boolean:su},hoverConnectedEdges:{boolean:su},tooltipDelay:{number:au},zoomView:{boolean:su},zoomSpeed:{number:au},__type__:{object:lu}},layout:{randomSeed:{undefined:"undefined",number:au,string:ru},improvedLayout:{boolean:su},clusterThreshold:{number:au},hierarchical:{enabled:{boolean:su},levelSeparation:{number:au},nodeSpacing:{number:au},treeSpacing:{number:au},blockShifting:{boolean:su},edgeMinimization:{boolean:su},parentCentralization:{boolean:su},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},shakeTowards:{string:["leaves","roots"]},__type__:{object:lu,boolean:su}},__type__:{object:lu}},manipulation:{enabled:{boolean:su},initiallyActive:{boolean:su},addNode:{boolean:su,function:"function"},addEdge:{boolean:su,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:lu,boolean:su,function:"function"}},deleteNode:{boolean:su,function:"function"},deleteEdge:{boolean:su,function:"function"},controlNodeStyle:"get from nodes, will be overwritten below",__type__:{object:lu,boolean:su}},nodes:{borderWidth:{number:au},borderWidthSelected:{number:au,undefined:"undefined"},brokenImage:{string:ru,undefined:"undefined"},chosen:{label:{boolean:su,function:"function"},node:{boolean:su,function:"function"},__type__:{object:lu,boolean:su}},color:{border:{string:ru},background:{string:ru},highlight:{border:{string:ru},background:{string:ru},__type__:{object:lu,string:ru}},hover:{border:{string:ru},background:{string:ru},__type__:{object:lu,string:ru}},__type__:{object:lu,string:ru}},opacity:{number:au,undefined:"undefined"},fixed:{x:{boolean:su},y:{boolean:su},__type__:{object:lu,boolean:su}},font:{align:{string:ru},color:{string:ru},size:{number:au},face:{string:ru},background:{string:ru},strokeWidth:{number:au},strokeColor:{string:ru},vadjust:{number:au},multi:{boolean:su,string:ru},bold:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},boldital:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},ital:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},mono:{color:{string:ru},size:{number:au},face:{string:ru},mod:{string:ru},vadjust:{number:au},__type__:{object:lu,string:ru}},__type__:{object:lu,string:ru}},group:{string:ru,number:au,undefined:"undefined"},heightConstraint:{minimum:{number:au},valign:{string:ru},__type__:{object:lu,boolean:su,number:au}},hidden:{boolean:su},icon:{face:{string:ru},code:{string:ru},size:{number:au},color:{string:ru},weight:{string:ru,number:au},__type__:{object:lu}},id:{string:ru,number:au},image:{selected:{string:ru,undefined:"undefined"},unselected:{string:ru,undefined:"undefined"},__type__:{object:lu,string:ru}},imagePadding:{top:{number:au},right:{number:au},bottom:{number:au},left:{number:au},__type__:{object:lu,number:au}},label:{string:ru,undefined:"undefined"},labelHighlightBold:{boolean:su},level:{number:au,undefined:"undefined"},margin:{top:{number:au},right:{number:au},bottom:{number:au},left:{number:au},__type__:{object:lu,number:au}},mass:{number:au},physics:{boolean:su},scaling:{min:{number:au},max:{number:au},label:{enabled:{boolean:su},min:{number:au},max:{number:au},maxVisible:{number:au},drawThreshold:{number:au},__type__:{object:lu,boolean:su}},customScalingFunction:{function:"function"},__type__:{object:lu}},shadow:{enabled:{boolean:su},color:{string:ru},size:{number:au},x:{number:au},y:{number:au},__type__:{object:lu,boolean:su}},shape:{string:["custom","ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon","hexagon"]},customRenderer:{function:"function"},shapeProperties:{borderDashes:{boolean:su,array:"array"},borderRadius:{number:au},interpolation:{boolean:su},useImageSize:{boolean:su},useBorderWithImage:{boolean:su},coordinateOrigin:{string:["center","top-left"]},__type__:{object:lu}},size:{number:au},title:{string:ru,dom:"dom",undefined:"undefined"},value:{number:au,undefined:"undefined"},widthConstraint:{minimum:{number:au},maximum:{number:au},__type__:{object:lu,boolean:su,number:au}},x:{number:au},y:{number:au},__type__:{object:lu}},physics:{enabled:{boolean:su},barnesHut:{theta:{number:au},gravitationalConstant:{number:au},centralGravity:{number:au},springLength:{number:au},springConstant:{number:au},damping:{number:au},avoidOverlap:{number:au},__type__:{object:lu}},forceAtlas2Based:{theta:{number:au},gravitationalConstant:{number:au},centralGravity:{number:au},springLength:{number:au},springConstant:{number:au},damping:{number:au},avoidOverlap:{number:au},__type__:{object:lu}},repulsion:{centralGravity:{number:au},springLength:{number:au},springConstant:{number:au},nodeDistance:{number:au},damping:{number:au},__type__:{object:lu}},hierarchicalRepulsion:{centralGravity:{number:au},springLength:{number:au},springConstant:{number:au},nodeDistance:{number:au},damping:{number:au},avoidOverlap:{number:au},__type__:{object:lu}},maxVelocity:{number:au},minVelocity:{number:au},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:su},iterations:{number:au},updateInterval:{number:au},onlyDynamicEdges:{boolean:su},fit:{boolean:su},__type__:{object:lu,boolean:su}},timestep:{number:au},adaptiveTimestep:{boolean:su},wind:{x:{number:au},y:{number:au},__type__:{object:lu}},__type__:{object:lu,boolean:su}},autoResize:{boolean:su},clickToUse:{boolean:su},locale:{string:ru},locales:{__any__:{any:"any"},__type__:{object:lu}},height:{string:ru},width:{string:ru},__type__:{object:lu}};hu.groups.__any__=hu.nodes,hu.manipulation.controlNodeStyle=hu.nodes;var du={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},opacity:[0,0,1,.1],fixed:{x:!1,y:!1},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:!1,labelHighlightBold:!0,physics:!0,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:!1,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown","hexagon"],shapeProperties:{borderDashes:!1,borderRadius:[6,0,20,1],interpolation:!0,useImageSize:!1},size:[25,0,200,1]},edges:{arrows:{to:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"}},endPointOffset:{from:[0,-10,10,1],to:[0,-10,10,1]},arrowStrikethrough:!0,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",!0,!1],opacity:[1,0,1,.05]},dashes:!1,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:!1,hoverWidth:[1.5,0,5,.1],labelHighlightBold:!0,physics:!0,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:!0,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],selfReference:{size:[20,0,200,1],angle:[Math.PI/2,-6*Math.PI,6*Math.PI,Math.PI/8],renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:!0,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:!1,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"],shakeTowards:["leaves","roots"]}},interaction:{dragNodes:!0,dragView:!0,hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1,hover:!1,keyboard:{enabled:!1,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:!0},multiselect:!1,navigationButtons:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,tooltipDelay:[300,0,1e3,25],zoomView:!0,zoomSpeed:[1,.1,2,.1]},manipulation:{enabled:!1,initiallyActive:!1},physics:{enabled:!0,barnesHut:{theta:[.5,.1,1,.05],gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{theta:[.5,.1,1,.05],gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01],wind:{x:[0,-10,10,.1],y:[0,-10,10,.1]}}},uu=Object.freeze({__proto__:null,allOptions:hu,configureOptions:du}),fu=function(){function t(){hl(this,t)}return ul(t,[{key:"getDistances",value:function(t,e,i){for(var n={},o=t.edges,r=0;r<e.length;r++){var s={};n[e[r]]=s;for(var a=0;a<e.length;a++)s[e[a]]=r==a?0:1e9}for(var l=0;l<i.length;l++){var c=o[i[l]];!0===c.connected&&void 0!==n[c.fromId]&&void 0!==n[c.toId]&&(n[c.fromId][c.toId]=1,n[c.toId][c.fromId]=1)}for(var h=e.length,d=0;d<h;d++)for(var u=e[d],f=n[u],p=0;p<h-1;p++)for(var g=e[p],m=n[g],v=p+1;v<h;v++){var y=e[v],b=n[y],w=Math.min(m[y],m[u]+f[y]);m[y]=w,b[g]=w}return n}}]),t}(),pu=function(){function t(e,i,n){hl(this,t),this.body=e,this.springLength=i,this.springConstant=n,this.distanceSolver=new fu}return ul(t,[{key:"setOptions",value:function(t){t&&(t.springLength&&(this.springLength=t.springLength),t.springConstant&&(this.springConstant=t.springConstant))}},{key:"solve",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.distanceSolver.getDistances(this.body,t,e);this._createL_matrix(n),this._createK_matrix(n),this._createE_matrix();for(var o=.01,r=1,s=0,a=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3)),l=5,c=1e9,h=0,d=0,u=0,f=0,p=0;c>o&&s<a;){s+=1;var g=this._getHighestEnergyNode(i),m=jo(g,4);for(h=m[0],d=m[2],u=m[3],f=c=m[1],p=0;f>r&&p<l;){p+=1,this._moveNode(h,d,u);var v=this._getEnergy(h),y=jo(v,3);f=y[0],d=y[1],u=y[2]}}}},{key:"_getHighestEnergyNode",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=0,o=e[0],r=0,s=0,a=0;a<e.length;a++){var l=e[a];if(!1===i[l].predefinedPosition||!0===i[l].isCluster&&!0===t||!0===i[l].options.fixed.x||!0===i[l].options.fixed.y){var c=this._getEnergy(l),h=jo(c,3),d=h[0];n<d&&(n=d,o=l,r=h[1],s=h[2])}}return[o,n,r,s]}},{key:"_getEnergy",value:function(t){var e=jo(this.E_sums[t],2),i=e[0],n=e[1];return[Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),i,n]}},{key:"_moveNode",value:function(t,e,i){for(var n=this.body.nodeIndices,o=this.body.nodes,r=0,s=0,a=0,l=o[t].x,c=o[t].y,h=this.K_matrix[t],d=this.L_matrix[t],u=0;u<n.length;u++){var f=n[u];if(f!==t){var p=o[f].x,g=o[f].y,m=h[f],v=d[f],y=1/Math.pow(Math.pow(l-p,2)+Math.pow(c-g,2),1.5);r+=m*(1-v*Math.pow(c-g,2)*y),s+=m*(v*(l-p)*(c-g)*y),a+=m*(1-v*Math.pow(l-p,2)*y)}}var b=(e/r+i/s)/(s/r-a/s);o[t].x+=-(s*b+e)/r,o[t].y+=b,this._updateE_matrix(t)}},{key:"_createL_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springLength;this.L_matrix=[];for(var n=0;n<e.length;n++){this.L_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.L_matrix[e[n]][e[o]]=i*t[e[n]][e[o]]}}},{key:"_createK_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springConstant;this.K_matrix=[];for(var n=0;n<e.length;n++){this.K_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.K_matrix[e[n]][e[o]]=i*Math.pow(t[e[n]][e[o]],-2)}}},{key:"_createE_matrix",value:function(){var t=this.body.nodeIndices,e=this.body.nodes;this.E_matrix={},this.E_sums={};for(var i=0;i<t.length;i++)this.E_matrix[t[i]]=[];for(var n=0;n<t.length;n++){for(var o=t[n],r=e[o].x,s=e[o].y,a=0,l=0,c=n;c<t.length;c++){var h=t[c];if(h!==o){var d=e[h].x,u=e[h].y,f=1/Math.sqrt(Math.pow(r-d,2)+Math.pow(s-u,2));this.E_matrix[o][c]=[this.K_matrix[o][h]*(r-d-this.L_matrix[o][h]*(r-d)*f),this.K_matrix[o][h]*(s-u-this.L_matrix[o][h]*(s-u)*f)],this.E_matrix[h][n]=this.E_matrix[o][c],a+=this.E_matrix[o][c][0],l+=this.E_matrix[o][c][1]}}this.E_sums[o]=[a,l]}}},{key:"_updateE_matrix",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=this.E_matrix[t],o=this.K_matrix[t],r=this.L_matrix[t],s=i[t].x,a=i[t].y,l=0,c=0,h=0;h<e.length;h++){var d=e[h];if(d!==t){var u=n[h],f=u[0],p=u[1],g=i[d].x,m=i[d].y,v=1/Math.sqrt(Math.pow(s-g,2)+Math.pow(a-m,2)),y=o[d]*(s-g-r[d]*(s-g)*v),b=o[d]*(a-m-r[d]*(a-m)*v);n[h]=[y,b],l+=y,c+=b;var w=this.E_sums[d];w[0]+=y-f,w[1]+=b-p}}this.E_sums[t]=[l,c]}}]),t}();function gu(t,e,i){var n,o,r,s,a=this;if(!(this instanceof gu))throw new SyntaxError("Constructor must be called with the new operator");this.options={},this.defaultOptions={locale:"en",locales:cl,clickToUse:!1},wt(this.options,this.defaultOptions),this.body={container:t,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:J(n=this.on).call(n,this),off:J(o=this.off).call(o,this),emit:J(r=this.emit).call(r,this),once:J(s=this.once).call(s,this)},eventListeners:{onTap:function(){},onTouch:function(){},onDoubleTap:function(){},onHold:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onMouseWheel:function(){},onPinch:function(){},onMouseMove:function(){},onRelease:function(){},onContext:function(){}},data:{nodes:null,edges:null},functions:{createNode:function(){},createEdge:function(){},getPointer:function(){}},modules:{},view:{scale:1,translation:{x:0,y:0}},selectionBox:{show:!1,position:{start:{x:0,y:0},end:{x:0,y:0}}}},this.bindEventListeners(),this.images=new pl(function(){return a.body.emitter.emit("_requestRedraw")}),this.groups=new gl,this.canvas=new ed(this.body),this.selectionHandler=new sd(this.body,this.canvas),this.interactionHandler=new rd(this.body,this.canvas,this.selectionHandler),this.view=new id(this.body,this.canvas),this.renderer=new Kh(this.body,this.canvas),this.physics=new zh(this.body),this.layoutEngine=new tu(this.body),this.clustering=new Xh(this.body),this.manipulation=new eu(this.body,this.canvas,this.selectionHandler,this.interactionHandler),this.nodesHandler=new Yc(this.body,this.images,this.groups,this.layoutEngine),this.edgesHandler=new Sh(this.body,this.images,this.groups),this.body.modules.kamadaKawai=new pu(this.body,150,.05),this.body.modules.clustering=this.clustering,this.canvas._create(),this.setOptions(i),this.setData(e)}St(gu.prototype),gu.prototype.setOptions=function(t){var e=this;if(null===t&&(t=void 0),void 0!==t){if(!0===Vc.validate(t,hu)&&console.log("%cErrors have been found in the supplied options object.",jc),vr(["locale","locales","clickToUse"],this.options,t),void 0!==t.locale&&(t.locale=function(t,e){try{var i=e.split(/[-_ \/]/,2),n=jo(i,2),o=n[0],r=n[1],s=null!=o?o.toLowerCase():null,a=null!=r?r.toUpperCase():null;if(s&&a){var l,c=s+"-"+a;if(Object.prototype.hasOwnProperty.call(t,c))return c;console.warn(ir(l="Unknown variant ".concat(a," of language ")).call(l,s,"."))}if(s){var h=s;if(Object.prototype.hasOwnProperty.call(t,h))return h;console.warn("Unknown language ".concat(s))}return console.warn("Unknown locale ".concat(e,", falling back to English.")),"en"}catch(t){return console.error(t),console.warn("Unexpected error while normalizing locale ".concat(e,", falling back to English.")),"en"}}(t.locales||this.options.locales,t.locale)),t=this.layoutEngine.setOptions(t.layout,t),this.canvas.setOptions(t),this.groups.setOptions(t.groups),this.nodesHandler.setOptions(t.nodes),this.edgesHandler.setOptions(t.edges),this.physics.setOptions(t.physics),this.manipulation.setOptions(t.manipulation,t,this.options),this.interactionHandler.setOptions(t.interaction),this.renderer.setOptions(t.interaction),this.selectionHandler.setOptions(t.interaction),void 0!==t.groups&&this.body.emitter.emit("refreshNodes"),"configure"in t&&(this.configurator||(this.configurator=new ou(this,this.body.container,du,this.canvas.pixelRatio)),this.configurator.setOptions(t.configure)),this.configurator&&!0===this.configurator.options.enabled){var i={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};br(i.nodes,this.nodesHandler.options),br(i.edges,this.edgesHandler.options),br(i.layout,this.layoutEngine.options),br(i.interaction,this.selectionHandler.options),br(i.interaction,this.renderer.options),br(i.interaction,this.interactionHandler.options),br(i.manipulation,this.manipulation.options),br(i.physics,this.physics.options),br(i.global,this.canvas.options),br(i.global,this.options),this.configurator.setModuleOptions(i)}void 0!==t.clickToUse?!0===t.clickToUse?void 0===this.activator&&(this.activator=new ll(this.canvas.frame),this.activator.on("change",function(){e.body.emitter.emit("activate")})):(void 0!==this.activator&&(this.activator.destroy(),delete this.activator),this.body.emitter.emit("activate")):this.body.emitter.emit("activate"),this.canvas.setSize(),this.body.emitter.emit("startSimulation")}},gu.prototype._updateVisibleIndices=function(){var t=this.body.nodes,e=this.body.edges;for(var i in this.body.nodeIndices=[],this.body.edgeIndices=[],t)Object.prototype.hasOwnProperty.call(t,i)&&(this.clustering._isClusteredNode(i)||!1!==t[i].options.hidden||this.body.nodeIndices.push(t[i].id));for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=e[n],r=t[o.fromId],s=t[o.toId],a=void 0!==r&&void 0!==s;!this.clustering._isClusteredEdge(n)&&!1===o.options.hidden&&a&&!1===r.options.hidden&&!1===s.options.hidden&&this.body.edgeIndices.push(o.id)}},gu.prototype.bindEventListeners=function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.edgesHandler._updateState(),t.body.emitter.emit("_dataUpdated")}),this.body.emitter.on("_dataUpdated",function(){t.clustering._updateState(),t._updateVisibleIndices(),t._updateValueRange(t.body.nodes),t._updateValueRange(t.body.edges),t.body.emitter.emit("startSimulation"),t.body.emitter.emit("_requestRedraw")})},gu.prototype.setData=function(t){if(this.body.emitter.emit("resetPhysics"),this.body.emitter.emit("_resetData"),this.selectionHandler.unselectAll(),t&&t.dot&&(t.nodes||t.edges))throw new SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');if(this.setOptions(t&&t.options),t&&t.dot){console.log("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var e=Is(t.dot);this.setData(e)}else if(t&&t.gephi){console.log("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var i=Ms(t.gephi);this.setData(i)}else this.nodesHandler.setData(t&&t.nodes,!0),this.edgesHandler.setData(t&&t.edges,!0),this.body.emitter.emit("_dataChanged"),this.body.emitter.emit("_dataLoaded"),this.body.emitter.emit("initPhysics")},gu.prototype.destroy=function(){for(var t in this.body.emitter.emit("destroy"),this.body.emitter.off(),this.off(),delete this.groups,delete this.canvas,delete this.selectionHandler,delete this.interactionHandler,delete this.view,delete this.renderer,delete this.physics,delete this.layoutEngine,delete this.clustering,delete this.manipulation,delete this.nodesHandler,delete this.edgesHandler,delete this.configurator,delete this.images,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&delete this.body.nodes[t];for(var e in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,e)&&delete this.body.edges[e];ur(this.body.container)},gu.prototype._updateValueRange=function(t){var e,i=void 0,n=void 0,o=0;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=t[e].getValue();void 0!==r&&(i=void 0===i?r:Math.min(r,i),n=void 0===n?r:Math.max(r,n),o+=r)}if(void 0!==i&&void 0!==n)for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].setValueRange(i,n,o)},gu.prototype.isActive=function(){return!this.activator||this.activator.active},gu.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)},gu.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)},gu.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)},gu.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)},gu.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)},gu.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)},gu.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)},gu.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)},gu.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)},gu.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)},gu.prototype.updateClusteredNode=function(){return this.clustering.updateClusteredNode.apply(this.clustering,arguments)},gu.prototype.getClusteredEdges=function(){return this.clustering.getClusteredEdges.apply(this.clustering,arguments)},gu.prototype.getBaseEdge=function(){return this.clustering.getBaseEdge.apply(this.clustering,arguments)},gu.prototype.getBaseEdges=function(){return this.clustering.getBaseEdges.apply(this.clustering,arguments)},gu.prototype.updateEdge=function(){return this.clustering.updateEdge.apply(this.clustering,arguments)},gu.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)},gu.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)},gu.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)},gu.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)},gu.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)},gu.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)},gu.prototype.editNodeMode=function(){return console.log("Deprecated: Please use editNode instead of editNodeMode."),this.manipulation.editNode.apply(this.manipulation,arguments)},gu.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)},gu.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)},gu.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)},gu.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)},gu.prototype.getPosition=function(){return this.nodesHandler.getPosition.apply(this.nodesHandler,arguments)},gu.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)},gu.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)},gu.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)},gu.prototype.getConnectedNodes=function(t){return void 0!==this.body.nodes[t]?this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments):this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)},gu.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)},gu.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)},gu.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)},gu.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)},gu.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)},gu.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)},gu.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodes.apply(this.selectionHandler,arguments)},gu.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdges.apply(this.selectionHandler,arguments)},gu.prototype.getNodeAt=function(){var t=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},gu.prototype.getEdgeAt=function(){var t=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},gu.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)},gu.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)},gu.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments),this.redraw()},gu.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)},gu.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)},gu.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)},gu.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)},gu.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)},gu.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)},gu.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)},gu.prototype.getOptionsFromConfigurator=function(){var t={};return this.configurator&&(t=this.configurator.getOptions.apply(this.configurator)),t};var mu=Is;t.Network=gu,t.NetworkImages=pl,t.networkDOTParser=Ps,t.networkGephiParser=Ds,t.networkOptions=uu,t.parseDOTNetwork=mu,t.parseGephiNetwork=Ms,Object.defineProperty(t,"__esModule",{value:!0})}(e,i(4493))},4493:function(t,e){!function(t){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){var e={exports:{}};return t(e,e.exports),e.exports}var n=function(t){return t&&t.Math==Math&&t},o=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),r=function(t){try{return!!t()}catch(e){return!0}},s=!r(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),a={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c={f:l&&!a.call({1:2},1)?function(t){var e=l(this,t);return!!e&&e.enumerable}:a},h=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},d={}.toString,u=function(t){return d.call(t).slice(8,-1)},f="".split,p=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==u(t)?f.call(t,""):Object(t)}:Object,g=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},m=function(t){return p(g(t))},v=function(t){return"object"==typeof t?null!==t:"function"==typeof t},y=function(t,e){if(!v(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!v(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!v(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!v(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},b={}.hasOwnProperty,w=function(t,e){return b.call(t,e)},k=o.document,_=v(k)&&v(k.createElement),x=function(t){return _?k.createElement(t):{}},C=!s&&!r(function(){return 7!=Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a}),E=Object.getOwnPropertyDescriptor,T={f:s?E:function(t,e){if(t=m(t),e=y(e,!0),C)try{return E(t,e)}catch(i){}if(w(t,e))return h(!c.f.call(t,e),t[e])}},S=/#|\.prototype\./,A=function(t,e){var i=I[O(t)];return i==M||i!=P&&("function"==typeof e?r(e):!!e)},O=A.normalize=function(t){return String(t).replace(S,".").toLowerCase()},I=A.data={},P=A.NATIVE="N",M=A.POLYFILL="P",D=A,N={},R=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},z=function(t,e,i){if(R(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}},F=function(t){if(!v(t))throw TypeError(String(t)+" is not an object");return t},L=Object.defineProperty,B={f:s?L:function(t,e,i){if(F(t),e=y(e,!0),F(i),C)try{return L(t,e,i)}catch(n){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},j=s?function(t,e,i){return B.f(t,e,h(1,i))}:function(t,e,i){return t[e]=i,t},V=T.f,H=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},W=function(t,e){var i,n,r,s,a,l,c,h,d=t.target,u=t.global,f=t.stat,p=t.proto,g=u?o:f?o[d]:(o[d]||{}).prototype,m=u?N:N[d]||(N[d]={}),v=m.prototype;for(r in e)i=!D(u?r:d+(f?".":"#")+r,t.forced)&&g&&w(g,r),a=m[r],i&&(l=t.noTargetGet?(h=V(g,r))&&h.value:g[r]),s=i&&l?l:e[r],i&&typeof a==typeof s||(c=t.bind&&i?z(s,o):t.wrap&&i?H(s):p&&"function"==typeof s?z(Function.call,s):s,(t.sham||s&&s.sham||a&&a.sham)&&j(c,"sham",!0),m[r]=c,p&&(w(N,n=d+"Prototype")||j(N,n,{}),N[n][r]=s,t.real&&v&&!v[r]&&j(v,r,s)))},q=Array.isArray||function(t){return"Array"==u(t)},U=Math.ceil,Y=Math.floor,G=function(t){return isNaN(t=+t)?0:(t>0?Y:U)(t)},Z=Math.min,$=function(t){return t>0?Z(G(t),9007199254740991):0},X=function(t,e,i,n,o,r,s,a){for(var l,c=o,h=0,d=!!s&&z(s,a,3);h<n;){if(h in i){if(l=d?d(i[h],h,e):i[h],r>0&&q(l))c=X(t,e,l,$(l.length),c,r-1)-1;else{if(c>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[c]=l}c++}h++}return c},K=X,Q=function(t){return Object(g(t))},J="__core-js_shared__",tt=o[J]||function(t,e){try{j(o,t,e)}catch(i){o[t]=e}return e}(J,{}),et=i(function(t){(t.exports=function(t,e){return tt[t]||(tt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.7.0",mode:"pure",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})}),it=0,nt=Math.random(),ot=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++it+nt).toString(36)},rt=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())}),st=rt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=et("wks"),lt=o.Symbol,ct=st?lt:lt&&lt.withoutSetter||ot,ht=function(t){return w(at,t)||(at[t]=rt&&w(lt,t)?lt[t]:ct("Symbol."+t)),at[t]},dt=ht("species"),ut=function(t,e){var i;return q(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!q(i.prototype)?v(i)&&null===(i=i[dt])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)};W({target:"Array",proto:!0},{flatMap:function(t){var e,i=Q(this),n=$(i.length);return R(t),(e=ut(i,0)).length=K(e,i,i,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var ft,pt,gt=function(t){return N[t+"Prototype"]},mt=gt("Array").flatMap,vt=Array.prototype,yt=[].push,bt=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,r=6==t,s=5==t||r;return function(a,l,c,h){for(var d,u,f=Q(a),g=p(f),m=z(l,c,3),v=$(g.length),y=0,b=h||ut,w=e?b(a,v):i?b(a,0):void 0;v>y;y++)if((s||y in g)&&(u=m(d=g[y],y,f),t))if(e)w[y]=u;else if(u)switch(t){case 3:return!0;case 5:return d;case 6:return y;case 2:yt.call(w,d)}else if(o)return!1;return r?-1:n||o?o:w}},wt={forEach:bt(0),map:bt(1),filter:bt(2),some:bt(3),every:bt(4),find:bt(5),findIndex:bt(6)},kt=function(t){return"function"==typeof t?t:void 0},_t=function(t,e){return arguments.length<2?kt(N[t])||kt(o[t]):N[t]&&N[t][e]||o[t]&&o[t][e]},xt=_t("navigator","userAgent")||"",Ct=o.process,Et=Ct&&Ct.versions,Tt=Et&&Et.v8;Tt?pt=(ft=Tt.split("."))[0]+ft[1]:xt&&(!(ft=xt.match(/Edge\/(\d+)/))||ft[1]>=74)&&(ft=xt.match(/Chrome\/(\d+)/))&&(pt=ft[1]);var St=pt&&+pt,At=ht("species"),Ot=function(t){return St>=51||!r(function(){var e=[];return(e.constructor={})[At]=function(){return{foo:1}},1!==e[t](Boolean).foo})},It=Object.defineProperty,Pt={},Mt=function(t){throw t},Dt=function(t,e){if(w(Pt,t))return Pt[t];e||(e={});var i=[][t],n=!!w(e,"ACCESSORS")&&e.ACCESSORS,o=w(e,0)?e[0]:Mt,a=w(e,1)?e[1]:void 0;return Pt[t]=!!i&&!r(function(){if(n&&!s)return!0;var t={length:-1};n?It(t,1,{enumerable:!0,get:Mt}):t[1]=1,i.call(t,o,a)})},Nt=wt.map,Rt=Ot("map"),zt=Dt("map");W({target:"Array",proto:!0,forced:!Rt||!zt},{map:function(t){return Nt(this,t,arguments.length>1?arguments[1]:void 0)}});var Ft=gt("Array").map,Lt=Array.prototype,Bt=function(t){var e=t.map;return t===Lt||t instanceof Array&&e===Lt.map?Ft:e},jt=wt.filter,Vt=Ot("filter"),Ht=Dt("filter");W({target:"Array",proto:!0,forced:!Vt||!Ht},{filter:function(t){return jt(this,t,arguments.length>1?arguments[1]:void 0)}});var Wt=gt("Array").filter,qt=Array.prototype,Ut=function(t){var e=t.filter;return t===qt||t instanceof Array&&e===qt.filter?Wt:e},Yt=function(t){return function(e,i,n,o){R(i);var r=Q(e),s=p(r),a=$(r.length),l=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=c;break}if(l+=c,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=c)l in s&&(o=i(o,s[l],l,r));return o}},Gt={left:Yt(!1),right:Yt(!0)},Zt=function(t,e){var i=[][t];return!!i&&r(function(){i.call(null,e||function(){throw 1},1)})},$t="process"==u(o.process),Xt=Gt.left,Kt=Zt("reduce"),Qt=Dt("reduce",{1:0});W({target:"Array",proto:!0,forced:!Kt||!Qt||!$t&&St>79&&St<83},{reduce:function(t){return Xt(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Jt=gt("Array").reduce,te=Array.prototype,ee=function(t){var e=t.reduce;return t===te||t instanceof Array&&e===te.reduce?Jt:e},ie=[].slice,ne={},oe=function(t,e,i){if(!(e in ne)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";ne[e]=Function("C,a","return new C("+n.join(",")+")")}return ne[e](t,i)},re=Function.bind||function(t){var e=R(this),i=ie.call(arguments,1),n=function(){var o=i.concat(ie.call(arguments));return this instanceof n?oe(e,o.length,o):e.apply(t,o)};return v(e.prototype)&&(n.prototype=e.prototype),n};W({target:"Function",proto:!0},{bind:re});var se=gt("Function").bind,ae=Function.prototype,le=function(t){var e=t.bind;return t===ae||t instanceof Function&&e===ae.bind?se:e},ce=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};W({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperty:B.f});var he=i(function(t){var e=N.Object,i=t.exports=function(t,i,n){return e.defineProperty(t,i,n)};e.defineProperty.sham&&(i.sham=!0)}),de=he;function ue(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),de(t,n.key,n)}}var fe=function(t,e,i){return e&&ue(t.prototype,e),i&&ue(t,i),t},pe=function(){function t(e,i,n){var o,r,s;ce(this,t),this._source=e,this._transformers=i,this._target=n,this._listeners={add:le(o=this._add).call(o,this),remove:le(r=this._remove).call(r,this),update:le(s=this._update).call(s,this)}}return fe(t,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(t){var e;return ee(e=this._transformers).call(e,function(t,e){return e(t)},t)}},{key:"_add",value:function(t,e){null!=e&&this._target.add(this._transformItems(this._source.get(e.items)))}},{key:"_update",value:function(t,e){null!=e&&this._target.update(this._transformItems(this._source.get(e.items)))}},{key:"_remove",value:function(t,e){null!=e&&this._target.remove(this._transformItems(e.oldData))}}]),t}(),ge=function(){function t(e){ce(this,t),this._source=e,this._transformers=[]}return fe(t,[{key:"filter",value:function(t){return this._transformers.push(function(e){return Ut(e).call(e,t)}),this}},{key:"map",value:function(t){return this._transformers.push(function(e){return Bt(e).call(e,t)}),this}},{key:"flatMap",value:function(t){return this._transformers.push(function(e){return(i=e,n=i.flatMap,i===vt||i instanceof Array&&n===vt.flatMap?mt:n).call(e,t);var i,n}),this}},{key:"to",value:function(t){return new pe(this._source,this._transformers,t)}}]),t}(),me=he,ve=Math.max,ye=Math.min,be=function(t,e){var i=G(t);return i<0?ve(i+e,0):ye(i,e)},we=function(t){return function(e,i,n){var o,r=m(e),s=$(r.length),a=be(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},ke={includes:we(!0),indexOf:we(!1)},_e={},xe=ke.indexOf,Ce=function(t,e){var i,n=m(t),o=0,r=[];for(i in n)!w(_e,i)&&w(n,i)&&r.push(i);for(;e.length>o;)w(n,i=e[o++])&&(~xe(r,i)||r.push(i));return r},Ee=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Te=Object.keys||function(t){return Ce(t,Ee)},Se=s?Object.defineProperties:function(t,e){F(t);for(var i,n=Te(e),o=n.length,r=0;o>r;)B.f(t,i=n[r++],e[i]);return t};W({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperties:Se});var Ae=i(function(t){var e=N.Object,i=t.exports=function(t,i){return e.defineProperties(t,i)};e.defineProperties.sham&&(i.sham=!0)}),Oe=Ee.concat("length","prototype"),Ie={f:Object.getOwnPropertyNames||function(t){return Ce(t,Oe)}},Pe={f:Object.getOwnPropertySymbols},Me=_t("Reflect","ownKeys")||function(t){var e=Ie.f(F(t)),i=Pe.f;return i?e.concat(i(t)):e},De=function(t,e,i){var n=y(e);n in t?B.f(t,n,h(0,i)):t[n]=i};W({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(t){for(var e,i,n=m(t),o=T.f,r=Me(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&De(s,e,i);return s}});var Ne=N.Object.getOwnPropertyDescriptors,Re=T.f,ze=r(function(){Re(1)});W({target:"Object",stat:!0,forced:!s||ze,sham:!s},{getOwnPropertyDescriptor:function(t,e){return Re(m(t),e)}});var Fe,Le=i(function(t){var e=N.Object,i=t.exports=function(t,i){return e.getOwnPropertyDescriptor(t,i)};e.getOwnPropertyDescriptor.sham&&(i.sham=!0)}),Be=_t("document","documentElement"),je=et("keys"),Ve=function(t){return je[t]||(je[t]=ot(t))},He=Ve("IE_PROTO"),We=function(){},qe=function(t){return"<script>"+t+"<\/script>"},Ue=function(){try{Fe=document.domain&&new ActiveXObject("htmlfile")}catch(n){}var t,e;Ue=Fe?function(t){t.write(qe("")),t.close();var e=t.parentWindow.Object;return t=null,e}(Fe):((e=x("iframe")).style.display="none",Be.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(qe("document.F=Object")),t.close(),t.F);for(var i=Ee.length;i--;)delete Ue.prototype[Ee[i]];return Ue()};_e[He]=!0;var Ye=Object.create||function(t,e){var i;return null!==t?(We.prototype=F(t),i=new We,We.prototype=null,i[He]=t):i=Ue(),void 0===e?i:Se(i,e)},Ge=Ie.f,Ze={}.toString,$e="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Xe={f:function(t){return $e&&"[object Window]"==Ze.call(t)?function(t){try{return Ge(t)}catch(e){return $e.slice()}}(t):Ge(m(t))}},Ke=function(t,e,i,n){n&&n.enumerable?t[e]=i:j(t,e,i)},Qe={f:ht},Je=B.f,ti=function(t){var e=N.Symbol||(N.Symbol={});w(e,t)||Je(e,t,{value:Qe.f(t)})},ei={};ei[ht("toStringTag")]="z";var ii="[object z]"===String(ei),ni=ht("toStringTag"),oi="Arguments"==u(function(){return arguments}()),ri=ii?u:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(i){}}(e=Object(t),ni))?i:oi?u(e):"Object"==(n=u(e))&&"function"==typeof e.callee?"Arguments":n},si=ii?{}.toString:function(){return"[object "+ri(this)+"]"},ai=B.f,li=ht("toStringTag"),ci=function(t,e,i,n){if(t){var o=i?t:t.prototype;w(o,li)||ai(o,li,{configurable:!0,value:e}),n&&!ii&&j(o,"toString",si)}},hi=Function.toString;"function"!=typeof tt.inspectSource&&(tt.inspectSource=function(t){return hi.call(t)});var di,ui,fi,pi=o.WeakMap;if("function"==typeof pi&&/native code/.test((0,tt.inspectSource)(pi))){var gi=tt.state||(tt.state=new(0,o.WeakMap)),mi=gi.get,vi=gi.has,yi=gi.set;di=function(t,e){return e.facade=t,yi.call(gi,t,e),e},ui=function(t){return mi.call(gi,t)||{}},fi=function(t){return vi.call(gi,t)}}else{var bi=Ve("state");_e[bi]=!0,di=function(t,e){return e.facade=t,j(t,bi,e),e},ui=function(t){return w(t,bi)?t[bi]:{}},fi=function(t){return w(t,bi)}}var wi={set:di,get:ui,has:fi,enforce:function(t){return fi(t)?ui(t):di(t,{})},getterFor:function(t){return function(e){var i;if(!v(e)||(i=ui(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},ki=wt.forEach,_i=Ve("hidden"),xi="Symbol",Ci=ht("toPrimitive"),Ei=wi.set,Ti=wi.getterFor(xi),Si=Object.prototype,Ai=o.Symbol,Oi=_t("JSON","stringify"),Ii=T.f,Pi=B.f,Mi=Xe.f,Di=c.f,Ni=et("symbols"),Ri=et("op-symbols"),zi=et("string-to-symbol-registry"),Fi=et("symbol-to-string-registry"),Li=et("wks"),Bi=o.QObject,ji=!Bi||!Bi.prototype||!Bi.prototype.findChild,Vi=s&&r(function(){return 7!=Ye(Pi({},"a",{get:function(){return Pi(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=Ii(Si,e);n&&delete Si[e],Pi(t,e,i),n&&t!==Si&&Pi(Si,e,n)}:Pi,Hi=function(t,e){var i=Ni[t]=Ye(Ai.prototype);return Ei(i,{type:xi,tag:t,description:e}),s||(i.description=e),i},Wi=st?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Ai},qi=function(t,e,i){t===Si&&qi(Ri,e,i),F(t);var n=y(e,!0);return F(i),w(Ni,n)?(i.enumerable?(w(t,_i)&&t[_i][n]&&(t[_i][n]=!1),i=Ye(i,{enumerable:h(0,!1)})):(w(t,_i)||Pi(t,_i,h(1,{})),t[_i][n]=!0),Vi(t,n,i)):Pi(t,n,i)},Ui=function(t,e){F(t);var i=m(e),n=Te(i).concat($i(i));return ki(n,function(e){s&&!Yi.call(i,e)||qi(t,e,i[e])}),t},Yi=function(t){var e=y(t,!0),i=Di.call(this,e);return!(this===Si&&w(Ni,e)&&!w(Ri,e))&&(!(i||!w(this,e)||!w(Ni,e)||w(this,_i)&&this[_i][e])||i)},Gi=function(t,e){var i=m(t),n=y(e,!0);if(i!==Si||!w(Ni,n)||w(Ri,n)){var o=Ii(i,n);return!o||!w(Ni,n)||w(i,_i)&&i[_i][n]||(o.enumerable=!0),o}},Zi=function(t){var e=Mi(m(t)),i=[];return ki(e,function(t){w(Ni,t)||w(_e,t)||i.push(t)}),i},$i=function(t){var e=t===Si,i=Mi(e?Ri:m(t)),n=[];return ki(i,function(t){!w(Ni,t)||e&&!w(Si,t)||n.push(Ni[t])}),n};if(rt||(Ke((Ai=function(){if(this instanceof Ai)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=ot(t),i=function(t){this===Si&&i.call(Ri,t),w(this,_i)&&w(this[_i],e)&&(this[_i][e]=!1),Vi(this,e,h(1,t))};return s&&ji&&Vi(Si,e,{configurable:!0,set:i}),Hi(e,t)}).prototype,"toString",function(){return Ti(this).tag}),Ke(Ai,"withoutSetter",function(t){return Hi(ot(t),t)}),c.f=Yi,B.f=qi,T.f=Gi,Ie.f=Xe.f=Zi,Pe.f=$i,Qe.f=function(t){return Hi(ht(t),t)},s&&Pi(Ai.prototype,"description",{configurable:!0,get:function(){return Ti(this).description}})),W({global:!0,wrap:!0,forced:!rt,sham:!rt},{Symbol:Ai}),ki(Te(Li),function(t){ti(t)}),W({target:xi,stat:!0,forced:!rt},{for:function(t){var e=String(t);if(w(zi,e))return zi[e];var i=Ai(e);return zi[e]=i,Fi[i]=e,i},keyFor:function(t){if(!Wi(t))throw TypeError(t+" is not a symbol");if(w(Fi,t))return Fi[t]},useSetter:function(){ji=!0},useSimple:function(){ji=!1}}),W({target:"Object",stat:!0,forced:!rt,sham:!s},{create:function(t,e){return void 0===e?Ye(t):Ui(Ye(t),e)},defineProperty:qi,defineProperties:Ui,getOwnPropertyDescriptor:Gi}),W({target:"Object",stat:!0,forced:!rt},{getOwnPropertyNames:Zi,getOwnPropertySymbols:$i}),W({target:"Object",stat:!0,forced:r(function(){Pe.f(1)})},{getOwnPropertySymbols:function(t){return Pe.f(Q(t))}}),Oi){var Xi=!rt||r(function(){var t=Ai();return"[null]"!=Oi([t])||"{}"!=Oi({a:t})||"{}"!=Oi(Object(t))});W({target:"JSON",stat:!0,forced:Xi},{stringify:function(t,e,i){for(var n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e,(v(e)||void 0!==t)&&!Wi(t))return q(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Wi(e))return e}),o[1]=e,Oi.apply(null,o)}})}Ai.prototype[Ci]||j(Ai.prototype,Ci,Ai.prototype.valueOf),ci(Ai,xi),_e[_i]=!0;var Ki,Qi,Ji,tn=N.Object.getOwnPropertySymbols,en={},nn=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),on=Ve("IE_PROTO"),rn=Object.prototype,sn=nn?Object.getPrototypeOf:function(t){return t=Q(t),w(t,on)?t[on]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?rn:null},an=(ht("iterator"),!1);[].keys&&("next"in(Ji=[].keys())?(Qi=sn(sn(Ji)))!==Object.prototype&&(Ki=Qi):an=!0),null==Ki&&(Ki={});var ln={IteratorPrototype:Ki,BUGGY_SAFARI_ITERATORS:an},cn=ln.IteratorPrototype,hn=function(){return this},dn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(n){}return function(i,n){return F(i),function(t){if(!v(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0),un=ln.IteratorPrototype,fn=ln.BUGGY_SAFARI_ITERATORS,pn=ht("iterator"),gn="keys",mn="values",vn="entries",yn=function(){return this},bn=function(t,e,i,n,o,r,s){!function(t,e,i){var n=e+" Iterator";t.prototype=Ye(cn,{next:h(1,i)}),ci(t,n,!1,!0),en[n]=hn}(i,e,n);var a,l,c,d=function(t){if(t===o&&m)return m;if(!fn&&t in p)return p[t];switch(t){case gn:case mn:case vn:return function(){return new i(this,t)}}return function(){return new i(this)}},u=e+" Iterator",f=!1,p=t.prototype,g=p[pn]||p["@@iterator"]||o&&p[o],m=!fn&&g||d(o),v="Array"==e&&p.entries||g;if(v&&(a=sn(v.call(new t)),un!==Object.prototype&&a.next&&(ci(a,u,!0,!0),en[u]=yn)),o==mn&&g&&g.name!==mn&&(f=!0,m=function(){return g.call(this)}),s&&p[pn]!==m&&j(p,pn,m),en[e]=m,o)if(l={values:d(mn),keys:r?m:d(gn),entries:d(vn)},s)for(c in l)(fn||f||!(c in p))&&Ke(p,c,l[c]);else W({target:e,proto:!0,forced:fn||f},l);return l},wn="Array Iterator",kn=wi.set,_n=wi.getterFor(wn);bn(Array,"Array",function(t,e){kn(this,{type:wn,target:m(t),index:0,kind:e})},function(){var t=_n(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),en.Arguments=en.Array;var xn=ht("toStringTag");for(var Cn in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var En=o[Cn],Tn=En&&En.prototype;Tn&&ri(Tn)!==xn&&j(Tn,xn,Cn),en[Cn]=en.Array}var Sn=function(t){return function(e,i){var n,o,r=String(g(e)),s=G(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):n:t?r.slice(s,s+2):o-56320+(n-55296<<10)+65536}},An=(Sn(!1),Sn(!0)),On="String Iterator",In=wi.set,Pn=wi.getterFor(On);bn(String,"String",function(t){In(this,{type:On,string:String(t),index:0})},function(){var t,e=Pn(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=An(i,n),e.index+=t.length,{value:t,done:!1})});var Mn=ht("iterator"),Dn=function(t){if(null!=t)return t[Mn]||t["@@iterator"]||en[ri(t)]},Nn=function(t){var e=Dn(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return F(e.call(t))},Rn=Dn,zn=function(t){var e=t.return;if(void 0!==e)return F(e.call(t)).value},Fn=function(t,e,i,n){try{return n?e(F(i)[0],i[1]):e(i)}catch(o){throw zn(t),o}},Ln=ht("iterator"),Bn=Array.prototype,jn=function(t){return void 0!==t&&(en.Array===t||Bn[Ln]===t)},Vn=ht("iterator"),Hn=!1;try{var Wn=0,qn={next:function(){return{done:!!Wn++}},return:function(){Hn=!0}};qn[Vn]=function(){return this},Array.from(qn,function(){throw 2})}catch(dc){}var Un=!function(t,e){if(!Hn)return!1;var i=!1;try{var n={};n[Vn]=function(){return{next:function(){return{done:i=!0}}}},Array.from(n)}catch(dc){}return i}();W({target:"Array",stat:!0,forced:Un},{from:function(t){var e,i,n,o,r,s,a=Q(t),l="function"==typeof this?this:Array,c=arguments.length,h=c>1?arguments[1]:void 0,d=void 0!==h,u=Dn(a),f=0;if(d&&(h=z(h,c>2?arguments[2]:void 0,2)),null==u||l==Array&&jn(u))for(i=new l(e=$(a.length));e>f;f++)s=d?h(a[f],f):a[f],De(i,f,s);else for(r=(o=u.call(a)).next,i=new l;!(n=r.call(o)).done;f++)s=d?Fn(o,h,[n.value,f],!0):n.value,De(i,f,s);return i.length=f,i}});var Yn=N.Array.from,Gn=Yn;W({target:"Array",proto:!0},{fill:function(t){for(var e=Q(this),i=$(e.length),n=arguments.length,o=be(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:be(r,i);s>o;)e[o++]=t;return e}}),gt("Array");var Zn=[].slice,$n=/MSIE .\./.test(xt),Xn=function(t){return function(e,i){var n=arguments.length>2,o=n?Zn.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,i)}};W({global:!0,bind:!0,forced:$n},{setTimeout:Xn(o.setTimeout),setInterval:Xn(o.setInterval)});var Kn=N.setTimeout,Qn=_t("JSON","stringify"),Jn=/[\uD800-\uDFFF]/g,to=/^[\uD800-\uDBFF]$/,eo=/^[\uDC00-\uDFFF]$/,io=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return to.test(t)&&!eo.test(o)||eo.test(t)&&!to.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},no=r(function(){return'"\\udf06\\ud834"'!==Qn("\udf06\ud834")||'"\\udead"'!==Qn("\udead")});Qn&&W({target:"JSON",stat:!0,forced:no},{stringify:function(t,e,i){var n=Qn.apply(null,arguments);return"string"==typeof n?n.replace(Jn,io):n}}),N.JSON||(N.JSON={stringify:JSON.stringify}),W({target:"Object",stat:!0,sham:!s},{create:Ye});var oo=N.Object,ro=function(t,e){return oo.create(t,e)},so=ro,ao=function(t,e,i){return e in t?de(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},lo="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",co="["+lo+"]",ho=RegExp("^"+co+co+"*"),uo=RegExp(co+co+"*$"),fo=function(t){return function(e){var i=String(g(e));return 1&t&&(i=i.replace(ho,"")),2&t&&(i=i.replace(uo,"")),i}},po={start:fo(1),end:fo(2),trim:fo(3)},go=po.trim;W({target:"String",proto:!0,forced:("trim",r(function(){return!!lo.trim()||"\u200b\x85\u180e"!="\u200b\x85\u180e".trim()||"trim"!==lo.trim.name}))},{trim:function(){return go(this)}}),gt("String");var mo=ke.indexOf,vo=[].indexOf,yo=!!vo&&1/[1].indexOf(1,-0)<0,bo=Zt("indexOf"),wo=Dt("indexOf",{ACCESSORS:!0,1:0});W({target:"Array",proto:!0,forced:yo||!bo||!wo},{indexOf:function(t){return yo?vo.apply(this,arguments)||0:mo(this,t,arguments.length>1?arguments[1]:void 0)}}),gt("Array");var ko=po.trim,_o=o.parseInt,xo=/^[+-]?0[Xx]/,Co=8!==_o(lo+"08")||22!==_o(lo+"0x16")?function(t,e){var i=ko(String(t));return _o(i,e>>>0||(xo.test(i)?16:10))}:_o;W({global:!0,forced:parseInt!=Co},{parseInt:Co});var Eo=c.f,To=function(t){return function(e){for(var i,n=m(e),o=Te(n),r=o.length,a=0,l=[];r>a;)i=o[a++],s&&!Eo.call(n,i)||l.push(t?[i,n[i]]:n[i]);return l}},So=(To(!0),To(!1));W({target:"Object",stat:!0},{values:function(t){return So(t)}});var Ao=r(function(){sn(1)});W({target:"Object",stat:!0,forced:Ao,sham:!nn},{getPrototypeOf:function(t){return sn(Q(t))}});var Oo=N.Object.getPrototypeOf,Io=ke.includes,Po=Dt("indexOf",{ACCESSORS:!0,1:0});W({target:"Array",proto:!0,forced:!Po},{includes:function(t){return Io(this,t,arguments.length>1?arguments[1]:void 0)}}),gt("Array");var Mo=ht("match"),Do=function(t){if(function(t){var e;return v(t)&&(void 0!==(e=t[Mo])?!!e:"RegExp"==u(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},No=ht("match");W({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./".includes(e)}catch(i){try{return e[No]=!1,"/./".includes(e)}catch(n){}}return!1}()},{includes:function(t){return!!~String(g(this)).indexOf(Do(t),arguments.length>1?arguments[1]:void 0)}}),gt("String");var Ro=Object.assign,zo=Object.defineProperty,Fo=!Ro||r(function(){if(s&&1!==Ro({b:1},Ro(zo({},"a",{enumerable:!0,get:function(){zo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=Ro({},t)[i]||Te(Ro({},e)).join("")!=n})?function(t,e){for(var i=Q(t),n=arguments.length,o=1,r=Pe.f,a=c.f;n>o;)for(var l,h=p(arguments[o++]),d=r?Te(h).concat(r(h)):Te(h),u=d.length,f=0;u>f;)l=d[f++],s&&!a.call(h,l)||(i[l]=h[l]);return i}:Ro;W({target:"Object",stat:!0,forced:Object.assign!==Fo},{assign:Fo});var Lo=N.Object.assign,Bo=Ot("splice"),jo=Dt("splice",{ACCESSORS:!0,0:0,1:2}),Vo=Math.max,Ho=Math.min,Wo=9007199254740991,qo="Maximum allowed length exceeded";W({target:"Array",proto:!0,forced:!Bo||!jo},{splice:function(t,e){var i,n,o,r,s,a,l=Q(this),c=$(l.length),h=be(t,c),d=arguments.length;if(0===d?i=n=0:1===d?(i=0,n=c-h):(i=d-2,n=Ho(Vo(G(e),0),c-h)),c+i-n>Wo)throw TypeError(qo);for(o=ut(l,n),r=0;r<n;r++)(s=h+r)in l&&De(o,r,l[s]);if(o.length=n,i<n){for(r=h;r<c-n;r++)a=r+i,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=c;r>c-n+i;r--)delete l[r-1]}else if(i>n)for(r=c-n;r>h;r--)a=r+i-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<i;r++)l[r+h]=arguments[r+2];return l.length=c-n+i,o}});var Uo=gt("Array").splice,Yo=Array.prototype,Go=function(t){var e=t.splice;return t===Yo||t instanceof Array&&e===Yo.splice?Uo:e},Zo=[].reverse,$o=[1,2];W({target:"Array",proto:!0,forced:String($o)===String($o.reverse())},{reverse:function(){return q(this)&&(this.length=this.length),Zo.call(this)}});var Xo=gt("Array").reverse,Ko=Array.prototype,Qo=wt.forEach,Jo=Zt("forEach"),tr=Dt("forEach"),er=Jo&&tr?[].forEach:function(t){return Qo(this,t,arguments.length>1?arguments[1]:void 0)};W({target:"Array",proto:!0,forced:[].forEach!=er},{forEach:er});var ir=gt("Array").forEach,nr=Array.prototype,or={DOMTokenList:!0,NodeList:!0},rr=function(t){var e=t.forEach;return t===nr||t instanceof Array&&e===nr.forEach||or.hasOwnProperty(ri(t))?ir:e};W({target:"Array",stat:!0},{isArray:q});var sr=N.Array.isArray,ar=sr,lr=ht("iterator"),cr=function(t){var e=Object(t);return void 0!==e[lr]||"@@iterator"in e||en.hasOwnProperty(ri(e))},hr=ht("isConcatSpreadable"),dr=9007199254740991,ur="Maximum allowed index exceeded",fr=St>=51||!r(function(){var t=[];return t[hr]=!1,t.concat()[0]!==t}),pr=Ot("concat"),gr=function(t){if(!v(t))return!1;var e=t[hr];return void 0!==e?!!e:q(t)};W({target:"Array",proto:!0,forced:!fr||!pr},{concat:function(t){var e,i,n,o,r,s=Q(this),a=ut(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(gr(r=-1===e?s:arguments[e])){if(l+(o=$(r.length))>dr)throw TypeError(ur);for(i=0;i<o;i++,l++)i in r&&De(a,l,r[i])}else{if(l>=dr)throw TypeError(ur);De(a,l++,r)}return a.length=l,a}}),ti("asyncIterator"),ti("hasInstance"),ti("isConcatSpreadable"),ti("iterator"),ti("match"),ti("matchAll"),ti("replace"),ti("search"),ti("species"),ti("split"),ti("toPrimitive"),ti("toStringTag"),ti("unscopables"),ci(o.JSON,"JSON",!0);var mr=N.Symbol;ti("asyncDispose"),ti("dispose"),ti("observable"),ti("patternMatch"),ti("replaceAll");var vr=mr,yr=Yn,br=Ot("slice"),wr=Dt("slice",{ACCESSORS:!0,0:0,1:2}),kr=ht("species"),_r=[].slice,xr=Math.max;W({target:"Array",proto:!0,forced:!br||!wr},{slice:function(t,e){var i,n,o,r=m(this),s=$(r.length),a=be(t,s),l=be(void 0===e?s:e,s);if(q(r)&&("function"!=typeof(i=r.constructor)||i!==Array&&!q(i.prototype)?v(i)&&null===(i=i[kr])&&(i=void 0):i=void 0,i===Array||void 0===i))return _r.call(r,a,l);for(n=new(void 0===i?Array:i)(xr(l-a,0)),o=0;a<l;a++,o++)a in r&&De(n,o,r[a]);return n.length=o,n}});var Cr=gt("Array").slice,Er=Array.prototype,Tr=function(t){var e=t.slice;return t===Er||t instanceof Array&&e===Er.slice?Cr:e},Sr=Tr,Ar=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},Or=function(t,e){var i;if(t){if("string"==typeof t)return Ar(t,e);var n=Sr(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?yr(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ar(t,e):void 0}},Ir=function(t,e){return function(t){if(ar(t))return t}(t)||function(t,e){if(void 0!==vr&&cr(Object(t))){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=Nn(t);!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(l){o=!0,r=l}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return i}}(t,e)||Or(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()};W({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Pr=r(function(){Te(1)});W({target:"Object",stat:!0,forced:Pr},{keys:function(t){return Te(Q(t))}});var Mr=N.Object.keys,Dr=sr,Nr=Qe.f("iterator"),Rr=Nr,zr=i(function(t){function e(i){return t.exports=e="function"==typeof vr&&"symbol"==typeof Rr?function(t){return typeof t}:function(t){return t&&"function"==typeof vr&&t.constructor===vr&&t!==vr.prototype?"symbol":typeof t},e(i)}t.exports=e});W({target:"Reflect",stat:!0},{ownKeys:Me});var Fr=N.Reflect.ownKeys,Lr=Tr,Br=function(t){return function(t){if(ar(t))return Ar(t)}(t)||function(t){if(void 0!==vr&&cr(Object(t)))return yr(t)}(t)||Or(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},jr=gt("Array").concat,Vr=Array.prototype,Hr=function(t){var e=t.concat;return t===Vr||t instanceof Array&&e===Vr.concat?jr:e},Wr=mr,qr=i(function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}});function Ur(){return(Ur=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Yr(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Gr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Zr,$r="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,Xr=["","webkit","Moz","MS","ms","o"],Kr="undefined"==typeof document?{style:{}}:document.createElement("div"),Qr=Math.round,Jr=Math.abs,ts=Date.now;function es(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<Xr.length;){if((n=(i=Xr[r])?i+o:e)in t)return n;r++}}Zr="undefined"==typeof window?{}:window;var is=es(Kr.style,"touchAction"),ns=void 0!==is,os="compute",rs="auto",ss="manipulation",as="none",ls="pan-x",cs="pan-y",hs=function(){if(!ns)return!1;var t={},e=Zr.CSS&&Zr.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||Zr.CSS.supports("touch-action",i)}),t}(),ds="ontouchstart"in Zr,us=void 0!==es(Zr,"PointerEvent"),fs=ds&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ps="touch",gs="mouse",ms=["x","y"],vs=["clientX","clientY"];function ys(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function bs(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function ws(t,e){return t.indexOf(e)>-1}var ks=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===os&&(t=this.compute()),ns&&this.manager.element.style&&hs[t]&&(this.manager.element.style[is]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return ys(this.manager.recognizers,function(e){bs(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(ws(t,as))return as;var e=ws(t,ls),i=ws(t,cs);return e&&i?as:e||i?e?ls:cs:ws(t,ss)?ss:rs}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,o=ws(n,as)&&!hs.none,r=ws(n,cs)&&!hs["pan-y"],s=ws(n,ls)&&!hs["pan-x"];if(o&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!s||!r)return o||r&&6&i||s&&24&i?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function _s(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function xs(t){var e=t.length;if(1===e)return{x:Qr(t[0].clientX),y:Qr(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:Qr(i/e),y:Qr(n/e)}}function Cs(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Qr(t.pointers[i].clientX),clientY:Qr(t.pointers[i].clientY)},i++;return{timeStamp:ts(),pointers:e,center:xs(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Es(t,e,i){i||(i=ms);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function Ts(t,e,i){return i||(i=ms),180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function Ss(t,e){return t===e?1:Jr(t)>=Jr(e)?t<0?2:4:e<0?8:16}function As(t,e,i){return{x:e/t||0,y:i/t||0}}function Os(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=1&e&&n-o==0,s=12&e&&n-o==0;i.isFirst=!!r,i.isFinal=!!s,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=Cs(e)),o>1&&!i.firstMultiple?i.firstMultiple=Cs(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,a=s?s.center:r.center,l=e.center=xs(n);e.timeStamp=ts(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=Ts(a,l),e.distance=Es(a,l),function(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}(i,e),e.offsetDirection=Ss(e.deltaX,e.deltaY);var c,h,d=As(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=Jr(d.x)>Jr(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,Es((h=n)[0],h[1],vs)/Es(c[0],c[1],vs)):1,e.rotation=s?function(t,e){return Ts(e[1],e[0],vs)+Ts(t[1],t[0],vs)}(s.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=As(a,l,c);n=h.x,o=h.y,i=Jr(h.x)>Jr(h.y)?h.x:h.y,r=Ss(l,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(i,e);var u,f=t.element,p=e.srcEvent;_s(u=p.composedPath?p.composedPath()[0]:p.path?p.path[0]:p.target,f)&&(f=u),e.target=f}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Is(t){return t.trim().split(/\s+/g)}function Ps(t,e,i){ys(Is(e),function(e){t.addEventListener(e,i,!1)})}function Ms(t,e,i){ys(Is(e),function(e){t.removeEventListener(e,i,!1)})}function Ds(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var Ns=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){bs(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&Ps(this.element,this.evEl,this.domHandler),this.evTarget&&Ps(this.target,this.evTarget,this.domHandler),this.evWin&&Ps(Ds(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&Ms(this.element,this.evEl,this.domHandler),this.evTarget&&Ms(this.target,this.evTarget,this.domHandler),this.evWin&&Ms(Ds(this.element),this.evWin,this.domHandler)},t}();function Rs(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}var zs={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Fs={2:ps,3:"pen",4:gs,5:"kinect"},Ls="pointerdown",Bs="pointermove pointerup pointercancel";Zr.MSPointerEvent&&!Zr.PointerEvent&&(Ls="MSPointerDown",Bs="MSPointerMove MSPointerUp MSPointerCancel");var js=function(t){function e(){var i,n=e.prototype;return n.evEl=Ls,n.evWin=Bs,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return Yr(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=zs[n],r=Fs[t.pointerType]||t.pointerType,s=r===ps,a=Rs(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))},e}(Ns);function Vs(t){return Array.prototype.slice.call(t,0)}function Hs(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];Rs(o,s)<0&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var Ws={touchstart:1,touchmove:2,touchend:4,touchcancel:8},qs="touchstart touchmove touchend touchcancel",Us=function(t){function e(){var i;return e.prototype.evTarget=qs,(i=t.apply(this,arguments)||this).targetIds={},i}return Yr(e,t),e.prototype.handler=function(t){var e=Ws[t.type],i=Ys.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:ps,srcEvent:t})},e}(Ns);function Ys(t,e){var i,n,o=Vs(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=Vs(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return _s(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[Hs(n.concat(a),"identifier",!0),a]:void 0}var Gs={mousedown:1,mousemove:2,mouseup:4},Zs="mousedown",$s="mousemove mouseup",Xs=function(t){function e(){var i,n=e.prototype;return n.evEl=Zs,n.evWin=$s,(i=t.apply(this,arguments)||this).pressed=!1,i}return Yr(e,t),e.prototype.handler=function(t){var e=Gs[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:gs,srcEvent:t}))},e}(Ns);function Ks(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function Qs(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,Ks.call(this,e)):12&t&&Ks.call(this,e)}function Js(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var ta=function(){return function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o=i.pointerType===gs;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(i.pointerType===ps)Qs.call(Gr(Gr(n)),e,i);else if(o&&Js.call(Gr(Gr(n)),i))return;n.callback(t,e,i)}},n.touch=new Us(n.manager,n.handler),n.mouse=new Xs(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return Yr(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(Ns)}();function ea(t,e,i){return!!Array.isArray(t)&&(ys(t,i[e],i),!0)}var ia=32,na=1;function oa(t,e){var i=e.manager;return i?i.get(t):t}function ra(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var sa=function(){function t(t){void 0===t&&(t={}),this.options=Ur({enable:!0},t),this.id=na++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return $r(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(ea(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=oa(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return ea(t,"dropRecognizeWith",this)||(t=oa(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(ea(t,"requireFailure",this))return this;var e=this.requireFail;return-1===Rs(e,t=oa(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(ea(t,"dropRequireFailure",this))return this;t=oa(t,this);var e=Rs(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+ra(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+ra(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=ia},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=$r({},t);if(!bs(this.options.enable,[this,e]))return this.reset(),void(this.state=ia);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),aa=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ur({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[ss]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||Es(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return ia},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=ia},this.options.interval),ia},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(sa),la=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ur({pointers:1},e))||this}Yr(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:ia},e}(sa);function ca(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var ha=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ur({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(cs),24&t&&e.push(ls),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return la.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=ca(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(la),da=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ur({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){return ha.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&Jr(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=ca(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(la),ua=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ur({event:"pinch",threshold:0,pointers:2},e))||this}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[as]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),t.prototype.emit.call(this,e)},e}(la),fa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ur({event:"rotate",threshold:0,pointers:2},e))||this}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[as]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(la),pa=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ur({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}Yr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[rs]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,!o||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8;return ia},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ts(),this.manager.emit(this.options.event,this._input)))},e}(sa),ga={domEvents:!1,touchAction:os,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ma=[[fa,{enable:!1}],[ua,{enable:!1},["rotate"]],[da,{direction:6}],[ha,{direction:6},["swipe"]],[aa],[aa,{event:"doubletap",taps:2},["tap"]],[pa]];function va(t,e){var i,n=t.element;n.style&&(ys(t.options.cssProps,function(o,r){i=es(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var ya=function(){function t(t,e){var i=this;this.options=$r({},ga,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(us?js:fs?Us:ds?ta:Xs))(this,Os),this.touchAction=new ks(this,this.options.touchAction),va(this,!0),ys(this.options.recognizers,function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return $r(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(e.curRecognizer=null,o=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||o&&i!==o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&14&i.state&&(e.curRecognizer=i,o=i),r++}},e.get=function(t){if(t instanceof sa)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(ea(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(ea(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=Rs(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return ys(Is(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return ys(Is(t),function(t){e?i[t]&&i[t].splice(Rs(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},e.destroy=function(){this.element&&va(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),ba={touchstart:1,touchmove:2,touchend:4,touchcancel:8},wa="touchstart",ka="touchstart touchmove touchend touchcancel",_a=function(t){function e(){var i,n=e.prototype;return n.evTarget=wa,n.evWin=ka,(i=t.apply(this,arguments)||this).started=!1,i}return Yr(e,t),e.prototype.handler=function(t){var e=ba[t.type];if(1===e&&(this.started=!0),this.started){var i=xa.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:ps,srcEvent:t})}},e}(Ns);function xa(t,e){var i=Vs(t.touches),n=Vs(t.changedTouches);return 12&e&&(i=Hs(i.concat(n),"identifier",!0)),[i,n]}function Ca(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var Ea=Ca(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),Ta=Ca(function(t,e){return Ea(t,e,!0)},"merge","Use `assign`.");function Sa(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&$r(n,i)}function Aa(t,e){return function(){return t.apply(e,arguments)}}var Oa=function(){var t=function(t,e){return void 0===e&&(e={}),new ya(t,Ur({recognizers:ma.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=16,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=24,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=16,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=ia,t.Manager=ya,t.Input=Ns,t.TouchAction=ks,t.TouchInput=Us,t.MouseInput=Xs,t.PointerEventInput=js,t.TouchMouseInput=ta,t.SingleTouchInput=_a,t.Recognizer=sa,t.AttrRecognizer=la,t.Tap=aa,t.Pan=ha,t.Swipe=da,t.Pinch=ua,t.Rotate=fa,t.Press=pa,t.on=Ps,t.off=Ms,t.each=ys,t.merge=Ta,t.extend=Ea,t.bindFn=Aa,t.assign=$r,t.inherit=Sa,t.bindFn=Aa,t.prefixed=es,t.toArray=Vs,t.inArray=Rs,t.uniqueArray=Hs,t.splitStr=Is,t.boolOrFn=bs,t.hasParent=_s,t.addEventListeners=Ps,t.removeEventListeners=Ms,t.defaults=$r({},ga,{preset:ma}),t}();function Ia(t,e){var i;if(void 0===Wr||null==Rn(t)){if(Dr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Pa(t,e);var n=Lr(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pa(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Pa(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ma=Wr("DELETE");function Da(){var t=Na.apply(void 0,arguments);return za(t),t}function Na(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<2)return e[0];var n;if(e.length>2)return Na.apply(void 0,Hr(n=[Da(e[0],e[1])]).call(n,Br(Lr(e).call(e,2))));var o,r=e[0],s=e[1],a=Ia(Fr(s));try{for(a.s();!(o=a.n()).done;){var l=o.value;Object.prototype.propertyIsEnumerable.call(s,l)&&(s[l]===Ma?delete r[l]:r[l]=null===r[l]||null===s[l]||"object"!==zr(r[l])||"object"!==zr(s[l])||Dr(r[l])||Dr(s[l])?Ra(s[l]):Na(r[l],s[l]))}}catch(c){a.e(c)}finally{a.f()}return r}function Ra(t){return Dr(t)?Bt(t).call(t,function(t){return Ra(t)}):"object"===zr(t)&&null!==t?Na({},t):t}function za(t){for(var e=0,i=Mr(t);e<i.length;e++){var n=i[e];t[n]===Ma?delete t[n]:"object"===zr(t[n])&&null!==t[n]&&za(t[n])}}var Fa="undefined"!=typeof window?window.Hammer||Oa:function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(){return{set:t}}};var t};function La(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)});var n=Fa(this._dom.overlay);n.on("tap",le(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){n.destroy()});var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];rr(o).call(o,function(t){n.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",i._onClick)})),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}qr(La.prototype),La.current=null,La.prototype.destroy=function(){var t,e;this.deactivate();var i,n,o,r=Ia((n=t=Go(e=this._cleanupQueue).call(e,0),o=n.reverse,n===Ko||n instanceof Array&&o===Ko.reverse?Xo:o).call(t));try{for(r.s();!(i=r.n()).done;)(0,i.value)()}catch(s){r.e(s)}finally{r.f()}},La.prototype.activate=function(){La.current&&La.current.deactivate(),La.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},La.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},La.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var Ba=_t("Reflect","construct"),ja=r(function(){function t(){}return!(Ba(function(){},[],t)instanceof t)}),Va=!r(function(){Ba(function(){})}),Ha=ja||Va;W({target:"Reflect",stat:!0,forced:Ha,sham:Ha},{construct:function(t,e){R(t),F(e);var i=arguments.length<3?t:R(arguments[2]);if(Va&&!ja)return Ba(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(re.apply(t,n))}var o=i.prototype,r=Ye(v(o)?o:Object.prototype),s=Function.apply.call(t,r,e);return v(s)?s:r}});var Wa=N.Reflect.construct,qa=gt("Array").entries,Ua=Array.prototype,Ya={DOMTokenList:!0,NodeList:!0},Ga=i(function(t){var e=function(t){var e,i=Object.prototype,n=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(P){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var o=Object.create((e&&e.prototype instanceof m?e:m).prototype),r=new A(n||[]);return o._invoke=function(t,e,i){var n=d;return function(o,r){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw r;return I()}for(i.method=o,i.arg=r;;){var s=i.delegate;if(s){var a=E(s,i);if(a){if(a===g)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=h(t,e,i);if("normal"===l.type){if(n=i.done?p:u,l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=p,i.method="throw",i.arg=l.arg)}}}(t,i,r),o}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(P){return{type:"throw",arg:P}}}t.wrap=c;var d="suspendedStart",u="suspendedYield",f="executing",p="completed",g={};function m(){}function v(){}function y(){}var b={};b[r]=function(){return this};var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==i&&n.call(k,r)&&(b=k);var _=y.prototype=m.prototype=Object.create(b);function x(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function C(t,e){function i(o,r,s,a){var l=h(t[o],t,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then(function(t){i("next",t,s,a)},function(t){i("throw",t,s,a)}):e.resolve(d).then(function(t){c.value=t,s(c)},function(t){return i("throw",t,s,a)})}a(l.arg)}var o;this._invoke=function(t,n){function r(){return new e(function(e,o){i(t,n,e,o)})}return o=o?o.then(r,r):r()}}function E(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,E(t,i),"throw"===i.method))return g;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=h(n,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var r=o.arg;return r?r.done?(i[t.resultName]=r.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function O(t){if(t){var i=t[r];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function i(){for(;++o<t.length;)if(n.call(t,o))return i.value=t[o],i.done=!1,i;return i.value=e,i.done=!0,i};return s.next=s}}return{next:I}}function I(){return{value:e,done:!0}}return v.prototype=_.constructor=y,y.constructor=v,v.displayName=l(y,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,a,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},x(C.prototype),C.prototype[s]=function(){return this},t.AsyncIterator=C,t.async=function(e,i,n,o,r){void 0===r&&(r=Promise);var s=new C(c(e,i,n,o),r);return t.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},x(_),l(_,a,"Generator"),_[r]=function(){return this},_.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=O,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function o(n,o){return a.type="throw",a.arg=t,i.next=n,o&&(i.method="next",i.arg=e),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),S(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;S(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:O(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=e}catch(i){Function("r","regeneratorRuntime = r")(e)}}),Za=Nr,$a=gt("Array").values,Xa=Array.prototype,Ka={DOMTokenList:!0,NodeList:!0},Qa=function(t){var e=t.values;return t===Xa||t instanceof Array&&e===Xa.values||Ka.hasOwnProperty(ri(t))?$a:e},Ja=[],tl=Ja.sort,el=r(function(){Ja.sort(void 0)}),il=r(function(){Ja.sort(null)}),nl=Zt("sort");W({target:"Array",proto:!0,forced:el||!il||!nl},{sort:function(t){return void 0===t?tl.call(Q(this)):tl.call(Q(this),R(t))}});var ol=gt("Array").sort,rl=Array.prototype,sl=function(t){var e=t.sort;return t===rl||t instanceof Array&&e===rl.sort?ol:e},al=gt("Array").keys,ll=Array.prototype,cl={DOMTokenList:!0,NodeList:!0},hl=function(t){var e=t.keys;return t===ll||t instanceof Array&&e===ll.keys||cl.hasOwnProperty(ri(t))?al:e},dl=wt.some,ul=Zt("some"),fl=Dt("some");W({target:"Array",proto:!0,forced:!ul||!fl},{some:function(t){return dl(this,t,arguments.length>1?arguments[1]:void 0)}});var pl=gt("Array").some,gl=Array.prototype,ml=!r(function(){return Object.isExtensible(Object.preventExtensions({}))}),vl=i(function(t){var e=B.f,i=ot("meta"),n=0,o=Object.isExtensible||function(){return!0},r=function(t){e(t,i,{value:{objectID:"O"+ ++n,weakData:{}}})},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!v(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,i)){if(!o(t))return"F";if(!e)return"E";r(t)}return t[i].objectID},getWeakData:function(t,e){if(!w(t,i)){if(!o(t))return!0;if(!e)return!1;r(t)}return t[i].weakData},onFreeze:function(t){return ml&&s.REQUIRED&&o(t)&&!w(t,i)&&r(t),t}};_e[i]=!0}),yl=function(t,e){this.stopped=t,this.result=e},bl=function(t,e,i){var n,o,r,s,a,l,c,h=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),u=!(!i||!i.INTERRUPTED),f=z(e,i&&i.that,1+h+u),p=function(t){return n&&zn(n),new yl(!0,t)},g=function(t){return h?(F(t),u?f(t[0],t[1],p):f(t[0],t[1])):u?f(t,p):f(t)};if(d)n=t;else{if("function"!=typeof(o=Dn(t)))throw TypeError("Target is not iterable");if(jn(o)){for(r=0,s=$(t.length);s>r;r++)if((a=g(t[r]))&&a instanceof yl)return a;return new yl(!1)}n=o.call(t)}for(l=n.next;!(c=l.call(n)).done;){try{a=g(c.value)}catch(dc){throw zn(n),dc}if("object"==typeof a&&a&&a instanceof yl)return a}return new yl(!1)},wl=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t},kl=B.f,_l=wt.forEach,xl=wi.set,Cl=wi.getterFor,El=function(t,e,i){var n,a=-1!==t.indexOf("Map"),l=-1!==t.indexOf("Weak"),c=a?"set":"add",h=o[t],d=h&&h.prototype,u={};if(s&&"function"==typeof h&&(l||d.forEach&&!r(function(){(new h).entries().next()}))){n=e(function(e,i){xl(wl(e,n,t),{type:t,collection:new h}),null!=i&&bl(i,e[c],{that:e,AS_ENTRIES:a})});var f=Cl(t);_l(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"==t||"set"==t;!(t in d)||l&&"clear"==t||j(n.prototype,t,function(i,n){var o=f(this).collection;if(!e&&l&&!v(i))return"get"==t&&void 0;var r=o[t](0===i?0:i,n);return e?this:r})}),l||kl(n.prototype,"size",{configurable:!0,get:function(){return f(this).collection.size}})}else n=i.getConstructor(e,t,a,c),vl.REQUIRED=!0;return ci(n,t,!1,!0),u[t]=n,W({global:!0,forced:!0},u),l||i.setStrong(n,t,a),n},Tl=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:Ke(t,n,e[n],i);return t},Sl=ht("species"),Al=B.f,Ol=vl.fastKey,Il=wi.set,Pl=wi.getterFor,Ml={getConstructor:function(t,e,i,n){var o=t(function(t,r){wl(t,o,e),Il(t,{type:e,index:Ye(null),first:void 0,last:void 0,size:0}),s||(t.size=0),null!=r&&bl(r,t[n],{that:t,AS_ENTRIES:i})}),r=Pl(e),a=function(t,e,i){var n,o,a=r(t),c=l(t,e);return c?c.value=i:(a.last=c={index:o=Ol(e,!0),key:e,value:i,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=c),n&&(n.next=c),s?a.size++:t.size++,"F"!==o&&(a.index[o]=c)),t},l=function(t,e){var i,n=r(t),o=Ol(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key==e)return i};return Tl(o.prototype,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,s?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),n=l(e,t);if(n){var o=n.next,a=n.previous;delete i.index[n.index],n.removed=!0,a&&(a.next=o),o&&(o.previous=a),i.first==n&&(i.first=o),i.last==n&&(i.last=a),s?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=r(this),n=z(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!l(this,t)}}),Tl(o.prototype,i?{get:function(t){var e=l(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),s&&Al(o.prototype,"size",{get:function(){return r(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=Pl(e),r=Pl(n);bn(t,e,function(t,e){Il(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),function(t){var e=_t(t);s&&e&&!e[Sl]&&(0,B.f)(e,Sl,{configurable:!0,get:function(){return this}})}(e)}},Dl=(El("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ml),N.Map),Nl=ro;W({target:"Object",stat:!0},{setPrototypeOf:dn});var Rl,zl=N.Object.setPrototypeOf,Fl=i(function(t){function e(i,n){return t.exports=e=zl||function(t,e){return t.__proto__=e,t},e(i,n)}t.exports=e}),Ll=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Nl(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Fl(t,e)},Bl=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},jl=function(t,e){return!e||"object"!==zr(e)&&"function"!=typeof e?Bl(t):e},Vl=Oo,Hl=i(function(t){function e(i){return t.exports=e=zl?Vl:function(t){return t.__proto__||Vl(t)},e(i)}t.exports=e}),Wl=new Uint8Array(16);function ql(){if(!Rl&&!(Rl="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rl(Wl)}var Ul=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Yl(t){return"string"==typeof t&&Ul.test(t)}for(var Gl=[],Zl=0;Zl<256;++Zl)Gl.push((Zl+256).toString(16).substr(1));function $l(t,e,i){var n=(t=t||{}).random||(t.rng||ql)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){i=i||0;for(var o=0;o<16;++o)e[i+o]=n[o];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(Gl[t[e+0]]+Gl[t[e+1]]+Gl[t[e+2]]+Gl[t[e+3]]+"-"+Gl[t[e+4]]+Gl[t[e+5]]+"-"+Gl[t[e+6]]+Gl[t[e+7]]+"-"+Gl[t[e+8]]+Gl[t[e+9]]+"-"+Gl[t[e+10]]+Gl[t[e+11]]+Gl[t[e+12]]+Gl[t[e+13]]+Gl[t[e+14]]+Gl[t[e+15]]).toLowerCase();if(!Yl(i))throw TypeError("Stringified UUID is invalid");return i}(n)}function Xl(t){return"string"==typeof t||"number"==typeof t}var Kl=function(){function t(e){ce(this,t),this._queue=[],this._timeout=null,this._extended=null,this.delay=null,this.max=1/0,this.setOptions(e)}return fe(t,[{key:"setOptions",value:function(t){t&&void 0!==t.delay&&(this.delay=t.delay),t&&void 0!==t.max&&(this.max=t.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var t=this._extended.object,e=this._extended.methods,i=0;i<e.length;i++){var n=e[i];n.original?t[n.name]=n.original:delete t[n.name]}this._extended=null}}},{key:"replace",value:function(t,e){var i=this,n=t[e];if(!n)throw new Error("Method "+e+" undefined");t[e]=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];i.queue({args:e,fn:n,context:this})}}},{key:"queue",value:function(t){this._queue.push("function"==typeof t?{fn:t}:t),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var t=this;this._queue.length>this.max&&this.flush(),null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&"number"==typeof this.delay&&(this._timeout=Kn(function(){t.flush()},this.delay))}},{key:"flush",value:function(){var t,e;rr(t=Go(e=this._queue).call(e,0)).call(t,function(t){t.fn.apply(t.context||t.fn,t.args||[])})}}],[{key:"extend",value:function(e,i){var n=new t(i);if(void 0!==e.flush)throw new Error("Target object already has a property flush");e.flush=function(){n.flush()};var o=[{name:"flush",original:void 0}];if(i&&i.replace)for(var r=0;r<i.replace.length;r++){var s=i.replace[r];o.push({name:s,original:e[s]}),n.replace(e,s)}return n._extended={object:e,methods:o},n}}]),t}(),Ql=function(){function t(){ce(this,t),this._subscribers={"*":[],add:[],remove:[],update:[]},this.subscribe=t.prototype.on,this.unsubscribe=t.prototype.off}return fe(t,[{key:"_trigger",value:function(t,e,i){var n,o;if("*"===t)throw new Error("Cannot trigger event *");rr(n=Hr(o=[]).call(o,Br(this._subscribers[t]),Br(this._subscribers["*"]))).call(n,function(n){n(t,e,null!=i?i:null)})}},{key:"on",value:function(t,e){"function"==typeof e&&this._subscribers[t].push(e)}},{key:"off",value:function(t,e){var i;this._subscribers[t]=Ut(i=this._subscribers[t]).call(i,function(t){return t!==e})}}]),t}(),Jl=(El("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Ml),N.Set);function tc(t,e){var i;if(void 0===Wr||null==Rn(t)){if(Dr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return ec(t,e);var n=Lr(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ec(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function ec(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ic=function(){function t(e){ce(this,t),this._pairs=e}return fe(t,[{key:Za,value:Ga.mark(function t(){var e,i,n,o,r;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=tc(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Ir(i.value,2),o=n[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"entries",value:Ga.mark(function t(){var e,i,n,o,r;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=tc(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Ir(i.value,2),o=n[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"keys",value:Ga.mark(function t(){var e,i,n,o;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=tc(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Ir(i.value,1),o=n[0],t.next=7,o;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"values",value:Ga.mark(function t(){var e,i,n,o;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=tc(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Ir(i.value,2),o=n[1],t.next=7,o;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"toIdArray",value:function(){var t;return Bt(t=Br(this._pairs)).call(t,function(t){return t[0]})}},{key:"toItemArray",value:function(){var t;return Bt(t=Br(this._pairs)).call(t,function(t){return t[1]})}},{key:"toEntryArray",value:function(){return Br(this._pairs)}},{key:"toObjectMap",value:function(){var t,e=so(null),i=tc(this._pairs);try{for(i.s();!(t=i.n()).done;){var n=Ir(t.value,2);e[n[0]]=n[1]}}catch(o){i.e(o)}finally{i.f()}return e}},{key:"toMap",value:function(){return new Dl(this._pairs)}},{key:"toIdSet",value:function(){return new Jl(this.toIdArray())}},{key:"toItemSet",value:function(){return new Jl(this.toItemArray())}},{key:"cache",value:function(){return new t(Br(this._pairs))}},{key:"distinct",value:function(t){var e,i=new Jl,n=tc(this._pairs);try{for(n.s();!(e=n.n()).done;){var o=Ir(e.value,2);i.add(t(o[1],o[0]))}}catch(r){n.e(r)}finally{n.f()}return i}},{key:"filter",value:function(e){var i=this._pairs;return new t(ao({},Za,Ga.mark(function t(){var n,o,r,s,a;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=tc(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=10;break}if(r=Ir(o.value,2),!e(a=r[1],s=r[0])){t.next=8;break}return t.next=8,[s,a];case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}},t,null,[[1,12,15,18]])})))}},{key:"forEach",value:function(t){var e,i=tc(this._pairs);try{for(i.s();!(e=i.n()).done;){var n=Ir(e.value,2);t(n[1],n[0])}}catch(o){i.e(o)}finally{i.f()}}},{key:"map",value:function(e){var i=this._pairs;return new t(ao({},Za,Ga.mark(function t(){var n,o,r,s,a;return Ga.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=tc(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=9;break}return r=Ir(o.value,2),s=r[0],a=r[1],t.next=7,[s,e(a,s)];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}},t,null,[[1,11,14,17]])})))}},{key:"max",value:function(t){var e=Nn(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=Ir(i.value,2),s=r[1],a=t(s,r[0]);a>o&&(o=a,n=s)}return n}},{key:"min",value:function(t){var e=Nn(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=Ir(i.value,2),s=r[1],a=t(s,r[0]);a<o&&(o=a,n=s)}return n}},{key:"reduce",value:function(t,e){var i,n=tc(this._pairs);try{for(n.s();!(i=n.n()).done;){var o=Ir(i.value,2);e=t(e,o[1],o[0])}}catch(r){n.e(r)}finally{n.f()}return e}},{key:"sort",value:function(e){var i=this;return new t(ao({},Za,function(){var t;return Nn(sl(t=Br(i._pairs)).call(t,function(t,i){var n=Ir(t,2),o=n[0],r=n[1],s=Ir(i,2);return e(r,s[1],o,s[0])}))}))}}]),t}();function nc(t,e){var i=Mr(t);if(tn){var n=tn(t);e&&(n=Ut(n).call(n,function(e){return Le(t,e).enumerable})),i.push.apply(i,n)}return i}function oc(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)rr(i=nc(Object(n),!0)).call(i,function(e){ao(t,e,n[e])});else if(Ne)Ae(t,Ne(n));else{var o;rr(o=nc(Object(n))).call(o,function(e){me(t,e,Le(n,e))})}}return t}function rc(t,e){var i;if(void 0===Wr||null==Rn(t)){if(Dr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return sc(t,e);var n=Lr(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sc(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function sc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var ac=function(t){Ll(o,t);var e,i,n=(e=o,i=function(){if("undefined"==typeof Reflect||!Wa)return!1;if(Wa.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Wa(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=Hl(e);if(i){var o=Hl(this).constructor;t=Wa(n,arguments,o)}else t=n.apply(this,arguments);return jl(this,t)});function o(t,e){var i;return ce(this,o),(i=n.call(this))._queue=null,t&&!Dr(t)&&(e=t,t=[]),i._options=e||{},i._data=new Dl,i.length=0,i._idProp=i._options.fieldId||"id",t&&t.length&&i.add(t),i.setOptions(e),i}return fe(o,[{key:"setOptions",value:function(t){t&&void 0!==t.queue&&(!1===t.queue?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=Kl.extend(this,{replace:["add","update","remove"]})),t.queue&&"object"===zr(t.queue)&&this._queue.setOptions(t.queue)))}},{key:"add",value:function(t,e){var i,n,o,r=this,s=[];if(Dr(t)){var a=Bt(t).call(t,function(t){return t[r._idProp]});if((n=a,o=n.some,n===gl||n instanceof Array&&o===gl.some?pl:o).call(a,function(t){return r._data.has(t)}))throw new Error("A duplicate id was found in the parameter array.");for(var l=0,c=t.length;l<c;l++)i=this._addItem(t[l]),s.push(i)}else{if(!t||"object"!==zr(t))throw new Error("Unknown dataType");i=this._addItem(t),s.push(i)}return s.length&&this._trigger("add",{items:s},e),s}},{key:"update",value:function(t,e){var i=this,n=[],o=[],r=[],s=[],a=this._idProp,l=function(t){var e=t[a];if(null!=e&&i._data.has(e)){var l=t,c=Lo({},i._data.get(e)),h=i._updateItem(l);o.push(h),s.push(l),r.push(c)}else{var d=i._addItem(t);n.push(d)}};if(Dr(t))for(var c=0,h=t.length;c<h;c++)t[c]&&"object"===zr(t[c])?l(t[c]):console.warn("Ignoring input item, which is not an object at index "+c);else{if(!t||"object"!==zr(t))throw new Error("Unknown dataType");l(t)}return n.length&&this._trigger("add",{items:n},e),o.length&&this._trigger("update",{items:o,oldData:r,data:s},e),Hr(n).call(n,o)}},{key:"updateOnly",value:function(t,e){var i,n=this;Dr(t)||(t=[t]);var o=Bt(i=Bt(t).call(t,function(t){var e=n._data.get(t[n._idProp]);if(null==e)throw new Error("Updating non-existent items is not allowed.");return{oldData:e,update:t}})).call(i,function(t){var e=t.oldData,i=e[n._idProp],o=function(t){for(var e,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Da.apply(void 0,Hr(e=[{},t]).call(e,n))}(e,t.update);return n._data.set(i,o),{id:i,oldData:e,updatedData:o}});if(o.length){var r={items:Bt(o).call(o,function(t){return t.id}),oldData:Bt(o).call(o,function(t){return t.oldData}),data:Bt(o).call(o,function(t){return t.updatedData})};return this._trigger("update",r,e),r.items}return[]}},{key:"get",value:function(t,e){var i=void 0,n=void 0,o=void 0;Xl(t)?(i=t,o=e):Dr(t)?(n=t,o=e):o=t;var r,s=o&&"Object"===o.returnType?"Object":"Array",a=o&&Ut(o),l=[],c=void 0,h=void 0;if(null!=i)(c=this._data.get(i))&&a&&!a(c)&&(c=void 0);else if(null!=n)for(var d=0,u=n.length;d<u;d++)null==(c=this._data.get(n[d]))||a&&!a(c)||l.push(c);else for(var f,p=0,g=(h=Br(hl(f=this._data).call(f))).length;p<g;p++)null==(c=this._data.get(h[p]))||a&&!a(c)||l.push(c);if(o&&o.order&&null==i&&this._sort(l,o.order),o&&o.fields){var m=o.fields;if(null!=i&&null!=c)c=this._filterFields(c,m);else for(var v=0,y=l.length;v<y;v++)l[v]=this._filterFields(l[v],m)}if("Object"==s){for(var b={},w=0,k=l.length;w<k;w++){var _=l[w];b[_[this._idProp]]=_}return b}return null!=i?null!==(r=c)&&void 0!==r?r:null:l}},{key:"getIds",value:function(t){var e=this._data,i=t&&Ut(t),n=t&&t.order,o=Br(hl(e).call(e)),r=[];if(i)if(n){for(var s=[],a=0,l=o.length;a<l;a++){var c=this._data.get(o[a]);null!=c&&i(c)&&s.push(c)}this._sort(s,n);for(var h=0,d=s.length;h<d;h++)r.push(s[h][this._idProp])}else for(var u=0,f=o.length;u<f;u++){var p=this._data.get(o[u]);null!=p&&i(p)&&r.push(p[this._idProp])}else if(n){for(var g=[],m=0,v=o.length;m<v;m++)g.push(e.get(o[m]));this._sort(g,n);for(var y=0,b=g.length;y<b;y++)r.push(g[y][this._idProp])}else for(var w=0,k=o.length;w<k;w++){var _=e.get(o[w]);null!=_&&r.push(_[this._idProp])}return r}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(t,e){var i=e&&Ut(e),n=this._data,o=Br(hl(n).call(n));if(e&&e.order)for(var r=this.get(e),s=0,a=r.length;s<a;s++){var l=r[s];t(l,l[this._idProp])}else for(var c=0,h=o.length;c<h;c++){var d=o[c],u=this._data.get(d);null==u||i&&!i(u)||t(u,d)}}},{key:"map",value:function(t,e){for(var i=e&&Ut(e),n=[],o=this._data,r=Br(hl(o).call(o)),s=0,a=r.length;s<a;s++){var l=r[s],c=this._data.get(l);null==c||i&&!i(c)||n.push(t(c,l))}return e&&e.order&&this._sort(n,e.order),n}},{key:"_filterFields",value:function(t,e){var i;return t?ee(i=Dr(e)?e:Mr(e)).call(i,function(e,i){return e[i]=t[i],e},{}):t}},{key:"_sort",value:function(t,e){if("string"==typeof e){var i=e;sl(t).call(t,function(t,e){var n=t[i],o=e[i];return n>o?1:n<o?-1:0})}else{if("function"!=typeof e)throw new TypeError("Order must be a function or a string");sl(t).call(t,e)}}},{key:"remove",value:function(t,e){for(var i=[],n=[],o=Dr(t)?t:[t],r=0,s=o.length;r<s;r++){var a=this._remove(o[r]);if(a){var l=a[this._idProp];null!=l&&(i.push(l),n.push(a))}}return i.length&&this._trigger("remove",{items:i,oldData:n},e),i}},{key:"_remove",value:function(t){var e;if(Xl(t)?e=t:t&&"object"===zr(t)&&(e=t[this._idProp]),null!=e&&this._data.has(e)){var i=this._data.get(e)||null;return this._data.delete(e),--this.length,i}return null}},{key:"clear",value:function(t){for(var e,i=Br(hl(e=this._data).call(e)),n=[],o=0,r=i.length;o<r;o++)n.push(this._data.get(i[o]));return this._data.clear(),this.length=0,this._trigger("remove",{items:i,oldData:n},t),i}},{key:"max",value:function(t){var e,i,n=null,o=null,r=rc(Qa(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a>o)&&(n=s,o=a)}}catch(l){r.e(l)}finally{r.f()}return n||null}},{key:"min",value:function(t){var e,i,n=null,o=null,r=rc(Qa(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a<o)&&(n=s,o=a)}}catch(l){r.e(l)}finally{r.f()}return n||null}},{key:"distinct",value:function(t){for(var e=this._data,i=Br(hl(e).call(e)),n=[],o=0,r=0,s=i.length;r<s;r++){for(var a=e.get(i[r])[t],l=!1,c=0;c<o;c++)if(n[c]==a){l=!0;break}l||void 0===a||(n[o]=a,o++)}return n}},{key:"_addItem",value:function(t){var e=function(t,e){return null==t[e]&&(t[e]=$l()),t}(t,this._idProp),i=e[this._idProp];if(this._data.has(i))throw new Error("Cannot add item: item with id "+i+" already exists");return this._data.set(i,e),++this.length,i}},{key:"_updateItem",value:function(t){var e=t[this._idProp];if(null==e)throw new Error("Cannot update item: item has no id (item: "+function(t,e,i){return N.JSON.stringify.apply(null,arguments)}(t)+")");var i=this._data.get(e);if(!i)throw new Error("Cannot update item: no item with id "+e+" found");return this._data.set(e,oc(oc({},i),t)),e}},{key:"stream",value:function(t){if(t){var e=this._data;return new ic(ao({},Za,Ga.mark(function i(){var n,o,r,s;return Ga.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n=rc(t),i.prev=1,n.s();case 3:if((o=n.n()).done){i.next=11;break}if(null==(s=e.get(r=o.value))){i.next=9;break}return i.next=9,[r,s];case 9:i.next=3;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(1),n.e(i.t0);case 16:return i.prev=16,n.f(),i.finish(16);case 19:case"end":return i.stop()}},i,null,[[1,13,16,19]])})))}var i,n,o;return new ic(ao({},Za,le((n=this._data,o=n.entries,i=n===Ua||n instanceof Array&&o===Ua.entries||Ya.hasOwnProperty(ri(n))?qa:o)).call(i,this._data)))}},{key:"idProp",get:function(){return this._idProp}}]),o}(Ql);function lc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var cc=function(t){Ll(o,t);var e,i,n=(e=o,i=function(){if("undefined"==typeof Reflect||!Wa)return!1;if(Wa.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Wa(Date,[],function(){})),!0}catch(t){return!1}}(),function(){var t,n=Hl(e);if(i){var o=Hl(this).constructor;t=Wa(n,arguments,o)}else t=n.apply(this,arguments);return jl(this,t)});function o(t,e){var i,r;return ce(this,o),(r=n.call(this)).length=0,r._ids=new Jl,r._options=e||{},r._listener=le(i=r._onEvent).call(i,Bl(r)),r.setData(t),r}return fe(o,[{key:"setData",value:function(t){if(this._data){this._data.off&&this._data.off("*",this._listener);var e=this._data.getIds({filter:Ut(this._options)}),i=this._data.get(e);this._ids.clear(),this.length=0,this._trigger("remove",{items:e,oldData:i})}if(null!=t){this._data=t;for(var n=this._data.getIds({filter:Ut(this._options)}),o=0,r=n.length;o<r;o++)this._ids.add(n[o]);this.length=n.length,this._trigger("add",{items:n})}else this._data=new ac;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var t=this._data.getIds({filter:Ut(this._options)}),e=Br(this._ids),i={},n=[],o=[],r=[],s=0,a=t.length;s<a;s++){var l=t[s];i[l]=!0,this._ids.has(l)||(n.push(l),this._ids.add(l))}for(var c=0,h=e.length;c<h;c++){var d=e[c],u=this._data.get(d);null==u?console.error("If you see this, report it please."):i[d]||(o.push(d),r.push(u),this._ids.delete(d))}this.length+=n.length-o.length,n.length&&this._trigger("add",{items:n}),o.length&&this._trigger("remove",{items:o,oldData:r})}},{key:"get",value:function(t,e){if(null==this._data)return null;var i,n=null;Xl(t)||Dr(t)?(n=t,i=e):i=t;var o=Lo({},this._options,i),r=Ut(this._options),s=i&&Ut(i);return r&&s&&(o.filter=function(t){return r(t)&&s(t)}),null==n?this._data.get(o):this._data.get(n,o)}},{key:"getIds",value:function(t){if(this._data.length){var e=Ut(this._options),i=null!=t?Ut(t):null;return this._data.getIds({filter:i?e?function(t){return e(t)&&i(t)}:i:e,order:t&&t.order})}return[]}},{key:"forEach",value:function(t,e){if(this._data){var i,n,o=Ut(this._options),r=e&&Ut(e);n=r?o?function(t){return o(t)&&r(t)}:r:o,rr(i=this._data).call(i,t,{filter:n,order:e&&e.order})}}},{key:"map",value:function(t,e){if(this._data){var i,n,o=Ut(this._options),r=e&&Ut(e);return n=r?o?function(t){return o(t)&&r(t)}:r:o,Bt(i=this._data).call(i,t,{filter:n,order:e&&e.order})}return[]}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(t){var e;return this._data.stream(t||ao({},Za,le(e=hl(this._ids)).call(e,this._ids)))}},{key:"dispose",value:function(){var t;null!==(t=this._data)&&void 0!==t&&t.off&&this._data.off("*",this._listener);var e,i="This data view has already been disposed of.",n={get:function(){throw new Error(i)},set:function(){throw new Error(i)},configurable:!1},r=function(t,e){var i;if(void 0===Wr||null==Rn(t)){if(Dr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return lc(t,e);var n=Lr(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lc(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(Fr(o.prototype));try{for(r.s();!(e=r.n()).done;)me(this,e.value,n)}catch(s){r.e(s)}finally{r.f()}}},{key:"_onEvent",value:function(t,e,i){if(e&&e.items&&this._data){var n=e.items,o=[],r=[],s=[],a=[],l=[],c=[];switch(t){case"add":for(var h=0,d=n.length;h<d;h++){var u=n[h];this.get(u)&&(this._ids.add(u),o.push(u))}break;case"update":for(var f=0,p=n.length;f<p;f++){var g=n[f];this.get(g)?this._ids.has(g)?(r.push(g),l.push(e.data[f]),a.push(e.oldData[f])):(this._ids.add(g),o.push(g)):this._ids.has(g)&&(this._ids.delete(g),s.push(g),c.push(e.oldData[f]))}break;case"remove":for(var m=0,v=n.length;m<v;m++){var y=n[m];this._ids.has(y)&&(this._ids.delete(y),s.push(y),c.push(e.oldData[m]))}}this.length+=o.length-s.length,o.length&&this._trigger("add",{items:o},i),r.length&&this._trigger("update",{items:r,oldData:a,data:l},i),s.length&&this._trigger("remove",{items:s,oldData:c},i)}}},{key:"idProp",get:function(){return this.getDataSet().idProp}}]),o}(Ql);function hc(t,e){return"object"===zr(e)&&null!==e&&t===e.idProp&&"function"==typeof e.add&&"function"==typeof e.clear&&"function"==typeof e.distinct&&"function"==typeof rr(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Bt(e)&&"function"==typeof e.max&&"function"==typeof e.min&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.remove&&"function"==typeof e.setOptions&&"function"==typeof e.stream&&"function"==typeof e.update&&"function"==typeof e.updateOnly}t.DELETE=Ma,t.DataSet=ac,t.DataStream=ic,t.DataView=cc,t.Queue=Kl,t.createNewDataPipeFrom=function(t){return new ge(t)},t.isDataSetLike=hc,t.isDataViewLike=function(t,e){return"object"===zr(e)&&null!==e&&t===e.idProp&&"function"==typeof rr(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Bt(e)&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.stream&&hc(t,e.getDataSet())},Object.defineProperty(t,"__esModule",{value:!0})}(e)},8012:function(t,e){!function(t){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){var e={exports:{}};return t(e,e.exports),e.exports}var n=function(t){return t&&t.Math==Math&&t},o=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||function(){return this}()||Function("return this")(),r=function(t){try{return!!t()}catch(t){return!0}},s=!r(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),a={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c={f:l&&!a.call({1:2},1)?function(t){var e=l(this,t);return!!e&&e.enumerable}:a},h=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},d={}.toString,u=function(t){return d.call(t).slice(8,-1)},f="".split,p=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==u(t)?f.call(t,""):Object(t)}:Object,g=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},m=function(t){return p(g(t))},v=function(t){return"object"==typeof t?null!==t:"function"==typeof t},y=function(t,e){if(!v(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!v(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!v(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!v(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},b={}.hasOwnProperty,w=function(t,e){return b.call(t,e)},k=o.document,_=v(k)&&v(k.createElement),x=function(t){return _?k.createElement(t):{}},C=!s&&!r(function(){return 7!=Object.defineProperty(x("div"),"a",{get:function(){return 7}}).a}),E=Object.getOwnPropertyDescriptor,T={f:s?E:function(t,e){if(t=m(t),e=y(e,!0),C)try{return E(t,e)}catch(t){}if(w(t,e))return h(!c.f.call(t,e),t[e])}},S=/#|\.prototype\./,A=function(t,e){var i=I[O(t)];return i==M||i!=P&&("function"==typeof e?r(e):!!e)},O=A.normalize=function(t){return String(t).replace(S,".").toLowerCase()},I=A.data={},P=A.NATIVE="N",M=A.POLYFILL="P",D=A,N={},R=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},z=function(t,e,i){if(R(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}},F=function(t){if(!v(t))throw TypeError(String(t)+" is not an object");return t},L=Object.defineProperty,B={f:s?L:function(t,e,i){if(F(t),e=y(e,!0),F(i),C)try{return L(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},j=s?function(t,e,i){return B.f(t,e,h(1,i))}:function(t,e,i){return t[e]=i,t},V=T.f,H=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},W=function(t,e){var i,n,r,s,a,l,c,h,d=t.target,u=t.global,f=t.stat,p=t.proto,g=u?o:f?o[d]:(o[d]||{}).prototype,m=u?N:N[d]||(N[d]={}),v=m.prototype;for(r in e)i=!D(u?r:d+(f?".":"#")+r,t.forced)&&g&&w(g,r),a=m[r],i&&(l=t.noTargetGet?(h=V(g,r))&&h.value:g[r]),s=i&&l?l:e[r],i&&typeof a==typeof s||(c=t.bind&&i?z(s,o):t.wrap&&i?H(s):p&&"function"==typeof s?z(Function.call,s):s,(t.sham||s&&s.sham||a&&a.sham)&&j(c,"sham",!0),m[r]=c,p&&(w(N,n=d+"Prototype")||j(N,n,{}),N[n][r]=s,t.real&&v&&!v[r]&&j(v,r,s)))},q=Array.isArray||function(t){return"Array"==u(t)},U=Math.ceil,Y=Math.floor,G=function(t){return isNaN(t=+t)?0:(t>0?Y:U)(t)},Z=Math.min,$=function(t){return t>0?Z(G(t),9007199254740991):0},X=function(t,e,i,n,o,r,s,a){for(var l,c=o,h=0,d=!!s&&z(s,a,3);h<n;){if(h in i){if(l=d?d(i[h],h,e):i[h],r>0&&q(l))c=X(t,e,l,$(l.length),c,r-1)-1;else{if(c>=9007199254740991)throw TypeError("Exceed the acceptable array length");t[c]=l}c++}h++}return c},K=X,Q=function(t){return Object(g(t))},J="__core-js_shared__",tt=o[J]||function(t,e){try{j(o,t,e)}catch(i){o[t]=e}return e}(J,{}),et=i(function(t){(t.exports=function(t,e){return tt[t]||(tt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.7.0",mode:"pure",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})}),it=0,nt=Math.random(),ot=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++it+nt).toString(36)},rt=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())}),st=rt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,at=et("wks"),lt=o.Symbol,ct=st?lt:lt&&lt.withoutSetter||ot,ht=function(t){return w(at,t)||(at[t]=rt&&w(lt,t)?lt[t]:ct("Symbol."+t)),at[t]},dt=ht("species"),ut=function(t,e){var i;return q(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!q(i.prototype)?v(i)&&null===(i=i[dt])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)};W({target:"Array",proto:!0},{flatMap:function(t){var e,i=Q(this),n=$(i.length);return R(t),(e=ut(i,0)).length=K(e,i,i,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var ft,pt,gt=function(t){return N[t+"Prototype"]},mt=gt("Array").flatMap,vt=Array.prototype,yt=[].push,bt=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,r=6==t,s=5==t||r;return function(a,l,c,h){for(var d,u,f=Q(a),g=p(f),m=z(l,c,3),v=$(g.length),y=0,b=h||ut,w=e?b(a,v):i?b(a,0):void 0;v>y;y++)if((s||y in g)&&(u=m(d=g[y],y,f),t))if(e)w[y]=u;else if(u)switch(t){case 3:return!0;case 5:return d;case 6:return y;case 2:yt.call(w,d)}else if(o)return!1;return r?-1:n||o?o:w}},wt={forEach:bt(0),map:bt(1),filter:bt(2),some:bt(3),every:bt(4),find:bt(5),findIndex:bt(6)},kt=function(t){return"function"==typeof t?t:void 0},_t=function(t,e){return arguments.length<2?kt(N[t])||kt(o[t]):N[t]&&N[t][e]||o[t]&&o[t][e]},xt=_t("navigator","userAgent")||"",Ct=o.process,Et=Ct&&Ct.versions,Tt=Et&&Et.v8;Tt?pt=(ft=Tt.split("."))[0]+ft[1]:xt&&(!(ft=xt.match(/Edge\/(\d+)/))||ft[1]>=74)&&(ft=xt.match(/Chrome\/(\d+)/))&&(pt=ft[1]);var St=pt&&+pt,At=ht("species"),Ot=function(t){return St>=51||!r(function(){var e=[];return(e.constructor={})[At]=function(){return{foo:1}},1!==e[t](Boolean).foo})},It=Object.defineProperty,Pt={},Mt=function(t){throw t},Dt=function(t,e){if(w(Pt,t))return Pt[t];e||(e={});var i=[][t],n=!!w(e,"ACCESSORS")&&e.ACCESSORS,o=w(e,0)?e[0]:Mt,a=w(e,1)?e[1]:void 0;return Pt[t]=!!i&&!r(function(){if(n&&!s)return!0;var t={length:-1};n?It(t,1,{enumerable:!0,get:Mt}):t[1]=1,i.call(t,o,a)})},Nt=wt.map,Rt=Ot("map"),zt=Dt("map");W({target:"Array",proto:!0,forced:!Rt||!zt},{map:function(t){return Nt(this,t,arguments.length>1?arguments[1]:void 0)}});var Ft=gt("Array").map,Lt=Array.prototype,Bt=function(t){var e=t.map;return t===Lt||t instanceof Array&&e===Lt.map?Ft:e},jt=wt.filter,Vt=Ot("filter"),Ht=Dt("filter");W({target:"Array",proto:!0,forced:!Vt||!Ht},{filter:function(t){return jt(this,t,arguments.length>1?arguments[1]:void 0)}});var Wt=gt("Array").filter,qt=Array.prototype,Ut=function(t){var e=t.filter;return t===qt||t instanceof Array&&e===qt.filter?Wt:e},Yt=function(t){return function(e,i,n,o){R(i);var r=Q(e),s=p(r),a=$(r.length),l=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=c;break}if(l+=c,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=c)l in s&&(o=i(o,s[l],l,r));return o}},Gt={left:Yt(!1),right:Yt(!0)},Zt=function(t,e){var i=[][t];return!!i&&r(function(){i.call(null,e||function(){throw 1},1)})},$t="process"==u(o.process),Xt=Gt.left,Kt=Zt("reduce"),Qt=Dt("reduce",{1:0});W({target:"Array",proto:!0,forced:!Kt||!Qt||!$t&&St>79&&St<83},{reduce:function(t){return Xt(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Jt=gt("Array").reduce,te=Array.prototype,ee=function(t){var e=t.reduce;return t===te||t instanceof Array&&e===te.reduce?Jt:e},ie=[].slice,ne={},oe=function(t,e,i){if(!(e in ne)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";ne[e]=Function("C,a","return new C("+n.join(",")+")")}return ne[e](t,i)},re=Function.bind||function(t){var e=R(this),i=ie.call(arguments,1),n=function(){var o=i.concat(ie.call(arguments));return this instanceof n?oe(e,o.length,o):e.apply(t,o)};return v(e.prototype)&&(n.prototype=e.prototype),n};W({target:"Function",proto:!0},{bind:re});var se=gt("Function").bind,ae=Function.prototype,le=function(t){var e=t.bind;return t===ae||t instanceof Function&&e===ae.bind?se:e},ce=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};W({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperty:B.f});var he=i(function(t){var e=N.Object,i=t.exports=function(t,i,n){return e.defineProperty(t,i,n)};e.defineProperty.sham&&(i.sham=!0)}),de=he;function ue(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),de(t,n.key,n)}}var fe=function(t,e,i){return e&&ue(t.prototype,e),i&&ue(t,i),t},pe=function(){function t(e,i,n){var o,r,s;ce(this,t),this._source=e,this._transformers=i,this._target=n,this._listeners={add:le(o=this._add).call(o,this),remove:le(r=this._remove).call(r,this),update:le(s=this._update).call(s,this)}}return fe(t,[{key:"all",value:function(){return this._target.update(this._transformItems(this._source.get())),this}},{key:"start",value:function(){return this._source.on("add",this._listeners.add),this._source.on("remove",this._listeners.remove),this._source.on("update",this._listeners.update),this}},{key:"stop",value:function(){return this._source.off("add",this._listeners.add),this._source.off("remove",this._listeners.remove),this._source.off("update",this._listeners.update),this}},{key:"_transformItems",value:function(t){var e;return ee(e=this._transformers).call(e,function(t,e){return e(t)},t)}},{key:"_add",value:function(t,e){null!=e&&this._target.add(this._transformItems(this._source.get(e.items)))}},{key:"_update",value:function(t,e){null!=e&&this._target.update(this._transformItems(this._source.get(e.items)))}},{key:"_remove",value:function(t,e){null!=e&&this._target.remove(this._transformItems(e.oldData))}}]),t}(),ge=function(){function t(e){ce(this,t),this._source=e,this._transformers=[]}return fe(t,[{key:"filter",value:function(t){return this._transformers.push(function(e){return Ut(e).call(e,t)}),this}},{key:"map",value:function(t){return this._transformers.push(function(e){return Bt(e).call(e,t)}),this}},{key:"flatMap",value:function(t){return this._transformers.push(function(e){return function(t){var e=t.flatMap;return t===vt||t instanceof Array&&e===vt.flatMap?mt:e}(e).call(e,t)}),this}},{key:"to",value:function(t){return new pe(this._source,this._transformers,t)}}]),t}(),me=he,ve=Math.max,ye=Math.min,be=function(t,e){var i=G(t);return i<0?ve(i+e,0):ye(i,e)},we=function(t){return function(e,i,n){var o,r=m(e),s=$(r.length),a=be(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},ke={includes:we(!0),indexOf:we(!1)},_e={},xe=ke.indexOf,Ce=function(t,e){var i,n=m(t),o=0,r=[];for(i in n)!w(_e,i)&&w(n,i)&&r.push(i);for(;e.length>o;)w(n,i=e[o++])&&(~xe(r,i)||r.push(i));return r},Ee=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Te=Object.keys||function(t){return Ce(t,Ee)},Se=s?Object.defineProperties:function(t,e){F(t);for(var i,n=Te(e),o=n.length,r=0;o>r;)B.f(t,i=n[r++],e[i]);return t};W({target:"Object",stat:!0,forced:!s,sham:!s},{defineProperties:Se});var Ae=i(function(t){var e=N.Object,i=t.exports=function(t,i){return e.defineProperties(t,i)};e.defineProperties.sham&&(i.sham=!0)}),Oe=Ee.concat("length","prototype"),Ie={f:Object.getOwnPropertyNames||function(t){return Ce(t,Oe)}},Pe={f:Object.getOwnPropertySymbols},Me=_t("Reflect","ownKeys")||function(t){var e=Ie.f(F(t)),i=Pe.f;return i?e.concat(i(t)):e},De=function(t,e,i){var n=y(e);n in t?B.f(t,n,h(0,i)):t[n]=i};W({target:"Object",stat:!0,sham:!s},{getOwnPropertyDescriptors:function(t){for(var e,i,n=m(t),o=T.f,r=Me(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&De(s,e,i);return s}});var Ne=N.Object.getOwnPropertyDescriptors,Re=T.f,ze=r(function(){Re(1)});W({target:"Object",stat:!0,forced:!s||ze,sham:!s},{getOwnPropertyDescriptor:function(t,e){return Re(m(t),e)}});var Fe,Le=i(function(t){var e=N.Object,i=t.exports=function(t,i){return e.getOwnPropertyDescriptor(t,i)};e.getOwnPropertyDescriptor.sham&&(i.sham=!0)}),Be=_t("document","documentElement"),je=et("keys"),Ve=function(t){return je[t]||(je[t]=ot(t))},He=Ve("IE_PROTO"),We=function(){},qe=function(t){return"<script>"+t+"<\/script>"},Ue=function(){try{Fe=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;Ue=Fe?function(t){t.write(qe("")),t.close();var e=t.parentWindow.Object;return t=null,e}(Fe):((e=x("iframe")).style.display="none",Be.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(qe("document.F=Object")),t.close(),t.F);for(var i=Ee.length;i--;)delete Ue.prototype[Ee[i]];return Ue()};_e[He]=!0;var Ye=Object.create||function(t,e){var i;return null!==t?(We.prototype=F(t),i=new We,We.prototype=null,i[He]=t):i=Ue(),void 0===e?i:Se(i,e)},Ge=Ie.f,Ze={}.toString,$e="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Xe={f:function(t){return $e&&"[object Window]"==Ze.call(t)?function(t){try{return Ge(t)}catch(t){return $e.slice()}}(t):Ge(m(t))}},Ke=function(t,e,i,n){n&&n.enumerable?t[e]=i:j(t,e,i)},Qe={f:ht},Je=B.f,ti=function(t){var e=N.Symbol||(N.Symbol={});w(e,t)||Je(e,t,{value:Qe.f(t)})},ei={};ei[ht("toStringTag")]="z";var ii="[object z]"===String(ei),ni=ht("toStringTag"),oi="Arguments"==u(function(){return arguments}()),ri=ii?u:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),ni))?i:oi?u(e):"Object"==(n=u(e))&&"function"==typeof e.callee?"Arguments":n},si=ii?{}.toString:function(){return"[object "+ri(this)+"]"},ai=B.f,li=ht("toStringTag"),ci=function(t,e,i,n){if(t){var o=i?t:t.prototype;w(o,li)||ai(o,li,{configurable:!0,value:e}),n&&!ii&&j(o,"toString",si)}},hi=Function.toString;"function"!=typeof tt.inspectSource&&(tt.inspectSource=function(t){return hi.call(t)});var di,ui,fi,pi=o.WeakMap;if("function"==typeof pi&&/native code/.test((0,tt.inspectSource)(pi))){var gi=tt.state||(tt.state=new(0,o.WeakMap)),mi=gi.get,vi=gi.has,yi=gi.set;di=function(t,e){return e.facade=t,yi.call(gi,t,e),e},ui=function(t){return mi.call(gi,t)||{}},fi=function(t){return vi.call(gi,t)}}else{var bi=Ve("state");_e[bi]=!0,di=function(t,e){return e.facade=t,j(t,bi,e),e},ui=function(t){return w(t,bi)?t[bi]:{}},fi=function(t){return w(t,bi)}}var wi={set:di,get:ui,has:fi,enforce:function(t){return fi(t)?ui(t):di(t,{})},getterFor:function(t){return function(e){var i;if(!v(e)||(i=ui(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},ki=wt.forEach,_i=Ve("hidden"),xi="Symbol",Ci=ht("toPrimitive"),Ei=wi.set,Ti=wi.getterFor(xi),Si=Object.prototype,Ai=o.Symbol,Oi=_t("JSON","stringify"),Ii=T.f,Pi=B.f,Mi=Xe.f,Di=c.f,Ni=et("symbols"),Ri=et("op-symbols"),zi=et("string-to-symbol-registry"),Fi=et("symbol-to-string-registry"),Li=et("wks"),Bi=o.QObject,ji=!Bi||!Bi.prototype||!Bi.prototype.findChild,Vi=s&&r(function(){return 7!=Ye(Pi({},"a",{get:function(){return Pi(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=Ii(Si,e);n&&delete Si[e],Pi(t,e,i),n&&t!==Si&&Pi(Si,e,n)}:Pi,Hi=function(t,e){var i=Ni[t]=Ye(Ai.prototype);return Ei(i,{type:xi,tag:t,description:e}),s||(i.description=e),i},Wi=st?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Ai},qi=function(t,e,i){t===Si&&qi(Ri,e,i),F(t);var n=y(e,!0);return F(i),w(Ni,n)?(i.enumerable?(w(t,_i)&&t[_i][n]&&(t[_i][n]=!1),i=Ye(i,{enumerable:h(0,!1)})):(w(t,_i)||Pi(t,_i,h(1,{})),t[_i][n]=!0),Vi(t,n,i)):Pi(t,n,i)},Ui=function(t,e){F(t);var i=m(e),n=Te(i).concat($i(i));return ki(n,function(e){s&&!Yi.call(i,e)||qi(t,e,i[e])}),t},Yi=function(t){var e=y(t,!0),i=Di.call(this,e);return!(this===Si&&w(Ni,e)&&!w(Ri,e))&&(!(i||!w(this,e)||!w(Ni,e)||w(this,_i)&&this[_i][e])||i)},Gi=function(t,e){var i=m(t),n=y(e,!0);if(i!==Si||!w(Ni,n)||w(Ri,n)){var o=Ii(i,n);return!o||!w(Ni,n)||w(i,_i)&&i[_i][n]||(o.enumerable=!0),o}},Zi=function(t){var e=Mi(m(t)),i=[];return ki(e,function(t){w(Ni,t)||w(_e,t)||i.push(t)}),i},$i=function(t){var e=t===Si,i=Mi(e?Ri:m(t)),n=[];return ki(i,function(t){!w(Ni,t)||e&&!w(Si,t)||n.push(Ni[t])}),n};if(rt||(Ke((Ai=function(){if(this instanceof Ai)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=ot(t),i=function(t){this===Si&&i.call(Ri,t),w(this,_i)&&w(this[_i],e)&&(this[_i][e]=!1),Vi(this,e,h(1,t))};return s&&ji&&Vi(Si,e,{configurable:!0,set:i}),Hi(e,t)}).prototype,"toString",function(){return Ti(this).tag}),Ke(Ai,"withoutSetter",function(t){return Hi(ot(t),t)}),c.f=Yi,B.f=qi,T.f=Gi,Ie.f=Xe.f=Zi,Pe.f=$i,Qe.f=function(t){return Hi(ht(t),t)},s&&Pi(Ai.prototype,"description",{configurable:!0,get:function(){return Ti(this).description}})),W({global:!0,wrap:!0,forced:!rt,sham:!rt},{Symbol:Ai}),ki(Te(Li),function(t){ti(t)}),W({target:xi,stat:!0,forced:!rt},{for:function(t){var e=String(t);if(w(zi,e))return zi[e];var i=Ai(e);return zi[e]=i,Fi[i]=e,i},keyFor:function(t){if(!Wi(t))throw TypeError(t+" is not a symbol");if(w(Fi,t))return Fi[t]},useSetter:function(){ji=!0},useSimple:function(){ji=!1}}),W({target:"Object",stat:!0,forced:!rt,sham:!s},{create:function(t,e){return void 0===e?Ye(t):Ui(Ye(t),e)},defineProperty:qi,defineProperties:Ui,getOwnPropertyDescriptor:Gi}),W({target:"Object",stat:!0,forced:!rt},{getOwnPropertyNames:Zi,getOwnPropertySymbols:$i}),W({target:"Object",stat:!0,forced:r(function(){Pe.f(1)})},{getOwnPropertySymbols:function(t){return Pe.f(Q(t))}}),Oi){var Xi=!rt||r(function(){var t=Ai();return"[null]"!=Oi([t])||"{}"!=Oi({a:t})||"{}"!=Oi(Object(t))});W({target:"JSON",stat:!0,forced:Xi},{stringify:function(t,e,i){for(var n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e,(v(e)||void 0!==t)&&!Wi(t))return q(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Wi(e))return e}),o[1]=e,Oi.apply(null,o)}})}Ai.prototype[Ci]||j(Ai.prototype,Ci,Ai.prototype.valueOf),ci(Ai,xi),_e[_i]=!0;var Ki,Qi,Ji,tn=N.Object.getOwnPropertySymbols,en={},nn=!r(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),on=Ve("IE_PROTO"),rn=Object.prototype,sn=nn?Object.getPrototypeOf:function(t){return t=Q(t),w(t,on)?t[on]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?rn:null},an=(ht("iterator"),!1);[].keys&&("next"in(Ji=[].keys())?(Qi=sn(sn(Ji)))!==Object.prototype&&(Ki=Qi):an=!0),null==Ki&&(Ki={});var ln={IteratorPrototype:Ki,BUGGY_SAFARI_ITERATORS:an},cn=ln.IteratorPrototype,hn=function(){return this},dn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return F(i),function(t){if(!v(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0),un=ln.IteratorPrototype,fn=ln.BUGGY_SAFARI_ITERATORS,pn=ht("iterator"),gn="keys",mn="values",vn="entries",yn=function(){return this},bn=function(t,e,i,n,o,r,s){!function(t,e,i){var n=e+" Iterator";t.prototype=Ye(cn,{next:h(1,i)}),ci(t,n,!1,!0),en[n]=hn}(i,e,n);var a,l,c,d=function(t){if(t===o&&m)return m;if(!fn&&t in p)return p[t];switch(t){case gn:case mn:case vn:return function(){return new i(this,t)}}return function(){return new i(this)}},u=e+" Iterator",f=!1,p=t.prototype,g=p[pn]||p["@@iterator"]||o&&p[o],m=!fn&&g||d(o),v="Array"==e&&p.entries||g;if(v&&(a=sn(v.call(new t)),un!==Object.prototype&&a.next&&(ci(a,u,!0,!0),en[u]=yn)),o==mn&&g&&g.name!==mn&&(f=!0,m=function(){return g.call(this)}),s&&p[pn]!==m&&j(p,pn,m),en[e]=m,o)if(l={values:d(mn),keys:r?m:d(gn),entries:d(vn)},s)for(c in l)(fn||f||!(c in p))&&Ke(p,c,l[c]);else W({target:e,proto:!0,forced:fn||f},l);return l},wn="Array Iterator",kn=wi.set,_n=wi.getterFor(wn);bn(Array,"Array",function(t,e){kn(this,{type:wn,target:m(t),index:0,kind:e})},function(){var t=_n(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),en.Arguments=en.Array;var xn=ht("toStringTag");for(var Cn in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var En=o[Cn],Tn=En&&En.prototype;Tn&&ri(Tn)!==xn&&j(Tn,xn,Cn),en[Cn]=en.Array}var Sn=function(t){return function(e,i){var n,o,r=String(g(e)),s=G(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):n:t?r.slice(s,s+2):o-56320+(n-55296<<10)+65536}},An=(Sn(!1),Sn(!0)),On="String Iterator",In=wi.set,Pn=wi.getterFor(On);bn(String,"String",function(t){In(this,{type:On,string:String(t),index:0})},function(){var t,e=Pn(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=An(i,n),e.index+=t.length,{value:t,done:!1})});var Mn=ht("iterator"),Dn=function(t){if(null!=t)return t[Mn]||t["@@iterator"]||en[ri(t)]},Nn=function(t){var e=Dn(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return F(e.call(t))},Rn=Dn,zn=function(t){var e=t.return;if(void 0!==e)return F(e.call(t)).value},Fn=function(t,e,i,n){try{return n?e(F(i)[0],i[1]):e(i)}catch(e){throw zn(t),e}},Ln=ht("iterator"),Bn=Array.prototype,jn=function(t){return void 0!==t&&(en.Array===t||Bn[Ln]===t)},Vn=ht("iterator"),Hn=!1;try{var Wn=0,qn={next:function(){return{done:!!Wn++}},return:function(){Hn=!0}};qn[Vn]=function(){return this},Array.from(qn,function(){throw 2})}catch(t){}var Un=!function(t,e){if(!Hn)return!1;var i=!1;try{var n={};n[Vn]=function(){return{next:function(){return{done:i=!0}}}},function(t){Array.from(t)}(n)}catch(t){}return i}();W({target:"Array",stat:!0,forced:Un},{from:function(t){var e,i,n,o,r,s,a=Q(t),l="function"==typeof this?this:Array,c=arguments.length,h=c>1?arguments[1]:void 0,d=void 0!==h,u=Dn(a),f=0;if(d&&(h=z(h,c>2?arguments[2]:void 0,2)),null==u||l==Array&&jn(u))for(i=new l(e=$(a.length));e>f;f++)s=d?h(a[f],f):a[f],De(i,f,s);else for(r=(o=u.call(a)).next,i=new l;!(n=r.call(o)).done;f++)s=d?Fn(o,h,[n.value,f],!0):n.value,De(i,f,s);return i.length=f,i}});var Yn=N.Array.from,Gn=Yn;W({target:"Array",proto:!0},{fill:function(t){for(var e=Q(this),i=$(e.length),n=arguments.length,o=be(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:be(r,i);s>o;)e[o++]=t;return e}}),gt("Array");var Zn=[].slice,$n=/MSIE .\./.test(xt),Xn=function(t){return function(e,i){var n=arguments.length>2,o=n?Zn.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,i)}};W({global:!0,bind:!0,forced:$n},{setTimeout:Xn(o.setTimeout),setInterval:Xn(o.setInterval)});var Kn=N.setTimeout,Qn=_t("JSON","stringify"),Jn=/[\uD800-\uDFFF]/g,to=/^[\uD800-\uDBFF]$/,eo=/^[\uDC00-\uDFFF]$/,io=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return to.test(t)&&!eo.test(o)||eo.test(t)&&!to.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},no=r(function(){return'"\\udf06\\ud834"'!==Qn("\udf06\ud834")||'"\\udead"'!==Qn("\udead")});Qn&&W({target:"JSON",stat:!0,forced:no},{stringify:function(t,e,i){var n=Qn.apply(null,arguments);return"string"==typeof n?n.replace(Jn,io):n}}),N.JSON||(N.JSON={stringify:JSON.stringify}),W({target:"Object",stat:!0,sham:!s},{create:Ye});var oo,ro=N.Object,so=function(t,e){return ro.create(t,e)},ao=so,lo=function(t,e,i){return e in t?de(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t},co="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",ho="["+co+"]",uo=RegExp("^"+ho+ho+"*"),fo=RegExp(ho+ho+"*$"),po=function(t){return function(e){var i=String(g(e));return 1&t&&(i=i.replace(uo,"")),2&t&&(i=i.replace(fo,"")),i}},go={start:po(1),end:po(2),trim:po(3)},mo=go.trim;W({target:"String",proto:!0,forced:(oo="trim",r(function(){return!!co[oo]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[oo]()||co[oo].name!==oo}))},{trim:function(){return mo(this)}}),gt("String");var vo=ke.indexOf,yo=[].indexOf,bo=!!yo&&1/[1].indexOf(1,-0)<0,wo=Zt("indexOf"),ko=Dt("indexOf",{ACCESSORS:!0,1:0});W({target:"Array",proto:!0,forced:bo||!wo||!ko},{indexOf:function(t){return bo?yo.apply(this,arguments)||0:vo(this,t,arguments.length>1?arguments[1]:void 0)}}),gt("Array");var _o=go.trim,xo=o.parseInt,Co=/^[+-]?0[Xx]/,Eo=8!==xo(co+"08")||22!==xo(co+"0x16")?function(t,e){var i=_o(String(t));return xo(i,e>>>0||(Co.test(i)?16:10))}:xo;W({global:!0,forced:parseInt!=Eo},{parseInt:Eo});var To=c.f,So=function(t){return function(e){for(var i,n=m(e),o=Te(n),r=o.length,a=0,l=[];r>a;)i=o[a++],s&&!To.call(n,i)||l.push(t?[i,n[i]]:n[i]);return l}},Ao=(So(!0),So(!1));W({target:"Object",stat:!0},{values:function(t){return Ao(t)}});var Oo=r(function(){sn(1)});W({target:"Object",stat:!0,forced:Oo,sham:!nn},{getPrototypeOf:function(t){return sn(Q(t))}});var Io=N.Object.getPrototypeOf,Po=ke.includes,Mo=Dt("indexOf",{ACCESSORS:!0,1:0});W({target:"Array",proto:!0,forced:!Mo},{includes:function(t){return Po(this,t,arguments.length>1?arguments[1]:void 0)}}),gt("Array");var Do=ht("match"),No=function(t){if(function(t){var e;return v(t)&&(void 0!==(e=t[Do])?!!e:"RegExp"==u(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},Ro=ht("match");W({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[Ro]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~String(g(this)).indexOf(No(t),arguments.length>1?arguments[1]:void 0)}}),gt("String");var zo=Object.assign,Fo=Object.defineProperty,Lo=!zo||r(function(){if(s&&1!==zo({b:1},zo(Fo({},"a",{enumerable:!0,get:function(){Fo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=zo({},t)[i]||Te(zo({},e)).join("")!=n})?function(t,e){for(var i=Q(t),n=arguments.length,o=1,r=Pe.f,a=c.f;n>o;)for(var l,h=p(arguments[o++]),d=r?Te(h).concat(r(h)):Te(h),u=d.length,f=0;u>f;)l=d[f++],s&&!a.call(h,l)||(i[l]=h[l]);return i}:zo;W({target:"Object",stat:!0,forced:Object.assign!==Lo},{assign:Lo});var Bo=N.Object.assign,jo=Ot("splice"),Vo=Dt("splice",{ACCESSORS:!0,0:0,1:2}),Ho=Math.max,Wo=Math.min,qo=9007199254740991,Uo="Maximum allowed length exceeded";W({target:"Array",proto:!0,forced:!jo||!Vo},{splice:function(t,e){var i,n,o,r,s,a,l=Q(this),c=$(l.length),h=be(t,c),d=arguments.length;if(0===d?i=n=0:1===d?(i=0,n=c-h):(i=d-2,n=Wo(Ho(G(e),0),c-h)),c+i-n>qo)throw TypeError(Uo);for(o=ut(l,n),r=0;r<n;r++)(s=h+r)in l&&De(o,r,l[s]);if(o.length=n,i<n){for(r=h;r<c-n;r++)a=r+i,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=c;r>c-n+i;r--)delete l[r-1]}else if(i>n)for(r=c-n;r>h;r--)a=r+i-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<i;r++)l[r+h]=arguments[r+2];return l.length=c-n+i,o}});var Yo=gt("Array").splice,Go=Array.prototype,Zo=function(t){var e=t.splice;return t===Go||t instanceof Array&&e===Go.splice?Yo:e},$o=[].reverse,Xo=[1,2];W({target:"Array",proto:!0,forced:String(Xo)===String(Xo.reverse())},{reverse:function(){return q(this)&&(this.length=this.length),$o.call(this)}});var Ko=gt("Array").reverse,Qo=Array.prototype,Jo=wt.forEach,tr=Zt("forEach"),er=Dt("forEach"),ir=tr&&er?[].forEach:function(t){return Jo(this,t,arguments.length>1?arguments[1]:void 0)};W({target:"Array",proto:!0,forced:[].forEach!=ir},{forEach:ir});var nr=gt("Array").forEach,or=Array.prototype,rr={DOMTokenList:!0,NodeList:!0},sr=function(t){var e=t.forEach;return t===or||t instanceof Array&&e===or.forEach||rr.hasOwnProperty(ri(t))?nr:e};W({target:"Array",stat:!0},{isArray:q});var ar=N.Array.isArray,lr=ar,cr=ht("iterator"),hr=function(t){var e=Object(t);return void 0!==e[cr]||"@@iterator"in e||en.hasOwnProperty(ri(e))},dr=ht("isConcatSpreadable"),ur=9007199254740991,fr="Maximum allowed index exceeded",pr=St>=51||!r(function(){var t=[];return t[dr]=!1,t.concat()[0]!==t}),gr=Ot("concat"),mr=function(t){if(!v(t))return!1;var e=t[dr];return void 0!==e?!!e:q(t)};W({target:"Array",proto:!0,forced:!pr||!gr},{concat:function(t){var e,i,n,o,r,s=Q(this),a=ut(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(mr(r=-1===e?s:arguments[e])){if(l+(o=$(r.length))>ur)throw TypeError(fr);for(i=0;i<o;i++,l++)i in r&&De(a,l,r[i])}else{if(l>=ur)throw TypeError(fr);De(a,l++,r)}return a.length=l,a}}),ti("asyncIterator"),ti("hasInstance"),ti("isConcatSpreadable"),ti("iterator"),ti("match"),ti("matchAll"),ti("replace"),ti("search"),ti("species"),ti("split"),ti("toPrimitive"),ti("toStringTag"),ti("unscopables"),ci(o.JSON,"JSON",!0);var vr=N.Symbol;ti("asyncDispose"),ti("dispose"),ti("observable"),ti("patternMatch"),ti("replaceAll");var yr=vr,br=Yn,wr=Ot("slice"),kr=Dt("slice",{ACCESSORS:!0,0:0,1:2}),_r=ht("species"),xr=[].slice,Cr=Math.max;W({target:"Array",proto:!0,forced:!wr||!kr},{slice:function(t,e){var i,n,o,r=m(this),s=$(r.length),a=be(t,s),l=be(void 0===e?s:e,s);if(q(r)&&("function"!=typeof(i=r.constructor)||i!==Array&&!q(i.prototype)?v(i)&&null===(i=i[_r])&&(i=void 0):i=void 0,i===Array||void 0===i))return xr.call(r,a,l);for(n=new(void 0===i?Array:i)(Cr(l-a,0)),o=0;a<l;a++,o++)a in r&&De(n,o,r[a]);return n.length=o,n}});var Er=gt("Array").slice,Tr=Array.prototype,Sr=function(t){var e=t.slice;return t===Tr||t instanceof Array&&e===Tr.slice?Er:e},Ar=Sr,Or=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},Ir=function(t,e){var i;if(t){if("string"==typeof t)return Or(t,e);var n=Ar(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?br(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Or(t,e):void 0}},Pr=function(t,e){return function(t){if(lr(t))return t}(t)||function(t,e){if(void 0!==yr&&hr(Object(t))){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=Nn(t);!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{n||null==a.return||a.return()}finally{if(o)throw r}}return i}}(t,e)||Ir(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()};W({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Mr=r(function(){Te(1)});W({target:"Object",stat:!0,forced:Mr},{keys:function(t){return Te(Q(t))}});var Dr=N.Object.keys,Nr=ar,Rr=Qe.f("iterator"),zr=Rr,Fr=i(function(t){function e(i){return t.exports=e="function"==typeof yr&&"symbol"==typeof zr?function(t){return typeof t}:function(t){return t&&"function"==typeof yr&&t.constructor===yr&&t!==yr.prototype?"symbol":typeof t},e(i)}t.exports=e});W({target:"Reflect",stat:!0},{ownKeys:Me});var Lr=N.Reflect.ownKeys,Br=Sr,jr=function(t){return function(t){if(lr(t))return Or(t)}(t)||function(t){if(void 0!==yr&&hr(Object(t)))return br(t)}(t)||Ir(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()},Vr=gt("Array").concat,Hr=Array.prototype,Wr=function(t){var e=t.concat;return t===Hr||t instanceof Array&&e===Hr.concat?Vr:e},qr=vr,Ur=i(function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}});function Yr(){return(Yr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Gr(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Zr(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var $r,Xr="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,Kr=["","webkit","Moz","MS","ms","o"],Qr="undefined"==typeof document?{style:{}}:document.createElement("div"),Jr=Math.round,ts=Math.abs,es=Date.now;function is(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<Kr.length;){if((n=(i=Kr[r])?i+o:e)in t)return n;r++}}$r="undefined"==typeof window?{}:window;var ns=is(Qr.style,"touchAction"),os=void 0!==ns,rs="compute",ss="auto",as="manipulation",ls="none",cs="pan-x",hs="pan-y",ds=function(){if(!os)return!1;var t={},e=$r.CSS&&$r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||$r.CSS.supports("touch-action",i)}),t}(),us="ontouchstart"in $r,fs=void 0!==is($r,"PointerEvent"),ps=us&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),gs="touch",ms="mouse",vs=["x","y"],ys=["clientX","clientY"];function bs(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function ws(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function ks(t,e){return t.indexOf(e)>-1}var _s=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===rs&&(t=this.compute()),os&&this.manager.element.style&&ds[t]&&(this.manager.element.style[ns]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return bs(this.manager.recognizers,function(e){ws(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(ks(t,ls))return ls;var e=ks(t,cs),i=ks(t,hs);return e&&i?ls:e||i?e?cs:hs:ks(t,as)?as:ss}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,o=ks(n,ls)&&!ds.none,r=ks(n,hs)&&!ds["pan-y"],s=ks(n,cs)&&!ds["pan-x"];if(o&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!s||!r)return o||r&&6&i||s&&24&i?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function xs(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Cs(t){var e=t.length;if(1===e)return{x:Jr(t[0].clientX),y:Jr(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:Jr(i/e),y:Jr(n/e)}}function Es(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Jr(t.pointers[i].clientX),clientY:Jr(t.pointers[i].clientY)},i++;return{timeStamp:es(),pointers:e,center:Cs(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Ts(t,e,i){i||(i=vs);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function Ss(t,e,i){return i||(i=vs),180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function As(t,e){return t===e?1:ts(t)>=ts(e)?t<0?2:4:e<0?8:16}function Os(t,e,i){return{x:e/t||0,y:i/t||0}}function Is(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=1&e&&n-o==0,s=12&e&&n-o==0;i.isFirst=!!r,i.isFinal=!!s,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=Es(e)),o>1&&!i.firstMultiple?i.firstMultiple=Es(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,a=s?s.center:r.center,l=e.center=Cs(n);e.timeStamp=es(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=Ss(a,l),e.distance=Ts(a,l),function(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}(i,e),e.offsetDirection=As(e.deltaX,e.deltaY);var c,h,d=Os(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=ts(d.x)>ts(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,Ts((h=n)[0],h[1],ys)/Ts(c[0],c[1],ys)):1,e.rotation=s?function(t,e){return Ss(e[1],e[0],ys)+Ss(t[1],t[0],ys)}(s.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=Os(a,l,c);n=h.x,o=h.y,i=ts(h.x)>ts(h.y)?h.x:h.y,r=As(l,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(i,e);var u,f=t.element,p=e.srcEvent;xs(u=p.composedPath?p.composedPath()[0]:p.path?p.path[0]:p.target,f)&&(f=u),e.target=f}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Ps(t){return t.trim().split(/\s+/g)}function Ms(t,e,i){bs(Ps(e),function(e){t.addEventListener(e,i,!1)})}function Ds(t,e,i){bs(Ps(e),function(e){t.removeEventListener(e,i,!1)})}function Ns(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var Rs=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){ws(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&Ms(this.element,this.evEl,this.domHandler),this.evTarget&&Ms(this.target,this.evTarget,this.domHandler),this.evWin&&Ms(Ns(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&Ds(this.element,this.evEl,this.domHandler),this.evTarget&&Ds(this.target,this.evTarget,this.domHandler),this.evWin&&Ds(Ns(this.element),this.evWin,this.domHandler)},t}();function zs(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}var Fs={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Ls={2:gs,3:"pen",4:ms,5:"kinect"},Bs="pointerdown",js="pointermove pointerup pointercancel";$r.MSPointerEvent&&!$r.PointerEvent&&(Bs="MSPointerDown",js="MSPointerMove MSPointerUp MSPointerCancel");var Vs=function(t){function e(){var i,n=e.prototype;return n.evEl=Bs,n.evWin=js,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return Gr(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=Fs[n],r=Ls[t.pointerType]||t.pointerType,s=r===gs,a=zs(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))},e}(Rs);function Hs(t){return Array.prototype.slice.call(t,0)}function Ws(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];zs(o,s)<0&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var qs={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Us="touchstart touchmove touchend touchcancel",Ys=function(t){function e(){var i;return e.prototype.evTarget=Us,(i=t.apply(this,arguments)||this).targetIds={},i}return Gr(e,t),e.prototype.handler=function(t){var e=qs[t.type],i=Gs.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:gs,srcEvent:t})},e}(Rs);function Gs(t,e){var i,n,o=Hs(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=Hs(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return xs(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[Ws(n.concat(a),"identifier",!0),a]:void 0}var Zs={mousedown:1,mousemove:2,mouseup:4},$s="mousedown",Xs="mousemove mouseup",Ks=function(t){function e(){var i,n=e.prototype;return n.evEl=$s,n.evWin=Xs,(i=t.apply(this,arguments)||this).pressed=!1,i}return Gr(e,t),e.prototype.handler=function(t){var e=Zs[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:ms,srcEvent:t}))},e}(Rs);function Qs(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function Js(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,Qs.call(this,e)):12&t&&Qs.call(this,e)}function ta(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var ea=function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o=i.pointerType===ms;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(i.pointerType===gs)Js.call(Zr(Zr(n)),e,i);else if(o&&ta.call(Zr(Zr(n)),i))return;n.callback(t,e,i)}},n.touch=new Ys(n.manager,n.handler),n.mouse=new Ks(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return Gr(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(Rs);function ia(t,e,i){return!!Array.isArray(t)&&(bs(t,i[e],i),!0)}var na=32,oa=1;function ra(t,e){var i=e.manager;return i?i.get(t):t}function sa(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var aa=function(){function t(t){void 0===t&&(t={}),this.options=Yr({enable:!0},t),this.id=oa++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return Xr(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(ia(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=ra(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return ia(t,"dropRecognizeWith",this)||(t=ra(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(ia(t,"requireFailure",this))return this;var e=this.requireFail;return-1===zs(e,t=ra(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(ia(t,"dropRequireFailure",this))return this;t=ra(t,this);var e=zs(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+sa(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+sa(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=na},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=Xr({},t);if(!ws(this.options.enable,[this,e]))return this.reset(),void(this.state=na);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),la=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Yr({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[as]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||Ts(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return na},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=na},this.options.interval),na},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(aa),ca=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Yr({pointers:1},e))||this}Gr(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:na},e}(aa);function ha(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var da=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Yr({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(hs),24&t&&e.push(cs),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return ca.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=ha(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(ca),ua=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Yr({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){return da.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&ts(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=ha(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(ca),fa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Yr({event:"pinch",threshold:0,pointers:2},e))||this}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[ls]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),t.prototype.emit.call(this,e)},e}(ca),pa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Yr({event:"rotate",threshold:0,pointers:2},e))||this}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[ls]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(ca),ga=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Yr({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}Gr(e,t);var i=e.prototype;return i.getTouchAction=function(){return[ss]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,!o||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8;return na},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=es(),this.manager.emit(this.options.event,this._input)))},e}(aa),ma={domEvents:!1,touchAction:rs,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},va=[[pa,{enable:!1}],[fa,{enable:!1},["rotate"]],[ua,{direction:6}],[da,{direction:6},["swipe"]],[la],[la,{event:"doubletap",taps:2},["tap"]],[ga]];function ya(t,e){var i,n=t.element;n.style&&(bs(t.options.cssProps,function(o,r){i=is(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var ba=function(){function t(t,e){var i=this;this.options=Xr({},ma,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(fs?Vs:ps?Ys:us?ea:Ks))(this,Is),this.touchAction=new _s(this,this.options.touchAction),ya(this,!0),bs(this.options.recognizers,function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return Xr(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(e.curRecognizer=null,o=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||o&&i!==o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&14&i.state&&(e.curRecognizer=i,o=i),r++}},e.get=function(t){if(t instanceof aa)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(ia(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(ia(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=zs(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return bs(Ps(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return bs(Ps(t),function(t){e?i[t]&&i[t].splice(zs(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},e.destroy=function(){this.element&&ya(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),wa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ka="touchstart",_a="touchstart touchmove touchend touchcancel",xa=function(t){function e(){var i,n=e.prototype;return n.evTarget=ka,n.evWin=_a,(i=t.apply(this,arguments)||this).started=!1,i}return Gr(e,t),e.prototype.handler=function(t){var e=wa[t.type];if(1===e&&(this.started=!0),this.started){var i=Ca.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:gs,srcEvent:t})}},e}(Rs);function Ca(t,e){var i=Hs(t.touches),n=Hs(t.changedTouches);return 12&e&&(i=Ws(i.concat(n),"identifier",!0)),[i,n]}function Ea(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var Ta=Ea(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),Sa=Ea(function(t,e){return Ta(t,e,!0)},"merge","Use `assign`.");function Aa(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&Xr(n,i)}function Oa(t,e){return function(){return t.apply(e,arguments)}}var Ia=function(){var t=function(t,e){return void 0===e&&(e={}),new ba(t,Yr({recognizers:va.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=16,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=24,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=16,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=na,t.Manager=ba,t.Input=Rs,t.TouchAction=_s,t.TouchInput=Ys,t.MouseInput=Ks,t.PointerEventInput=Vs,t.TouchMouseInput=ea,t.SingleTouchInput=xa,t.Recognizer=aa,t.AttrRecognizer=ca,t.Tap=la,t.Pan=da,t.Swipe=ua,t.Pinch=fa,t.Rotate=pa,t.Press=ga,t.on=Ms,t.off=Ds,t.each=bs,t.merge=Sa,t.extend=Ta,t.bindFn=Oa,t.assign=Xr,t.inherit=Aa,t.bindFn=Oa,t.prefixed=is,t.toArray=Hs,t.inArray=zs,t.uniqueArray=Ws,t.splitStr=Ps,t.boolOrFn=ws,t.hasParent=xs,t.addEventListeners=Ms,t.removeEventListeners=Ds,t.defaults=Xr({},ma,{preset:va}),t}();function Pa(t,e){var i;if(void 0===qr||null==Rn(t)){if(Nr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Ma(t,e);var n=Br(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ma(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Ma(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Da=qr("DELETE");function Na(){var t=Ra.apply(void 0,arguments);return Fa(t),t}function Ra(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<2)return e[0];var n;if(e.length>2)return Ra.apply(void 0,Wr(n=[Na(e[0],e[1])]).call(n,jr(Br(e).call(e,2))));var o,r=e[0],s=e[1],a=Pa(Lr(s));try{for(a.s();!(o=a.n()).done;){var l=o.value;Object.prototype.propertyIsEnumerable.call(s,l)&&(s[l]===Da?delete r[l]:r[l]=null===r[l]||null===s[l]||"object"!==Fr(r[l])||"object"!==Fr(s[l])||Nr(r[l])||Nr(s[l])?za(s[l]):Ra(r[l],s[l]))}}catch(t){a.e(t)}finally{a.f()}return r}function za(t){return Nr(t)?Bt(t).call(t,function(t){return za(t)}):"object"===Fr(t)&&null!==t?Ra({},t):t}function Fa(t){for(var e=0,i=Dr(t);e<i.length;e++){var n=i[e];t[n]===Da?delete t[n]:"object"===Fr(t[n])&&null!==t[n]&&Fa(t[n])}}var La="undefined"!=typeof window?window.Hammer||Ia:function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(){return{set:t}}};var t};function Ba(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)});var n=La(this._dom.overlay);n.on("tap",le(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){n.destroy()});var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];sr(o).call(o,function(t){n.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",i._onClick)})),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}Ur(Ba.prototype),Ba.current=null,Ba.prototype.destroy=function(){var t,e;this.deactivate();var i,n=Pa(function(t){var e=t.reverse;return t===Qo||t instanceof Array&&e===Qo.reverse?Ko:e}(t=Zo(e=this._cleanupQueue).call(e,0)).call(t));try{for(n.s();!(i=n.n()).done;)(0,i.value)()}catch(t){n.e(t)}finally{n.f()}},Ba.prototype.activate=function(){Ba.current&&Ba.current.deactivate(),Ba.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},Ba.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},Ba.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var ja=_t("Reflect","construct"),Va=r(function(){function t(){}return!(ja(function(){},[],t)instanceof t)}),Ha=!r(function(){ja(function(){})}),Wa=Va||Ha;W({target:"Reflect",stat:!0,forced:Wa,sham:Wa},{construct:function(t,e){R(t),F(e);var i=arguments.length<3?t:R(arguments[2]);if(Ha&&!Va)return ja(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(re.apply(t,n))}var o=i.prototype,r=Ye(v(o)?o:Object.prototype),s=Function.apply.call(t,r,e);return v(s)?s:r}});var qa=N.Reflect.construct,Ua=gt("Array").entries,Ya=Array.prototype,Ga={DOMTokenList:!0,NodeList:!0},Za=i(function(t){var e=function(t){var e,i=Object.prototype,n=i.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var o=Object.create((e&&e.prototype instanceof m?e:m).prototype),r=new A(n||[]);return o._invoke=function(t,e,i){var n=d;return function(o,r){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw r;return I()}for(i.method=o,i.arg=r;;){var s=i.delegate;if(s){var a=E(s,i);if(a){if(a===g)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===d)throw n=p,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=f;var l=h(t,e,i);if("normal"===l.type){if(n=i.done?p:u,l.arg===g)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(n=p,i.method="throw",i.arg=l.arg)}}}(t,i,r),o}function h(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var d="suspendedStart",u="suspendedYield",f="executing",p="completed",g={};function m(){}function v(){}function y(){}var b={};b[r]=function(){return this};var w=Object.getPrototypeOf,k=w&&w(w(O([])));k&&k!==i&&n.call(k,r)&&(b=k);var _=y.prototype=m.prototype=Object.create(b);function x(t){["next","throw","return"].forEach(function(e){l(t,e,function(t){return this._invoke(e,t)})})}function C(t,e){function i(o,r,s,a){var l=h(t[o],t,r);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then(function(t){i("next",t,s,a)},function(t){i("throw",t,s,a)}):e.resolve(d).then(function(t){c.value=t,s(c)},function(t){return i("throw",t,s,a)})}a(l.arg)}var o;this._invoke=function(t,n){function r(){return new e(function(e,o){i(t,n,e,o)})}return o=o?o.then(r,r):r()}}function E(t,i){var n=t.iterator[i.method];if(n===e){if(i.delegate=null,"throw"===i.method){if(t.iterator.return&&(i.method="return",i.arg=e,E(t,i),"throw"===i.method))return g;i.method="throw",i.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=h(n,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,g;var r=o.arg;return r?r.done?(i[t.resultName]=r.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,g):r:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function O(t){if(t){var i=t[r];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,s=function i(){for(;++o<t.length;)if(n.call(t,o))return i.value=t[o],i.done=!1,i;return i.value=e,i.done=!0,i};return s.next=s}}return{next:I}}function I(){return{value:e,done:!0}}return v.prototype=_.constructor=y,y.constructor=v,v.displayName=l(y,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,l(t,a,"GeneratorFunction")),t.prototype=Object.create(_),t},t.awrap=function(t){return{__await:t}},x(C.prototype),C.prototype[s]=function(){return this},t.AsyncIterator=C,t.async=function(e,i,n,o,r){void 0===r&&(r=Promise);var s=new C(c(e,i,n,o),r);return t.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},x(_),l(_,a,"Generator"),_[r]=function(){return this},_.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},t.values=O,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var i in this)"t"===i.charAt(0)&&n.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function o(n,o){return a.type="throw",a.arg=t,i.next=n,o&&(i.method="next",i.arg=e),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),S(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var o=n.arg;S(i)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:O(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}),$a=Rr,Xa=gt("Array").values,Ka=Array.prototype,Qa={DOMTokenList:!0,NodeList:!0},Ja=function(t){var e=t.values;return t===Ka||t instanceof Array&&e===Ka.values||Qa.hasOwnProperty(ri(t))?Xa:e},tl=[],el=tl.sort,il=r(function(){tl.sort(void 0)}),nl=r(function(){tl.sort(null)}),ol=Zt("sort");W({target:"Array",proto:!0,forced:il||!nl||!ol},{sort:function(t){return void 0===t?el.call(Q(this)):el.call(Q(this),R(t))}});var rl=gt("Array").sort,sl=Array.prototype,al=function(t){var e=t.sort;return t===sl||t instanceof Array&&e===sl.sort?rl:e},ll=gt("Array").keys,cl=Array.prototype,hl={DOMTokenList:!0,NodeList:!0},dl=function(t){var e=t.keys;return t===cl||t instanceof Array&&e===cl.keys||hl.hasOwnProperty(ri(t))?ll:e},ul=wt.some,fl=Zt("some"),pl=Dt("some");W({target:"Array",proto:!0,forced:!fl||!pl},{some:function(t){return ul(this,t,arguments.length>1?arguments[1]:void 0)}});var gl=gt("Array").some,ml=Array.prototype,vl=!r(function(){return Object.isExtensible(Object.preventExtensions({}))}),yl=i(function(t){var e=B.f,i=ot("meta"),n=0,o=Object.isExtensible||function(){return!0},r=function(t){e(t,i,{value:{objectID:"O"+ ++n,weakData:{}}})},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!v(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,i)){if(!o(t))return"F";if(!e)return"E";r(t)}return t[i].objectID},getWeakData:function(t,e){if(!w(t,i)){if(!o(t))return!0;if(!e)return!1;r(t)}return t[i].weakData},onFreeze:function(t){return vl&&s.REQUIRED&&o(t)&&!w(t,i)&&r(t),t}};_e[i]=!0}),bl=function(t,e){this.stopped=t,this.result=e},wl=function(t,e,i){var n,o,r,s,a,l,c,h=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),u=!(!i||!i.INTERRUPTED),f=z(e,i&&i.that,1+h+u),p=function(t){return n&&zn(n),new bl(!0,t)},g=function(t){return h?(F(t),u?f(t[0],t[1],p):f(t[0],t[1])):u?f(t,p):f(t)};if(d)n=t;else{if("function"!=typeof(o=Dn(t)))throw TypeError("Target is not iterable");if(jn(o)){for(r=0,s=$(t.length);s>r;r++)if((a=g(t[r]))&&a instanceof bl)return a;return new bl(!1)}n=o.call(t)}for(l=n.next;!(c=l.call(n)).done;){try{a=g(c.value)}catch(t){throw zn(n),t}if("object"==typeof a&&a&&a instanceof bl)return a}return new bl(!1)},kl=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t},_l=B.f,xl=wt.forEach,Cl=wi.set,El=wi.getterFor,Tl=function(t,e,i){var n,a=-1!==t.indexOf("Map"),l=-1!==t.indexOf("Weak"),c=a?"set":"add",h=o[t],d=h&&h.prototype,u={};if(s&&"function"==typeof h&&(l||d.forEach&&!r(function(){(new h).entries().next()}))){n=e(function(e,i){Cl(kl(e,n,t),{type:t,collection:new h}),null!=i&&wl(i,e[c],{that:e,AS_ENTRIES:a})});var f=El(t);xl(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"==t||"set"==t;!(t in d)||l&&"clear"==t||j(n.prototype,t,function(i,n){var o=f(this).collection;if(!e&&l&&!v(i))return"get"==t&&void 0;var r=o[t](0===i?0:i,n);return e?this:r})}),l||_l(n.prototype,"size",{configurable:!0,get:function(){return f(this).collection.size}})}else n=i.getConstructor(e,t,a,c),yl.REQUIRED=!0;return ci(n,t,!1,!0),u[t]=n,W({global:!0,forced:!0},u),l||i.setStrong(n,t,a),n},Sl=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:Ke(t,n,e[n],i);return t},Al=ht("species"),Ol=B.f,Il=yl.fastKey,Pl=wi.set,Ml=wi.getterFor,Dl={getConstructor:function(t,e,i,n){var o=t(function(t,r){kl(t,o,e),Pl(t,{type:e,index:Ye(null),first:void 0,last:void 0,size:0}),s||(t.size=0),null!=r&&wl(r,t[n],{that:t,AS_ENTRIES:i})}),r=Ml(e),a=function(t,e,i){var n,o,a=r(t),c=l(t,e);return c?c.value=i:(a.last=c={index:o=Il(e,!0),key:e,value:i,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=c),n&&(n.next=c),s?a.size++:t.size++,"F"!==o&&(a.index[o]=c)),t},l=function(t,e){var i,n=r(t),o=Il(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key==e)return i};return Sl(o.prototype,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,s?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),n=l(e,t);if(n){var o=n.next,a=n.previous;delete i.index[n.index],n.removed=!0,a&&(a.next=o),o&&(o.previous=a),i.first==n&&(i.first=o),i.last==n&&(i.last=a),s?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=r(this),n=z(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!l(this,t)}}),Sl(o.prototype,i?{get:function(t){var e=l(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),s&&Ol(o.prototype,"size",{get:function(){return r(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=Ml(e),r=Ml(n);bn(t,e,function(t,e){Pl(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),function(t){var e=_t(t);s&&e&&!e[Al]&&(0,B.f)(e,Al,{configurable:!0,get:function(){return this}})}(e)}},Nl=(Tl("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Dl),N.Map),Rl=so;W({target:"Object",stat:!0},{setPrototypeOf:dn});var zl,Fl=N.Object.setPrototypeOf,Ll=i(function(t){function e(i,n){return t.exports=e=Fl||function(t,e){return t.__proto__=e,t},e(i,n)}t.exports=e}),Bl=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Rl(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ll(t,e)},jl=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},Vl=function(t,e){return!e||"object"!==Fr(e)&&"function"!=typeof e?jl(t):e},Hl=Io,Wl=i(function(t){function e(i){return t.exports=e=Fl?Hl:function(t){return t.__proto__||Hl(t)},e(i)}t.exports=e}),ql=new Uint8Array(16);function Ul(){if(!zl&&!(zl="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zl(ql)}var Yl=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Gl(t){return"string"==typeof t&&Yl.test(t)}for(var Zl=[],$l=0;$l<256;++$l)Zl.push(($l+256).toString(16).substr(1));function Xl(t,e,i){var n=(t=t||{}).random||(t.rng||Ul)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){i=i||0;for(var o=0;o<16;++o)e[i+o]=n[o];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(Zl[t[e+0]]+Zl[t[e+1]]+Zl[t[e+2]]+Zl[t[e+3]]+"-"+Zl[t[e+4]]+Zl[t[e+5]]+"-"+Zl[t[e+6]]+Zl[t[e+7]]+"-"+Zl[t[e+8]]+Zl[t[e+9]]+"-"+Zl[t[e+10]]+Zl[t[e+11]]+Zl[t[e+12]]+Zl[t[e+13]]+Zl[t[e+14]]+Zl[t[e+15]]).toLowerCase();if(!Gl(i))throw TypeError("Stringified UUID is invalid");return i}(n)}function Kl(t){return"string"==typeof t||"number"==typeof t}var Ql=function(){function t(e){ce(this,t),this._queue=[],this._timeout=null,this._extended=null,this.delay=null,this.max=1/0,this.setOptions(e)}return fe(t,[{key:"setOptions",value:function(t){t&&void 0!==t.delay&&(this.delay=t.delay),t&&void 0!==t.max&&(this.max=t.max),this._flushIfNeeded()}},{key:"destroy",value:function(){if(this.flush(),this._extended){for(var t=this._extended.object,e=this._extended.methods,i=0;i<e.length;i++){var n=e[i];n.original?t[n.name]=n.original:delete t[n.name]}this._extended=null}}},{key:"replace",value:function(t,e){var i=this,n=t[e];if(!n)throw new Error("Method "+e+" undefined");t[e]=function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];i.queue({args:e,fn:n,context:this})}}},{key:"queue",value:function(t){this._queue.push("function"==typeof t?{fn:t}:t),this._flushIfNeeded()}},{key:"_flushIfNeeded",value:function(){var t=this;this._queue.length>this.max&&this.flush(),null!=this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this.queue.length>0&&"number"==typeof this.delay&&(this._timeout=Kn(function(){t.flush()},this.delay))}},{key:"flush",value:function(){var t,e;sr(t=Zo(e=this._queue).call(e,0)).call(t,function(t){t.fn.apply(t.context||t.fn,t.args||[])})}}],[{key:"extend",value:function(e,i){var n=new t(i);if(void 0!==e.flush)throw new Error("Target object already has a property flush");e.flush=function(){n.flush()};var o=[{name:"flush",original:void 0}];if(i&&i.replace)for(var r=0;r<i.replace.length;r++){var s=i.replace[r];o.push({name:s,original:e[s]}),n.replace(e,s)}return n._extended={object:e,methods:o},n}}]),t}(),Jl=function(){function t(){ce(this,t),this._subscribers={"*":[],add:[],remove:[],update:[]},this.subscribe=t.prototype.on,this.unsubscribe=t.prototype.off}return fe(t,[{key:"_trigger",value:function(t,e,i){var n,o;if("*"===t)throw new Error("Cannot trigger event *");sr(n=Wr(o=[]).call(o,jr(this._subscribers[t]),jr(this._subscribers["*"]))).call(n,function(n){n(t,e,null!=i?i:null)})}},{key:"on",value:function(t,e){"function"==typeof e&&this._subscribers[t].push(e)}},{key:"off",value:function(t,e){var i;this._subscribers[t]=Ut(i=this._subscribers[t]).call(i,function(t){return t!==e})}}]),t}(),tc=(Tl("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Dl),N.Set);function ec(t,e){var i;if(void 0===qr||null==Rn(t)){if(Nr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return ic(t,e);var n=Br(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ic(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function ic(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var nc=function(){function t(e){ce(this,t),this._pairs=e}return fe(t,[{key:$a,value:Za.mark(function t(){var e,i,n,o,r;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=ec(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Pr(i.value,2),o=n[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"entries",value:Za.mark(function t(){var e,i,n,o,r;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=ec(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Pr(i.value,2),o=n[0],r=n[1],t.next=7,[o,r];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"keys",value:Za.mark(function t(){var e,i,n,o;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=ec(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Pr(i.value,1),o=n[0],t.next=7,o;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"values",value:Za.mark(function t(){var e,i,n,o;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=ec(this._pairs),t.prev=1,e.s();case 3:if((i=e.n()).done){t.next=9;break}return n=Pr(i.value,2),o=n[1],t.next=7,o;case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.e(t.t0);case 14:return t.prev=14,e.f(),t.finish(14);case 17:case"end":return t.stop()}},t,this,[[1,11,14,17]])})},{key:"toIdArray",value:function(){var t;return Bt(t=jr(this._pairs)).call(t,function(t){return t[0]})}},{key:"toItemArray",value:function(){var t;return Bt(t=jr(this._pairs)).call(t,function(t){return t[1]})}},{key:"toEntryArray",value:function(){return jr(this._pairs)}},{key:"toObjectMap",value:function(){var t,e=ao(null),i=ec(this._pairs);try{for(i.s();!(t=i.n()).done;){var n=Pr(t.value,2);e[n[0]]=n[1]}}catch(t){i.e(t)}finally{i.f()}return e}},{key:"toMap",value:function(){return new Nl(this._pairs)}},{key:"toIdSet",value:function(){return new tc(this.toIdArray())}},{key:"toItemSet",value:function(){return new tc(this.toItemArray())}},{key:"cache",value:function(){return new t(jr(this._pairs))}},{key:"distinct",value:function(t){var e,i=new tc,n=ec(this._pairs);try{for(n.s();!(e=n.n()).done;){var o=Pr(e.value,2);i.add(t(o[1],o[0]))}}catch(t){n.e(t)}finally{n.f()}return i}},{key:"filter",value:function(e){var i=this._pairs;return new t(lo({},$a,Za.mark(function t(){var n,o,r,s,a;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=ec(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=10;break}if(r=Pr(o.value,2),!e(a=r[1],s=r[0])){t.next=8;break}return t.next=8,[s,a];case 8:t.next=3;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(1),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}},t,null,[[1,12,15,18]])})))}},{key:"forEach",value:function(t){var e,i=ec(this._pairs);try{for(i.s();!(e=i.n()).done;){var n=Pr(e.value,2);t(n[1],n[0])}}catch(t){i.e(t)}finally{i.f()}}},{key:"map",value:function(e){var i=this._pairs;return new t(lo({},$a,Za.mark(function t(){var n,o,r,s,a;return Za.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=ec(i),t.prev=1,n.s();case 3:if((o=n.n()).done){t.next=9;break}return r=Pr(o.value,2),s=r[0],a=r[1],t.next=7,[s,e(a,s)];case 7:t.next=3;break;case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),n.e(t.t0);case 14:return t.prev=14,n.f(),t.finish(14);case 17:case"end":return t.stop()}},t,null,[[1,11,14,17]])})))}},{key:"max",value:function(t){var e=Nn(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=Pr(i.value,2),s=r[1],a=t(s,r[0]);a>o&&(o=a,n=s)}return n}},{key:"min",value:function(t){var e=Nn(this._pairs),i=e.next();if(i.done)return null;for(var n=i.value[1],o=t(i.value[1],i.value[0]);!(i=e.next()).done;){var r=Pr(i.value,2),s=r[1],a=t(s,r[0]);a<o&&(o=a,n=s)}return n}},{key:"reduce",value:function(t,e){var i,n=ec(this._pairs);try{for(n.s();!(i=n.n()).done;){var o=Pr(i.value,2);e=t(e,o[1],o[0])}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"sort",value:function(e){var i=this;return new t(lo({},$a,function(){var t;return Nn(al(t=jr(i._pairs)).call(t,function(t,i){var n=Pr(t,2),o=n[0],r=n[1],s=Pr(i,2);return e(r,s[1],o,s[0])}))}))}}]),t}();function oc(t,e){var i=Dr(t);if(tn){var n=tn(t);e&&(n=Ut(n).call(n,function(e){return Le(t,e).enumerable})),i.push.apply(i,n)}return i}function rc(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)sr(i=oc(Object(n),!0)).call(i,function(e){lo(t,e,n[e])});else if(Ne)Ae(t,Ne(n));else{var o;sr(o=oc(Object(n))).call(o,function(e){me(t,e,Le(n,e))})}}return t}function sc(t,e){var i;if(void 0===qr||null==Rn(t)){if(Nr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return ac(t,e);var n=Br(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ac(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function ac(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var lc=function(t){Bl(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!qa)return!1;if(qa.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(qa(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Wl(t);if(e){var o=Wl(this).constructor;i=qa(n,arguments,o)}else i=n.apply(this,arguments);return Vl(this,i)}}(i);function i(t,n){var o;return ce(this,i),(o=e.call(this))._queue=null,t&&!Nr(t)&&(n=t,t=[]),o._options=n||{},o._data=new Nl,o.length=0,o._idProp=o._options.fieldId||"id",t&&t.length&&o.add(t),o.setOptions(n),o}return fe(i,[{key:"setOptions",value:function(t){t&&void 0!==t.queue&&(!1===t.queue?this._queue&&(this._queue.destroy(),this._queue=null):(this._queue||(this._queue=Ql.extend(this,{replace:["add","update","remove"]})),t.queue&&"object"===Fr(t.queue)&&this._queue.setOptions(t.queue)))}},{key:"add",value:function(t,e){var i,n=this,o=[];if(Nr(t)){var r=Bt(t).call(t,function(t){return t[n._idProp]});if(function(t){var e=t.some;return t===ml||t instanceof Array&&e===ml.some?gl:e}(r).call(r,function(t){return n._data.has(t)}))throw new Error("A duplicate id was found in the parameter array.");for(var s=0,a=t.length;s<a;s++)i=this._addItem(t[s]),o.push(i)}else{if(!t||"object"!==Fr(t))throw new Error("Unknown dataType");i=this._addItem(t),o.push(i)}return o.length&&this._trigger("add",{items:o},e),o}},{key:"update",value:function(t,e){var i=this,n=[],o=[],r=[],s=[],a=this._idProp,l=function(t){var e=t[a];if(null!=e&&i._data.has(e)){var l=t,c=Bo({},i._data.get(e)),h=i._updateItem(l);o.push(h),s.push(l),r.push(c)}else{var d=i._addItem(t);n.push(d)}};if(Nr(t))for(var c=0,h=t.length;c<h;c++)t[c]&&"object"===Fr(t[c])?l(t[c]):console.warn("Ignoring input item, which is not an object at index "+c);else{if(!t||"object"!==Fr(t))throw new Error("Unknown dataType");l(t)}return n.length&&this._trigger("add",{items:n},e),o.length&&this._trigger("update",{items:o,oldData:r,data:s},e),Wr(n).call(n,o)}},{key:"updateOnly",value:function(t,e){var i,n=this;Nr(t)||(t=[t]);var o=Bt(i=Bt(t).call(t,function(t){var e=n._data.get(t[n._idProp]);if(null==e)throw new Error("Updating non-existent items is not allowed.");return{oldData:e,update:t}})).call(i,function(t){var e=t.oldData,i=e[n._idProp],o=function(t){for(var e,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Na.apply(void 0,Wr(e=[{},t]).call(e,n))}(e,t.update);return n._data.set(i,o),{id:i,oldData:e,updatedData:o}});if(o.length){var r={items:Bt(o).call(o,function(t){return t.id}),oldData:Bt(o).call(o,function(t){return t.oldData}),data:Bt(o).call(o,function(t){return t.updatedData})};return this._trigger("update",r,e),r.items}return[]}},{key:"get",value:function(t,e){var i=void 0,n=void 0,o=void 0;Kl(t)?(i=t,o=e):Nr(t)?(n=t,o=e):o=t;var r,s=o&&"Object"===o.returnType?"Object":"Array",a=o&&Ut(o),l=[],c=void 0,h=void 0;if(null!=i)(c=this._data.get(i))&&a&&!a(c)&&(c=void 0);else if(null!=n)for(var d=0,u=n.length;d<u;d++)null==(c=this._data.get(n[d]))||a&&!a(c)||l.push(c);else for(var f,p=0,g=(h=jr(dl(f=this._data).call(f))).length;p<g;p++)null==(c=this._data.get(h[p]))||a&&!a(c)||l.push(c);if(o&&o.order&&null==i&&this._sort(l,o.order),o&&o.fields){var m=o.fields;if(null!=i&&null!=c)c=this._filterFields(c,m);else for(var v=0,y=l.length;v<y;v++)l[v]=this._filterFields(l[v],m)}if("Object"==s){for(var b={},w=0,k=l.length;w<k;w++){var _=l[w];b[_[this._idProp]]=_}return b}return null!=i?null!==(r=c)&&void 0!==r?r:null:l}},{key:"getIds",value:function(t){var e=this._data,i=t&&Ut(t),n=t&&t.order,o=jr(dl(e).call(e)),r=[];if(i)if(n){for(var s=[],a=0,l=o.length;a<l;a++){var c=this._data.get(o[a]);null!=c&&i(c)&&s.push(c)}this._sort(s,n);for(var h=0,d=s.length;h<d;h++)r.push(s[h][this._idProp])}else for(var u=0,f=o.length;u<f;u++){var p=this._data.get(o[u]);null!=p&&i(p)&&r.push(p[this._idProp])}else if(n){for(var g=[],m=0,v=o.length;m<v;m++)g.push(e.get(o[m]));this._sort(g,n);for(var y=0,b=g.length;y<b;y++)r.push(g[y][this._idProp])}else for(var w=0,k=o.length;w<k;w++){var _=e.get(o[w]);null!=_&&r.push(_[this._idProp])}return r}},{key:"getDataSet",value:function(){return this}},{key:"forEach",value:function(t,e){var i=e&&Ut(e),n=this._data,o=jr(dl(n).call(n));if(e&&e.order)for(var r=this.get(e),s=0,a=r.length;s<a;s++){var l=r[s];t(l,l[this._idProp])}else for(var c=0,h=o.length;c<h;c++){var d=o[c],u=this._data.get(d);null==u||i&&!i(u)||t(u,d)}}},{key:"map",value:function(t,e){for(var i=e&&Ut(e),n=[],o=this._data,r=jr(dl(o).call(o)),s=0,a=r.length;s<a;s++){var l=r[s],c=this._data.get(l);null==c||i&&!i(c)||n.push(t(c,l))}return e&&e.order&&this._sort(n,e.order),n}},{key:"_filterFields",value:function(t,e){var i;return t?ee(i=Nr(e)?e:Dr(e)).call(i,function(e,i){return e[i]=t[i],e},{}):t}},{key:"_sort",value:function(t,e){if("string"==typeof e){var i=e;al(t).call(t,function(t,e){var n=t[i],o=e[i];return n>o?1:n<o?-1:0})}else{if("function"!=typeof e)throw new TypeError("Order must be a function or a string");al(t).call(t,e)}}},{key:"remove",value:function(t,e){for(var i=[],n=[],o=Nr(t)?t:[t],r=0,s=o.length;r<s;r++){var a=this._remove(o[r]);if(a){var l=a[this._idProp];null!=l&&(i.push(l),n.push(a))}}return i.length&&this._trigger("remove",{items:i,oldData:n},e),i}},{key:"_remove",value:function(t){var e;if(Kl(t)?e=t:t&&"object"===Fr(t)&&(e=t[this._idProp]),null!=e&&this._data.has(e)){var i=this._data.get(e)||null;return this._data.delete(e),--this.length,i}return null}},{key:"clear",value:function(t){for(var e,i=jr(dl(e=this._data).call(e)),n=[],o=0,r=i.length;o<r;o++)n.push(this._data.get(i[o]));return this._data.clear(),this.length=0,this._trigger("remove",{items:i,oldData:n},t),i}},{key:"max",value:function(t){var e,i,n=null,o=null,r=sc(Ja(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a>o)&&(n=s,o=a)}}catch(t){r.e(t)}finally{r.f()}return n||null}},{key:"min",value:function(t){var e,i,n=null,o=null,r=sc(Ja(e=this._data).call(e));try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s[t];"number"==typeof a&&(null==o||a<o)&&(n=s,o=a)}}catch(t){r.e(t)}finally{r.f()}return n||null}},{key:"distinct",value:function(t){for(var e=this._data,i=jr(dl(e).call(e)),n=[],o=0,r=0,s=i.length;r<s;r++){for(var a=e.get(i[r])[t],l=!1,c=0;c<o;c++)if(n[c]==a){l=!0;break}l||void 0===a||(n[o]=a,o++)}return n}},{key:"_addItem",value:function(t){var e=function(t,e){return null==t[e]&&(t[e]=Xl()),t}(t,this._idProp),i=e[this._idProp];if(this._data.has(i))throw new Error("Cannot add item: item with id "+i+" already exists");return this._data.set(i,e),++this.length,i}},{key:"_updateItem",value:function(t){var e=t[this._idProp];if(null==e)throw new Error("Cannot update item: item has no id (item: "+function(t,e,i){return N.JSON.stringify.apply(null,arguments)}(t)+")");var i=this._data.get(e);if(!i)throw new Error("Cannot update item: no item with id "+e+" found");return this._data.set(e,rc(rc({},i),t)),e}},{key:"stream",value:function(t){if(t){var e=this._data;return new nc(lo({},$a,Za.mark(function i(){var n,o,r,s;return Za.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:n=sc(t),i.prev=1,n.s();case 3:if((o=n.n()).done){i.next=11;break}if(null==(s=e.get(r=o.value))){i.next=9;break}return i.next=9,[r,s];case 9:i.next=3;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i.catch(1),n.e(i.t0);case 16:return i.prev=16,n.f(),i.finish(16);case 19:case"end":return i.stop()}},i,null,[[1,13,16,19]])})))}var i;return new nc(lo({},$a,le(i=function(t){var e=t.entries;return t===Ya||t instanceof Array&&e===Ya.entries||Ga.hasOwnProperty(ri(t))?Ua:e}(this._data)).call(i,this._data)))}},{key:"idProp",get:function(){return this._idProp}}]),i}(Jl);function cc(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var hc=function(t){Bl(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!qa)return!1;if(qa.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(qa(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Wl(t);if(e){var o=Wl(this).constructor;i=qa(n,arguments,o)}else i=n.apply(this,arguments);return Vl(this,i)}}(i);function i(t,n){var o,r;return ce(this,i),(r=e.call(this)).length=0,r._ids=new tc,r._options=n||{},r._listener=le(o=r._onEvent).call(o,jl(r)),r.setData(t),r}return fe(i,[{key:"setData",value:function(t){if(this._data){this._data.off&&this._data.off("*",this._listener);var e=this._data.getIds({filter:Ut(this._options)}),i=this._data.get(e);this._ids.clear(),this.length=0,this._trigger("remove",{items:e,oldData:i})}if(null!=t){this._data=t;for(var n=this._data.getIds({filter:Ut(this._options)}),o=0,r=n.length;o<r;o++)this._ids.add(n[o]);this.length=n.length,this._trigger("add",{items:n})}else this._data=new lc;this._data.on&&this._data.on("*",this._listener)}},{key:"refresh",value:function(){for(var t=this._data.getIds({filter:Ut(this._options)}),e=jr(this._ids),i={},n=[],o=[],r=[],s=0,a=t.length;s<a;s++){var l=t[s];i[l]=!0,this._ids.has(l)||(n.push(l),this._ids.add(l))}for(var c=0,h=e.length;c<h;c++){var d=e[c],u=this._data.get(d);null==u?console.error("If you see this, report it please."):i[d]||(o.push(d),r.push(u),this._ids.delete(d))}this.length+=n.length-o.length,n.length&&this._trigger("add",{items:n}),o.length&&this._trigger("remove",{items:o,oldData:r})}},{key:"get",value:function(t,e){if(null==this._data)return null;var i,n=null;Kl(t)||Nr(t)?(n=t,i=e):i=t;var o=Bo({},this._options,i),r=Ut(this._options),s=i&&Ut(i);return r&&s&&(o.filter=function(t){return r(t)&&s(t)}),null==n?this._data.get(o):this._data.get(n,o)}},{key:"getIds",value:function(t){if(this._data.length){var e=Ut(this._options),i=null!=t?Ut(t):null;return this._data.getIds({filter:i?e?function(t){return e(t)&&i(t)}:i:e,order:t&&t.order})}return[]}},{key:"forEach",value:function(t,e){if(this._data){var i,n,o=Ut(this._options),r=e&&Ut(e);n=r?o?function(t){return o(t)&&r(t)}:r:o,sr(i=this._data).call(i,t,{filter:n,order:e&&e.order})}}},{key:"map",value:function(t,e){if(this._data){var i,n,o=Ut(this._options),r=e&&Ut(e);return n=r?o?function(t){return o(t)&&r(t)}:r:o,Bt(i=this._data).call(i,t,{filter:n,order:e&&e.order})}return[]}},{key:"getDataSet",value:function(){return this._data.getDataSet()}},{key:"stream",value:function(t){var e;return this._data.stream(t||lo({},$a,le(e=dl(this._ids)).call(e,this._ids)))}},{key:"dispose",value:function(){var t;null!==(t=this._data)&&void 0!==t&&t.off&&this._data.off("*",this._listener);var e,n="This data view has already been disposed of.",o={get:function(){throw new Error(n)},set:function(){throw new Error(n)},configurable:!1},r=function(t,e){var i;if(void 0===qr||null==Rn(t)){if(Nr(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return cc(t,e);var n=Br(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Gn(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cc(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=Nn(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(Lr(i.prototype));try{for(r.s();!(e=r.n()).done;)me(this,e.value,o)}catch(t){r.e(t)}finally{r.f()}}},{key:"_onEvent",value:function(t,e,i){if(e&&e.items&&this._data){var n=e.items,o=[],r=[],s=[],a=[],l=[],c=[];switch(t){case"add":for(var h=0,d=n.length;h<d;h++){var u=n[h];this.get(u)&&(this._ids.add(u),o.push(u))}break;case"update":for(var f=0,p=n.length;f<p;f++){var g=n[f];this.get(g)?this._ids.has(g)?(r.push(g),l.push(e.data[f]),a.push(e.oldData[f])):(this._ids.add(g),o.push(g)):this._ids.has(g)&&(this._ids.delete(g),s.push(g),c.push(e.oldData[f]))}break;case"remove":for(var m=0,v=n.length;m<v;m++){var y=n[m];this._ids.has(y)&&(this._ids.delete(y),s.push(y),c.push(e.oldData[m]))}}this.length+=o.length-s.length,o.length&&this._trigger("add",{items:o},i),r.length&&this._trigger("update",{items:r,oldData:a,data:l},i),s.length&&this._trigger("remove",{items:s,oldData:c},i)}}},{key:"idProp",get:function(){return this.getDataSet().idProp}}]),i}(Jl);function dc(t,e){return"object"===Fr(e)&&null!==e&&t===e.idProp&&"function"==typeof e.add&&"function"==typeof e.clear&&"function"==typeof e.distinct&&"function"==typeof sr(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Bt(e)&&"function"==typeof e.max&&"function"==typeof e.min&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.remove&&"function"==typeof e.setOptions&&"function"==typeof e.stream&&"function"==typeof e.update&&"function"==typeof e.updateOnly}t.DELETE=Da,t.DataSet=lc,t.DataStream=nc,t.DataView=hc,t.Queue=Ql,t.createNewDataPipeFrom=function(t){return new ge(t)},t.isDataSetLike=dc,t.isDataViewLike=function(t,e){return"object"===Fr(e)&&null!==e&&t===e.idProp&&"function"==typeof sr(e)&&"function"==typeof e.get&&"function"==typeof e.getDataSet&&"function"==typeof e.getIds&&"number"==typeof e.length&&"function"==typeof Bt(e)&&"function"==typeof e.off&&"function"==typeof e.on&&"function"==typeof e.stream&&dc(t,e.getDataSet())},Object.defineProperty(t,"__esModule",{value:!0})}(e)},8395:function(t,e,i){!function(t,e){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(t){return t&&t.Math==Math&&t},o=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof i&&i)||function(){return this}()||Function("return this")(),r={},s=function(t){try{return!!t()}catch(t){return!0}},a=!s(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),l={},c={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,d=h&&!c.call({1:2},1);l.f=d?function(t){var e=h(this,t);return!!e&&e.enumerable}:c;var u,f,p=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},g={}.toString,m=function(t){return g.call(t).slice(8,-1)},v=m,y="".split,b=s(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==v(t)?y.call(t,""):Object(t)}:Object,w=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},k=b,_=w,x=function(t){return k(_(t))},C=function(t){return"object"==typeof t?null!==t:"function"==typeof t},E={},T=E,S=o,A=function(t){return"function"==typeof t?t:void 0},O=function(t,e){return arguments.length<2?A(T[t])||A(S[t]):T[t]&&T[t][e]||S[t]&&S[t][e]},I=O("navigator","userAgent")||"",P=I,M=o.process,D=o.Deno,N=M&&M.versions||D&&D.version,R=N&&N.v8;R?f=(u=R.split("."))[0]<4?1:u[0]+u[1]:P&&(!(u=P.match(/Edge\/(\d+)/))||u[1]>=74)&&(u=P.match(/Chrome\/(\d+)/))&&(f=u[1]);var z=f&&+f,F=z,L=!!Object.getOwnPropertySymbols&&!s(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&F&&F<41}),B=L&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,j=O,V=B?function(t){return"symbol"==typeof t}:function(t){var e=j("Symbol");return"function"==typeof e&&Object(t)instanceof e},H=C,W={exports:{}},q=o,U="__core-js_shared__",Y=o[U]||function(t,e){try{Object.defineProperty(q,t,{value:e,configurable:!0,writable:!0})}catch(i){q[t]=e}return e}(U,{}),G=Y;(W.exports=function(t,e){return G[t]||(G[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.16.1",mode:"pure",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"});var Z=w,$=function(t){return Object(Z(t))},X=$,K={}.hasOwnProperty,Q=Object.hasOwn||function(t,e){return K.call(X(t),e)},J=0,tt=Math.random(),et=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++J+tt).toString(36)},it=o,nt=Q,ot=et,rt=L,st=B,at=(0,W.exports)("wks"),lt=it.Symbol,ct=st?lt:lt&&lt.withoutSetter||ot,ht=function(t){return nt(at,t)&&(rt||"string"==typeof at[t])||(at[t]=rt&&nt(lt,t)?lt[t]:ct("Symbol."+t)),at[t]},dt=C,ut=V,ft=ht("toPrimitive"),pt=V,gt=function(t){var e=function(t,e){if(!dt(t)||ut(t))return t;var i,n=t[ft];if(void 0!==n){if(void 0===e&&(e="default"),i=n.call(t,e),!dt(i)||ut(i))return i;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),function(t,e){var i,n;if("string"===e&&"function"==typeof(i=t.toString)&&!H(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!H(n=i.call(t)))return n;if("string"!==e&&"function"==typeof(i=t.toString)&&!H(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")}(t,e)}(t,"string");return pt(e)?e:String(e)},mt=C,vt=o.document,yt=mt(vt)&&mt(vt.createElement),bt=function(t){return yt?vt.createElement(t):{}},wt=bt,kt=!a&&!s(function(){return 7!=Object.defineProperty(wt("div"),"a",{get:function(){return 7}}).a}),_t=l,xt=p,Ct=x,Et=gt,Tt=Q,St=kt,At=Object.getOwnPropertyDescriptor;r.f=a?At:function(t,e){if(t=Ct(t),e=Et(e),St)try{return At(t,e)}catch(t){}if(Tt(t,e))return xt(!_t.f.call(t,e),t[e])};var Ot=s,It=/#|\.prototype\./,Pt=function(t,e){var i=Dt[Mt(t)];return i==Rt||i!=Nt&&("function"==typeof e?Ot(e):!!e)},Mt=Pt.normalize=function(t){return String(t).replace(It,".").toLowerCase()},Dt=Pt.data={},Nt=Pt.NATIVE="N",Rt=Pt.POLYFILL="P",zt=Pt,Ft=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},Lt=Ft,Bt=function(t,e,i){if(Lt(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}},jt={},Vt=C,Ht=function(t){if(!Vt(t))throw TypeError(String(t)+" is not an object");return t},Wt=kt,qt=Ht,Ut=gt,Yt=Object.defineProperty;jt.f=a?Yt:function(t,e,i){if(qt(t),e=Ut(e),qt(i),Wt)try{return Yt(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t};var Gt=jt,Zt=p,$t=a?function(t,e,i){return Gt.f(t,e,Zt(1,i))}:function(t,e,i){return t[e]=i,t},Xt=o,Kt=r.f,Qt=zt,Jt=E,te=Bt,ee=$t,ie=Q,ne=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},oe=function(t,e){var i,n,o,r,s,a,l,c,h=t.target,d=t.global,u=t.stat,f=t.proto,p=d?Xt:u?Xt[h]:(Xt[h]||{}).prototype,g=d?Jt:Jt[h]||(Jt[h]={}),m=g.prototype;for(o in e)i=!Qt(d?o:h+(u?".":"#")+o,t.forced)&&p&&ie(p,o),s=g[o],i&&(a=t.noTargetGet?(c=Kt(p,o))&&c.value:p[o]),r=i&&a?a:e[o],i&&typeof s==typeof r||(l=t.bind&&i?te(r,Xt):t.wrap&&i?ne(r):f&&"function"==typeof r?te(Function.call,r):r,(t.sham||r&&r.sham||s&&s.sham)&&ee(l,"sham",!0),g[o]=l,f&&(ie(Jt,n=h+"Prototype")||ee(Jt,n,{}),Jt[n][o]=r,t.real&&m&&!m[o]&&ee(m,o,r)))},re=Math.ceil,se=Math.floor,ae=function(t){return isNaN(t=+t)?0:(t>0?se:re)(t)},le=ae,ce=Math.min,he=function(t){return t>0?ce(le(t),9007199254740991):0},de=ae,ue=Math.max,fe=Math.min,pe=function(t,e){var i=de(t);return i<0?ue(i+e,0):fe(i,e)},ge=x,me=he,ve=pe,ye=function(t){return function(e,i,n){var o,r=ge(e),s=me(r.length),a=ve(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},be={includes:ye(!0),indexOf:ye(!1)},we={},ke=Q,_e=x,xe=be.indexOf,Ce=we,Ee=function(t,e){var i,n=_e(t),o=0,r=[];for(i in n)!ke(Ce,i)&&ke(n,i)&&r.push(i);for(;e.length>o;)ke(n,i=e[o++])&&(~xe(r,i)||r.push(i));return r},Te=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Se=Ee,Ae=Te,Oe=Object.keys||function(t){return Se(t,Ae)},Ie={};Ie.f=Object.getOwnPropertySymbols;var Pe=a,Me=Oe,De=Ie,Ne=l,Re=$,ze=b,Fe=Object.assign,Le=Object.defineProperty,Be=!Fe||s(function(){if(Pe&&1!==Fe({b:1},Fe(Le({},"a",{enumerable:!0,get:function(){Le(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=Fe({},t)[i]||Me(Fe({},e)).join("")!=n})?function(t,e){for(var i=Re(t),n=arguments.length,o=1,r=De.f,s=Ne.f;n>o;)for(var a,l=ze(arguments[o++]),c=r?Me(l).concat(r(l)):Me(l),h=c.length,d=0;h>d;)a=c[d++],Pe&&!s.call(l,a)||(i[a]=l[a]);return i}:Fe;oe({target:"Object",stat:!0,forced:Object.assign!==Be},{assign:Be});var je=E.Object.assign,Ve=Ft,He=C,We=[].slice,qe={},Ue=function(t,e,i){if(!(e in qe)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";qe[e]=Function("C,a","return new C("+n.join(",")+")")}return qe[e](t,i)},Ye=Function.bind||function(t){var e=Ve(this),i=We.call(arguments,1),n=function(){var o=i.concat(We.call(arguments));return this instanceof n?Ue(e,o.length,o):e.apply(t,o)};return He(e.prototype)&&(n.prototype=e.prototype),n};oe({target:"Function",proto:!0},{bind:Ye});var Ge=E,Ze=function(t){return Ge[t+"Prototype"]},$e=Ze("Function").bind,Xe=Function.prototype,Ke=function(t){var e=t.bind;return t===Xe||t instanceof Function&&e===Xe.bind?$e:e};function Qe(t,e,i,n){t.beginPath(),t.arc(e,i,n,0,2*Math.PI,!1),t.closePath()}function Je(t,e,i,n,o,r){var s=Math.PI/180;n-2*r<0&&(r=n/2),o-2*r<0&&(r=o/2),t.beginPath(),t.moveTo(e+r,i),t.lineTo(e+n-r,i),t.arc(e+n-r,i+r,r,270*s,360*s,!1),t.lineTo(e+n,i+o-r),t.arc(e+n-r,i+o-r,r,0,90*s,!1),t.lineTo(e+r,i+o),t.arc(e+r,i+o-r,r,90*s,180*s,!1),t.lineTo(e,i+r),t.arc(e+r,i+r,r,180*s,270*s,!1),t.closePath()}function ti(t,e,i,n,o){var r=.5522848,s=n/2*r,a=o/2*r,l=e+n,c=i+o,h=e+n/2,d=i+o/2;t.beginPath(),t.moveTo(e,d),t.bezierCurveTo(e,d-a,h-s,i,h,i),t.bezierCurveTo(h+s,i,l,d-a,l,d),t.bezierCurveTo(l,d+a,h+s,c,h,c),t.bezierCurveTo(h-s,c,e,d+a,e,d),t.closePath()}function ei(t,e,i,n,o){var r=o*(1/3),s=.5522848,a=n/2*s,l=r/2*s,c=e+n,h=i+r,d=e+n/2,u=i+r/2,f=i+(o-r/2),p=i+o;t.beginPath(),t.moveTo(c,u),t.bezierCurveTo(c,u+l,d+a,h,d,h),t.bezierCurveTo(d-a,h,e,u+l,e,u),t.bezierCurveTo(e,u-l,d-a,i,d,i),t.bezierCurveTo(d+a,i,c,u-l,c,u),t.lineTo(c,f),t.bezierCurveTo(c,f+l,d+a,p,d,p),t.bezierCurveTo(d-a,p,e,f+l,e,f),t.lineTo(e,u)}function ii(t,e,i,n,o,r){t.beginPath(),t.moveTo(e,i);for(var s=r.length,a=n-e,l=o-i,c=l/a,h=Math.sqrt(a*a+l*l),d=0,u=!0,f=0,p=+r[0];h>=.1;)(p=+r[d++%s])>h&&(p=h),f=Math.sqrt(p*p/(1+c*c)),e+=f=a<0?-f:f,i+=c*f,!0===u?t.lineTo(e,i):t.moveTo(e,i),h-=p,u=!u}var ni={circle:Qe,dashedLine:ii,database:ei,diamond:function(t,e,i,n){t.beginPath(),t.lineTo(e,i+n),t.lineTo(e+n,i),t.lineTo(e,i-n),t.lineTo(e-n,i),t.closePath()},ellipse:ti,ellipse_vis:ti,hexagon:function(t,e,i,n){t.beginPath();var o=2*Math.PI/6;t.moveTo(e+n,i);for(var r=1;r<6;r++)t.lineTo(e+n*Math.cos(o*r),i+n*Math.sin(o*r));t.closePath()},roundRect:Je,square:function(t,e,i,n){t.beginPath(),t.rect(e-n,i-n,2*n,2*n),t.closePath()},star:function(t,e,i,n){t.beginPath(),i+=.1*(n*=.82);for(var o=0;o<10;o++){var r=o%2==0?1.3*n:.5*n;t.lineTo(e+r*Math.sin(2*o*Math.PI/10),i-r*Math.cos(2*o*Math.PI/10))}t.closePath()},triangle:function(t,e,i,n){t.beginPath(),i+=.275*(n*=1.15);var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i-(a-s)),t.lineTo(e+r,i+s),t.lineTo(e-r,i+s),t.lineTo(e,i-(a-s)),t.closePath()},triangleDown:function(t,e,i,n){t.beginPath(),i-=.275*(n*=1.15);var o=2*n,r=o/2,s=Math.sqrt(3)/6*o,a=Math.sqrt(o*o-r*r);t.moveTo(e,i+(a-s)),t.lineTo(e+r,i-s),t.lineTo(e-r,i-s),t.lineTo(e,i+(a-s)),t.closePath()}},oi={exports:{}};!function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}}(oi);var ri=oi.exports,si=V,ai=function(t){if(si(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)},li=ae,ci=ai,hi=w,di=function(t){return function(e,i){var n,o,r=ci(hi(e)),s=li(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):n:t?r.slice(s,s+2):o-56320+(n-55296<<10)+65536}},ui={codeAt:di(!1),charAt:di(!0)},fi=Y,pi=Function.toString;"function"!=typeof fi.inspectSource&&(fi.inspectSource=function(t){return pi.call(t)});var gi,mi,vi,yi=o.WeakMap,bi="function"==typeof yi&&/native code/.test((0,fi.inspectSource)(yi)),wi=et,ki=(0,W.exports)("keys"),_i=function(t){return ki[t]||(ki[t]=wi(t))},xi=C,Ci=$t,Ei=Q,Ti=_i,Si=we,Ai="Object already initialized";if(bi||Y.state){var Oi=Y.state||(Y.state=new(0,o.WeakMap)),Ii=Oi.get,Pi=Oi.has,Mi=Oi.set;gi=function(t,e){if(Pi.call(Oi,t))throw new TypeError(Ai);return e.facade=t,Mi.call(Oi,t,e),e},mi=function(t){return Ii.call(Oi,t)||{}},vi=function(t){return Pi.call(Oi,t)}}else{var Di=Ti("state");Si[Di]=!0,gi=function(t,e){if(Ei(t,Di))throw new TypeError(Ai);return e.facade=t,Ci(t,Di,e),e},mi=function(t){return Ei(t,Di)?t[Di]:{}},vi=function(t){return Ei(t,Di)}}var Ni,Ri,zi,Fi={set:gi,get:mi,has:vi,enforce:function(t){return vi(t)?mi(t):gi(t,{})},getterFor:function(t){return function(e){var i;if(!xi(e)||(i=mi(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},Li=!s(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Bi=Q,ji=$,Vi=Li,Hi=_i("IE_PROTO"),Wi=Object.prototype,qi=Vi?Object.getPrototypeOf:function(t){return t=ji(t),Bi(t,Hi)?t[Hi]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Wi:null},Ui=s,Yi=qi,Gi=$t,Zi=Q,$i=ht("iterator"),Xi=!1;[].keys&&("next"in(zi=[].keys())?(Ri=Yi(Yi(zi)))!==Object.prototype&&(Ni=Ri):Xi=!0);var Ki=null==Ni||Ui(function(){var t={};return Ni[$i].call(t)!==t});Ki&&(Ni={}),Ki&&!Zi(Ni,$i)&&Gi(Ni,$i,function(){return this});var Qi,Ji={IteratorPrototype:Ni,BUGGY_SAFARI_ITERATORS:Xi},tn=jt,en=Ht,nn=Oe,on=a?Object.defineProperties:function(t,e){en(t);for(var i,n=nn(e),o=n.length,r=0;o>r;)tn.f(t,i=n[r++],e[i]);return t},rn=O("document","documentElement"),sn=Ht,an=on,ln=Te,cn=we,hn=rn,dn=bt,un=_i("IE_PROTO"),fn=function(){},pn=function(t){return"<script>"+t+"<\/script>"},gn=function(t){t.write(pn("")),t.close();var e=t.parentWindow.Object;return t=null,e},mn=function(){try{Qi=new ActiveXObject("htmlfile")}catch(t){}mn=document.domain&&Qi?gn(Qi):function(){var t,e=dn("iframe");if(e.style)return e.style.display="none",hn.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(pn("document.F=Object")),t.close(),t.F}()||gn(Qi);for(var t=ln.length;t--;)delete mn.prototype[ln[t]];return mn()};cn[un]=!0;var vn=Object.create||function(t,e){var i;return null!==t?(fn.prototype=sn(t),i=new fn,fn.prototype=null,i[un]=t):i=mn(),void 0===e?i:an(i,e)},yn={};yn[ht("toStringTag")]="z";var bn="[object z]"===String(yn),wn=bn,kn=m,_n=ht("toStringTag"),xn="Arguments"==kn(function(){return arguments}()),Cn=wn?kn:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),_n))?i:xn?kn(e):"Object"==(n=kn(e))&&"function"==typeof e.callee?"Arguments":n},En=Cn,Tn=bn,Sn=jt.f,An=$t,On=Q,In=bn?{}.toString:function(){return"[object "+En(this)+"]"},Pn=ht("toStringTag"),Mn=function(t,e,i,n){if(t){var o=i?t:t.prototype;On(o,Pn)||Sn(o,Pn,{configurable:!0,value:e}),n&&!Tn&&An(o,"toString",In)}},Dn={},Nn=Ji.IteratorPrototype,Rn=vn,zn=p,Fn=Mn,Ln=Dn,Bn=function(){return this},jn=C,Vn=Ht,Hn=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return Vn(i),function(t){if(!jn(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0),Wn=$t,qn=function(t,e,i,n){n&&n.enumerable?t[e]=i:Wn(t,e,i)},Un=oe,Yn=qi,Gn=Mn,Zn=$t,$n=qn,Xn=Dn,Kn=Ji.IteratorPrototype,Qn=Ji.BUGGY_SAFARI_ITERATORS,Jn=ht("iterator"),to="keys",eo="values",io="entries",no=function(){return this},oo=function(t,e,i,n,o,r,s){!function(t,e,i){var n=e+" Iterator";t.prototype=Rn(Nn,{next:zn(1,i)}),Fn(t,n,!1,!0),Ln[n]=Bn}(i,e,n);var a,l,c,h=function(t){if(t===o&&g)return g;if(!Qn&&t in f)return f[t];switch(t){case to:case eo:case io:return function(){return new i(this,t)}}return function(){return new i(this)}},d=e+" Iterator",u=!1,f=t.prototype,p=f[Jn]||f["@@iterator"]||o&&f[o],g=!Qn&&p||h(o),m="Array"==e&&f.entries||p;if(m&&(a=Yn(m.call(new t)),Kn!==Object.prototype&&a.next&&(Gn(a,d,!0,!0),Xn[d]=no)),o==eo&&p&&p.name!==eo&&(u=!0,g=function(){return p.call(this)}),s&&f[Jn]!==g&&Zn(f,Jn,g),Xn[e]=g,o)if(l={values:h(eo),keys:r?g:h(to),entries:h(io)},s)for(c in l)(Qn||u||!(c in f))&&$n(f,c,l[c]);else Un({target:e,proto:!0,forced:Qn||u},l);return l},ro=ui.charAt,so=ai,ao=oo,lo="String Iterator",co=Fi.set,ho=Fi.getterFor(lo);ao(String,"String",function(t){co(this,{type:lo,string:so(t),index:0})},function(){var t,e=ho(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=ro(i,n),e.index+=t.length,{value:t,done:!1})});var uo=Ht,fo=function(t){var e=t.return;if(void 0!==e)return uo(e.call(t)).value},po=Ht,go=fo,mo=Dn,vo=ht("iterator"),yo=Array.prototype,bo=function(t){return void 0!==t&&(mo.Array===t||yo[vo]===t)},wo=gt,ko=jt,_o=p,xo=function(t,e,i){var n=wo(e);n in t?ko.f(t,n,_o(0,i)):t[n]=i},Co=Cn,Eo=Dn,To=ht("iterator"),So=function(t){if(null!=t)return t[To]||t["@@iterator"]||Eo[Co(t)]},Ao=Bt,Oo=$,Io=function(t,e,i,n){try{return n?e(po(i)[0],i[1]):e(i)}catch(e){throw go(t),e}},Po=bo,Mo=he,Do=xo,No=So,Ro=ht("iterator"),zo=!1;try{var Fo=0,Lo={next:function(){return{done:!!Fo++}},return:function(){zo=!0}};Lo[Ro]=function(){return this},Array.from(Lo,function(){throw 2})}catch(t){}oe({target:"Array",stat:!0,forced:!function(t,e){if(!zo)return!1;var i=!1;try{var n={};n[Ro]=function(){return{next:function(){return{done:i=!0}}}},function(t){Array.from(t)}(n)}catch(t){}return i}()},{from:function(t){var e,i,n,o,r,s,a=Oo(t),l="function"==typeof this?this:Array,c=arguments.length,h=c>1?arguments[1]:void 0,d=void 0!==h,u=No(a),f=0;if(d&&(h=Ao(h,c>2?arguments[2]:void 0,2)),null==u||l==Array&&Po(u))for(i=new l(e=Mo(a.length));e>f;f++)s=d?h(a[f],f):a[f],Do(i,f,s);else for(r=(o=u.call(a)).next,i=new l;!(n=r.call(o)).done;f++)s=d?Io(o,h,[n.value,f],!0):n.value,Do(i,f,s);return i.length=f,i}});var Bo=E.Array.from,jo=Bo,Vo=x,Ho=Dn,Wo=oo,qo="Array Iterator",Uo=Fi.set,Yo=Fi.getterFor(qo);Wo(Array,"Array",function(t,e){Uo(this,{type:qo,target:Vo(t),index:0,kind:e})},function(){var t=Yo(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),Ho.Arguments=Ho.Array;var Go=So,Zo=o,$o=Cn,Xo=$t,Ko=Dn,Qo=ht("toStringTag");for(var Jo in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var tr=Zo[Jo],er=tr&&tr.prototype;er&&$o(er)!==Qo&&Xo(er,Qo,Jo),Ko[Jo]=Ko.Array}var ir=Go,nr=m,or=Array.isArray||function(t){return"Array"==nr(t)},rr={},sr=Ee,ar=Te.concat("length","prototype");rr.f=Object.getOwnPropertyNames||function(t){return sr(t,ar)};var lr={},cr=x,hr=rr.f,dr={}.toString,ur="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];lr.f=function(t){return ur&&"[object Window]"==dr.call(t)?function(t){try{return hr(t)}catch(t){return ur.slice()}}(t):hr(cr(t))};var fr={};fr.f=ht;var pr=E,gr=Q,mr=fr,vr=jt.f,yr=function(t){var e=pr.Symbol||(pr.Symbol={});gr(e,t)||vr(e,t,{value:mr.f(t)})},br=C,wr=or,kr=ht("species"),_r=function(t,e){return new(function(t){var e;return wr(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!wr(e.prototype)?br(e)&&null===(e=e[kr])&&(e=void 0):e=void 0),void 0===e?Array:e}(t))(0===e?0:e)},xr=Bt,Cr=b,Er=$,Tr=he,Sr=_r,Ar=[].push,Or=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,r=6==t,s=7==t,a=5==t||r;return function(l,c,h,d){for(var u,f,p=Er(l),g=Cr(p),m=xr(c,h,3),v=Tr(g.length),y=0,b=d||Sr,w=e?b(l,v):i||s?b(l,0):void 0;v>y;y++)if((a||y in g)&&(f=m(u=g[y],y,p),t))if(e)w[y]=f;else if(f)switch(t){case 3:return!0;case 5:return u;case 6:return y;case 2:Ar.call(w,u)}else switch(t){case 4:return!1;case 7:Ar.call(w,u)}return r?-1:n||o?o:w}},Ir={forEach:Or(0),map:Or(1),filter:Or(2),some:Or(3),every:Or(4),find:Or(5),findIndex:Or(6),filterReject:Or(7)},Pr=oe,Mr=o,Dr=O,Nr=a,Rr=L,zr=s,Fr=Q,Lr=or,Br=C,jr=V,Vr=Ht,Hr=$,Wr=x,qr=gt,Ur=ai,Yr=p,Gr=vn,Zr=Oe,$r=rr,Xr=lr,Kr=Ie,Qr=r,Jr=jt,ts=l,es=$t,is=qn,ns=W.exports,os=we,rs=et,ss=ht,as=fr,ls=yr,cs=Mn,hs=Fi,ds=Ir.forEach,us=_i("hidden"),fs="Symbol",ps=ss("toPrimitive"),gs=hs.set,ms=hs.getterFor(fs),vs=Object.prototype,ys=Mr.Symbol,bs=Dr("JSON","stringify"),ws=Qr.f,ks=Jr.f,_s=Xr.f,xs=ts.f,Cs=ns("symbols"),Es=ns("op-symbols"),Ts=ns("string-to-symbol-registry"),Ss=ns("symbol-to-string-registry"),As=ns("wks"),Os=Mr.QObject,Is=!Os||!Os.prototype||!Os.prototype.findChild,Ps=Nr&&zr(function(){return 7!=Gr(ks({},"a",{get:function(){return ks(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=ws(vs,e);n&&delete vs[e],ks(t,e,i),n&&t!==vs&&ks(vs,e,n)}:ks,Ms=function(t,e){var i=Cs[t]=Gr(ys.prototype);return gs(i,{type:fs,tag:t,description:e}),Nr||(i.description=e),i},Ds=function(t,e,i){t===vs&&Ds(Es,e,i),Vr(t);var n=qr(e);return Vr(i),Fr(Cs,n)?(i.enumerable?(Fr(t,us)&&t[us][n]&&(t[us][n]=!1),i=Gr(i,{enumerable:Yr(0,!1)})):(Fr(t,us)||ks(t,us,Yr(1,{})),t[us][n]=!0),Ps(t,n,i)):ks(t,n,i)},Ns=function(t,e){Vr(t);var i=Wr(e),n=Zr(i).concat(Ls(i));return ds(n,function(e){Nr&&!Rs.call(i,e)||Ds(t,e,i[e])}),t},Rs=function(t){var e=qr(t),i=xs.call(this,e);return!(this===vs&&Fr(Cs,e)&&!Fr(Es,e))&&(!(i||!Fr(this,e)||!Fr(Cs,e)||Fr(this,us)&&this[us][e])||i)},zs=function(t,e){var i=Wr(t),n=qr(e);if(i!==vs||!Fr(Cs,n)||Fr(Es,n)){var o=ws(i,n);return!o||!Fr(Cs,n)||Fr(i,us)&&i[us][n]||(o.enumerable=!0),o}},Fs=function(t){var e=_s(Wr(t)),i=[];return ds(e,function(t){Fr(Cs,t)||Fr(os,t)||i.push(t)}),i},Ls=function(t){var e=t===vs,i=_s(e?Es:Wr(t)),n=[];return ds(i,function(t){!Fr(Cs,t)||e&&!Fr(vs,t)||n.push(Cs[t])}),n};Rr||(is((ys=function(){if(this instanceof ys)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?Ur(arguments[0]):void 0,e=rs(t),i=function(t){this===vs&&i.call(Es,t),Fr(this,us)&&Fr(this[us],e)&&(this[us][e]=!1),Ps(this,e,Yr(1,t))};return Nr&&Is&&Ps(vs,e,{configurable:!0,set:i}),Ms(e,t)}).prototype,"toString",function(){return ms(this).tag}),is(ys,"withoutSetter",function(t){return Ms(rs(t),t)}),ts.f=Rs,Jr.f=Ds,Qr.f=zs,$r.f=Xr.f=Fs,Kr.f=Ls,as.f=function(t){return Ms(ss(t),t)},Nr&&ks(ys.prototype,"description",{configurable:!0,get:function(){return ms(this).description}})),Pr({global:!0,wrap:!0,forced:!Rr,sham:!Rr},{Symbol:ys}),ds(Zr(As),function(t){ls(t)}),Pr({target:fs,stat:!0,forced:!Rr},{for:function(t){var e=Ur(t);if(Fr(Ts,e))return Ts[e];var i=ys(e);return Ts[e]=i,Ss[i]=e,i},keyFor:function(t){if(!jr(t))throw TypeError(t+" is not a symbol");if(Fr(Ss,t))return Ss[t]},useSetter:function(){Is=!0},useSimple:function(){Is=!1}}),Pr({target:"Object",stat:!0,forced:!Rr,sham:!Nr},{create:function(t,e){return void 0===e?Gr(t):Ns(Gr(t),e)},defineProperty:Ds,defineProperties:Ns,getOwnPropertyDescriptor:zs}),Pr({target:"Object",stat:!0,forced:!Rr},{getOwnPropertyNames:Fs,getOwnPropertySymbols:Ls}),Pr({target:"Object",stat:!0,forced:zr(function(){Kr.f(1)})},{getOwnPropertySymbols:function(t){return Kr.f(Hr(t))}}),bs&&Pr({target:"JSON",stat:!0,forced:!Rr||zr(function(){var t=ys();return"[null]"!=bs([t])||"{}"!=bs({a:t})||"{}"!=bs(Object(t))})},{stringify:function(t,e,i){for(var n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e,(Br(e)||void 0!==t)&&!jr(t))return Lr(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!jr(e))return e}),o[1]=e,bs.apply(null,o)}}),ys.prototype[ps]||es(ys.prototype,ps,ys.prototype.valueOf),cs(ys,fs),os[us]=!0;var Bs=E.Object.getOwnPropertySymbols,js={exports:{}},Vs=oe,Hs=x,Ws=r.f,qs=a,Us=s(function(){Ws(1)});Vs({target:"Object",stat:!0,forced:!qs||Us,sham:!qs},{getOwnPropertyDescriptor:function(t,e){return Ws(Hs(t),e)}});var Ys=E.Object,Gs=js.exports=function(t,e){return Ys.getOwnPropertyDescriptor(t,e)};Ys.getOwnPropertyDescriptor.sham&&(Gs.sham=!0);var Zs=js.exports,$s=Zs,Xs=rr,Ks=Ie,Qs=Ht,Js=O("Reflect","ownKeys")||function(t){var e=Xs.f(Qs(t)),i=Ks.f;return i?e.concat(i(t)):e},ta=Js,ea=x,ia=r,na=xo;oe({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(t){for(var e,i,n=ea(t),o=ia.f,r=ta(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&na(s,e,i);return s}});var oa=E.Object.getOwnPropertyDescriptors,ra={exports:{}};oe({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperties:on});var sa=E.Object,aa=ra.exports=function(t,e){return sa.defineProperties(t,e)};sa.defineProperties.sham&&(aa.sham=!0);var la=ra.exports,ca={exports:{}};oe({target:"Object",stat:!0,forced:!a,sham:!a},{defineProperty:jt.f});var ha=E.Object,da=ca.exports=function(t,e,i){return ha.defineProperty(t,e,i)};ha.defineProperty.sham&&(da.sham=!0);var ua=ca.exports,fa=ua;function pa(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ga=ua;function ma(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),ga(t,n.key,n)}}function va(t,e,i){return e&&ma(t.prototype,e),i&&ma(t,i),t}function ya(t,e,i){return e in t?ga(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}oe({target:"Array",stat:!0},{isArray:or});var ba=E.Array.isArray,wa=ba,ka=s,_a=z,xa=ht("species"),Ca=function(t){return _a>=51||!ka(function(){var e=[];return(e.constructor={})[xa]=function(){return{foo:1}},1!==e[t](Boolean).foo})},Ea=oe,Ta=s,Sa=or,Aa=C,Oa=$,Ia=he,Pa=xo,Ma=_r,Da=Ca,Na=z,Ra=ht("isConcatSpreadable"),za=9007199254740991,Fa="Maximum allowed index exceeded",La=Na>=51||!Ta(function(){var t=[];return t[Ra]=!1,t.concat()[0]!==t}),Ba=Da("concat"),ja=function(t){if(!Aa(t))return!1;var e=t[Ra];return void 0!==e?!!e:Sa(t)};Ea({target:"Array",proto:!0,forced:!La||!Ba},{concat:function(t){var e,i,n,o,r,s=Oa(this),a=Ma(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(ja(r=-1===e?s:arguments[e])){if(l+(o=Ia(r.length))>za)throw TypeError(Fa);for(i=0;i<o;i++,l++)i in r&&Pa(a,l,r[i])}else{if(l>=za)throw TypeError(Fa);Pa(a,l++,r)}return a.length=l,a}}),yr("asyncIterator"),yr("hasInstance"),yr("isConcatSpreadable"),yr("iterator"),yr("match"),yr("matchAll"),yr("replace"),yr("search"),yr("species"),yr("split"),yr("toPrimitive"),yr("toStringTag"),yr("unscopables"),Mn(o.JSON,"JSON",!0);var Va=E.Symbol;yr("asyncDispose"),yr("dispose"),yr("matcher"),yr("metadata"),yr("observable"),yr("patternMatch"),yr("replaceAll");var Ha=Va,Wa=oe,qa=C,Ua=or,Ya=pe,Ga=he,Za=x,$a=xo,Xa=ht,Ka=Ca("slice"),Qa=Xa("species"),Ja=[].slice,tl=Math.max;Wa({target:"Array",proto:!0,forced:!Ka},{slice:function(t,e){var i,n,o,r=Za(this),s=Ga(r.length),a=Ya(t,s),l=Ya(void 0===e?s:e,s);if(Ua(r)&&("function"!=typeof(i=r.constructor)||i!==Array&&!Ua(i.prototype)?qa(i)&&null===(i=i[Qa])&&(i=void 0):i=void 0,i===Array||void 0===i))return Ja.call(r,a,l);for(n=new(void 0===i?Array:i)(tl(l-a,0)),o=0;a<l;a++,o++)a in r&&$a(n,o,r[a]);return n.length=o,n}});var el=Ze("Array").slice,il=Array.prototype,nl=function(t){var e=t.slice;return t===il||t instanceof Array&&e===il.slice?el:e},ol=nl,rl=Bo;function sl(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function al(t,e){var i;if(t){if("string"==typeof t)return sl(t,e);var n=ol(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?rl(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sl(t,e):void 0}}function ll(t,e){return function(t){if(wa(t))return t}(t)||function(t,e){var i=null==t?null:void 0!==Ha&&ir(t)||t["@@iterator"];if(null!=i){var n,o,r=[],s=!0,a=!1;try{for(i=i.call(t);!(s=(n=i.next()).done)&&(r.push(n.value),!e||r.length!==e);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==i.return||i.return()}finally{if(a)throw o}}return r}}(t,e)||al(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var cl=fr.f("iterator");function hl(t){return(hl="function"==typeof Ha&&"symbol"==typeof cl?function(t){return typeof t}:function(t){return t&&"function"==typeof Ha&&t.constructor===Ha&&t!==Ha.prototype?"symbol":typeof t})(t)}function dl(t){return function(t){if(wa(t))return sl(t)}(t)||function(t){if(void 0!==Ha&&null!=ir(t)||null!=t["@@iterator"])return rl(t)}(t)||al(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var ul=Va,fl=Ze("Array").concat,pl=Array.prototype,gl=function(t){var e=t.concat;return t===pl||t instanceof Array&&e===pl.concat?fl:e},ml=nl;oe({target:"Reflect",stat:!0},{ownKeys:Js});var vl=ba,yl=Ir.map;oe({target:"Array",proto:!0,forced:!Ca("map")},{map:function(t){return yl(this,t,arguments.length>1?arguments[1]:void 0)}});var bl=Ze("Array").map,wl=Array.prototype,kl=function(t){var e=t.map;return t===wl||t instanceof Array&&e===wl.map?bl:e},_l=$,xl=Oe;oe({target:"Object",stat:!0,forced:s(function(){xl(1)})},{keys:function(t){return xl(_l(t))}});var Cl=E.Object.keys;oe({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var El=E.Date.now,Tl=s,Sl=function(t,e){var i=[][t];return!!i&&Tl(function(){i.call(null,e||function(){throw 1},1)})},Al=Ir.forEach,Ol=Sl("forEach")?[].forEach:function(t){return Al(this,t,arguments.length>1?arguments[1]:void 0)};oe({target:"Array",proto:!0,forced:[].forEach!=Ol},{forEach:Ol});var Il=Ze("Array").forEach,Pl=Cn,Ml=Array.prototype,Dl={DOMTokenList:!0,NodeList:!0},Nl=function(t){var e=t.forEach;return t===Ml||t instanceof Array&&e===Ml.forEach||Dl.hasOwnProperty(Pl(t))?Il:e},Rl=or,zl=[].reverse,Fl=[1,2];oe({target:"Array",proto:!0,forced:String(Fl)===String(Fl.reverse())},{reverse:function(){return Rl(this)&&(this.length=this.length),zl.call(this)}});var Ll=Ze("Array").reverse,Bl=Array.prototype,jl=function(t){var e=t.reverse;return t===Bl||t instanceof Array&&e===Bl.reverse?Ll:e},Vl=oe,Hl=pe,Wl=ae,ql=he,Ul=$,Yl=_r,Gl=xo,Zl=Ca("splice"),$l=Math.max,Xl=Math.min,Kl=9007199254740991,Ql="Maximum allowed length exceeded";Vl({target:"Array",proto:!0,forced:!Zl},{splice:function(t,e){var i,n,o,r,s,a,l=Ul(this),c=ql(l.length),h=Hl(t,c),d=arguments.length;if(0===d?i=n=0:1===d?(i=0,n=c-h):(i=d-2,n=Xl($l(Wl(e),0),c-h)),c+i-n>Kl)throw TypeError(Ql);for(o=Yl(l,n),r=0;r<n;r++)(s=h+r)in l&&Gl(o,r,l[s]);if(o.length=n,i<n){for(r=h;r<c-n;r++)a=r+i,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=c;r>c-n+i;r--)delete l[r-1]}else if(i>n)for(r=c-n;r>h;r--)a=r+i-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<i;r++)l[r+h]=arguments[r+2];return l.length=c-n+i,o}});var Jl=Ze("Array").splice,tc=Array.prototype,ec=function(t){var e=t.splice;return t===tc||t instanceof Array&&e===tc.splice?Jl:e},ic=be.includes;oe({target:"Array",proto:!0},{includes:function(t){return ic(this,t,arguments.length>1?arguments[1]:void 0)}});var nc=Ze("Array").includes,oc=C,rc=m,sc=ht("match"),ac=ht("match"),lc=function(t){if(function(t){var e;return oc(t)&&(void 0!==(e=t[sc])?!!e:"RegExp"==rc(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},cc=w,hc=ai;oe({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[ac]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~hc(cc(this)).indexOf(hc(lc(t)),arguments.length>1?arguments[1]:void 0)}});var dc=Ze("String").includes,uc=nc,fc=dc,pc=Array.prototype,gc=String.prototype,mc=function(t){var e=t.includes;return t===pc||t instanceof Array&&e===pc.includes?uc:"string"==typeof t||t===gc||t instanceof String&&e===gc.includes?fc:e},vc=$,yc=qi,bc=Li;oe({target:"Object",stat:!0,forced:s(function(){yc(1)}),sham:!bc},{getPrototypeOf:function(t){return yc(vc(t))}});var wc=E.Object.getPrototypeOf,kc=wc,_c=Ir.filter;oe({target:"Array",proto:!0,forced:!Ca("filter")},{filter:function(t){return _c(this,t,arguments.length>1?arguments[1]:void 0)}});var xc=Ze("Array").filter,Cc=Array.prototype,Ec=function(t){var e=t.filter;return t===Cc||t instanceof Array&&e===Cc.filter?xc:e},Tc=a,Sc=Oe,Ac=x,Oc=l.f,Ic=function(t){return function(e){for(var i,n=Ac(e),o=Sc(n),r=o.length,s=0,a=[];r>s;)i=o[s++],Tc&&!Oc.call(n,i)||a.push(t?[i,n[i]]:n[i]);return a}},Pc=(Ic(!0),Ic(!1));oe({target:"Object",stat:!0},{values:function(t){return Pc(t)}});var Mc="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",Dc=w,Nc=ai,Rc="[\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]",zc=RegExp("^"+Rc+Rc+"*"),Fc=RegExp(Rc+Rc+"*$"),Lc=function(t){return function(e){var i=Nc(Dc(e));return 1&t&&(i=i.replace(zc,"")),2&t&&(i=i.replace(Fc,"")),i}},Bc={start:Lc(1),end:Lc(2),trim:Lc(3)},jc=ai,Vc=Bc.trim,Hc=Mc,Wc=o.parseInt,qc=/^[+-]?0[Xx]/,Uc=8!==Wc(Hc+"08")||22!==Wc(Hc+"0x16")?function(t,e){var i=Vc(jc(t));return Wc(i,e>>>0||(qc.test(i)?16:10))}:Wc;oe({global:!0,forced:parseInt!=Uc},{parseInt:Uc});var Yc=E.parseInt,Gc=oe,Zc=be.indexOf,$c=Sl,Xc=[].indexOf,Kc=!!Xc&&1/[1].indexOf(1,-0)<0,Qc=$c("indexOf");Gc({target:"Array",proto:!0,forced:Kc||!Qc},{indexOf:function(t){return Kc?Xc.apply(this,arguments)||0:Zc(this,t,arguments.length>1?arguments[1]:void 0)}});var Jc=Ze("Array").indexOf,th=Array.prototype,eh=function(t){var e=t.indexOf;return t===th||t instanceof Array&&e===th.indexOf?Jc:e},ih=s,nh=Mc,oh=Bc.trim;oe({target:"String",proto:!0,forced:function(t){return ih(function(){return!!nh[t]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[t]()||nh[t].name!==t})}("trim")},{trim:function(){return oh(this)}}),Ze("String"),oe({target:"Object",stat:!0,sham:!a},{create:vn});var rh=E.Object,sh=function(t,e){return rh.create(t,e)},ah=sh,lh=oe,ch=s,hh=O("JSON","stringify"),dh=/[\uD800-\uDFFF]/g,uh=/^[\uD800-\uDBFF]$/,fh=/^[\uDC00-\uDFFF]$/,ph=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return uh.test(t)&&!fh.test(o)||fh.test(t)&&!uh.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},gh=ch(function(){return'"\\udf06\\ud834"'!==hh("\udf06\ud834")||'"\\udead"'!==hh("\udead")});hh&&lh({target:"JSON",stat:!0,forced:gh},{stringify:function(t,e,i){var n=hh.apply(null,arguments);return"string"==typeof n?n.replace(dh,ph):n}});var mh=E;mh.JSON||(mh.JSON={stringify:JSON.stringify});var vh=function(t,e,i){return mh.JSON.stringify.apply(null,arguments)},yh=o,bh=[].slice,wh=function(t){return function(e,i){var n=arguments.length>2,o=n?bh.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,i)}};oe({global:!0,bind:!0,forced:/MSIE .\./.test(I)},{setTimeout:wh(yh.setTimeout),setInterval:wh(yh.setInterval)});var kh=E.setTimeout,_h=$,xh=pe,Ch=he;oe({target:"Array",proto:!0},{fill:function(t){for(var e=_h(this),i=Ch(e.length),n=arguments.length,o=xh(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:xh(r,i);s>o;)e[o++]=t;return e}});var Eh=Ze("Array").fill,Th=Array.prototype,Sh=function(t){var e=t.fill;return t===Th||t instanceof Array&&e===Th.fill?Eh:e};function Ah(){return(Ah=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function Oh(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function Ih(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Ph,Mh="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,Dh=["","webkit","Moz","MS","ms","o"],Nh="undefined"==typeof document?{style:{}}:document.createElement("div"),Rh=Math.round,zh=Math.abs,Fh=Date.now;function Lh(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<Dh.length;){if((n=(i=Dh[r])?i+o:e)in t)return n;r++}}Ph="undefined"==typeof window?{}:window;var Bh=Lh(Nh.style,"touchAction"),jh=void 0!==Bh,Vh="compute",Hh="auto",Wh="manipulation",qh="none",Uh="pan-x",Yh="pan-y",Gh=function(){if(!jh)return!1;var t={},e=Ph.CSS&&Ph.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||Ph.CSS.supports("touch-action",i)}),t}(),Zh="ontouchstart"in Ph,$h=void 0!==Lh(Ph,"PointerEvent"),Xh=Zh&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Kh="touch",Qh="mouse",Jh=["x","y"],td=["clientX","clientY"];function ed(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function id(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function nd(t,e){return t.indexOf(e)>-1}var od=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===Vh&&(t=this.compute()),jh&&this.manager.element.style&&Gh[t]&&(this.manager.element.style[Bh]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return ed(this.manager.recognizers,function(e){id(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(nd(t,qh))return qh;var e=nd(t,Uh),i=nd(t,Yh);return e&&i?qh:e||i?e?Uh:Yh:nd(t,Wh)?Wh:Hh}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,o=nd(n,qh)&&!Gh.none,r=nd(n,Yh)&&!Gh["pan-y"],s=nd(n,Uh)&&!Gh["pan-x"];if(o&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!s||!r)return o||r&&6&i||s&&24&i?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function rd(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function sd(t){var e=t.length;if(1===e)return{x:Rh(t[0].clientX),y:Rh(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:Rh(i/e),y:Rh(n/e)}}function ad(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:Rh(t.pointers[i].clientX),clientY:Rh(t.pointers[i].clientY)},i++;return{timeStamp:Fh(),pointers:e,center:sd(e),deltaX:t.deltaX,deltaY:t.deltaY}}function ld(t,e,i){i||(i=Jh);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function cd(t,e,i){return i||(i=Jh),180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function hd(t,e){return t===e?1:zh(t)>=zh(e)?t<0?2:4:e<0?8:16}function dd(t,e,i){return{x:e/t||0,y:i/t||0}}function ud(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=1&e&&n-o==0,s=12&e&&n-o==0;i.isFirst=!!r,i.isFinal=!!s,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=ad(e)),o>1&&!i.firstMultiple?i.firstMultiple=ad(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,a=s?s.center:r.center,l=e.center=sd(n);e.timeStamp=Fh(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=cd(a,l),e.distance=ld(a,l),function(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}(i,e),e.offsetDirection=hd(e.deltaX,e.deltaY);var c,h,d=dd(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=zh(d.x)>zh(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,ld((h=n)[0],h[1],td)/ld(c[0],c[1],td)):1,e.rotation=s?function(t,e){return cd(e[1],e[0],td)+cd(t[1],t[0],td)}(s.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=dd(a,l,c);n=h.x,o=h.y,i=zh(h.x)>zh(h.y)?h.x:h.y,r=hd(l,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(i,e);var u,f=t.element,p=e.srcEvent;rd(u=p.composedPath?p.composedPath()[0]:p.path?p.path[0]:p.target,f)&&(f=u),e.target=f}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function fd(t){return t.trim().split(/\s+/g)}function pd(t,e,i){ed(fd(e),function(e){t.addEventListener(e,i,!1)})}function gd(t,e,i){ed(fd(e),function(e){t.removeEventListener(e,i,!1)})}function md(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var vd=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){id(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&pd(this.element,this.evEl,this.domHandler),this.evTarget&&pd(this.target,this.evTarget,this.domHandler),this.evWin&&pd(md(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&gd(this.element,this.evEl,this.domHandler),this.evTarget&&gd(this.target,this.evTarget,this.domHandler),this.evWin&&gd(md(this.element),this.evWin,this.domHandler)},t}();function yd(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}var bd={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},wd={2:Kh,3:"pen",4:Qh,5:"kinect"},kd="pointerdown",_d="pointermove pointerup pointercancel";Ph.MSPointerEvent&&!Ph.PointerEvent&&(kd="MSPointerDown",_d="MSPointerMove MSPointerUp MSPointerCancel");var xd=function(t){function e(){var i,n=e.prototype;return n.evEl=kd,n.evWin=_d,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return Oh(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=bd[n],r=wd[t.pointerType]||t.pointerType,s=r===Kh,a=yd(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))},e}(vd);function Cd(t){return Array.prototype.slice.call(t,0)}function Ed(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];yd(o,s)<0&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var Td={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Sd="touchstart touchmove touchend touchcancel",Ad=function(t){function e(){var i;return e.prototype.evTarget=Sd,(i=t.apply(this,arguments)||this).targetIds={},i}return Oh(e,t),e.prototype.handler=function(t){var e=Td[t.type],i=Od.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Kh,srcEvent:t})},e}(vd);function Od(t,e){var i,n,o=Cd(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=Cd(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return rd(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[Ed(n.concat(a),"identifier",!0),a]:void 0}var Id={mousedown:1,mousemove:2,mouseup:4},Pd="mousedown",Md="mousemove mouseup",Dd=function(t){function e(){var i,n=e.prototype;return n.evEl=Pd,n.evWin=Md,(i=t.apply(this,arguments)||this).pressed=!1,i}return Oh(e,t),e.prototype.handler=function(t){var e=Id[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Qh,srcEvent:t}))},e}(vd);function Nd(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function Rd(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,Nd.call(this,e)):12&t&&Nd.call(this,e)}function zd(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var Fd=function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o=i.pointerType===Qh;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(i.pointerType===Kh)Rd.call(Ih(Ih(n)),e,i);else if(o&&zd.call(Ih(Ih(n)),i))return;n.callback(t,e,i)}},n.touch=new Ad(n.manager,n.handler),n.mouse=new Dd(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return Oh(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(vd);function Ld(t,e,i){return!!Array.isArray(t)&&(ed(t,i[e],i),!0)}var Bd=32,jd=1;function Vd(t,e){var i=e.manager;return i?i.get(t):t}function Hd(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var Wd=function(){function t(t){void 0===t&&(t={}),this.options=Ah({enable:!0},t),this.id=jd++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return Mh(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(Ld(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Vd(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return Ld(t,"dropRecognizeWith",this)||(t=Vd(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(Ld(t,"requireFailure",this))return this;var e=this.requireFail;return-1===yd(e,t=Vd(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(Ld(t,"dropRequireFailure",this))return this;t=Vd(t,this);var e=yd(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+Hd(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+Hd(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=Bd},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=Mh({},t);if(!id(this.options.enable,[this,e]))return this.reset(),void(this.state=Bd);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),qd=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ah({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Wh]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||ld(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return Bd},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=Bd},this.options.interval),Bd},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(Wd),Ud=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ah({pointers:1},e))||this}Oh(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:Bd},e}(Wd);function Yd(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var Gd=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ah({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(Yh),24&t&&e.push(Uh),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return Ud.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=Yd(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(Ud),Zd=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ah({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){return Gd.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&zh(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=Yd(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(Ud),$d=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ah({event:"pinch",threshold:0,pointers:2},e))||this}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){return[qh]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),t.prototype.emit.call(this,e)},e}(Ud),Xd=function(t){function e(e){return void 0===e&&(e={}),t.call(this,Ah({event:"rotate",threshold:0,pointers:2},e))||this}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){return[qh]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(Ud),Kd=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,Ah({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}Oh(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Hh]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,!o||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8;return Bd},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=Fh(),this.manager.emit(this.options.event,this._input)))},e}(Wd),Qd={domEvents:!1,touchAction:Vh,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Jd=[[Xd,{enable:!1}],[$d,{enable:!1},["rotate"]],[Zd,{direction:6}],[Gd,{direction:6},["swipe"]],[qd],[qd,{event:"doubletap",taps:2},["tap"]],[Kd]];function tu(t,e){var i,n=t.element;n.style&&(ed(t.options.cssProps,function(o,r){i=Lh(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var eu=function(){function t(t,e){var i=this;this.options=Mh({},Qd,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||($h?xd:Xh?Ad:Zh?Fd:Dd))(this,ud),this.touchAction=new od(this,this.options.touchAction),tu(this,!0),ed(this.options.recognizers,function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return Mh(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(e.curRecognizer=null,o=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||o&&i!==o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&14&i.state&&(e.curRecognizer=i,o=i),r++}},e.get=function(t){if(t instanceof Wd)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(Ld(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(Ld(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=yd(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return ed(fd(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return ed(fd(t),function(t){e?i[t]&&i[t].splice(yd(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},e.destroy=function(){this.element&&tu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),iu={touchstart:1,touchmove:2,touchend:4,touchcancel:8},nu="touchstart",ou="touchstart touchmove touchend touchcancel",ru=function(t){function e(){var i,n=e.prototype;return n.evTarget=nu,n.evWin=ou,(i=t.apply(this,arguments)||this).started=!1,i}return Oh(e,t),e.prototype.handler=function(t){var e=iu[t.type];if(1===e&&(this.started=!0),this.started){var i=su.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Kh,srcEvent:t})}},e}(vd);function su(t,e){var i=Cd(t.touches),n=Cd(t.changedTouches);return 12&e&&(i=Ed(i.concat(n),"identifier",!0)),[i,n]}function au(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var lu=au(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),cu=au(function(t,e){return lu(t,e,!0)},"merge","Use `assign`.");function hu(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&Mh(n,i)}function du(t,e){return function(){return t.apply(e,arguments)}}var uu=function(){var t=function(t,e){return void 0===e&&(e={}),new eu(t,Ah({recognizers:Jd.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=16,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=24,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=16,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=Bd,t.Manager=eu,t.Input=vd,t.TouchAction=od,t.TouchInput=Ad,t.MouseInput=Dd,t.PointerEventInput=xd,t.TouchMouseInput=Fd,t.SingleTouchInput=ru,t.Recognizer=Wd,t.AttrRecognizer=Ud,t.Tap=qd,t.Pan=Gd,t.Swipe=Zd,t.Pinch=$d,t.Rotate=Xd,t.Press=Kd,t.on=pd,t.off=gd,t.each=ed,t.merge=cu,t.extend=lu,t.bindFn=du,t.assign=Mh,t.inherit=hu,t.bindFn=du,t.prefixed=Lh,t.toArray=Cd,t.inArray=yd,t.uniqueArray=Ed,t.splitStr=fd,t.boolOrFn=id,t.hasParent=rd,t.addEventListeners=pd,t.removeEventListeners=gd,t.defaults=Mh({},Qd,{preset:Jd}),t}();function fu(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return pu(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pu(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function pu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function gu(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return mu(e.length?e:[El()])}function mu(t){var e=ll(function(){for(var t=vu(),e=t(" "),i=t(" "),n=t(" "),o=0;o<arguments.length;o++)(e-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(e+=1),(i-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(i+=1),(n-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(n+=1);return[e,i,n]}(t),3),i=e[0],n=e[1],o=e[2],r=1,s=function(){var t=2091639*i+2.3283064365386963e-10*r;return i=n,n=o,o=t-(r=0|t)};return s.uint32=function(){return 4294967296*s()},s.fract53=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.algorithm="Alea",s.seed=t,s.version="0.9",s}function vu(){var t=4022871197;return function(e){for(var i=e.toString(),n=0;n<i.length;n++){var o=.02519603282416938*(t+=i.charCodeAt(n));o-=t=o>>>0,t=(o*=t)>>>0,t+=4294967296*(o-=t)}return 2.3283064365386963e-10*(t>>>0)}}ul("DELETE");var yu="undefined"!=typeof window?window.Hammer||uu:function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(){return{set:t}}};var t};function bu(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)});var n=yu(this._dom.overlay);n.on("tap",Ke(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){n.destroy()});var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Nl(o).call(o,function(t){n.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",i._onClick)})),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}ri(bu.prototype),bu.current=null,bu.prototype.destroy=function(){var t,e;this.deactivate();var i,n=fu(jl(t=ec(e=this._cleanupQueue).call(e,0)).call(t));try{for(n.s();!(i=n.n()).done;)(0,i.value)()}catch(t){n.e(t)}finally{n.f()}},bu.prototype.activate=function(){bu.current&&bu.current.deactivate(),bu.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},bu.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},bu.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var wu=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ku=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,_u=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,xu=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function Cu(t){if(t)for(;!0===t.hasChildNodes();){var e=t.firstChild;e&&(Cu(e),t.removeChild(e))}}function Eu(t){return t instanceof String||"string"==typeof t}function Tu(t){return"object"===hl(t)&&null!==t}function Su(t,e,i,n){var o=!1;!0===n&&(o=null===e[i]&&void 0!==t[i]),o?delete t[i]:t[i]=e[i]}function Au(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var n in t)if(void 0!==e[n])if(null===e[n]||"object"!==hl(e[n]))Su(t,e,n,i);else{var o=t[n],r=e[n];Tu(o)&&Tu(r)&&Au(o,r,i)}}function Ou(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(vl(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o=0;o<t.length;o++){var r=t[o];if(Object.prototype.hasOwnProperty.call(i,r))if(i[r]&&i[r].constructor===Object)void 0===e[r]&&(e[r]={}),e[r].constructor===Object?Pu(e[r],i[r],!1,n):Su(e,i,r,n);else{if(vl(i[r]))throw new TypeError("Arrays are not supported by deepExtend");Su(e,i,r,n)}}return e}function Iu(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(vl(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)&&!mc(t).call(t,o))if(i[o]&&i[o].constructor===Object)void 0===e[o]&&(e[o]={}),e[o].constructor===Object?Pu(e[o],i[o]):Su(e,i,o,n);else if(vl(i[o])){e[o]=[];for(var r=0;r<i[o].length;r++)e[o].push(i[o][r])}else Su(e,i,o,n);return e}function Pu(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)||!0===i)if("object"===hl(e[o])&&null!==e[o]&&kc(e[o])===Object.prototype)void 0===t[o]?t[o]=Pu({},e[o],i):"object"===hl(t[o])&&null!==t[o]&&kc(t[o])===Object.prototype?Pu(t[o],e[o],i):Su(t,e,o,n);else if(vl(e[o])){var r;t[o]=ml(r=e[o]).call(r)}else Su(t,e,o,n);return t}function Mu(t,e){var i;return gl(i=[]).call(i,dl(t),[e])}function Du(t){return ml(t).call(t)}function Nu(t){return t.getBoundingClientRect().top}function Ru(t,e){if(vl(t))for(var i=t.length,n=0;n<i;n++)e(t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e(t[o],o,t)}function zu(t){var e;switch(t.length){case 3:case 4:return(e=ku.exec(t))?{r:Yc(e[1]+e[1],16),g:Yc(e[2]+e[2],16),b:Yc(e[3]+e[3],16)}:null;case 6:case 7:return(e=wu.exec(t))?{r:Yc(e[1],16),g:Yc(e[2],16),b:Yc(e[3],16)}:null;default:return null}}function Fu(t,e){if(mc(t).call(t,"rgba"))return t;if(mc(t).call(t,"rgb")){var i=t.substr(eh(t).call(t,"(")+1).replace(")","").split(",");return"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"}var n=zu(t);return null==n?t:"rgba("+n.r+","+n.g+","+n.b+","+e+")"}function Lu(t,e,i){var n;return"#"+ml(n=((1<<24)+(t<<16)+(e<<8)+i).toString(16)).call(n,1)}function Bu(t,e){if(Eu(t)){var i=t;if(qu(i)){var n,o=kl(n=i.substr(4).substr(0,i.length-5).split(",")).call(n,function(t){return Yc(t)});i=Lu(o[0],o[1],o[2])}if(!0===Wu(i)){var r=function(t){var e=zu(t);if(!e)throw new TypeError("'".concat(t,"' is not a valid color."));return ju(e.r,e.g,e.b)}(i),s={h:r.h,s:.8*r.s,v:Math.min(1,1.02*r.v)},a={h:r.h,s:Math.min(1,1.25*r.s),v:.8*r.v},l=Hu(a.h,a.s,a.v),c=Hu(s.h,s.s,s.v);return{background:i,border:l,highlight:{background:c,border:l},hover:{background:c,border:l}}}return{background:i,border:i,highlight:{background:i,border:i},hover:{background:i,border:i}}}return e?{background:t.background||e.background,border:t.border||e.border,highlight:Eu(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||e.highlight.background,border:t.highlight&&t.highlight.border||e.highlight.border},hover:Eu(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||e.hover.border,background:t.hover&&t.hover.background||e.hover.background}}:{background:t.background||void 0,border:t.border||void 0,highlight:Eu(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||void 0,border:t.highlight&&t.highlight.border||void 0},hover:Eu(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||void 0,background:t.hover&&t.hover.background||void 0}}}function ju(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,Math.min(e,i)),o=Math.max(t,Math.max(e,i));return n===o?{h:0,s:0,v:n}:{h:60*((t===n?3:i===n?1:5)-(t===n?e-i:i===n?t-e:i-t)/(o-n))/360,s:(o-n)/o,v:o}}function Vu(t,e,i){var n,o,r,s=Math.floor(6*t),a=6*t-s,l=i*(1-e),c=i*(1-a*e),h=i*(1-(1-a)*e);switch(s%6){case 0:n=i,o=h,r=l;break;case 1:n=c,o=i,r=l;break;case 2:n=l,o=i,r=h;break;case 3:n=l,o=c,r=i;break;case 4:n=h,o=l,r=i;break;case 5:n=i,o=l,r=c}return{r:Math.floor(255*n),g:Math.floor(255*o),b:Math.floor(255*r)}}function Hu(t,e,i){var n=Vu(t,e,i);return Lu(n.r,n.g,n.b)}function Wu(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}function qu(t){return _u.test(t)}function Uu(t){return xu.test(t)}function Yu(t){if(null===t||"object"!==hl(t))return null;if(t instanceof Element)return t;var e=ah(t);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&"object"==hl(t[i])&&(e[i]=Yu(t[i]));return e}function Gu(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=function(t){return null!=t},r=function(t){return null!==t&&"object"===hl(t)},s=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0};if(!r(t))throw new Error("Parameter mergeTarget must be an object");if(!r(e))throw new Error("Parameter options must be an object");if(!o(i))throw new Error("Parameter option must have a value");if(!r(n))throw new Error("Parameter globalOptions must be an object");var a=function(t,e,i){r(t[i])||(t[i]={});var n=e[i],o=t[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])},l=e[i],c=r(n)&&!s(n)?n[i]:void 0,h=c?c.enabled:void 0;if(void 0!==l){if("boolean"==typeof l)return r(t[i])||(t[i]={}),void(t[i].enabled=l);if(null===l&&!r(t[i])){if(!o(c))return;t[i]=ah(c)}if(r(l)){var d=!0;void 0!==l.enabled?d=l.enabled:void 0!==h&&(d=c.enabled),a(t,e,i),t[i].enabled=d}}}var Zu={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}};function $u(t,e){var i;vl(e)||(e=[e]);var n,o=fu(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r){i=r[e[0]];for(var s=1;s<e.length;s++)i&&(i=i[e[s]]);if(void 0!==i)break}}}catch(t){o.e(t)}finally{o.f()}return i}var Xu={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},Ku=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;pa(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return va(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=t}},{key:"setCloseCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=t}},{key:"_isColorString",value:function(t){if("string"==typeof t)return Xu[t]}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==t){var i,n=this._isColorString(t);if(void 0!==n&&(t=n),!0===Eu(t)){if(!0===qu(t)){var o=t.substr(4).substr(0,t.length-5).split(",");i={r:o[0],g:o[1],b:o[2],a:1}}else if(!0===Uu(t)){var r=t.substr(5).substr(0,t.length-6).split(",");i={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===Wu(t)){var s=zu(t);i={r:s.r,g:s.g,b:s.b,a:1}}}else t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&(i={r:t.r,g:t.g,b:t.b,a:void 0!==t.a?t.a:"1.0"});if(void 0===i)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+vh(t));this._setColor(i,e)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this;!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.previousColor=je({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",kh(function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){!0===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.initialColor=je({},t)),this.color=t;var e=ju(t.r,t.g,t.b),i=2*Math.PI,n=this.r*e.s,o=this.centerCoordinates.x+n*Math.sin(i*e.h),r=this.centerCoordinates.y+n*Math.cos(i*e.h);this.colorPickerSelector.style.left=o-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=r-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=ju(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=Vu(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=ju(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),i.clearRect(0,0,this.colorPickerCanvas.clientWidth,this.colorPickerCanvas.clientHeight),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),Sh(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var t,e,i,n;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var o=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=Ke(t=this._hide).call(t,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=Ke(e=this._apply).call(e,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=Ke(i=this._save).call(i,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=Ke(n=this._loadLast).call(n,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new yu(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",function(e){e.isFirst&&t._moveSelector(e)}),this.hammer.on("tap",function(e){t._moveSelector(e)}),this.hammer.on("panstart",function(e){t._moveSelector(e)}),this.hammer.on("panmove",function(e){t._moveSelector(e)}),this.hammer.on("panend",function(e){t._moveSelector(e)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var e,i,n,o,r=this.colorPickerCanvas.clientWidth,s=this.colorPickerCanvas.clientHeight;t.clearRect(0,0,r,s),this.centerCoordinates={x:.5*r,y:.5*s},this.r=.49*r;var a,l=2*Math.PI/360,c=1/this.r;for(n=0;n<360;n++)for(o=0;o<this.r;o++)e=this.centerCoordinates.x+o*Math.sin(l*n),i=this.centerCoordinates.y+o*Math.cos(l*n),a=Vu(.002777777777777778*n,o*c,1),t.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",t.fillRect(e-.5,i-.5,2,2);t.strokeStyle="rgba(0,0,0,1)",t.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),t.stroke(),this.hueCircle=t.getImageData(0,0,r,s)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=.5*this.colorPickerDiv.clientHeight,n=.5*this.colorPickerDiv.clientWidth,o=t.center.x-e.left-n,r=t.center.y-e.top-i,s=Math.atan2(o,r),a=.98*Math.min(Math.sqrt(o*o+r*r),n),l=Math.cos(s)*a+i,c=Math.sin(s)*a+n;this.colorPickerSelector.style.top=l-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=c-.5*this.colorPickerSelector.clientWidth+"px";var h=s/(2*Math.PI);h=h<0?h+1:h;var d=a/this.r,u=ju(this.color.r,this.color.g,this.color.b);u.h=h,u.s=d;var f=Vu(u.h,u.s,u.v);f.a=this.color.a,this.color=f,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}();function Qu(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<1)throw new TypeError("Invalid arguments.");if(1===e.length)return document.createTextNode(e[0]);var n=document.createElement(e[0]);return n.appendChild(Qu.apply(void 0,dl(ml(e).call(e,1)))),n}var Ju,tf=!1,ef="background: #FFeeee; color: #dd0000",nf=bu,of=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!1};pa(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.hideOption=r,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},je(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new Ku(o),this.wrapper=void 0}return va(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(vl(t))this.options.filter=t.join();else if("object"===hl(t)){if(null==t)throw new TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==Ec(t)&&(this.options.filter=Ec(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===Ec(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=Ec(this.options),e=0,i=!1;for(var n in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,n)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):!0!==t&&-1===eh(t).call(t,n)||(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++){if(void 0===e[t[i]]){e=void 0;break}e=e[t[i]]}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Nl(n).call(n,function(t){e.appendChild(t)}),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerText=t,this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");if(n.className="vis-configuration vis-config-label vis-config-s"+e.length,!0===i){for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(Qu("i","b",t))}else n.innerText=t+":";return n}},{key:"_makeDropdown",value:function(t,e,i){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var o=0;void 0!==e&&-1!==eh(t).call(t,e)&&(o=eh(t).call(t,e));for(var r=0;r<t.length;r++){var s=document.createElement("option");s.value=t[r],r===o&&(s.selected="selected"),s.innerText=t[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,n)}},{key:"_makeRange",value:function(t,e,i){var n=t[0],o=t[1],r=t[2],s=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=o,a.max=r}catch(t){}a.step=s;var l="",c=0;if(void 0!==e){var h=1.2;e<0&&e*h<o?(a.min=Math.ceil(e*h),c=a.min,l="range increased"):e/h<o&&(a.min=Math.ceil(e/h),c=a.min,l="range increased"),e*h>r&&1!==r&&(a.max=Math.ceil(e*h),c=a.max,l="range increased"),a.value=e}else a.value=n;var d=document.createElement("input");d.className="vis-configuration vis-config-rangeinput",d.value=a.value;var u=this;a.onchange=function(){d.value=this.value,u._update(Number(this.value),i)},a.oninput=function(){d.value=this.value};var f=this._makeLabel(i[i.length-1],i),p=this._makeItem(i,f,a,d);""!==l&&this.popupHistory[p]!==c&&(this.popupHistory[p]=c,this._setupPopup(l,p))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerText="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerText=t,n.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=kh(function(){t.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=kh(function(){t._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=t,void 0!==e&&(n.checked=e,e!==t&&("object"===hl(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var o=this;n.onchange=function(){o._update(this.checked,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeTextInput",value:function(t,e,i){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var o=this;n.onchange=function(){o._update(this.value,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeColorField",value:function(t,e,i){var n=this,o=t[1],r=document.createElement("div");"none"!==(e=void 0===e?o:e)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=e):r.className="vis-configuration vis-config-colorBlock none",e=void 0===e?o:e,r.onclick=function(){n._showColorPicker(e,r,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,r)}},{key:"_showColorPicker",value:function(t,e,i){var n=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback(function(t){var o="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=o,n._update(o,i)}),this.colorPicker.setCloseCallback(function(){e.onclick=function(){n._showColorPicker(t,e,i)}})}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=Ec(this.options),r=!1;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){n=!0;var a=t[s],l=Mu(e,s);if("function"==typeof o&&!1===(n=o(s,e))&&!vl(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==n){r=!0;var c=this._getValue(l);if(vl(a))this._handleArray(a,c,l);else if("string"==typeof a)this._makeTextInput(a,c,l);else if("boolean"==typeof a)this._makeCheckbox(a,c,l);else if(a instanceof Object){if(!this.hideOption(e,s,this.moduleOptions))if(void 0!==a.enabled){var h=Mu(l,"enabled"),d=this._getValue(h);if(!0===d){var u=this._makeLabel(s,l,!0);this._makeItem(l,u),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,d,l)}else{var f=this._makeLabel(s,l,!0);this._makeItem(l,f),r=this._handleObject(a,l)||r}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i;t="false"!==(t="true"===t||t)&&t;for(var o=0;o<e.length;o++)"global"!==e[o]&&(void 0===n[e[o]]&&(n[e[o]]={}),o!==e.length-1?n=n[e[o]]:n[e[o]]=t);return i}},{key:"_printOptions",value:function(){for(var t=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(Qu("pre","const options = "+vh(t,null,2)))}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),rf=yu,sf=function(){function t(e,i){pa(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return va(t,[{key:"setPosition",value:function(t,e){this.x=Yc(t),this.y=Yc(e)}},{key:"setText",value:function(t){if(t instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(t)}else this.frame.innerText=t}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-e<this.padding&&(l=!1),this.x+i>o-this.padding&&(a=!0),r=a?this.x-i:this.x,s=l?this.y-e:this.y}else(s=this.y-e)+e+this.padding>n&&(s=n-e-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+i+this.padding>o&&(r=o-i-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),af=ef,lf=function(){function t(){pa(this,t)}return va(t,null,[{key:"validate",value:function(e,i,n){tf=!1,Ju=i;var o=i;return void 0!==n&&(o=i[n]),t.parse(e,o,[]),tf}},{key:"parse",value:function(e,i,n){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.check(o,e,i,n)}},{key:"check",value:function(e,i,n,o){if(void 0!==n[e]||void 0!==n.__any__){var r=e,s=!0;void 0===n[e]&&void 0!==n.__any__&&(r="__any__",s="object"===t.getType(i[e]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,n,r,a,o)}else t.getSuggestion(e,n,o)}},{key:"checkFields",value:function(e,i,n,o,r,s){var a=function(i){console.error("%c"+i+t.printLocation(s,e),ef)},l=t.getType(i[e]),c=r[l];void 0!==c?"array"===t.getType(c)&&-1===eh(c).call(c,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(c)+' not "'+i[e]+'". '),tf=!0):"object"===l&&"__any__"!==o&&(s=Mu(s,e),t.parse(i[e],n[o],s)):void 0===r.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(Cl(r))+". Received ["+l+'] "'+i[e]+'"'),tf=!0)}},{key:"getType",value:function(t){var e=hl(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":vl(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,n){var o,r=t.findInOptions(e,i,n,!1),s=t.findInOptions(e,Ju,[],!0);o=void 0!==r.indexMatch?" in "+t.printLocation(r.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+t.printLocation(r.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+t.printLocation(r.path,e):". Did you mean one of these: "+t.print(Cl(i))+t.printLocation(n,e),console.error('%cUnknown option detected: "'+e+'"'+o,ef),tf=!0}},{key:"findInOptions",value:function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=e.toLowerCase(),c=void 0;for(var h in i){var d=void 0;if(void 0!==i[h].__type__&&!0===o){var u=t.findInOptions(e,i[h],Mu(n,h));r>u.distance&&(s=u.closestMatch,a=u.path,r=u.distance,c=u.indexMatch)}else{var f;-1!==eh(f=h.toLowerCase()).call(f,l)&&(c=h),r>(d=t.levenshteinDistance(e,h))&&(s=h,a=Du(n),r=d)}}return{closestMatch:s,path:a,distance:r,indexMatch:c}}},{key:"printLocation",value:function(t,e){for(var i="\n\n"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n")+"options = {\n",n=0;n<t.length;n++){for(var o=0;o<n+1;o++)i+="  ";i+=t[n]+": {\n"}for(var r=0;r<t.length+1;r++)i+="  ";i+=e+"\n";for(var s=0;s<t.length+1;s++){for(var a=0;a<t.length-s;a++)i+="  ";i+="}\n"}return i+"\n\n"}},{key:"print",value:function(t){return vh(t).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n,o=[];for(i=0;i<=e.length;i++)o[i]=[i];for(n=0;n<=t.length;n++)o[0][n]=n;for(i=1;i<=e.length;i++)for(n=1;n<=t.length;n++)o[i][n]=e.charAt(i-1)==t.charAt(n-1)?o[i-1][n-1]:Math.min(o[i-1][n-1]+1,Math.min(o[i][n-1]+1,o[i-1][n]+1));return o[e.length][t.length]}}]),t}();function cf(t){return pf=t,function(){var t={};if(gf=0,mf=pf.charAt(0),Sf(),"strict"===vf&&(t.strict=!0,Sf()),"graph"!==vf&&"digraph"!==vf||(t.type=vf,Sf()),yf===uf&&(t.id=vf,Sf()),"{"!=vf)throw Df("Angle bracket { expected");if(Sf(),Af(t),"}"!=vf)throw Df("Angle bracket } expected");if(Sf(),""!==vf)throw Df("End of file expected");return Sf(),delete t.node,delete t.edge,delete t.graph,t}()}var hf={fontsize:"font.size",fontcolor:"font.color",labelfontcolor:"font.color",fontname:"font.face",color:["color.border","color.background"],fillcolor:"color.background",tooltip:"title",labeltooltip:"title"},df=ah(hf);df.color="color.color",df.style="dashes";var uf=2,ff={"{":!0,"}":!0,"[":!0,"]":!0,";":!0,"=":!0,",":!0,"->":!0,"--":!0},pf="",gf=0,mf="",vf="",yf=0;function bf(){gf++,mf=pf.charAt(gf)}function wf(){return pf.charAt(gf+1)}function kf(t){var e=t.charCodeAt(0);return e<47?35===e||46===e:e<59?e>47:e<91?e>64:e<96?95===e:e<123&&e>96}function _f(t,e){if(t||(t={}),e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function xf(t,e,i){for(var n=e.split("."),o=t;n.length;){var r=n.shift();n.length?(o[r]||(o[r]={}),o=o[r]):o[r]=i}}function Cf(t,e){for(var i,n,o=null,r=[t],s=t;s.parent;)r.push(s.parent),s=s.parent;if(s.nodes)for(i=0,n=s.nodes.length;i<n;i++)if(e.id===s.nodes[i].id){o=s.nodes[i];break}for(o||(o={id:e.id},t.node&&(o.attr=_f(o.attr,t.node))),i=r.length-1;i>=0;i--){var a,l=r[i];l.nodes||(l.nodes=[]),-1===eh(a=l.nodes).call(a,o)&&l.nodes.push(o)}e.attr&&(o.attr=_f(o.attr,e.attr))}function Ef(t,e){if(t.edges||(t.edges=[]),t.edges.push(e),t.edge){var i=_f({},t.edge);e.attr=_f(i,e.attr)}}function Tf(t,e,i,n,o){var r={from:e,to:i,type:n};return t.edge&&(r.attr=_f({},t.edge)),r.attr=_f(r.attr||{},o),null!=o&&o.hasOwnProperty("arrows")&&null!=o.arrows&&(r.arrows={to:{enabled:!0,type:o.arrows.type}},o.arrows=null),r}function Sf(){for(yf=0,vf="";" "===mf||"\t"===mf||"\n"===mf||"\r"===mf;)bf();do{var t=!1;if("#"===mf){for(var e=gf-1;" "===pf.charAt(e)||"\t"===pf.charAt(e);)e--;if("\n"===pf.charAt(e)||""===pf.charAt(e)){for(;""!=mf&&"\n"!=mf;)bf();t=!0}}if("/"===mf&&"/"===wf()){for(;""!=mf&&"\n"!=mf;)bf();t=!0}if("/"===mf&&"*"===wf()){for(;""!=mf;){if("*"===mf&&"/"===wf()){bf(),bf();break}bf()}t=!0}for(;" "===mf||"\t"===mf||"\n"===mf||"\r"===mf;)bf()}while(t);if(""!==mf){var i=mf+wf();if(ff[i])return yf=1,vf=i,bf(),void bf();if(ff[mf])return yf=1,vf=mf,void bf();if(kf(mf)||"-"===mf){for(vf+=mf,bf();kf(mf);)vf+=mf,bf();return"false"===vf?vf=!1:"true"===vf?vf=!0:isNaN(Number(vf))||(vf=Number(vf)),void(yf=uf)}if('"'===mf){for(bf();""!=mf&&('"'!=mf||'"'===mf&&'"'===wf());)'"'===mf?(vf+=mf,bf()):"\\"===mf&&"n"===wf()?(vf+="\n",bf()):vf+=mf,bf();if('"'!=mf)throw Df('End of string " expected');return bf(),void(yf=uf)}for(yf=3;""!=mf;)vf+=mf,bf();throw new SyntaxError('Syntax error in part "'+Nf(vf,30)+'"')}yf=1}function Af(t){for(;""!==vf&&"}"!=vf;)Of(t),";"===vf&&Sf()}function Of(t){var e=If(t);if(e)Pf(t,e);else if(!function(t){return"node"===vf?(Sf(),t.node=Mf(),"node"):"edge"===vf?(Sf(),t.edge=Mf(),"edge"):"graph"===vf?(Sf(),t.graph=Mf(),"graph"):null}(t)){if(yf!=uf)throw Df("Identifier expected");var i=vf;if(Sf(),"="===vf){if(Sf(),yf!=uf)throw Df("Identifier expected");t[i]=vf,Sf()}else!function(t,e){var i={id:e},n=Mf();n&&(i.attr=n),Cf(t,i),Pf(t,e)}(t,i)}}function If(t){var e=null;if("subgraph"===vf&&((e={}).type="subgraph",Sf(),yf===uf&&(e.id=vf,Sf())),"{"===vf){if(Sf(),e||(e={}),e.parent=t,e.node=t.node,e.edge=t.edge,e.graph=t.graph,Af(e),"}"!=vf)throw Df("Angle bracket } expected");Sf(),delete e.node,delete e.edge,delete e.graph,delete e.parent,t.subgraphs||(t.subgraphs=[]),t.subgraphs.push(e)}return e}function Pf(t,e){for(;"->"===vf||"--"===vf;){var i,n=vf;Sf();var o=If(t);if(o)i=o;else{if(yf!=uf)throw Df("Identifier or subgraph expected");Cf(t,{id:i=vf}),Sf()}Ef(t,Tf(t,e,i,n,Mf())),e=i}}function Mf(){for(var t,e,i=null,n={dashed:!0,solid:!1,dotted:[1,5]},o={dot:"circle",box:"box",crow:"crow",curve:"curve",icurve:"inv_curve",normal:"triangle",inv:"inv_triangle",diamond:"diamond",tee:"bar",vee:"vee"},r=new Array,s=new Array;"["===vf;){for(Sf(),i={};""!==vf&&"]"!=vf;){if(yf!=uf)throw Df("Attribute name expected");var a=vf;if(Sf(),"="!=vf)throw Df("Equal sign = expected");if(Sf(),yf!=uf)throw Df("Attribute value expected");var l=vf;"style"===a&&(l=n[l]),"arrowhead"===a&&(a="arrows",l={to:{enabled:!0,type:o[l]}}),"arrowtail"===a&&(a="arrows",l={from:{enabled:!0,type:o[l]}}),r.push({attr:i,name:a,value:l}),s.push(a),Sf(),","==vf&&Sf()}if("]"!=vf)throw Df("Bracket ] expected");Sf()}if(mc(s).call(s,"dir")){var c={arrows:{}};for(t=0;t<r.length;t++)if("arrows"===r[t].name)if(null!=r[t].value.to)c.arrows.to=t;else{if(null==r[t].value.from)throw Df("Invalid value of arrows");c.arrows.from=t}else"dir"===r[t].name&&(c.dir=t);var h,d,u=r[c.dir].value;if(!mc(s).call(s,"arrows"))if("both"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),c.arrows.to=r.length-1,r.push({attr:r[c.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),c.arrows.from=r.length-1;else if("forward"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{to:{enabled:!0}}}),c.arrows.to=r.length-1;else if("back"===u)r.push({attr:r[c.dir].attr,name:"arrows",value:{from:{enabled:!0}}}),c.arrows.from=r.length-1;else{if("none"!==u)throw Df('Invalid dir type "'+u+'"');r.push({attr:r[c.dir].attr,name:"arrows",value:""}),c.arrows.to=r.length-1}if("both"===u)c.arrows.to&&c.arrows.from?(r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}},ec(r).call(r,c.arrows.from,1)):c.arrows.to?r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h="arrow"}}}:c.arrows.from&&(r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d="arrow"},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}});else if("back"===u)c.arrows.to&&c.arrows.from?r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}}:c.arrows.to?(d="",h="arrow",c.arrows.from=c.arrows.to,r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:h}}}):c.arrows.from&&(r[c.arrows.to]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{to:{enabled:!0,type:d=""},from:{enabled:!0,type:h=r[c.arrows.from].value.from.type}}}),r[c.arrows.from]={attr:r[c.arrows.from].attr,name:r[c.arrows.from].name,value:{from:{enabled:!0,type:r[c.arrows.from].value.from.type}}};else if("none"===u){var f;r[f=c.arrows.to?c.arrows.to:c.arrows.from]={attr:r[f].attr,name:r[f].name,value:""}}else{if("forward"!==u)throw Df('Invalid dir type "'+u+'"');c.arrows.to&&c.arrows.from||c.arrows.to?r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d=r[c.arrows.to].value.to.type},from:{enabled:!0,type:h=""}}}:c.arrows.from&&(d="arrow",h="",c.arrows.to=c.arrows.from,r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:d},from:{enabled:!0,type:h}}}),r[c.arrows.to]={attr:r[c.arrows.to].attr,name:r[c.arrows.to].name,value:{to:{enabled:!0,type:r[c.arrows.to].value.to.type}}}}ec(r).call(r,c.dir,1)}if(mc(s).call(s,"penwidth")){var p=[];for(e=r.length,t=0;t<e;t++)"width"!==r[t].name&&("penwidth"===r[t].name&&(r[t].name="width"),p.push(r[t]));r=p}for(e=r.length,t=0;t<e;t++)xf(r[t].attr,r[t].name,r[t].value);return i}function Df(t){return new SyntaxError(t+', got "'+Nf(vf,30)+'" (char '+gf+")")}function Nf(t,e){return t.length<=e?t:t.substr(0,27)+"..."}function Rf(t,e,i){for(var n=e.split("."),o=n.pop(),r=t,s=0;s<n.length;s++){var a=n[s];a in r||(r[a]={}),r=r[a]}return r[o]=i,t}function zf(t,e){var i={};for(var n in t)if(t.hasOwnProperty(n)){var o=e[n];vl(o)?Nl(o).call(o,function(e){Rf(i,e,t[n])}):Rf(i,"string"==typeof o?o:n,t[n])}return i}function Ff(t){var e,i=cf(t),n={nodes:[],edges:[],options:{}};if(i.nodes&&Nl(e=i.nodes).call(e,function(t){var e={id:t.id,label:String(t.label||t.id)};_f(e,zf(t.attr,hf)),e.image&&(e.shape="image"),n.nodes.push(e)}),i.edges){var o,r=function(t){var e={from:t.from,to:t.to};return _f(e,zf(t.attr,df)),null==e.arrows&&"->"===t.type&&(e.arrows="to"),e};Nl(o=i.edges).call(o,function(t){var e,i,o,s,a,l,c;e=t.from instanceof Object?t.from.nodes:{id:t.from},i=t.to instanceof Object?t.to.nodes:{id:t.to},t.from instanceof Object&&t.from.edges&&Nl(o=t.from.edges).call(o,function(t){var e=r(t);n.edges.push(e)}),a=i,l=function(e,i){var o=Tf(n,e.id,i.id,t.type,t.attr),s=r(o);n.edges.push(s)},vl(s=e)?Nl(s).call(s,function(t){vl(a)?Nl(a).call(a,function(e){l(t,e)}):l(t,a)}):vl(a)?Nl(a).call(a,function(t){l(s,t)}):l(s,a),t.to instanceof Object&&t.to.edges&&Nl(c=t.to.edges).call(c,function(t){var e=r(t);n.edges.push(e)})})}return i.attr&&(n.options=i.attr),n}var Lf=Object.freeze({__proto__:null,parseDOT:cf,DOTToGraph:Ff});function Bf(t,e){var i,n={edges:{inheritColor:!1},nodes:{fixed:!1,parseColor:!1}};null!=e&&(null!=e.fixed&&(n.nodes.fixed=e.fixed),null!=e.parseColor&&(n.nodes.parseColor=e.parseColor),null!=e.inheritColor&&(n.edges.inheritColor=e.inheritColor));var o=t.edges,r=kl(o).call(o,function(t){var e={from:t.source,id:t.id,to:t.target};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),"Directed"===t.type&&(e.arrows="to"),t.color&&!1===n.edges.inheritColor&&(e.color=t.color),e});return{nodes:kl(i=t.nodes).call(i,function(t){var e={id:t.id,fixed:n.nodes.fixed&&null!=t.x&&null!=t.y};return null!=t.attributes&&(e.attributes=t.attributes),null!=t.label&&(e.label=t.label),null!=t.size&&(e.size=t.size),null!=t.attributes&&null!=t.attributes.title&&(e.title=t.attributes.title),null!=t.title&&(e.title=t.title),null!=t.x&&(e.x=t.x),null!=t.y&&(e.y=t.y),null!=t.color&&(e.color=!0===n.nodes.parseColor?t.color:{background:t.color,border:t.color,highlight:{background:t.color,border:t.color},hover:{background:t.color,border:t.color}}),e}),edges:r}}var jf=Object.freeze({__proto__:null,parseGephi:Bf}),Vf=Object.freeze({__proto__:null,en:{addDescription:"Click in an empty space to place a new node.",addEdge:"Add Edge",addNode:"Add Node",back:"Back",close:"Close",createEdgeError:"Cannot link edges to a cluster.",del:"Delete selected",deleteClusterError:"Clusters cannot be deleted.",edgeDescription:"Click on a node and drag the edge to another node to connect them.",edit:"Edit",editClusterError:"Clusters cannot be edited.",editEdge:"Edit Edge",editEdgeDescription:"Click on the control points and drag them to a node to connect to it.",editNode:"Edit Node"},de:{addDescription:"Klicke auf eine freie Stelle, um einen neuen Knoten zu plazieren.",addEdge:"Kante hinzuf\xfcgen",addNode:"Knoten hinzuf\xfcgen",back:"Zur\xfcck",close:"Schlie\xdfen",createEdgeError:"Es ist nicht m\xf6glich, Kanten mit Clustern zu verbinden.",del:"L\xf6sche Auswahl",deleteClusterError:"Cluster k\xf6nnen nicht gel\xf6scht werden.",edgeDescription:"Klicke auf einen Knoten und ziehe die Kante zu einem anderen Knoten, um diese zu verbinden.",edit:"Editieren",editClusterError:"Cluster k\xf6nnen nicht editiert werden.",editEdge:"Kante editieren",editEdgeDescription:"Klicke auf die Verbindungspunkte und ziehe diese auf einen Knoten, um sie zu verbinden.",editNode:"Knoten editieren"},es:{addDescription:"Haga clic en un lugar vac\xedo para colocar un nuevo nodo.",addEdge:"A\xf1adir arista",addNode:"A\xf1adir nodo",back:"Atr\xe1s",close:"Cerrar",createEdgeError:"No se puede conectar una arista a un grupo.",del:"Eliminar selecci\xf3n",deleteClusterError:"No es posible eliminar grupos.",edgeDescription:"Haga clic en un nodo y arrastre la arista hacia otro nodo para conectarlos.",edit:"Editar",editClusterError:"No es posible editar grupos.",editEdge:"Editar arista",editEdgeDescription:"Haga clic en un punto de control y arrastrelo a un nodo para conectarlo.",editNode:"Editar nodo"},it:{addDescription:"Clicca per aggiungere un nuovo nodo",addEdge:"Aggiungi un vertice",addNode:"Aggiungi un nodo",back:"Indietro",close:"Chiudere",createEdgeError:"Non si possono collegare vertici ad un cluster",del:"Cancella la selezione",deleteClusterError:"I cluster non possono essere cancellati",edgeDescription:"Clicca su un nodo e trascinalo ad un altro nodo per connetterli.",edit:"Modifica",editClusterError:"I clusters non possono essere modificati.",editEdge:"Modifica il vertice",editEdgeDescription:"Clicca sui Punti di controllo e trascinali ad un nodo per connetterli.",editNode:"Modifica il nodo"},nl:{addDescription:"Klik op een leeg gebied om een nieuwe node te maken.",addEdge:"Link toevoegen",addNode:"Node toevoegen",back:"Terug",close:"Sluiten",createEdgeError:"Kan geen link maken naar een cluster.",del:"Selectie verwijderen",deleteClusterError:"Clusters kunnen niet worden verwijderd.",edgeDescription:"Klik op een node en sleep de link naar een andere node om ze te verbinden.",edit:"Wijzigen",editClusterError:"Clusters kunnen niet worden aangepast.",editEdge:"Link wijzigen",editEdgeDescription:"Klik op de verbindingspunten en sleep ze naar een node om daarmee te verbinden.",editNode:"Node wijzigen"},pt:{addDescription:"Clique em um espa\xe7o em branco para adicionar um novo n\xf3",addEdge:"Adicionar aresta",addNode:"Adicionar n\xf3",back:"Voltar",close:"Fechar",createEdgeError:"N\xe3o foi poss\xedvel linkar arestas a um cluster.",del:"Remover selecionado",deleteClusterError:"Clusters n\xe3o puderam ser removidos.",edgeDescription:"Clique em um n\xf3 e arraste a aresta at\xe9 outro n\xf3 para conect\xe1-los",edit:"Editar",editClusterError:"Clusters n\xe3o puderam ser editados.",editEdge:"Editar aresta",editEdgeDescription:"Clique nos pontos de controle e os arraste para um n\xf3 para conect\xe1-los",editNode:"Editar n\xf3"},ru:{addDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u0432 \u0441\u0432\u043e\u0431\u043e\u0434\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e, \u0447\u0442\u043e\u0431\u044b \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0443\u0437\u0435\u043b.",addEdge:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u043e",addNode:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0443\u0437\u0435\u043b",back:"\u041d\u0430\u0437\u0430\u0434",close:"\u0417\u0430\u043a\u0440\u044b\u0432\u0430\u0442\u044c",createEdgeError:"\u041d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0440\u0435\u0431\u0440\u0430 \u0432 \u043a\u043b\u0430\u0441\u0442\u0435\u0440.",del:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435",deleteClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u044b",edgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u0443\u0437\u0435\u043b \u0438 \u043f\u0440\u043e\u0442\u044f\u043d\u0438\u0442\u0435 \u0440\u0435\u0431\u0440\u043e \u043a \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u0443\u0437\u043b\u0443, \u0447\u0442\u043e\u0431\u044b \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0438\u0445.",edit:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",editClusterError:"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0440\u0435\u0431\u0440\u043e",editEdgeDescription:"\u041a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u044b\u0435 \u0442\u043e\u0447\u043a\u0438 \u0438 \u043f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0438\u0445 \u0432 \u0443\u0437\u0435\u043b, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043a \u043d\u0435\u043c\u0443.",editNode:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0443\u0437\u0435\u043b"},cn:{addDescription:"\u5355\u51fb\u7a7a\u767d\u5904\u653e\u7f6e\u65b0\u8282\u70b9\u3002",addEdge:"\u6dfb\u52a0\u8fde\u63a5\u7ebf",addNode:"\u6dfb\u52a0\u8282\u70b9",back:"\u8fd4\u56de",close:"\u95dc\u9589",createEdgeError:"\u65e0\u6cd5\u5c06\u8fde\u63a5\u7ebf\u8fde\u63a5\u5230\u7fa4\u96c6\u3002",del:"\u5220\u9664\u9009\u5b9a",deleteClusterError:"\u65e0\u6cd5\u5220\u9664\u7fa4\u96c6\u3002",edgeDescription:"\u5355\u51fb\u67d0\u4e2a\u8282\u70b9\u5e76\u5c06\u8be5\u8fde\u63a5\u7ebf\u62d6\u52a8\u5230\u53e6\u4e00\u4e2a\u8282\u70b9\u4ee5\u8fde\u63a5\u5b83\u4eec\u3002",edit:"\u7f16\u8f91",editClusterError:"\u65e0\u6cd5\u7f16\u8f91\u7fa4\u96c6\u3002",editEdge:"\u7f16\u8f91\u8fde\u63a5\u7ebf",editEdgeDescription:"\u5355\u51fb\u63a7\u5236\u8282\u70b9\u5e76\u5c06\u5b83\u4eec\u62d6\u5230\u8282\u70b9\u4e0a\u8fde\u63a5\u3002",editNode:"\u7f16\u8f91\u8282\u70b9"},uk:{addDescription:"K\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0456\u043b\u044c\u043d\u0435 \u043c\u0456\u0441\u0446\u0435, \u0449\u043e\u0431 \u0434\u043e\u0434\u0430\u0442\u0438 \u043d\u043e\u0432\u0438\u0439 \u0432\u0443\u0437\u043e\u043b.",addEdge:"\u0414\u043e\u0434\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",addNode:"\u0414\u043e\u0434\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b",back:"\u041d\u0430\u0437\u0430\u0434",close:"\u0417\u0430\u043a\u0440\u0438\u0442\u0438",createEdgeError:"\u041d\u0435 \u043c\u043e\u0436\u043b\u0438\u0432\u043e \u043e\u0431'\u0454\u0434\u043d\u0430\u0442\u0438 \u043a\u0440\u0430\u0457 \u0432 \u0433\u0440\u0443\u043f\u0443.",del:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043e\u0431\u0440\u0430\u043d\u0435",deleteClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435 \u043c\u043e\u0436\u0443\u0442\u044c \u0431\u0443\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u0456.",edgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u0432\u0443\u0437\u043e\u043b \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u043a\u0440\u0430\u0439 \u0434\u043e \u0456\u043d\u0448\u043e\u0433\u043e \u0432\u0443\u0437\u043b\u0430, \u0449\u043e\u0431 \u0457\u0445 \u0437'\u0454\u0434\u043d\u0430\u0442\u0438.",edit:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438",editClusterError:"\u0413\u0440\u0443\u043f\u0438 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0456 \u0434\u043b\u044f \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f.",editEdge:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u043a\u0440\u0430\u0439",editEdgeDescription:"\u041a\u043b\u0456\u043a\u043d\u0456\u0442\u044c \u043d\u0430 \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u044c\u043d\u0456 \u0442\u043e\u0447\u043a\u0438 \u0456 \u043f\u0435\u0440\u0435\u0442\u044f\u0433\u043d\u0456\u0442\u044c \u0457\u0445 \u0443 \u0432\u0443\u0437\u043e\u043b, \u0449\u043e\u0431 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u0438\u0441\u044f \u0434\u043e \u043d\u044c\u043e\u0433\u043e.",editNode:"\u0420\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u0442\u0438 \u0432\u0443\u0437\u043e\u043b"},fr:{addDescription:"Cliquez dans un endroit vide pour placer un n\u0153ud.",addEdge:"Ajouter un lien",addNode:"Ajouter un n\u0153ud",back:"Retour",close:"Fermer",createEdgeError:"Impossible de cr\xe9er un lien vers un cluster.",del:"Effacer la s\xe9lection",deleteClusterError:"Les clusters ne peuvent pas \xeatre effac\xe9s.",edgeDescription:"Cliquez sur un n\u0153ud et glissez le lien vers un autre n\u0153ud pour les connecter.",edit:"\xc9diter",editClusterError:"Les clusters ne peuvent pas \xeatre \xe9dit\xe9s.",editEdge:"\xc9diter le lien",editEdgeDescription:"Cliquez sur les points de contr\xf4le et glissez-les pour connecter un n\u0153ud.",editNode:"\xc9diter le n\u0153ud"},cs:{addDescription:"Kluknut\xedm do pr\xe1zdn\xe9ho prostoru m\u016f\u017eete p\u0159idat nov\xfd vrchol.",addEdge:"P\u0159idat hranu",addNode:"P\u0159idat vrchol",back:"Zp\u011bt",close:"Zav\u0159\xedt",createEdgeError:"Nelze p\u0159ipojit hranu ke shluku.",del:"Smazat v\xfdb\u011br",deleteClusterError:"Nelze mazat shluky.",edgeDescription:"P\u0159eta\u017een\xedm z jednoho vrcholu do druh\xe9ho m\u016f\u017eete spojit tyto vrcholy novou hranou.",edit:"Upravit",editClusterError:"Nelze upravovat shluky.",editEdge:"Upravit hranu",editEdgeDescription:"P\u0159eta\u017een\xedm kontroln\xedho vrcholu hrany ji m\u016f\u017eete p\u0159ipojit k jin\xe9mu vrcholu.",editNode:"Upravit vrchol"}}),Hf=function(){function t(){pa(this,t),this.NUM_ITERATIONS=4,this.image=new Image,this.canvas=document.createElement("canvas")}return va(t,[{key:"init",value:function(){if(!this.initialized()){this.src=this.image.src;var t=this.image.width,e=this.image.height;this.width=t,this.height=e;var i=Math.floor(e/2),n=Math.floor(e/4),o=Math.floor(e/8),r=Math.floor(e/16),s=Math.floor(t/2),a=Math.floor(t/4),l=Math.floor(t/8),c=Math.floor(t/16);this.canvas.width=3*a,this.canvas.height=i,this.coordinates=[[0,0,s,i],[s,0,a,n],[s,n,l,o],[5*l,n,c,r]],this._fillMipMap()}}},{key:"initialized",value:function(){return void 0!==this.coordinates}},{key:"_fillMipMap",value:function(){var t=this.canvas.getContext("2d"),e=this.coordinates[0];t.drawImage(this.image,e[0],e[1],e[2],e[3]);for(var i=1;i<this.NUM_ITERATIONS;i++){var n=this.coordinates[i-1],o=this.coordinates[i];t.drawImage(this.canvas,n[0],n[1],n[2],n[3],o[0],o[1],o[2],o[3])}}},{key:"drawImageAtPosition",value:function(t,e,i,n,o,r){if(this.initialized())if(e>2){e*=.5;for(var s=0;e>2&&s<this.NUM_ITERATIONS;)e*=.5,s+=1;s>=this.NUM_ITERATIONS&&(s=this.NUM_ITERATIONS-1);var a=this.coordinates[s];t.drawImage(this.canvas,a[0],a[1],a[2],a[3],i,n,o,r)}else t.drawImage(this.image,i,n,o,r)}}]),t}(),Wf=function(){function t(e){pa(this,t),this.images={},this.imageBroken={},this.callback=e}return va(t,[{key:"_tryloadBrokenUrl",value:function(t,e,i){void 0!==t&&void 0!==i&&(void 0!==e?(i.image.onerror=function(){console.error("Could not load brokenImage:",e)},i.image.src=e):console.warn("No broken url image defined"))}},{key:"_redrawWithImage",value:function(t){this.callback&&this.callback(t)}},{key:"load",value:function(t,e){var i=this,n=this.images[t];if(n)return n;var o=new Hf;return this.images[t]=o,o.image.onload=function(){i._fixImageCoordinates(o.image),o.init(),i._redrawWithImage(o)},o.image.onerror=function(){console.error("Could not load image:",t),i._tryloadBrokenUrl(t,e,o)},o.image.src=t,o}},{key:"_fixImageCoordinates",value:function(t){0===t.width&&(document.body.appendChild(t),t.width=t.offsetWidth,t.height=t.offsetHeight,document.body.removeChild(t))}}]),t}(),qf={exports:{}},Uf=!s(function(){return Object.isExtensible(Object.preventExtensions({}))}),Yf=oe,Gf=we,Zf=C,$f=Q,Xf=jt.f,Kf=rr,Qf=lr,Jf=Uf,tp=!1,ep=et("meta"),ip=0,np=Object.isExtensible||function(){return!0},op=function(t){Xf(t,ep,{value:{objectID:"O"+ip++,weakData:{}}})},rp=qf.exports={enable:function(){rp.enable=function(){},tp=!0;var t=Kf.f,e=[].splice,i={};i[ep]=1,t(i).length&&(Kf.f=function(i){for(var n=t(i),o=0,r=n.length;o<r;o++)if(n[o]===ep){e.call(n,o,1);break}return n},Yf({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Qf.f}))},fastKey:function(t,e){if(!Zf(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!$f(t,ep)){if(!np(t))return"F";if(!e)return"E";op(t)}return t[ep].objectID},getWeakData:function(t,e){if(!$f(t,ep)){if(!np(t))return!0;if(!e)return!1;op(t)}return t[ep].weakData},onFreeze:function(t){return Jf&&tp&&np(t)&&!$f(t,ep)&&op(t),t}};Gf[ep]=!0;var sp=Ht,ap=bo,lp=he,cp=Bt,hp=So,dp=fo,up=function(t,e){this.stopped=t,this.result=e},fp=function(t,e,i){var n,o,r,s,a,l,c,h=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),u=!(!i||!i.INTERRUPTED),f=cp(e,i&&i.that,1+h+u),p=function(t){return n&&dp(n),new up(!0,t)},g=function(t){return h?(sp(t),u?f(t[0],t[1],p):f(t[0],t[1])):u?f(t,p):f(t)};if(d)n=t;else{if("function"!=typeof(o=hp(t)))throw TypeError("Target is not iterable");if(ap(o)){for(r=0,s=lp(t.length);s>r;r++)if((a=g(t[r]))&&a instanceof up)return a;return new up(!1)}n=o.call(t)}for(l=n.next;!(c=l.call(n)).done;){try{a=g(c.value)}catch(t){throw dp(n),t}if("object"==typeof a&&a&&a instanceof up)return a}return new up(!1)},pp=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t},gp=oe,mp=o,vp=qf.exports,yp=s,bp=$t,wp=fp,kp=pp,_p=C,xp=Mn,Cp=jt.f,Ep=Ir.forEach,Tp=a,Sp=Fi.set,Ap=Fi.getterFor,Op=function(t,e,i){var n,o=-1!==t.indexOf("Map"),r=-1!==t.indexOf("Weak"),s=o?"set":"add",a=mp[t],l=a&&a.prototype,c={};if(Tp&&"function"==typeof a&&(r||l.forEach&&!yp(function(){(new a).entries().next()}))){n=e(function(e,i){Sp(kp(e,n,t),{type:t,collection:new a}),null!=i&&wp(i,e[s],{that:e,AS_ENTRIES:o})});var h=Ap(t);Ep(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"==t||"set"==t;!(t in l)||r&&"clear"==t||bp(n.prototype,t,function(i,n){var o=h(this).collection;if(!e&&r&&!_p(i))return"get"==t&&void 0;var s=o[t](0===i?0:i,n);return e?this:s})}),r||Cp(n.prototype,"size",{configurable:!0,get:function(){return h(this).collection.size}})}else n=i.getConstructor(e,t,o,s),vp.enable();return xp(n,t,!1,!0),c[t]=n,gp({global:!0,forced:!0},c),r||i.setStrong(n,t,o),n},Ip=qn,Pp=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:Ip(t,n,e[n],i);return t},Mp=O,Dp=jt,Np=a,Rp=ht("species"),zp=jt.f,Fp=vn,Lp=Pp,Bp=Bt,jp=pp,Vp=fp,Hp=oo,Wp=a,qp=qf.exports.fastKey,Up=Fi.set,Yp=Fi.getterFor,Gp={getConstructor:function(t,e,i,n){var o=t(function(t,r){jp(t,o,e),Up(t,{type:e,index:Fp(null),first:void 0,last:void 0,size:0}),Wp||(t.size=0),null!=r&&Vp(r,t[n],{that:t,AS_ENTRIES:i})}),r=Yp(e),s=function(t,e,i){var n,o,s=r(t),l=a(t,e);return l?l.value=i:(s.last=l={index:o=qp(e,!0),key:e,value:i,previous:n=s.last,next:void 0,removed:!1},s.first||(s.first=l),n&&(n.next=l),Wp?s.size++:t.size++,"F"!==o&&(s.index[o]=l)),t},a=function(t,e){var i,n=r(t),o=qp(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key==e)return i};return Lp(o.prototype,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,Wp?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),n=a(e,t);if(n){var o=n.next,s=n.previous;delete i.index[n.index],n.removed=!0,s&&(s.next=o),o&&(o.previous=s),i.first==n&&(i.first=o),i.last==n&&(i.last=s),Wp?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=r(this),n=Bp(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),Lp(o.prototype,i?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return s(this,0===t?0:t,e)}}:{add:function(t){return s(this,t=0===t?0:t,t)}}),Wp&&zp(o.prototype,"size",{get:function(){return r(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=Yp(e),r=Yp(n);Hp(t,e,function(t,e){Up(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),function(t){var e=Mp(t);Np&&e&&!e[Rp]&&(0,Dp.f)(e,Rp,{configurable:!0,get:function(){return this}})}(e)}};Op("Map",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gp);var Zp=E.Map,$p=function(){function t(){pa(this,t),this.clear(),this._defaultIndex=0,this._groupIndex=0,this._defaultGroups=[{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},{border:"#FFA500",background:"#FFFF00",highlight:{border:"#FFA500",background:"#FFFFA3"},hover:{border:"#FFA500",background:"#FFFFA3"}},{border:"#FA0A10",background:"#FB7E81",highlight:{border:"#FA0A10",background:"#FFAFB1"},hover:{border:"#FA0A10",background:"#FFAFB1"}},{border:"#41A906",background:"#7BE141",highlight:{border:"#41A906",background:"#A1EC76"},hover:{border:"#41A906",background:"#A1EC76"}},{border:"#E129F0",background:"#EB7DF4",highlight:{border:"#E129F0",background:"#F0B3F5"},hover:{border:"#E129F0",background:"#F0B3F5"}},{border:"#7C29F0",background:"#AD85E4",highlight:{border:"#7C29F0",background:"#D3BDF0"},hover:{border:"#7C29F0",background:"#D3BDF0"}},{border:"#C37F00",background:"#FFA807",highlight:{border:"#C37F00",background:"#FFCA66"},hover:{border:"#C37F00",background:"#FFCA66"}},{border:"#4220FB",background:"#6E6EFD",highlight:{border:"#4220FB",background:"#9B9BFD"},hover:{border:"#4220FB",background:"#9B9BFD"}},{border:"#FD5A77",background:"#FFC0CB",highlight:{border:"#FD5A77",background:"#FFD1D9"},hover:{border:"#FD5A77",background:"#FFD1D9"}},{border:"#4AD63A",background:"#C2FABC",highlight:{border:"#4AD63A",background:"#E6FFE3"},hover:{border:"#4AD63A",background:"#E6FFE3"}},{border:"#990000",background:"#EE0000",highlight:{border:"#BB0000",background:"#FF3333"},hover:{border:"#BB0000",background:"#FF3333"}},{border:"#FF6000",background:"#FF6000",highlight:{border:"#FF6000",background:"#FF6000"},hover:{border:"#FF6000",background:"#FF6000"}},{border:"#97C2FC",background:"#2B7CE9",highlight:{border:"#D2E5FF",background:"#2B7CE9"},hover:{border:"#D2E5FF",background:"#2B7CE9"}},{border:"#399605",background:"#255C03",highlight:{border:"#399605",background:"#255C03"},hover:{border:"#399605",background:"#255C03"}},{border:"#B70054",background:"#FF007E",highlight:{border:"#B70054",background:"#FF007E"},hover:{border:"#B70054",background:"#FF007E"}},{border:"#AD85E4",background:"#7C29F0",highlight:{border:"#D3BDF0",background:"#7C29F0"},hover:{border:"#D3BDF0",background:"#7C29F0"}},{border:"#4557FA",background:"#000EA1",highlight:{border:"#6E6EFD",background:"#000EA1"},hover:{border:"#6E6EFD",background:"#000EA1"}},{border:"#FFC0CB",background:"#FD5A77",highlight:{border:"#FFD1D9",background:"#FD5A77"},hover:{border:"#FFD1D9",background:"#FD5A77"}},{border:"#C2FABC",background:"#74D66A",highlight:{border:"#E6FFE3",background:"#74D66A"},hover:{border:"#E6FFE3",background:"#74D66A"}},{border:"#EE0000",background:"#990000",highlight:{border:"#FF3333",background:"#BB0000"},hover:{border:"#FF3333",background:"#BB0000"}}],this.options={},this.defaultOptions={useDefaultGroups:!0},je(this.options,this.defaultOptions)}return va(t,[{key:"setOptions",value:function(t){var e=["useDefaultGroups"];if(void 0!==t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&-1===eh(e).call(e,i)&&this.add(i,t[i])}},{key:"clear",value:function(){this._groups=new Zp,this._groupNames=[]}},{key:"get",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._groups.get(t);if(void 0===i&&e)if(!1===this.options.useDefaultGroups&&this._groupNames.length>0){var n=this._groupIndex%this._groupNames.length;++this._groupIndex,(i={}).color=this._groups.get(this._groupNames[n]),this._groups.set(t,i)}else{var o=this._defaultIndex%this._defaultGroups.length;this._defaultIndex++,(i={}).color=this._defaultGroups[o],this._groups.set(t,i)}return i}},{key:"add",value:function(t,e){return this._groups.has(t)||this._groupNames.push(t),this._groups.set(t,e),e}}]),t}();oe({target:"Number",stat:!0},{isNaN:function(t){return t!=t}});var Xp=E.Number.isNaN,Kp=o.isFinite;oe({target:"Number",stat:!0},{isFinite:Number.isFinite||function(t){return"number"==typeof t&&Kp(t)}});var Qp=E.Number.isFinite,Jp=Ir.some;oe({target:"Array",proto:!0,forced:!Sl("some")},{some:function(t){return Jp(this,t,arguments.length>1?arguments[1]:void 0)}});var tg=Ze("Array").some,eg=Array.prototype,ig=ai,ng=Bc.trim,og=o.parseFloat,rg=1/og("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff-0")!=-1/0?function(t){var e=ng(ig(t)),i=og(e);return 0===i&&"-"==e.charAt(0)?-0:i}:og;oe({global:!0,forced:parseFloat!=rg},{parseFloat:rg});var sg=E.parseFloat,ag=lr.f;oe({target:"Object",stat:!0,forced:s(function(){return!Object.getOwnPropertyNames(1)})},{getOwnPropertyNames:ag});var lg=E.Object;function cg(t,e){var i=["node","edge","label"],n=!0,o=$u(e,"chosen");if("boolean"==typeof o)n=o;else if("object"===hl(o)){if(-1===eh(i).call(i,t))throw new Error("choosify: subOption '"+t+"' should be one of '"+i.join("', '")+"'");var r=$u(e,["chosen",t]);"boolean"!=typeof r&&"function"!=typeof r||(n=r)}return n}function hg(t,e,i){if(t.width<=0||t.height<=0)return!1;if(void 0!==i){var n={x:e.x-i.x,y:e.y-i.y};if(0!==i.angle){var o=-i.angle;e={x:Math.cos(o)*n.x-Math.sin(o)*n.y,y:Math.sin(o)*n.x+Math.cos(o)*n.y}}else e=n}return t.left<e.x&&t.x+t.width>e.x&&t.top<e.y&&t.y+t.width>e.y}function dg(t){return"string"==typeof t&&""!==t}function ug(t,e,i,n){var o=n.x,r=n.y;if("function"==typeof n.distanceToBorder){var s=n.distanceToBorder(t,e),a=Math.sin(e)*s,l=Math.cos(e)*s;l===s?(o+=s,r=n.y):a===s?(o=n.x,r-=s):(o+=l,r-=a)}else n.shape.width>n.shape.height?(o=n.x+.5*n.shape.width,r=n.y-i):(o=n.x+i,r=n.y-.5*n.shape.height);return{x:o,y:r}}var fg=Ze("Array").values,pg=Cn,gg=Array.prototype,mg={DOMTokenList:!0,NodeList:!0},vg=function(t){var e=t.values;return t===gg||t instanceof Array&&e===gg.values||mg.hasOwnProperty(pg(t))?fg:e},yg=function(){function t(e){pa(this,t),this.measureText=e,this.current=0,this.width=0,this.height=0,this.lines=[]}return va(t,[{key:"_add",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";void 0===this.lines[t]&&(this.lines[t]={width:0,height:0,blocks:[]});var n=e;void 0!==e&&""!==e||(n=" ");var o=this.measureText(n,i),r=je({},vg(o));r.text=e,r.width=o.width,r.mod=i,void 0!==e&&""!==e||(r.width=0),this.lines[t].blocks.push(r),this.lines[t].width+=r.width}},{key:"curWidth",value:function(){var t=this.lines[this.current];return void 0===t?0:t.width}},{key:"append",value:function(t){this._add(this.current,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal")}},{key:"newLine",value:function(t){this._add(this.current,t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal"),this.current++}},{key:"determineLineHeights",value:function(){for(var t=0;t<this.lines.length;t++){var e=this.lines[t],i=0;if(void 0!==e.blocks)for(var n=0;n<e.blocks.length;n++){var o=e.blocks[n];i<o.height&&(i=o.height)}e.height=i}}},{key:"determineLabelSize",value:function(){for(var t=0,e=0,i=0;i<this.lines.length;i++){var n=this.lines[i];n.width>t&&(t=n.width),e+=n.height}this.width=t,this.height=e}},{key:"removeEmptyBlocks",value:function(){for(var t=[],e=0;e<this.lines.length;e++){var i=this.lines[e];if(0!==i.blocks.length&&(e!==this.lines.length-1||0!==i.width)){var n={};je(n,i),n.blocks=[];for(var o=void 0,r=[],s=0;s<i.blocks.length;s++){var a=i.blocks[s];0!==a.width?r.push(a):void 0===o&&(o=a)}0===r.length&&void 0!==o&&r.push(o),n.blocks=r,t.push(n)}}return t}},{key:"finalize",value:function(){this.determineLineHeights(),this.determineLabelSize();var t=this.removeEmptyBlocks();return{width:this.width,height:this.height,lines:t}}}]),t}(),bg={"<b>":/<b>/,"<i>":/<i>/,"<code>":/<code>/,"</b>":/<\/b>/,"</i>":/<\/i>/,"</code>":/<\/code>/,"*":/\*/,_:/_/,"`":/`/,afterBold:/[^*]/,afterItal:/[^_]/,afterMono:/[^`]/},wg=function(){function t(e){pa(this,t),this.text=e,this.bold=!1,this.ital=!1,this.mono=!1,this.spacing=!1,this.position=0,this.buffer="",this.modStack=[],this.blocks=[]}return va(t,[{key:"mod",value:function(){return 0===this.modStack.length?"normal":this.modStack[0]}},{key:"modName",value:function(){return 0===this.modStack.length?"normal":"mono"===this.modStack[0]?"mono":this.bold&&this.ital?"boldital":this.bold?"bold":this.ital?"ital":void 0}},{key:"emitBlock",value:function(){this.spacing&&(this.add(" "),this.spacing=!1),this.buffer.length>0&&(this.blocks.push({text:this.buffer,mod:this.modName()}),this.buffer="")}},{key:"add",value:function(t){" "===t&&(this.spacing=!0),this.spacing&&(this.buffer+=" ",this.spacing=!1)," "!=t&&(this.buffer+=t)}},{key:"parseWS",value:function(t){return!!/[ \t]/.test(t)&&(this.mono?this.add(t):this.spacing=!0,!0)}},{key:"setTag",value:function(t){this.emitBlock(),this[t]=!0,this.modStack.unshift(t)}},{key:"unsetTag",value:function(t){this.emitBlock(),this[t]=!1,this.modStack.shift()}},{key:"parseStartTag",value:function(t,e){return!(this.mono||this[t]||!this.match(e)||(this.setTag(t),0))}},{key:"match",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=ll(this.prepareRegExp(t),2),n=i[1],o=i[0].test(this.text.substr(this.position,n));return o&&e&&(this.position+=n-1),o}},{key:"parseEndTag",value:function(t,e,i){var n=this.mod()===t;return!(!(n="mono"===t?n&&this.mono:n&&!this.mono)||!this.match(e)||(void 0!==i?(this.position===this.text.length-1||this.match(i,!1))&&this.unsetTag(t):this.unsetTag(t),0))}},{key:"replace",value:function(t,e){return!!this.match(t)&&(this.add(e),this.position+=length-1,!0)}},{key:"prepareRegExp",value:function(t){var e,i;if(t instanceof RegExp)i=t,e=1;else{var n=bg[t];i=void 0!==n?n:new RegExp(t),e=t.length}return[i,e]}}]),t}(),kg=function(){function t(e,i,n,o){var r=this;pa(this,t),this.ctx=e,this.parent=i,this.selected=n,this.hover=o,this.lines=new yg(function(t,i){if(void 0===t)return 0;var s=r.parent.getFormattingValues(e,n,o,i),a=0;return""!==t&&(a=r.ctx.measureText(t).width),{width:a,values:s}})}return va(t,[{key:"process",value:function(t){if(!dg(t))return this.lines.finalize();var e=this.parent.fontOptions;t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");var i=String(t).split("\n"),n=i.length;if(e.multi)for(var o=0;o<n;o++){var r=this.splitBlocks(i[o],e.multi);if(void 0!==r)if(0!==r.length){if(e.maxWdt>0)for(var s=0;s<r.length;s++)this.splitStringIntoLines(r[s].text,r[s].mod,!0);else for(var a=0;a<r.length;a++)this.lines.append(r[a].text,r[a].mod);this.lines.newLine()}else this.lines.newLine("")}else if(e.maxWdt>0)for(var l=0;l<n;l++)this.splitStringIntoLines(i[l]);else for(var c=0;c<n;c++)this.lines.newLine(i[c]);return this.lines.finalize()}},{key:"decodeMarkupSystem",value:function(t){var e="none";return"markdown"===t||"md"===t?e="markdown":!0!==t&&"html"!==t||(e="html"),e}},{key:"splitHtmlBlocks",value:function(t){for(var e=new wg(t),i=function(t){return!!/&/.test(t)&&(e.replace(e.text,"&lt;","<")||e.replace(e.text,"&amp;","&")||e.add("&"),!0)};e.position<e.text.length;){var n=e.text.charAt(e.position);e.parseWS(n)||/</.test(n)&&(e.parseStartTag("bold","<b>")||e.parseStartTag("ital","<i>")||e.parseStartTag("mono","<code>")||e.parseEndTag("bold","</b>")||e.parseEndTag("ital","</i>")||e.parseEndTag("mono","</code>"))||i(n)||e.add(n),e.position++}return e.emitBlock(),e.blocks}},{key:"splitMarkdownBlocks",value:function(t){for(var e=this,i=new wg(t),n=!0,o=function(t){return!!/\\/.test(t)&&(i.position<e.text.length+1&&(i.position++,t=e.text.charAt(i.position),/ \t/.test(t)?i.spacing=!0:(i.add(t),n=!1)),!0)};i.position<i.text.length;){var r=i.text.charAt(i.position);i.parseWS(r)||o(r)||(n||i.spacing)&&(i.parseStartTag("bold","*")||i.parseStartTag("ital","_")||i.parseStartTag("mono","`"))||i.parseEndTag("bold","*","afterBold")||i.parseEndTag("ital","_","afterItal")||i.parseEndTag("mono","`","afterMono")||(i.add(r),n=!1),i.position++}return i.emitBlock(),i.blocks}},{key:"splitBlocks",value:function(t,e){var i=this.decodeMarkupSystem(e);return"none"===i?[{text:t,mod:"normal"}]:"markdown"===i?this.splitMarkdownBlocks(t):"html"===i?this.splitHtmlBlocks(t):void 0}},{key:"overMaxWidth",value:function(t){var e=this.ctx.measureText(t).width;return this.lines.curWidth()+e>this.parent.fontOptions.maxWdt}},{key:"getLongestFit",value:function(t){for(var e="",i=0;i<t.length;){var n=e+(""===e?"":" ")+t[i];if(this.overMaxWidth(n))break;e=n,i++}return i}},{key:"getLongestFitWord",value:function(t){for(var e=0;e<t.length&&!this.overMaxWidth(ml(t).call(t,0,e));)e++;return e}},{key:"splitStringIntoLines",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.parent.getFormattingValues(this.ctx,this.selected,this.hover,e);for(var n=(t=(t=t.replace(/^( +)/g,"$1\r")).replace(/([^\r][^ ]*)( +)/g,"$1\r$2\r")).split("\r");n.length>0;){var o=this.getLongestFit(n);if(0===o){var r=n[0],s=this.getLongestFitWord(r);this.lines.newLine(ml(r).call(r,0,s),e),n[0]=ml(r).call(r,s)}else{var a=o;" "===n[o-1]?o--:" "===n[a]&&a++;var l=ml(n).call(n,0,o).join("");o==n.length&&i?this.lines.append(l,e):this.lines.newLine(l,e),n=ml(n).call(n,a)}}}}]),t}(),_g=["bold","ital","boldital","mono"],xg=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];pa(this,t),this.body=e,this.pointToSelf=!1,this.baseSize=void 0,this.fontOptions={},this.setOptions(i),this.size={top:0,left:0,width:0,height:0,yLine:0},this.isEdgeLabel=n}return va(t,[{key:"setOptions",value:function(t){if(this.elementOptions=t,this.initFontOptions(t.font),dg(t.label)?this.labelDirty=!0:t.label=void 0,null!=t.font)if("string"==typeof t.font)this.baseSize=this.fontOptions.size;else if("object"===hl(t.font)){var e=t.font.size;void 0!==e&&(this.baseSize=e)}}},{key:"initFontOptions",value:function(e){var i=this;Ru(_g,function(t){i.fontOptions[t]={}}),t.parseFontString(this.fontOptions,e)?this.fontOptions.vadjust=0:Ru(e,function(t,e){null!=t&&"object"!==hl(t)&&(i.fontOptions[e]=t)})}},{key:"constrain",value:function(t){var e={constrainWidth:!1,maxWdt:-1,minWdt:-1,constrainHeight:!1,minHgt:-1,valign:"middle"},i=$u(t,"widthConstraint");if("number"==typeof i)e.maxWdt=Number(i),e.minWdt=Number(i);else if("object"===hl(i)){var n=$u(t,["widthConstraint","maximum"]);"number"==typeof n&&(e.maxWdt=Number(n));var o=$u(t,["widthConstraint","minimum"]);"number"==typeof o&&(e.minWdt=Number(o))}var r=$u(t,"heightConstraint");if("number"==typeof r)e.minHgt=Number(r);else if("object"===hl(r)){var s=$u(t,["heightConstraint","minimum"]);"number"==typeof s&&(e.minHgt=Number(s));var a=$u(t,["heightConstraint","valign"]);"string"==typeof a&&("top"!==a&&"bottom"!==a||(e.valign=a))}return e}},{key:"update",value:function(t,e){this.setOptions(t,!0),this.propagateFonts(e),Pu(this.fontOptions,this.constrain(e)),this.fontOptions.chooser=cg("label",e)}},{key:"adjustSizes",value:function(t){var e=t?t.right+t.left:0;this.fontOptions.constrainWidth&&(this.fontOptions.maxWdt-=e,this.fontOptions.minWdt-=e),this.fontOptions.constrainHeight&&(this.fontOptions.minHgt-=t?t.top+t.bottom:0)}},{key:"addFontOptionsToPile",value:function(t,e){for(var i=0;i<e.length;++i)this.addFontToPile(t,e[i])}},{key:"addFontToPile",value:function(t,e){void 0!==e&&null!=e.font&&t.push(e.font)}},{key:"getBasicOptions",value:function(e){for(var i={},n=0;n<e.length;++n){var o=e[n],r={};t.parseFontString(r,o)&&(o=r),Ru(o,function(t,e){void 0!==t&&(Object.prototype.hasOwnProperty.call(i,e)||(i[e]=-1!==eh(_g).call(_g,e)?{}:t))})}return i}},{key:"getFontOption",value:function(e,i,n){for(var o,r=0;r<e.length;++r){var s=e[r];if(Object.prototype.hasOwnProperty.call(s,i)){if(null==(o=s[i]))continue;var a={};if(t.parseFontString(a,o)&&(o=a),Object.prototype.hasOwnProperty.call(o,n))return o[n]}}if(Object.prototype.hasOwnProperty.call(this.fontOptions,n))return this.fontOptions[n];throw new Error("Did not find value for multi-font for property: '"+n+"'")}},{key:"getFontOptions",value:function(t,e){for(var i={},n=["color","size","face","mod","vadjust"],o=0;o<n.length;++o){var r=n[o];i[r]=this.getFontOption(t,e,r)}return i}},{key:"propagateFonts",value:function(t){var e=this,i=[];this.addFontOptionsToPile(i,t),this.fontOptions=this.getBasicOptions(i);for(var n=function(t){var n=_g[t],o=e.fontOptions[n];Ru(e.getFontOptions(i,n),function(t,e){o[e]=t}),o.size=Number(o.size),o.vadjust=Number(o.vadjust)},o=0;o<_g.length;++o)n(o)}},{key:"draw",value:function(t,e,i,n,o){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";if(void 0!==this.elementOptions.label){var s=this.fontOptions.size*this.body.view.scale;this.elementOptions.label&&s<this.elementOptions.scaling.label.drawThreshold-1||(s>=this.elementOptions.scaling.label.maxVisible&&(s=Number(this.elementOptions.scaling.label.maxVisible)/this.body.view.scale),this.calculateLabelSize(t,n,o,e,i,r),this._drawBackground(t),this._drawText(t,e,this.size.yLine,r,s))}}},{key:"_drawBackground",value:function(t){if(void 0!==this.fontOptions.background&&"none"!==this.fontOptions.background){t.fillStyle=this.fontOptions.background;var e=this.getSize();t.fillRect(e.left,e.top,e.width,e.height)}}},{key:"_drawText",value:function(t,e,i){var n=arguments.length>4?arguments[4]:void 0,o=ll(this._setAlignment(t,e,i,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle"),2);e=o[0],i=o[1],t.textAlign="left",e-=this.size.width/2,this.fontOptions.valign&&this.size.height>this.size.labelHeight&&("top"===this.fontOptions.valign&&(i-=(this.size.height-this.size.labelHeight)/2),"bottom"===this.fontOptions.valign&&(i+=(this.size.height-this.size.labelHeight)/2));for(var r=0;r<this.lineCount;r++){var s=this.lines[r];if(s&&s.blocks){var a=0;this.isEdgeLabel||"center"===this.fontOptions.align?a+=(this.size.width-s.width)/2:"right"===this.fontOptions.align&&(a+=this.size.width-s.width);for(var l=0;l<s.blocks.length;l++){var c=s.blocks[l];t.font=c.font;var h=ll(this._getColor(c.color,n,c.strokeColor),2),d=h[0],u=h[1];c.strokeWidth>0&&(t.lineWidth=c.strokeWidth,t.strokeStyle=u,t.lineJoin="round"),t.fillStyle=d,c.strokeWidth>0&&t.strokeText(c.text,e+a,i+c.vadjust),t.fillText(c.text,e+a,i+c.vadjust),a+=c.width}i+=s.height}}}},{key:"_setAlignment",value:function(t,e,i,n){return this.isEdgeLabel&&"horizontal"!==this.fontOptions.align&&!1===this.pointToSelf?(e=0,i=0,"top"===this.fontOptions.align?(t.textBaseline="alphabetic",i-=4):"bottom"===this.fontOptions.align?(t.textBaseline="hanging",i+=4):t.textBaseline="middle"):t.textBaseline=n,[e,i]}},{key:"_getColor",value:function(t,e,i){var n=t||"#000000",o=i||"#ffffff";if(e<=this.elementOptions.scaling.label.drawThreshold){var r=Math.max(0,Math.min(1,1-(this.elementOptions.scaling.label.drawThreshold-e)));n=Fu(n,r),o=Fu(o,r)}return[n,o]}},{key:"getTextSize",value:function(t){return this._processLabel(t,arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments.length>2&&void 0!==arguments[2]&&arguments[2]),{width:this.size.width,height:this.size.height,lineCount:this.lineCount}}},{key:"getSize",value:function(){var t=this.size.left,e=this.size.top-1;if(this.isEdgeLabel){var i=.5*-this.size.width;switch(this.fontOptions.align){case"middle":t=i,e=.5*-this.size.height;break;case"top":t=i,e=-(this.size.height+2);break;case"bottom":t=i,e=2}}return{left:t,top:e,width:this.size.width,height:this.size.height}}},{key:"calculateLabelSize",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"middle";this._processLabel(t,e,i),this.size.left=n-.5*this.size.width,this.size.top=o-.5*this.size.height,this.size.yLine=o+.5*(1-this.lineCount)*this.fontOptions.size,"hanging"===r&&(this.size.top+=.5*this.fontOptions.size,this.size.top+=4,this.size.yLine+=4)}},{key:"getFormattingValues",value:function(t,e,i,n){var o=function(t,e,i){return"normal"===e?"mod"===i?"":t[i]:void 0!==t[e][i]?t[e][i]:t[i]},r={color:o(this.fontOptions,n,"color"),size:o(this.fontOptions,n,"size"),face:o(this.fontOptions,n,"face"),mod:o(this.fontOptions,n,"mod"),vadjust:o(this.fontOptions,n,"vadjust"),strokeWidth:this.fontOptions.strokeWidth,strokeColor:this.fontOptions.strokeColor};(e||i)&&("normal"===n&&!0===this.fontOptions.chooser&&this.elementOptions.labelHighlightBold?r.mod="bold":"function"==typeof this.fontOptions.chooser&&this.fontOptions.chooser(r,this.elementOptions.id,e,i));var s="";return void 0!==r.mod&&""!==r.mod&&(s+=r.mod+" "),t.font=(s+=r.size+"px "+r.face).replace(/"/g,""),r.font=t.font,r.height=r.size,r}},{key:"differentState",value:function(t,e){return t!==this.selectedState||e!==this.hoverState}},{key:"_processLabelText",value:function(t,e,i,n){return new kg(t,this,e,i).process(n)}},{key:"_processLabel",value:function(t,e,i){if(!1!==this.labelDirty||this.differentState(e,i)){var n=this._processLabelText(t,e,i,this.elementOptions.label);this.fontOptions.minWdt>0&&n.width<this.fontOptions.minWdt&&(n.width=this.fontOptions.minWdt),this.size.labelHeight=n.height,this.fontOptions.minHgt>0&&n.height<this.fontOptions.minHgt&&(n.height=this.fontOptions.minHgt),this.lines=n.lines,this.lineCount=n.lines.length,this.size.width=n.width,this.size.height=n.height,this.selectedState=e,this.hoverState=i,this.labelDirty=!1}}},{key:"visible",value:function(){return 0!==this.size.width&&0!==this.size.height&&void 0!==this.elementOptions.label&&!(this.fontOptions.size*this.body.view.scale<this.elementOptions.scaling.label.drawThreshold-1)}}],[{key:"parseFontString",value:function(t,e){if(!e||"string"!=typeof e)return!1;var i=e.split(" ");return t.size=+i[0].replace("px",""),t.face=i[1],t.color=i[2],!0}}]),t}(),Cg=oe,Eg=Ft,Tg=Ht,Sg=C,Ag=vn,Og=Ye,Ig=s,Pg=O("Reflect","construct"),Mg=Ig(function(){function t(){}return!(Pg(function(){},[],t)instanceof t)}),Dg=!Ig(function(){Pg(function(){})}),Ng=Mg||Dg;Cg({target:"Reflect",stat:!0,forced:Ng,sham:Ng},{construct:function(t,e){Eg(t),Tg(e);var i=arguments.length<3?t:Eg(arguments[2]);if(Dg&&!Mg)return Pg(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(Og.apply(t,n))}var o=i.prototype,r=Ag(Sg(o)?o:Object.prototype),s=Function.apply.call(t,r,e);return Sg(s)?s:r}});var Rg=E.Reflect.construct,zg=sh;oe({target:"Object",stat:!0},{setPrototypeOf:Hn});var Fg=E.Object.setPrototypeOf;function Lg(t,e){return(Lg=Fg||function(t,e){return t.__proto__=e,t})(t,e)}function Bg(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=zg(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lg(t,e)}function jg(t,e){if(e&&("object"===hl(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}var Vg=wc;function Hg(t){return(Hg=Fg?Vg:function(t){return t.__proto__||Vg(t)})(t)}var Wg=function(){function t(e,i,n){pa(this,t),this.body=i,this.labelModule=n,this.setOptions(e),this.top=void 0,this.left=void 0,this.height=void 0,this.width=void 0,this.radius=void 0,this.margin=void 0,this.refreshNeeded=!0,this.boundingBox={top:0,left:0,right:0,bottom:0}}return va(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"_setMargins",value:function(t){this.margin={},this.options.margin&&("object"==hl(this.options.margin)?(this.margin.top=this.options.margin.top,this.margin.right=this.options.margin.right,this.margin.bottom=this.options.margin.bottom,this.margin.left=this.options.margin.left):(this.margin.top=this.options.margin,this.margin.right=this.options.margin,this.margin.bottom=this.options.margin,this.margin.left=this.options.margin)),t.adjustSizes(this.margin)}},{key:"_distanceToBorder",value:function(t,e){var i=this.options.borderWidth;return t&&this.resize(t),Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}},{key:"enableShadow",value:function(t,e){e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"enableBorderDashes",value:function(t,e){if(!1!==e.borderDashes)if(void 0!==t.setLineDash){var i=e.borderDashes;!0===i&&(i=[5,15]),t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1}},{key:"disableBorderDashes",value:function(t,e){!1!==e.borderDashes&&(void 0!==t.setLineDash?t.setLineDash([0]):(console.warn("setLineDash is not supported in this browser. The dashed borders cannot be used."),this.options.shapeProperties.borderDashes=!1,e.borderDashes=!1))}},{key:"needsRefresh",value:function(t,e){return!0===this.refreshNeeded?(this.refreshNeeded=!1,!0):void 0===this.width||this.labelModule.differentState(t,e)}},{key:"initContextForDraw",value:function(t,e){t.lineWidth=Math.min(this.width,e.borderWidth/this.body.view.scale),t.strokeStyle=e.borderColor,t.fillStyle=e.color}},{key:"performStroke",value:function(t,e){var i=e.borderWidth/this.body.view.scale;t.save(),i>0&&(this.enableBorderDashes(t,e),t.stroke(),this.disableBorderDashes(t,e)),t.restore()}},{key:"performFill",value:function(t,e){t.save(),t.fillStyle=e.color,this.enableShadow(t,e),Sh(t).call(t),this.disableShadow(t,e),t.restore(),this.performStroke(t,e)}},{key:"_addBoundingBoxMargin",value:function(t){this.boundingBox.left-=t,this.boundingBox.top-=t,this.boundingBox.bottom+=t,this.boundingBox.right+=t}},{key:"_updateBoundingBox",value:function(t,e,i,n,o){void 0!==i&&this.resize(i,n,o),this.left=t-this.width/2,this.top=e-this.height/2,this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o)}},{key:"getDimensionsFromLabel",value:function(t,e,i){this.textSize=this.labelModule.getTextSize(t,e,i);var n=this.textSize.width,o=this.textSize.height;return 0===n&&(n=14,o=14),{width:n,height:o}}}]),t}(),qg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.width=n.width+this.margin.right+this.margin.left,this.height=n.height+this.margin.top+this.margin.bottom,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),Je(t,this.left,this.top,this.width,this.height,r.borderRadius),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"updateBoundingBox",value:function(t,e,i,n,o){this._updateBoundingBox(t,e,i,n,o),this._addBoundingBoxMargin(this.options.shapeProperties.borderRadius)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=this.options.borderWidth;return Math.min(Math.abs(this.width/2/Math.cos(e)),Math.abs(this.height/2/Math.sin(e)))+i}}]),i}(Wg),Ug=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o)).labelOffset=0,r.selected=!1,r}return va(i,[{key:"setOptions",value:function(t,e,i){this.options=t,void 0===e&&void 0===i||this.setImages(e,i)}},{key:"setImages",value:function(t,e){e&&this.selected?(this.imageObj=e,this.imageObjAlt=t):(this.imageObj=t,this.imageObjAlt=e)}},{key:"switchImages",value:function(t){var e=t&&!this.selected||!t&&this.selected;if(this.selected=t,void 0!==this.imageObjAlt&&e){var i=this.imageObj;this.imageObj=this.imageObjAlt,this.imageObjAlt=i}}},{key:"_getImagePadding",value:function(){var t={top:0,right:0,bottom:0,left:0};if(this.options.imagePadding){var e=this.options.imagePadding;"object"==hl(e)?(t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left):(t.top=e,t.right=e,t.bottom=e,t.left=e)}return t}},{key:"_resizeImage",value:function(){var t,e;if(!1===this.options.shapeProperties.useImageSize){var i=1,n=1;this.imageObj.width&&this.imageObj.height&&(this.imageObj.width>this.imageObj.height?i=this.imageObj.width/this.imageObj.height:n=this.imageObj.height/this.imageObj.width),t=2*this.options.size*i,e=2*this.options.size*n}else{var o=this._getImagePadding();t=this.imageObj.width+o.left+o.right,e=this.imageObj.height+o.top+o.bottom}this.width=t,this.height=e,this.radius=.5*this.width}},{key:"_drawRawCircle",value:function(t,e,i,n){this.initContextForDraw(t,n),Qe(t,e,i,n.size),this.performFill(t,n)}},{key:"_drawImageAtPosition",value:function(t,e){if(0!=this.imageObj.width){t.globalAlpha=void 0!==e.opacity?e.opacity:1,this.enableShadow(t,e);var i=1;!0===this.options.shapeProperties.interpolation&&(i=this.imageObj.width/this.width/this.body.view.scale);var n=this._getImagePadding();this.imageObj.drawImageAtPosition(t,i,this.left+n.left,this.top+n.top,this.width-n.left-n.right,this.height-n.top-n.bottom),this.disableShadow(t,e)}}},{key:"_drawImageLabel",value:function(t,e,i,n,o){var r=0;if(void 0!==this.height){r=.5*this.height;var s=this.labelModule.getTextSize(t,n,o);s.lineCount>=1&&(r+=s.height/2)}var a=i+r;this.options.label&&(this.labelOffset=r),this.labelModule.draw(t,e,a,n,o,"hanging")}}]),i}(Wg),Yg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i),o=Math.max(n.width+this.margin.right+this.margin.left,n.height+this.margin.top+this.margin.bottom);this.options.size=o/2,this.width=o,this.height=o,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this._drawRawCircle(t,e,i,r),this.updateBoundingBox(e,i),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,i,n,o)}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),i}(Ug),Gg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o,r,s){var a;return pa(this,i),(a=e.call(this,t,n,o)).setImages(r,s),a}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;return this.width=n,this.height=n,void(this.radius=.5*this.width)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){this.switchImages(n),this.resize();var s=e,a=i;"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),this._drawRawCircle(t,s,a,r),t.save(),t.clip(),this._drawImageAtPosition(t,r),t.restore(),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i)}},{key:"updateBoundingBox",value:function(t,e){"top-left"===this.options.shapeProperties.coordinateOrigin?(this.boundingBox.top=e,this.boundingBox.left=t,this.boundingBox.right=t+2*this.options.size,this.boundingBox.bottom=e+2*this.options.size):(this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size),this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),.5*this.width}}]),i}(Ug),Zg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{size:this.options.size};if(this.needsRefresh(e,i)){var o,r;this.labelModule.getTextSize(t,e,i);var s=2*n.size;this.width=null!==(o=this.customSizeWidth)&&void 0!==o?o:s,this.height=null!==(r=this.customSizeHeight)&&void 0!==r?r:s,this.radius=.5*this.width}}},{key:"_drawShape",value:function(t,e,i,n,o,r,s,a){var l,c=this;return this.resize(t,r,s,a),this.left=n-this.width/2,this.top=o-this.height/2,this.initContextForDraw(t,a),(l=e,Object.prototype.hasOwnProperty.call(ni,l)?ni[l]:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];CanvasRenderingContext2D.prototype[l].call(t,i)})(t,n,o,a.size),this.performFill(t,a),void 0!==this.options.icon&&void 0!==this.options.icon.code&&(t.font=(r?"bold ":"")+this.height/2+"px "+(this.options.icon.face||"FontAwesome"),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",t.fillText(this.options.icon.code,n,o)),{drawExternalLabel:function(){void 0!==c.options.label&&(c.labelModule.calculateLabelSize(t,r,s,n,o,"hanging"),c.labelModule.draw(t,n,o+.5*c.height+.5*c.labelModule.size.height,r,s,"hanging")),c.updateBoundingBox(n,o)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-this.options.size,this.boundingBox.left=t-this.options.size,this.boundingBox.right=t+this.options.size,this.boundingBox.bottom=e+this.options.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height))}}]),i}(Wg);function $g(t,e){var i=Cl(t);if(Bs){var n=Bs(t);e&&(n=Ec(n).call(n,function(e){return $s(t,e).enumerable})),i.push.apply(i,n)}return i}function Xg(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nl(i=$g(Object(n),!0)).call(i,function(e){ya(t,e,n[e])});else if(oa)la(t,oa(n));else{var o;Nl(o=$g(Object(n))).call(o,function(e){fa(t,e,$s(n,e))})}}return t}var Kg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o,r){var s;return pa(this,i),(s=e.call(this,t,n,o,r)).ctxRenderer=r,s}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o,r),this.left=e-this.width/2,this.top=i-this.height/2,t.save();var s=this.ctxRenderer({ctx:t,id:this.options.id,x:e,y:i,state:{selected:n,hover:o},style:Xg({},r),label:this.options.label});if(null!=s.drawNode&&s.drawNode(),t.restore(),s.drawExternalLabel){var a=s.drawExternalLabel;s.drawExternalLabel=function(){t.save(),a(),t.restore()}}return s.nodeDimensions&&(this.customSizeWidth=s.nodeDimensions.width,this.customSizeHeight=s.nodeDimensions.height),s}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),Qg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return va(i,[{key:"resize",value:function(t,e,i){if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i).width+this.margin.right+this.margin.left;this.width=n,this.height=n,this.radius=this.width/2}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.initContextForDraw(t,r),ei(t,e-this.width/2,i-this.height/2,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Wg),Jg=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"diamond",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),tm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"circle",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t){return t&&this.resize(t),this.options.size}}]),i}(Zg),em=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(this.needsRefresh(e,i)){var n=this.getDimensionsFromLabel(t,e,i);this.height=2*n.height,this.width=n.width+n.height,this.radius=.5*this.width}}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-.5*this.width,this.top=i-.5*this.height,this.initContextForDraw(t,r),ti(t,this.left,this.top,this.width,this.height),this.performFill(t,r),this.updateBoundingBox(e,i,t,n,o),this.labelModule.draw(t,e,i,n,o)}},{key:"distanceToBorder",value:function(t,e){t&&this.resize(t);var i=.5*this.width,n=.5*this.height,o=Math.sin(e)*i,r=Math.cos(e)*n;return i*n/Math.sqrt(o*o+r*r)}}]),i}(Wg),im=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return va(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.iconSize={width:Number(this.options.icon.size),height:Number(this.options.icon.size)},this.width=this.iconSize.width+this.margin.right+this.margin.left,this.height=this.iconSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){var s=this;return this.resize(t,n,o),this.options.icon.size=this.options.icon.size||50,this.left=e-this.width/2,this.top=i-this.height/2,this._icon(t,e,i,n,o,r),{drawExternalLabel:function(){void 0!==s.options.label&&s.labelModule.draw(t,s.left+s.iconSize.width/2+s.margin.left,i+s.height/2+5,n),s.updateBoundingBox(e,i)}}}},{key:"updateBoundingBox",value:function(t,e){this.boundingBox.top=e-.5*this.options.icon.size,this.boundingBox.left=t-.5*this.options.icon.size,this.boundingBox.right=t+.5*this.options.icon.size,this.boundingBox.bottom=e+.5*this.options.icon.size,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelModule.size.height+5))}},{key:"_icon",value:function(t,e,i,n,o,r){var s=Number(this.options.icon.size);void 0!==this.options.icon.code?(t.font=[null!=this.options.icon.weight?this.options.icon.weight:n?"bold":"",(null!=this.options.icon.weight&&n?5:0)+s+"px",this.options.icon.face].join(" "),t.fillStyle=this.options.icon.color||"black",t.textAlign="center",t.textBaseline="middle",this.enableShadow(t,r),t.fillText(this.options.icon.code,e,i),this.disableShadow(t,r)):console.error("When using the icon shape, you need to define the code in the icon options object. This can be done per node or globally.")}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Wg),nm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o,r,s){var a;return pa(this,i),(a=e.call(this,t,n,o)).setImages(r,s),a}return va(i,[{key:"resize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selected,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hover;if(void 0===this.imageObj.src||void 0===this.imageObj.width||void 0===this.imageObj.height){var n=2*this.options.size;return this.width=n,void(this.height=n)}this.needsRefresh(e,i)&&this._resizeImage()}},{key:"draw",value:function(t,e,i,n,o,r){t.save(),this.switchImages(n),this.resize();var s=e,a=i;if("top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=e,this.top=i,s+=this.width/2,a+=this.height/2):(this.left=e-this.width/2,this.top=i-this.height/2),!0===this.options.shapeProperties.useBorderWithImage){t.lineWidth=Math.min(this.width,(n?this.options.borderWidthSelected||2*this.options.borderWidth:this.options.borderWidth)/this.body.view.scale),t.beginPath();var l=n?this.options.color.highlight.border:o?this.options.color.hover.border:this.options.color.border,c=n?this.options.color.highlight.background:o?this.options.color.hover.background:this.options.color.background;void 0!==r.opacity&&(l=Fu(l,r.opacity),c=Fu(c,r.opacity)),t.strokeStyle=l,t.fillStyle=c,t.rect(this.left-.5*t.lineWidth,this.top-.5*t.lineWidth,this.width+t.lineWidth,this.height+t.lineWidth),Sh(t).call(t),this.performStroke(t,r),t.closePath()}this._drawImageAtPosition(t,r),this._drawImageLabel(t,s,a,n,o),this.updateBoundingBox(e,i),t.restore()}},{key:"updateBoundingBox",value:function(t,e){this.resize(),"top-left"===this.options.shapeProperties.coordinateOrigin?(this.left=t,this.top=e):(this.left=t-this.width/2,this.top=e-this.height/2),this.boundingBox.left=this.left,this.boundingBox.top=this.top,this.boundingBox.bottom=this.top+this.height,this.boundingBox.right=this.left+this.width,void 0!==this.options.label&&this.labelModule.size.width>0&&(this.boundingBox.left=Math.min(this.boundingBox.left,this.labelModule.size.left),this.boundingBox.right=Math.max(this.boundingBox.right,this.labelModule.size.left+this.labelModule.size.width),this.boundingBox.bottom=Math.max(this.boundingBox.bottom,this.boundingBox.bottom+this.labelOffset))}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Ug),om=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"square",2,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),rm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"hexagon",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),sm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"star",4,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),am=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._setMargins(o),r}return va(i,[{key:"resize",value:function(t,e,i){this.needsRefresh(e,i)&&(this.textSize=this.labelModule.getTextSize(t,e,i),this.width=this.textSize.width+this.margin.right+this.margin.left,this.height=this.textSize.height+this.margin.top+this.margin.bottom,this.radius=.5*this.width)}},{key:"draw",value:function(t,e,i,n,o,r){this.resize(t,n,o),this.left=e-this.width/2,this.top=i-this.height/2,this.enableShadow(t,r),this.labelModule.draw(t,this.left+this.textSize.width/2+this.margin.left,this.top+this.textSize.height/2+this.margin.top,n,o),this.disableShadow(t,r),this.updateBoundingBox(e,i,t,n,o)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Wg),lm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"triangle",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg),cm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"draw",value:function(t,e,i,n,o,r){return this._drawShape(t,"triangleDown",3,e,i,n,o,r)}},{key:"distanceToBorder",value:function(t,e){return this._distanceToBorder(t,e)}}]),i}(Zg);function hm(t,e){var i=Cl(t);if(Bs){var n=Bs(t);e&&(n=Ec(n).call(n,function(e){return $s(t,e).enumerable})),i.push.apply(i,n)}return i}function dm(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nl(i=hm(Object(n),!0)).call(i,function(e){ya(t,e,n[e])});else if(oa)la(t,oa(n));else{var o;Nl(o=hm(Object(n))).call(o,function(e){fa(t,e,$s(n,e))})}}return t}var um=function(){function t(e,i,n,o,r,s){pa(this,t),this.options=Yu(r),this.globalOptions=r,this.defaultOptions=s,this.body=i,this.edges=[],this.id=void 0,this.imagelist=n,this.grouplist=o,this.x=void 0,this.y=void 0,this.baseSize=this.options.size,this.baseFontSize=this.options.font.size,this.predefinedPosition=!1,this.selected=!1,this.hover=!1,this.labelModule=new xg(this.body,this.options,!1),this.setOptions(e)}return va(t,[{key:"attachEdge",value:function(t){var e;-1===eh(e=this.edges).call(e,t)&&this.edges.push(t)}},{key:"detachEdge",value:function(t){var e,i,n=eh(e=this.edges).call(e,t);-1!=n&&ec(i=this.edges).call(i,n,1)}},{key:"setOptions",value:function(e){var i=this.options.shape;if(e){if(void 0!==e.color&&(this._localColor=e.color),void 0!==e.id&&(this.id=e.id),void 0===this.id)throw new Error("Node must have an id");return t.checkMass(e,this.id),void 0!==e.x&&(null===e.x?(this.x=void 0,this.predefinedPosition=!1):(this.x=Yc(e.x),this.predefinedPosition=!0)),void 0!==e.y&&(null===e.y?(this.y=void 0,this.predefinedPosition=!1):(this.y=Yc(e.y),this.predefinedPosition=!0)),void 0!==e.size&&(this.baseSize=e.size),void 0!==e.value&&(e.value=sg(e.value)),t.parseOptions(this.options,e,!0,this.globalOptions,this.grouplist),this.chooser=cg("node",[e,this.options,this.defaultOptions]),this._load_images(),this.updateLabelModule(e),void 0!==e.opacity&&t.checkOpacity(e.opacity)&&(this.options.opacity=e.opacity),this.updateShape(i),void 0!==e.hidden||void 0!==e.physics}}},{key:"_load_images",value:function(){if(("circularImage"===this.options.shape||"image"===this.options.shape)&&void 0===this.options.image)throw new Error("Option image must be defined for node type '"+this.options.shape+"'");if(void 0!==this.options.image){if(void 0===this.imagelist)throw new Error("Internal Error: No images provided");if("string"==typeof this.options.image)this.imageObj=this.imagelist.load(this.options.image,this.options.brokenImage,this.id);else{if(void 0===this.options.image.unselected)throw new Error("No unselected image provided");this.imageObj=this.imagelist.load(this.options.image.unselected,this.options.brokenImage,this.id),this.imageObjAlt=void 0!==this.options.image.selected?this.imagelist.load(this.options.image.selected,this.options.brokenImage,this.id):void 0}}}},{key:"getFormattingValues",value:function(){var t={color:this.options.color.background,opacity:this.options.opacity,borderWidth:this.options.borderWidth,borderColor:this.options.color.border,size:this.options.size,borderDashes:this.options.shapeProperties.borderDashes,borderRadius:this.options.shapeProperties.borderRadius,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y};if(this.selected||this.hover?!0===this.chooser?this.selected?(null!=this.options.borderWidthSelected?t.borderWidth=this.options.borderWidthSelected:t.borderWidth*=2,t.color=this.options.color.highlight.background,t.borderColor=this.options.color.highlight.border,t.shadow=this.options.shadow.enabled):this.hover&&(t.color=this.options.color.hover.background,t.borderColor=this.options.color.hover.border,t.shadow=this.options.shadow.enabled):"function"==typeof this.chooser&&(this.chooser(t,this.options.id,this.selected,this.hover),!1===t.shadow&&(t.shadowColor===this.options.shadow.color&&t.shadowSize===this.options.shadow.size&&t.shadowX===this.options.shadow.x&&t.shadowY===this.options.shadow.y||(t.shadow=!0))):t.shadow=this.options.shadow.enabled,void 0!==this.options.opacity){var e=this.options.opacity;t.borderColor=Fu(t.borderColor,e),t.color=Fu(t.color,e),t.shadowColor=Fu(t.shadowColor,e)}return t}},{key:"updateLabelModule",value:function(e){null!=this.options.label||(this.options.label=""),t.updateGroupOptions(this.options,dm(dm({},e),{},{color:e&&e.color||this._localColor||void 0}),this.grouplist);var i=this.grouplist.get(this.options.group,!1);this.labelModule.update(this.options,[e,this.options,i,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateShape",value:function(t){if(t===this.options.shape&&this.shape)this.shape.setOptions(this.options,this.imageObj,this.imageObjAlt);else switch(this.options.shape){case"box":this.shape=new qg(this.options,this.body,this.labelModule);break;case"circle":this.shape=new Yg(this.options,this.body,this.labelModule);break;case"circularImage":this.shape=new Gg(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"custom":this.shape=new Kg(this.options,this.body,this.labelModule,this.options.ctxRenderer);break;case"database":this.shape=new Qg(this.options,this.body,this.labelModule);break;case"diamond":this.shape=new Jg(this.options,this.body,this.labelModule);break;case"dot":this.shape=new tm(this.options,this.body,this.labelModule);break;case"ellipse":this.shape=new em(this.options,this.body,this.labelModule);break;case"icon":this.shape=new im(this.options,this.body,this.labelModule);break;case"image":this.shape=new nm(this.options,this.body,this.labelModule,this.imageObj,this.imageObjAlt);break;case"square":this.shape=new om(this.options,this.body,this.labelModule);break;case"hexagon":this.shape=new rm(this.options,this.body,this.labelModule);break;case"star":this.shape=new sm(this.options,this.body,this.labelModule);break;case"text":this.shape=new am(this.options,this.body,this.labelModule);break;case"triangle":this.shape=new lm(this.options,this.body,this.labelModule);break;case"triangleDown":this.shape=new cm(this.options,this.body,this.labelModule);break;default:this.shape=new em(this.options,this.body,this.labelModule)}this.needsRefresh()}},{key:"select",value:function(){this.selected=!0,this.needsRefresh()}},{key:"unselect",value:function(){this.selected=!1,this.needsRefresh()}},{key:"needsRefresh",value:function(){this.shape.refreshNeeded=!0}},{key:"getTitle",value:function(){return this.options.title}},{key:"distanceToBorder",value:function(t,e){return this.shape.distanceToBorder(t,e)}},{key:"isFixed",value:function(){return this.options.fixed.x&&this.options.fixed.y}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"getLabelSize",value:function(){return this.labelModule.size()}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.size=this.options.scaling.min+n*o}else this.options.size=this.baseSize,this.options.font.size=this.baseFontSize;this.updateLabelModule()}},{key:"draw",value:function(t){var e=this.getFormattingValues();return this.shape.draw(t,this.x,this.y,this.selected,this.hover,e)||{}}},{key:"updateBoundingBox",value:function(t){this.shape.updateBoundingBox(this.x,this.y,t)}},{key:"resize",value:function(t){var e=this.getFormattingValues();this.shape.resize(t,this.selected,this.hover,e)}},{key:"getItemsOnPoint",value:function(t){var e=[];return this.labelModule.visible()&&hg(this.labelModule.getSize(),t)&&e.push({nodeId:this.id,labelId:0}),hg(this.shape.boundingBox,t)&&e.push({nodeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return this.shape.left<t.right&&this.shape.left+this.shape.width>t.left&&this.shape.top<t.bottom&&this.shape.top+this.shape.height>t.top}},{key:"isBoundingBoxOverlappingWith",value:function(t){return this.shape.boundingBox.left<t.right&&this.shape.boundingBox.right>t.left&&this.shape.boundingBox.top<t.bottom&&this.shape.boundingBox.bottom>t.top}}],[{key:"checkOpacity",value:function(t){return 0<=t&&t<=1}},{key:"checkCoordinateOrigin",value:function(t){return void 0===t||"center"===t||"top-left"===t}},{key:"updateGroupOptions",value:function(e,i,n){var o;if(void 0!==n){var r=e.group;if(void 0!==i&&void 0!==i.group&&r!==i.group)throw new Error("updateGroupOptions: group values in options don't match.");if("number"==typeof r||"string"==typeof r&&""!=r){var s=n.get(r);void 0!==s.opacity&&void 0===i.opacity&&(t.checkOpacity(s.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+s.opacity),s.opacity=void 0));var a=Ec(o=function(t){return lg.getOwnPropertyNames(t)}(i)).call(o,function(t){return null!=i[t]});a.push("font"),Iu(a,e,s),e.color=Bu(e.color)}}}},{key:"parseOptions",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4?arguments[4]:void 0;if(Iu(["color","fixed","shadow"],e,i,n),t.checkMass(i),void 0!==e.opacity&&(t.checkOpacity(e.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+e.opacity),e.opacity=void 0)),void 0!==i.opacity&&(t.checkOpacity(i.opacity)||(console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+i.opacity),i.opacity=void 0)),i.shapeProperties&&!t.checkCoordinateOrigin(i.shapeProperties.coordinateOrigin)&&console.error("Invalid option for node coordinateOrigin, found: "+i.shapeProperties.coordinateOrigin),Gu(e,i,"shadow",o),null!=i.color){var s=Bu(i.color);Au(e.color,s)}else!0===n&&null===i.color&&(e.color=Yu(o.color));null!=i.fixed&&("boolean"==typeof i.fixed?(e.fixed.x=i.fixed,e.fixed.y=i.fixed):(void 0!==i.fixed.x&&"boolean"==typeof i.fixed.x&&(e.fixed.x=i.fixed.x),void 0!==i.fixed.y&&"boolean"==typeof i.fixed.y&&(e.fixed.y=i.fixed.y))),!0===n&&null===i.font&&(e.font=Yu(o.font)),t.updateGroupOptions(e,i,r),void 0!==i.scaling&&Gu(e.scaling,i.scaling,"label",o.scaling)}},{key:"checkMass",value:function(t,e){if(void 0!==t.mass&&t.mass<=0){var i="";void 0!==e&&(i=" in node id: "+e),console.error("%cNegative or zero mass disallowed"+i+", setting mass to 1.",af),t.mass=1}}}]),t}();function fm(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var pm=function(){function t(e,i,n,o){var r,s=this;if(pa(this,t),this.body=e,this.images=i,this.groups=n,this.layoutEngine=o,this.body.functions.createNode=Ke(r=this.create).call(r,this),this.nodesListeners={add:function(t,e){s.add(e.items)},update:function(t,e){s.update(e.items,e.data,e.oldData)},remove:function(t,e){s.remove(e.items)}},this.defaultOptions={borderWidth:1,borderWidthSelected:void 0,brokenImage:void 0,color:{border:"#2B7CE9",background:"#97C2FC",highlight:{border:"#2B7CE9",background:"#D2E5FF"},hover:{border:"#2B7CE9",background:"#D2E5FF"}},opacity:void 0,fixed:{x:!1,y:!1},font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:0,strokeColor:"#ffffff",align:"center",vadjust:0,multi:!1,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"monospace",vadjust:2}},group:void 0,hidden:!1,icon:{face:"FontAwesome",code:void 0,size:50,color:"#2B7CE9"},image:void 0,imagePadding:{top:0,right:0,bottom:0,left:0},label:void 0,labelHighlightBold:!0,level:void 0,margin:{top:5,right:5,bottom:5,left:5},mass:1,physics:!0,scaling:{min:10,max:30,label:{enabled:!1,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},shape:"ellipse",shapeProperties:{borderDashes:!1,borderRadius:6,interpolation:!0,useImageSize:!1,useBorderWithImage:!1,coordinateOrigin:"center"},size:25,title:void 0,value:void 0,x:void 0,y:void 0},this.defaultOptions.mass<=0)throw"Internal error: mass in defaultOptions of NodesHandler may not be zero or negative";this.options=Yu(this.defaultOptions),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("refreshNodes",Ke(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",Ke(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){Ru(i.nodesListeners,function(t,e){i.body.data.nodes&&i.body.data.nodes.off(e,t)}),delete i.body.functions.createNode,delete i.nodesListeners.add,delete i.nodesListeners.update,delete i.nodesListeners.remove,delete i.nodesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){if(um.parseOptions(this.options,t),void 0!==t.opacity&&(Xp(t.opacity)||!Qp(t.opacity)||t.opacity<0||t.opacity>1?console.error("Invalid option for node opacity. Value must be between 0 and 1, found: "+t.opacity):this.options.opacity=t.opacity),void 0!==t.shape)for(var e in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&this.body.nodes[e].updateShape();if(void 0!==t.font||void 0!==t.widthConstraint||void 0!==t.heightConstraint)for(var i=0,n=Cl(this.body.nodes);i<n.length;i++){var o=n[i];this.body.nodes[o].updateLabelModule(),this.body.nodes[o].needsRefresh()}if(void 0!==t.size)for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.body.nodes[r].needsRefresh();void 0===t.hidden&&void 0===t.physics||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.body.data.nodes;if(e.isDataViewLike("id",t))this.body.data.nodes=t;else if(vl(t))this.body.data.nodes=new e.DataSet,this.body.data.nodes.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.nodes=new e.DataSet}if(n&&Ru(this.nodesListeners,function(t,e){n.off(e,t)}),this.body.nodes={},this.body.data.nodes){var o=this;Ru(this.nodesListeners,function(t,e){o.body.data.nodes.on(e,t)});var r=this.body.data.nodes.getIds();this.add(r,!0)}!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[],o=0;o<t.length;o++){var r=this.body.data.nodes.get(e=t[o]),s=this.create(r);n.push(s),this.body.nodes[e]=s}this.layoutEngine.positionInitially(n),!1===i&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t,e,i){for(var n=this.body.nodes,o=!1,r=0;r<t.length;r++){var s=t[r],a=n[s],l=e[r];void 0!==a?a.setOptions(l)&&(o=!0):(o=!0,a=this.create(l),n[s]=a)}o||void 0===i||(o=function(t){var e=t.some;return t===eg||t instanceof Array&&e===eg.some?tg:e}(e).call(e,function(t,e){var n=i[e];return n&&n.level!==t.level})),this.body.emitter.emit(!0===o?"_dataChanged":"_dataUpdated")}},{key:"remove",value:function(t){for(var e=this.body.nodes,i=0;i<t.length;i++)delete e[t[i]];this.body.emitter.emit("_dataChanged")}},{key:"create",value:function(t){return new(arguments.length>1&&void 0!==arguments[1]?arguments[1]:um)(t,this.body,this.images,this.groups,this.options,this.defaultOptions)}},{key:"refresh",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ru(this.body.nodes,function(i,n){var o=t.body.data.nodes.get(n);void 0!==o&&(!0===e&&i.setOptions({x:null,y:null}),i.setOptions({fixed:!1}),i.setOptions(o))})}},{key:"getPositions",value:function(t){var e={};if(void 0!==t){if(!0===vl(t)){for(var i=0;i<t.length;i++)if(void 0!==this.body.nodes[t[i]]){var n=this.body.nodes[t[i]];e[t[i]]={x:Math.round(n.x),y:Math.round(n.y)}}}else if(void 0!==this.body.nodes[t]){var o=this.body.nodes[t];e[t]={x:Math.round(o.x),y:Math.round(o.y)}}}else for(var r=0;r<this.body.nodeIndices.length;r++){var s=this.body.nodes[this.body.nodeIndices[r]];e[this.body.nodeIndices[r]]={x:Math.round(s.x),y:Math.round(s.y)}}return e}},{key:"getPosition",value:function(t){if(null==t)throw new TypeError("No id was specified for getPosition method.");if(null==this.body.nodes[t])throw new ReferenceError("NodeId provided for getPosition does not exist. Provided: ".concat(t));return{x:Math.round(this.body.nodes[t].x),y:Math.round(this.body.nodes[t].y)}}},{key:"storePositions",value:function(){var t,e=[],i=this.body.data.nodes.getDataSet(),n=function(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return fm(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fm(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(i.get());try{for(n.s();!(t=n.n()).done;){var o=t.value,r=o.id,s=this.body.nodes[r],a=Math.round(s.x),l=Math.round(s.y);o.x===a&&o.y===l||e.push({id:r,x:a,y:l})}}catch(t){n.e(t)}finally{n.f()}i.update(e)}},{key:"getBoundingBox",value:function(t){if(void 0!==this.body.nodes[t])return this.body.nodes[t].shape.boundingBox}},{key:"getConnectedNodes",value:function(t,e){var i=[];if(void 0!==this.body.nodes[t])for(var n=this.body.nodes[t],o={},r=0;r<n.edges.length;r++){var s=n.edges[r];"to"!==e&&s.toId==n.id?void 0===o[s.fromId]&&(i.push(s.fromId),o[s.fromId]=!0):"from"!==e&&s.fromId==n.id&&void 0===o[s.toId]&&(i.push(s.toId),o[s.toId]=!0)}return i}},{key:"getConnectedEdges",value:function(t){var e=[];if(void 0!==this.body.nodes[t])for(var i=this.body.nodes[t],n=0;n<i.edges.length;n++)e.push(i.edges[n].id);else console.error("NodeId provided for getConnectedEdges does not exist. Provided: ",t);return e}},{key:"moveNode",value:function(t,e,i){var n=this;void 0!==this.body.nodes[t]?(this.body.nodes[t].x=Number(e),this.body.nodes[t].y=Number(i),kh(function(){n.body.emitter.emit("startSimulation")},0)):console.error("Node id supplied to moveNode does not exist. Provided: ",t)}}]),t}(),gm=C,mm=Ht,vm=Q,ym=r,bm=qi;oe({target:"Reflect",stat:!0},{get:function t(e,i){var n,o,r=arguments.length<3?e:arguments[2];return mm(e)===r?e[i]:(n=ym.f(e,i))?vm(n,"value")?n.value:void 0===n.get?void 0:n.get.call(r):gm(o=bm(e))?t(o,i,r):void 0}});var wm=E.Reflect.get,km=Zs;function _m(t,e,i){return(_m="undefined"!=typeof Reflect&&wm?wm:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Hg(t)););return t}(t,e);if(n){var o=km(n,e);return o.get?o.get.call(i):o.value}})(t,e,i||t)}var xm=Math.hypot,Cm=Math.abs,Em=Math.sqrt;oe({target:"Math",stat:!0,forced:!!xm&&xm(1/0,NaN)!==1/0},{hypot:function(t,e){for(var i,n,o=0,r=0,s=arguments.length,a=0;r<s;)a<(i=Cm(arguments[r++]))?(o=o*(n=a/i)*n+1,a=i):o+=i>0?(n=i/a)*n:i;return a===1/0?1/0:a*Em(o)}});var Tm=E.Math.hypot;function Sm(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}var Am=function(){function t(){pa(this,t)}return va(t,null,[{key:"transform",value:function(t,e){vl(t)||(t=[t]);for(var i=e.point.x,n=e.point.y,o=e.angle,r=e.length,s=0;s<t.length;++s){var a=t[s],l=a.x*Math.cos(o)-a.y*Math.sin(o),c=a.x*Math.sin(o)+a.y*Math.cos(o);a.x=i+r*l,a.y=n+r*c}}},{key:"drawPath",value:function(t,e){t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;++i)t.lineTo(e[i].x,e[i].y);t.closePath()}}]),t}(),Om=function(t){Bg(i,t);var e=Sm(i);function i(){return pa(this,i),e.apply(this,arguments)}return va(i,null,[{key:"draw",value:function(t,e){if(e.image){t.save(),t.translate(e.point.x,e.point.y),t.rotate(Math.PI/2+e.angle);var i=null!=e.imageWidth?e.imageWidth:e.image.width;e.image.drawImageAtPosition(t,1,-i/2,0,i,null!=e.imageHeight?e.imageHeight:e.image.height),t.restore()}return!1}}]),i}(Am),Im=function(t){Bg(i,t);var e=Sm(i);function i(){return pa(this,i),e.apply(this,arguments)}return va(i,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-1,y:.3},{x:-.9,y:0},{x:-1,y:-.3}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),i}(Am),Pm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:0},{x:0,y:.3},{x:-.4,y:0},{x:0,y:-.3}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),Mm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};Am.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle-n/2,r=e.angle+n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),Dm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i={x:-.3,y:0};Am.transform(i,e),t.strokeStyle=t.fillStyle,t.fillStyle="rgba(0, 0, 0, 0)";var n=Math.PI,o=e.angle+n/2,r=e.angle+3*n/2;return t.beginPath(),t.arc(i.x,i.y,.4*e.length,o,r,!1),t.stroke(),!0}}]),t}(),Nm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:.02,y:0},{x:-1,y:.3},{x:-1,y:-.3}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),Rm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-1,y:0}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),zm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i={x:-.4,y:0};return Am.transform(i,e),Qe(t,i.x,i.y,.4*e.length),!0}}]),t}(),Fm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.5},{x:0,y:-.5},{x:-.15,y:-.5},{x:-.15,y:.5}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),Lm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:.3},{x:0,y:-.3},{x:-.6,y:-.3},{x:-.6,y:.3}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),Bm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:0,y:0},{x:-.5,y:-.3},{x:-1,y:0},{x:-.5,y:.3}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),jm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i=[{x:-1,y:.3},{x:-.5,y:0},{x:-1,y:-.3},{x:0,y:0}];return Am.transform(i,e),Am.drawPath(t,i),!0}}]),t}(),Vm=function(){function t(){pa(this,t)}return va(t,null,[{key:"draw",value:function(t,e){var i;switch(e.type&&(i=e.type.toLowerCase()),i){case"image":return Om.draw(t,e);case"circle":return zm.draw(t,e);case"box":return Lm.draw(t,e);case"crow":return Pm.draw(t,e);case"curve":return Mm.draw(t,e);case"diamond":return Bm.draw(t,e);case"inv_curve":return Dm.draw(t,e);case"triangle":return Nm.draw(t,e);case"inv_triangle":return Rm.draw(t,e);case"bar":return Fm.draw(t,e);case"vee":return jm.draw(t,e);case"arrow":default:return Im.draw(t,e)}}}]),t}();function Hm(t,e){var i=Cl(t);if(Bs){var n=Bs(t);e&&(n=Ec(n).call(n,function(e){return $s(t,e).enumerable})),i.push.apply(i,n)}return i}function Wm(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nl(i=Hm(Object(n),!0)).call(i,function(e){ya(t,e,n[e])});else if(oa)la(t,oa(n));else{var o;Nl(o=Hm(Object(n))).call(o,function(e){fa(t,e,$s(n,e))})}}return t}var qm=function(){function t(e,i,n){pa(this,t),this._body=i,this._labelModule=n,this.color={},this.colorDirty=!0,this.hoverWidth=1.5,this.selectionWidth=2,this.setOptions(e),this.fromPoint=this.from,this.toPoint=this.to}return va(t,[{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to]}},{key:"cleanup",value:function(){return!1}},{key:"setOptions",value:function(t){this.options=t,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.id=this.options.id}},{key:"drawLine",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.getViaNode();t.strokeStyle=this.getColor(t,e),t.lineWidth=e.width,!1!==e.dashes?this._drawDashedLine(t,e,o):this._drawLine(t,e,o)}},{key:"_drawLine",value:function(t,e,i,n,o){if(this.from!=this.to)this._line(t,e,i,n,o);else{var r=ll(this._getCircleData(t),3);this._circle(t,e,r[0],r[1],r[2])}}},{key:"_drawDashedLine",value:function(t,e,i,n,o){t.lineCap="round";var r=vl(e.dashes)?e.dashes:[5,5];if(void 0!==t.setLineDash){if(t.save(),t.setLineDash(r),t.lineDashOffset=0,this.from!=this.to)this._line(t,e,i);else{var s=ll(this._getCircleData(t),3);this._circle(t,e,s[0],s[1],s[2])}t.setLineDash([0]),t.lineDashOffset=0,t.restore()}else{if(this.from!=this.to)ii(t,this.from.x,this.from.y,this.to.x,this.to.y,r);else{var a=ll(this._getCircleData(t),3);this._circle(t,e,a[0],a[1],a[2])}this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}}},{key:"findBorderPosition",value:function(t,e,i){return this.from!=this.to?this._findBorderPosition(t,e,i):this._findBorderPositionCircle(t,e,i)}},{key:"findBorderPositions",value:function(t){if(this.from!=this.to)return{from:this._findBorderPosition(this.from,t),to:this._findBorderPosition(this.to,t)};var e,i=ll(ml(e=this._getCircleData(t)).call(e,0,2),2),n=i[0],o=i[1];return{from:this._findBorderPositionCircle(this.from,t,{x:n,y:o,low:.25,high:.6,direction:-1}),to:this._findBorderPositionCircle(this.from,t,{x:n,y:o,low:.6,high:.8,direction:1})}}},{key:"_getCircleData",value:function(t){var e=this.options.selfReference.size;void 0!==t&&void 0===this.from.shape.width&&this.from.shape.resize(t);var i=ug(t,this.options.selfReference.angle,e,this.from);return[i.x,i.y,e]}},{key:"_pointOnCircle",value:function(t,e,i,n){var o=2*n*Math.PI;return{x:t+i*Math.cos(o),y:e-i*Math.sin(o)}}},{key:"_findBorderPositionCircle",value:function(t,e,i){var n,o=i.x,r=i.y,s=i.low,a=i.high,l=i.direction,c=this.options.selfReference.size,h=.5*(s+a),d=0;!0===this.options.arrowStrikethrough&&(-1===l?d=this.options.endPointOffset.from:1===l&&(d=this.options.endPointOffset.to));var u=0;do{n=this._pointOnCircle(o,r,c,h=.5*(s+a));var f=Math.atan2(t.y-n.y,t.x-n.x),p=t.distanceToBorder(e,f)+d-Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));if(Math.abs(p)<.05)break;p>0?l>0?s=h:a=h:l>0?a=h:s=h,++u}while(s<=a&&u<10);return Wm(Wm({},n),{},{t:h})}},{key:"getLineWidth",value:function(t,e){return!0===t?Math.max(this.selectionWidth,.3/this._body.view.scale):!0===e?Math.max(this.hoverWidth,.3/this._body.view.scale):Math.max(this.options.width,.3/this._body.view.scale)}},{key:"getColor",value:function(t,e){if(!1!==e.inheritsColor){if("both"===e.inheritsColor&&this.from.id!==this.to.id){var i=t.createLinearGradient(this.from.x,this.from.y,this.to.x,this.to.y),n=this.from.options.color.highlight.border,o=this.to.options.color.highlight.border;return!1===this.from.selected&&!1===this.to.selected?(n=Fu(this.from.options.color.border,e.opacity),o=Fu(this.to.options.color.border,e.opacity)):!0===this.from.selected&&!1===this.to.selected?o=this.to.options.color.border:!1===this.from.selected&&!0===this.to.selected&&(n=this.from.options.color.border),i.addColorStop(0,n),i.addColorStop(1,o),i}return Fu("to"===e.inheritsColor?this.to.options.color.border:this.from.options.color.border,e.opacity)}return Fu(e.color,e.opacity)}},{key:"_circle",value:function(t,e,i,n,o){this.enableShadow(t,e);var r=0,s=2*Math.PI;if(!this.options.selfReference.renderBehindTheNode){var a=this.options.selfReference.angle,l=this.options.selfReference.angle+Math.PI,c=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:-1}),h=this._findBorderPositionCircle(this.from,t,{x:i,y:n,low:a,high:l,direction:1});r=Math.atan2(c.y-n,c.x-i),s=Math.atan2(h.y-n,h.x-i)}t.beginPath(),t.arc(i,n,o,r,s,!1),t.stroke(),this.disableShadow(t,e)}},{key:"getDistanceToEdge",value:function(t,e,i,n,o,r){if(this.from!=this.to)return this._getDistanceToEdge(t,e,i,n,o,r);var s=ll(this._getCircleData(void 0),3),a=s[2],l=s[0]-o,c=s[1]-r;return Math.abs(Math.sqrt(l*l+c*c)-a)}},{key:"_getDistanceToLine",value:function(t,e,i,n,o,r){var s=i-t,a=n-e,l=((o-t)*s+(r-e)*a)/(s*s+a*a);l>1?l=1:l<0&&(l=0);var c=t+l*s-o,h=e+l*a-r;return Math.sqrt(c*c+h*h)}},{key:"getArrowData",value:function(t,e,i,n,o,r){var s,a,l,c,h,d,u,f=r.width;"from"===e?(l=this.from,c=this.to,h=r.fromArrowScale<0,d=Math.abs(r.fromArrowScale),u=r.fromArrowType):"to"===e?(l=this.to,c=this.from,h=r.toArrowScale<0,d=Math.abs(r.toArrowScale),u=r.toArrowType):(l=this.to,c=this.from,h=r.middleArrowScale<0,d=Math.abs(r.middleArrowScale),u=r.middleArrowType);var p=15*d+3*f;if(l!=c){var g=p/Tm(l.x-c.x,l.y-c.y);if("middle"!==e)if(!0===this.options.smooth.enabled){var m=this._findBorderPosition(l,t,{via:i}),v=this.getPoint(m.t+g*("from"===e?1:-1),i);s=Math.atan2(m.y-v.y,m.x-v.x),a=m}else s=Math.atan2(l.y-c.y,l.x-c.x),a=this._findBorderPosition(l,t);else{var y=(h?-g:g)/2,b=this.getPoint(.5+y,i),w=this.getPoint(.5-y,i);s=Math.atan2(b.y-w.y,b.x-w.x),a=this.getPoint(.5,i)}}else{var k=ll(this._getCircleData(t),3),_=k[0],x=k[1],C=k[2];if("from"===e){var E=this.options.selfReference.angle+Math.PI,T=this._findBorderPositionCircle(this.from,t,{x:_,y:x,low:this.options.selfReference.angle,high:E,direction:-1});s=-2*T.t*Math.PI+1.5*Math.PI+.1*Math.PI,a=T}else if("to"===e){var S=this.options.selfReference.angle+Math.PI,A=this._findBorderPositionCircle(this.from,t,{x:_,y:x,low:this.options.selfReference.angle,high:S,direction:1});s=-2*A.t*Math.PI+1.5*Math.PI-1.1*Math.PI,a=A}else{var O=this.options.selfReference.angle/(2*Math.PI);a=this._pointOnCircle(_,x,C,O),s=-2*O*Math.PI+1.5*Math.PI+.1*Math.PI}}return{point:a,core:{x:a.x-.9*p*Math.cos(s),y:a.y-.9*p*Math.sin(s)},angle:s,length:p,type:u}}},{key:"drawArrowHead",value:function(t,e,i,n,o){t.strokeStyle=this.getColor(t,e),t.fillStyle=t.strokeStyle,t.lineWidth=e.width,Vm.draw(t,o)&&(this.enableShadow(t,e),Sh(t).call(t),this.disableShadow(t,e))}},{key:"enableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor=e.shadowColor,t.shadowBlur=e.shadowSize,t.shadowOffsetX=e.shadowX,t.shadowOffsetY=e.shadowY)}},{key:"disableShadow",value:function(t,e){!0===e.shadow&&(t.shadowColor="rgba(0,0,0,0)",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0)}},{key:"drawBackground",value:function(t,e){if(!1!==e.background){var i={strokeStyle:t.strokeStyle,lineWidth:t.lineWidth,dashes:t.dashes};t.strokeStyle=e.backgroundColor,t.lineWidth=e.backgroundSize,this.setStrokeDashed(t,e.backgroundDashes),t.stroke(),t.strokeStyle=i.strokeStyle,t.lineWidth=i.lineWidth,t.dashes=i.dashes,this.setStrokeDashed(t,e.dashes)}}},{key:"setStrokeDashed",value:function(t,e){if(!1!==e)if(void 0!==t.setLineDash){var i=vl(e)?e:[5,5];t.setLineDash(i)}else console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.");else void 0!==t.setLineDash?t.setLineDash([]):console.warn("setLineDash is not supported in this browser. The dashed stroke cannot be used.")}}]),t}();function Um(t,e){var i=Cl(t);if(Bs){var n=Bs(t);e&&(n=Ec(n).call(n,function(e){return $s(t,e).enumerable})),i.push.apply(i,n)}return i}function Ym(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Nl(i=Um(Object(n),!0)).call(i,function(e){ya(t,e,n[e])});else if(oa)la(t,oa(n));else{var o;Nl(o=Um(Object(n))).call(o,function(e){fa(t,e,$s(n,e))})}}return t}var Gm,Zm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_findBorderPositionBezier",value:function(t,e){var i,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._getViaCoordinates(),r=10,s=.2,a=!1,l=1,c=0,h=this.to,d=this.options.endPointOffset?this.options.endPointOffset.to:0;t.id===this.from.id&&(h=this.from,a=!0,d=this.options.endPointOffset?this.options.endPointOffset.from:0),!1===this.options.arrowStrikethrough&&(d=0);var u=0;do{i=this.getPoint(n=.5*(c+l),o);var f=Math.atan2(h.y-i.y,h.x-i.x),p=h.distanceToBorder(e,f)+d-Math.sqrt(Math.pow(i.x-h.x,2)+Math.pow(i.y-h.y,2));if(Math.abs(p)<s)break;p<0?!1===a?c=n:l=n:!1===a?l=n:c=n,++u}while(c<=l&&u<r);return Ym(Ym({},i),{},{t:n})}},{key:"_getDistanceToBezierEdge",value:function(t,e,i,n,o,r,s){var a,l,c,h,d,u=1e9,f=t,p=e;for(l=1;l<10;l++)c=.1*l,h=Math.pow(1-c,2)*t+2*c*(1-c)*s.x+Math.pow(c,2)*i,d=Math.pow(1-c,2)*e+2*c*(1-c)*s.y+Math.pow(c,2)*n,l>0&&(u=(a=this._getDistanceToLine(f,p,h,d,o,r))<u?a:u),f=h,p=d;return u}},{key:"_bezierCurve",value:function(t,e,i,n){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),null!=i&&null!=i.x?null!=n&&null!=n.x?t.bezierCurveTo(i.x,i.y,n.x,n.y,this.toPoint.x,this.toPoint.y):t.quadraticCurveTo(i.x,i.y,this.toPoint.x,this.toPoint.y):t.lineTo(this.toPoint.x,this.toPoint.y),this.drawBackground(t,e),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}}]),i}(qm),$m=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o)).via=r.via,r._boundFunction=function(){r.positionBezierNode()},r._body.emitter.on("_repositionBezierNodes",r._boundFunction),r}return va(i,[{key:"setOptions",value:function(t){_m(Hg(i.prototype),"setOptions",this).call(this,t);var e=!1;this.options.physics!==t.physics&&(e=!0),this.options=t,this.id=this.options.id,this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.setupSupportNode(),this.connect(),!0===e&&(this.via.setOptions({physics:this.options.physics}),this.positionBezierNode())}},{key:"connect",value:function(){this.from=this._body.nodes[this.options.from],this.to=this._body.nodes[this.options.to],this.via.setOptions(void 0===this.from||void 0===this.to||!1===this.options.physics||this.from.id===this.to.id?{physics:!1}:{physics:!0})}},{key:"cleanup",value:function(){return this._body.emitter.off("_repositionBezierNodes",this._boundFunction),void 0!==this.via&&(delete this._body.nodes[this.via.id],this.via=void 0,!0)}},{key:"setupSupportNode",value:function(){if(void 0===this.via){var t="edgeId:"+this.id,e=this._body.functions.createNode({id:t,shape:"circle",physics:!0,hidden:!0});this._body.nodes[t]=e,this.via=e,this.via.parentEdgeId=this.id,this.positionBezierNode()}}},{key:"positionBezierNode",value:function(){void 0!==this.via&&void 0!==this.from&&void 0!==this.to?(this.via.x=.5*(this.from.x+this.to.x),this.via.y=.5*(this.from.y+this.to.y)):void 0!==this.via&&(this.via.x=0,this.via.y=0)}},{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"_getViaCoordinates",value:function(){return this.via}},{key:"getViaNode",value:function(){return this.via}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.via;if(this.from===this.to){var i=ll(this._getCircleData(),3),n=i[1],o=i[2],r=2*Math.PI*(1-t);return{x:i[0]+o*Math.sin(r),y:n+o-o*(1-Math.cos(r))}}return{x:Math.pow(1-t,2)*this.fromPoint.x+2*t*(1-t)*e.x+Math.pow(t,2)*this.toPoint.x,y:Math.pow(1-t,2)*this.fromPoint.y+2*t*(1-t)*e.y+Math.pow(t,2)*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,this.via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToBezierEdge(t,e,i,n,o,r,this.via)}}]),i}(Zm),Xm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i)}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_getViaCoordinates",value:function(){var t,e,i=this.options.smooth.roundness,n=this.options.smooth.type,o=Math.abs(this.from.x-this.to.x),r=Math.abs(this.from.y-this.to.y);if("discrete"===n||"diagonalCross"===n){var s,a;s=a=o<=r?i*r:i*o,this.from.x>this.to.x&&(s=-s),this.from.y>=this.to.y&&(a=-a);var l=this.from.x+s,c=this.from.y+a;return"discrete"===n&&(o<=r?l=o<i*r?this.from.x:l:c=r<i*o?this.from.y:c),{x:l,y:c}}if("straightCross"===n){var h=(1-i)*o,d=(1-i)*r;return o<=r?(h=0,this.from.y<this.to.y&&(d=-d)):(this.from.x<this.to.x&&(h=-h),d=0),{x:this.to.x+h,y:this.to.y+d}}if("horizontal"===n){var u=(1-i)*o;return this.from.x<this.to.x&&(u=-u),{x:this.to.x+u,y:this.from.y}}if("vertical"===n){var f=(1-i)*r;return this.from.y<this.to.y&&(f=-f),{x:this.from.x,y:this.to.y+f}}if("curvedCW"===n){o=this.to.x-this.from.x,r=this.from.y-this.to.y;var p=Math.sqrt(o*o+r*r),g=Math.PI,m=(Math.atan2(r,o)+(.5*i+.5)*g)%(2*g);return{x:this.from.x+(.5*i+.5)*p*Math.sin(m),y:this.from.y+(.5*i+.5)*p*Math.cos(m)}}if("curvedCCW"===n){o=this.to.x-this.from.x,r=this.from.y-this.to.y;var v=Math.sqrt(o*o+r*r),y=Math.PI,b=(Math.atan2(r,o)+(.5*-i+.5)*y)%(2*y);return{x:this.from.x+(.5*i+.5)*v*Math.sin(b),y:this.from.y+(.5*i+.5)*v*Math.cos(b)}}t=e=o<=r?i*r:i*o,this.from.x>this.to.x&&(t=-t),this.from.y>=this.to.y&&(e=-e);var w=this.from.x+t,k=this.from.y+e;return o<=r?w=this.from.x<=this.to.x?this.to.x<w?this.to.x:w:this.to.x>w?this.to.x:w:k=this.from.y>=this.to.y?this.to.y>k?this.to.y:k:this.to.y<k?this.to.y:k,{x:w,y:k}}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e,(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).via)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates();return this._getDistanceToBezierEdge(t,e,i,n,o,r,s)}},{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),i=t;return{x:Math.pow(1-i,2)*this.fromPoint.x+2*i*(1-i)*e.x+Math.pow(i,2)*this.toPoint.x,y:Math.pow(1-i,2)*this.fromPoint.y+2*i*(1-i)*e.y+Math.pow(i,2)*this.toPoint.y}}}]),i}(Zm),Km=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_line",value:function(t,e,i){this._bezierCurve(t,e,i[0],i[1])}},{key:"_getViaCoordinates",value:function(){var t,e,i,n,o=this.from.x-this.to.x,r=this.from.y-this.to.y,s=this.options.smooth.roundness;return(Math.abs(o)>Math.abs(r)||!0===this.options.smooth.forceDirection||"horizontal"===this.options.smooth.forceDirection)&&"vertical"!==this.options.smooth.forceDirection?(e=this.from.y,n=this.to.y,t=this.from.x-s*o,i=this.to.x+s*o):(e=this.from.y-s*r,n=this.to.y+s*r,t=this.from.x,i=this.to.x),[{x:t,y:e},{x:i,y:n}]}},{key:"getViaNode",value:function(){return this._getViaCoordinates()}},{key:"_findBorderPosition",value:function(t,e){return this._findBorderPositionBezier(t,e)}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){var s=ll(arguments.length>6&&void 0!==arguments[6]?arguments[6]:this._getViaCoordinates(),2);return this._getDistanceToBezierEdge2(t,e,i,n,o,r,s[0],s[1])}},{key:"getPoint",value:function(t){var e=ll(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._getViaCoordinates(),2),i=e[0],n=e[1],o=t,r=[Math.pow(1-o,3),3*o*Math.pow(1-o,2),3*Math.pow(o,2)*(1-o),Math.pow(o,3)];return{x:r[0]*this.fromPoint.x+r[1]*i.x+r[2]*n.x+r[3]*this.toPoint.x,y:r[0]*this.fromPoint.y+r[1]*i.y+r[2]*n.y+r[3]*this.toPoint.y}}}]),i}(function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_getDistanceToBezierEdge2",value:function(t,e,i,n,o,r,s,a){for(var l=1e9,c=t,h=e,d=[0,0,0,0],u=1;u<10;u++){var f=.1*u;d[0]=Math.pow(1-f,3),d[1]=3*f*Math.pow(1-f,2),d[2]=3*Math.pow(f,2)*(1-f),d[3]=Math.pow(f,3);var p=d[0]*t+d[1]*s.x+d[2]*a.x+d[3]*i,g=d[0]*e+d[1]*s.y+d[2]*a.y+d[3]*n;if(u>0){var m=this._getDistanceToLine(c,h,p,g,o,r);l=m<l?m:l}c=p,h=g}return l}}]),i}(Zm)),Qm=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_line",value:function(t,e){t.beginPath(),t.moveTo(this.fromPoint.x,this.fromPoint.y),t.lineTo(this.toPoint.x,this.toPoint.y),this.enableShadow(t,e),t.stroke(),this.disableShadow(t,e)}},{key:"getViaNode",value:function(){}},{key:"getPoint",value:function(t){return{x:(1-t)*this.fromPoint.x+t*this.toPoint.x,y:(1-t)*this.fromPoint.y+t*this.toPoint.y}}},{key:"_findBorderPosition",value:function(t,e){var i=this.to,n=this.from;t.id===this.from.id&&(i=this.from,n=this.to);var o=Math.atan2(i.y-n.y,i.x-n.x),r=i.x-n.x,s=i.y-n.y,a=Math.sqrt(r*r+s*s),l=(a-t.distanceToBorder(e,o))/a;return{x:(1-l)*n.x+l*i.x,y:(1-l)*n.y+l*i.y,t:0}}},{key:"_getDistanceToEdge",value:function(t,e,i,n,o,r){return this._getDistanceToLine(t,e,i,n,o,r)}}]),i}(qm),Jm=function(){function t(e,i,n,o,r){if(pa(this,t),void 0===i)throw new Error("No body provided");this.options=Yu(o),this.globalOptions=o,this.defaultOptions=r,this.body=i,this.imagelist=n,this.id=void 0,this.fromId=void 0,this.toId=void 0,this.selected=!1,this.hover=!1,this.labelDirty=!0,this.baseWidth=this.options.width,this.baseFontSize=this.options.font.size,this.from=void 0,this.to=void 0,this.edgeType=void 0,this.connected=!1,this.labelModule=new xg(this.body,this.options,!0),this.setOptions(e)}return va(t,[{key:"setOptions",value:function(e){if(e){var i=void 0!==e.physics&&this.options.physics!==e.physics||void 0!==e.hidden&&(this.options.hidden||!1)!==(e.hidden||!1)||void 0!==e.from&&this.options.from!==e.from||void 0!==e.to&&this.options.to!==e.to;return t.parseOptions(this.options,e,!0,this.globalOptions),void 0!==e.id&&(this.id=e.id),void 0!==e.from&&(this.fromId=e.from),void 0!==e.to&&(this.toId=e.to),void 0!==e.title&&(this.title=e.title),void 0!==e.value&&(e.value=sg(e.value)),this.chooser=cg("edge",[e,this.options,this.defaultOptions]),this.updateLabelModule(e),i=this.updateEdgeType()||i,this._setInteractionWidths(),this.connect(),i}}},{key:"getFormattingValues",value:function(){var t=this.options.color.inherit,e={toArrow:!0===this.options.arrows.to||!0===this.options.arrows.to.enabled,toArrowScale:this.options.arrows.to.scaleFactor,toArrowType:this.options.arrows.to.type,toArrowSrc:this.options.arrows.to.src,toArrowImageWidth:this.options.arrows.to.imageWidth,toArrowImageHeight:this.options.arrows.to.imageHeight,middleArrow:!0===this.options.arrows.middle||!0===this.options.arrows.middle.enabled,middleArrowScale:this.options.arrows.middle.scaleFactor,middleArrowType:this.options.arrows.middle.type,middleArrowSrc:this.options.arrows.middle.src,middleArrowImageWidth:this.options.arrows.middle.imageWidth,middleArrowImageHeight:this.options.arrows.middle.imageHeight,fromArrow:!0===this.options.arrows.from||!0===this.options.arrows.from.enabled,fromArrowScale:this.options.arrows.from.scaleFactor,fromArrowType:this.options.arrows.from.type,fromArrowSrc:this.options.arrows.from.src,fromArrowImageWidth:this.options.arrows.from.imageWidth,fromArrowImageHeight:this.options.arrows.from.imageHeight,arrowStrikethrough:this.options.arrowStrikethrough,color:t?void 0:this.options.color.color,inheritsColor:t,opacity:this.options.color.opacity,hidden:this.options.hidden,length:this.options.length,shadow:this.options.shadow.enabled,shadowColor:this.options.shadow.color,shadowSize:this.options.shadow.size,shadowX:this.options.shadow.x,shadowY:this.options.shadow.y,dashes:this.options.dashes,width:this.options.width,background:this.options.background.enabled,backgroundColor:this.options.background.color,backgroundSize:this.options.background.size,backgroundDashes:this.options.background.dashes};if(this.selected||this.hover)if(!0===this.chooser){if(this.selected){var i=this.options.selectionWidth;"function"==typeof i?e.width=i(e.width):"number"==typeof i&&(e.width+=i),e.width=Math.max(e.width,.3/this.body.view.scale),e.color=this.options.color.highlight,e.shadow=this.options.shadow.enabled}else if(this.hover){var n=this.options.hoverWidth;"function"==typeof n?e.width=n(e.width):"number"==typeof n&&(e.width+=n),e.width=Math.max(e.width,.3/this.body.view.scale),e.color=this.options.color.hover,e.shadow=this.options.shadow.enabled}}else"function"==typeof this.chooser&&(this.chooser(e,this.options.id,this.selected,this.hover),void 0!==e.color&&(e.inheritsColor=!1),!1===e.shadow&&(e.shadowColor===this.options.shadow.color&&e.shadowSize===this.options.shadow.size&&e.shadowX===this.options.shadow.x&&e.shadowY===this.options.shadow.y||(e.shadow=!0)));else e.shadow=this.options.shadow.enabled,e.width=Math.max(e.width,.3/this.body.view.scale);return e}},{key:"updateLabelModule",value:function(t){this.labelModule.update(this.options,[t,this.options,this.globalOptions,this.defaultOptions]),void 0!==this.labelModule.baseSize&&(this.baseFontSize=this.labelModule.baseSize)}},{key:"updateEdgeType",value:function(){var t=this.options.smooth,e=!1,i=!0;return void 0!==this.edgeType&&((this.edgeType instanceof $m&&!0===t.enabled&&"dynamic"===t.type||this.edgeType instanceof Km&&!0===t.enabled&&"cubicBezier"===t.type||this.edgeType instanceof Xm&&!0===t.enabled&&"dynamic"!==t.type&&"cubicBezier"!==t.type||this.edgeType instanceof Qm&&!1===t.type.enabled)&&(i=!1),!0===i&&(e=this.cleanup())),!0===i?!0===t.enabled?"dynamic"===t.type?(e=!0,this.edgeType=new $m(this.options,this.body,this.labelModule)):this.edgeType="cubicBezier"===t.type?new Km(this.options,this.body,this.labelModule):new Xm(this.options,this.body,this.labelModule):this.edgeType=new Qm(this.options,this.body,this.labelModule):this.edgeType.setOptions(this.options),e}},{key:"connect",value:function(){this.disconnect(),this.from=this.body.nodes[this.fromId]||void 0,this.to=this.body.nodes[this.toId]||void 0,this.connected=void 0!==this.from&&void 0!==this.to,!0===this.connected?(this.from.attachEdge(this),this.to.attachEdge(this)):(this.from&&this.from.detachEdge(this),this.to&&this.to.detachEdge(this)),this.edgeType.connect()}},{key:"disconnect",value:function(){this.from&&(this.from.detachEdge(this),this.from=void 0),this.to&&(this.to.detachEdge(this),this.to=void 0),this.connected=!1}},{key:"getTitle",value:function(){return this.title}},{key:"isSelected",value:function(){return this.selected}},{key:"getValue",value:function(){return this.options.value}},{key:"setValueRange",value:function(t,e,i){if(void 0!==this.options.value){var n=this.options.scaling.customScalingFunction(t,e,i,this.options.value),o=this.options.scaling.max-this.options.scaling.min;!0===this.options.scaling.label.enabled&&(this.options.font.size=this.options.scaling.label.min+n*(this.options.scaling.label.max-this.options.scaling.label.min)),this.options.width=this.options.scaling.min+n*o}else this.options.width=this.baseWidth,this.options.font.size=this.baseFontSize;this._setInteractionWidths(),this.updateLabelModule()}},{key:"_setInteractionWidths",value:function(){this.edgeType.hoverWidth="function"==typeof this.options.hoverWidth?this.options.hoverWidth(this.options.width):this.options.hoverWidth+this.options.width,this.edgeType.selectionWidth="function"==typeof this.options.selectionWidth?this.options.selectionWidth(this.options.width):this.options.selectionWidth+this.options.width}},{key:"draw",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode();this.edgeType.drawLine(t,e,this.selected,this.hover,i),this.drawLabel(t,i)}}},{key:"drawArrows",value:function(t){var e=this.getFormattingValues();if(!e.hidden){var i=this.edgeType.getViaNode(),n={};this.edgeType.fromPoint=this.edgeType.from,this.edgeType.toPoint=this.edgeType.to,e.fromArrow&&(n.from=this.edgeType.getArrowData(t,"from",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.fromPoint=n.from.core),e.fromArrowSrc&&(n.from.image=this.imagelist.load(e.fromArrowSrc)),e.fromArrowImageWidth&&(n.from.imageWidth=e.fromArrowImageWidth),e.fromArrowImageHeight&&(n.from.imageHeight=e.fromArrowImageHeight)),e.toArrow&&(n.to=this.edgeType.getArrowData(t,"to",i,this.selected,this.hover,e),!1===e.arrowStrikethrough&&(this.edgeType.toPoint=n.to.core),e.toArrowSrc&&(n.to.image=this.imagelist.load(e.toArrowSrc)),e.toArrowImageWidth&&(n.to.imageWidth=e.toArrowImageWidth),e.toArrowImageHeight&&(n.to.imageHeight=e.toArrowImageHeight)),e.middleArrow&&(n.middle=this.edgeType.getArrowData(t,"middle",i,this.selected,this.hover,e),e.middleArrowSrc&&(n.middle.image=this.imagelist.load(e.middleArrowSrc)),e.middleArrowImageWidth&&(n.middle.imageWidth=e.middleArrowImageWidth),e.middleArrowImageHeight&&(n.middle.imageHeight=e.middleArrowImageHeight)),e.fromArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.from),e.middleArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.middle),e.toArrow&&this.edgeType.drawArrowHead(t,e,this.selected,this.hover,n.to)}}},{key:"drawLabel",value:function(t,e){if(void 0!==this.options.label){var i,n=this.from,o=this.to;if(this.labelModule.differentState(this.selected,this.hover)&&this.labelModule.getTextSize(t,this.selected,this.hover),n.id!=o.id){this.labelModule.pointToSelf=!1,i=this.edgeType.getPoint(.5,e),t.save();var r=this._getRotation(t);0!=r.angle&&(t.translate(r.x,r.y),t.rotate(r.angle)),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover),t.restore()}else{this.labelModule.pointToSelf=!0;var s=ug(t,this.options.selfReference.angle,this.options.selfReference.size,n);i=this._pointOnCircle(s.x,s.y,this.options.selfReference.size,this.options.selfReference.angle),this.labelModule.draw(t,i.x,i.y,this.selected,this.hover)}}}},{key:"getItemsOnPoint",value:function(t){var e=[];if(this.labelModule.visible()){var i=this._getRotation();hg(this.labelModule.getSize(),t,i)&&e.push({edgeId:this.id,labelId:0})}return this.isOverlappingWith({left:t.x,top:t.y})&&e.push({edgeId:this.id}),e}},{key:"isOverlappingWith",value:function(t){return!!this.connected&&this.edgeType.getDistanceToEdge(this.from.x,this.from.y,this.to.x,this.to.y,t.left,t.top)<10}},{key:"_getRotation",value:function(t){var e=this.edgeType.getViaNode(),i=this.edgeType.getPoint(.5,e);void 0!==t&&this.labelModule.calculateLabelSize(t,this.selected,this.hover,i.x,i.y);var n={x:i.x,y:this.labelModule.size.yLine,angle:0};if(!this.labelModule.visible())return n;if("horizontal"===this.options.font.align)return n;var o=this.from.x-this.to.x,r=Math.atan2(this.from.y-this.to.y,o);return(r<-1&&o<0||r>0&&o<0)&&(r+=Math.PI),n.angle=r,n}},{key:"_pointOnCircle",value:function(t,e,i,n){return{x:t+i*Math.cos(n),y:e-i*Math.sin(n)}}},{key:"select",value:function(){this.selected=!0}},{key:"unselect",value:function(){this.selected=!1}},{key:"cleanup",value:function(){return this.edgeType.cleanup()}},{key:"remove",value:function(){this.cleanup(),this.disconnect(),delete this.body.edges[this.id]}},{key:"endPointsValid",value:function(){return void 0!==this.body.nodes[this.fromId]&&void 0!==this.body.nodes[this.toId]}}],[{key:"parseOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Ou(["endPointOffset","arrowStrikethrough","id","from","hidden","hoverWidth","labelHighlightBold","length","line","opacity","physics","scaling","selectionWidth","selfReferenceSize","selfReference","to","title","value","width","font","chosen","widthConstraint"],t,e,i),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.from&&(Qp(e.endPointOffset.from)?t.endPointOffset.from=e.endPointOffset.from:(t.endPointOffset.from=void 0!==n.endPointOffset.from?n.endPointOffset.from:0,console.error("endPointOffset.from is not a valid number"))),void 0!==e.endPointOffset&&void 0!==e.endPointOffset.to&&(Qp(e.endPointOffset.to)?t.endPointOffset.to=e.endPointOffset.to:(t.endPointOffset.to=void 0!==n.endPointOffset.to?n.endPointOffset.to:0,console.error("endPointOffset.to is not a valid number"))),dg(e.label)?t.label=e.label:dg(t.label)||(t.label=void 0),Gu(t,e,"smooth",n),Gu(t,e,"shadow",n),Gu(t,e,"background",n),null!=e.dashes?t.dashes=e.dashes:!0===i&&null===e.dashes&&(t.dashes=ah(n.dashes)),null!=e.scaling?(void 0!==e.scaling.min&&(t.scaling.min=e.scaling.min),void 0!==e.scaling.max&&(t.scaling.max=e.scaling.max),Gu(t.scaling,e.scaling,"label",n.scaling)):!0===i&&null===e.scaling&&(t.scaling=ah(n.scaling)),null!=e.arrows)if("string"==typeof e.arrows){var r=e.arrows.toLowerCase();t.arrows.to.enabled=-1!=eh(r).call(r,"to"),t.arrows.middle.enabled=-1!=eh(r).call(r,"middle"),t.arrows.from.enabled=-1!=eh(r).call(r,"from")}else{if("object"!==hl(e.arrows))throw new Error("The arrow newOptions can only be an object or a string. Refer to the documentation. You used:"+vh(e.arrows));Gu(t.arrows,e.arrows,"to",n.arrows),Gu(t.arrows,e.arrows,"middle",n.arrows),Gu(t.arrows,e.arrows,"from",n.arrows)}else!0===i&&null===e.arrows&&(t.arrows=ah(n.arrows));if(null!=e.color){var s=Eu(e.color)?{color:e.color,highlight:e.color,hover:e.color,inherit:!1,opacity:1}:e.color,a=t.color;if(o)Pu(a,n.color,!1,i);else for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&delete a[l];if(Eu(a))a.color=a,a.highlight=a,a.hover=a,a.inherit=!1,void 0===s.opacity&&(a.opacity=1);else{var c=!1;void 0!==s.color&&(a.color=s.color,c=!0),void 0!==s.highlight&&(a.highlight=s.highlight,c=!0),void 0!==s.hover&&(a.hover=s.hover,c=!0),void 0!==s.inherit&&(a.inherit=s.inherit),void 0!==s.opacity&&(a.opacity=Math.min(1,Math.max(0,s.opacity))),!0===c?a.inherit=!1:void 0===a.inherit&&(a.inherit="from")}}else!0===i&&null===e.color&&(t.color=Yu(n.color));!0===i&&null===e.font&&(t.font=Yu(n.font)),Object.prototype.hasOwnProperty.call(e,"selfReferenceSize")&&(console.warn("The selfReferenceSize property has been deprecated. Please use selfReference property instead. The selfReference can be set like thise selfReference:{size:30, angle:Math.PI / 4}"),t.selfReference.size=e.selfReferenceSize)}}]),t}(),tv=function(){function t(e,i,n){var o,r=this;pa(this,t),this.body=e,this.images=i,this.groups=n,this.body.functions.createEdge=Ke(o=this.create).call(o,this),this.edgesListeners={add:function(t,e){r.add(e.items)},update:function(t,e){r.update(e.items)},remove:function(t,e){r.remove(e.items)}},this.options={},this.defaultOptions={arrows:{to:{enabled:!1,scaleFactor:1,type:"arrow"},middle:{enabled:!1,scaleFactor:1,type:"arrow"},from:{enabled:!1,scaleFactor:1,type:"arrow"}},endPointOffset:{from:0,to:0},arrowStrikethrough:!0,color:{color:"#848484",highlight:"#848484",hover:"#848484",inherit:"from",opacity:1},dashes:!1,font:{color:"#343434",size:14,face:"arial",background:"none",strokeWidth:2,strokeColor:"#ffffff",align:"horizontal",multi:!1,vadjust:0,bold:{mod:"bold"},boldital:{mod:"bold italic"},ital:{mod:"italic"},mono:{mod:"",size:15,face:"courier new",vadjust:2}},hidden:!1,hoverWidth:1.5,label:void 0,labelHighlightBold:!0,length:void 0,physics:!0,scaling:{min:1,max:15,label:{enabled:!0,min:14,max:30,maxVisible:30,drawThreshold:5},customScalingFunction:function(t,e,i,n){return e===t?.5:Math.max(0,1/(e-t)*(n-t))}},selectionWidth:1.5,selfReference:{size:20,angle:Math.PI/4,renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:10,x:5,y:5},background:{enabled:!1,color:"rgba(111,111,111,1)",size:10,dashes:!1},smooth:{enabled:!0,type:"dynamic",forceDirection:"none",roundness:.5},title:void 0,width:1,value:void 0},Pu(this.options,this.defaultOptions),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t,e,i=this;this.body.emitter.on("_forceDisableDynamicCurves",function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"dynamic"===t&&(t="continuous");var n=!1;for(var o in i.body.edges)if(Object.prototype.hasOwnProperty.call(i.body.edges,o)){var r=i.body.edges[o],s=i.body.data.edges.get(o);if(null!=s){var a=s.smooth;void 0!==a&&!0===a.enabled&&"dynamic"===a.type&&(r.setOptions(void 0===t?{smooth:!1}:{smooth:{type:t}}),n=!0)}}!0===e&&!0===n&&i.body.emitter.emit("_dataChanged")}),this.body.emitter.on("_dataUpdated",function(){i.reconnectEdges()}),this.body.emitter.on("refreshEdges",Ke(t=this.refresh).call(t,this)),this.body.emitter.on("refresh",Ke(e=this.refresh).call(e,this)),this.body.emitter.on("destroy",function(){Ru(i.edgesListeners,function(t,e){i.body.data.edges&&i.body.data.edges.off(e,t)}),delete i.body.functions.createEdge,delete i.edgesListeners.add,delete i.edgesListeners.update,delete i.edgesListeners.remove,delete i.edgesListeners})}},{key:"setOptions",value:function(t){if(void 0!==t){Jm.parseOptions(this.options,t,!0,this.defaultOptions,!0);var e=!1;if(void 0!==t.smooth)for(var i in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,i)&&(e=this.body.edges[i].updateEdgeType()||e);if(void 0!==t.font)for(var n in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,n)&&this.body.edges[n].updateLabelModule();void 0===t.hidden&&void 0===t.physics&&!0!==e||this.body.emitter.emit("_dataChanged")}}},{key:"setData",value:function(t){var i=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.data.edges;if(e.isDataViewLike("id",t))this.body.data.edges=t;else if(vl(t))this.body.data.edges=new e.DataSet,this.body.data.edges.add(t);else{if(t)throw new TypeError("Array or DataSet expected");this.body.data.edges=new e.DataSet}if(o&&Ru(this.edgesListeners,function(t,e){o.off(e,t)}),this.body.edges={},this.body.data.edges){Ru(this.edgesListeners,function(t,e){i.body.data.edges.on(e,t)});var r=this.body.data.edges.getIds();this.add(r,!0)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===n&&this.body.emitter.emit("_dataChanged")}},{key:"add",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.body.edges,n=this.body.data.edges,o=0;o<t.length;o++){var r=t[o],s=i[r];s&&s.disconnect();var a=n.get(r,{showInternalIds:!0});i[r]=this.create(a)}this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),!1===e&&this.body.emitter.emit("_dataChanged")}},{key:"update",value:function(t){for(var e=this.body.edges,i=this.body.data.edges,n=!1,o=0;o<t.length;o++){var r=t[o],s=i.get(r),a=e[r];void 0!==a?(a.disconnect(),n=a.setOptions(s)||n,a.connect()):(this.body.edges[r]=this.create(s),n=!0)}!0===n?(this.body.emitter.emit("_adjustEdgesForHierarchicalLayout"),this.body.emitter.emit("_dataChanged")):this.body.emitter.emit("_dataUpdated")}},{key:"remove",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0!==t.length){var i=this.body.edges;Ru(t,function(t){var e=i[t];void 0!==e&&e.remove()}),e&&this.body.emitter.emit("_dataChanged")}}},{key:"refresh",value:function(){var t=this;Ru(this.body.edges,function(e,i){var n=t.body.data.edges.get(i);void 0!==n&&e.setOptions(n)})}},{key:"create",value:function(t){return new Jm(t,this.body,this.images,this.options,this.defaultOptions)}},{key:"reconnectEdges",value:function(){var t,e=this.body.nodes,i=this.body.edges;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(e[t].edges=[]);for(t in i)if(Object.prototype.hasOwnProperty.call(i,t)){var n=i[t];n.from=null,n.to=null,n.connect()}}},{key:"getConnectedNodes",value:function(t){var e=[];if(void 0!==this.body.edges[t]){var i=this.body.edges[t];void 0!==i.fromId&&e.push(i.fromId),void 0!==i.toId&&e.push(i.toId)}return e}},{key:"_updateState",value:function(){this._addMissingEdges(),this._removeInvalidEdges()}},{key:"_removeInvalidEdges",value:function(){var t=this,e=[];Ru(this.body.edges,function(i,n){var o=t.body.nodes[i.toId],r=t.body.nodes[i.fromId];void 0!==o&&!0===o.isCluster||void 0!==r&&!0===r.isCluster||void 0!==o&&void 0!==r||e.push(n)}),this.remove(e,!1)}},{key:"_addMissingEdges",value:function(){var t=this.body.data.edges;if(null!=t){var e=this.body.edges,i=[];Nl(t).call(t,function(t,n){void 0===e[n]&&i.push(n)}),this.add(i,!0)}}}]),t}(),ev=function(){function t(e,i,n){pa(this,t),this.body=e,this.physicsBody=i,this.setOptions(n),this._rng=gu("BARNES HUT SOLVER")}return va(t,[{key:"setOptions",value:function(t){this.options=t,this.thetaInversed=1/this.options.theta,this.overlapAvoidanceFactor=1-Math.max(0,Math.min(1,this.options.avoidOverlap))}},{key:"solve",value:function(){if(0!==this.options.gravitationalConstant&&this.physicsBody.physicsNodeIndices.length>0){var t,e=this.body.nodes,i=this.physicsBody.physicsNodeIndices,n=i.length,o=this._formBarnesHutTree(e,i);this.barnesHutTree=o;for(var r=0;r<n;r++)(t=e[i[r]]).options.mass>0&&this._getForceContributions(o.root,t)}}},{key:"_getForceContributions",value:function(t,e){this._getForceContribution(t.children.NW,e),this._getForceContribution(t.children.NE,e),this._getForceContribution(t.children.SW,e),this._getForceContribution(t.children.SE,e)}},{key:"_getForceContribution",value:function(t,e){if(t.childrenCount>0){var i=t.centerOfMass.x-e.x,n=t.centerOfMass.y-e.y,o=Math.sqrt(i*i+n*n);o*t.calcSize>this.thetaInversed?this._calculateForces(o,i,n,e,t):4===t.childrenCount?this._getForceContributions(t,e):t.children.data.id!=e.id&&this._calculateForces(o,i,n,e,t)}}},{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=this.options.gravitationalConstant*o.mass*n.options.mass/Math.pow(t,3),s=i*r;this.physicsBody.forces[n.id].x+=e*r,this.physicsBody.forces[n.id].y+=s}},{key:"_formBarnesHutTree",value:function(t,e){for(var i,n=e.length,o=t[e[0]].x,r=t[e[0]].y,s=t[e[0]].x,a=t[e[0]].y,l=1;l<n;l++){var c=t[e[l]],h=c.x,d=c.y;c.options.mass>0&&(h<o&&(o=h),h>s&&(s=h),d<r&&(r=d),d>a&&(a=d))}var u=Math.abs(s-o)-Math.abs(a-r);u>0?(r-=.5*u,a+=.5*u):(o+=.5*u,s-=.5*u);var f=Math.max(1e-5,Math.abs(s-o)),p=.5*f,g=.5*(o+s),m=.5*(r+a),v={root:{centerOfMass:{x:0,y:0},mass:0,range:{minX:g-p,maxX:g+p,minY:m-p,maxY:m+p},size:f,calcSize:1/f,children:{data:null},maxWidth:0,level:0,childrenCount:4}};this._splitBranch(v.root);for(var y=0;y<n;y++)(i=t[e[y]]).options.mass>0&&this._placeInTree(v.root,i);return v}},{key:"_updateBranchMass",value:function(t,e){var i=t.centerOfMass,n=t.mass+e.options.mass,o=1/n;i.x=i.x*t.mass+e.x*e.options.mass,i.x*=o,i.y=i.y*t.mass+e.y*e.options.mass,i.y*=o,t.mass=n;var r=Math.max(Math.max(e.height,e.radius),e.width);t.maxWidth=t.maxWidth<r?r:t.maxWidth}},{key:"_placeInTree",value:function(t,e,i){1==i&&void 0!==i||this._updateBranchMass(t,e);var n=t.children.NW.range;this._placeInRegion(t,e,n.maxX>e.x?n.maxY>e.y?"NW":"SW":n.maxY>e.y?"NE":"SE")}},{key:"_placeInRegion",value:function(t,e,i){var n=t.children[i];switch(n.childrenCount){case 0:n.children.data=e,n.childrenCount=1,this._updateBranchMass(n,e);break;case 1:n.children.data.x===e.x&&n.children.data.y===e.y?(e.x+=this._rng(),e.y+=this._rng()):(this._splitBranch(n),this._placeInTree(n,e));break;case 4:this._placeInTree(n,e)}}},{key:"_splitBranch",value:function(t){var e=null;1===t.childrenCount&&(e=t.children.data,t.mass=0,t.centerOfMass.x=0,t.centerOfMass.y=0),t.childrenCount=4,t.children.data=null,this._insertRegion(t,"NW"),this._insertRegion(t,"NE"),this._insertRegion(t,"SW"),this._insertRegion(t,"SE"),null!=e&&this._placeInTree(t,e)}},{key:"_insertRegion",value:function(t,e){var i,n,o,r,s=.5*t.size;switch(e){case"NW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY,r=t.range.minY+s;break;case"NE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY,r=t.range.minY+s;break;case"SW":i=t.range.minX,n=t.range.minX+s,o=t.range.minY+s,r=t.range.maxY;break;case"SE":i=t.range.minX+s,n=t.range.maxX,o=t.range.minY+s,r=t.range.maxY}t.children[e]={centerOfMass:{x:0,y:0},mass:0,range:{minX:i,maxX:n,minY:o,maxY:r},size:.5*t.size,calcSize:2*t.calcSize,children:{data:null},maxWidth:0,level:t.level+1,childrenCount:0}}},{key:"_debug",value:function(t,e){void 0!==this.barnesHutTree&&(t.lineWidth=1,this._drawBranch(this.barnesHutTree.root,t,e))}},{key:"_drawBranch",value:function(t,e,i){void 0===i&&(i="#FF0000"),4===t.childrenCount&&(this._drawBranch(t.children.NW,e),this._drawBranch(t.children.NE,e),this._drawBranch(t.children.SE,e),this._drawBranch(t.children.SW,e)),e.strokeStyle=i,e.beginPath(),e.moveTo(t.range.minX,t.range.minY),e.lineTo(t.range.maxX,t.range.minY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.minY),e.lineTo(t.range.maxX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.maxX,t.range.maxY),e.lineTo(t.range.minX,t.range.maxY),e.stroke(),e.beginPath(),e.moveTo(t.range.minX,t.range.maxY),e.lineTo(t.range.minX,t.range.minY),e.stroke()}}]),t}(),iv=function(){function t(e,i,n){pa(this,t),this._rng=gu("REPULSION SOLVER"),this.body=e,this.physicsBody=i,this.setOptions(n)}return va(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l=this.body.nodes,c=this.physicsBody.physicsNodeIndices,h=this.physicsBody.forces,d=this.options.nodeDistance,u=-2/3/d,f=0;f<c.length-1;f++){s=l[c[f]];for(var p=f+1;p<c.length;p++)t=(a=l[c[p]]).x-s.x,e=a.y-s.y,0===(i=Math.sqrt(t*t+e*e))&&(t=i=.1*this._rng()),i<2*d&&(r=i<.5*d?1:u*i+1.3333333333333333,n=t*(r/=i),o=e*r,h[s.id].x-=n,h[s.id].y-=o,h[a.id].x+=n,h[a.id].y+=o)}}}]),t}(),nv=function(){function t(e,i,n){pa(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return va(t,[{key:"setOptions",value:function(t){this.options=t,this.overlapAvoidanceFactor=Math.max(0,Math.min(1,this.options.avoidOverlap||0))}},{key:"solve",value:function(){for(var t=this.body.nodes,e=this.physicsBody.physicsNodeIndices,i=this.physicsBody.forces,n=this.options.nodeDistance,o=0;o<e.length-1;o++)for(var r=t[e[o]],s=o+1;s<e.length;s++){var a=t[e[s]];if(r.level===a.level){var l=n+this.overlapAvoidanceFactor*((r.shape.radius||0)/2+(a.shape.radius||0)/2),c=a.x-r.x,h=a.y-r.y,d=Math.sqrt(c*c+h*h),u=void 0;u=d<l?-Math.pow(.05*d,2)+Math.pow(.05*l,2):0,0!==d&&(u/=d);var f=c*u,p=h*u;i[r.id].x-=f,i[r.id].y-=p,i[a.id].x+=f,i[a.id].y+=p}}}}]),t}(),ov=function(){function t(e,i,n){pa(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return va(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o=this.physicsBody.physicsEdgeIndices,r=this.body.edges,s=0;s<o.length;s++)!0===(e=r[o[s]]).connected&&e.toId!==e.fromId&&void 0!==this.body.nodes[e.toId]&&void 0!==this.body.nodes[e.fromId]&&(void 0!==e.edgeType.via?(n=e.from,this._calculateSpringForce(e.to,i=e.edgeType.via,.5*(t=void 0===e.options.length?this.options.springLength:e.options.length)),this._calculateSpringForce(i,n,.5*t)):this._calculateSpringForce(e.from,e.to,t=void 0===e.options.length?1.5*this.options.springLength:e.options.length))}},{key:"_calculateSpringForce",value:function(t,e,i){var n=t.x-e.x,o=t.y-e.y,r=Math.max(Math.sqrt(n*n+o*o),.01),s=this.options.springConstant*(i-r)/r,a=n*s,l=o*s;void 0!==this.physicsBody.forces[t.id]&&(this.physicsBody.forces[t.id].x+=a,this.physicsBody.forces[t.id].y+=l),void 0!==this.physicsBody.forces[e.id]&&(this.physicsBody.forces[e.id].x-=a,this.physicsBody.forces[e.id].y-=l)}}]),t}(),rv=function(){function t(e,i,n){pa(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return va(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o,r,s,a,l,c,h=this.body.edges,d=.5,u=this.physicsBody.physicsEdgeIndices,f=this.physicsBody.physicsNodeIndices,p=this.physicsBody.forces,g=0;g<f.length;g++){var m=f[g];p[m].springFx=0,p[m].springFy=0}for(var v=0;v<u.length;v++)!0===(e=h[u[v]]).connected&&(t=void 0===e.options.length?this.options.springLength:e.options.length,i=e.from.x-e.to.x,n=e.from.y-e.to.y,a=0===(a=Math.sqrt(i*i+n*n))?.01:a,o=i*(s=this.options.springConstant*(t-a)/a),r=n*s,e.to.level!=e.from.level?(void 0!==p[e.toId]&&(p[e.toId].springFx-=o,p[e.toId].springFy-=r),void 0!==p[e.fromId]&&(p[e.fromId].springFx+=o,p[e.fromId].springFy+=r)):(void 0!==p[e.toId]&&(p[e.toId].x-=d*o,p[e.toId].y-=d*r),void 0!==p[e.fromId]&&(p[e.fromId].x+=d*o,p[e.fromId].y+=d*r)));s=1;for(var y=0;y<f.length;y++){var b=f[y];l=Math.min(s,Math.max(-s,p[b].springFx)),c=Math.min(s,Math.max(-s,p[b].springFy)),p[b].x+=l,p[b].y+=c}for(var w=0,k=0,_=0;_<f.length;_++){var x=f[_];w+=p[x].x,k+=p[x].y}for(var C=w/f.length,E=k/f.length,T=0;T<f.length;T++){var S=f[T];p[S].x-=C,p[S].y-=E}}}]),t}(),sv=function(){function t(e,i,n){pa(this,t),this.body=e,this.physicsBody=i,this.setOptions(n)}return va(t,[{key:"setOptions",value:function(t){this.options=t}},{key:"solve",value:function(){for(var t,e,i,n,o=this.body.nodes,r=this.physicsBody.physicsNodeIndices,s=this.physicsBody.forces,a=0;a<r.length;a++)t=-(n=o[r[a]]).x,e=-n.y,i=Math.sqrt(t*t+e*e),this._calculateForces(i,t,e,s,n)}},{key:"_calculateForces",value:function(t,e,i,n,o){var r=0===t?0:this.options.centralGravity/t;n[o.id].x=e*r,n[o.id].y=i*r}}]),t}(),av=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){var r;return pa(this,i),(r=e.call(this,t,n,o))._rng=gu("FORCE ATLAS 2 BASED REPULSION SOLVER"),r}return va(i,[{key:"_calculateForces",value:function(t,e,i,n,o){0===t&&(e=t=.1*this._rng()),this.overlapAvoidanceFactor<1&&n.shape.radius&&(t=Math.max(.1+this.overlapAvoidanceFactor*n.shape.radius,t-n.shape.radius));var r=this.options.gravitationalConstant*o.mass*n.options.mass*(n.edges.length+1)/Math.pow(t,2),s=i*r;this.physicsBody.forces[n.id].x+=e*r,this.physicsBody.forces[n.id].y+=s}}]),i}(ev),lv=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o){return pa(this,i),e.call(this,t,n,o)}return va(i,[{key:"_calculateForces",value:function(t,e,i,n,o){if(t>0){var r=this.options.centralGravity*(o.edges.length+1)*o.options.mass;n[o.id].x=e*r,n[o.id].y=i*r}}}]),i}(sv),cv=function(){function t(e){pa(this,t),this.body=e,this.physicsBody={physicsNodeIndices:[],physicsEdgeIndices:[],forces:{},velocities:{}},this.physicsEnabled=!0,this.simulationInterval=1e3/60,this.requiresTimeout=!0,this.previousStates={},this.referenceState={},this.freezeCache={},this.renderTimer=void 0,this.adaptiveTimestep=!1,this.adaptiveTimestepEnabled=!1,this.adaptiveCounter=0,this.adaptiveInterval=3,this.stabilized=!1,this.startedStabilization=!1,this.stabilizationIterations=0,this.ready=!1,this.options={},this.defaultOptions={enabled:!0,barnesHut:{theta:.5,gravitationalConstant:-2e3,centralGravity:.3,springLength:95,springConstant:.04,damping:.09,avoidOverlap:0},forceAtlas2Based:{theta:.5,gravitationalConstant:-50,centralGravity:.01,springConstant:.08,springLength:100,damping:.4,avoidOverlap:0},repulsion:{centralGravity:.2,springLength:200,springConstant:.05,nodeDistance:100,damping:.09,avoidOverlap:0},hierarchicalRepulsion:{centralGravity:0,springLength:100,springConstant:.01,nodeDistance:120,damping:.09},maxVelocity:50,minVelocity:.75,solver:"barnesHut",stabilization:{enabled:!0,iterations:1e3,updateInterval:50,onlyDynamicEdges:!1,fit:!0},timestep:.5,adaptiveTimestep:!0,wind:{x:0,y:0}},je(this.options,this.defaultOptions),this.timestep=.5,this.layoutFailed=!1,this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("initPhysics",function(){t.initPhysics()}),this.body.emitter.on("_layoutFailed",function(){t.layoutFailed=!0}),this.body.emitter.on("resetPhysics",function(){t.stopSimulation(),t.ready=!1}),this.body.emitter.on("disablePhysics",function(){t.physicsEnabled=!1,t.stopSimulation()}),this.body.emitter.on("restorePhysics",function(){t.setOptions(t.options),!0===t.ready&&t.startSimulation()}),this.body.emitter.on("startSimulation",function(){!0===t.ready&&t.startSimulation()}),this.body.emitter.on("stopSimulation",function(){t.stopSimulation()}),this.body.emitter.on("destroy",function(){t.stopSimulation(!1),t.body.emitter.off()}),this.body.emitter.on("_dataChanged",function(){t.updatePhysicsData()})}},{key:"setOptions",value:function(t){if(void 0!==t)if(!1===t)this.options.enabled=!1,this.physicsEnabled=!1,this.stopSimulation();else if(!0===t)this.options.enabled=!0,this.physicsEnabled=!0,this.startSimulation();else{this.physicsEnabled=!0,Iu(["stabilization"],this.options,t),Gu(this.options,t,"stabilization"),void 0===t.enabled&&(this.options.enabled=!0),!1===this.options.enabled&&(this.physicsEnabled=!1,this.stopSimulation());var e=this.options.wind;e&&(("number"!=typeof e.x||Xp(e.x))&&(e.x=0),("number"!=typeof e.y||Xp(e.y))&&(e.y=0)),this.timestep=this.options.timestep}this.init()}},{key:"init",value:function(){var t;"forceAtlas2Based"===this.options.solver?(this.nodesSolver=new av(this.body,this.physicsBody,t=this.options.forceAtlas2Based),this.edgesSolver=new ov(this.body,this.physicsBody,t),this.gravitySolver=new lv(this.body,this.physicsBody,t)):"repulsion"===this.options.solver?(this.nodesSolver=new iv(this.body,this.physicsBody,t=this.options.repulsion),this.edgesSolver=new ov(this.body,this.physicsBody,t),this.gravitySolver=new sv(this.body,this.physicsBody,t)):"hierarchicalRepulsion"===this.options.solver?(this.nodesSolver=new nv(this.body,this.physicsBody,t=this.options.hierarchicalRepulsion),this.edgesSolver=new rv(this.body,this.physicsBody,t),this.gravitySolver=new sv(this.body,this.physicsBody,t)):(this.nodesSolver=new ev(this.body,this.physicsBody,t=this.options.barnesHut),this.edgesSolver=new ov(this.body,this.physicsBody,t),this.gravitySolver=new sv(this.body,this.physicsBody,t)),this.modelOptions=t}},{key:"initPhysics",value:function(){!0===this.physicsEnabled&&!0===this.options.enabled?!0===this.options.stabilization.enabled?this.stabilize():(this.stabilized=!1,this.ready=!0,this.body.emitter.emit("fit",{},this.layoutFailed),this.startSimulation()):(this.ready=!0,this.body.emitter.emit("fit"))}},{key:"startSimulation",value:function(){var t;!0===this.physicsEnabled&&!0===this.options.enabled?(this.stabilized=!1,this.adaptiveTimestep=!1,this.body.emitter.emit("_resizeNodes"),void 0===this.viewFunction&&(this.viewFunction=Ke(t=this.simulationStep).call(t,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))):this.body.emitter.emit("_redraw")}},{key:"stopSimulation",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.stabilized=!0,!0===t&&this._emitStabilized(),void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.viewFunction=void 0,!0===t&&this.body.emitter.emit("_stopRendering"))}},{key:"simulationStep",value:function(){var t=El();this.physicsTick(),(El()-t<.4*this.simulationInterval||!0===this.runDoubleSpeed)&&!1===this.stabilized&&(this.physicsTick(),this.runDoubleSpeed=!0),!0===this.stabilized&&this.stopSimulation()}},{key:"_emitStabilized",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stabilizationIterations;(this.stabilizationIterations>1||!0===this.startedStabilization)&&kh(function(){t.body.emitter.emit("stabilized",{iterations:e}),t.startedStabilization=!1,t.stabilizationIterations=0},0)}},{key:"physicsStep",value:function(){this.gravitySolver.solve(),this.nodesSolver.solve(),this.edgesSolver.solve(),this.moveNodes()}},{key:"adjustTimeStep",value:function(){!0===this._evaluateStepQuality()?this.timestep=1.2*this.timestep:this.timestep/1.2<this.options.timestep?this.timestep=this.options.timestep:(this.adaptiveCounter=-1,this.timestep=Math.max(this.options.timestep,this.timestep/1.2))}},{key:"physicsTick",value:function(){this._startStabilizing(),!0!==this.stabilized&&(!0===this.adaptiveTimestep&&!0===this.adaptiveTimestepEnabled?(this.adaptiveCounter%this.adaptiveInterval==0?(this.timestep=2*this.timestep,this.physicsStep(),this.revert(),this.timestep=.5*this.timestep,this.physicsStep(),this.physicsStep(),this.adjustTimeStep()):this.physicsStep(),this.adaptiveCounter+=1):(this.timestep=this.options.timestep,this.physicsStep()),!0===this.stabilized&&this.revert(),this.stabilizationIterations++)}},{key:"updatePhysicsData",value:function(){this.physicsBody.forces={},this.physicsBody.physicsNodeIndices=[],this.physicsBody.physicsEdgeIndices=[];var t=this.body.nodes,e=this.body.edges;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&!0===t[i].options.physics&&this.physicsBody.physicsNodeIndices.push(t[i].id);for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&!0===e[n].options.physics&&this.physicsBody.physicsEdgeIndices.push(e[n].id);for(var o=0;o<this.physicsBody.physicsNodeIndices.length;o++){var r=this.physicsBody.physicsNodeIndices[o];this.physicsBody.forces[r]={x:0,y:0},void 0===this.physicsBody.velocities[r]&&(this.physicsBody.velocities[r]={x:0,y:0})}for(var s in this.physicsBody.velocities)void 0===t[s]&&delete this.physicsBody.velocities[s]}},{key:"revert",value:function(){var t=Cl(this.previousStates),e=this.body.nodes,i=this.physicsBody.velocities;this.referenceState={};for(var n=0;n<t.length;n++){var o=t[n];void 0!==e[o]?!0===e[o].options.physics&&(this.referenceState[o]={positions:{x:e[o].x,y:e[o].y}},i[o].x=this.previousStates[o].vx,i[o].y=this.previousStates[o].vy,e[o].x=this.previousStates[o].x,e[o].y=this.previousStates[o].y):delete this.previousStates[o]}}},{key:"_evaluateStepQuality",value:function(){var t,e=this.body.nodes,i=this.referenceState;for(var n in this.referenceState)if(Object.prototype.hasOwnProperty.call(this.referenceState,n)&&void 0!==e[n]&&(t=e[n].y-i[n].positions.y,Math.sqrt(Math.pow(e[n].x-i[n].positions.x,2)+Math.pow(t,2))>.3))return!1;return!0}},{key:"moveNodes",value:function(){for(var t=this.physicsBody.physicsNodeIndices,e=0,i=0,n=0;n<t.length;n++){var o=this._performStep(t[n]);e=Math.max(e,o),i+=o}this.adaptiveTimestepEnabled=i/t.length<5,this.stabilized=e<this.options.minVelocity}},{key:"calculateComponentVelocity",value:function(t,e,i){t+=(e-this.modelOptions.damping*t)/i*this.timestep;var n=this.options.maxVelocity||1e9;return Math.abs(t)>n&&(t=t>0?n:-n),t}},{key:"_performStep",value:function(t){var e=this.body.nodes[t],i=this.physicsBody.forces[t];this.options.wind&&(i.x+=this.options.wind.x,i.y+=this.options.wind.y);var n=this.physicsBody.velocities[t];return this.previousStates[t]={x:e.x,y:e.y,vx:n.x,vy:n.y},!1===e.options.fixed.x?(n.x=this.calculateComponentVelocity(n.x,i.x,e.options.mass),e.x+=n.x*this.timestep):(i.x=0,n.x=0),!1===e.options.fixed.y?(n.y=this.calculateComponentVelocity(n.y,i.y,e.options.mass),e.y+=n.y*this.timestep):(i.y=0,n.y=0),Math.sqrt(Math.pow(n.x,2)+Math.pow(n.y,2))}},{key:"_freezeNodes",value:function(){var t=this.body.nodes;for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e].x&&t[e].y){var i=t[e].options.fixed;this.freezeCache[e]={x:i.x,y:i.y},i.x=!0,i.y=!0}}},{key:"_restoreFrozenNodes",value:function(){var t=this.body.nodes;for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&void 0!==this.freezeCache[e]&&(t[e].options.fixed.x=this.freezeCache[e].x,t[e].options.fixed.y=this.freezeCache[e].y);this.freezeCache={}}},{key:"stabilize",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.stabilization.iterations;"number"!=typeof e&&(e=this.options.stabilization.iterations,console.error("The stabilize method needs a numeric amount of iterations. Switching to default: ",e)),0!==this.physicsBody.physicsNodeIndices.length?(this.adaptiveTimestep=this.options.adaptiveTimestep,this.body.emitter.emit("_resizeNodes"),this.stopSimulation(),this.stabilized=!1,this.body.emitter.emit("_blockRedraw"),this.targetIterations=e,!0===this.options.stabilization.onlyDynamicEdges&&this._freezeNodes(),this.stabilizationIterations=0,kh(function(){return t._stabilizationBatch()},0)):this.ready=!0}},{key:"_startStabilizing",value:function(){return!0!==this.startedStabilization&&(this.body.emitter.emit("startStabilizing"),this.startedStabilization=!0,!0)}},{key:"_stabilizationBatch",value:function(){var t=this,e=function(){return!1===t.stabilized&&t.stabilizationIterations<t.targetIterations},i=function(){t.body.emitter.emit("stabilizationProgress",{iterations:t.stabilizationIterations,total:t.targetIterations})};this._startStabilizing()&&i();for(var n,o=0;e()&&o<this.options.stabilization.updateInterval;)this.physicsTick(),o++;i(),e()?kh(Ke(n=this._stabilizationBatch).call(n,this),0):this._finalizeStabilization()}},{key:"_finalizeStabilization",value:function(){this.body.emitter.emit("_allowRedraw"),!0===this.options.stabilization.fit&&this.body.emitter.emit("fit"),!0===this.options.stabilization.onlyDynamicEdges&&this._restoreFrozenNodes(),this.body.emitter.emit("stabilizationIterationsDone"),this.body.emitter.emit("_requestRedraw"),!0===this.stabilized?this._emitStabilized():this.startSimulation(),this.ready=!0}},{key:"_drawForces",value:function(t){for(var e=0;e<this.physicsBody.physicsNodeIndices.length;e++){var i=this.physicsBody.physicsNodeIndices[e],n=this.body.nodes[i],o=this.physicsBody.forces[i],r=Math.sqrt(Math.pow(o.x,2)+Math.pow(o.x,2)),s=Math.min(Math.max(5,r),15),a=3*s,l=Hu((180-180*Math.min(1,Math.max(0,.03*r)))/360,1,1),c={x:n.x+20*o.x,y:n.y+20*o.y};t.lineWidth=s,t.strokeStyle=l,t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(c.x,c.y),t.stroke();var h=Math.atan2(o.y,o.x);t.fillStyle=l,Vm.draw(t,{type:"arrow",point:c,angle:h,length:a}),Sh(t).call(t)}}}]),t}(),hv=new Uint8Array(16);function dv(){if(!Gm&&!(Gm="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Gm(hv)}var uv=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function fv(t){return"string"==typeof t&&uv.test(t)}for(var pv=[],gv=0;gv<256;++gv)pv.push((gv+256).toString(16).substr(1));function mv(t,e,i){var n=(t=t||{}).random||(t.rng||dv)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){i=i||0;for(var o=0;o<16;++o)e[i+o]=n[o];return e}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(pv[t[e+0]]+pv[t[e+1]]+pv[t[e+2]]+pv[t[e+3]]+"-"+pv[t[e+4]]+pv[t[e+5]]+"-"+pv[t[e+6]]+pv[t[e+7]]+"-"+pv[t[e+8]]+pv[t[e+9]]+"-"+pv[t[e+10]]+pv[t[e+11]]+pv[t[e+12]]+pv[t[e+13]]+pv[t[e+14]]+pv[t[e+15]]).toLowerCase();if(!fv(i))throw TypeError("Stringified UUID is invalid");return i}(n)}var vv=function(){function t(){pa(this,t)}return va(t,null,[{key:"getRange",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).shape.boundingBox.left&&(r=e.shape.boundingBox.left),s<e.shape.boundingBox.right&&(s=e.shape.boundingBox.right),n>e.shape.boundingBox.top&&(n=e.shape.boundingBox.top),o<e.shape.boundingBox.bottom&&(o=e.shape.boundingBox.bottom);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"getRangeCore",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=1e9,o=-1e9,r=1e9,s=-1e9;if(i.length>0)for(var a=0;a<i.length;a++)r>(e=t[i[a]]).x&&(r=e.x),s<e.x&&(s=e.x),n>e.y&&(n=e.y),o<e.y&&(o=e.y);return 1e9===r&&-1e9===s&&1e9===n&&-1e9===o&&(n=0,o=0,r=0,s=0),{minX:r,maxX:s,minY:n,maxY:o}}},{key:"findCenter",value:function(t){return{x:.5*(t.maxX+t.minX),y:.5*(t.maxY+t.minY)}}},{key:"cloneOptions",value:function(t,e){var i={};return void 0===e||"node"===e?(Pu(i,t.options,!0),i.x=t.x,i.y=t.y,i.amountOfConnections=t.edges.length):Pu(i,t.options,!0),i}}]),t}(),yv=function(t){Bg(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}(i);function i(t,n,o,r,s,a){var l;return pa(this,i),(l=e.call(this,t,n,o,r,s,a)).isCluster=!0,l.containedNodes={},l.containedEdges={},l}return va(i,[{key:"_openChildCluster",value:function(t){var e=this,i=this.body.nodes[t];if(void 0===this.containedNodes[t])throw new Error("node with id: "+t+" not in current cluster");if(!i.isCluster)throw new Error("node with id: "+t+" is not a cluster");delete this.containedNodes[t],Ru(i.edges,function(t){delete e.containedEdges[t.id]}),Ru(i.containedNodes,function(t,i){e.containedNodes[i]=t}),i.containedNodes={},Ru(i.containedEdges,function(t,i){e.containedEdges[i]=t}),i.containedEdges={},Ru(i.edges,function(t){Ru(e.edges,function(i){var n,o,r=eh(n=i.clusteringEdgeReplacingIds).call(n,t.id);-1!==r&&(Ru(t.clusteringEdgeReplacingIds,function(t){i.clusteringEdgeReplacingIds.push(t),e.body.edges[t].edgeReplacedById=i.id}),ec(o=i.clusteringEdgeReplacingIds).call(o,r,1))})}),i.edges=[]}}]),i}(um),bv=function(){function t(e){var i=this;pa(this,t),this.body=e,this.clusteredNodes={},this.clusteredEdges={},this.options={},this.defaultOptions={},je(this.options,this.defaultOptions),this.body.emitter.on("_resetData",function(){i.clusteredNodes={},i.clusteredEdges={}})}return va(t,[{key:"clusterByHubsize",value:function(t,e){void 0===t?t=this._getHubSize():"object"===hl(t)&&(e=this._checkOptions(t),t=this._getHubSize());for(var i=[],n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodes[this.body.nodeIndices[n]];o.edges.length>=t&&i.push(o.id)}for(var r=0;r<i.length;r++)this.clusterByConnection(i[r],e,!0);this.body.emitter.emit("_dataChanged")}},{key:"cluster",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(void 0===e.joinCondition)throw new Error("Cannot call clusterByNodeData without a joinCondition function in the options.");e=this._checkOptions(e);var n={},o={};Ru(this.body.nodes,function(i,r){i.options&&!0===e.joinCondition(i.options)&&(n[r]=i,Ru(i.edges,function(e){void 0===t.clusteredEdges[e.id]&&(o[e.id]=e)}))}),this._cluster(n,o,e,i)}},{key:"clusterByEdgeCount",value:function(t,e){var i=this,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e=this._checkOptions(e);for(var o,r,s,a=[],l={},c=function(n){var c={},h={},d=i.body.nodeIndices[n],u=i.body.nodes[d];if(void 0===l[d]){s=0,r=[];for(var f=0;f<u.edges.length;f++)void 0===i.clusteredEdges[(o=u.edges[f]).id]&&(o.toId!==o.fromId&&s++,r.push(o));if(s===t){for(var p=function(t){if(null==e.joinCondition)return!0;var i=vv.cloneOptions(t);return e.joinCondition(i)},g=!0,m=0;m<r.length;m++){var v=i._getConnectedId(o=r[m],d);if(!p(u)){g=!1;break}h[o.id]=o,c[d]=u,c[v]=i.body.nodes[v],l[d]=!0}if(Cl(c).length>0&&Cl(h).length>0&&!0===g){var y=function(){for(var t=0;t<a.length;++t)for(var e in c)if(void 0!==a[t].nodes[e])return a[t]}();if(void 0!==y){for(var b in c)void 0===y.nodes[b]&&(y.nodes[b]=c[b]);for(var w in h)void 0===y.edges[w]&&(y.edges[w]=h[w])}else a.push({nodes:c,edges:h})}}}},h=0;h<this.body.nodeIndices.length;h++)c(h);for(var d=0;d<a.length;d++)this._cluster(a[d].nodes,a[d].edges,e,!1);!0===n&&this.body.emitter.emit("_dataChanged")}},{key:"clusterOutliers",value:function(t){this.clusterByEdgeCount(1,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"clusterBridges",value:function(t){this.clusterByEdgeCount(2,t,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"clusterByConnection",value:function(t,e){var i,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No nodeId supplied to clusterByConnection!");if(void 0===this.body.nodes[t])throw new Error("The nodeId given to clusterByConnection does not exist!");var o=this.body.nodes[t];void 0===(e=this._checkOptions(e,o)).clusterNodeProperties.x&&(e.clusterNodeProperties.x=o.x),void 0===e.clusterNodeProperties.y&&(e.clusterNodeProperties.y=o.y),void 0===e.clusterNodeProperties.fixed&&(e.clusterNodeProperties.fixed={},e.clusterNodeProperties.fixed.x=o.options.fixed.x,e.clusterNodeProperties.fixed.y=o.options.fixed.y);var r={},s={},a=o.id,l=vv.cloneOptions(o);r[a]=o;for(var c=0;c<o.edges.length;c++){var h=o.edges[c];if(void 0===this.clusteredEdges[h.id]){var d=this._getConnectedId(h,a);if(void 0===this.clusteredNodes[d])if(d!==a)if(void 0===e.joinCondition)s[h.id]=h,r[d]=this.body.nodes[d];else{var u=vv.cloneOptions(this.body.nodes[d]);!0===e.joinCondition(l,u)&&(s[h.id]=h,r[d]=this.body.nodes[d])}else s[h.id]=h}}var f=kl(i=Cl(r)).call(i,function(t){return r[t].id});for(var p in r)if(Object.prototype.hasOwnProperty.call(r,p))for(var g=r[p],m=0;m<g.edges.length;m++){var v=g.edges[m];eh(f).call(f,this._getConnectedId(v,g.id))>-1&&(s[v.id]=v)}this._cluster(r,s,e,n)}},{key:"_createClusterEdges",value:function(t,e,i,n){for(var o,r,s,a,l,c,h=Cl(t),d=[],u=0;u<h.length;u++){s=t[r=h[u]];for(var f=0;f<s.edges.length;f++)void 0===this.clusteredEdges[(o=s.edges[f]).id]&&(o.toId==o.fromId?e[o.id]=o:o.toId==r?(a=i.id,c=l=o.fromId):(l=i.id,c=a=o.toId),void 0===t[c]&&d.push({edge:o,fromId:l,toId:a}))}for(var p=[],g=function(t){for(var e=0;e<p.length;e++){var i=p[e];if(t.fromId===i.fromId&&t.toId===i.toId||t.fromId===i.toId&&t.toId===i.fromId)return i}return null},m=0;m<d.length;m++){var v=d[m],y=v.edge,b=g(v);null===b?(b=this._createClusteredEdge(v.fromId,v.toId,y,n),p.push(b)):b.clusteringEdgeReplacingIds.push(y.id),this.body.edges[y.id].edgeReplacedById=b.id,this._backupEdgeOptions(y),y.setOptions({physics:!1})}}},{key:"_checkOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return void 0===t.clusterEdgeProperties&&(t.clusterEdgeProperties={}),void 0===t.clusterNodeProperties&&(t.clusterNodeProperties={}),t}},{key:"_cluster",value:function(t,e,i){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&void 0!==this.clusteredNodes[r]&&o.push(r);for(var s=0;s<o.length;++s)delete t[o[s]];if(0!=Cl(t).length&&(1!=Cl(t).length||1==i.clusterNodeProperties.allowSingleNodeCluster)){var a=Pu({},i.clusterNodeProperties);if(void 0!==i.processProperties){var l=[];for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var h=vv.cloneOptions(t[c]);l.push(h)}var d=[];for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)&&"clusterEdge:"!==u.substr(0,12)){var f=vv.cloneOptions(e[u],"edge");d.push(f)}if(!(a=i.processProperties(a,l,d)))throw new Error("The processProperties function does not return properties!")}void 0===a.id&&(a.id="cluster:"+mv());var p=a.id;void 0===a.label&&(a.label="cluster");var g=void 0;void 0===a.x&&(g=this._getClusterPosition(t),a.x=g.x),void 0===a.y&&(void 0===g&&(g=this._getClusterPosition(t)),a.y=g.y),a.id=p;var m=this.body.functions.createNode(a,yv);m.containedNodes=t,m.containedEdges=e,m.clusterEdgeProperties=i.clusterEdgeProperties,this.body.nodes[a.id]=m,this._clusterEdges(t,e,a,i.clusterEdgeProperties),a.id=void 0,!0===n&&this.body.emitter.emit("_dataChanged")}}},{key:"_backupEdgeOptions",value:function(t){void 0===this.clusteredEdges[t.id]&&(this.clusteredEdges[t.id]={physics:t.options.physics})}},{key:"_restoreEdge",value:function(t){var e=this.clusteredEdges[t.id];void 0!==e&&(t.setOptions({physics:e.physics}),delete this.clusteredEdges[t.id])}},{key:"isCluster",value:function(t){return void 0!==this.body.nodes[t]?!0===this.body.nodes[t].isCluster:(console.error("Node does not exist."),!1)}},{key:"_getClusterPosition",value:function(t){for(var e,i=Cl(t),n=t[i[0]].x,o=t[i[0]].x,r=t[i[0]].y,s=t[i[0]].y,a=1;a<i.length;a++)n=(e=t[i[a]]).x<n?e.x:n,o=e.x>o?e.x:o,r=e.y<r?e.y:r,s=e.y>s?e.y:s;return{x:.5*(n+o),y:.5*(r+s)}}},{key:"openCluster",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(void 0===t)throw new Error("No clusterNodeId supplied to openCluster.");var n=this.body.nodes[t];if(void 0===n)throw new Error("The clusterNodeId supplied to openCluster does not exist.");if(!0!==n.isCluster||void 0===n.containedNodes||void 0===n.containedEdges)throw new Error("The node:"+t+" is not a valid cluster.");var o=this.findNode(t),r=eh(o).call(o,t)-1;if(r>=0)return this.body.nodes[o[r]]._openChildCluster(t),delete this.body.nodes[t],void(!0===i&&this.body.emitter.emit("_dataChanged"));var s=n.containedNodes,a=n.containedEdges;if(void 0!==e&&void 0!==e.releaseFunction&&"function"==typeof e.releaseFunction){var l={},c={x:n.x,y:n.y};for(var h in s)if(Object.prototype.hasOwnProperty.call(s,h)){var d=this.body.nodes[h];l[h]={x:d.x,y:d.y}}var u=e.releaseFunction(c,l);for(var f in s)if(Object.prototype.hasOwnProperty.call(s,f)){var p=this.body.nodes[f];void 0!==u[f]&&(p.x=void 0===u[f].x?n.x:u[f].x,p.y=void 0===u[f].y?n.y:u[f].y)}}else Ru(s,function(t){!1===t.options.fixed.x&&(t.x=n.x),!1===t.options.fixed.y&&(t.y=n.y)});for(var g in s)if(Object.prototype.hasOwnProperty.call(s,g)){var m=this.body.nodes[g];m.vx=n.vx,m.vy=n.vy,m.setOptions({physics:!0}),delete this.clusteredNodes[g]}for(var v=[],y=0;y<n.edges.length;y++)v.push(n.edges[y]);for(var b=0;b<v.length;b++){for(var w=v[b],k=this._getConnectedId(w,t),_=this.clusteredNodes[k],x=0;x<w.clusteringEdgeReplacingIds.length;x++){var C=this.body.edges[w.clusteringEdgeReplacingIds[x]];if(void 0!==C)if(void 0!==_){var E=this.body.nodes[_.clusterId];E.containedEdges[C.id]=C,delete a[C.id];var T=C.fromId,S=C.toId;C.toId==k?S=_.clusterId:T=_.clusterId,this._createClusteredEdge(T,S,C,E.clusterEdgeProperties,{hidden:!1,physics:!0})}else this._restoreEdge(C)}w.remove()}for(var A in a)Object.prototype.hasOwnProperty.call(a,A)&&this._restoreEdge(a[A]);delete this.body.nodes[t],!0===i&&this.body.emitter.emit("_dataChanged")}},{key:"getNodesInCluster",value:function(t){var e=[];if(!0===this.isCluster(t)){var i=this.body.nodes[t].containedNodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.push(this.body.nodes[n].id)}return e}},{key:"findNode",value:function(t){for(var e,i=[],n=0;void 0!==this.clusteredNodes[t]&&n<100;){if(void 0===(e=this.body.nodes[t]))return[];i.push(e.id),t=this.clusteredNodes[t].clusterId,n++}return void 0===(e=this.body.nodes[t])?[]:(i.push(e.id),jl(i).call(i),i)}},{key:"updateClusteredNode",value:function(t,e){if(void 0===t)throw new Error("No clusteredNodeId supplied to updateClusteredNode.");if(void 0===e)throw new Error("No newOptions supplied to updateClusteredNode.");if(void 0===this.body.nodes[t])throw new Error("The clusteredNodeId supplied to updateClusteredNode does not exist.");this.body.nodes[t].setOptions(e),this.body.emitter.emit("_dataChanged")}},{key:"updateEdge",value:function(t,e){if(void 0===t)throw new Error("No startEdgeId supplied to updateEdge.");if(void 0===e)throw new Error("No newOptions supplied to updateEdge.");if(void 0===this.body.edges[t])throw new Error("The startEdgeId supplied to updateEdge does not exist.");for(var i=this.getClusteredEdges(t),n=0;n<i.length;n++)this.body.edges[i[n]].setOptions(e);this.body.emitter.emit("_dataChanged")}},{key:"getClusteredEdges",value:function(t){for(var e=[],i=0;void 0!==t&&void 0!==this.body.edges[t]&&i<100;)e.push(this.body.edges[t].id),t=this.body.edges[t].edgeReplacedById,i++;return jl(e).call(e),e}},{key:"getBaseEdge",value:function(t){return this.getBaseEdges(t)[0]}},{key:"getBaseEdges",value:function(t){for(var e=[t],i=[],n=[],o=0;e.length>0&&o<100;){var r=e.pop();if(void 0!==r){var s=this.body.edges[r];if(void 0!==s){o++;var a=s.clusteringEdgeReplacingIds;if(void 0===a)n.push(r);else for(var l=0;l<a.length;++l){var c=a[l];-1===eh(e).call(e,a)&&-1===eh(i).call(i,a)&&e.push(c)}i.push(r)}}}return n}},{key:"_getConnectedId",value:function(t,e){return t.toId!=e?t.toId:t.fromId}},{key:"_getHubSize",value:function(){for(var t=0,e=0,i=0,n=0,o=0;o<this.body.nodeIndices.length;o++){var r=this.body.nodes[this.body.nodeIndices[o]];r.edges.length>n&&(n=r.edges.length),t+=r.edges.length,e+=Math.pow(r.edges.length,2),i+=1}t/=i;var s=(e/=i)-Math.pow(t,2),a=Math.sqrt(s),l=Math.floor(t+2*a);return l>n&&(l=n),l}},{key:"_createClusteredEdge",value:function(t,e,i,n,o){var r=vv.cloneOptions(i,"edge");Pu(r,n),r.from=t,r.to=e,r.id="clusterEdge:"+mv(),void 0!==o&&Pu(r,o);var s=this.body.functions.createEdge(r);return s.clusteringEdgeReplacingIds=[i.id],s.connect(),this.body.edges[s.id]=s,s}},{key:"_clusterEdges",value:function(t,e,i,n){if(e instanceof Jm){var o={};o[e.id]=e,e=o}if(t instanceof um){var r={};r[t.id]=t,t=r}if(null==i)throw new Error("_clusterEdges: parameter clusterNode required");for(var s in void 0===n&&(n=i.clusterEdgeProperties),this._createClusterEdges(t,e,i,n),e)if(Object.prototype.hasOwnProperty.call(e,s)&&void 0!==this.body.edges[s]){var a=this.body.edges[s];this._backupEdgeOptions(a),a.setOptions({physics:!1})}for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(this.clusteredNodes[l]={clusterId:i.id,node:this.body.nodes[l]},this.body.nodes[l].setOptions({physics:!1}))}},{key:"_getClusterNodeForNode",value:function(t){if(void 0!==t){var e=this.clusteredNodes[t];if(void 0!==e){var i=e.clusterId;if(void 0!==i)return this.body.nodes[i]}}}},{key:"_filter",value:function(t,e){var i=[];return Ru(t,function(t){e(t)&&i.push(t)}),i}},{key:"_updateState",value:function(){var t,e=this,i=[],n={},o=function(t){Ru(e.body.nodes,function(e){!0===e.isCluster&&t(e)})};for(t in this.clusteredNodes)Object.prototype.hasOwnProperty.call(this.clusteredNodes,t)&&void 0===this.body.nodes[t]&&i.push(t);o(function(t){for(var e=0;e<i.length;e++)delete t.containedNodes[i[e]]});for(var r=0;r<i.length;r++)delete this.clusteredNodes[i[r]];Ru(this.clusteredEdges,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()||(n[t]=t)}),o(function(t){Ru(t.containedEdges,function(t,e){t.endPointsValid()||n[e]||(n[e]=e)})}),Ru(this.body.edges,function(t,i){var o=!0,r=t.clusteringEdgeReplacingIds;if(void 0!==r){var s=0;Ru(r,function(t){var i=e.body.edges[t];void 0!==i&&i.endPointsValid()&&(s+=1)}),o=s>0}t.endPointsValid()&&o||(n[i]=i)}),o(function(t){Ru(n,function(i){delete t.containedEdges[i],Ru(t.edges,function(o,r){o.id!==i?o.clusteringEdgeReplacingIds=e._filter(o.clusteringEdgeReplacingIds,function(t){return!n[t]}):t.edges[r]=null}),t.edges=e._filter(t.edges,function(t){return null!==t})})}),Ru(n,function(t){delete e.clusteredEdges[t]}),Ru(n,function(t){delete e.body.edges[t]}),Ru(Cl(this.body.edges),function(t){var i=e.body.edges[t],n=e._isClusteredNode(i.fromId)||e._isClusteredNode(i.toId);if(n!==e._isClusteredEdge(i.id))if(n){var o=e._getClusterNodeForNode(i.fromId);void 0!==o&&e._clusterEdges(e.body.nodes[i.fromId],i,o);var r=e._getClusterNodeForNode(i.toId);void 0!==r&&e._clusterEdges(e.body.nodes[i.toId],i,r)}else delete e._clusterEdges[t],e._restoreEdge(i)});for(var s=!1,a=!0,l=function(){var t=[];o(function(e){var i=Cl(e.containedNodes).length,n=!0===e.options.allowSingleNodeCluster;(n&&i<1||!n&&i<2)&&t.push(e.id)});for(var i=0;i<t.length;++i)e.openCluster(t[i],{},!1);a=t.length>0,s=s||a};a;)l();s&&this._updateState()}},{key:"_isClusteredNode",value:function(t){return void 0!==this.clusteredNodes[t]}},{key:"_isClusteredEdge",value:function(t){return void 0!==this.clusteredEdges[t]}}]),t}();function wv(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return kv(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kv(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function kv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var _v=function(){function t(e,i){var n;pa(this,t),void 0!==window&&(n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),window.requestAnimationFrame=void 0===n?function(t){t()}:n,this.body=e,this.canvas=i,this.redrawRequested=!1,this.renderTimer=void 0,this.requiresTimeout=!0,this.renderingActive=!1,this.renderRequests=0,this.allowRedraw=!0,this.dragging=!1,this.zooming=!1,this.options={},this.defaultOptions={hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1},je(this.options,this.defaultOptions),this._determineBrowserMethod(),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.on("dragStart",function(){e.dragging=!0}),this.body.emitter.on("dragEnd",function(){e.dragging=!1}),this.body.emitter.on("zoom",function(){e.zooming=!0,window.clearTimeout(e.zoomTimeoutId),e.zoomTimeoutId=kh(function(){var t;e.zooming=!1,Ke(t=e._requestRedraw).call(t,e)()},250)}),this.body.emitter.on("_resizeNodes",function(){e._resizeNodes()}),this.body.emitter.on("_redraw",function(){!1===e.renderingActive&&e._redraw()}),this.body.emitter.on("_blockRedraw",function(){e.allowRedraw=!1}),this.body.emitter.on("_allowRedraw",function(){e.allowRedraw=!0,e.redrawRequested=!1}),this.body.emitter.on("_requestRedraw",Ke(t=this._requestRedraw).call(t,this)),this.body.emitter.on("_startRendering",function(){e.renderRequests+=1,e.renderingActive=!0,e._startRendering()}),this.body.emitter.on("_stopRendering",function(){e.renderRequests-=1,e.renderingActive=e.renderRequests>0,e.renderTimer=void 0}),this.body.emitter.on("destroy",function(){e.renderRequests=0,e.allowRedraw=!1,e.renderingActive=!1,!0===e.requiresTimeout?clearTimeout(e.renderTimer):window.cancelAnimationFrame(e.renderTimer),e.body.emitter.off()})}},{key:"setOptions",value:function(t){void 0!==t&&Ou(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag"],this.options,t)}},{key:"_requestNextFrame",value:function(t,e){if("undefined"!=typeof window){var i,n=window;return!0===this.requiresTimeout?i=kh(t,e):n.requestAnimationFrame&&(i=n.requestAnimationFrame(t)),i}}},{key:"_startRendering",value:function(){var t;!0===this.renderingActive&&void 0===this.renderTimer&&(this.renderTimer=this._requestNextFrame(Ke(t=this._renderStep).call(t,this),this.simulationInterval))}},{key:"_renderStep",value:function(){!0===this.renderingActive&&(this.renderTimer=void 0,!0===this.requiresTimeout&&this._startRendering(),this._redraw(),!1===this.requiresTimeout&&this._startRendering())}},{key:"redraw",value:function(){this.body.emitter.emit("setSize"),this._redraw()}},{key:"_requestRedraw",value:function(){var t=this;!0!==this.redrawRequested&&!1===this.renderingActive&&!0===this.allowRedraw&&(this.redrawRequested=!0,this._requestNextFrame(function(){t._redraw(!1)},0))}},{key:"_redraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.allowRedraw){this.body.emitter.emit("initRedraw"),this.redrawRequested=!1;var e={drawExternalLabels:null};0!==this.canvas.frame.canvas.width&&0!==this.canvas.frame.canvas.height||this.canvas.setSize(),this.canvas.setTransform();var i=this.canvas.getContext(),n=this.canvas.frame.canvas.clientWidth,o=this.canvas.frame.canvas.clientHeight;if(i.clearRect(0,0,n,o),0===this.canvas.frame.clientWidth)return;if(i.save(),i.translate(this.body.view.translation.x,this.body.view.translation.y),i.scale(this.body.view.scale,this.body.view.scale),i.beginPath(),this.body.emitter.emit("beforeDrawing",i),i.closePath(),!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawEdges(i),!1===this.dragging||!0===this.dragging&&!1===this.options.hideNodesOnDrag){var r=this._drawNodes(i,t);e.drawExternalLabels=r.drawExternalLabels}!1===t&&(!1===this.dragging||!0===this.dragging&&!1===this.options.hideEdgesOnDrag)&&(!1===this.zooming||!0===this.zooming&&!1===this.options.hideEdgesOnZoom)&&this._drawArrows(i),null!=e.drawExternalLabels&&e.drawExternalLabels(),!1===t&&this._drawSelectionBox(i),i.beginPath(),this.body.emitter.emit("afterDrawing",i),i.closePath(),i.restore(),!0===t&&i.clearRect(0,0,n,o)}}},{key:"_resizeNodes",value:function(){this.canvas.setTransform();var t=this.canvas.getContext();t.save(),t.translate(this.body.view.translation.x,this.body.view.translation.y),t.scale(this.body.view.scale,this.body.view.scale);var e,i=this.body.nodes;for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&((e=i[n]).resize(t),e.updateBoundingBox(t,e.selected));t.restore()}},{key:"_drawNodes",value:function(t){for(var e,i,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.body.nodes,r=this.body.nodeIndices,s=[],a=[],l=20,c=this.canvas.DOMtoCanvas({x:-l,y:-l}),h=this.canvas.DOMtoCanvas({x:this.canvas.frame.canvas.clientWidth+l,y:this.canvas.frame.canvas.clientHeight+l}),d={top:c.y,left:c.x,bottom:h.y,right:h.x},u=[],f=0;f<r.length;f++)if((e=o[r[f]]).hover)a.push(r[f]);else if(e.isSelected())s.push(r[f]);else if(!0===n){var p=e.draw(t);null!=p.drawExternalLabel&&u.push(p.drawExternalLabel)}else if(!0===e.isBoundingBoxOverlappingWith(d)){var g=e.draw(t);null!=g.drawExternalLabel&&u.push(g.drawExternalLabel)}else e.updateBoundingBox(t,e.selected);var m=s.length,v=a.length;for(i=0;i<m;i++){var y=(e=o[s[i]]).draw(t);null!=y.drawExternalLabel&&u.push(y.drawExternalLabel)}for(i=0;i<v;i++){var b=(e=o[a[i]]).draw(t);null!=b.drawExternalLabel&&u.push(b.drawExternalLabel)}return{drawExternalLabels:function(){var t,e=wv(u);try{for(e.s();!(t=e.n()).done;)(0,t.value)()}catch(t){e.e(t)}finally{e.f()}}}}},{key:"_drawEdges",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.draw(t)}}},{key:"_drawArrows",value:function(t){for(var e=this.body.edges,i=this.body.edgeIndices,n=0;n<i.length;n++){var o=e[i[n]];!0===o.connected&&o.drawArrows(t)}}},{key:"_determineBrowserMethod",value:function(){if("undefined"!=typeof window){var t=navigator.userAgent.toLowerCase();this.requiresTimeout=!1,(-1!=eh(t).call(t,"msie 9.0")||-1!=eh(t).call(t,"safari")&&eh(t).call(t,"chrome")<=-1)&&(this.requiresTimeout=!0)}else this.requiresTimeout=!0}},{key:"_drawSelectionBox",value:function(t){if(this.body.selectionBox.show){t.beginPath();var e=this.body.selectionBox.position.end.x-this.body.selectionBox.position.start.x,i=this.body.selectionBox.position.end.y-this.body.selectionBox.position.start.y;t.rect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.fillStyle="rgba(151, 194, 252, 0.2)",t.fillRect(this.body.selectionBox.position.start.x,this.body.selectionBox.position.start.y,e,i),t.strokeStyle="rgba(151, 194, 252, 1)",t.stroke()}else t.closePath()}}]),t}(),xv=E.setInterval;function Cv(t,e){e.inputHandler=function(t){t.isFirst&&e(t)},t.on("hammer.input",e.inputHandler)}function Ev(t,e){return e.inputHandler=function(t){t.isFinal&&e(t)},t.on("hammer.input",e.inputHandler)}var Tv=function(){function t(e){pa(this,t),this.body=e,this.pixelRatio=1,this.cameraState={},this.initialized=!1,this.canvasViewCenter={},this._cleanupCallbacks=[],this.options={},this.defaultOptions={autoResize:!0,height:"100%",width:"100%"},je(this.options,this.defaultOptions),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t,e=this;this.body.emitter.once("resize",function(t){0!==t.width&&(e.body.view.translation.x=.5*t.width),0!==t.height&&(e.body.view.translation.y=.5*t.height)}),this.body.emitter.on("setSize",Ke(t=this.setSize).call(t,this)),this.body.emitter.on("destroy",function(){e.hammerFrame.destroy(),e.hammer.destroy(),e._cleanUp()})}},{key:"setOptions",value:function(t){var e,i,n,o,r,s=this;if(void 0!==t&&Ou(["width","height","autoResize"],this.options,t),this._cleanUp(),!0===this.options.autoResize){var a;if(window.ResizeObserver){var l=new ResizeObserver(function(){!0===s.setSize()&&s.body.emitter.emit("_requestRedraw")}),c=this.frame;l.observe(c),this._cleanupCallbacks.push(function(){l.unobserve(c)})}else{var h=xv(function(){!0===s.setSize()&&s.body.emitter.emit("_requestRedraw")},1e3);this._cleanupCallbacks.push(function(){clearInterval(h)})}var d=Ke(a=this._onResize).call(a,this);e=window,i="resize",n=d,e.addEventListener?(void 0===o&&(o=!1),"mousewheel"===i&&mc(r=navigator.userAgent).call(r,"Firefox")&&(i="DOMMouseScroll"),e.addEventListener(i,n,o)):e.attachEvent("on"+i,n),this._cleanupCallbacks.push(function(){!function(t,e,i,n){var o;t.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&mc(o=navigator.userAgent).call(o,"Firefox")&&(e="DOMMouseScroll"),t.removeEventListener(e,i,n)):t.detachEvent("on"+e,i)}(window,"resize",d)})}}},{key:"_cleanUp",value:function(){var t,e,i;Nl(t=jl(e=ec(i=this._cleanupCallbacks).call(i,0)).call(e)).call(t,function(t){try{t()}catch(t){console.error(t)}})}},{key:"_onResize",value:function(){this.setSize(),this.body.emitter.emit("_redraw")}},{key:"_getCameraState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pixelRatio;!0===this.initialized&&(this.cameraState.previousWidth=this.frame.canvas.width/t,this.cameraState.previousHeight=this.frame.canvas.height/t,this.cameraState.scale=this.body.view.scale,this.cameraState.position=this.DOMtoCanvas({x:.5*this.frame.canvas.width/t,y:.5*this.frame.canvas.height/t}))}},{key:"_setCameraState",value:function(){if(void 0!==this.cameraState.scale&&0!==this.frame.canvas.clientWidth&&0!==this.frame.canvas.clientHeight&&0!==this.pixelRatio&&this.cameraState.previousWidth>0&&this.cameraState.previousHeight>0){var t=this.frame.canvas.width/this.pixelRatio/this.cameraState.previousWidth,e=this.frame.canvas.height/this.pixelRatio/this.cameraState.previousHeight,i=this.cameraState.scale;1!=t&&1!=e?i=.5*this.cameraState.scale*(t+e):1!=t?i=this.cameraState.scale*t:1!=e&&(i=this.cameraState.scale*e),this.body.view.scale=i;var n=this.DOMtoCanvas({x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight}),o={x:n.x-this.cameraState.position.x,y:n.y-this.cameraState.position.y};this.body.view.translation.x+=o.x*this.body.view.scale,this.body.view.translation.y+=o.y*this.body.view.scale}}},{key:"_prepareValue",value:function(t){if("number"==typeof t)return t+"px";if("string"==typeof t){if(-1!==eh(t).call(t,"%")||-1!==eh(t).call(t,"px"))return t;if(-1===eh(t).call(t,"%"))return t+"px"}throw new Error("Could not use the value supplied for width or height:"+t)}},{key:"_create",value:function(){for(;this.body.container.hasChildNodes();)this.body.container.removeChild(this.body.container.firstChild);if(this.frame=document.createElement("div"),this.frame.className="vis-network",this.frame.style.position="relative",this.frame.style.overflow="hidden",this.frame.tabIndex=0,this.frame.canvas=document.createElement("canvas"),this.frame.canvas.style.position="relative",this.frame.appendChild(this.frame.canvas),this.frame.canvas.getContext)this._setPixelRatio(),this.setTransform();else{var t=document.createElement("DIV");t.style.color="red",t.style.fontWeight="bold",t.style.padding="10px",t.innerText="Error: your browser does not support HTML canvas",this.frame.canvas.appendChild(t)}this.body.container.appendChild(this.frame),this.body.view.scale=1,this.body.view.translation={x:.5*this.frame.canvas.clientWidth,y:.5*this.frame.canvas.clientHeight},this._bindHammer()}},{key:"_bindHammer",value:function(){var t=this;void 0!==this.hammer&&this.hammer.destroy(),this.drag={},this.pinch={},this.hammer=new rf(this.frame.canvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.get("pan").set({threshold:5,direction:rf.DIRECTION_ALL}),Cv(this.hammer,function(e){t.body.eventListeners.onTouch(e)}),this.hammer.on("tap",function(e){t.body.eventListeners.onTap(e)}),this.hammer.on("doubletap",function(e){t.body.eventListeners.onDoubleTap(e)}),this.hammer.on("press",function(e){t.body.eventListeners.onHold(e)}),this.hammer.on("panstart",function(e){t.body.eventListeners.onDragStart(e)}),this.hammer.on("panmove",function(e){t.body.eventListeners.onDrag(e)}),this.hammer.on("panend",function(e){t.body.eventListeners.onDragEnd(e)}),this.hammer.on("pinch",function(e){t.body.eventListeners.onPinch(e)}),this.frame.canvas.addEventListener("wheel",function(e){t.body.eventListeners.onMouseWheel(e)}),this.frame.canvas.addEventListener("mousemove",function(e){t.body.eventListeners.onMouseMove(e)}),this.frame.canvas.addEventListener("contextmenu",function(e){t.body.eventListeners.onContext(e)}),this.hammerFrame=new rf(this.frame),Ev(this.hammerFrame,function(e){t.body.eventListeners.onRelease(e)})}},{key:"setSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options.width,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.height;t=this._prepareValue(t),e=this._prepareValue(e);var i=!1,n=this.frame.canvas.width,o=this.frame.canvas.height,r=this.pixelRatio;if(this._setPixelRatio(),t!=this.options.width||e!=this.options.height||this.frame.style.width!=t||this.frame.style.height!=e)this._getCameraState(r),this.frame.style.width=t,this.frame.style.height=e,this.frame.canvas.style.width="100%",this.frame.canvas.style.height="100%",this.frame.canvas.width=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),this.frame.canvas.height=Math.round(this.frame.canvas.clientHeight*this.pixelRatio),this.options.width=t,this.options.height=e,this.canvasViewCenter={x:.5*this.frame.clientWidth,y:.5*this.frame.clientHeight},i=!0;else{var s=Math.round(this.frame.canvas.clientWidth*this.pixelRatio),a=Math.round(this.frame.canvas.clientHeight*this.pixelRatio);this.frame.canvas.width===s&&this.frame.canvas.height===a||this._getCameraState(r),this.frame.canvas.width!==s&&(this.frame.canvas.width=s,i=!0),this.frame.canvas.height!==a&&(this.frame.canvas.height=a,i=!0)}return!0===i&&(this.body.emitter.emit("resize",{width:Math.round(this.frame.canvas.width/this.pixelRatio),height:Math.round(this.frame.canvas.height/this.pixelRatio),oldWidth:Math.round(n/this.pixelRatio),oldHeight:Math.round(o/this.pixelRatio)}),this._setCameraState()),this.initialized=!0,i}},{key:"getContext",value:function(){return this.frame.canvas.getContext("2d")}},{key:"_determinePixelRatio",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");var e=1;return"undefined"!=typeof window&&(e=window.devicePixelRatio||1),e/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},{key:"_setPixelRatio",value:function(){this.pixelRatio=this._determinePixelRatio()}},{key:"setTransform",value:function(){var t=this.getContext();if(void 0===t)throw new Error("Could not get canvax context");t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}},{key:"_XconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.x)/this.body.view.scale}},{key:"_XconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.x}},{key:"_YconvertDOMtoCanvas",value:function(t){return(t-this.body.view.translation.y)/this.body.view.scale}},{key:"_YconvertCanvasToDOM",value:function(t){return t*this.body.view.scale+this.body.view.translation.y}},{key:"canvasToDOM",value:function(t){return{x:this._XconvertCanvasToDOM(t.x),y:this._YconvertCanvasToDOM(t.y)}}},{key:"DOMtoCanvas",value:function(t){return{x:this._XconvertDOMtoCanvas(t.x),y:this._YconvertDOMtoCanvas(t.y)}}}]),t}();function Sv(t,e){var i=je({nodes:e,minZoomLevel:Number.MIN_VALUE,maxZoomLevel:1},null!=t?t:{});if(!vl(i.nodes))throw new TypeError("Nodes has to be an array of ids.");if(0===i.nodes.length&&(i.nodes=e),!("number"==typeof i.minZoomLevel&&i.minZoomLevel>0))throw new TypeError("Min zoom level has to be a number higher than zero.");if(!("number"==typeof i.maxZoomLevel&&i.minZoomLevel<=i.maxZoomLevel))throw new TypeError("Max zoom level has to be a number higher than min zoom level.");return i}var Av=function(){function t(e,i){var n,o,r=this;pa(this,t),this.body=e,this.canvas=i,this.animationSpeed=1/this.renderRefreshRate,this.animationEasingFunction="easeInOutQuint",this.easingTime=0,this.sourceScale=0,this.targetScale=0,this.sourceTranslation=0,this.targetTranslation=0,this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0,this.touchTime=0,this.viewFunction=void 0,this.body.emitter.on("fit",Ke(n=this.fit).call(n,this)),this.body.emitter.on("animationFinished",function(){r.body.emitter.emit("_stopRendering")}),this.body.emitter.on("unlockNode",Ke(o=this.releaseNode).call(o,this))}return va(t,[{key:"setOptions",value:function(){this.options=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}},{key:"fit",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=Sv(t,this.body.nodeIndices);var i,n,o=this.canvas.frame.canvas.clientWidth,r=this.canvas.frame.canvas.clientHeight;if(0===o||0===r)n=1,i=vv.getRange(this.body.nodes,t.nodes);else if(!0===e){var s=0;for(var a in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,a)&&!0===this.body.nodes[a].predefinedPosition&&(s+=1);if(s>.5*this.body.nodeIndices.length)return void this.fit(t,!1);i=vv.getRange(this.body.nodes,t.nodes),n=12.662/(this.body.nodeIndices.length+7.4147)+.0964822,n*=Math.min(o/600,r/600)}else{this.body.emitter.emit("_resizeNodes"),i=vv.getRange(this.body.nodes,t.nodes);var l=o/(1.1*Math.abs(i.maxX-i.minX)),c=r/(1.1*Math.abs(i.maxY-i.minY));n=l<=c?l:c}n>t.maxZoomLevel?n=t.maxZoomLevel:n<t.minZoomLevel&&(n=t.minZoomLevel);var h=vv.findCenter(i);this.moveTo({position:h,scale:n,animation:t.animation})}},{key:"focus",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};void 0!==this.body.nodes[t]?(e.position={x:this.body.nodes[t].x,y:this.body.nodes[t].y},e.lockedOnNode=t,this.moveTo(e)):console.error("Node: "+t+" cannot be found.")}},{key:"moveTo",value:function(t){if(void 0!==t){if(null!=t.offset){if(null!=t.offset.x){if(t.offset.x=+t.offset.x,!Qp(t.offset.x))throw new TypeError('The option "offset.x" has to be a finite number.')}else t.offset.x=0;if(null!=t.offset.y){if(t.offset.y=+t.offset.y,!Qp(t.offset.y))throw new TypeError('The option "offset.y" has to be a finite number.')}else t.offset.x=0}else t.offset={x:0,y:0};if(null!=t.position){if(null!=t.position.x){if(t.position.x=+t.position.x,!Qp(t.position.x))throw new TypeError('The option "position.x" has to be a finite number.')}else t.position.x=0;if(null!=t.position.y){if(t.position.y=+t.position.y,!Qp(t.position.y))throw new TypeError('The option "position.y" has to be a finite number.')}else t.position.x=0}else t.position=this.getViewPosition();if(null!=t.scale){if(t.scale=+t.scale,!(t.scale>0))throw new TypeError('The option "scale" has to be a number greater than zero.')}else t.scale=this.body.view.scale;void 0===t.animation&&(t.animation={duration:0}),!1===t.animation&&(t.animation={duration:0}),!0===t.animation&&(t.animation={}),void 0===t.animation.duration&&(t.animation.duration=1e3),void 0===t.animation.easingFunction&&(t.animation.easingFunction="easeInOutQuad"),this.animateView(t)}else t={}}},{key:"animateView",value:function(t){if(void 0!==t){this.animationEasingFunction=t.animation.easingFunction,this.releaseNode(),!0===t.locked&&(this.lockedOnNodeId=t.lockedOnNode,this.lockedOnNodeOffset=t.offset),0!=this.easingTime&&this._transitionRedraw(!0),this.sourceScale=this.body.view.scale,this.sourceTranslation=this.body.view.translation,this.targetScale=t.scale,this.body.view.scale=this.targetScale;var e,i,n=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight});this.targetTranslation={x:this.sourceTranslation.x+(n.x-t.position.x)*this.targetScale+t.offset.x,y:this.sourceTranslation.y+(n.y-t.position.y)*this.targetScale+t.offset.y},0===t.animation.duration?null!=this.lockedOnNodeId?(this.viewFunction=Ke(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)):(this.body.view.scale=this.targetScale,this.body.view.translation=this.targetTranslation,this.body.emitter.emit("_requestRedraw")):(this.animationSpeed=1/(60*t.animation.duration*.001)||1/60,this.animationEasingFunction=t.animation.easingFunction,this.viewFunction=Ke(i=this._transitionRedraw).call(i,this),this.body.emitter.on("initRedraw",this.viewFunction),this.body.emitter.emit("_startRendering"))}}},{key:"_lockedRedraw",value:function(){var t=this.body.nodes[this.lockedOnNodeId].x,e=this.body.nodes[this.lockedOnNodeId].y,i=this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight}),n=this.body.view.translation;this.body.view.translation={x:n.x+(i.x-t)*this.body.view.scale+this.lockedOnNodeOffset.x,y:n.y+(i.y-e)*this.body.view.scale+this.lockedOnNodeOffset.y}}},{key:"releaseNode",value:function(){void 0!==this.lockedOnNodeId&&void 0!==this.viewFunction&&(this.body.emitter.off("initRedraw",this.viewFunction),this.lockedOnNodeId=void 0,this.lockedOnNodeOffset=void 0)}},{key:"_transitionRedraw",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.easingTime+=this.animationSpeed,this.easingTime=!0===t?1:this.easingTime;var e,i=Zu[this.animationEasingFunction](this.easingTime);this.body.view.scale=this.sourceScale+(this.targetScale-this.sourceScale)*i,this.body.view.translation={x:this.sourceTranslation.x+(this.targetTranslation.x-this.sourceTranslation.x)*i,y:this.sourceTranslation.y+(this.targetTranslation.y-this.sourceTranslation.y)*i},this.easingTime>=1&&(this.body.emitter.off("initRedraw",this.viewFunction),this.easingTime=0,null!=this.lockedOnNodeId&&(this.viewFunction=Ke(e=this._lockedRedraw).call(e,this),this.body.emitter.on("initRedraw",this.viewFunction)),this.body.emitter.emit("animationFinished"))}},{key:"getScale",value:function(){return this.body.view.scale}},{key:"getViewPosition",value:function(){return this.canvas.DOMtoCanvas({x:.5*this.canvas.frame.canvas.clientWidth,y:.5*this.canvas.frame.canvas.clientHeight})}}]),t}(),Ov=function(){function t(e,i){var n=this;pa(this,t),this.body=e,this.canvas=i,this.iconsCreated=!1,this.navigationHammers=[],this.boundFunctions={},this.touchTime=0,this.activated=!1,this.body.emitter.on("activate",function(){n.activated=!0,n.configureKeyboardBindings()}),this.body.emitter.on("deactivate",function(){n.activated=!1,n.configureKeyboardBindings()}),this.body.emitter.on("destroy",function(){void 0!==n.keycharm&&n.keycharm.destroy()}),this.options={}}return va(t,[{key:"setOptions",value:function(t){void 0!==t&&(this.options=t,this.create())}},{key:"create",value:function(){!0===this.options.navigationButtons?!1===this.iconsCreated&&this.loadNavigationElements():!0===this.iconsCreated&&this.cleanNavigation(),this.configureKeyboardBindings()}},{key:"cleanNavigation",value:function(){if(0!=this.navigationHammers.length){for(var t=0;t<this.navigationHammers.length;t++)this.navigationHammers[t].destroy();this.navigationHammers=[]}this.navigationDOM&&this.navigationDOM.wrapper&&this.navigationDOM.wrapper.parentNode&&this.navigationDOM.wrapper.parentNode.removeChild(this.navigationDOM.wrapper),this.iconsCreated=!1}},{key:"loadNavigationElements",value:function(){var t=this;this.cleanNavigation(),this.navigationDOM={};var e=["up","down","left","right","zoomIn","zoomOut","zoomExtends"],i=["_moveUp","_moveDown","_moveLeft","_moveRight","_zoomIn","_zoomOut","_fit"];this.navigationDOM.wrapper=document.createElement("div"),this.navigationDOM.wrapper.className="vis-navigation",this.canvas.frame.appendChild(this.navigationDOM.wrapper);for(var n=0;n<e.length;n++){this.navigationDOM[e[n]]=document.createElement("div"),this.navigationDOM[e[n]].className="vis-button vis-"+e[n],this.navigationDOM.wrapper.appendChild(this.navigationDOM[e[n]]);var o,r,s=new rf(this.navigationDOM[e[n]]);Cv(s,"_fit"===i[n]?Ke(o=this._fit).call(o,this):Ke(r=this.bindToRedraw).call(r,this,i[n])),this.navigationHammers.push(s)}var a=new rf(this.canvas.frame);Ev(a,function(){t._stopMovement()}),this.navigationHammers.push(a),this.iconsCreated=!0}},{key:"bindToRedraw",value:function(t){var e;void 0===this.boundFunctions[t]&&(this.boundFunctions[t]=Ke(e=this[t]).call(e,this),this.body.emitter.on("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_startRendering"))}},{key:"unbindFromRedraw",value:function(t){void 0!==this.boundFunctions[t]&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"),delete this.boundFunctions[t])}},{key:"_fit",value:function(){(new Date).valueOf()-this.touchTime>700&&(this.body.emitter.emit("fit",{duration:700}),this.touchTime=(new Date).valueOf())}},{key:"_stopMovement",value:function(){for(var t in this.boundFunctions)Object.prototype.hasOwnProperty.call(this.boundFunctions,t)&&(this.body.emitter.off("initRedraw",this.boundFunctions[t]),this.body.emitter.emit("_stopRendering"));this.boundFunctions={}}},{key:"_moveUp",value:function(){this.body.view.translation.y+=this.options.keyboard.speed.y}},{key:"_moveDown",value:function(){this.body.view.translation.y-=this.options.keyboard.speed.y}},{key:"_moveLeft",value:function(){this.body.view.translation.x+=this.options.keyboard.speed.x}},{key:"_moveRight",value:function(){this.body.view.translation.x-=this.options.keyboard.speed.x}},{key:"_zoomIn",value:function(){var t=this.body.view.scale*(1+this.options.keyboard.speed.zoom),e=this.body.view.translation,i=t/this.body.view.scale,n=(1-i)*this.canvas.canvasViewCenter.x+e.x*i,o=(1-i)*this.canvas.canvasViewCenter.y+e.y*i;this.body.view.scale=t,this.body.view.translation={x:n,y:o},this.body.emitter.emit("zoom",{direction:"+",scale:this.body.view.scale,pointer:null})}},{key:"_zoomOut",value:function(){var t=this.body.view.scale/(1+this.options.keyboard.speed.zoom),e=this.body.view.translation,i=t/this.body.view.scale,n=(1-i)*this.canvas.canvasViewCenter.x+e.x*i,o=(1-i)*this.canvas.canvasViewCenter.y+e.y*i;this.body.view.scale=t,this.body.view.translation={x:n,y:o},this.body.emitter.emit("zoom",{direction:"-",scale:this.body.view.scale,pointer:null})}},{key:"configureKeyboardBindings",value:function(){var t,e,i,n,o,r,s,a,l,c,h,d,u,f,p,g,m,v,y,b,w,k,_,x,C=this;void 0!==this.keycharm&&this.keycharm.destroy(),!0===this.options.keyboard.enabled&&(this.keycharm=function(t){var e,i=t&&t.preventDefault||!1,n=t&&t.container||window,o={},r={keydown:{},keyup:{}},s={};for(e=97;e<=122;e++)s[String.fromCharCode(e)]={code:e-97+65,shift:!1};for(e=65;e<=90;e++)s[String.fromCharCode(e)]={code:e,shift:!0};for(e=0;e<=9;e++)s[""+e]={code:48+e,shift:!1};for(e=1;e<=12;e++)s["F"+e]={code:111+e,shift:!1};for(e=0;e<=9;e++)s["num"+e]={code:96+e,shift:!1};s["num*"]={code:106,shift:!1},s["num+"]={code:107,shift:!1},s["num-"]={code:109,shift:!1},s["num/"]={code:111,shift:!1},s["num."]={code:110,shift:!1},s.left={code:37,shift:!1},s.up={code:38,shift:!1},s.right={code:39,shift:!1},s.down={code:40,shift:!1},s.space={code:32,shift:!1},s.enter={code:13,shift:!1},s.shift={code:16,shift:void 0},s.esc={code:27,shift:!1},s.backspace={code:8,shift:!1},s.tab={code:9,shift:!1},s.ctrl={code:17,shift:!1},s.alt={code:18,shift:!1},s.delete={code:46,shift:!1},s.pageup={code:33,shift:!1},s.pagedown={code:34,shift:!1},s["="]={code:187,shift:!1},s["-"]={code:189,shift:!1},s["]"]={code:221,shift:!1},s["["]={code:219,shift:!1};var a=function(t){c(t,"keydown")},l=function(t){c(t,"keyup")},c=function(t,e){if(void 0!==r[e][t.keyCode]){for(var n=r[e][t.keyCode],o=0;o<n.length;o++)(void 0===n[o].shift||1==n[o].shift&&1==t.shiftKey||0==n[o].shift&&0==t.shiftKey)&&n[o].fn(t);1==i&&t.preventDefault()}};return o.bind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw new Error("unsupported key: "+t);void 0===r[i][s[t].code]&&(r[i][s[t].code]=[]),r[i][s[t].code].push({fn:e,shift:s[t].shift})},o.bindAll=function(t,e){for(var i in void 0===e&&(e="keydown"),s)s.hasOwnProperty(i)&&o.bind(i,t,e)},o.getKey=function(t){for(var e in s)if(s.hasOwnProperty(e)){if(1==t.shiftKey&&1==s[e].shift&&t.keyCode==s[e].code)return e;if(0==t.shiftKey&&0==s[e].shift&&t.keyCode==s[e].code)return e;if(t.keyCode==s[e].code&&"shift"==e)return e}return"unknown key, currently not supported"},o.unbind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===s[t])throw new Error("unsupported key: "+t);if(void 0!==e){var n=[],o=r[i][s[t].code];if(void 0!==o)for(var a=0;a<o.length;a++)o[a].fn==e&&o[a].shift==s[t].shift||n.push(r[i][s[t].code][a]);r[i][s[t].code]=n}else r[i][s[t].code]=[]},o.reset=function(){r={keydown:{},keyup:{}}},o.destroy=function(){r={keydown:{},keyup:{}},n.removeEventListener("keydown",a,!0),n.removeEventListener("keyup",l,!0)},n.addEventListener("keydown",a,!0),n.addEventListener("keyup",l,!0),o}(!0===this.options.keyboard.bindToWindow?{container:window,preventDefault:!0}:{container:this.canvas.frame,preventDefault:!0}),this.keycharm.reset(),!0===this.activated&&(Ke(t=this.keycharm).call(t,"up",function(){C.bindToRedraw("_moveUp")},"keydown"),Ke(e=this.keycharm).call(e,"down",function(){C.bindToRedraw("_moveDown")},"keydown"),Ke(i=this.keycharm).call(i,"left",function(){C.bindToRedraw("_moveLeft")},"keydown"),Ke(n=this.keycharm).call(n,"right",function(){C.bindToRedraw("_moveRight")},"keydown"),Ke(o=this.keycharm).call(o,"=",function(){C.bindToRedraw("_zoomIn")},"keydown"),Ke(r=this.keycharm).call(r,"num+",function(){C.bindToRedraw("_zoomIn")},"keydown"),Ke(s=this.keycharm).call(s,"num-",function(){C.bindToRedraw("_zoomOut")},"keydown"),Ke(a=this.keycharm).call(a,"-",function(){C.bindToRedraw("_zoomOut")},"keydown"),Ke(l=this.keycharm).call(l,"[",function(){C.bindToRedraw("_zoomOut")},"keydown"),Ke(c=this.keycharm).call(c,"]",function(){C.bindToRedraw("_zoomIn")},"keydown"),Ke(h=this.keycharm).call(h,"pageup",function(){C.bindToRedraw("_zoomIn")},"keydown"),Ke(d=this.keycharm).call(d,"pagedown",function(){C.bindToRedraw("_zoomOut")},"keydown"),Ke(u=this.keycharm).call(u,"up",function(){C.unbindFromRedraw("_moveUp")},"keyup"),Ke(f=this.keycharm).call(f,"down",function(){C.unbindFromRedraw("_moveDown")},"keyup"),Ke(p=this.keycharm).call(p,"left",function(){C.unbindFromRedraw("_moveLeft")},"keyup"),Ke(g=this.keycharm).call(g,"right",function(){C.unbindFromRedraw("_moveRight")},"keyup"),Ke(m=this.keycharm).call(m,"=",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),Ke(v=this.keycharm).call(v,"num+",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),Ke(y=this.keycharm).call(y,"num-",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),Ke(b=this.keycharm).call(b,"-",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),Ke(w=this.keycharm).call(w,"[",function(){C.unbindFromRedraw("_zoomOut")},"keyup"),Ke(k=this.keycharm).call(k,"]",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),Ke(_=this.keycharm).call(_,"pageup",function(){C.unbindFromRedraw("_zoomIn")},"keyup"),Ke(x=this.keycharm).call(x,"pagedown",function(){C.unbindFromRedraw("_zoomOut")},"keyup")))}}]),t}();function Iv(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Pv=function(){function t(e,i,n){var o,r,s,a,l,c,h,d,u,f,p,g,m;pa(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.navigationHandler=new Ov(e,i),this.body.eventListeners.onTap=Ke(o=this.onTap).call(o,this),this.body.eventListeners.onTouch=Ke(r=this.onTouch).call(r,this),this.body.eventListeners.onDoubleTap=Ke(s=this.onDoubleTap).call(s,this),this.body.eventListeners.onHold=Ke(a=this.onHold).call(a,this),this.body.eventListeners.onDragStart=Ke(l=this.onDragStart).call(l,this),this.body.eventListeners.onDrag=Ke(c=this.onDrag).call(c,this),this.body.eventListeners.onDragEnd=Ke(h=this.onDragEnd).call(h,this),this.body.eventListeners.onMouseWheel=Ke(d=this.onMouseWheel).call(d,this),this.body.eventListeners.onPinch=Ke(u=this.onPinch).call(u,this),this.body.eventListeners.onMouseMove=Ke(f=this.onMouseMove).call(f,this),this.body.eventListeners.onRelease=Ke(p=this.onRelease).call(p,this),this.body.eventListeners.onContext=Ke(g=this.onContext).call(g,this),this.touchTime=0,this.drag={},this.pinch={},this.popup=void 0,this.popupObj=void 0,this.popupTimer=void 0,this.body.functions.getPointer=Ke(m=this.getPointer).call(m,this),this.options={},this.defaultOptions={dragNodes:!0,dragView:!0,hover:!1,keyboard:{enabled:!1,speed:{x:10,y:10,zoom:.02},bindToWindow:!0,autoFocus:!0},navigationButtons:!1,tooltipDelay:300,zoomView:!0,zoomSpeed:1},je(this.options,this.defaultOptions),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("destroy",function(){clearTimeout(t.popupTimer),delete t.body.functions.getPointer})}},{key:"setOptions",value:function(t){void 0!==t&&(Iu(["hideEdgesOnDrag","hideEdgesOnZoom","hideNodesOnDrag","keyboard","multiselect","selectable","selectConnectedEdges"],this.options,t),Gu(this.options,t,"keyboard"),t.tooltip&&(je(this.options.tooltip,t.tooltip),t.tooltip.color&&(this.options.tooltip.color=Bu(t.tooltip.color)))),this.navigationHandler.setOptions(this.options)}},{key:"getPointer",value:function(t){return{x:t.x-(e=this.canvas.frame.canvas,e.getBoundingClientRect().left),y:t.y-Nu(this.canvas.frame.canvas)};var e}},{key:"onTouch",value:function(t){(new Date).valueOf()-this.touchTime>50&&(this.drag.pointer=this.getPointer(t.center),this.drag.pinched=!1,this.pinch.scale=this.body.view.scale,this.touchTime=(new Date).valueOf())}},{key:"onTap",value:function(t){var e=this.getPointer(t.center);this.checkSelectionChanges(e,this.selectionHandler.options.multiselect&&(t.changedPointers[0].ctrlKey||t.changedPointers[0].metaKey)),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e)}},{key:"onDoubleTap",value:function(t){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("doubleClick",t,e)}},{key:"onHold",value:function(t){var e=this.getPointer(t.center);this.checkSelectionChanges(e,this.selectionHandler.options.multiselect),this.selectionHandler.commitAndEmit(e,t),this.selectionHandler.generateClickEvent("click",t,e),this.selectionHandler.generateClickEvent("hold",t,e)}},{key:"onRelease",value:function(t){if((new Date).valueOf()-this.touchTime>10){var e=this.getPointer(t.center);this.selectionHandler.generateClickEvent("release",t,e),this.touchTime=(new Date).valueOf()}}},{key:"onContext",value:function(t){var e=this.getPointer({x:t.clientX,y:t.clientY});this.selectionHandler.generateClickEvent("oncontext",t,e)}},{key:"checkSelectionChanges",value:function(t){!0===(arguments.length>1&&void 0!==arguments[1]&&arguments[1])?this.selectionHandler.selectAdditionalOnPoint(t):this.selectionHandler.selectOnPoint(t)}},{key:"_determineDifference",value:function(t,e){var i=function(t,e){for(var i=[],n=0;n<t.length;n++){var o=t[n];-1===eh(e).call(e,o)&&i.push(o)}return i};return{nodes:i(t.nodes,e.nodes),edges:i(t.edges,e.edges)}}},{key:"onDragStart",value:function(t){if(!this.drag.dragging){void 0===this.drag.pointer&&this.onTouch(t);var e=this.selectionHandler.getNodeAt(this.drag.pointer);if(this.drag.dragging=!0,this.drag.selection=[],this.drag.translation=je({},this.body.view.translation),this.drag.nodeId=void 0,t.srcEvent.shiftKey){this.body.selectionBox.show=!0;var i=this.getPointer(t.center);this.body.selectionBox.position.start={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)}}if(void 0!==e&&!0===this.options.dragNodes){this.drag.nodeId=e.id,!1===e.isSelected()&&(this.selectionHandler.unselectAll(),this.selectionHandler.selectObject(e)),this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer);var n,o=function(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Iv(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Iv(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(this.selectionHandler.getSelectedNodes());try{for(o.s();!(n=o.n()).done;){var r=n.value,s={id:r.id,node:r,x:r.x,y:r.y,xFixed:r.options.fixed.x,yFixed:r.options.fixed.y};r.options.fixed.x=!0,r.options.fixed.y=!0,this.drag.selection.push(s)}}catch(t){o.e(t)}finally{o.f()}}else this.selectionHandler.generateClickEvent("dragStart",t,this.drag.pointer,void 0,!0)}}},{key:"onDrag",value:function(t){var e=this;if(!0!==this.drag.pinched){this.body.emitter.emit("unlockNode");var i=this.getPointer(t.center),n=this.drag.selection;if(n&&n.length&&!0===this.options.dragNodes){this.selectionHandler.generateClickEvent("dragging",t,i);var o=i.x-this.drag.pointer.x,r=i.y-this.drag.pointer.y;Nl(n).call(n,function(t){var i=t.node;!1===t.xFixed&&(i.x=e.canvas._XconvertDOMtoCanvas(e.canvas._XconvertCanvasToDOM(t.x)+o)),!1===t.yFixed&&(i.y=e.canvas._YconvertDOMtoCanvas(e.canvas._YconvertCanvasToDOM(t.y)+r))}),this.body.emitter.emit("startSimulation")}else{if(t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);this.body.selectionBox.position.end={x:this.canvas._XconvertDOMtoCanvas(i.x),y:this.canvas._YconvertDOMtoCanvas(i.y)},this.body.emitter.emit("_requestRedraw")}if(!0===this.options.dragView&&!t.srcEvent.shiftKey){if(this.selectionHandler.generateClickEvent("dragging",t,i,void 0,!0),void 0===this.drag.pointer)return void this.onDragStart(t);this.body.view.translation={x:this.drag.translation.x+(i.x-this.drag.pointer.x),y:this.drag.translation.y+(i.y-this.drag.pointer.y)},this.body.emitter.emit("_requestRedraw")}}}}},{key:"onDragEnd",value:function(t){var e=this;if(this.drag.dragging=!1,this.body.selectionBox.show){var i;this.body.selectionBox.show=!1;var n=this.body.selectionBox.position,o={minX:Math.min(n.start.x,n.end.x),minY:Math.min(n.start.y,n.end.y),maxX:Math.max(n.start.x,n.end.x),maxY:Math.max(n.start.y,n.end.y)},r=Ec(i=this.body.nodeIndices).call(i,function(t){var i=e.body.nodes[t];return i.x>=o.minX&&i.x<=o.maxX&&i.y>=o.minY&&i.y<=o.maxY});Nl(r).call(r,function(t){return e.selectionHandler.selectObject(e.body.nodes[t])});var s=this.getPointer(t.center);this.selectionHandler.commitAndEmit(s,t),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw")}else{var a=this.drag.selection;a&&a.length?(Nl(a).call(a,function(t){t.node.options.fixed.x=t.xFixed,t.node.options.fixed.y=t.yFixed}),this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center)),this.body.emitter.emit("startSimulation")):(this.selectionHandler.generateClickEvent("dragEnd",t,this.getPointer(t.center),void 0,!0),this.body.emitter.emit("_requestRedraw"))}}},{key:"onPinch",value:function(t){var e=this.getPointer(t.center);this.drag.pinched=!0,void 0===this.pinch.scale&&(this.pinch.scale=1),this.zoom(this.pinch.scale*t.scale,e)}},{key:"zoom",value:function(t,e){if(!0===this.options.zoomView){var i=this.body.view.scale;t<1e-5&&(t=1e-5),t>10&&(t=10);var n=void 0;void 0!==this.drag&&!0===this.drag.dragging&&(n=this.canvas.DOMtoCanvas(this.drag.pointer));var o=this.body.view.translation,r=t/i,s=(1-r)*e.x+o.x*r,a=(1-r)*e.y+o.y*r;if(this.body.view.scale=t,this.body.view.translation={x:s,y:a},null!=n){var l=this.canvas.canvasToDOM(n);this.drag.pointer.x=l.x,this.drag.pointer.y=l.y}this.body.emitter.emit("_requestRedraw"),this.body.emitter.emit("zoom",i<t?{direction:"+",scale:this.body.view.scale,pointer:e}:{direction:"-",scale:this.body.view.scale,pointer:e})}}},{key:"onMouseWheel",value:function(t){if(!0===this.options.zoomView){if(0!==t.deltaY){var e=this.body.view.scale;e*=1+.1*this.options.zoomSpeed*(t.deltaY<0?1:-1);var i=this.getPointer({x:t.clientX,y:t.clientY});this.zoom(e,i)}t.preventDefault()}}},{key:"onMouseMove",value:function(t){var e=this,i=this.getPointer({x:t.clientX,y:t.clientY}),n=!1;void 0!==this.popup&&(!1===this.popup.hidden&&this._checkHidePopup(i),!1===this.popup.hidden&&(n=!0,this.popup.setPosition(i.x+3,i.y-5),this.popup.show())),this.options.keyboard.autoFocus&&!1===this.options.keyboard.bindToWindow&&!0===this.options.keyboard.enabled&&this.canvas.frame.focus(),!1===n&&(void 0!==this.popupTimer&&(clearInterval(this.popupTimer),this.popupTimer=void 0),this.drag.dragging||(this.popupTimer=kh(function(){return e._checkShowPopup(i)},this.options.tooltipDelay))),!0===this.options.hover&&this.selectionHandler.hoverObject(t,i)}},{key:"_checkShowPopup",value:function(t){var e=this.canvas._XconvertDOMtoCanvas(t.x),i=this.canvas._YconvertDOMtoCanvas(t.y),n={left:e,top:i,right:e,bottom:i},o=void 0===this.popupObj?void 0:this.popupObj.id,r=!1,s="node";if(void 0===this.popupObj){for(var a,l=this.body.nodeIndices,c=this.body.nodes,h=[],d=0;d<l.length;d++)!0===(a=c[l[d]]).isOverlappingWith(n)&&(r=!0,void 0!==a.getTitle()&&h.push(l[d]));h.length>0&&(this.popupObj=c[h[h.length-1]],r=!0)}if(void 0===this.popupObj&&!1===r){for(var u,f=this.body.edgeIndices,p=this.body.edges,g=[],m=0;m<f.length;m++)!0===(u=p[f[m]]).isOverlappingWith(n)&&!0===u.connected&&void 0!==u.getTitle()&&g.push(f[m]);g.length>0&&(this.popupObj=p[g[g.length-1]],s="edge")}void 0!==this.popupObj?this.popupObj.id!==o&&(void 0===this.popup&&(this.popup=new sf(this.canvas.frame)),this.popup.popupTargetType=s,this.popup.popupTargetId=this.popupObj.id,this.popup.setPosition(t.x+3,t.y-5),this.popup.setText(this.popupObj.getTitle()),this.popup.show(),this.body.emitter.emit("showPopup",this.popupObj.id)):void 0!==this.popup&&(this.popup.hide(),this.body.emitter.emit("hidePopup"))}},{key:"_checkHidePopup",value:function(t){var e=this.selectionHandler._pointerToPositionObject(t),i=!1;if("node"===this.popup.popupTargetType){if(void 0!==this.body.nodes[this.popup.popupTargetId]&&!0===(i=this.body.nodes[this.popup.popupTargetId].isOverlappingWith(e))){var n=this.selectionHandler.getNodeAt(t);i=void 0!==n&&n.id===this.popup.popupTargetId}}else void 0===this.selectionHandler.getNodeAt(t)&&void 0!==this.body.edges[this.popup.popupTargetId]&&(i=this.body.edges[this.popup.popupTargetId].isOverlappingWith(e));!1===i&&(this.popupObj=void 0,this.popup.hide(),this.body.emitter.emit("hidePopup"))}}]),t}();Op("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},Gp);var Mv=E.Set,Dv=Pp,Nv=qf.exports.getWeakData,Rv=Ht,zv=C,Fv=pp,Lv=fp,Bv=Q,jv=Fi.set,Vv=Fi.getterFor,Hv=Ir.find,Wv=Ir.findIndex,qv=0,Uv=function(t){return t.frozen||(t.frozen=new Yv)},Yv=function(){this.entries=[]},Gv=function(t,e){return Hv(t.entries,function(t){return t[0]===e})};Yv.prototype={get:function(t){var e=Gv(this,t);if(e)return e[1]},has:function(t){return!!Gv(this,t)},set:function(t,e){var i=Gv(this,t);i?i[1]=e:this.entries.push([t,e])},delete:function(t){var e=Wv(this.entries,function(e){return e[0]===t});return~e&&this.entries.splice(e,1),!!~e}};var Zv,$v=Pp,Xv=qf.exports,Kv={getConstructor:function(t,e,i,n){var o=t(function(t,r){Fv(t,o,e),jv(t,{type:e,id:qv++,frozen:void 0}),null!=r&&Lv(r,t[n],{that:t,AS_ENTRIES:i})}),r=Vv(e),s=function(t,e,i){var n=r(t),o=Nv(Rv(e),!0);return!0===o?Uv(n).set(e,i):o[n.id]=i,t};return Dv(o.prototype,{delete:function(t){var e=r(this);if(!zv(t))return!1;var i=Nv(t);return!0===i?Uv(e).delete(t):i&&Bv(i,e.id)&&delete i[e.id]},has:function(t){var e=r(this);if(!zv(t))return!1;var i=Nv(t);return!0===i?Uv(e).has(t):i&&Bv(i,e.id)}}),Dv(o.prototype,i?{get:function(t){var e=r(this);if(zv(t)){var i=Nv(t);return!0===i?Uv(e).get(t):i?i[e.id]:void 0}},set:function(t,e){return s(this,t,e)}}:{add:function(t){return s(this,t,!0)}}),o}},Qv=C,Jv=Fi.enforce,ty=bi,ey=!o.ActiveXObject&&"ActiveXObject"in o,iy=Object.isExtensible,ny=function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},oy=Op("WeakMap",ny,Kv);if(ty&&ey){Zv=Kv.getConstructor(ny,"WeakMap",!0),Xv.enable();var ry=oy.prototype,sy=ry.delete,ay=ry.has,ly=ry.get,cy=ry.set;$v(ry,{delete:function(t){if(Qv(t)&&!iy(t)){var e=Jv(this);return e.frozen||(e.frozen=new Zv),sy.call(this,t)||e.frozen.delete(t)}return sy.call(this,t)},has:function(t){if(Qv(t)&&!iy(t)){var e=Jv(this);return e.frozen||(e.frozen=new Zv),ay.call(this,t)||e.frozen.has(t)}return ay.call(this,t)},get:function(t){if(Qv(t)&&!iy(t)){var e=Jv(this);return e.frozen||(e.frozen=new Zv),ay.call(this,t)?ly.call(this,t):e.frozen.get(t)}return ly.call(this,t)},set:function(t,e){if(Qv(t)&&!iy(t)){var i=Jv(this);i.frozen||(i.frozen=new Zv),ay.call(this,t)?cy.call(this,t,e):i.frozen.set(t,e)}else cy.call(this,t,e);return this}})}var hy,dy,uy,fy,py,gy=E.WeakMap;function my(t,e,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(t):n?n.value:e.get(t)}function vy(t,e,i,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(t,i):o?o.value=i:e.set(t,i),i}function yy(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return by(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?by(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function by(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function wy(t,e){var i,n=new Mv,o=yy(e);try{for(o.s();!(i=o.n()).done;){var r=i.value;t.has(r)||n.add(r)}}catch(t){o.e(t)}finally{o.f()}return n}var ky=function(){function t(){pa(this,t),hy.set(this,new Mv),dy.set(this,new Mv)}return va(t,[{key:"size",get:function(){return my(this,dy,"f").size}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0,o=e;n<o.length;n++){var r=o[n];my(this,dy,"f").add(r)}}},{key:"delete",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];for(var n=0,o=e;n<o.length;n++){var r=o[n];my(this,dy,"f").delete(r)}}},{key:"clear",value:function(){my(this,dy,"f").clear()}},{key:"getSelection",value:function(){return dl(my(this,dy,"f"))}},{key:"getChanges",value:function(){return{added:dl(wy(my(this,hy,"f"),my(this,dy,"f"))),deleted:dl(wy(my(this,dy,"f"),my(this,hy,"f"))),previous:dl(new Mv(my(this,hy,"f"))),current:dl(new Mv(my(this,dy,"f")))}}},{key:"commit",value:function(){var t=this.getChanges();vy(this,hy,my(this,dy,"f"),"f"),vy(this,dy,new Mv(my(this,hy,"f")),"f");var e,i=yy(t.added);try{for(i.s();!(e=i.n()).done;)e.value.select()}catch(t){i.e(t)}finally{i.f()}var n,o=yy(t.deleted);try{for(o.s();!(n=o.n()).done;)n.value.unselect()}catch(t){o.e(t)}finally{o.f()}return t}}]),t}();hy=new gy,dy=new gy;var _y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};pa(this,t),uy.set(this,new ky),fy.set(this,new ky),py.set(this,void 0),vy(this,py,e,"f")}return va(t,[{key:"sizeNodes",get:function(){return my(this,uy,"f").size}},{key:"sizeEdges",get:function(){return my(this,fy,"f").size}},{key:"getNodes",value:function(){return my(this,uy,"f").getSelection()}},{key:"getEdges",value:function(){return my(this,fy,"f").getSelection()}},{key:"addNodes",value:function(){var t;(t=my(this,uy,"f")).add.apply(t,arguments)}},{key:"addEdges",value:function(){var t;(t=my(this,fy,"f")).add.apply(t,arguments)}},{key:"deleteNodes",value:function(t){my(this,uy,"f").delete(t)}},{key:"deleteEdges",value:function(t){my(this,fy,"f").delete(t)}},{key:"clear",value:function(){my(this,uy,"f").clear(),my(this,fy,"f").clear()}},{key:"commit",value:function(){for(var t,e,i={nodes:my(this,uy,"f").commit(),edges:my(this,fy,"f").commit()},n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=my(this,py,"f")).call.apply(t,gl(e=[this,i]).call(e,o)),i}}]),t}();function xy(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Cy(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cy(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Cy(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}uy=new gy,fy=new gy,py=new gy;var Ey=function(){function t(e,i){var n=this;pa(this,t),this.body=e,this.canvas=i,this._selectionAccumulator=new _y,this.hoverObj={nodes:{},edges:{}},this.options={},this.defaultOptions={multiselect:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0},je(this.options,this.defaultOptions),this.body.emitter.on("_dataChanged",function(){n.updateSelection()})}return va(t,[{key:"setOptions",value:function(t){void 0!==t&&Ou(["multiselect","hoverConnectedEdges","selectable","selectConnectedEdges"],this.options,t)}},{key:"selectOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);this.unselectAll(),void 0!==i&&(e=this.selectObject(i)),this.body.emitter.emit("_requestRedraw")}return e}},{key:"selectAdditionalOnPoint",value:function(t){var e=!1;if(!0===this.options.selectable){var i=this.getNodeAt(t)||this.getEdgeAt(t);void 0!==i&&(e=!0,!0===i.isSelected()?this.deselectObject(i):this.selectObject(i),this.body.emitter.emit("_requestRedraw"))}return e}},{key:"_initBaseEvent",value:function(t,e){var i={};return i.pointer={DOM:{x:e.x,y:e.y},canvas:this.canvas.DOMtoCanvas(e)},i.event=t,i}},{key:"generateClickEvent",value:function(t,e,i,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=this._initBaseEvent(e,i);if(!0===o)r.nodes=[],r.edges=[];else{var s=this.getSelection();r.nodes=s.nodes,r.edges=s.edges}void 0!==n&&(r.previousSelection=n),"click"==t&&(r.items=this.getClickedItems(i)),void 0!==e.controlEdge&&(r.controlEdge=e.controlEdge),this.body.emitter.emit(t,r)}},{key:"selectObject",value:function(t){var e;return void 0!==t&&(t instanceof um?(!0===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.selectConnectedEdges)&&(e=this._selectionAccumulator).addEdges.apply(e,dl(t.edges)),this._selectionAccumulator.addNodes(t)):this._selectionAccumulator.addEdges(t),!0)}},{key:"deselectObject",value:function(t){!0===t.isSelected()&&(t.selected=!1,this._removeFromSelection(t))}},{key:"_getAllNodesOverlappingWith",value:function(t){for(var e=[],i=this.body.nodes,n=0;n<this.body.nodeIndices.length;n++){var o=this.body.nodeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}return e}},{key:"_pointerToPositionObject",value:function(t){var e=this.canvas.DOMtoCanvas(t);return{left:e.x-1,top:e.y+1,right:e.x+1,bottom:e.y-1}}},{key:"getNodeAt",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._pointerToPositionObject(t),n=this._getAllNodesOverlappingWith(i);return n.length>0?!0===e?this.body.nodes[n[n.length-1]]:n[n.length-1]:void 0}},{key:"_getEdgesOverlappingWith",value:function(t,e){for(var i=this.body.edges,n=0;n<this.body.edgeIndices.length;n++){var o=this.body.edgeIndices[n];i[o].isOverlappingWith(t)&&e.push(o)}}},{key:"_getAllEdgesOverlappingWith",value:function(t){var e=[];return this._getEdgesOverlappingWith(t,e),e}},{key:"getEdgeAt",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.canvas.DOMtoCanvas(t),n=10,o=null,r=this.body.edges,s=0;s<this.body.edgeIndices.length;s++){var a=this.body.edgeIndices[s],l=r[a];if(l.connected){var c=l.edgeType.getDistanceToEdge(l.from.x,l.from.y,l.to.x,l.to.y,i.x,i.y);c<n&&(o=a,n=c)}}return null!==o?!0===e?this.body.edges[o]:o:void 0}},{key:"_addToHover",value:function(t){t instanceof um?this.hoverObj.nodes[t.id]=t:this.hoverObj.edges[t.id]=t}},{key:"_removeFromSelection",value:function(t){var e;t instanceof um?(this._selectionAccumulator.deleteNodes(t),(e=this._selectionAccumulator).deleteEdges.apply(e,dl(t.edges))):this._selectionAccumulator.deleteEdges(t)}},{key:"unselectAll",value:function(){this._selectionAccumulator.clear()}},{key:"getSelectedNodeCount",value:function(){return this._selectionAccumulator.sizeNodes}},{key:"getSelectedEdgeCount",value:function(){return this._selectionAccumulator.sizeEdges}},{key:"_hoverConnectedEdges",value:function(t){for(var e=0;e<t.edges.length;e++){var i=t.edges[e];i.hover=!0,this._addToHover(i)}}},{key:"emitBlurEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e);!0===i.hover&&(i.hover=!1,i instanceof um?(n.node=i.id,this.body.emitter.emit("blurNode",n)):(n.edge=i.id,this.body.emitter.emit("blurEdge",n)))}},{key:"emitHoverEvent",value:function(t,e,i){var n=this._initBaseEvent(t,e),o=!1;return!1===i.hover&&(i.hover=!0,this._addToHover(i),o=!0,i instanceof um?(n.node=i.id,this.body.emitter.emit("hoverNode",n)):(n.edge=i.id,this.body.emitter.emit("hoverEdge",n))),o}},{key:"hoverObject",value:function(t,e){var i=this.getNodeAt(e);void 0===i&&(i=this.getEdgeAt(e));var n=!1;for(var o in this.hoverObj.nodes)Object.prototype.hasOwnProperty.call(this.hoverObj.nodes,o)&&(void 0===i||i instanceof um&&i.id!=o||i instanceof Jm)&&(this.emitBlurEvent(t,e,this.hoverObj.nodes[o]),delete this.hoverObj.nodes[o],n=!0);for(var r in this.hoverObj.edges)Object.prototype.hasOwnProperty.call(this.hoverObj.edges,r)&&(!0===n?(this.hoverObj.edges[r].hover=!1,delete this.hoverObj.edges[r]):(void 0===i||i instanceof Jm&&i.id!=r||i instanceof um&&!i.hover)&&(this.emitBlurEvent(t,e,this.hoverObj.edges[r]),delete this.hoverObj.edges[r],n=!0));if(void 0!==i){var s=Cl(this.hoverObj.edges).length,a=Cl(this.hoverObj.nodes).length;(n||i instanceof Jm&&0===s&&0===a||i instanceof um&&0===s&&0===a)&&(n=this.emitHoverEvent(t,e,i)),i instanceof um&&!0===this.options.hoverConnectedEdges&&this._hoverConnectedEdges(i)}!0===n&&this.body.emitter.emit("_requestRedraw")}},{key:"commitWithoutEmitting",value:function(){this._selectionAccumulator.commit()}},{key:"commitAndEmit",value:function(t,e){var i=!1,n=this._selectionAccumulator.commit(),o={nodes:n.nodes.previous,edges:n.edges.previous};n.edges.deleted.length>0&&(this.generateClickEvent("deselectEdge",e,t,o),i=!0),n.nodes.deleted.length>0&&(this.generateClickEvent("deselectNode",e,t,o),i=!0),n.nodes.added.length>0&&(this.generateClickEvent("selectNode",e,t),i=!0),n.edges.added.length>0&&(this.generateClickEvent("selectEdge",e,t),i=!0),!0===i&&this.generateClickEvent("select",e,t)}},{key:"getSelection",value:function(){return{nodes:this.getSelectedNodeIds(),edges:this.getSelectedEdgeIds()}}},{key:"getSelectedNodes",value:function(){return this._selectionAccumulator.getNodes()}},{key:"getSelectedEdges",value:function(){return this._selectionAccumulator.getEdges()}},{key:"getSelectedNodeIds",value:function(){var t;return kl(t=this._selectionAccumulator.getNodes()).call(t,function(t){return t.id})}},{key:"getSelectedEdgeIds",value:function(){var t;return kl(t=this._selectionAccumulator.getEdges()).call(t,function(t){return t.id})}},{key:"setSelection",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||!t.nodes&&!t.edges)throw new TypeError("Selection must be an object with nodes and/or edges properties");if((e.unselectAll||void 0===e.unselectAll)&&this.unselectAll(),t.nodes){var i,n=xy(t.nodes);try{for(n.s();!(i=n.n()).done;){var o=i.value,r=this.body.nodes[o];if(!r)throw new RangeError('Node with id "'+o+'" not found');this.selectObject(r,e.highlightEdges)}}catch(t){n.e(t)}finally{n.f()}}if(t.edges){var s,a=xy(t.edges);try{for(a.s();!(s=a.n()).done;){var l=s.value,c=this.body.edges[l];if(!c)throw new RangeError('Edge with id "'+l+'" not found');this.selectObject(c)}}catch(t){a.e(t)}finally{a.f()}}this.body.emitter.emit("_requestRedraw"),this._selectionAccumulator.commit()}},{key:"selectNodes",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({nodes:t},{highlightEdges:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]})}},{key:"selectEdges",value:function(t){if(!t||void 0===t.length)throw"Selection must be an array with ids";this.setSelection({edges:t})}},{key:"updateSelection",value:function(){for(var t in this._selectionAccumulator.getNodes())Object.prototype.hasOwnProperty.call(this.body.nodes,t.id)||this._selectionAccumulator.deleteNodes(t);for(var e in this._selectionAccumulator.getEdges())Object.prototype.hasOwnProperty.call(this.body.edges,e.id)||this._selectionAccumulator.deleteEdges(e)}},{key:"getClickedItems",value:function(t){for(var e=this.canvas.DOMtoCanvas(t),i=[],n=this.body.nodeIndices,o=this.body.nodes,r=n.length-1;r>=0;r--){var s=o[n[r]].getItemsOnPoint(e);i.push.apply(i,s)}for(var a=this.body.edgeIndices,l=this.body.edges,c=a.length-1;c>=0;c--){var h=l[a[c]].getItemsOnPoint(e);i.push.apply(i,h)}return i}}]),t}(),Ty=Math.floor,Sy=function(t,e){var i=t.length,n=Ty(i/2);return i<8?Ay(t,e):Oy(Sy(t.slice(0,n),e),Sy(t.slice(n),e),e)},Ay=function(t,e){for(var i,n,o=t.length,r=1;r<o;){for(n=r,i=t[r];n&&e(t[n-1],i)>0;)t[n]=t[--n];n!==r++&&(t[n]=i)}return t},Oy=function(t,e,i){for(var n=t.length,o=e.length,r=0,s=0,a=[];r<n||s<o;)a.push(r<n&&s<o?i(t[r],e[s])<=0?t[r++]:e[s++]:r<n?t[r++]:e[s++]);return a},Iy=Sy,Py=I.match(/firefox\/(\d+)/i),My=!!Py&&+Py[1],Dy=/MSIE|Trident/.test(I),Ny=I.match(/AppleWebKit\/(\d+)\./),Ry=oe,zy=Ft,Fy=$,Ly=he,By=ai,jy=s,Vy=Iy,Hy=Sl,Wy=My,qy=Dy,Uy=z,Yy=!!Ny&&+Ny[1],Gy=[],Zy=Gy.sort,$y=jy(function(){Gy.sort(void 0)}),Xy=jy(function(){Gy.sort(null)}),Ky=Hy("sort"),Qy=!jy(function(){if(Uy)return Uy<70;if(!(Wy&&Wy>3)){if(qy)return!0;if(Yy)return Yy<603;var t,e,i,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)Gy.push({k:e+n,v:i})}for(Gy.sort(function(t,e){return e.v-t.v}),n=0;n<Gy.length;n++)e=Gy[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});Ry({target:"Array",proto:!0,forced:$y||!Xy||!Ky||!Qy},{sort:function(t){void 0!==t&&zy(t);var e=Fy(this);if(Qy)return void 0===t?Zy.call(e):Zy.call(e,t);var i,n,o=[],r=Ly(e.length);for(n=0;n<r;n++)n in e&&o.push(e[n]);for(i=(o=Vy(o,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:By(e)>By(i)?1:-1}}(t))).length,n=0;n<i;)e[n]=o[n++];for(;n<r;)delete e[n++];return e}});var Jy=Ze("Array").sort,tb=Array.prototype,eb=function(t){var e=t.sort;return t===tb||t instanceof Array&&e===tb.sort?Jy:e},ib=Ft,nb=$,ob=b,rb=he,sb=function(t){return function(e,i,n,o){ib(i);var r=nb(e),s=ob(r),a=rb(r.length),l=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=c;break}if(l+=c,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=c)l in s&&(o=i(o,s[l],l,r));return o}},ab={left:sb(!1),right:sb(!0)},lb="process"==m(o.process),cb=ab.left,hb=z,db=lb;oe({target:"Array",proto:!0,forced:!Sl("reduce")||!db&&hb>79&&hb<83},{reduce:function(t){return cb(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ub=Ze("Array").reduce,fb=Array.prototype,pb=function(t){var e=t.reduce;return t===fb||t instanceof Array&&e===fb.reduce?ub:e},gb={};!function(t){!function(t){t.__esModule=!0,t.sort=function(t,e,i,s){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");e?"function"!=typeof e&&(s=i,i=e,e=n):e=n,i||(i=0),s||(s=t.length);var a=s-i;if(!(a<2)){var c=0;if(a<32)r(t,i,s,i+(c=o(t,i,s,e)),e);else{var h=new l(t,e),d=function(t){for(var e=0;t>=32;)e|=1&t,t>>=1;return t+e}(a);do{if((c=o(t,i,s,e))<d){var u=a;u>d&&(u=d),r(t,i,i+u,i+c,e),c=u}h.pushRun(i,c),h.mergeRuns(),a-=c,i+=c}while(0!==a);h.forceMergeRuns()}}};var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function i(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function n(t,n){if(t===n)return 0;if(~~t===t&&~~n===n){if(0===t||0===n)return t<n?-1:1;if(t<0||n<0){if(n>=0)return-1;if(t>=0)return 1;t=-t,n=-n}var o=i(t),r=i(n),s=0;return o<r?(t*=e[r-o-1],n/=10,s=-1):o>r&&(n*=e[o-r-1],t/=10,s=1),t===n?s:t<n?-1:1}var a=String(t),l=String(n);return a===l?0:a<l?-1:1}function o(t,e,i,n){var o=e+1;if(o===i)return 1;if(n(t[o++],t[e])<0){for(;o<i&&n(t[o],t[o-1])<0;)o++;!function(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}(t,e,o)}else for(;o<i&&n(t[o],t[o-1])>=0;)o++;return o-e}function r(t,e,i,n,o){for(n===e&&n++;n<i;n++){for(var r=t[n],s=e,a=n;s<a;){var l=s+a>>>1;o(r,t[l])<0?a=l:s=l+1}var c=n-s;switch(c){case 3:t[s+3]=t[s+2];case 2:t[s+2]=t[s+1];case 1:t[s+1]=t[s];break;default:for(;c>0;)t[s+c]=t[s+c-1],c--}t[s]=r}}function s(t,e,i,n,o,r){var s=0,a=0,l=1;if(r(t,e[i+o])>0){for(a=n-o;l<a&&r(t,e[i+o+l])>0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=o,l+=o}else{for(a=o+1;l<a&&r(t,e[i+o-l])<=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var c=s;s=o-l,l=o-c}for(s++;s<l;){var h=s+(l-s>>>1);r(t,e[i+h])>0?s=h+1:l=h}return l}function a(t,e,i,n,o,r){var s=0,a=0,l=1;if(r(t,e[i+o])<0){for(a=o+1;l<a&&r(t,e[i+o-l])<0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a);var c=s;s=o-l,l=o-c}else{for(a=n-o;l<a&&r(t,e[i+o+l])>=0;)s=l,(l=1+(l<<1))<=0&&(l=a);l>a&&(l=a),s+=o,l+=o}for(s++;s<l;){var h=s+(l-s>>>1);r(t,e[i+h])<0?l=h:s=h+1}return l}var l=function(){function t(e,i){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.array=null,this.compare=null,this.minGallop=7,this.length=0,this.tmpStorageLength=256,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=e,this.compare=i,this.length=e.length,this.length<512&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return t.prototype.pushRun=function(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1},t.prototype.mergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}},t.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}},t.prototype.mergeAt=function(t){var e=this.compare,i=this.array,n=this.runStart[t],o=this.runLength[t],r=this.runStart[t+1],l=this.runLength[t+1];this.runLength[t]=o+l,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;var c=a(i[r],i,n,o,0,e);n+=c,0!=(o-=c)&&0!==(l=s(i[n+o-1],i,r,l,l-1,e))&&(o<=l?this.mergeLow(n,o,r,l):this.mergeHigh(n,o,r,l))},t.prototype.mergeLow=function(t,e,i,n){var o=this.compare,r=this.array,l=this.tmp,c=0;for(c=0;c<e;c++)l[c]=r[t+c];var h=0,d=i,u=t;if(r[u++]=r[d++],0!=--n)if(1!==e){for(var f=this.minGallop;;){var p=0,g=0,m=!1;do{if(o(r[d],l[h])<0){if(r[u++]=r[d++],g++,p=0,0==--n){m=!0;break}}else if(r[u++]=l[h++],p++,g=0,1==--e){m=!0;break}}while((p|g)<f);if(m)break;do{if(0!==(p=a(r[d],l,h,e,0,o))){for(c=0;c<p;c++)r[u+c]=l[h+c];if(u+=p,h+=p,(e-=p)<=1){m=!0;break}}if(r[u++]=r[d++],0==--n){m=!0;break}if(0!==(g=s(l[h],r,d,n,0,o))){for(c=0;c<g;c++)r[u+c]=r[d+c];if(u+=g,d+=g,0==(n-=g)){m=!0;break}}if(r[u++]=l[h++],1==--e){m=!0;break}f--}while(p>=7||g>=7);if(m)break;f<0&&(f=0),f+=2}if(this.minGallop=f,f<1&&(this.minGallop=1),1===e){for(c=0;c<n;c++)r[u+c]=r[d+c];r[u+n]=l[h]}else{if(0===e)throw new Error("mergeLow preconditions were not respected");for(c=0;c<e;c++)r[u+c]=l[h+c]}}else{for(c=0;c<n;c++)r[u+c]=r[d+c];r[u+n]=l[h]}else for(c=0;c<e;c++)r[u+c]=l[h+c]},t.prototype.mergeHigh=function(t,e,i,n){var o=this.compare,r=this.array,l=this.tmp,c=0;for(c=0;c<n;c++)l[c]=r[i+c];var h=t+e-1,d=n-1,u=i+n-1,f=0,p=0;if(r[u--]=r[h--],0!=--e)if(1!==n){for(var g=this.minGallop;;){var m=0,v=0,y=!1;do{if(o(l[d],r[h])<0){if(r[u--]=r[h--],m++,v=0,0==--e){y=!0;break}}else if(r[u--]=l[d--],v++,m=0,1==--n){y=!0;break}}while((m|v)<g);if(y)break;do{if(0!=(m=e-a(l[d],r,t,e,e-1,o))){for(e-=m,p=1+(u-=m),f=1+(h-=m),c=m-1;c>=0;c--)r[p+c]=r[f+c];if(0===e){y=!0;break}}if(r[u--]=l[d--],1==--n){y=!0;break}if(0!=(v=n-s(r[h],l,0,n,n-1,o))){for(n-=v,p=1+(u-=v),f=1+(d-=v),c=0;c<v;c++)r[p+c]=l[f+c];if(n<=1){y=!0;break}}if(r[u--]=r[h--],0==--e){y=!0;break}g--}while(m>=7||v>=7);if(y)break;g<0&&(g=0),g+=2}if(this.minGallop=g,g<1&&(this.minGallop=1),1===n){for(p=1+(u-=e),f=1+(h-=e),c=e-1;c>=0;c--)r[p+c]=r[f+c];r[u]=l[d]}else{if(0===n)throw new Error("mergeHigh preconditions were not respected");for(f=u-(n-1),c=0;c<n;c++)r[f+c]=l[c]}}else{for(p=1+(u-=e),f=1+(h-=e),c=e-1;c>=0;c--)r[p+c]=r[f+c];r[u]=l[d]}else for(f=u-(n-1),c=0;c<n;c++)r[f+c]=l[c]},t}()}(t)}(gb);var mb=gb;function vb(t){var e=function(){if("undefined"==typeof Reflect||!Rg)return!1;if(Rg.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rg(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=Hg(t);if(e){var o=Hg(this).constructor;i=Rg(n,arguments,o)}else i=n.apply(this,arguments);return jg(this,i)}}var yb=function(){function t(){pa(this,t)}return va(t,[{key:"abstract",value:function(){throw new Error("Can't instantiate abstract class!")}},{key:"fake_use",value:function(){}},{key:"curveType",value:function(){return this.abstract()}},{key:"getPosition",value:function(t){return this.fake_use(t),this.abstract()}},{key:"setPosition",value:function(t,e){this.fake_use(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0),this.abstract()}},{key:"getTreeSize",value:function(t){return this.fake_use(t),this.abstract()}},{key:"sort",value:function(t){this.fake_use(t),this.abstract()}},{key:"fix",value:function(t,e){this.fake_use(t,e),this.abstract()}},{key:"shift",value:function(t,e){this.fake_use(t,e),this.abstract()}}]),t}(),bb=function(t){Bg(i,t);var e=vb(i);function i(t){var n;return pa(this,i),(n=e.call(this)).layout=t,n}return va(i,[{key:"curveType",value:function(){return"horizontal"}},{key:"getPosition",value:function(t){return t.x}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.x=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_x,max:e.max_x}}},{key:"sort",value:function(t){mb.sort(t,function(t,e){return t.x-e.x})}},{key:"fix",value:function(t,e){t.y=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.y=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].x+=e}}]),i}(yb),wb=function(t){Bg(i,t);var e=vb(i);function i(t){var n;return pa(this,i),(n=e.call(this)).layout=t,n}return va(i,[{key:"curveType",value:function(){return"vertical"}},{key:"getPosition",value:function(t){return t.y}},{key:"setPosition",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;void 0!==i&&this.layout.hierarchical.addToOrdering(t,i),t.y=e}},{key:"getTreeSize",value:function(t){var e=this.layout.hierarchical.getTreeSize(this.layout.body.nodes,t);return{min:e.min_y,max:e.max_y}}},{key:"sort",value:function(t){mb.sort(t,function(t,e){return t.y-e.y})}},{key:"fix",value:function(t,e){t.x=this.layout.options.hierarchical.levelSeparation*e,t.options.fixed.x=!0}},{key:"shift",value:function(t,e){this.layout.body.nodes[t].y+=e}}]),i}(yb),kb=Ir.every;oe({target:"Array",proto:!0,forced:!Sl("every")},{every:function(t){return kb(this,t,arguments.length>1?arguments[1]:void 0)}});var _b=Ze("Array").every,xb=Array.prototype,Cb=function(t){var e=t.every;return t===xb||t instanceof Array&&e===xb.every?_b:e};function Eb(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Tb(t,e){var i=new Mv;return Nl(t).call(t,function(t){var e;Nl(e=t.edges).call(e,function(t){t.connected&&i.add(t)})}),Nl(i).call(i,function(t){var i=t.from.id,n=t.to.id;null==e[i]&&(e[i]=0),(null==e[n]||e[i]>=e[n])&&(e[n]=e[i]+1)}),e}function Sb(t,e,i,n){var o,r,s=ah(null),a=pb(o=dl(vg(n).call(n))).call(o,function(t,e){return t+1+e.edges.length},0),l=i+"Id",c="to"===i?1:-1,h=function(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Eb(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Eb(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(n);try{var d=function(){var o=ll(r.value,2),h=o[0],d=o[1];if(!n.has(h)||!t(d))return"continue";s[h]=0;for(var u=[d],f=0,p=void 0,g=function(){var t,o;if(!n.has(h))return"continue";var r=s[p.id]+c;if(Nl(t=Ec(o=p.edges).call(o,function(t){return t.connected&&t.to!==t.from&&t[i]!==p&&n.has(t.toId)&&n.has(t.fromId)})).call(t,function(t){var n=t[l],o=s[n];(null==o||e(r,o))&&(s[n]=r,u.push(t[i]))}),f>a)return{v:{v:Tb(n,s)}};++f};p=u.pop();){var m=g();if("continue"!==m&&"object"===hl(m))return m.v}};for(h.s();!(r=h.n()).done;){var u=d();if("continue"!==u&&"object"===hl(u))return u.v}}catch(t){h.e(t)}finally{h.f()}return s}var Ab=function(){function t(){pa(this,t),this.childrenReference={},this.parentReference={},this.trees={},this.distributionOrdering={},this.levels={},this.distributionIndex={},this.isTree=!1,this.treeIndex=-1}return va(t,[{key:"addRelation",value:function(t,e){void 0===this.childrenReference[t]&&(this.childrenReference[t]=[]),this.childrenReference[t].push(e),void 0===this.parentReference[e]&&(this.parentReference[e]=[]),this.parentReference[e].push(t)}},{key:"checkIfTree",value:function(){for(var t in this.parentReference)if(this.parentReference[t].length>1)return void(this.isTree=!1);this.isTree=!0}},{key:"numTrees",value:function(){return this.treeIndex+1}},{key:"setTreeIndex",value:function(t,e){void 0!==e&&void 0===this.trees[t.id]&&(this.trees[t.id]=e,this.treeIndex=Math.max(e,this.treeIndex))}},{key:"ensureLevel",value:function(t){void 0===this.levels[t]&&(this.levels[t]=0)}},{key:"getMaxLevel",value:function(t){var e=this,i={};return function t(n){if(void 0!==i[n])return i[n];var o=e.levels[n];if(e.childrenReference[n]){var r=e.childrenReference[n];if(r.length>0)for(var s=0;s<r.length;s++)o=Math.max(o,t(r[s]))}return i[n]=o,o}(t)}},{key:"levelDownstream",value:function(t,e){void 0===this.levels[e.id]&&(void 0===this.levels[t.id]&&(this.levels[t.id]=0),this.levels[e.id]=this.levels[t.id]+1)}},{key:"setMinLevelToZero",value:function(t){var e=1e9;for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&void 0!==this.levels[i]&&(e=Math.min(this.levels[i],e));for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==this.levels[n]&&(this.levels[n]-=e)}},{key:"getTreeSize",value:function(t,e){var i=1e9,n=-1e9,o=1e9,r=-1e9;for(var s in this.trees)if(Object.prototype.hasOwnProperty.call(this.trees,s)&&this.trees[s]===e){var a=t[s];i=Math.min(a.x,i),n=Math.max(a.x,n),o=Math.min(a.y,o),r=Math.max(a.y,r)}return{min_x:i,max_x:n,min_y:o,max_y:r}}},{key:"hasSameParent",value:function(t,e){var i=this.parentReference[t.id],n=this.parentReference[e.id];if(void 0===i||void 0===n)return!1;for(var o=0;o<i.length;o++)for(var r=0;r<n.length;r++)if(i[o]==n[r])return!0;return!1}},{key:"inSameSubNetwork",value:function(t,e){return this.trees[t.id]===this.trees[e.id]}},{key:"getLevels",value:function(){return Cl(this.distributionOrdering)}},{key:"addToOrdering",value:function(t,e){void 0===this.distributionOrdering[e]&&(this.distributionOrdering[e]=[]);var i=!1,n=this.distributionOrdering[e];for(var o in n)if(n[o]===t){i=!0;break}i||(this.distributionOrdering[e].push(t),this.distributionIndex[t.id]=this.distributionOrdering[e].length-1)}}]),t}(),Ob=function(){function t(e){pa(this,t),this.body=e,this._resetRNG(Math.random()+":"+El()),this.setPhysics=!1,this.options={},this.optionsBackup={physics:{}},this.defaultOptions={randomSeed:void 0,improvedLayout:!0,clusterThreshold:150,hierarchical:{enabled:!1,levelSeparation:150,nodeSpacing:100,treeSpacing:200,blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:"UD",sortMethod:"hubsize"}},je(this.options,this.defaultOptions),this.bindEventListeners()}return va(t,[{key:"bindEventListeners",value:function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_dataLoaded",function(){t.layoutNetwork()}),this.body.emitter.on("_resetHierarchicalLayout",function(){t.setupHierarchicalLayout()}),this.body.emitter.on("_adjustEdgesForHierarchicalLayout",function(){if(!0===t.options.hierarchical.enabled){var e=t.direction.curveType();t.body.emitter.emit("_forceDisableDynamicCurves",e,!1)}})}},{key:"setOptions",value:function(t,e){if(void 0!==t){var i=this.options.hierarchical,n=i.enabled;if(Ou(["randomSeed","improvedLayout","clusterThreshold"],this.options,t),Gu(this.options,t,"hierarchical"),void 0!==t.randomSeed&&this._resetRNG(t.randomSeed),!0===i.enabled)return!0===n&&this.body.emitter.emit("refresh",!0),"RL"===i.direction||"DU"===i.direction?i.levelSeparation>0&&(i.levelSeparation*=-1):i.levelSeparation<0&&(i.levelSeparation*=-1),this.setDirectionStrategy(),this.body.emitter.emit("_resetHierarchicalLayout"),this.adaptAllOptionsForHierarchicalLayout(e);if(!0===n)return this.body.emitter.emit("refresh"),Pu(e,this.optionsBackup)}return e}},{key:"_resetRNG",value:function(t){this.initialRandomSeed=t,this._rng=gu(this.initialRandomSeed)}},{key:"adaptAllOptionsForHierarchicalLayout",value:function(t){if(!0===this.options.hierarchical.enabled){var e=this.optionsBackup.physics;void 0===t.physics||!0===t.physics?(t.physics={enabled:void 0===e.enabled||e.enabled,solver:"hierarchicalRepulsion"},e.enabled=void 0===e.enabled||e.enabled,e.solver=e.solver||"barnesHut"):"object"===hl(t.physics)?(e.enabled=void 0===t.physics.enabled||t.physics.enabled,e.solver=t.physics.solver||"barnesHut",t.physics.solver="hierarchicalRepulsion"):!1!==t.physics&&(e.solver="barnesHut",t.physics={solver:"hierarchicalRepulsion"});var i=this.direction.curveType();if(void 0===t.edges)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges={smooth:!1};else if(void 0===t.edges.smooth)this.optionsBackup.edges={smooth:{enabled:!0,type:"dynamic"}},t.edges.smooth=!1;else if("boolean"==typeof t.edges.smooth)this.optionsBackup.edges={smooth:t.edges.smooth},t.edges.smooth={enabled:t.edges.smooth,type:i};else{var n=t.edges.smooth;void 0!==n.type&&"dynamic"!==n.type&&(i=n.type),this.optionsBackup.edges={smooth:{enabled:void 0===n.enabled||n.enabled,type:void 0===n.type?"dynamic":n.type,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}},t.edges.smooth={enabled:void 0===n.enabled||n.enabled,type:i,roundness:void 0===n.roundness?.5:n.roundness,forceDirection:void 0!==n.forceDirection&&n.forceDirection}}this.body.emitter.emit("_forceDisableDynamicCurves",i)}return t}},{key:"positionInitially",value:function(t){if(!0!==this.options.hierarchical.enabled){this._resetRNG(this.initialRandomSeed);for(var e=t.length+50,i=0;i<t.length;i++){var n=t[i],o=2*Math.PI*this._rng();void 0===n.x&&(n.x=e*Math.cos(o)),void 0===n.y&&(n.y=e*Math.sin(o))}}}},{key:"layoutNetwork",value:function(){if(!0!==this.options.hierarchical.enabled&&!0===this.options.improvedLayout){for(var t=this.body.nodeIndices,e=0,i=0;i<t.length;i++)!0===this.body.nodes[t[i]].predefinedPosition&&(e+=1);if(e<.5*t.length){var n=0,o=this.options.clusterThreshold,r={clusterNodeProperties:{shape:"ellipse",label:"",group:"",font:{multi:!1}},clusterEdgeProperties:{label:"",font:{multi:!1},smooth:{enabled:!1}}};if(t.length>o){for(var s=t.length;t.length>o&&n<=10;){var a=t.length;if((n+=1)%3==0?this.body.modules.clustering.clusterBridges(r):this.body.modules.clustering.clusterOutliers(r),a==t.length&&n%3!=0)return this._declusterAll(),this.body.emitter.emit("_layoutFailed"),void console.info("This network could not be positioned by this version of the improved layout algorithm. Please disable improvedLayout for better performance.")}this.body.modules.kamadaKawai.setOptions({springLength:Math.max(150,2*s)})}n>10&&console.info("The clustering didn't succeed within the amount of interations allowed, progressing with partial result."),this.body.modules.kamadaKawai.solve(t,this.body.edgeIndices,!0),this._shiftToCenter();for(var l=0;l<t.length;l++){var c=this.body.nodes[t[l]];!1===c.predefinedPosition&&(c.x+=70*(.5-this._rng()),c.y+=70*(.5-this._rng()))}this._declusterAll(),this.body.emitter.emit("_repositionBezierNodes")}}}},{key:"_shiftToCenter",value:function(){for(var t=vv.getRangeCore(this.body.nodes,this.body.nodeIndices),e=vv.findCenter(t),i=0;i<this.body.nodeIndices.length;i++){var n=this.body.nodes[this.body.nodeIndices[i]];n.x-=e.x,n.y-=e.y}}},{key:"_declusterAll",value:function(){for(var t=!0;!0===t;){t=!1;for(var e=0;e<this.body.nodeIndices.length;e++)!0===this.body.nodes[this.body.nodeIndices[e]].isCluster&&(t=!0,this.body.modules.clustering.openCluster(this.body.nodeIndices[e],{},!1));!0===t&&this.body.emitter.emit("_dataChanged")}}},{key:"getSeed",value:function(){return this.initialRandomSeed}},{key:"setupHierarchicalLayout",value:function(){if(!0===this.options.hierarchical.enabled&&this.body.nodeIndices.length>0){var t,e,i=!1,n=!1;for(e in this.lastNodeOnLevel={},this.hierarchical=new Ab,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,e)&&(void 0!==(t=this.body.nodes[e]).options.level?(i=!0,this.hierarchical.levels[e]=t.options.level):n=!0);if(!0===n&&!0===i)throw new Error("To use the hierarchical layout, nodes require either no predefined levels or levels have to be defined for all nodes.");if(!0===n){var o=this.options.hierarchical.sortMethod;"hubsize"===o?this._determineLevelsByHubsize():"directed"===o?this._determineLevelsDirected():"custom"===o&&this._determineLevelsCustomCallback()}for(var r in this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,r)&&this.hierarchical.ensureLevel(r);var s=this._getDistribution();this._generateMap(),this._placeNodesByHierarchy(s),this._condenseHierarchy(),this._shiftToCenter()}}},{key:"_condenseHierarchy",value:function(){var t=this,e=!1,i={},n=function(e,i){var n=t.hierarchical.trees;for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&n[o]===e&&t.direction.shift(o,i)},o=function e(i,n){if(!n[i.id]&&(n[i.id]=!0,t.hierarchical.childrenReference[i.id])){var o=t.hierarchical.childrenReference[i.id];if(o.length>0)for(var r=0;r<o.length;r++)e(t.body.nodes[o[r]],n)}},r=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e9,n=1e9,o=1e9,r=1e9,s=-1e9;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var l=t.body.nodes[a],c=t.hierarchical.levels[l.id],h=t.direction.getPosition(l),d=ll(t._getSpaceAroundNode(l,e),2),u=d[1];n=Math.min(d[0],n),o=Math.min(u,o),c<=i&&(r=Math.min(h,r),s=Math.max(h,s))}return[r,s,n,o]},s=function(e,i){var n=t.hierarchical.getMaxLevel(e.id),o=t.hierarchical.getMaxLevel(i.id);return Math.min(n,o)},a=function(e,i,n){for(var o=t.hierarchical,r=0;r<i.length;r++){var s=o.distributionOrdering[i[r]];if(s.length>1)for(var a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];o.hasSameParent(l,c)&&o.inSameSubNetwork(l,c)&&e(l,c,n)}}},l=function(i,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=t.direction.getPosition(i),c=t.direction.getPosition(n),h=Math.abs(c-l),d=t.options.hierarchical.nodeSpacing;if(h>d){var u={},f={};o(i,u),o(n,f);var p=s(i,n),g=r(u,p),m=r(f,p),v=g[1],y=m[0],b=m[2];if(Math.abs(v-y)>d){var w=v-y+d;w<-b+d&&(w=-b+d),w<0&&(t._shiftBlock(n.id,w),e=!0,!0===a&&t._centerParent(n))}}},c=function(n,s){for(var a=s.id,l=s.edges,c=t.hierarchical.levels[s.id],h=t.options.hierarchical.levelSeparation*t.options.hierarchical.levelSeparation,d={},u=[],f=0;f<l.length;f++){var p=l[f];if(p.toId!=p.fromId){var g=p.toId==a?p.from:p.to;d[l[f].id]=g,t.hierarchical.levels[g.id]<c&&u.push(p)}}var m=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==d[i[o].id]){var r=t.direction.getPosition(d[i[o].id])-e;n+=r/Math.sqrt(r*r+h)}return n},v=function(e,i){for(var n=0,o=0;o<i.length;o++)if(void 0!==d[i[o].id]){var r=t.direction.getPosition(d[i[o].id])-e;n-=h*Math.pow(r*r+h,-1.5)}return n},y=function(e,i){for(var n=t.direction.getPosition(s),o={},r=0;r<e;r++){var a=m(n,i),l=v(n,i);if(void 0!==o[n-=Math.max(-40,Math.min(40,Math.round(a/l)))])break;o[n]=r}return n},b=y(n,u);!function(n){var a=t.direction.getPosition(s);if(void 0===i[s.id]){var l={};o(s,l),i[s.id]=l}var c=r(i[s.id]),h=c[2],d=n-a,u=0;d>0?u=Math.min(d,c[3]-t.options.hierarchical.nodeSpacing):d<0&&(u=-Math.min(-d,h-t.options.hierarchical.nodeSpacing)),0!=u&&(t._shiftBlock(s.id,u),e=!0)}(b),function(i){var n=t.direction.getPosition(s),o=ll(t._getSpaceAroundNode(s),2),r=o[0],a=i-n,l=n;a>0?l=Math.min(n+(o[1]-t.options.hierarchical.nodeSpacing),i):a<0&&(l=Math.max(n-(r-t.options.hierarchical.nodeSpacing),i)),l!==n&&(t.direction.setPosition(s,l),e=!0)}(b=y(n,l))};!0===this.options.hierarchical.blockShifting&&(function(i){var n=t.hierarchical.getLevels();n=jl(n).call(n);for(var o=0;o<5&&(e=!1,a(l,n,!0),!0===e);o++);}(),function(){for(var e in t.body.nodes)Object.prototype.hasOwnProperty.call(t.body.nodes,e)&&t._centerParent(t.body.nodes[e])}()),!0===this.options.hierarchical.edgeMinimization&&function(i){var n=t.hierarchical.getLevels();n=jl(n).call(n);for(var o=0;o<20;o++){e=!1;for(var r=0;r<n.length;r++)for(var s=t.hierarchical.distributionOrdering[n[r]],a=0;a<s.length;a++)c(1e3,s[a]);if(!0!==e)break}}(),!0===this.options.hierarchical.parentCentralization&&function(){var e=t.hierarchical.getLevels();e=jl(e).call(e);for(var i=0;i<e.length;i++)for(var n=t.hierarchical.distributionOrdering[e[i]],o=0;o<n.length;o++)t._centerParent(n[o])}(),function(){for(var e=function(){for(var e=[],i=0;i<t.hierarchical.numTrees();i++)e.push(t.direction.getTreeSize(i));return e}(),i=0,o=0;o<e.length-1;o++)n(o+1,i+=e[o].max-e[o+1].min+t.options.hierarchical.treeSpacing)}()}},{key:"_getSpaceAroundNode",value:function(t,e){var i=!0;void 0===e&&(i=!1);var n=this.hierarchical.levels[t.id];if(void 0!==n){var o=this.hierarchical.distributionIndex[t.id],r=this.direction.getPosition(t),s=this.hierarchical.distributionOrdering[n],a=1e9,l=1e9;if(0!==o){var c=s[o-1];(!0===i&&void 0===e[c.id]||!1===i)&&(a=r-this.direction.getPosition(c))}if(o!=s.length-1){var h=s[o+1];if(!0===i&&void 0===e[h.id]||!1===i){var d=this.direction.getPosition(h);l=Math.min(l,d-r)}}return[a,l]}return[0,0]}},{key:"_centerParent",value:function(t){if(this.hierarchical.parentReference[t.id])for(var e=this.hierarchical.parentReference[t.id],i=0;i<e.length;i++){var n=e[i],o=this.body.nodes[n],r=this.hierarchical.childrenReference[n];if(void 0!==r){var s=this._getCenterPosition(r),a=this.direction.getPosition(o),l=ll(this._getSpaceAroundNode(o),2),c=l[0],h=l[1],d=a-s;(d<0&&Math.abs(d)<h-this.options.hierarchical.nodeSpacing||d>0&&Math.abs(d)<c-this.options.hierarchical.nodeSpacing)&&this.direction.setPosition(o,s)}}}},{key:"_placeNodesByHierarchy",value:function(t){for(var e in this.positionedNodes={},t)if(Object.prototype.hasOwnProperty.call(t,e)){var i,n=Cl(t[e]);n=this._indexArrayToNodes(n),eb(i=this.direction).call(i,n);for(var o=0,r=0;r<n.length;r++){var s=n[r];if(void 0===this.positionedNodes[s.id]){var a=this.options.hierarchical.nodeSpacing,l=a*o;o>0&&(l=this.direction.getPosition(n[r-1])+a),this.direction.setPosition(s,l,e),this._validatePositionAndContinue(s,e,l),o++}}}}},{key:"_placeBranchNodes",value:function(t,e){var i,n=this.hierarchical.childrenReference[t];if(void 0!==n){for(var o=[],r=0;r<n.length;r++)o.push(this.body.nodes[n[r]]);eb(i=this.direction).call(i,o);for(var s=0;s<o.length;s++){var a=o[s],l=this.hierarchical.levels[a.id];if(!(l>e&&void 0===this.positionedNodes[a.id]))return;var c,h=this.options.hierarchical.nodeSpacing;c=0===s?this.direction.getPosition(this.body.nodes[t]):this.direction.getPosition(o[s-1])+h,this.direction.setPosition(a,c,l),this._validatePositionAndContinue(a,l,c)}var d=this._getCenterPosition(o);this.direction.setPosition(this.body.nodes[t],d,e)}}},{key:"_validatePositionAndContinue",value:function(t,e,i){if(this.hierarchical.isTree){if(void 0!==this.lastNodeOnLevel[e]){var n=this.direction.getPosition(this.body.nodes[this.lastNodeOnLevel[e]]);if(i-n<this.options.hierarchical.nodeSpacing){var o=n+this.options.hierarchical.nodeSpacing-i,r=this._findCommonParent(this.lastNodeOnLevel[e],t.id);this._shiftBlock(r.withChild,o)}}this.lastNodeOnLevel[e]=t.id,this.positionedNodes[t.id]=!0,this._placeBranchNodes(t.id,e)}}},{key:"_indexArrayToNodes",value:function(t){for(var e=[],i=0;i<t.length;i++)e.push(this.body.nodes[t[i]]);return e}},{key:"_getDistribution",value:function(){var t,e,i={};for(t in this.body.nodes)if(Object.prototype.hasOwnProperty.call(this.body.nodes,t)){var n=void 0===this.hierarchical.levels[t]?0:this.hierarchical.levels[t];this.direction.fix(e=this.body.nodes[t],n),void 0===i[n]&&(i[n]={}),i[n][t]=e}return i}},{key:"_getActiveEdges",value:function(t){var e=this,i=[];return Ru(t.edges,function(t){var n;-1!==eh(n=e.body.edgeIndices).call(n,t.id)&&i.push(t)}),i}},{key:"_getHubSizes",value:function(){var t=this,e={};Ru(this.body.nodeIndices,function(i){var n=t._getActiveEdges(t.body.nodes[i]).length;e[n]=!0});var i=[];return Ru(e,function(t){i.push(Number(t))}),eb(mb).call(mb,i,function(t,e){return e-t}),i}},{key:"_determineLevelsByHubsize",value:function(){for(var t=this,e=function(e,i){t.hierarchical.levelDownstream(e,i)},i=this._getHubSizes(),n=function(n){var o=i[n];if(0===o)return"break";Ru(t.body.nodeIndices,function(i){o===t._getActiveEdges(t.body.nodes[i]).length&&t._crawlNetwork(e,i)})},o=0;o<i.length&&"break"!==n(o);++o);}},{key:"_determineLevelsCustomCallback",value:function(){var t=this;this._crawlNetwork(function(e,i,n){var o=t.hierarchical.levels[e.id];void 0===o&&(o=t.hierarchical.levels[e.id]=1e5);var r=(vv.cloneOptions(e,"node"),vv.cloneOptions(i,"node"),void vv.cloneOptions(n,"edge"));t.hierarchical.levels[i.id]=o+r}),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_determineLevelsDirected",value:function(){var t,e=this,i=pb(t=this.body.nodeIndices).call(t,function(t,i){return t.set(i,e.body.nodes[i]),t},new Zp);this.hierarchical.levels="roots"===this.options.hierarchical.shakeTowards?function(t){return Sb(function(e){var i,n;return Cb(i=Ec(n=e.edges).call(n,function(e){return t.has(e.toId)})).call(i,function(t){return t.from===e})},function(t,e){return e<t},"to",t)}(i):function(t){return Sb(function(e){var i,n;return Cb(i=Ec(n=e.edges).call(n,function(e){return t.has(e.toId)})).call(i,function(t){return t.to===e})},function(t,e){return e>t},"from",t)}(i),this.hierarchical.setMinLevelToZero(this.body.nodes)}},{key:"_generateMap",value:function(){var t=this;this._crawlNetwork(function(e,i){t.hierarchical.levels[i.id]>t.hierarchical.levels[e.id]&&t.hierarchical.addRelation(e.id,i.id)}),this.hierarchical.checkIfTree()}},{key:"_crawlNetwork",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},i=arguments.length>1?arguments[1]:void 0,n={},o=function i(o,r){if(void 0===n[o.id]){var s;t.hierarchical.setTreeIndex(o,r),n[o.id]=!0;for(var a=t._getActiveEdges(o),l=0;l<a.length;l++){var c=a[l];!0===c.connected&&o.id!=(s=c.toId==o.id?c.from:c.to).id&&(e(o,s,c),i(s,r))}}};if(void 0===i)for(var r=0,s=0;s<this.body.nodeIndices.length;s++){var a=this.body.nodeIndices[s];void 0===n[a]&&(o(this.body.nodes[a],r),r+=1)}else{var l=this.body.nodes[i];if(void 0===l)return void console.error("Node not found:",i);o(l)}}},{key:"_shiftBlock",value:function(t,e){var i=this,n={};!function t(o){if(!n[o]){n[o]=!0,i.direction.shift(o,e);var r=i.hierarchical.childrenReference[o];if(void 0!==r)for(var s=0;s<r.length;s++)t(r[s])}}(t)}},{key:"_findCommonParent",value:function(t,e){var i=this,n={};return function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];e[s]=!0,t(e,s)}}(n,t),function t(e,n){var o=i.hierarchical.parentReference[n];if(void 0!==o)for(var r=0;r<o.length;r++){var s=o[r];if(void 0!==e[s])return{foundParent:s,withChild:n};var a=t(e,s);if(null!==a.foundParent)return a}return{foundParent:null,withChild:n}}(n,e)}},{key:"setDirectionStrategy",value:function(){this.direction="UD"===this.options.hierarchical.direction||"DU"===this.options.hierarchical.direction?new bb(this):new wb(this)}},{key:"_getCenterPosition",value:function(t){for(var e=1e9,i=-1e9,n=0;n<t.length;n++){var o=this.direction.getPosition(void 0!==t[n].id?t[n]:this.body.nodes[t[n]]);e=Math.min(e,o),i=Math.max(i,o)}return.5*(e+i)}}]),t}();function Ib(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Pb=function(){function t(e,i,n,o){var r,s,a=this;pa(this,t),this.body=e,this.canvas=i,this.selectionHandler=n,this.interactionHandler=o,this.editMode=!1,this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0,this._domEventListenerCleanupQueue=[],this.temporaryUIFunctions={},this.temporaryEventFunctions=[],this.touchTime=0,this.temporaryIds={nodes:[],edges:[]},this.guiEnabled=!1,this.inMode=!1,this.selectedControlNode=void 0,this.options={},this.defaultOptions={enabled:!1,initiallyActive:!1,addNode:!0,addEdge:!0,editNode:void 0,editEdge:!0,deleteNode:!0,deleteEdge:!0,controlNodeStyle:{shape:"dot",size:6,color:{background:"#ff0000",border:"#3c3c3c",highlight:{background:"#07f968",border:"#3c3c3c"}},borderWidth:2,borderWidthSelected:2}},je(this.options,this.defaultOptions),this.body.emitter.on("destroy",function(){a._clean()}),this.body.emitter.on("_dataChanged",Ke(r=this._restore).call(r,this)),this.body.emitter.on("_resetData",Ke(s=this._restore).call(s,this))}return va(t,[{key:"_restore",value:function(){!1!==this.inMode&&(!0===this.options.initiallyActive?this.enableEditMode():this.disableEditMode())}},{key:"setOptions",value:function(t,e,i){void 0!==e&&(this.options.locale=void 0!==e.locale?e.locale:i.locale,this.options.locales=void 0!==e.locales?e.locales:i.locales),void 0!==t&&("boolean"==typeof t?this.options.enabled=t:(this.options.enabled=!0,Pu(this.options,t)),!0===this.options.initiallyActive&&(this.editMode=!0),this._setup())}},{key:"toggleEditMode",value:function(){!0===this.editMode?this.disableEditMode():this.enableEditMode()}},{key:"enableEditMode",value:function(){this.editMode=!0,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="block",this.closeDiv.style.display="block",this.editModeDiv.style.display="none",this.showManipulatorToolbar())}},{key:"disableEditMode",value:function(){this.editMode=!1,this._clean(),!0===this.guiEnabled&&(this.manipulationDiv.style.display="none",this.closeDiv.style.display="none",this.editModeDiv.style.display="block",this._createEditButton())}},{key:"showManipulatorToolbar",value:function(){if(this._clean(),this.manipulationDOM={},!0===this.guiEnabled){var t,e;this.editMode=!0,this.manipulationDiv.style.display="block",this.closeDiv.style.display="block";var i=this.selectionHandler.getSelectedNodeCount(),n=this.selectionHandler.getSelectedEdgeCount(),o=i+n,r=this.options.locales[this.options.locale],s=!1;!1!==this.options.addNode&&(this._createAddNodeButton(r),s=!0),!1!==this.options.addEdge&&(!0===s?this._createSeperator(1):s=!0,this._createAddEdgeButton(r)),1===i&&"function"==typeof this.options.editNode?(!0===s?this._createSeperator(2):s=!0,this._createEditNodeButton(r)):1===n&&0===i&&!1!==this.options.editEdge&&(!0===s?this._createSeperator(3):s=!0,this._createEditEdgeButton(r)),0!==o&&(i>0&&!1!==this.options.deleteNode||0===i&&!1!==this.options.deleteEdge)&&(!0===s&&this._createSeperator(4),this._createDeleteButton(r)),this._bindElementEvents(this.closeDiv,Ke(t=this.toggleEditMode).call(t,this)),this._temporaryBindEvent("select",Ke(e=this.showManipulatorToolbar).call(e,this))}this.body.emitter.emit("_redraw")}},{key:"addNodeMode",value:function(){var t;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addNode",!0===this.guiEnabled){var e,i=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(i),this._createSeperator(),this._createDescription(i.addDescription||this.options.locales.en.addDescription),this._bindElementEvents(this.closeDiv,Ke(e=this.toggleEditMode).call(e,this))}this._temporaryBindEvent("click",Ke(t=this._performAddNode).call(t,this))}},{key:"editNode",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean();var e=this.selectionHandler.getSelectedNodes()[0];if(void 0!==e){if(this.inMode="editNode","function"!=typeof this.options.editNode)throw new Error("No function has been configured to handle the editing of nodes.");if(!0!==e.isCluster){var i=Pu({},e.options,!1);if(i.x=e.x,i.y=e.y,2!==this.options.editNode.length)throw new Error("The function for edit does not support two arguments (data, callback)");this.options.editNode(i,function(e){null!=e&&"editNode"===t.inMode&&t.body.data.nodes.getDataSet().update(e),t.showManipulatorToolbar()})}else alert(this.options.locales[this.options.locale].editClusterError||this.options.locales.en.editClusterError)}else this.showManipulatorToolbar()}},{key:"addEdgeMode",value:function(){var t,e,i,n,o;if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="addEdge",!0===this.guiEnabled){var r,s=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(s),this._createSeperator(),this._createDescription(s.edgeDescription||this.options.locales.en.edgeDescription),this._bindElementEvents(this.closeDiv,Ke(r=this.toggleEditMode).call(r,this))}this._temporaryBindUI("onTouch",Ke(t=this._handleConnect).call(t,this)),this._temporaryBindUI("onDragEnd",Ke(e=this._finishConnect).call(e,this)),this._temporaryBindUI("onDrag",Ke(i=this._dragControlNode).call(i,this)),this._temporaryBindUI("onRelease",Ke(n=this._finishConnect).call(n,this)),this._temporaryBindUI("onDragStart",Ke(o=this._dragStartEdge).call(o,this)),this._temporaryBindUI("onHold",function(){})}},{key:"editEdgeMode",value:function(){if(!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="editEdge","object"!==hl(this.options.editEdge)||"function"!=typeof this.options.editEdge.editWithoutDrag||(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0===this.edgeBeingEditedId)){if(!0===this.guiEnabled){var t,e=this.options.locales[this.options.locale];this.manipulationDOM={},this._createBackButton(e),this._createSeperator(),this._createDescription(e.editEdgeDescription||this.options.locales.en.editEdgeDescription),this._bindElementEvents(this.closeDiv,Ke(t=this.toggleEditMode).call(t,this))}if(this.edgeBeingEditedId=this.selectionHandler.getSelectedEdgeIds()[0],void 0!==this.edgeBeingEditedId){var i,n,o,r,s=this.body.edges[this.edgeBeingEditedId],a=this._getNewTargetNode(s.from.x,s.from.y),l=this._getNewTargetNode(s.to.x,s.to.y);this.temporaryIds.nodes.push(a.id),this.temporaryIds.nodes.push(l.id),this.body.nodes[a.id]=a,this.body.nodeIndices.push(a.id),this.body.nodes[l.id]=l,this.body.nodeIndices.push(l.id),this._temporaryBindUI("onTouch",Ke(i=this._controlNodeTouch).call(i,this)),this._temporaryBindUI("onTap",function(){}),this._temporaryBindUI("onHold",function(){}),this._temporaryBindUI("onDragStart",Ke(n=this._controlNodeDragStart).call(n,this)),this._temporaryBindUI("onDrag",Ke(o=this._controlNodeDrag).call(o,this)),this._temporaryBindUI("onDragEnd",Ke(r=this._controlNodeDragEnd).call(r,this)),this._temporaryBindUI("onMouseMove",function(){}),this._temporaryBindEvent("beforeDrawing",function(t){var e=s.edgeType.findBorderPositions(t);!1===a.selected&&(a.x=e.from.x,a.y=e.from.y),!1===l.selected&&(l.x=e.to.x,l.y=e.to.y)}),this.body.emitter.emit("_redraw")}else this.showManipulatorToolbar()}else{var c=this.body.edges[this.edgeBeingEditedId];this._performEditEdge(c.from.id,c.to.id)}}},{key:"deleteSelected",value:function(){var t=this;!0!==this.editMode&&this.enableEditMode(),this._clean(),this.inMode="delete";var e=this.selectionHandler.getSelectedNodeIds(),i=this.selectionHandler.getSelectedEdgeIds(),n=void 0;if(e.length>0){for(var o=0;o<e.length;o++)if(!0===this.body.nodes[e[o]].isCluster)return void alert(this.options.locales[this.options.locale].deleteClusterError||this.options.locales.en.deleteClusterError);"function"==typeof this.options.deleteNode&&(n=this.options.deleteNode)}else i.length>0&&"function"==typeof this.options.deleteEdge&&(n=this.options.deleteEdge);if("function"==typeof n){var r={nodes:e,edges:i};if(2!==n.length)throw new Error("The function for delete does not support two arguments (data, callback)");n(r,function(e){null!=e&&"delete"===t.inMode?(t.body.data.edges.getDataSet().remove(e.edges),t.body.data.nodes.getDataSet().remove(e.nodes),t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar()):(t.body.emitter.emit("startSimulation"),t.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().remove(i),this.body.data.nodes.getDataSet().remove(e),this.body.emitter.emit("startSimulation"),this.showManipulatorToolbar()}},{key:"_setup",value:function(){!0===this.options.enabled?(this.guiEnabled=!0,this._createWrappers(),!1===this.editMode?this._createEditButton():this.showManipulatorToolbar()):(this._removeManipulationDOM(),this.guiEnabled=!1)}},{key:"_createWrappers",value:function(){var t,e;void 0===this.manipulationDiv&&(this.manipulationDiv=document.createElement("div"),this.manipulationDiv.className="vis-manipulation",this.manipulationDiv.style.display=!0===this.editMode?"block":"none",this.canvas.frame.appendChild(this.manipulationDiv)),void 0===this.editModeDiv&&(this.editModeDiv=document.createElement("div"),this.editModeDiv.className="vis-edit-mode",this.editModeDiv.style.display=!0===this.editMode?"none":"block",this.canvas.frame.appendChild(this.editModeDiv)),void 0===this.closeDiv&&(this.closeDiv=document.createElement("button"),this.closeDiv.className="vis-close",this.closeDiv.setAttribute("aria-label",null!==(t=null===(e=this.options.locales[this.options.locale])||void 0===e?void 0:e.close)&&void 0!==t?t:this.options.locales.en.close),this.closeDiv.style.display=this.manipulationDiv.style.display,this.canvas.frame.appendChild(this.closeDiv))}},{key:"_getNewTargetNode",value:function(t,e){var i=Pu({},this.options.controlNodeStyle);i.id="targetNode"+mv(),i.hidden=!1,i.physics=!1,i.x=t,i.y=e;var n=this.body.functions.createNode(i);return n.shape.boundingBox={left:t,right:t,top:e,bottom:e},n}},{key:"_createEditButton",value:function(){var t;this._clean(),this.manipulationDOM={},Cu(this.editModeDiv);var e=this._createButton("editMode","vis-edit vis-edit-mode",this.options.locales[this.options.locale].edit||this.options.locales.en.edit);this.editModeDiv.appendChild(e),this._bindElementEvents(e,Ke(t=this.toggleEditMode).call(t,this))}},{key:"_clean",value:function(){this.inMode=!1,!0===this.guiEnabled&&(Cu(this.editModeDiv),Cu(this.manipulationDiv),this._cleanupDOMEventListeners()),this._cleanupTemporaryNodesAndEdges(),this._unbindTemporaryUIs(),this._unbindTemporaryEvents(),this.body.emitter.emit("restorePhysics")}},{key:"_cleanupDOMEventListeners",value:function(){var t,e,i=function(t,e){var i=void 0!==ul&&ir(t)||t["@@iterator"];if(!i){if(vl(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Ib(t,e);var n=ml(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?jo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ib(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(ec(t=this._domEventListenerCleanupQueue).call(t,0));try{for(i.s();!(e=i.n()).done;)(0,e.value)()}catch(t){i.e(t)}finally{i.f()}}},{key:"_removeManipulationDOM",value:function(){this._clean(),Cu(this.manipulationDiv),Cu(this.editModeDiv),Cu(this.closeDiv),this.manipulationDiv&&this.canvas.frame.removeChild(this.manipulationDiv),this.editModeDiv&&this.canvas.frame.removeChild(this.editModeDiv),this.closeDiv&&this.canvas.frame.removeChild(this.closeDiv),this.manipulationDiv=void 0,this.editModeDiv=void 0,this.closeDiv=void 0}},{key:"_createSeperator",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.manipulationDOM["seperatorLineDiv"+t]=document.createElement("div"),this.manipulationDOM["seperatorLineDiv"+t].className="vis-separator-line",this.manipulationDiv.appendChild(this.manipulationDOM["seperatorLineDiv"+t])}},{key:"_createAddNodeButton",value:function(t){var e,i=this._createButton("addNode","vis-add",t.addNode||this.options.locales.en.addNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.addNodeMode).call(e,this))}},{key:"_createAddEdgeButton",value:function(t){var e,i=this._createButton("addEdge","vis-connect",t.addEdge||this.options.locales.en.addEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.addEdgeMode).call(e,this))}},{key:"_createEditNodeButton",value:function(t){var e,i=this._createButton("editNode","vis-edit",t.editNode||this.options.locales.en.editNode);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.editNode).call(e,this))}},{key:"_createEditEdgeButton",value:function(t){var e,i=this._createButton("editEdge","vis-edit",t.editEdge||this.options.locales.en.editEdge);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.editEdgeMode).call(e,this))}},{key:"_createDeleteButton",value:function(t){var e,i=this._createButton("delete",this.options.rtl?"vis-delete-rtl":"vis-delete",t.del||this.options.locales.en.del);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.deleteSelected).call(e,this))}},{key:"_createBackButton",value:function(t){var e,i=this._createButton("back","vis-back",t.back||this.options.locales.en.back);this.manipulationDiv.appendChild(i),this._bindElementEvents(i,Ke(e=this.showManipulatorToolbar).call(e,this))}},{key:"_createButton",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"vis-label";return this.manipulationDOM[t+"Div"]=document.createElement("button"),this.manipulationDOM[t+"Div"].className="vis-button "+e,this.manipulationDOM[t+"Label"]=document.createElement("div"),this.manipulationDOM[t+"Label"].className=n,this.manipulationDOM[t+"Label"].innerText=i,this.manipulationDOM[t+"Div"].appendChild(this.manipulationDOM[t+"Label"]),this.manipulationDOM[t+"Div"]}},{key:"_createDescription",value:function(t){this.manipulationDOM.descriptionLabel=document.createElement("div"),this.manipulationDOM.descriptionLabel.className="vis-none",this.manipulationDOM.descriptionLabel.innerText=t,this.manipulationDiv.appendChild(this.manipulationDOM.descriptionLabel)}},{key:"_temporaryBindEvent",value:function(t,e){this.temporaryEventFunctions.push({event:t,boundFunction:e}),this.body.emitter.on(t,e)}},{key:"_temporaryBindUI",value:function(t,e){if(void 0===this.body.eventListeners[t])throw new Error("This UI function does not exist. Typo? You tried: "+t+" possible are: "+vh(Cl(this.body.eventListeners)));this.temporaryUIFunctions[t]=this.body.eventListeners[t],this.body.eventListeners[t]=e}},{key:"_unbindTemporaryUIs",value:function(){for(var t in this.temporaryUIFunctions)Object.prototype.hasOwnProperty.call(this.temporaryUIFunctions,t)&&(this.body.eventListeners[t]=this.temporaryUIFunctions[t],delete this.temporaryUIFunctions[t]);this.temporaryUIFunctions={}}},{key:"_unbindTemporaryEvents",value:function(){for(var t=0;t<this.temporaryEventFunctions.length;t++)this.body.emitter.off(this.temporaryEventFunctions[t].event,this.temporaryEventFunctions[t].boundFunction);this.temporaryEventFunctions=[]}},{key:"_bindElementEvents",value:function(t,e){var i=new rf(t,{});Cv(i,e),this._domEventListenerCleanupQueue.push(function(){i.destroy()});var n=function(t){var i=t.keyCode,n=t.key;"Enter"!==n&&" "!==n&&13!==i&&32!==i||e()};t.addEventListener("keyup",n,!1),this._domEventListenerCleanupQueue.push(function(){t.removeEventListener("keyup",n,!1)})}},{key:"_cleanupTemporaryNodesAndEdges",value:function(){for(var t=0;t<this.temporaryIds.edges.length;t++){var e;this.body.edges[this.temporaryIds.edges[t]].disconnect(),delete this.body.edges[this.temporaryIds.edges[t]];var i,n=eh(e=this.body.edgeIndices).call(e,this.temporaryIds.edges[t]);-1!==n&&ec(i=this.body.edgeIndices).call(i,n,1)}for(var o=0;o<this.temporaryIds.nodes.length;o++){var r;delete this.body.nodes[this.temporaryIds.nodes[o]];var s,a=eh(r=this.body.nodeIndices).call(r,this.temporaryIds.nodes[o]);-1!==a&&ec(s=this.body.nodeIndices).call(s,a,1)}this.temporaryIds={nodes:[],edges:[]}}},{key:"_controlNodeTouch",value:function(t){this.selectionHandler.unselectAll(),this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=je({},this.body.view.translation)}},{key:"_controlNodeDragStart",value:function(){var t=this.selectionHandler._pointerToPositionObject(this.lastTouch),e=this.body.nodes[this.temporaryIds.nodes[0]],i=this.body.nodes[this.temporaryIds.nodes[1]],n=this.body.edges[this.edgeBeingEditedId];this.selectedControlNode=void 0;var o=e.isOverlappingWith(t),r=i.isOverlappingWith(t);!0===o?(this.selectedControlNode=e,n.edgeType.from=e):!0===r&&(this.selectedControlNode=i,n.edgeType.to=i),void 0!==this.selectedControlNode&&this.selectionHandler.selectObject(this.selectedControlNode),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDrag",value:function(t){this.body.emitter.emit("disablePhysics");var e=this.body.functions.getPointer(t.center),i=this.canvas.DOMtoCanvas(e);void 0!==this.selectedControlNode?(this.selectedControlNode.x=i.x,this.selectedControlNode.y=i.y):this.interactionHandler.onDrag(t),this.body.emitter.emit("_redraw")}},{key:"_controlNodeDragEnd",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=this.body.edges[this.edgeBeingEditedId];if(void 0!==this.selectedControlNode){this.selectionHandler.unselectAll();for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--)if(o[s]!==this.selectedControlNode.id){r=this.body.nodes[o[s]];break}void 0!==r&&void 0!==this.selectedControlNode?!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):this.selectedControlNode.id===this.body.nodes[this.temporaryIds.nodes[0]].id?this._performEditEdge(r.id,n.to.id):this._performEditEdge(n.from.id,r.id):(n.updateEdgeType(),this.body.emitter.emit("restorePhysics")),this.body.emitter.emit("_redraw")}}},{key:"_handleConnect",value:function(t){if((new Date).valueOf()-this.touchTime>100){this.lastTouch=this.body.functions.getPointer(t.center),this.lastTouch.translation=je({},this.body.view.translation),this.interactionHandler.drag.pointer=this.lastTouch,this.interactionHandler.drag.translation=this.lastTouch.translation;var e=this.selectionHandler.getNodeAt(this.lastTouch);if(void 0!==e)if(!0===e.isCluster)alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError);else{var i=this._getNewTargetNode(e.x,e.y);this.body.nodes[i.id]=i,this.body.nodeIndices.push(i.id);var n=this.body.functions.createEdge({id:"connectionEdge"+mv(),from:e.id,to:i.id,physics:!1,smooth:{enabled:!0,type:"continuous",roundness:.5}});this.body.edges[n.id]=n,this.body.edgeIndices.push(n.id),this.temporaryIds.nodes.push(i.id),this.temporaryIds.edges.push(n.id)}this.touchTime=(new Date).valueOf()}}},{key:"_dragControlNode",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--){var a;if(-1===eh(a=this.temporaryIds.nodes).call(a,o[s])){r=this.body.nodes[o[s]];break}}if(t.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragging",t,e),void 0!==this.temporaryIds.nodes[0]){var l=this.body.nodes[this.temporaryIds.nodes[0]];l.x=this.canvas._XconvertDOMtoCanvas(e.x),l.y=this.canvas._YconvertDOMtoCanvas(e.y),this.body.emitter.emit("_redraw")}else this.interactionHandler.onDrag(t)}},{key:"_finishConnect",value:function(t){var e=this.body.functions.getPointer(t.center),i=this.selectionHandler._pointerToPositionObject(e),n=void 0;void 0!==this.temporaryIds.edges[0]&&(n=this.body.edges[this.temporaryIds.edges[0]].fromId);for(var o=this.selectionHandler._getAllNodesOverlappingWith(i),r=void 0,s=o.length-1;s>=0;s--){var a;if(-1===eh(a=this.temporaryIds.nodes).call(a,o[s])){r=this.body.nodes[o[s]];break}}this._cleanupTemporaryNodesAndEdges(),void 0!==r&&(!0===r.isCluster?alert(this.options.locales[this.options.locale].createEdgeError||this.options.locales.en.createEdgeError):void 0!==this.body.nodes[n]&&void 0!==this.body.nodes[r.id]&&this._performAddEdge(n,r.id)),t.controlEdge={from:n,to:r?r.id:void 0},this.selectionHandler.generateClickEvent("controlNodeDragEnd",t,e),this.body.emitter.emit("_redraw")}},{key:"_dragStartEdge",value:function(t){this.selectionHandler.generateClickEvent("dragStart",t,this.lastTouch,void 0,!0)}},{key:"_performAddNode",value:function(t){var e=this,i={id:mv(),x:t.pointer.canvas.x,y:t.pointer.canvas.y,label:"new"};if("function"==typeof this.options.addNode){if(2!==this.options.addNode.length)throw this.showManipulatorToolbar(),new Error("The function for add does not support two arguments (data,callback)");this.options.addNode(i,function(t){null!=t&&"addNode"===e.inMode&&e.body.data.nodes.getDataSet().add(t),e.showManipulatorToolbar()})}else this.body.data.nodes.getDataSet().add(i),this.showManipulatorToolbar()}},{key:"_performAddEdge",value:function(t,e){var i=this,n={from:t,to:e};if("function"==typeof this.options.addEdge){if(2!==this.options.addEdge.length)throw new Error("The function for connect does not support two arguments (data,callback)");this.options.addEdge(n,function(t){null!=t&&"addEdge"===i.inMode&&(i.body.data.edges.getDataSet().add(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().add(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}},{key:"_performEditEdge",value:function(t,e){var i=this,n={id:this.edgeBeingEditedId,from:t,to:e,label:this.body.data.edges.get(this.edgeBeingEditedId).label},o=this.options.editEdge;if("object"===hl(o)&&(o=o.editWithoutDrag),"function"==typeof o){if(2!==o.length)throw new Error("The function for edit does not support two arguments (data, callback)");o(n,function(t){null==t||"editEdge"!==i.inMode?(i.body.edges[n.id].updateEdgeType(),i.body.emitter.emit("_redraw"),i.showManipulatorToolbar()):(i.body.data.edges.getDataSet().update(t),i.selectionHandler.unselectAll(),i.showManipulatorToolbar())})}else this.body.data.edges.getDataSet().update(n),this.selectionHandler.unselectAll(),this.showManipulatorToolbar()}}]),t}(),Mb="string",Db="boolean",Nb="number",Rb="array",zb="object",Fb=["arrow","bar","box","circle","crow","curve","diamond","image","inv_curve","inv_triangle","triangle","vee"],Lb={borderWidth:{number:Nb},borderWidthSelected:{number:Nb,undefined:"undefined"},brokenImage:{string:Mb,undefined:"undefined"},chosen:{label:{boolean:Db,function:"function"},node:{boolean:Db,function:"function"},__type__:{object:zb,boolean:Db}},color:{border:{string:Mb},background:{string:Mb},highlight:{border:{string:Mb},background:{string:Mb},__type__:{object:zb,string:Mb}},hover:{border:{string:Mb},background:{string:Mb},__type__:{object:zb,string:Mb}},__type__:{object:zb,string:Mb}},opacity:{number:Nb,undefined:"undefined"},fixed:{x:{boolean:Db},y:{boolean:Db},__type__:{object:zb,boolean:Db}},font:{align:{string:Mb},color:{string:Mb},size:{number:Nb},face:{string:Mb},background:{string:Mb},strokeWidth:{number:Nb},strokeColor:{string:Mb},vadjust:{number:Nb},multi:{boolean:Db,string:Mb},bold:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},boldital:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},ital:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},mono:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},__type__:{object:zb,string:Mb}},group:{string:Mb,number:Nb,undefined:"undefined"},heightConstraint:{minimum:{number:Nb},valign:{string:Mb},__type__:{object:zb,boolean:Db,number:Nb}},hidden:{boolean:Db},icon:{face:{string:Mb},code:{string:Mb},size:{number:Nb},color:{string:Mb},weight:{string:Mb,number:Nb},__type__:{object:zb}},id:{string:Mb,number:Nb},image:{selected:{string:Mb,undefined:"undefined"},unselected:{string:Mb,undefined:"undefined"},__type__:{object:zb,string:Mb}},imagePadding:{top:{number:Nb},right:{number:Nb},bottom:{number:Nb},left:{number:Nb},__type__:{object:zb,number:Nb}},label:{string:Mb,undefined:"undefined"},labelHighlightBold:{boolean:Db},level:{number:Nb,undefined:"undefined"},margin:{top:{number:Nb},right:{number:Nb},bottom:{number:Nb},left:{number:Nb},__type__:{object:zb,number:Nb}},mass:{number:Nb},physics:{boolean:Db},scaling:{min:{number:Nb},max:{number:Nb},label:{enabled:{boolean:Db},min:{number:Nb},max:{number:Nb},maxVisible:{number:Nb},drawThreshold:{number:Nb},__type__:{object:zb,boolean:Db}},customScalingFunction:{function:"function"},__type__:{object:zb}},shadow:{enabled:{boolean:Db},color:{string:Mb},size:{number:Nb},x:{number:Nb},y:{number:Nb},__type__:{object:zb,boolean:Db}},shape:{string:["custom","ellipse","circle","database","box","text","image","circularImage","diamond","dot","star","triangle","triangleDown","square","icon","hexagon"]},ctxRenderer:{function:"function"},shapeProperties:{borderDashes:{boolean:Db,array:Rb},borderRadius:{number:Nb},interpolation:{boolean:Db},useImageSize:{boolean:Db},useBorderWithImage:{boolean:Db},coordinateOrigin:{string:["center","top-left"]},__type__:{object:zb}},size:{number:Nb},title:{string:Mb,dom:"dom",undefined:"undefined"},value:{number:Nb,undefined:"undefined"},widthConstraint:{minimum:{number:Nb},maximum:{number:Nb},__type__:{object:zb,boolean:Db,number:Nb}},x:{number:Nb},y:{number:Nb},__type__:{object:zb}},Bb={configure:{enabled:{boolean:Db},filter:{boolean:Db,string:Mb,array:Rb,function:"function"},container:{dom:"dom"},showButton:{boolean:Db},__type__:{object:zb,boolean:Db,string:Mb,array:Rb,function:"function"}},edges:{arrows:{to:{enabled:{boolean:Db},scaleFactor:{number:Nb},type:{string:Fb},imageHeight:{number:Nb},imageWidth:{number:Nb},src:{string:Mb},__type__:{object:zb,boolean:Db}},middle:{enabled:{boolean:Db},scaleFactor:{number:Nb},type:{string:Fb},imageWidth:{number:Nb},imageHeight:{number:Nb},src:{string:Mb},__type__:{object:zb,boolean:Db}},from:{enabled:{boolean:Db},scaleFactor:{number:Nb},type:{string:Fb},imageWidth:{number:Nb},imageHeight:{number:Nb},src:{string:Mb},__type__:{object:zb,boolean:Db}},__type__:{string:["from","to","middle"],object:zb}},endPointOffset:{from:{number:Nb},to:{number:Nb},__type__:{object:zb,number:Nb}},arrowStrikethrough:{boolean:Db},background:{enabled:{boolean:Db},color:{string:Mb},size:{number:Nb},dashes:{boolean:Db,array:Rb},__type__:{object:zb,boolean:Db}},chosen:{label:{boolean:Db,function:"function"},edge:{boolean:Db,function:"function"},__type__:{object:zb,boolean:Db}},color:{color:{string:Mb},highlight:{string:Mb},hover:{string:Mb},inherit:{string:["from","to","both"],boolean:Db},opacity:{number:Nb},__type__:{object:zb,string:Mb}},dashes:{boolean:Db,array:Rb},font:{color:{string:Mb},size:{number:Nb},face:{string:Mb},background:{string:Mb},strokeWidth:{number:Nb},strokeColor:{string:Mb},align:{string:["horizontal","top","middle","bottom"]},vadjust:{number:Nb},multi:{boolean:Db,string:Mb},bold:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},boldital:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},ital:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},mono:{color:{string:Mb},size:{number:Nb},face:{string:Mb},mod:{string:Mb},vadjust:{number:Nb},__type__:{object:zb,string:Mb}},__type__:{object:zb,string:Mb}},hidden:{boolean:Db},hoverWidth:{function:"function",number:Nb},label:{string:Mb,undefined:"undefined"},labelHighlightBold:{boolean:Db},length:{number:Nb,undefined:"undefined"},physics:{boolean:Db},scaling:{min:{number:Nb},max:{number:Nb},label:{enabled:{boolean:Db},min:{number:Nb},max:{number:Nb},maxVisible:{number:Nb},drawThreshold:{number:Nb},__type__:{object:zb,boolean:Db}},customScalingFunction:{function:"function"},__type__:{object:zb}},selectionWidth:{function:"function",number:Nb},selfReferenceSize:{number:Nb},selfReference:{size:{number:Nb},angle:{number:Nb},renderBehindTheNode:{boolean:Db},__type__:{object:zb}},shadow:{enabled:{boolean:Db},color:{string:Mb},size:{number:Nb},x:{number:Nb},y:{number:Nb},__type__:{object:zb,boolean:Db}},smooth:{enabled:{boolean:Db},type:{string:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"]},roundness:{number:Nb},forceDirection:{string:["horizontal","vertical","none"],boolean:Db},__type__:{object:zb,boolean:Db}},title:{string:Mb,undefined:"undefined"},width:{number:Nb},widthConstraint:{maximum:{number:Nb},__type__:{object:zb,boolean:Db,number:Nb}},value:{number:Nb,undefined:"undefined"},__type__:{object:zb}},groups:{useDefaultGroups:{boolean:Db},__any__:Lb,__type__:{object:zb}},interaction:{dragNodes:{boolean:Db},dragView:{boolean:Db},hideEdgesOnDrag:{boolean:Db},hideEdgesOnZoom:{boolean:Db},hideNodesOnDrag:{boolean:Db},hover:{boolean:Db},keyboard:{enabled:{boolean:Db},speed:{x:{number:Nb},y:{number:Nb},zoom:{number:Nb},__type__:{object:zb}},bindToWindow:{boolean:Db},autoFocus:{boolean:Db},__type__:{object:zb,boolean:Db}},multiselect:{boolean:Db},navigationButtons:{boolean:Db},selectable:{boolean:Db},selectConnectedEdges:{boolean:Db},hoverConnectedEdges:{boolean:Db},tooltipDelay:{number:Nb},zoomView:{boolean:Db},zoomSpeed:{number:Nb},__type__:{object:zb}},layout:{randomSeed:{undefined:"undefined",number:Nb,string:Mb},improvedLayout:{boolean:Db},clusterThreshold:{number:Nb},hierarchical:{enabled:{boolean:Db},levelSeparation:{number:Nb},nodeSpacing:{number:Nb},treeSpacing:{number:Nb},blockShifting:{boolean:Db},edgeMinimization:{boolean:Db},parentCentralization:{boolean:Db},direction:{string:["UD","DU","LR","RL"]},sortMethod:{string:["hubsize","directed"]},shakeTowards:{string:["leaves","roots"]},__type__:{object:zb,boolean:Db}},__type__:{object:zb}},manipulation:{enabled:{boolean:Db},initiallyActive:{boolean:Db},addNode:{boolean:Db,function:"function"},addEdge:{boolean:Db,function:"function"},editNode:{function:"function"},editEdge:{editWithoutDrag:{function:"function"},__type__:{object:zb,boolean:Db,function:"function"}},deleteNode:{boolean:Db,function:"function"},deleteEdge:{boolean:Db,function:"function"},controlNodeStyle:Lb,__type__:{object:zb,boolean:Db}},nodes:Lb,physics:{enabled:{boolean:Db},barnesHut:{theta:{number:Nb},gravitationalConstant:{number:Nb},centralGravity:{number:Nb},springLength:{number:Nb},springConstant:{number:Nb},damping:{number:Nb},avoidOverlap:{number:Nb},__type__:{object:zb}},forceAtlas2Based:{theta:{number:Nb},gravitationalConstant:{number:Nb},centralGravity:{number:Nb},springLength:{number:Nb},springConstant:{number:Nb},damping:{number:Nb},avoidOverlap:{number:Nb},__type__:{object:zb}},repulsion:{centralGravity:{number:Nb},springLength:{number:Nb},springConstant:{number:Nb},nodeDistance:{number:Nb},damping:{number:Nb},__type__:{object:zb}},hierarchicalRepulsion:{centralGravity:{number:Nb},springLength:{number:Nb},springConstant:{number:Nb},nodeDistance:{number:Nb},damping:{number:Nb},avoidOverlap:{number:Nb},__type__:{object:zb}},maxVelocity:{number:Nb},minVelocity:{number:Nb},solver:{string:["barnesHut","repulsion","hierarchicalRepulsion","forceAtlas2Based"]},stabilization:{enabled:{boolean:Db},iterations:{number:Nb},updateInterval:{number:Nb},onlyDynamicEdges:{boolean:Db},fit:{boolean:Db},__type__:{object:zb,boolean:Db}},timestep:{number:Nb},adaptiveTimestep:{boolean:Db},wind:{x:{number:Nb},y:{number:Nb},__type__:{object:zb}},__type__:{object:zb,boolean:Db}},autoResize:{boolean:Db},clickToUse:{boolean:Db},locale:{string:Mb},locales:{__any__:{any:"any"},__type__:{object:zb}},height:{string:Mb},width:{string:Mb},__type__:{object:zb}},jb={nodes:{borderWidth:[1,0,10,1],borderWidthSelected:[2,0,10,1],color:{border:["color","#2B7CE9"],background:["color","#97C2FC"],highlight:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]},hover:{border:["color","#2B7CE9"],background:["color","#D2E5FF"]}},opacity:[0,0,1,.1],fixed:{x:!1,y:!1},font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[0,0,50,1],strokeColor:["color","#ffffff"]},hidden:!1,labelHighlightBold:!0,physics:!0,scaling:{min:[10,0,200,1],max:[30,0,200,1],label:{enabled:!1,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},shape:["ellipse","box","circle","database","diamond","dot","square","star","text","triangle","triangleDown","hexagon"],shapeProperties:{borderDashes:!1,borderRadius:[6,0,20,1],interpolation:!0,useImageSize:!1},size:[25,0,200,1]},edges:{arrows:{to:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},middle:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"},from:{enabled:!1,scaleFactor:[1,0,3,.05],type:"arrow"}},endPointOffset:{from:[0,-10,10,1],to:[0,-10,10,1]},arrowStrikethrough:!0,color:{color:["color","#848484"],highlight:["color","#848484"],hover:["color","#848484"],inherit:["from","to","both",!0,!1],opacity:[1,0,1,.05]},dashes:!1,font:{color:["color","#343434"],size:[14,0,100,1],face:["arial","verdana","tahoma"],background:["color","none"],strokeWidth:[2,0,50,1],strokeColor:["color","#ffffff"],align:["horizontal","top","middle","bottom"]},hidden:!1,hoverWidth:[1.5,0,5,.1],labelHighlightBold:!0,physics:!0,scaling:{min:[1,0,100,1],max:[15,0,100,1],label:{enabled:!0,min:[14,0,200,1],max:[30,0,200,1],maxVisible:[30,0,200,1],drawThreshold:[5,0,20,1]}},selectionWidth:[1.5,0,5,.1],selfReferenceSize:[20,0,200,1],selfReference:{size:[20,0,200,1],angle:[Math.PI/2,-6*Math.PI,6*Math.PI,Math.PI/8],renderBehindTheNode:!0},shadow:{enabled:!1,color:"rgba(0,0,0,0.5)",size:[10,0,20,1],x:[5,-30,30,1],y:[5,-30,30,1]},smooth:{enabled:!0,type:["dynamic","continuous","discrete","diagonalCross","straightCross","horizontal","vertical","curvedCW","curvedCCW","cubicBezier"],forceDirection:["horizontal","vertical","none"],roundness:[.5,0,1,.05]},width:[1,0,30,1]},layout:{hierarchical:{enabled:!1,levelSeparation:[150,20,500,5],nodeSpacing:[100,20,500,5],treeSpacing:[200,20,500,5],blockShifting:!0,edgeMinimization:!0,parentCentralization:!0,direction:["UD","DU","LR","RL"],sortMethod:["hubsize","directed"],shakeTowards:["leaves","roots"]}},interaction:{dragNodes:!0,dragView:!0,hideEdgesOnDrag:!1,hideEdgesOnZoom:!1,hideNodesOnDrag:!1,hover:!1,keyboard:{enabled:!1,speed:{x:[10,0,40,1],y:[10,0,40,1],zoom:[.02,0,.1,.005]},bindToWindow:!0,autoFocus:!0},multiselect:!1,navigationButtons:!1,selectable:!0,selectConnectedEdges:!0,hoverConnectedEdges:!0,tooltipDelay:[300,0,1e3,25],zoomView:!0,zoomSpeed:[1,.1,2,.1]},manipulation:{enabled:!1,initiallyActive:!1},physics:{enabled:!0,barnesHut:{theta:[.5,.1,1,.05],gravitationalConstant:[-2e3,-3e4,0,50],centralGravity:[.3,0,10,.05],springLength:[95,0,500,5],springConstant:[.04,0,1.2,.005],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},forceAtlas2Based:{theta:[.5,.1,1,.05],gravitationalConstant:[-50,-500,0,1],centralGravity:[.01,0,1,.005],springLength:[95,0,500,5],springConstant:[.08,0,1.2,.005],damping:[.4,0,1,.01],avoidOverlap:[0,0,1,.01]},repulsion:{centralGravity:[.2,0,10,.05],springLength:[200,0,500,5],springConstant:[.05,0,1.2,.005],nodeDistance:[100,0,500,5],damping:[.09,0,1,.01]},hierarchicalRepulsion:{centralGravity:[.2,0,10,.05],springLength:[100,0,500,5],springConstant:[.01,0,1.2,.005],nodeDistance:[120,0,500,5],damping:[.09,0,1,.01],avoidOverlap:[0,0,1,.01]},maxVelocity:[50,0,150,1],minVelocity:[.1,.01,.5,.01],solver:["barnesHut","forceAtlas2Based","repulsion","hierarchicalRepulsion"],timestep:[.5,.01,1,.01],wind:{x:[0,-10,10,.1],y:[0,-10,10,.1]}}},Vb=function(t,e,i){var n;return!(!mc(t).call(t,"physics")||!mc(n=jb.physics.solver).call(n,e)||i.physics.solver===e||"wind"===e)},Hb=Object.freeze({__proto__:null,configuratorHideOption:Vb,allOptions:Bb,configureOptions:jb}),Wb=function(){function t(){pa(this,t)}return va(t,[{key:"getDistances",value:function(t,e,i){for(var n={},o=t.edges,r=0;r<e.length;r++){var s={};n[e[r]]=s;for(var a=0;a<e.length;a++)s[e[a]]=r==a?0:1e9}for(var l=0;l<i.length;l++){var c=o[i[l]];!0===c.connected&&void 0!==n[c.fromId]&&void 0!==n[c.toId]&&(n[c.fromId][c.toId]=1,n[c.toId][c.fromId]=1)}for(var h=e.length,d=0;d<h;d++)for(var u=e[d],f=n[u],p=0;p<h-1;p++)for(var g=e[p],m=n[g],v=p+1;v<h;v++){var y=e[v],b=n[y],w=Math.min(m[y],m[u]+f[y]);m[y]=w,b[g]=w}return n}}]),t}(),qb=function(){function t(e,i,n){pa(this,t),this.body=e,this.springLength=i,this.springConstant=n,this.distanceSolver=new Wb}return va(t,[{key:"setOptions",value:function(t){t&&(t.springLength&&(this.springLength=t.springLength),t.springConstant&&(this.springConstant=t.springConstant))}},{key:"solve",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.distanceSolver.getDistances(this.body,t,e);this._createL_matrix(n),this._createK_matrix(n),this._createE_matrix();for(var o=.01,r=1,s=0,a=Math.max(1e3,Math.min(10*this.body.nodeIndices.length,6e3)),l=5,c=1e9,h=0,d=0,u=0,f=0,p=0;c>o&&s<a;){s+=1;var g=ll(this._getHighestEnergyNode(i),4);for(h=g[0],d=g[2],u=g[3],f=c=g[1],p=0;f>r&&p<l;){p+=1,this._moveNode(h,d,u);var m=ll(this._getEnergy(h),3);f=m[0],d=m[1],u=m[2]}}}},{key:"_getHighestEnergyNode",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=0,o=e[0],r=0,s=0,a=0;a<e.length;a++){var l=e[a];if(!0!==i[l].predefinedPosition||!0===i[l].isCluster&&!0===t||!0!==i[l].options.fixed.x||!0!==i[l].options.fixed.y){var c=ll(this._getEnergy(l),3),h=c[0];n<h&&(n=h,o=l,r=c[1],s=c[2])}}return[o,n,r,s]}},{key:"_getEnergy",value:function(t){var e=ll(this.E_sums[t],2),i=e[0],n=e[1];return[Math.sqrt(Math.pow(i,2)+Math.pow(n,2)),i,n]}},{key:"_moveNode",value:function(t,e,i){for(var n=this.body.nodeIndices,o=this.body.nodes,r=0,s=0,a=0,l=o[t].x,c=o[t].y,h=this.K_matrix[t],d=this.L_matrix[t],u=0;u<n.length;u++){var f=n[u];if(f!==t){var p=o[f].x,g=o[f].y,m=h[f],v=d[f],y=1/Math.pow(Math.pow(l-p,2)+Math.pow(c-g,2),1.5);r+=m*(1-v*Math.pow(c-g,2)*y),s+=m*(v*(l-p)*(c-g)*y),a+=m*(1-v*Math.pow(l-p,2)*y)}}var b=(e/r+i/s)/(s/r-a/s);o[t].x+=-(s*b+e)/r,o[t].y+=b,this._updateE_matrix(t)}},{key:"_createL_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springLength;this.L_matrix=[];for(var n=0;n<e.length;n++){this.L_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.L_matrix[e[n]][e[o]]=i*t[e[n]][e[o]]}}},{key:"_createK_matrix",value:function(t){var e=this.body.nodeIndices,i=this.springConstant;this.K_matrix=[];for(var n=0;n<e.length;n++){this.K_matrix[e[n]]={};for(var o=0;o<e.length;o++)this.K_matrix[e[n]][e[o]]=i*Math.pow(t[e[n]][e[o]],-2)}}},{key:"_createE_matrix",value:function(){var t=this.body.nodeIndices,e=this.body.nodes;this.E_matrix={},this.E_sums={};for(var i=0;i<t.length;i++)this.E_matrix[t[i]]=[];for(var n=0;n<t.length;n++){for(var o=t[n],r=e[o].x,s=e[o].y,a=0,l=0,c=n;c<t.length;c++){var h=t[c];if(h!==o){var d=e[h].x,u=e[h].y,f=1/Math.sqrt(Math.pow(r-d,2)+Math.pow(s-u,2));this.E_matrix[o][c]=[this.K_matrix[o][h]*(r-d-this.L_matrix[o][h]*(r-d)*f),this.K_matrix[o][h]*(s-u-this.L_matrix[o][h]*(s-u)*f)],this.E_matrix[h][n]=this.E_matrix[o][c],a+=this.E_matrix[o][c][0],l+=this.E_matrix[o][c][1]}}this.E_sums[o]=[a,l]}}},{key:"_updateE_matrix",value:function(t){for(var e=this.body.nodeIndices,i=this.body.nodes,n=this.E_matrix[t],o=this.K_matrix[t],r=this.L_matrix[t],s=i[t].x,a=i[t].y,l=0,c=0,h=0;h<e.length;h++){var d=e[h];if(d!==t){var u=n[h],f=u[0],p=u[1],g=i[d].x,m=i[d].y,v=1/Math.sqrt(Math.pow(s-g,2)+Math.pow(a-m,2)),y=o[d]*(s-g-r[d]*(s-g)*v),b=o[d]*(a-m-r[d]*(a-m)*v);n[h]=[y,b],l+=y,c+=b;var w=this.E_sums[d];w[0]+=y-f,w[1]+=b-p}}this.E_sums[t]=[l,c]}}]),t}();function Ub(t,e,i){var n,o,r,s,a=this;if(!(this instanceof Ub))throw new SyntaxError("Constructor must be called with the new operator");this.options={},this.defaultOptions={locale:"en",locales:Vf,clickToUse:!1},je(this.options,this.defaultOptions),this.body={container:t,nodes:{},nodeIndices:[],edges:{},edgeIndices:[],emitter:{on:Ke(n=this.on).call(n,this),off:Ke(o=this.off).call(o,this),emit:Ke(r=this.emit).call(r,this),once:Ke(s=this.once).call(s,this)},eventListeners:{onTap:function(){},onTouch:function(){},onDoubleTap:function(){},onHold:function(){},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},onMouseWheel:function(){},onPinch:function(){},onMouseMove:function(){},onRelease:function(){},onContext:function(){}},data:{nodes:null,edges:null},functions:{createNode:function(){},createEdge:function(){},getPointer:function(){}},modules:{},view:{scale:1,translation:{x:0,y:0}},selectionBox:{show:!1,position:{start:{x:0,y:0},end:{x:0,y:0}}}},this.bindEventListeners(),this.images=new Wf(function(){return a.body.emitter.emit("_requestRedraw")}),this.groups=new $p,this.canvas=new Tv(this.body),this.selectionHandler=new Ey(this.body,this.canvas),this.interactionHandler=new Pv(this.body,this.canvas,this.selectionHandler),this.view=new Av(this.body,this.canvas),this.renderer=new _v(this.body,this.canvas),this.physics=new cv(this.body),this.layoutEngine=new Ob(this.body),this.clustering=new bv(this.body),this.manipulation=new Pb(this.body,this.canvas,this.selectionHandler,this.interactionHandler),this.nodesHandler=new pm(this.body,this.images,this.groups,this.layoutEngine),this.edgesHandler=new tv(this.body,this.images,this.groups),this.body.modules.kamadaKawai=new qb(this.body,150,.05),this.body.modules.clustering=this.clustering,this.canvas._create(),this.setOptions(i),this.setData(e)}ri(Ub.prototype),Ub.prototype.setOptions=function(t){var e=this;if(null===t&&(t=void 0),void 0!==t){if(!0===lf.validate(t,Bb)&&console.error("%cErrors have been found in the supplied options object.",af),Ou(["locale","locales","clickToUse"],this.options,t),void 0!==t.locale&&(t.locale=function(t,e){try{var i=ll(e.split(/[-_ /]/,2),2),n=i[0],o=i[1],r=null!=n?n.toLowerCase():null,s=null!=o?o.toUpperCase():null;if(r&&s){var a,l=r+"-"+s;if(Object.prototype.hasOwnProperty.call(t,l))return l;console.warn(gl(a="Unknown variant ".concat(s," of language ")).call(a,r,"."))}if(r){var c=r;if(Object.prototype.hasOwnProperty.call(t,c))return c;console.warn("Unknown language ".concat(r))}return console.warn("Unknown locale ".concat(e,", falling back to English.")),"en"}catch(t){return console.error(t),console.warn("Unexpected error while normalizing locale ".concat(e,", falling back to English.")),"en"}}(t.locales||this.options.locales,t.locale)),t=this.layoutEngine.setOptions(t.layout,t),this.canvas.setOptions(t),this.groups.setOptions(t.groups),this.nodesHandler.setOptions(t.nodes),this.edgesHandler.setOptions(t.edges),this.physics.setOptions(t.physics),this.manipulation.setOptions(t.manipulation,t,this.options),this.interactionHandler.setOptions(t.interaction),this.renderer.setOptions(t.interaction),this.selectionHandler.setOptions(t.interaction),void 0!==t.groups&&this.body.emitter.emit("refreshNodes"),"configure"in t&&(this.configurator||(this.configurator=new of(this,this.body.container,jb,this.canvas.pixelRatio,Vb)),this.configurator.setOptions(t.configure)),this.configurator&&!0===this.configurator.options.enabled){var i={nodes:{},edges:{},layout:{},interaction:{},manipulation:{},physics:{},global:{}};Pu(i.nodes,this.nodesHandler.options),Pu(i.edges,this.edgesHandler.options),Pu(i.layout,this.layoutEngine.options),Pu(i.interaction,this.selectionHandler.options),Pu(i.interaction,this.renderer.options),Pu(i.interaction,this.interactionHandler.options),Pu(i.manipulation,this.manipulation.options),Pu(i.physics,this.physics.options),Pu(i.global,this.canvas.options),Pu(i.global,this.options),this.configurator.setModuleOptions(i)}void 0!==t.clickToUse?!0===t.clickToUse?void 0===this.activator&&(this.activator=new nf(this.canvas.frame),this.activator.on("change",function(){e.body.emitter.emit("activate")})):(void 0!==this.activator&&(this.activator.destroy(),delete this.activator),this.body.emitter.emit("activate")):this.body.emitter.emit("activate"),this.canvas.setSize(),this.body.emitter.emit("startSimulation")}},Ub.prototype._updateVisibleIndices=function(){var t=this.body.nodes,e=this.body.edges;for(var i in this.body.nodeIndices=[],this.body.edgeIndices=[],t)Object.prototype.hasOwnProperty.call(t,i)&&(this.clustering._isClusteredNode(i)||!1!==t[i].options.hidden||this.body.nodeIndices.push(t[i].id));for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=e[n],r=t[o.fromId],s=t[o.toId],a=void 0!==r&&void 0!==s;!this.clustering._isClusteredEdge(n)&&!1===o.options.hidden&&a&&!1===r.options.hidden&&!1===s.options.hidden&&this.body.edgeIndices.push(o.id)}},Ub.prototype.bindEventListeners=function(){var t=this;this.body.emitter.on("_dataChanged",function(){t.edgesHandler._updateState(),t.body.emitter.emit("_dataUpdated")}),this.body.emitter.on("_dataUpdated",function(){t.clustering._updateState(),t._updateVisibleIndices(),t._updateValueRange(t.body.nodes),t._updateValueRange(t.body.edges),t.body.emitter.emit("startSimulation"),t.body.emitter.emit("_requestRedraw")})},Ub.prototype.setData=function(t){if(this.body.emitter.emit("resetPhysics"),this.body.emitter.emit("_resetData"),this.selectionHandler.unselectAll(),t&&t.dot&&(t.nodes||t.edges))throw new SyntaxError('Data must contain either parameter "dot" or  parameter pair "nodes" and "edges", but not both.');if(this.setOptions(t&&t.options),t&&t.dot){console.warn("The dot property has been deprecated. Please use the static convertDot method to convert DOT into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertDot(dotString);");var e=Ff(t.dot);this.setData(e)}else if(t&&t.gephi){console.warn("The gephi property has been deprecated. Please use the static convertGephi method to convert gephi into vis.network format and use the normal data format with nodes and edges. This converter is used like this: var data = vis.network.convertGephi(gephiJson);");var i=Bf(t.gephi);this.setData(i)}else this.nodesHandler.setData(t&&t.nodes,!0),this.edgesHandler.setData(t&&t.edges,!0),this.body.emitter.emit("_dataChanged"),this.body.emitter.emit("_dataLoaded"),this.body.emitter.emit("initPhysics")},Ub.prototype.destroy=function(){for(var t in this.body.emitter.emit("destroy"),this.body.emitter.off(),this.off(),delete this.groups,delete this.canvas,delete this.selectionHandler,delete this.interactionHandler,delete this.view,delete this.renderer,delete this.physics,delete this.layoutEngine,delete this.clustering,delete this.manipulation,delete this.nodesHandler,delete this.edgesHandler,delete this.configurator,delete this.images,this.body.nodes)Object.prototype.hasOwnProperty.call(this.body.nodes,t)&&delete this.body.nodes[t];for(var e in this.body.edges)Object.prototype.hasOwnProperty.call(this.body.edges,e)&&delete this.body.edges[e];Cu(this.body.container)},Ub.prototype._updateValueRange=function(t){var e,i=void 0,n=void 0,o=0;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=t[e].getValue();void 0!==r&&(i=void 0===i?r:Math.min(r,i),n=void 0===n?r:Math.max(r,n),o+=r)}if(void 0!==i&&void 0!==n)for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&t[e].setValueRange(i,n,o)},Ub.prototype.isActive=function(){return!this.activator||this.activator.active},Ub.prototype.setSize=function(){return this.canvas.setSize.apply(this.canvas,arguments)},Ub.prototype.canvasToDOM=function(){return this.canvas.canvasToDOM.apply(this.canvas,arguments)},Ub.prototype.DOMtoCanvas=function(){return this.canvas.DOMtoCanvas.apply(this.canvas,arguments)},Ub.prototype.findNode=function(){return this.clustering.findNode.apply(this.clustering,arguments)},Ub.prototype.isCluster=function(){return this.clustering.isCluster.apply(this.clustering,arguments)},Ub.prototype.openCluster=function(){return this.clustering.openCluster.apply(this.clustering,arguments)},Ub.prototype.cluster=function(){return this.clustering.cluster.apply(this.clustering,arguments)},Ub.prototype.getNodesInCluster=function(){return this.clustering.getNodesInCluster.apply(this.clustering,arguments)},Ub.prototype.clusterByConnection=function(){return this.clustering.clusterByConnection.apply(this.clustering,arguments)},Ub.prototype.clusterByHubsize=function(){return this.clustering.clusterByHubsize.apply(this.clustering,arguments)},Ub.prototype.updateClusteredNode=function(){return this.clustering.updateClusteredNode.apply(this.clustering,arguments)},Ub.prototype.getClusteredEdges=function(){return this.clustering.getClusteredEdges.apply(this.clustering,arguments)},Ub.prototype.getBaseEdge=function(){return this.clustering.getBaseEdge.apply(this.clustering,arguments)},Ub.prototype.getBaseEdges=function(){return this.clustering.getBaseEdges.apply(this.clustering,arguments)},Ub.prototype.updateEdge=function(){return this.clustering.updateEdge.apply(this.clustering,arguments)},Ub.prototype.clusterOutliers=function(){return this.clustering.clusterOutliers.apply(this.clustering,arguments)},Ub.prototype.getSeed=function(){return this.layoutEngine.getSeed.apply(this.layoutEngine,arguments)},Ub.prototype.enableEditMode=function(){return this.manipulation.enableEditMode.apply(this.manipulation,arguments)},Ub.prototype.disableEditMode=function(){return this.manipulation.disableEditMode.apply(this.manipulation,arguments)},Ub.prototype.addNodeMode=function(){return this.manipulation.addNodeMode.apply(this.manipulation,arguments)},Ub.prototype.editNode=function(){return this.manipulation.editNode.apply(this.manipulation,arguments)},Ub.prototype.editNodeMode=function(){return console.warn("Deprecated: Please use editNode instead of editNodeMode."),this.manipulation.editNode.apply(this.manipulation,arguments)},Ub.prototype.addEdgeMode=function(){return this.manipulation.addEdgeMode.apply(this.manipulation,arguments)},Ub.prototype.editEdgeMode=function(){return this.manipulation.editEdgeMode.apply(this.manipulation,arguments)},Ub.prototype.deleteSelected=function(){return this.manipulation.deleteSelected.apply(this.manipulation,arguments)},Ub.prototype.getPositions=function(){return this.nodesHandler.getPositions.apply(this.nodesHandler,arguments)},Ub.prototype.getPosition=function(){return this.nodesHandler.getPosition.apply(this.nodesHandler,arguments)},Ub.prototype.storePositions=function(){return this.nodesHandler.storePositions.apply(this.nodesHandler,arguments)},Ub.prototype.moveNode=function(){return this.nodesHandler.moveNode.apply(this.nodesHandler,arguments)},Ub.prototype.getBoundingBox=function(){return this.nodesHandler.getBoundingBox.apply(this.nodesHandler,arguments)},Ub.prototype.getConnectedNodes=function(t){return void 0!==this.body.nodes[t]?this.nodesHandler.getConnectedNodes.apply(this.nodesHandler,arguments):this.edgesHandler.getConnectedNodes.apply(this.edgesHandler,arguments)},Ub.prototype.getConnectedEdges=function(){return this.nodesHandler.getConnectedEdges.apply(this.nodesHandler,arguments)},Ub.prototype.startSimulation=function(){return this.physics.startSimulation.apply(this.physics,arguments)},Ub.prototype.stopSimulation=function(){return this.physics.stopSimulation.apply(this.physics,arguments)},Ub.prototype.stabilize=function(){return this.physics.stabilize.apply(this.physics,arguments)},Ub.prototype.getSelection=function(){return this.selectionHandler.getSelection.apply(this.selectionHandler,arguments)},Ub.prototype.setSelection=function(){return this.selectionHandler.setSelection.apply(this.selectionHandler,arguments)},Ub.prototype.getSelectedNodes=function(){return this.selectionHandler.getSelectedNodeIds.apply(this.selectionHandler,arguments)},Ub.prototype.getSelectedEdges=function(){return this.selectionHandler.getSelectedEdgeIds.apply(this.selectionHandler,arguments)},Ub.prototype.getNodeAt=function(){var t=this.selectionHandler.getNodeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},Ub.prototype.getEdgeAt=function(){var t=this.selectionHandler.getEdgeAt.apply(this.selectionHandler,arguments);return void 0!==t&&void 0!==t.id?t.id:t},Ub.prototype.selectNodes=function(){return this.selectionHandler.selectNodes.apply(this.selectionHandler,arguments)},Ub.prototype.selectEdges=function(){return this.selectionHandler.selectEdges.apply(this.selectionHandler,arguments)},Ub.prototype.unselectAll=function(){this.selectionHandler.unselectAll.apply(this.selectionHandler,arguments),this.selectionHandler.commitWithoutEmitting.apply(this.selectionHandler),this.redraw()},Ub.prototype.redraw=function(){return this.renderer.redraw.apply(this.renderer,arguments)},Ub.prototype.getScale=function(){return this.view.getScale.apply(this.view,arguments)},Ub.prototype.getViewPosition=function(){return this.view.getViewPosition.apply(this.view,arguments)},Ub.prototype.fit=function(){return this.view.fit.apply(this.view,arguments)},Ub.prototype.moveTo=function(){return this.view.moveTo.apply(this.view,arguments)},Ub.prototype.focus=function(){return this.view.focus.apply(this.view,arguments)},Ub.prototype.releaseNode=function(){return this.view.releaseNode.apply(this.view,arguments)},Ub.prototype.getOptionsFromConfigurator=function(){var t={};return this.configurator&&(t=this.configurator.getOptions.apply(this.configurator)),t};var Yb=Ff;t.Network=Ub,t.NetworkImages=Wf,t.networkDOTParser=Lf,t.networkGephiParser=jf,t.networkOptions=Hb,t.parseDOTNetwork=Yb,t.parseGephiNetwork=Bf,Object.defineProperty(t,"__esModule",{value:!0})}(e,i(4493))},5909:function(t,e,i){!function(t,e,i){var n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e),o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t){var e={exports:{}};return t(e,e.exports),e.exports}var s,a=function(t){return t&&t.Math==Math&&t},l=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof o&&o)||function(){return this}()||Function("return this")(),c=function(t){try{return!!t()}catch(t){return!0}},h=!c(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),d={}.propertyIsEnumerable,u=Object.getOwnPropertyDescriptor,f={f:u&&!d.call({1:2},1)?function(t){var e=u(this,t);return!!e&&e.enumerable}:d},p=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},g={}.toString,m=function(t){return g.call(t).slice(8,-1)},v="".split,y=c(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==m(t)?v.call(t,""):Object(t)}:Object,b=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t},w=function(t){return y(b(t))},k=function(t){return"object"==typeof t?null!==t:"function"==typeof t},_=function(t,e){if(!k(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!k(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!k(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!k(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},x=function(t){return Object(b(t))},C={}.hasOwnProperty,E=Object.hasOwn||function(t,e){return C.call(x(t),e)},T=l.document,S=k(T)&&k(T.createElement),A=function(t){return S?T.createElement(t):{}},O=!h&&!c(function(){return 7!=Object.defineProperty(A("div"),"a",{get:function(){return 7}}).a}),I=Object.getOwnPropertyDescriptor,P={f:h?I:function(t,e){if(t=w(t),e=_(e,!0),O)try{return I(t,e)}catch(t){}if(E(t,e))return p(!f.f.call(t,e),t[e])}},M=/#|\.prototype\./,D=function(t,e){var i=R[N(t)];return i==F||i!=z&&("function"==typeof e?c(e):!!e)},N=D.normalize=function(t){return String(t).replace(M,".").toLowerCase()},R=D.data={},z=D.NATIVE="N",F=D.POLYFILL="P",L=D,B={},j=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t},V=function(t,e,i){if(j(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,o){return t.call(e,i,n,o)}}return function(){return t.apply(e,arguments)}},H=function(t){if(!k(t))throw TypeError(String(t)+" is not an object");return t},W=Object.defineProperty,q={f:h?W:function(t,e,i){if(H(t),e=_(e,!0),H(i),O)try{return W(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},U=h?function(t,e,i){return q.f(t,e,p(1,i))}:function(t,e,i){return t[e]=i,t},Y=P.f,G=function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e},Z=function(t,e){var i,n,o,r,s,a,c,h,d=t.target,u=t.global,f=t.stat,p=t.proto,g=u?l:f?l[d]:(l[d]||{}).prototype,m=u?B:B[d]||(B[d]={}),v=m.prototype;for(o in e)i=!L(u?o:d+(f?".":"#")+o,t.forced)&&g&&E(g,o),s=m[o],i&&(a=t.noTargetGet?(h=Y(g,o))&&h.value:g[o]),r=i&&a?a:e[o],i&&typeof s==typeof r||(c=t.bind&&i?V(r,l):t.wrap&&i?G(r):p&&"function"==typeof r?V(Function.call,r):r,(t.sham||r&&r.sham||s&&s.sham)&&U(c,"sham",!0),m[o]=c,p&&(E(B,n=d+"Prototype")||U(B,n,{}),B[n][o]=r,t.real&&v&&!v[o]&&U(v,o,r)))},$=function(t){return"function"==typeof t?t:void 0},X=function(t,e){return arguments.length<2?$(B[t])||$(l[t]):B[t]&&B[t][e]||l[t]&&l[t][e]},K=Math.ceil,Q=Math.floor,J=function(t){return isNaN(t=+t)?0:(t>0?Q:K)(t)},tt=Math.min,et=function(t){return t>0?tt(J(t),9007199254740991):0},it=Math.max,nt=Math.min,ot=function(t,e){var i=J(t);return i<0?it(i+e,0):nt(i,e)},rt=function(t){return function(e,i,n){var o,r=w(e),s=et(r.length),a=ot(n,s);if(t&&i!=i){for(;s>a;)if((o=r[a++])!=o)return!0}else for(;s>a;a++)if((t||a in r)&&r[a]===i)return t||a||0;return!t&&-1}},st={includes:rt(!0),indexOf:rt(!1)},at={},lt=st.indexOf,ct=function(t,e){var i,n=w(t),o=0,r=[];for(i in n)!E(at,i)&&E(n,i)&&r.push(i);for(;e.length>o;)E(n,i=e[o++])&&(~lt(r,i)||r.push(i));return r},ht=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dt=Object.keys||function(t){return ct(t,ht)},ut=h?Object.defineProperties:function(t,e){H(t);for(var i,n=dt(e),o=n.length,r=0;o>r;)q.f(t,i=n[r++],e[i]);return t},ft=X("document","documentElement"),pt="__core-js_shared__",gt=l[pt]||function(t,e){try{U(l,t,e)}catch(i){l[t]=e}return e}(pt,{}),mt=r(function(t){(t.exports=function(t,e){return gt[t]||(gt[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.14.0",mode:"pure",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})}),vt=0,yt=Math.random(),bt=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++vt+yt).toString(36)},wt=mt("keys"),kt=function(t){return wt[t]||(wt[t]=bt(t))},_t=kt("IE_PROTO"),xt=function(){},Ct=function(t){return"<script>"+t+"<\/script>"},Et=function(){try{s=document.domain&&new ActiveXObject("htmlfile")}catch(t){}var t,e;Et=s?function(t){t.write(Ct("")),t.close();var e=t.parentWindow.Object;return t=null,e}(s):((e=A("iframe")).style.display="none",ft.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Ct("document.F=Object")),t.close(),t.F);for(var i=ht.length;i--;)delete Et.prototype[ht[i]];return Et()};at[_t]=!0;var Tt=Object.create||function(t,e){var i;return null!==t?(xt.prototype=H(t),i=new xt,xt.prototype=null,i[_t]=t):i=Et(),void 0===e?i:ut(i,e)},St=[].slice,At={},Ot=function(t,e,i){if(!(e in At)){for(var n=[],o=0;o<e;o++)n[o]="a["+o+"]";At[e]=Function("C,a","return new C("+n.join(",")+")")}return At[e](t,i)},It=Function.bind||function(t){var e=j(this),i=St.call(arguments,1),n=function(){var o=i.concat(St.call(arguments));return this instanceof n?Ot(e,o.length,o):e.apply(t,o)};return k(e.prototype)&&(n.prototype=e.prototype),n},Pt=X("Reflect","construct"),Mt=c(function(){function t(){}return!(Pt(function(){},[],t)instanceof t)}),Dt=!c(function(){Pt(function(){})}),Nt=Mt||Dt;Z({target:"Reflect",stat:!0,forced:Nt,sham:Nt},{construct:function(t,e){j(t),H(e);var i=arguments.length<3?t:j(arguments[2]);if(Dt&&!Mt)return Pt(t,e,i);if(t==i){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var n=[null];return n.push.apply(n,e),new(It.apply(t,n))}var o=i.prototype,r=Tt(k(o)?o:Object.prototype),s=Function.apply.call(t,r,e);return k(s)?s:r}});var Rt=B.Reflect.construct;function zt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Z({target:"Object",stat:!0,forced:!h,sham:!h},{defineProperty:q.f});var Ft=r(function(t){var e=B.Object,i=t.exports=function(t,i,n){return e.defineProperty(t,i,n)};e.defineProperty.sham&&(i.sham=!0)}),Lt=Ft;function Bt(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Lt(t,n.key,n)}}function jt(t,e,i){return e&&Bt(t.prototype,e),i&&Bt(t,i),t}function Vt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}Z({target:"Object",stat:!0,sham:!h},{create:Tt});var Ht=B.Object,Wt=function(t,e){return Ht.create(t,e)},qt=Wt,Ut=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(t){}return function(i,n){return H(i),function(t){if(!k(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(n),e?t.call(i,n):i.__proto__=n,i}}():void 0);Z({target:"Object",stat:!0},{setPrototypeOf:Ut});var Yt=B.Object.setPrototypeOf;function Gt(t,e){return(Gt=Yt||function(t,e){return t.__proto__=e,t})(t,e)}function Zt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=qt(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gt(t,e)}var $t,Xt,Kt=Array.isArray||function(t){return"Array"==m(t)},Qt=function(t,e,i){var n=_(e);n in t?q.f(t,n,p(0,i)):t[n]=i},Jt=X("navigator","userAgent")||"",te=l.process,ee=te&&te.versions,ie=ee&&ee.v8;ie?Xt=($t=ie.split("."))[0]<4?1:$t[0]+$t[1]:Jt&&(!($t=Jt.match(/Edge\/(\d+)/))||$t[1]>=74)&&($t=Jt.match(/Chrome\/(\d+)/))&&(Xt=$t[1]);var ne=Xt&&+Xt,oe=!!Object.getOwnPropertySymbols&&!c(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&ne&&ne<41}),re=oe&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,se=mt("wks"),ae=l.Symbol,le=re?ae:ae&&ae.withoutSetter||bt,ce=function(t){return E(se,t)&&(oe||"string"==typeof se[t])||(se[t]=oe&&E(ae,t)?ae[t]:le("Symbol."+t)),se[t]},he=ce("species"),de=function(t,e){var i;return Kt(t)&&("function"!=typeof(i=t.constructor)||i!==Array&&!Kt(i.prototype)?k(i)&&null===(i=i[he])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===e?0:e)},ue=ce("species"),fe=function(t){return ne>=51||!c(function(){var e=[];return(e.constructor={})[ue]=function(){return{foo:1}},1!==e[t](Boolean).foo})},pe=ce("isConcatSpreadable"),ge=9007199254740991,me="Maximum allowed index exceeded",ve=ne>=51||!c(function(){var t=[];return t[pe]=!1,t.concat()[0]!==t}),ye=fe("concat"),be=function(t){if(!k(t))return!1;var e=t[pe];return void 0!==e?!!e:Kt(t)};Z({target:"Array",proto:!0,forced:!ve||!ye},{concat:function(t){var e,i,n,o,r,s=x(this),a=de(s,0),l=0;for(e=-1,n=arguments.length;e<n;e++)if(be(r=-1===e?s:arguments[e])){if(l+(o=et(r.length))>ge)throw TypeError(me);for(i=0;i<o;i++,l++)i in r&&Qt(a,l,r[i])}else{if(l>=ge)throw TypeError(me);Qt(a,l++,r)}return a.length=l,a}});var we=ht.concat("length","prototype"),ke={f:Object.getOwnPropertyNames||function(t){return ct(t,we)}},_e=ke.f,xe={}.toString,Ce="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ee={f:function(t){return Ce&&"[object Window]"==xe.call(t)?function(t){try{return _e(t)}catch(t){return Ce.slice()}}(t):_e(w(t))}},Te={f:Object.getOwnPropertySymbols},Se=function(t,e,i,n){n&&n.enumerable?t[e]=i:U(t,e,i)},Ae={f:ce},Oe=q.f,Ie=function(t){var e=B.Symbol||(B.Symbol={});E(e,t)||Oe(e,t,{value:Ae.f(t)})},Pe={};Pe[ce("toStringTag")]="z";var Me="[object z]"===String(Pe),De=ce("toStringTag"),Ne="Arguments"==m(function(){return arguments}()),Re=Me?m:function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),De))?i:Ne?m(e):"Object"==(n=m(e))&&"function"==typeof e.callee?"Arguments":n},ze=Me?{}.toString:function(){return"[object "+Re(this)+"]"},Fe=q.f,Le=ce("toStringTag"),Be=function(t,e,i,n){if(t){var o=i?t:t.prototype;E(o,Le)||Fe(o,Le,{configurable:!0,value:e}),n&&!Me&&U(o,"toString",ze)}},je=Function.toString;"function"!=typeof gt.inspectSource&&(gt.inspectSource=function(t){return je.call(t)});var Ve,He,We,qe=l.WeakMap,Ue="function"==typeof qe&&/native code/.test((0,gt.inspectSource)(qe)),Ye="Object already initialized";if(Ue||gt.state){var Ge=gt.state||(gt.state=new(0,l.WeakMap)),Ze=Ge.get,$e=Ge.has,Xe=Ge.set;Ve=function(t,e){if($e.call(Ge,t))throw new TypeError(Ye);return e.facade=t,Xe.call(Ge,t,e),e},He=function(t){return Ze.call(Ge,t)||{}},We=function(t){return $e.call(Ge,t)}}else{var Ke=kt("state");at[Ke]=!0,Ve=function(t,e){if(E(t,Ke))throw new TypeError(Ye);return e.facade=t,U(t,Ke,e),e},He=function(t){return E(t,Ke)?t[Ke]:{}},We=function(t){return E(t,Ke)}}var Qe={set:Ve,get:He,has:We,enforce:function(t){return We(t)?He(t):Ve(t,{})},getterFor:function(t){return function(e){var i;if(!k(e)||(i=He(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}},Je=[].push,ti=function(t){var e=1==t,i=2==t,n=3==t,o=4==t,r=6==t,s=7==t,a=5==t||r;return function(l,c,h,d){for(var u,f,p=x(l),g=y(p),m=V(c,h,3),v=et(g.length),b=0,w=d||de,k=e?w(l,v):i||s?w(l,0):void 0;v>b;b++)if((a||b in g)&&(f=m(u=g[b],b,p),t))if(e)k[b]=f;else if(f)switch(t){case 3:return!0;case 5:return u;case 6:return b;case 2:Je.call(k,u)}else switch(t){case 4:return!1;case 7:Je.call(k,u)}return r?-1:n||o?o:k}},ei={forEach:ti(0),map:ti(1),filter:ti(2),some:ti(3),every:ti(4),find:ti(5),findIndex:ti(6),filterOut:ti(7)},ii=ei.forEach,ni=kt("hidden"),oi="Symbol",ri=ce("toPrimitive"),si=Qe.set,ai=Qe.getterFor(oi),li=Object.prototype,ci=l.Symbol,hi=X("JSON","stringify"),di=P.f,ui=q.f,fi=Ee.f,pi=f.f,gi=mt("symbols"),mi=mt("op-symbols"),vi=mt("string-to-symbol-registry"),yi=mt("symbol-to-string-registry"),bi=mt("wks"),wi=l.QObject,ki=!wi||!wi.prototype||!wi.prototype.findChild,_i=h&&c(function(){return 7!=Tt(ui({},"a",{get:function(){return ui(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=di(li,e);n&&delete li[e],ui(t,e,i),n&&t!==li&&ui(li,e,n)}:ui,xi=function(t,e){var i=gi[t]=Tt(ci.prototype);return si(i,{type:oi,tag:t,description:e}),h||(i.description=e),i},Ci=re?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof ci},Ei=function(t,e,i){t===li&&Ei(mi,e,i),H(t);var n=_(e,!0);return H(i),E(gi,n)?(i.enumerable?(E(t,ni)&&t[ni][n]&&(t[ni][n]=!1),i=Tt(i,{enumerable:p(0,!1)})):(E(t,ni)||ui(t,ni,p(1,{})),t[ni][n]=!0),_i(t,n,i)):ui(t,n,i)},Ti=function(t,e){H(t);var i=w(e),n=dt(i).concat(Ii(i));return ii(n,function(e){h&&!Si.call(i,e)||Ei(t,e,i[e])}),t},Si=function(t){var e=_(t,!0),i=pi.call(this,e);return!(this===li&&E(gi,e)&&!E(mi,e))&&(!(i||!E(this,e)||!E(gi,e)||E(this,ni)&&this[ni][e])||i)},Ai=function(t,e){var i=w(t),n=_(e,!0);if(i!==li||!E(gi,n)||E(mi,n)){var o=di(i,n);return!o||!E(gi,n)||E(i,ni)&&i[ni][n]||(o.enumerable=!0),o}},Oi=function(t){var e=fi(w(t)),i=[];return ii(e,function(t){E(gi,t)||E(at,t)||i.push(t)}),i},Ii=function(t){var e=t===li,i=fi(e?mi:w(t)),n=[];return ii(i,function(t){!E(gi,t)||e&&!E(li,t)||n.push(gi[t])}),n};if(oe||(Se((ci=function(){if(this instanceof ci)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=bt(t),i=function(t){this===li&&i.call(mi,t),E(this,ni)&&E(this[ni],e)&&(this[ni][e]=!1),_i(this,e,p(1,t))};return h&&ki&&_i(li,e,{configurable:!0,set:i}),xi(e,t)}).prototype,"toString",function(){return ai(this).tag}),Se(ci,"withoutSetter",function(t){return xi(bt(t),t)}),f.f=Si,q.f=Ei,P.f=Ai,ke.f=Ee.f=Oi,Te.f=Ii,Ae.f=function(t){return xi(ce(t),t)},h&&ui(ci.prototype,"description",{configurable:!0,get:function(){return ai(this).description}})),Z({global:!0,wrap:!0,forced:!oe,sham:!oe},{Symbol:ci}),ii(dt(bi),function(t){Ie(t)}),Z({target:oi,stat:!0,forced:!oe},{for:function(t){var e=String(t);if(E(vi,e))return vi[e];var i=ci(e);return vi[e]=i,yi[i]=e,i},keyFor:function(t){if(!Ci(t))throw TypeError(t+" is not a symbol");if(E(yi,t))return yi[t]},useSetter:function(){ki=!0},useSimple:function(){ki=!1}}),Z({target:"Object",stat:!0,forced:!oe,sham:!h},{create:function(t,e){return void 0===e?Tt(t):Ti(Tt(t),e)},defineProperty:Ei,defineProperties:Ti,getOwnPropertyDescriptor:Ai}),Z({target:"Object",stat:!0,forced:!oe},{getOwnPropertyNames:Oi,getOwnPropertySymbols:Ii}),Z({target:"Object",stat:!0,forced:c(function(){Te.f(1)})},{getOwnPropertySymbols:function(t){return Te.f(x(t))}}),hi){var Pi=!oe||c(function(){var t=ci();return"[null]"!=hi([t])||"{}"!=hi({a:t})||"{}"!=hi(Object(t))});Z({target:"JSON",stat:!0,forced:Pi},{stringify:function(t,e,i){for(var n,o=[t],r=1;arguments.length>r;)o.push(arguments[r++]);if(n=e,(k(e)||void 0!==t)&&!Ci(t))return Kt(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Ci(e))return e}),o[1]=e,hi.apply(null,o)}})}ci.prototype[ri]||U(ci.prototype,ri,ci.prototype.valueOf),Be(ci,oi),at[ni]=!0,Ie("asyncIterator"),Ie("hasInstance"),Ie("isConcatSpreadable"),Ie("iterator"),Ie("match"),Ie("matchAll"),Ie("replace"),Ie("search"),Ie("species"),Ie("split"),Ie("toPrimitive"),Ie("toStringTag"),Ie("unscopables"),Be(l.JSON,"JSON",!0);var Mi=B.Symbol;Ie("asyncDispose"),Ie("dispose"),Ie("matcher"),Ie("metadata"),Ie("observable"),Ie("patternMatch"),Ie("replaceAll");var Di,Ni,Ri,zi=Mi,Fi=function(t){return function(e,i){var n,o,r=String(b(e)),s=J(i),a=r.length;return s<0||s>=a?t?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===a||(o=r.charCodeAt(s+1))<56320||o>57343?t?r.charAt(s):n:t?r.slice(s,s+2):o-56320+(n-55296<<10)+65536}},Li={codeAt:Fi(!1),charAt:Fi(!0)},Bi=!c(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),ji=kt("IE_PROTO"),Vi=Object.prototype,Hi=Bi?Object.getPrototypeOf:function(t){return t=x(t),E(t,ji)?t[ji]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Vi:null},Wi=ce("iterator"),qi=!1;[].keys&&("next"in(Ri=[].keys())?(Ni=Hi(Hi(Ri)))!==Object.prototype&&(Di=Ni):qi=!0);var Ui=null==Di||c(function(){var t={};return Di[Wi].call(t)!==t});Ui&&(Di={}),Ui&&!E(Di,Wi)&&U(Di,Wi,function(){return this});var Yi={IteratorPrototype:Di,BUGGY_SAFARI_ITERATORS:qi},Gi={},Zi=Yi.IteratorPrototype,$i=function(){return this},Xi=Yi.IteratorPrototype,Ki=Yi.BUGGY_SAFARI_ITERATORS,Qi=ce("iterator"),Ji="keys",tn="values",en="entries",nn=function(){return this},on=function(t,e,i,n,o,r,s){!function(t,e,i){var n=e+" Iterator";t.prototype=Tt(Zi,{next:p(1,i)}),Be(t,n,!1,!0),Gi[n]=$i}(i,e,n);var a,l,c,h=function(t){if(t===o&&m)return m;if(!Ki&&t in f)return f[t];switch(t){case Ji:case tn:case en:return function(){return new i(this,t)}}return function(){return new i(this)}},d=e+" Iterator",u=!1,f=t.prototype,g=f[Qi]||f["@@iterator"]||o&&f[o],m=!Ki&&g||h(o),v="Array"==e&&f.entries||g;if(v&&(a=Hi(v.call(new t)),Xi!==Object.prototype&&a.next&&(Be(a,d,!0,!0),Gi[d]=nn)),o==tn&&g&&g.name!==tn&&(u=!0,m=function(){return g.call(this)}),s&&f[Qi]!==m&&U(f,Qi,m),Gi[e]=m,o)if(l={values:h(tn),keys:r?m:h(Ji),entries:h(en)},s)for(c in l)(Ki||u||!(c in f))&&Se(f,c,l[c]);else Z({target:e,proto:!0,forced:Ki||u},l);return l},rn=Li.charAt,sn="String Iterator",an=Qe.set,ln=Qe.getterFor(sn);on(String,"String",function(t){an(this,{type:sn,string:String(t),index:0})},function(){var t,e=ln(this),i=e.string,n=e.index;return n>=i.length?{value:void 0,done:!0}:(t=rn(i,n),e.index+=t.length,{value:t,done:!1})});var cn="Array Iterator",hn=Qe.set,dn=Qe.getterFor(cn);on(Array,"Array",function(t,e){hn(this,{type:cn,target:w(t),index:0,kind:e})},function(){var t=dn(this),e=t.target,i=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:n,done:!1}:"values"==i?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),Gi.Arguments=Gi.Array;var un=ce("toStringTag");for(var fn in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var pn=l[fn],gn=pn&&pn.prototype;gn&&Re(gn)!==un&&U(gn,un,fn),Gi[fn]=Gi.Array}var mn=Ae.f("iterator");function vn(t){return(vn="function"==typeof zi&&"symbol"==typeof mn?function(t){return typeof t}:function(t){return t&&"function"==typeof zi&&t.constructor===zi&&t!==zi.prototype?"symbol":typeof t})(t)}function yn(t,e){return!e||"object"!==vn(e)&&"function"!=typeof e?Vt(t):e}var bn=c(function(){Hi(1)});Z({target:"Object",stat:!0,forced:bn,sham:!Bi},{getPrototypeOf:function(t){return Hi(x(t))}});var wn=B.Object.getPrototypeOf,kn=wn;function _n(t){return(_n=Yt?kn:function(t){return t.__proto__||kn(t)})(t)}Z({target:"Array",stat:!0},{isArray:Kt});var xn=B.Array.isArray,Cn=xn;Z({target:"Function",proto:!0},{bind:It});var En=function(t){return B[t+"Prototype"]},Tn=En("Function").bind,Sn=Function.prototype,An=function(t){var e=t.bind;return t===Sn||t instanceof Function&&e===Sn.bind?Tn:e},On=[].slice,In=/MSIE .\./.test(Jt),Pn=function(t){return function(e,i){var n=arguments.length>2,o=n?On.call(arguments,2):void 0;return t(n?function(){("function"==typeof e?e:Function(e)).apply(this,o)}:e,i)}};Z({global:!0,bind:!0,forced:In},{setTimeout:Pn(l.setTimeout),setInterval:Pn(l.setInterval)});var Mn=B.setTimeout,Dn=function(t,e){var i=[][t];return!!i&&c(function(){i.call(null,e||function(){throw 1},1)})},Nn=ei.forEach,Rn=Dn("forEach")?[].forEach:function(t){return Nn(this,t,arguments.length>1?arguments[1]:void 0)};Z({target:"Array",proto:!0,forced:[].forEach!=Rn},{forEach:Rn});var zn=En("Array").forEach,Fn=Array.prototype,Ln={DOMTokenList:!0,NodeList:!0},Bn=function(t){var e=t.forEach;return t===Fn||t instanceof Array&&e===Fn.forEach||Ln.hasOwnProperty(Re(t))?zn:e},jn="undefined"!=typeof window&&window.moment||n.default,Vn=B.Object.getOwnPropertySymbols,Hn=ei.filter,Wn=fe("filter");Z({target:"Array",proto:!0,forced:!Wn},{filter:function(t){return Hn(this,t,arguments.length>1?arguments[1]:void 0)}});var qn=En("Array").filter,Un=Array.prototype,Yn=function(t){var e=t.filter;return t===Un||t instanceof Array&&e===Un.filter?qn:e},Gn=P.f,Zn=c(function(){Gn(1)});Z({target:"Object",stat:!0,forced:!h||Zn,sham:!h},{getOwnPropertyDescriptor:function(t,e){return Gn(w(t),e)}});var $n=r(function(t){var e=B.Object,i=t.exports=function(t,i){return e.getOwnPropertyDescriptor(t,i)};e.getOwnPropertyDescriptor.sham&&(i.sham=!0)}),Xn=X("Reflect","ownKeys")||function(t){var e=ke.f(H(t)),i=Te.f;return i?e.concat(i(t)):e};Z({target:"Object",stat:!0,sham:!h},{getOwnPropertyDescriptors:function(t){for(var e,i,n=w(t),o=P.f,r=Xn(n),s={},a=0;r.length>a;)void 0!==(i=o(n,e=r[a++]))&&Qt(s,e,i);return s}});var Kn=B.Object.getOwnPropertyDescriptors;Z({target:"Object",stat:!0,forced:!h,sham:!h},{defineProperties:ut});var Qn=r(function(t){var e=B.Object,i=t.exports=function(t,i){return e.defineProperties(t,i)};e.defineProperties.sham&&(i.sham=!0)});function Jn(t,e,i){return e in t?Lt(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var to=ei.map,eo=fe("map");Z({target:"Array",proto:!0,forced:!eo},{map:function(t){return to(this,t,arguments.length>1?arguments[1]:void 0)}});var io=En("Array").map,no=Array.prototype,oo=function(t){var e=t.map;return t===no||t instanceof Array&&e===no.map?io:e},ro=function(t){return function(e,i,n,o){j(i);var r=x(e),s=y(r),a=et(r.length),l=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(l in s){o=s[l],l+=c;break}if(l+=c,t?l<0:a<=l)throw TypeError("Reduce of empty array with no initial value")}for(;t?l>=0:a>l;l+=c)l in s&&(o=i(o,s[l],l,r));return o}},so={left:ro(!1),right:ro(!0)},ao="process"==m(l.process),lo=so.left,co=Dn("reduce");Z({target:"Array",proto:!0,forced:!co||!ao&&ne>79&&ne<83},{reduce:function(t){return lo(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var ho=En("Array").reduce,uo=Array.prototype,fo=function(t){var e=t.reduce;return t===uo||t instanceof Array&&e===uo.reduce?ho:e},po=c(function(){dt(1)});Z({target:"Object",stat:!0,forced:po},{keys:function(t){return dt(x(t))}});var go=B.Object.keys,mo=Ft,vo=function(t){var e=t.return;if(void 0!==e)return H(e.call(t)).value},yo=function(t,e,i,n){try{return n?e(H(i)[0],i[1]):e(i)}catch(e){throw vo(t),e}},bo=ce("iterator"),wo=Array.prototype,ko=function(t){return void 0!==t&&(Gi.Array===t||wo[bo]===t)},_o=ce("iterator"),xo=function(t){if(null!=t)return t[_o]||t["@@iterator"]||Gi[Re(t)]},Co=ce("iterator"),Eo=!1;try{var To=0,So={next:function(){return{done:!!To++}},return:function(){Eo=!0}};So[Co]=function(){return this},Array.from(So,function(){throw 2})}catch(t){}var Ao=!function(t,e){if(!Eo)return!1;var i=!1;try{var n={};n[Co]=function(){return{next:function(){return{done:i=!0}}}},function(t){Array.from(t)}(n)}catch(t){}return i}();Z({target:"Array",stat:!0,forced:Ao},{from:function(t){var e,i,n,o,r,s,a=x(t),l="function"==typeof this?this:Array,c=arguments.length,h=c>1?arguments[1]:void 0,d=void 0!==h,u=xo(a),f=0;if(d&&(h=V(h,c>2?arguments[2]:void 0,2)),null==u||l==Array&&ko(u))for(i=new l(e=et(a.length));e>f;f++)s=d?h(a[f],f):a[f],Qt(i,f,s);else for(r=(o=u.call(a)).next,i=new l;!(n=r.call(o)).done;f++)s=d?yo(o,h,[n.value,f],!0):n.value,Qt(i,f,s);return i.length=f,i}});var Oo=B.Array.from,Io=Oo,Po=xo,Mo=xn,Do=fe("slice"),No=ce("species"),Ro=[].slice,zo=Math.max;Z({target:"Array",proto:!0,forced:!Do},{slice:function(t,e){var i,n,o,r=w(this),s=et(r.length),a=ot(t,s),l=ot(void 0===e?s:e,s);if(Kt(r)&&("function"!=typeof(i=r.constructor)||i!==Array&&!Kt(i.prototype)?k(i)&&null===(i=i[No])&&(i=void 0):i=void 0,i===Array||void 0===i))return Ro.call(r,a,l);for(n=new(void 0===i?Array:i)(zo(l-a,0)),o=0;a<l;a++,o++)a in r&&Qt(n,o,r[a]);return n.length=o,n}});var Fo=En("Array").slice,Lo=Array.prototype,Bo=function(t){var e=t.slice;return t===Lo||t instanceof Array&&e===Lo.slice?Fo:e},jo=Bo,Vo=Oo;function Ho(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function Wo(t,e){var i;if(t){if("string"==typeof t)return Ho(t,e);var n=jo(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Vo(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ho(t,e):void 0}}function qo(t){return function(t){if(Mo(t))return Ho(t)}(t)||function(t){if(void 0!==zi&&null!=Po(t)||null!=t["@@iterator"])return Vo(t)}(t)||Wo(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Uo=Mi,Yo=En("Array").concat,Go=Array.prototype,Zo=function(t){var e=t.concat;return t===Go||t instanceof Array&&e===Go.concat?Yo:e},$o=Bo;Z({target:"Reflect",stat:!0},{ownKeys:Xn});var Xo=B.Reflect.ownKeys;Z({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Ko=B.Date.now,Qo=[].reverse,Jo=[1,2];Z({target:"Array",proto:!0,forced:String(Jo)===String(Jo.reverse())},{reverse:function(){return Kt(this)&&(this.length=this.length),Qo.call(this)}});var tr=En("Array").reverse,er=Array.prototype,ir=fe("splice"),nr=Math.max,or=Math.min,rr=9007199254740991,sr="Maximum allowed length exceeded";Z({target:"Array",proto:!0,forced:!ir},{splice:function(t,e){var i,n,o,r,s,a,l=x(this),c=et(l.length),h=ot(t,c),d=arguments.length;if(0===d?i=n=0:1===d?(i=0,n=c-h):(i=d-2,n=or(nr(J(e),0),c-h)),c+i-n>rr)throw TypeError(sr);for(o=de(l,n),r=0;r<n;r++)(s=h+r)in l&&Qt(o,r,l[s]);if(o.length=n,i<n){for(r=h;r<c-n;r++)a=r+i,(s=r+n)in l?l[a]=l[s]:delete l[a];for(r=c;r>c-n+i;r--)delete l[r-1]}else if(i>n)for(r=c-n;r>h;r--)a=r+i-1,(s=r+n-1)in l?l[a]=l[s]:delete l[a];for(r=0;r<i;r++)l[r+h]=arguments[r+2];return l.length=c-n+i,o}});var ar=En("Array").splice,lr=Array.prototype,cr=function(t){var e=t.splice;return t===lr||t instanceof Array&&e===lr.splice?ar:e},hr=Object.assign,dr=Object.defineProperty,ur=!hr||c(function(){if(h&&1!==hr({b:1},hr(dr({},"a",{enumerable:!0,get:function(){dr(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=hr({},t)[i]||dt(hr({},e)).join("")!=n})?function(t,e){for(var i=x(t),n=arguments.length,o=1,r=Te.f,s=f.f;n>o;)for(var a,l=y(arguments[o++]),c=r?dt(l).concat(r(l)):dt(l),d=c.length,u=0;d>u;)a=c[u++],h&&!s.call(l,a)||(i[a]=l[a]);return i}:hr;Z({target:"Object",stat:!0,forced:Object.assign!==ur},{assign:ur});var fr=B.Object.assign,pr=st.includes;Z({target:"Array",proto:!0},{includes:function(t){return pr(this,t,arguments.length>1?arguments[1]:void 0)}});var gr=En("Array").includes,mr=ce("match"),vr=function(t){if(function(t){var e;return k(t)&&(void 0!==(e=t[mr])?!!e:"RegExp"==m(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t},yr=ce("match");Z({target:"String",proto:!0,forced:!function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[yr]=!1,"/./"[t](e)}catch(t){}}return!1}("includes")},{includes:function(t){return!!~String(b(this)).indexOf(vr(t),arguments.length>1?arguments[1]:void 0)}});var br=En("String").includes,wr=Array.prototype,kr=String.prototype,_r=function(t){var e=t.includes;return t===wr||t instanceof Array&&e===wr.includes?gr:"string"==typeof t||t===kr||t instanceof String&&e===kr.includes?br:e},xr=wn,Cr=f.f,Er=function(t){return function(e){for(var i,n=w(e),o=dt(n),r=o.length,s=0,a=[];r>s;)i=o[s++],h&&!Cr.call(n,i)||a.push(t?[i,n[i]]:n[i]);return a}},Tr=(Er(!0),Er(!1));Z({target:"Object",stat:!0},{values:function(t){return Tr(t)}});var Sr=B.Object.values,Ar="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",Or="["+Ar+"]",Ir=RegExp("^"+Or+Or+"*"),Pr=RegExp(Or+Or+"*$"),Mr=function(t){return function(e){var i=String(b(e));return 1&t&&(i=i.replace(Ir,"")),2&t&&(i=i.replace(Pr,"")),i}},Dr={start:Mr(1),end:Mr(2),trim:Mr(3)},Nr=Dr.trim,Rr=l.parseInt,zr=/^[+-]?0[Xx]/,Fr=8!==Rr(Ar+"08")||22!==Rr(Ar+"0x16")?function(t,e){var i=Nr(String(t));return Rr(i,e>>>0||(zr.test(i)?16:10))}:Rr;Z({global:!0,forced:parseInt!=Fr},{parseInt:Fr});var Lr=B.parseInt,Br=st.indexOf,jr=[].indexOf,Vr=!!jr&&1/[1].indexOf(1,-0)<0,Hr=Dn("indexOf");Z({target:"Array",proto:!0,forced:Vr||!Hr},{indexOf:function(t){return Vr?jr.apply(this,arguments)||0:Br(this,t,arguments.length>1?arguments[1]:void 0)}});var Wr,qr=En("Array").indexOf,Ur=Array.prototype,Yr=function(t){var e=t.indexOf;return t===Ur||t instanceof Array&&e===Ur.indexOf?qr:e},Gr=Dr.trim;Z({target:"String",proto:!0,forced:(Wr="trim",c(function(){return!!Ar[Wr]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[Wr]()||Ar[Wr].name!==Wr}))},{trim:function(){return Gr(this)}});var Zr=En("String").trim,$r=String.prototype,Xr=function(t){var e=t.trim;return"string"==typeof t||t===$r||t instanceof String&&e===$r.trim?Zr:e},Kr=Wt,Qr=X("JSON","stringify"),Jr=/[\uD800-\uDFFF]/g,ts=/^[\uD800-\uDBFF]$/,es=/^[\uDC00-\uDFFF]$/,is=function(t,e,i){var n=i.charAt(e-1),o=i.charAt(e+1);return ts.test(t)&&!es.test(o)||es.test(t)&&!ts.test(n)?"\\u"+t.charCodeAt(0).toString(16):t},ns=c(function(){return'"\\udf06\\ud834"'!==Qr("\udf06\ud834")||'"\\udead"'!==Qr("\udead")});Qr&&Z({target:"JSON",stat:!0,forced:ns},{stringify:function(t,e,i){var n=Qr.apply(null,arguments);return"string"==typeof n?n.replace(Jr,is):n}}),B.JSON||(B.JSON={stringify:JSON.stringify});var os=function(t,e,i){return B.JSON.stringify.apply(null,arguments)};Z({target:"Array",proto:!0},{fill:function(t){for(var e=x(this),i=et(e.length),n=arguments.length,o=ot(n>1?arguments[1]:void 0,i),r=n>2?arguments[2]:void 0,s=void 0===r?i:ot(r,i);s>o;)e[o++]=t;return e}});var rs=En("Array").fill,ss=Array.prototype,as=function(t){var e=t.fill;return t===ss||t instanceof Array&&e===ss.fill?rs:e},ls=r(function(t){function e(t){if(t)return function(t){for(var i in e.prototype)t[i]=e.prototype[i];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},e.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,n=this._callbacks["$"+t];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<n.length;o++)if((i=n[o])===e||i.fn===e){n.splice(o,1);break}return 0===n.length&&delete this._callbacks["$"+t],this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),i=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(i){n=0;for(var o=(i=i.slice(0)).length;n<o;++n)i[n].apply(this,e)}return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}});function cs(){return(cs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}function hs(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function ds(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var us,fs="function"!=typeof Object.assign?function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign,ps=["","webkit","Moz","MS","ms","o"],gs="undefined"==typeof document?{style:{}}:document.createElement("div"),ms=Math.round,vs=Math.abs,ys=Date.now;function bs(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),r=0;r<ps.length;){if((n=(i=ps[r])?i+o:e)in t)return n;r++}}us="undefined"==typeof window?{}:window;var ws=bs(gs.style,"touchAction"),ks=void 0!==ws,_s="compute",xs="auto",Cs="manipulation",Es="none",Ts="pan-x",Ss="pan-y",As=function(){if(!ks)return!1;var t={},e=us.CSS&&us.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(i){return t[i]=!e||us.CSS.supports("touch-action",i)}),t}(),Os="ontouchstart"in us,Is=void 0!==bs(us,"PointerEvent"),Ps=Os&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ms="touch",Ds="mouse",Ns=["x","y"],Rs=["clientX","clientY"];function zs(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(void 0!==t.length)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function Fs(t,e){return"function"==typeof t?t.apply(e&&e[0]||void 0,e):t}function Ls(t,e){return t.indexOf(e)>-1}var Bs=function(){function t(t,e){this.manager=t,this.set(e)}var e=t.prototype;return e.set=function(t){t===_s&&(t=this.compute()),ks&&this.manager.element.style&&As[t]&&(this.manager.element.style[ws]=t),this.actions=t.toLowerCase().trim()},e.update=function(){this.set(this.manager.options.touchAction)},e.compute=function(){var t=[];return zs(this.manager.recognizers,function(e){Fs(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(Ls(t,Es))return Es;var e=Ls(t,Ts),i=Ls(t,Ss);return e&&i?Es:e||i?e?Ts:Ss:Ls(t,Cs)?Cs:xs}(t.join(" "))},e.preventDefaults=function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,o=Ls(n,Es)&&!As.none,r=Ls(n,Ss)&&!As["pan-y"],s=Ls(n,Ts)&&!As["pan-x"];if(o&&1===t.pointers.length&&t.distance<2&&t.deltaTime<250)return;if(!s||!r)return o||r&&6&i||s&&24&i?this.preventSrc(e):void 0}},e.preventSrc=function(t){this.manager.session.prevented=!0,t.preventDefault()},t}();function js(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Vs(t){var e=t.length;if(1===e)return{x:ms(t[0].clientX),y:ms(t[0].clientY)};for(var i=0,n=0,o=0;o<e;)i+=t[o].clientX,n+=t[o].clientY,o++;return{x:ms(i/e),y:ms(n/e)}}function Hs(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:ms(t.pointers[i].clientX),clientY:ms(t.pointers[i].clientY)},i++;return{timeStamp:ys(),pointers:e,center:Vs(e),deltaX:t.deltaX,deltaY:t.deltaY}}function Ws(t,e,i){i||(i=Ns);var n=e[i[0]]-t[i[0]],o=e[i[1]]-t[i[1]];return Math.sqrt(n*n+o*o)}function qs(t,e,i){return i||(i=Ns),180*Math.atan2(e[i[1]]-t[i[1]],e[i[0]]-t[i[0]])/Math.PI}function Us(t,e){return t===e?1:vs(t)>=vs(e)?t<0?2:4:e<0?8:16}function Ys(t,e,i){return{x:e/t||0,y:i/t||0}}function Gs(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,r=1&e&&n-o==0,s=12&e&&n-o==0;i.isFirst=!!r,i.isFinal=!!s,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=Hs(e)),o>1&&!i.firstMultiple?i.firstMultiple=Hs(e):1===o&&(i.firstMultiple=!1);var r=i.firstInput,s=i.firstMultiple,a=s?s.center:r.center,l=e.center=Vs(n);e.timeStamp=ys(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=qs(a,l),e.distance=Ws(a,l),function(t,e){var i=e.center,n=t.offsetDelta||{},o=t.prevDelta||{},r=t.prevInput||{};1!==e.eventType&&4!==r.eventType||(o=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=o.x+(i.x-n.x),e.deltaY=o.y+(i.y-n.y)}(i,e),e.offsetDirection=Us(e.deltaX,e.deltaY);var c,h,d=Ys(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=d.x,e.overallVelocityY=d.y,e.overallVelocity=vs(d.x)>vs(d.y)?d.x:d.y,e.scale=s?(c=s.pointers,Ws((h=n)[0],h[1],Rs)/Ws(c[0],c[1],Rs)):1,e.rotation=s?function(t,e){return qs(e[1],e[0],Rs)+qs(t[1],t[0],Rs)}(s.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,r,s=t.lastInterval||e,a=e.timeStamp-s.timeStamp;if(8!==e.eventType&&(a>25||void 0===s.velocity)){var l=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=Ys(a,l,c);n=h.x,o=h.y,i=vs(h.x)>vs(h.y)?h.x:h.y,r=Us(l,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,o=s.velocityY,r=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=r}(i,e);var u,f=t.element,p=e.srcEvent;js(u=p.composedPath?p.composedPath()[0]:p.path?p.path[0]:p.target,f)&&(f=u),e.target=f}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function Zs(t){return t.trim().split(/\s+/g)}function $s(t,e,i){zs(Zs(e),function(e){t.addEventListener(e,i,!1)})}function Xs(t,e,i){zs(Zs(e),function(e){t.removeEventListener(e,i,!1)})}function Ks(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||window}var Qs=function(){function t(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){Fs(t.options.enable,[t])&&i.handler(e)},this.init()}var e=t.prototype;return e.handler=function(){},e.init=function(){this.evEl&&$s(this.element,this.evEl,this.domHandler),this.evTarget&&$s(this.target,this.evTarget,this.domHandler),this.evWin&&$s(Ks(this.element),this.evWin,this.domHandler)},e.destroy=function(){this.evEl&&Xs(this.element,this.evEl,this.domHandler),this.evTarget&&Xs(this.target,this.evTarget,this.domHandler),this.evWin&&Xs(Ks(this.element),this.evWin,this.domHandler)},t}();function Js(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}var ta={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},ea={2:Ms,3:"pen",4:Ds,5:"kinect"},ia="pointerdown",na="pointermove pointerup pointercancel";us.MSPointerEvent&&!us.PointerEvent&&(ia="MSPointerDown",na="MSPointerMove MSPointerUp MSPointerCancel");var oa=function(t){function e(){var i,n=e.prototype;return n.evEl=ia,n.evWin=na,(i=t.apply(this,arguments)||this).store=i.manager.session.pointerEvents=[],i}return hs(e,t),e.prototype.handler=function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),o=ta[n],r=ea[t.pointerType]||t.pointerType,s=r===Ms,a=Js(e,t.pointerId,"pointerId");1&o&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&o&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))},e}(Qs);function ra(t){return Array.prototype.slice.call(t,0)}function sa(t,e,i){for(var n=[],o=[],r=0;r<t.length;){var s=e?t[r][e]:t[r];Js(o,s)<0&&n.push(t[r]),o[r]=s,r++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}var aa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},la="touchstart touchmove touchend touchcancel",ca=function(t){function e(){var i;return e.prototype.evTarget=la,(i=t.apply(this,arguments)||this).targetIds={},i}return hs(e,t),e.prototype.handler=function(t){var e=aa[t.type],i=ha.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Ms,srcEvent:t})},e}(Qs);function ha(t,e){var i,n,o=ra(t.touches),r=this.targetIds;if(3&e&&1===o.length)return r[o[0].identifier]=!0,[o,o];var s=ra(t.changedTouches),a=[],l=this.target;if(n=o.filter(function(t){return js(t.target,l)}),1===e)for(i=0;i<n.length;)r[n[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[sa(n.concat(a),"identifier",!0),a]:void 0}var da={mousedown:1,mousemove:2,mouseup:4},ua="mousedown",fa="mousemove mouseup",pa=function(t){function e(){var i,n=e.prototype;return n.evEl=ua,n.evWin=fa,(i=t.apply(this,arguments)||this).pressed=!1,i}return hs(e,t),e.prototype.handler=function(t){var e=da[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Ds,srcEvent:t}))},e}(Qs);function ga(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY},n=this.lastTouches;this.lastTouches.push(i),setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},2500)}}function ma(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,ga.call(this,e)):12&t&&ga.call(this,e)}function va(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var o=this.lastTouches[n],r=Math.abs(e-o.x),s=Math.abs(i-o.y);if(r<=25&&s<=25)return!0}return!1}var ya=function(t){function e(e,i){var n;return(n=t.call(this,e,i)||this).handler=function(t,e,i){var o=i.pointerType===Ds;if(!(o&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(i.pointerType===Ms)ma.call(ds(ds(n)),e,i);else if(o&&va.call(ds(ds(n)),i))return;n.callback(t,e,i)}},n.touch=new ca(n.manager,n.handler),n.mouse=new pa(n.manager,n.handler),n.primaryTouch=null,n.lastTouches=[],n}return hs(e,t),e.prototype.destroy=function(){this.touch.destroy(),this.mouse.destroy()},e}(Qs);function ba(t,e,i){return!!Array.isArray(t)&&(zs(t,i[e],i),!0)}var wa=32,ka=1;function _a(t,e){var i=e.manager;return i?i.get(t):t}function xa(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}var Ca=function(){function t(t){void 0===t&&(t={}),this.options=cs({enable:!0},t),this.id=ka++,this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var e=t.prototype;return e.set=function(t){return fs(this.options,t),this.manager&&this.manager.touchAction.update(),this},e.recognizeWith=function(t){if(ba(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=_a(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},e.dropRecognizeWith=function(t){return ba(t,"dropRecognizeWith",this)||(t=_a(t,this),delete this.simultaneous[t.id]),this},e.requireFailure=function(t){if(ba(t,"requireFailure",this))return this;var e=this.requireFail;return-1===Js(e,t=_a(t,this))&&(e.push(t),t.requireFailure(this)),this},e.dropRequireFailure=function(t){if(ba(t,"dropRequireFailure",this))return this;t=_a(t,this);var e=Js(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},e.hasRequireFailures=function(){return this.requireFail.length>0},e.canRecognizeWith=function(t){return!!this.simultaneous[t.id]},e.emit=function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+xa(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+xa(i))},e.tryEmit=function(t){if(this.canEmit())return this.emit(t);this.state=wa},e.canEmit=function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},e.recognize=function(t){var e=fs({},t);if(!Fs(this.options.enable,[this,e]))return this.reset(),void(this.state=wa);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},e.process=function(t){},e.getTouchAction=function(){},e.reset=function(){},t}(),Ea=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,cs({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},e))||this).pTime=!1,i.pCenter=!1,i._timer=null,i._input=null,i.count=0,i}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Cs]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime<i.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(o&&r&&n){if(4!==t.eventType)return this.failTimeout();var s=!this.pTime||t.timeStamp-this.pTime<i.interval,a=!this.pCenter||Ws(this.pCenter,t.center)<i.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,a&&s?this.count+=1:this.count=1,this._input=t,0==this.count%i.taps)return this.hasRequireFailures()?(this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.interval),2):8}return wa},i.failTimeout=function(){var t=this;return this._timer=setTimeout(function(){t.state=wa},this.options.interval),wa},i.reset=function(){clearTimeout(this._timer)},i.emit=function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},e}(Ca),Ta=function(t){function e(e){return void 0===e&&(e={}),t.call(this,cs({pointers:1},e))||this}hs(e,t);var i=e.prototype;return i.attrTest=function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},i.process=function(t){var e=this.state,i=t.eventType,n=6&e,o=this.attrTest(t);return n&&(8&i||!o)?16|e:n||o?4&i?8|e:2&e?4|e:2:wa},e}(Ca);function Sa(t){return 16===t?"down":8===t?"up":2===t?"left":4===t?"right":""}var Aa=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,cs({event:"pan",threshold:10,pointers:1,direction:30},e))||this).pX=null,i.pY=null,i}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){var t=this.options.direction,e=[];return 6&t&&e.push(Ss),24&t&&e.push(Ts),e},i.directionTest=function(t){var e=this.options,i=!0,n=t.distance,o=t.direction,r=t.deltaX,s=t.deltaY;return o&e.direction||(6&e.direction?(o=0===r?1:r<0?2:4,i=r!==this.pX,n=Math.abs(t.deltaX)):(o=0===s?1:s<0?8:16,i=s!==this.pY,n=Math.abs(t.deltaY))),t.direction=o,i&&n>e.threshold&&o&e.direction},i.attrTest=function(t){return Ta.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},i.emit=function(e){this.pX=e.deltaX,this.pY=e.deltaY;var i=Sa(e.direction);i&&(e.additionalEvent=this.options.event+i),t.prototype.emit.call(this,e)},e}(Ta),Oa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,cs({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},e))||this}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){return Aa.prototype.getTouchAction.call(this)},i.attrTest=function(e){var i,n=this.options.direction;return 30&n?i=e.overallVelocity:6&n?i=e.overallVelocityX:24&n&&(i=e.overallVelocityY),t.prototype.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers===this.options.pointers&&vs(i)>this.options.velocity&&4&e.eventType},i.emit=function(t){var e=Sa(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)},e}(Ta),Ia=function(t){function e(e){return void 0===e&&(e={}),t.call(this,cs({event:"pinch",threshold:0,pointers:2},e))||this}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Es]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},i.emit=function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),t.prototype.emit.call(this,e)},e}(Ta),Pa=function(t){function e(e){return void 0===e&&(e={}),t.call(this,cs({event:"rotate",threshold:0,pointers:2},e))||this}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){return[Es]},i.attrTest=function(e){return t.prototype.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)},e}(Ta),Ma=function(t){function e(e){var i;return void 0===e&&(e={}),(i=t.call(this,cs({event:"press",pointers:1,time:251,threshold:9},e))||this)._timer=null,i._input=null,i}hs(e,t);var i=e.prototype;return i.getTouchAction=function(){return[xs]},i.process=function(t){var e=this,i=this.options,n=t.pointers.length===i.pointers,o=t.distance<i.threshold,r=t.deltaTime>i.time;if(this._input=t,!o||!n||12&t.eventType&&!r)this.reset();else if(1&t.eventType)this.reset(),this._timer=setTimeout(function(){e.state=8,e.tryEmit()},i.time);else if(4&t.eventType)return 8;return wa},i.reset=function(){clearTimeout(this._timer)},i.emit=function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ys(),this.manager.emit(this.options.event,this._input)))},e}(Ca),Da={domEvents:!1,touchAction:_s,enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Na=[[Pa,{enable:!1}],[Ia,{enable:!1},["rotate"]],[Oa,{direction:6}],[Aa,{direction:6},["swipe"]],[Ea],[Ea,{event:"doubletap",taps:2},["tap"]],[Ma]];function Ra(t,e){var i,n=t.element;n.style&&(zs(t.options.cssProps,function(o,r){i=bs(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=o):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}var za=function(){function t(t,e){var i=this;this.options=fs({},Da,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(Is?oa:Ps?ca:Os?ya:pa))(this,Gs),this.touchAction=new Bs(this,this.options.touchAction),Ra(this,!0),zs(this.options.recognizers,function(t){var e=i.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}var e=t.prototype;return e.set=function(t){return fs(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},e.stop=function(t){this.session.stopped=t?2:1},e.recognize=function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,o=e.curRecognizer;(!o||o&&8&o.state)&&(e.curRecognizer=null,o=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||o&&i!==o&&!i.canRecognizeWith(o)?i.reset():i.recognize(t),!o&&14&i.state&&(e.curRecognizer=i,o=i),r++}},e.get=function(t){if(t instanceof Ca)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event===t)return e[i];return null},e.add=function(t){if(ba(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},e.remove=function(t){if(ba(t,"remove",this))return this;var e=this.get(t);if(t){var i=this.recognizers,n=Js(i,e);-1!==n&&(i.splice(n,1),this.touchAction.update())}return this},e.on=function(t,e){if(void 0===t||void 0===e)return this;var i=this.handlers;return zs(Zs(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},e.off=function(t,e){if(void 0===t)return this;var i=this.handlers;return zs(Zs(t),function(t){e?i[t]&&i[t].splice(Js(i[t],e),1):delete i[t]}),this},e.emit=function(t,e){this.options.domEvents&&function(t,e){var i=document.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},e.destroy=function(){this.element&&Ra(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},t}(),Fa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},La="touchstart",Ba="touchstart touchmove touchend touchcancel",ja=function(t){function e(){var i,n=e.prototype;return n.evTarget=La,n.evWin=Ba,(i=t.apply(this,arguments)||this).started=!1,i}return hs(e,t),e.prototype.handler=function(t){var e=Fa[t.type];if(1===e&&(this.started=!0),this.started){var i=Va.call(this,t,e);12&e&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Ms,srcEvent:t})}},e}(Qs);function Va(t,e){var i=ra(t.touches),n=ra(t.changedTouches);return 12&e&&(i=sa(i.concat(n),"identifier",!0)),[i,n]}function Ha(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=window.console&&(window.console.warn||window.console.log);return o&&o.call(window.console,n,i),t.apply(this,arguments)}}var Wa=Ha(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&void 0===t[n[o]])&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),qa=Ha(function(t,e){return Wa(t,e,!0)},"merge","Use `assign`.");function Ua(t,e,i){var n,o=e.prototype;(n=t.prototype=Object.create(o)).constructor=t,n._super=o,i&&fs(n,i)}function Ya(t,e){return function(){return t.apply(e,arguments)}}var Ga=function(){var t=function(t,e){return void 0===e&&(e={}),new za(t,cs({recognizers:Na.concat()},e))};return t.VERSION="2.0.17-rc",t.DIRECTION_ALL=30,t.DIRECTION_DOWN=16,t.DIRECTION_LEFT=2,t.DIRECTION_RIGHT=4,t.DIRECTION_UP=8,t.DIRECTION_HORIZONTAL=6,t.DIRECTION_VERTICAL=24,t.DIRECTION_NONE=1,t.DIRECTION_DOWN=16,t.INPUT_START=1,t.INPUT_MOVE=2,t.INPUT_END=4,t.INPUT_CANCEL=8,t.STATE_POSSIBLE=1,t.STATE_BEGAN=2,t.STATE_CHANGED=4,t.STATE_ENDED=8,t.STATE_RECOGNIZED=8,t.STATE_CANCELLED=16,t.STATE_FAILED=wa,t.Manager=za,t.Input=Qs,t.TouchAction=Bs,t.TouchInput=ca,t.MouseInput=pa,t.PointerEventInput=oa,t.TouchMouseInput=ya,t.SingleTouchInput=ja,t.Recognizer=Ca,t.AttrRecognizer=Ta,t.Tap=Ea,t.Pan=Aa,t.Swipe=Oa,t.Pinch=Ia,t.Rotate=Pa,t.Press=Ma,t.on=$s,t.off=Xs,t.each=zs,t.merge=qa,t.extend=Wa,t.bindFn=Ya,t.assign=fs,t.inherit=Ua,t.bindFn=Ya,t.prefixed=bs,t.toArray=ra,t.inArray=Js,t.uniqueArray=sa,t.splitStr=Zs,t.boolOrFn=Fs,t.hasParent=js,t.addEventListeners=$s,t.removeEventListeners=Xs,t.defaults=fs({},Da,{preset:Na}),t}();function Za(t,e){var i=go(t);if(Vn){var n=Vn(t);e&&(n=Yn(n).call(n,function(e){return $n(t,e).enumerable})),i.push.apply(i,n)}return i}function $a(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Bn(i=Za(Object(n),!0)).call(i,function(e){Jn(t,e,n[e])});else if(Kn)Qn(t,Kn(n));else{var o;Bn(o=Za(Object(n))).call(o,function(e){mo(t,e,$n(n,e))})}}return t}function Xa(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Ka(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ka(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function Ka(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Qa=Uo("DELETE");function Ja(){var t=tl.apply(void 0,arguments);return il(t),t}function tl(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<2)return e[0];var n;if(e.length>2)return tl.apply(void 0,Zo(n=[Ja(e[0],e[1])]).call(n,qo($o(e).call(e,2))));var o,r=e[0],s=e[1],a=Xa(Xo(s));try{for(a.s();!(o=a.n()).done;){var l=o.value;Object.prototype.propertyIsEnumerable.call(s,l)&&(s[l]===Qa?delete r[l]:r[l]=null===r[l]||null===s[l]||"object"!==vn(r[l])||"object"!==vn(s[l])||Cn(r[l])||Cn(s[l])?el(s[l]):tl(r[l],s[l]))}}catch(t){a.e(t)}finally{a.f()}return r}function el(t){return Cn(t)?oo(t).call(t,function(t){return el(t)}):"object"===vn(t)&&null!==t?tl({},t):t}function il(t){for(var e=0,i=go(t);e<i.length;e++){var n=i[e];t[n]===Qa?delete t[n]:"object"===vn(t[n])&&null!==t[n]&&il(t[n])}}function nl(t){var e=function(t,e){return function(t){if(Mo(t))return t}(t)||function(t,e){var i=t&&(void 0!==zi&&Po(t)||t["@@iterator"]);if(null!=i){var n,o,r=[],s=!0,a=!1;try{for(i=i.call(t);!(s=(n=i.next()).done)&&(r.push(n.value),3!==r.length);s=!0);}catch(t){a=!0,o=t}finally{try{s||null==i.return||i.return()}finally{if(a)throw o}}return r}}(t)||Wo(t,3)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(function(){for(var t=ol(),e=t(" "),i=t(" "),n=t(" "),o=0;o<arguments.length;o++)(e-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(e+=1),(i-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(i+=1),(n-=t(o<0||arguments.length<=o?void 0:arguments[o]))<0&&(n+=1);return[e,i,n]}(t)),i=e[0],n=e[1],o=e[2],r=1,s=function(){var t=2091639*i+2.3283064365386963e-10*r;return i=n,n=o,o=t-(r=0|t)};return s.uint32=function(){return 4294967296*s()},s.fract53=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.algorithm="Alea",s.seed=t,s.version="0.9",s}function ol(){var t=4022871197;return function(e){for(var i=e.toString(),n=0;n<i.length;n++){var o=.02519603282416938*(t+=i.charCodeAt(n));o-=t=o>>>0,t=(o*=t)>>>0,t+=4294967296*(o-=t)}return 2.3283064365386963e-10*(t>>>0)}}var rl="undefined"!=typeof window?window.Hammer||Ga:function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(){return{set:t}}};var t};function sl(t){var e,i=this;this._cleanupQueue=[],this.active=!1,this._dom={container:t,overlay:document.createElement("div")},this._dom.overlay.classList.add("vis-overlay"),this._dom.container.appendChild(this._dom.overlay),this._cleanupQueue.push(function(){i._dom.overlay.parentNode.removeChild(i._dom.overlay)});var n=rl(this._dom.overlay);n.on("tap",An(e=this._onTapOverlay).call(e,this)),this._cleanupQueue.push(function(){n.destroy()});var o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Bn(o).call(o,function(t){n.on(t,function(t){t.srcEvent.stopPropagation()})}),document&&document.body&&(this._onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||i.deactivate()},document.body.addEventListener("click",this._onClick),this._cleanupQueue.push(function(){document.body.removeEventListener("click",i._onClick)})),this._escListener=function(t){("key"in t?"Escape"===t.key:27===t.keyCode)&&i.deactivate()}}ls(sl.prototype),sl.current=null,sl.prototype.destroy=function(){var t,e;this.deactivate();var i,n=Xa(function(t){var e=t.reverse;return t===er||t instanceof Array&&e===er.reverse?tr:e}(t=cr(e=this._cleanupQueue).call(e,0)).call(t));try{for(n.s();!(i=n.n()).done;)(0,i.value)()}catch(t){n.e(t)}finally{n.f()}},sl.prototype.activate=function(){sl.current&&sl.current.deactivate(),sl.current=this,this.active=!0,this._dom.overlay.style.display="none",this._dom.container.classList.add("vis-active"),this.emit("change"),this.emit("activate"),document.body.addEventListener("keydown",this._escListener)},sl.prototype.deactivate=function(){this.active=!1,this._dom.overlay.style.display="block",this._dom.container.classList.remove("vis-active"),document.body.removeEventListener("keydown",this._escListener),this.emit("change"),this.emit("deactivate")},sl.prototype._onTapOverlay=function(t){this.activate(),t.srcEvent.stopPropagation()};var al=/^\/?Date\((-?\d+)/i,ll=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,cl=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,hl=/^rgb\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *\)$/i,dl=/^rgba\( *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *(1?\d{1,2}|2[0-4]\d|25[0-5]) *, *([01]|0?\.\d+) *\)$/i;function ul(t){return t instanceof Number||"number"==typeof t}function fl(t){return t instanceof String||"string"==typeof t}function pl(t){return"object"===vn(t)&&null!==t}function gl(t,e,i,n){var o=!1;!0===n&&(o=null===e[i]&&void 0!==t[i]),o?delete t[i]:t[i]=e[i]}var ml=fr;function vl(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)||!0===i)if("object"===vn(e[o])&&null!==e[o]&&xr(e[o])===Object.prototype)void 0===t[o]?t[o]=vl({},e[o],i):"object"===vn(t[o])&&null!==t[o]&&xr(t[o])===Object.prototype?vl(t[o],e[o],i):gl(t,e,o,n);else if(Cn(e[o])){var r;t[o]=$o(r=e[o]).call(r)}else gl(t,e,o,n);return t}function yl(t){var e=vn(t);return"object"===e?null===t?"null":t instanceof Boolean?"Boolean":t instanceof Number?"Number":t instanceof String?"String":Cn(t)?"Array":t instanceof Date?"Date":"Object":"number"===e?"Number":"boolean"===e?"Boolean":"string"===e?"String":void 0===e?"undefined":e}function bl(t,e){var i;return Zo(i=[]).call(i,qo(t),[e])}function wl(t){return $o(t).call(t)}var kl=Sr,_l={asBoolean:function(t,e){return"function"==typeof t&&(t=t()),null!=t?0!=t:e||null},asNumber:function(t,e){return"function"==typeof t&&(t=t()),null!=t?Number(t)||e||null:e||null},asString:function(t,e){return"function"==typeof t&&(t=t()),null!=t?String(t):e||null},asSize:function(t,e){return"function"==typeof t&&(t=t()),fl(t)?t:ul(t)?t+"px":e||null},asElement:function(t,e){return"function"==typeof t&&(t=t()),t||e||null}};function xl(t){var e;switch(t.length){case 3:case 4:return(e=cl.exec(t))?{r:Lr(e[1]+e[1],16),g:Lr(e[2]+e[2],16),b:Lr(e[3]+e[3],16)}:null;case 6:case 7:return(e=ll.exec(t))?{r:Lr(e[1],16),g:Lr(e[2],16),b:Lr(e[3],16)}:null;default:return null}}function Cl(t,e,i){var n;return"#"+$o(n=((1<<24)+(t<<16)+(e<<8)+i).toString(16)).call(n,1)}function El(t,e,i){t/=255,e/=255,i/=255;var n=Math.min(t,Math.min(e,i)),o=Math.max(t,Math.max(e,i));return n===o?{h:0,s:0,v:n}:{h:60*((t===n?3:i===n?1:5)-(t===n?e-i:i===n?t-e:i-t)/(o-n))/360,s:(o-n)/o,v:o}}var Tl=function(t){var e,i={};return Bn(e=t.split(";")).call(e,function(t){if(""!=Xr(t).call(t)){var e,n,o=t.split(":"),r=Xr(e=o[0]).call(e),s=Xr(n=o[1]).call(n);i[r]=s}}),i},Sl=function(t){var e;return oo(e=go(t)).call(e,function(e){return e+": "+t[e]}).join("; ")};function Al(t,e,i){var n,o,r,s=Math.floor(6*t),a=6*t-s,l=i*(1-e),c=i*(1-a*e),h=i*(1-(1-a)*e);switch(s%6){case 0:n=i,o=h,r=l;break;case 1:n=c,o=i,r=l;break;case 2:n=l,o=i,r=h;break;case 3:n=l,o=c,r=i;break;case 4:n=h,o=l,r=i;break;case 5:n=i,o=l,r=c}return{r:Math.floor(255*n),g:Math.floor(255*o),b:Math.floor(255*r)}}function Ol(t,e,i){var n=Al(t,e,i);return Cl(n.r,n.g,n.b)}function Il(t){var e=xl(t);if(!e)throw new TypeError("'".concat(t,"' is not a valid color."));return El(e.r,e.g,e.b)}function Pl(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}function Ml(t){return hl.test(t)}function Dl(t){return dl.test(t)}function Nl(t){if(null===t||"object"!==vn(t))return null;if(t instanceof Element)return t;var e=Kr(t);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&"object"==vn(t[i])&&(e[i]=Nl(t[i]));return e}var Rl={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},zl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;zt(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return jt(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=t}},{key:"setCloseCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=t}},{key:"_isColorString",value:function(t){if("string"==typeof t)return Rl[t]}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==t){var i,n=this._isColorString(t);if(void 0!==n&&(t=n),!0===fl(t)){if(!0===Ml(t)){var o=t.substr(4).substr(0,t.length-5).split(",");i={r:o[0],g:o[1],b:o[2],a:1}}else if(!0===Dl(t)){var r=t.substr(5).substr(0,t.length-6).split(",");i={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===Pl(t)){var s=xl(t);i={r:s.r,g:s.g,b:s.b,a:1}}}else t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&(i={r:t.r,g:t.g,b:t.b,a:void 0!==t.a?t.a:"1.0"});if(void 0===i)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+os(t));this._setColor(i,e)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this;!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.previousColor=fr({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",Mn(function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){!0===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.initialColor=fr({},t)),this.color=t;var e=El(t.r,t.g,t.b),i=2*Math.PI,n=this.r*e.s,o=this.centerCoordinates.x+n*Math.sin(i*e.h),r=this.centerCoordinates.y+n*Math.cos(i*e.h);this.colorPickerSelector.style.left=o-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=r-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=El(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=Al(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=El(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),i.clearRect(0,0,this.colorPickerCanvas.clientWidth,this.colorPickerCanvas.clientHeight),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),as(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var t,e,i,n;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var o=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerText="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerText="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerText="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerText="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerText="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerText="cancel",this.cancelButton.onclick=An(t=this._hide).call(t,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerText="apply",this.applyButton.onclick=An(e=this._apply).call(e,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerText="save",this.saveButton.onclick=An(i=this._save).call(i,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerText="load last",this.loadButton.onclick=An(n=this._loadLast).call(n,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new rl(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),this.hammer.on("hammer.input",function(e){e.isFirst&&t._moveSelector(e)}),this.hammer.on("tap",function(e){t._moveSelector(e)}),this.hammer.on("panstart",function(e){t._moveSelector(e)}),this.hammer.on("panmove",function(e){t._moveSelector(e)}),this.hammer.on("panend",function(e){t._moveSelector(e)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var e,i,n,o,r=this.colorPickerCanvas.clientWidth,s=this.colorPickerCanvas.clientHeight;t.clearRect(0,0,r,s),this.centerCoordinates={x:.5*r,y:.5*s},this.r=.49*r;var a,l=2*Math.PI/360,c=1/this.r;for(n=0;n<360;n++)for(o=0;o<this.r;o++)e=this.centerCoordinates.x+o*Math.sin(l*n),i=this.centerCoordinates.y+o*Math.cos(l*n),a=Al(.002777777777777778*n,o*c,1),t.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",t.fillRect(e-.5,i-.5,2,2);t.strokeStyle="rgba(0,0,0,1)",t.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),t.stroke(),this.hueCircle=t.getImageData(0,0,r,s)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=.5*this.colorPickerDiv.clientHeight,n=.5*this.colorPickerDiv.clientWidth,o=t.center.x-e.left-n,r=t.center.y-e.top-i,s=Math.atan2(o,r),a=.98*Math.min(Math.sqrt(o*o+r*r),n),l=Math.cos(s)*a+i,c=Math.sin(s)*a+n;this.colorPickerSelector.style.top=l-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=c-.5*this.colorPickerSelector.clientWidth+"px";var h=s/(2*Math.PI);h=h<0?h+1:h;var d=a/this.r,u=El(this.color.r,this.color.g,this.color.b);u.h=h,u.s=d;var f=Al(u.h,u.s,u.v);f.a=this.color.a,this.color=f,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}();function Fl(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];if(e.length<1)throw new TypeError("Invalid arguments.");if(1===e.length)return document.createTextNode(e[0]);var n=document.createElement(e[0]);return n.appendChild(Fl.apply(void 0,qo($o(e).call(e,1)))),n}var Ll,Bl=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){return!1};zt(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.hideOption=r,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},fr(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new zl(o),this.wrapper=void 0}return jt(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(Cn(t))this.options.filter=t.join();else if("object"===vn(t)){if(null==t)throw new TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==Yn(t)&&(this.options.filter=Yn(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===Yn(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=Yn(this.options),e=0,i=!1;for(var n in this.configureOptions)Object.prototype.hasOwnProperty.call(this.configureOptions,n)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):!0!==t&&-1===Yr(t).call(t,n)||(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++){if(void 0===e[t[i]]){e=void 0;break}e=e[t[i]]}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Bn(n).call(n,function(t){e.appendChild(t)}),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerText=t,this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");if(n.className="vis-configuration vis-config-label vis-config-s"+e.length,!0===i){for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(Fl("i","b",t))}else n.innerText=t+":";return n}},{key:"_makeDropdown",value:function(t,e,i){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var o=0;void 0!==e&&-1!==Yr(t).call(t,e)&&(o=Yr(t).call(t,e));for(var r=0;r<t.length;r++){var s=document.createElement("option");s.value=t[r],r===o&&(s.selected="selected"),s.innerText=t[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,n)}},{key:"_makeRange",value:function(t,e,i){var n=t[0],o=t[1],r=t[2],s=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=o,a.max=r}catch(t){}a.step=s;var l="",c=0;if(void 0!==e){var h=1.2;e<0&&e*h<o?(a.min=Math.ceil(e*h),c=a.min,l="range increased"):e/h<o&&(a.min=Math.ceil(e/h),c=a.min,l="range increased"),e*h>r&&1!==r&&(a.max=Math.ceil(e*h),c=a.max,l="range increased"),a.value=e}else a.value=n;var d=document.createElement("input");d.className="vis-configuration vis-config-rangeinput",d.value=a.value;var u=this;a.onchange=function(){d.value=this.value,u._update(Number(this.value),i)},a.oninput=function(){d.value=this.value};var f=this._makeLabel(i[i.length-1],i),p=this._makeItem(i,f,a,d);""!==l&&this.popupHistory[p]!==c&&(this.popupHistory[p]=c,this._setupPopup(l,p))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerText="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerText=t,n.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=Mn(function(){t.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=Mn(function(){t._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=t,void 0!==e&&(n.checked=e,e!==t&&("object"===vn(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var o=this;n.onchange=function(){o._update(this.checked,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeTextInput",value:function(t,e,i){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var o=this;n.onchange=function(){o._update(this.value,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeColorField",value:function(t,e,i){var n=this,o=t[1],r=document.createElement("div");"none"!==(e=void 0===e?o:e)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=e):r.className="vis-configuration vis-config-colorBlock none",e=void 0===e?o:e,r.onclick=function(){n._showColorPicker(e,r,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,r)}},{key:"_showColorPicker",value:function(t,e,i){var n=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback(function(t){var o="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=o,n._update(o,i)}),this.colorPicker.setCloseCallback(function(){e.onclick=function(){n._showColorPicker(t,e,i)}})}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=Yn(this.options),r=!1;for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){n=!0;var a=t[s],l=bl(e,s);if("function"==typeof o&&!1===(n=o(s,e))&&!Cn(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==n){r=!0;var c=this._getValue(l);if(Cn(a))this._handleArray(a,c,l);else if("string"==typeof a)this._makeTextInput(a,c,l);else if("boolean"==typeof a)this._makeCheckbox(a,c,l);else if(a instanceof Object){if(!this.hideOption(e,s,this.moduleOptions))if(void 0!==a.enabled){var h=bl(l,"enabled"),d=this._getValue(h);if(!0===d){var u=this._makeLabel(s,l,!0);this._makeItem(l,u),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,d,l)}else{var f=this._makeLabel(s,l,!0);this._makeItem(l,f),r=this._handleObject(a,l)||r}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i;t="false"!==(t="true"===t||t)&&t;for(var o=0;o<e.length;o++)"global"!==e[o]&&(void 0===n[e[o]]&&(n[e[o]]={}),o!==e.length-1?n=n[e[o]]:n[e[o]]=t);return i}},{key:"_printOptions",value:function(){for(var t=this.getOptions();this.optionsContainer.firstChild;)this.optionsContainer.removeChild(this.optionsContainer.firstChild);this.optionsContainer.appendChild(Fl("pre","const options = "+os(t,null,2)))}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),jl=!1,Vl="background: #FFeeee; color: #dd0000",Hl=sl,Wl=zl,ql=Bl,Ul=rl,Yl=function(){function t(e,i){zt(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return jt(t,[{key:"setPosition",value:function(t,e){this.x=Lr(t),this.y=Lr(e)}},{key:"setText",value:function(t){if(t instanceof Element){for(;this.frame.firstChild;)this.frame.removeChild(this.frame.firstChild);this.frame.appendChild(t)}else this.frame.innerText=t}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod){var a=!1,l=!0;this.y-e<this.padding&&(l=!1),this.x+i>o-this.padding&&(a=!0),r=a?this.x-i:this.x,s=l?this.y-e:this.y}else(s=this.y-e)+e+this.padding>n&&(s=n-e-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+i+this.padding>o&&(r=o-i-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),Gl=function(){function t(){zt(this,t)}return jt(t,null,[{key:"validate",value:function(e,i,n){jl=!1,Ll=i;var o=i;return void 0!==n&&(o=i[n]),t.parse(e,o,[]),jl}},{key:"parse",value:function(e,i,n){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.check(o,e,i,n)}},{key:"check",value:function(e,i,n,o){if(void 0!==n[e]||void 0!==n.__any__){var r=e,s=!0;void 0===n[e]&&void 0!==n.__any__&&(r="__any__",s="object"===t.getType(i[e]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,n,r,a,o)}else t.getSuggestion(e,n,o)}},{key:"checkFields",value:function(e,i,n,o,r,s){var a=function(i){console.error("%c"+i+t.printLocation(s,e),Vl)},l=t.getType(i[e]),c=r[l];void 0!==c?"array"===t.getType(c)&&-1===Yr(c).call(c,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(c)+' not "'+i[e]+'". '),jl=!0):"object"===l&&"__any__"!==o&&(s=bl(s,e),t.parse(i[e],n[o],s)):void 0===r.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(go(r))+". Received ["+l+'] "'+i[e]+'"'),jl=!0)}},{key:"getType",value:function(t){var e=vn(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Cn(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,n){var o,r=t.findInOptions(e,i,n,!1),s=t.findInOptions(e,Ll,[],!0);o=void 0!==r.indexMatch?" in "+t.printLocation(r.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+t.printLocation(r.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+t.printLocation(r.path,e):". Did you mean one of these: "+t.print(go(i))+t.printLocation(n,e),console.error('%cUnknown option detected: "'+e+'"'+o,Vl),jl=!0}},{key:"findInOptions",value:function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=e.toLowerCase(),c=void 0;for(var h in i){var d=void 0;if(void 0!==i[h].__type__&&!0===o){var u=t.findInOptions(e,i[h],bl(n,h));r>u.distance&&(s=u.closestMatch,a=u.path,r=u.distance,c=u.indexMatch)}else{var f;-1!==Yr(f=h.toLowerCase()).call(f,l)&&(c=h),r>(d=t.levenshteinDistance(e,h))&&(s=h,a=wl(n),r=d)}}return{closestMatch:s,path:a,distance:r,indexMatch:c}}},{key:"printLocation",value:function(t,e){for(var i="\n\n"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n")+"options = {\n",n=0;n<t.length;n++){for(var o=0;o<n+1;o++)i+="  ";i+=t[n]+": {\n"}for(var r=0;r<t.length+1;r++)i+="  ";i+=e+"\n";for(var s=0;s<t.length+1;s++){for(var a=0;a<t.length-s;a++)i+="  ";i+="}\n"}return i+"\n\n"}},{key:"print",value:function(t){return os(t).replace(/(")|(\[)|(\])|(,"__type__")/g,"").replace(/(,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n,o=[];for(i=0;i<=e.length;i++)o[i]=[i];for(n=0;n<=t.length;n++)o[0][n]=n;for(i=1;i<=e.length;i++)for(n=1;n<=t.length;n++)o[i][n]=e.charAt(i-1)==t.charAt(n-1)?o[i-1][n-1]:Math.min(o[i-1][n-1]+1,Math.min(o[i][n-1]+1,o[i-1][n]+1));return o[e.length][t.length]}}]),t}(),Zl=Object.freeze({__proto__:null,Activator:Hl,Alea:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return nl(e.length?e:[Ko()])},ColorPicker:Wl,Configurator:ql,DELETE:Qa,HSVToHex:Ol,HSVToRGB:Al,Hammer:Ul,Popup:Yl,RGBToHSV:El,RGBToHex:Cl,VALIDATOR_PRINT_STYLE:"background: #FFeeee; color: #dd0000",Validator:Gl,addClassName:function(t,e){var i=t.className.split(" "),n=e.split(" ");i=Zo(i).call(i,Yn(n).call(n,function(t){return!_r(i).call(i,t)})),t.className=i.join(" ")},addCssText:function(t,e){var i=Tl(t.style.cssText),n=Tl(e),o=$a($a({},i),n);t.style.cssText=Sl(o)},addEventListener:function(t,e,i,n){var o;t.addEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&_r(o=navigator.userAgent).call(o,"Firefox")&&(e="DOMMouseScroll"),t.addEventListener(e,i,n)):t.attachEvent("on"+e,i)},binarySearchCustom:function(t,e,i,n){for(var o=0,r=0,s=t.length-1;r<=s&&o<1e4;){var a=Math.floor((r+s)/2),l=t[a],c=e(void 0===n?l[i]:l[i][n]);if(0==c)return a;-1==c?r=a+1:s=a-1,o++}return-1},binarySearchValue:function(t,e,i,n,o){var r,s,a,l,c=0,h=0,d=t.length-1;for(o=null!=o?o:function(t,e){return t==e?0:t<e?-1:1};h<=d&&c<1e4;){if(l=Math.floor(.5*(d+h)),r=t[Math.max(0,l-1)][i],s=t[l][i],a=t[Math.min(t.length-1,l+1)][i],0==o(s,e))return l;if(o(r,e)<0&&o(s,e)>0)return"before"==n?Math.max(0,l-1):l;if(o(s,e)<0&&o(a,e)>0)return"before"==n?l:Math.min(t.length-1,l+1);o(s,e)<0?h=l+1:d=l-1,c++}return-1},bridgeObject:Nl,copyAndExtendArray:bl,copyArray:wl,deepExtend:vl,deepObjectAssign:Ja,easingFunctions:{linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},equalArray:function(t,e){if(t.length!==e.length)return!1;for(var i=0,n=t.length;i<n;i++)if(t[i]!=e[i])return!1;return!0},extend:ml,fillIfDefined:function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var o in e)if(void 0!==i[o])if(null===i[o]||"object"!==vn(i[o]))gl(e,i,o,n);else{var r=e[o],s=i[o];pl(r)&&pl(s)&&t(r,s,n)}},forEach:function(t,e){if(Cn(t))for(var i=t.length,n=0;n<i;n++)e(t[n],n,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e(t[o],o,t)},getAbsoluteLeft:function(t){return t.getBoundingClientRect().left},getAbsoluteRight:function(t){return t.getBoundingClientRect().right},getAbsoluteTop:function(t){return t.getBoundingClientRect().top},getScrollBarWidth:function(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var i=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return i==n&&(n=e.clientWidth),document.body.removeChild(e),i-n},getTarget:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,e=null;return t&&(t.target?e=t.target:t.srcElement&&(e=t.srcElement)),e instanceof Element&&(null==e.nodeType||3!=e.nodeType||(e=e.parentNode)instanceof Element)?e:null},getType:yl,hasParent:function(t,e){for(var i=t;i;){if(i===e)return!0;if(!i.parentNode)return!1;i=i.parentNode}return!1},hexToHSV:Il,hexToRGB:xl,insertSort:function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=void 0;for(o=i;o>0&&e(n,t[o-1])<0;o--)t[o]=t[o-1];t[o]=n}return t},isDate:function(t){if(t instanceof Date)return!0;if(fl(t)){if(al.exec(t))return!0;if(!isNaN(Date.parse(t)))return!0}return!1},isNumber:ul,isObject:pl,isString:fl,isValidHex:Pl,isValidRGB:Ml,isValidRGBA:Dl,mergeOptions:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=function(t){return null!=t},r=function(t){return null!==t&&"object"===vn(t)},s=function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0};if(!r(t))throw new Error("Parameter mergeTarget must be an object");if(!r(e))throw new Error("Parameter options must be an object");if(!o(i))throw new Error("Parameter option must have a value");if(!r(n))throw new Error("Parameter globalOptions must be an object");var a=function(t,e,i){r(t[i])||(t[i]={});var n=e[i],o=t[i];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(o[s]=n[s])},l=e[i],c=r(n)&&!s(n)?n[i]:void 0,h=c?c.enabled:void 0;if(void 0!==l){if("boolean"==typeof l)return r(t[i])||(t[i]={}),void(t[i].enabled=l);if(null===l&&!r(t[i])){if(!o(c))return;t[i]=Kr(c)}if(r(l)){var d=!0;void 0!==l.enabled?d=l.enabled:void 0!==h&&(d=c.enabled),a(t,e,i),t[i].enabled=d}}},option:_l,overrideOpacity:function(t,e){if(_r(t).call(t,"rgba"))return t;if(_r(t).call(t,"rgb")){var i=t.substr(Yr(t).call(t,"(")+1).replace(")","").split(",");return"rgba("+i[0]+","+i[1]+","+i[2]+","+e+")"}var n=xl(t);return null==n?t:"rgba("+n.r+","+n.g+","+n.b+","+e+")"},parseColor:function(t,e){if(fl(t)){var i=t;if(Ml(i)){var n,o=oo(n=i.substr(4).substr(0,i.length-5).split(",")).call(n,function(t){return Lr(t)});i=Cl(o[0],o[1],o[2])}if(!0===Pl(i)){var r=Il(i),s={h:r.h,s:.8*r.s,v:Math.min(1,1.02*r.v)},a={h:r.h,s:Math.min(1,1.25*r.s),v:.8*r.v},l=Ol(a.h,a.s,a.v),c=Ol(s.h,s.s,s.v);return{background:i,border:l,highlight:{background:c,border:l},hover:{background:c,border:l}}}return{background:i,border:i,highlight:{background:i,border:i},hover:{background:i,border:i}}}return e?{background:t.background||e.background,border:t.border||e.border,highlight:fl(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||e.highlight.background,border:t.highlight&&t.highlight.border||e.highlight.border},hover:fl(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||e.hover.border,background:t.hover&&t.hover.background||e.hover.background}}:{background:t.background||void 0,border:t.border||void 0,highlight:fl(t.highlight)?{border:t.highlight,background:t.highlight}:{background:t.highlight&&t.highlight.background||void 0,border:t.highlight&&t.highlight.border||void 0},hover:fl(t.hover)?{border:t.hover,background:t.hover}:{border:t.hover&&t.hover.border||void 0,background:t.hover&&t.hover.background||void 0}}},preventDefault:function(t){t||(t=window.event),t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},pureDeepObjectAssign:function(t){for(var e,i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Ja.apply(void 0,Zo(e=[{},t]).call(e,n))},recursiveDOMDelete:function t(e){if(e)for(;!0===e.hasChildNodes();){var i=e.firstChild;i&&(t(i),e.removeChild(i))}},removeClassName:function(t,e){var i=t.className.split(" "),n=e.split(" ");i=Yn(i).call(i,function(t){return!_r(n).call(n,t)}),t.className=i.join(" ")},removeCssText:function(t,e){var i=Tl(t.style.cssText),n=Tl(e);for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&delete i[o];t.style.cssText=Sl(i)},removeEventListener:function(t,e,i,n){var o;t.removeEventListener?(void 0===n&&(n=!1),"mousewheel"===e&&_r(o=navigator.userAgent).call(o,"Firefox")&&(e="DOMMouseScroll"),t.removeEventListener(e,i,n)):t.detachEvent("on"+e,i)},selectiveBridgeObject:function(t,e){if(null!==e&&"object"===vn(e)){for(var i=Kr(e),n=0;n<t.length;n++)Object.prototype.hasOwnProperty.call(e,t[n])&&"object"==vn(e[t[n]])&&(i[t[n]]=Nl(e[t[n]]));return i}return null},selectiveDeepExtend:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Cn(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o=0;o<t.length;o++){var r=t[o];if(Object.prototype.hasOwnProperty.call(i,r))if(i[r]&&i[r].constructor===Object)void 0===e[r]&&(e[r]={}),e[r].constructor===Object?vl(e[r],i[r],!1,n):gl(e,i,r,n);else{if(Cn(i[r]))throw new TypeError("Arrays are not supported by deepExtend");gl(e,i,r,n)}}return e},selectiveExtend:function(t,e){if(!Cn(t))throw new Error("Array with property names expected as first argument");for(var i=arguments.length,n=new Array(i>2?i-2:0),o=2;o<i;o++)n[o-2]=arguments[o];for(var r=0,s=n;r<s.length;r++)for(var a=s[r],l=0;l<t.length;l++){var c=t[l];a&&Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e},selectiveNotDeepExtend:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Cn(i))throw new TypeError("Arrays are not supported by deepExtend");for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)&&!_r(t).call(t,o))if(i[o]&&i[o].constructor===Object)void 0===e[o]&&(e[o]={}),e[o].constructor===Object?vl(e[o],i[o]):gl(e,i,o,n);else if(Cn(i[o])){e[o]=[];for(var r=0;r<i[o].length;r++)e[o].push(i[o][r])}else gl(e,i,o,n);return e},throttle:function(t){var e=!1;return function(){e||(e=!0,requestAnimationFrame(function(){e=!1,t()}))}},toArray:kl,topMost:function(t,e){var i;Cn(e)||(e=[e]);var n,o=Xa(t);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r){i=r[e[0]];for(var s=1;s<e.length;s++)i&&(i=i[e[s]]);if(void 0!==i)break}}}catch(t){o.e(t)}finally{o.f()}return i},updateProperty:function(t,e,i){return t[e]!==i&&(t[e]=i,!0)}});var $l=/javascript\s*\:/gim,Xl={whiteList:{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},getDefaultWhiteList:function(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}},onAttr:function(t,e,i){},onIgnoreAttr:function(t,e,i){},safeAttrValue:function(t,e){return $l.test(e)?"":e}},Kl=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")};function Ql(t){return null==t}function Jl(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||Xl.whiteList,t.onAttr=t.onAttr||Xl.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Xl.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Xl.safeAttrValue,this.options=t}Jl.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onAttr,o=e.onIgnoreAttr,r=e.safeAttrValue;return function(t,e){";"!==(t=function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")}(t))[t.length-1]&&(t+=";");var i=t.length,n=!1,o=0,r=0,s="";function a(){if(!n){var i=Kl(t.slice(o,r)),a=i.indexOf(":");if(-1!==a){var l=Kl(i.slice(0,a)),c=Kl(i.slice(a+1));if(l){var h=e(o,s.length,l,c,i);h&&(s+=h+"; ")}}}o=r+1}for(;r<i;r++){var l=t[r];if("/"===l&&"*"===t[r+1]){var c=t.indexOf("*/",r+2);if(-1===c)break;o=(r=c+1)+1,n=!1}else"("===l?n=!0:")"===l?n=!1:";"===l?n||a():"\n"===l&&a()}return Kl(s)}(t,function(t,e,s,a,l){var c=i[s],h=!1;if(!0===c?h=c:"function"==typeof c?h=c(a):c instanceof RegExp&&(h=c.test(a)),!0!==h&&(h=!1),a=r(s,a)){var d,u={position:e,sourcePosition:t,source:l,isWhite:h};return h?Ql(d=n(s,a,u))?s+":"+a:d:Ql(d=o(s,a,u))?void 0:d}})};var tc=Jl,ec=r(function(t,e){for(var i in(e=t.exports=function(t,e){return new tc(e).process(t)}).FilterCSS=tc,Xl)e[i]=Xl[i];"undefined"!=typeof window&&(window.filterCSS=t.exports)}),ic=function(t,e){var i,n;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1},nc=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},oc=function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1},rc=ec.getDefaultWhiteList,sc=new(0,ec.FilterCSS);function ac(t){return t.replace(lc,"&lt;").replace(cc,"&gt;")}var lc=/</g,cc=/>/g,hc=/"/g,dc=/&quot;/g,uc=/&#([a-zA-Z0-9]*);?/gim,fc=/&colon;?/gim,pc=/&newline;?/gim,gc=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,mc=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,vc=/u\s*r\s*l\s*\(.*/gi;function yc(t){return t.replace(hc,"&quot;")}function bc(t){return t.replace(dc,'"')}function wc(t){return t.replace(uc,function(t,e){return String.fromCharCode("x"===e[0]||"X"===e[0]?parseInt(e.substr(1),16):parseInt(e,10))})}function kc(t){return t.replace(fc,":").replace(pc," ")}function _c(t){for(var e="",i=0,n=t.length;i<n;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return nc(e)}function xc(t){return _c(t=kc(t=wc(t=bc(t))))}function Cc(t){return ac(t=yc(t))}var Ec=/<!--[\s\S]*?-->/g,Tc={whiteList:{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},getDefaultWhiteList:function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},onTag:function(t,e,i){},onIgnoreTag:function(t,e,i){},onTagAttr:function(t,e,i){},onIgnoreTagAttr:function(t,e,i){},safeAttrValue:function(t,e,i,n){if(i=xc(i),"href"===e||"src"===e){if("#"===(i=nc(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(gc.lastIndex=0,gc.test(i))return""}else if("style"===e){if(mc.lastIndex=0,mc.test(i))return"";if(vc.lastIndex=0,vc.test(i)&&(gc.lastIndex=0,gc.test(i)))return"";!1!==n&&(i=(n=n||sc).process(i))}return Cc(i)},escapeHtml:ac,escapeQuote:yc,unescapeQuote:bc,escapeHtmlEntities:wc,escapeDangerHtml5Entities:kc,clearNonPrintableCharacter:_c,friendlyAttrValue:xc,escapeAttrValue:Cc,onIgnoreTagStripAll:function(){return""},StripTagBody:function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),n=[],o=!1;return{onIgnoreTag:function(r,s,a){if(function(e){return!!i||-1!==ic(t,e)}(r)){if(a.isClosing){var l="[/removed]";return n.push([!1!==o?o:a.position,a.position+l.length]),o=!1,l}return o||(o=a.position),"[removed]"}return e(r,s,a)},remove:function(t){var e="",i=0;return function(t,e,i){var n,o;if(Array.prototype.forEach)return t.forEach(e,i);for(n=0,o=t.length;n<o;n++)e.call(i,t[n],n,t)}(n,function(n){e+=t.slice(i,n[0]),i=n[1]}),e+=t.slice(i)}}},stripCommentTag:function(t){return t.replace(Ec,"")},stripBlankChar:function(t){var e=t.split("");return(e=e.filter(function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)})).join("")},cssFilter:sc,getDefaultCSSWhiteList:rc};function Sc(t){var e=oc(t);if(-1===e)var i=t.slice(1,-1);else i=t.slice(1,e+1);return"/"===(i=nc(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function Ac(t){return"</"===t.slice(0,2)}var Oc=/[^a-zA-Z0-9_:\.\-]/gim;function Ic(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function Pc(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function Mc(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}var Dc={parseTag:function(t,e,i){var n="",o=0,r=!1,s=!1,a=0,l=t.length,c="",h="";t:for(a=0;a<l;a++){var d=t.charAt(a);if(!1===r){if("<"===d){r=a;continue}}else if(!1===s){if("<"===d){n+=i(t.slice(o,a)),r=a,o=a;continue}if(">"===d){n+=i(t.slice(o,r)),c=Sc(h=t.slice(r,a+1)),n+=e(r,n.length,c,h,Ac(h)),o=a+1,r=!1;continue}if('"'===d||"'"===d)for(var u=1,f=t.charAt(a-u);""===f.trim()||"="===f;){if("="===f){s=d;continue t}f=t.charAt(a-++u)}}else if(d===s){s=!1;continue}}return o<t.length&&(n+=i(t.substr(o))),n},parseAttr:function(t,e){var i=0,n=[],o=!1,r=t.length;function s(t,i){if(!((t=(t=nc(t)).replace(Oc,"").toLowerCase()).length<1)){var o=e(t,i||"");o&&n.push(o)}}for(var a=0;a<r;a++){var l,c=t.charAt(a);if(!1!==o||"="!==c)if(!1===o||a!==i||'"'!==c&&"'"!==c||"="!==t.charAt(a-1)){if(/\s|\n|\t/.test(c)){if(t=t.replace(/\s|\n|\t/g," "),!1===o){if(-1===(l=Ic(t,a))){s(nc(t.slice(i,a))),o=!1,i=a+1;continue}a=l-1;continue}if(-1===(l=Pc(t,a-1))){s(o,Mc(nc(t.slice(i,a)))),o=!1,i=a+1;continue}}}else{if(-1===(l=t.indexOf(c,a+1)))break;s(o,nc(t.slice(i+1,l))),o=!1,i=(a=l)+1}else o=t.slice(i,a),i=a+1}return i<t.length&&(!1===o?s(t.slice(i)):s(o,Mc(nc(t.slice(i))))),nc(n.join(" "))}},Nc=ec.FilterCSS,Rc=Dc.parseTag,zc=Dc.parseAttr;function Fc(t){return null==t}function Lc(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=Tc.onIgnoreTagStripAll),t.whiteList=t.whiteList||Tc.whiteList,t.onTag=t.onTag||Tc.onTag,t.onTagAttr=t.onTagAttr||Tc.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||Tc.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||Tc.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||Tc.safeAttrValue,t.escapeHtml=t.escapeHtml||Tc.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new Nc(t.css))}Lc.prototype.process=function(t){if(!(t=(t=t||"").toString()))return"";var e=this.options,i=e.whiteList,n=e.onTag,o=e.onIgnoreTag,r=e.onTagAttr,s=e.onIgnoreTagAttr,a=e.safeAttrValue,l=e.escapeHtml,c=this.cssFilter;e.stripBlankChar&&(t=Tc.stripBlankChar(t)),e.allowCommentTag||(t=Tc.stripCommentTag(t));var h=!1;e.stripIgnoreTagBody&&(h=Tc.StripTagBody(e.stripIgnoreTagBody,o),o=h.onIgnoreTag);var d=Rc(t,function(t,e,h,d,u){var f,p={sourcePosition:t,position:e,isClosing:u,isWhite:i.hasOwnProperty(h)};if(!Fc(f=n(h,d,p)))return f;if(p.isWhite){if(p.isClosing)return"</"+h+">";var g=function(t){var e=oc(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=nc(t.slice(e+1,-1)))[t.length-1];return i&&(t=nc(t.slice(0,-1))),{html:t,closing:i}}(d),m=i[h],v=zc(g.html,function(t,e){var i,n=-1!==ic(m,t);return Fc(i=r(h,t,e,n))?n?(e=a(h,t,e,c))?t+'="'+e+'"':t:Fc(i=s(h,t,e,n))?void 0:i:i});return d="<"+h,v&&(d+=" "+v),g.closing&&(d+=" /"),d+">"}return Fc(f=o(h,d,p))?l(d):f},l);return h&&(d=h.remove(d)),d};var Bc=Lc,jc=r(function(t,e){function i(t,e){return new Bc(e).process(t)}for(var n in(e=t.exports=i).filterXSS=i,e.FilterXSS=Bc,Tc)e[n]=Tc[n];for(var n in Dc)e[n]=Dc[n];"undefined"!=typeof window&&(window.filterXSS=t.exports),"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=t.exports)}),Vc="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Hc=new Uint8Array(16);function Wc(){if(!Vc)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vc(Hc)}for(var qc=[],Uc=0;Uc<256;++Uc)qc[Uc]=(Uc+256).toString(16).substr(1);function Yc(t,e,i){var n=e&&i||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var o=(t=t||{}).random||(t.rng||Wc)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,e)for(var r=0;r<16;++r)e[n+r]=o[r];return e||function(t,e){var i=0;return[qc[t[i++]],qc[t[i++]],qc[t[i++]],qc[t[i++]],"-",qc[t[i++]],qc[t[i++]],"-",qc[t[i++]],qc[t[i++]],"-",qc[t[i++]],qc[t[i++]],"-",qc[t[i++]],qc[t[i++]],qc[t[i++]],qc[t[i++]],qc[t[i++]],qc[t[i++]]].join("")}(o)}function Gc(t,e){var i=go(t);if(Vn){var n=Vn(t);e&&(n=Yn(n).call(n,function(e){return $n(t,e).enumerable})),i.push.apply(i,n)}return i}function Zc(t){for(var e=1;e<arguments.length;e++){var i,n=null!=arguments[e]?arguments[e]:{};if(e%2)Bn(i=Gc(Object(n),!0)).call(i,function(e){Jn(t,e,n[e])});else if(Kn)Qn(t,Kn(n));else{var o;Bn(o=Gc(Object(n))).call(o,function(e){mo(t,e,$n(n,e))})}}return t}var $c=/^\/?Date\((-?\d+)/i,Xc=/^\d+$/;function Kc(t,e){var i;if(void 0!==t){if(null===t)return null;if(!e)return t;if("string"!=typeof e&&!(e instanceof String))throw new Error("Type must be a string");switch(e){case"boolean":case"Boolean":return Boolean(t);case"number":case"Number":return fl(t)&&!isNaN(Date.parse(t))?n.default(t).valueOf():Number(t.valueOf());case"string":case"String":return String(t);case"Date":try{return Kc(t,"Moment").toDate()}catch(i){throw i instanceof TypeError?new TypeError("Cannot convert object of type "+yl(t)+" to type "+e):i}case"Moment":if(ul(t))return n.default(t);if(t instanceof Date)return n.default(t.valueOf());if(n.default.isMoment(t))return n.default(t);if(fl(t))return(i=$c.exec(t))?n.default(Number(i[1])):(i=Xc.exec(t))?n.default(Number(t)):n.default(t);throw new TypeError("Cannot convert object of type "+yl(t)+" to type "+e);case"ISODate":if(ul(t))return new Date(t);if(t instanceof Date)return t.toISOString();if(n.default.isMoment(t))return t.toDate().toISOString();if(fl(t))return(i=$c.exec(t))?new Date(Number(i[1])).toISOString():n.default(t).format();throw new Error("Cannot convert object of type "+yl(t)+" to type ISODate");case"ASPDate":if(ul(t))return"/Date("+t+")/";if(t instanceof Date||n.default.isMoment(t))return"/Date("+t.valueOf()+")/";if(fl(t))return"/Date("+((i=$c.exec(t))?new Date(Number(i[1])).valueOf():new Date(t).valueOf())+")/";throw new Error("Cannot convert object of type "+yl(t)+" to type ASPDate");default:throw new Error("Unknown type ".concat(e))}}}function Qc(t){var e,n,o,r,s,a,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{start:"Date",end:"Date"},c=t._idProp,h=new i.DataSet({fieldId:c}),d=oo(e=i.createNewDataPipeFrom(t)).call(e,function(t){var e;return fo(e=go(t)).call(e,function(e,i){return e[i]=Kc(t[i],l[i]),e},{})}).to(h);return d.all().start(),{add:function(){var e;return(e=t.getDataSet()).add.apply(e,arguments)},remove:function(){var e;return(e=t.getDataSet()).remove.apply(e,arguments)},update:function(){var e;return(e=t.getDataSet()).update.apply(e,arguments)},updateOnly:function(){var e;return(e=t.getDataSet()).updateOnly.apply(e,arguments)},clear:function(){var e;return(e=t.getDataSet()).clear.apply(e,arguments)},forEach:An(n=Bn(h)).call(n,h),get:An(o=h.get).call(o,h),getIds:An(r=h.getIds).call(r,h),off:An(s=h.off).call(s,h),on:An(a=h.on).call(a,h),get length(){return h.length},idProp:c,type:l,rawDS:t,coercedDS:h,dispose:function(){return d.stop()}}}var Jc=function(t){var e=new jc.FilterXSS(t);return function(t){return e.process(t)}},th=function(t){return t},eh=Jc(),ih=Zc(Zc({},Zl),{},{convert:Kc,setupXSSProtection:function(t){t&&(!0===t.disabled?(eh=th,console.warn("You disabled XSS protection for vis-Timeline. I sure hope you know what you're doing!")):t.filterOptions&&(eh=Jc(t.filterOptions)))}});mo(ih,"xss",{get:function(){return eh}});var nh=Dr.trim,oh=l.parseFloat,rh=1/oh(Ar+"-0")!=-1/0?function(t){var e=nh(String(t)),i=oh(e);return 0===i&&"-"==e.charAt(0)?-0:i}:oh;Z({global:!0,forced:parseFloat!=rh},{parseFloat:rh});var sh=B.parseFloat,ah=function(){function t(e,i){zt(this,t),this.options=null,this.props=null}return jt(t,[{key:"setOptions",value:function(t){t&&ih.extend(this.options,t)}},{key:"redraw",value:function(){return!1}},{key:"destroy",value:function(){}},{key:"_isResized",value:function(){var t=this.props._previousWidth!==this.props.width||this.props._previousHeight!==this.props.height;return this.props._previousWidth=this.props.width,this.props._previousHeight=this.props.height,t}}]),t}();Z({target:"String",proto:!0},{repeat:function(t){var e=String(b(this)),i="",n=J(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(i+=e);return i}});var lh=En("String").repeat,ch=String.prototype,hh=function(t){var e=t.repeat;return"string"==typeof t||t===ch||t instanceof String&&e===ch.repeat?lh:e},dh=Math.floor,uh=function(t,e){var i=t.length,n=dh(i/2);return i<8?fh(t,e):ph(uh(t.slice(0,n),e),uh(t.slice(n),e),e)},fh=function(t,e){for(var i,n,o=t.length,r=1;r<o;){for(n=r,i=t[r];n&&e(t[n-1],i)>0;)t[n]=t[--n];n!==r++&&(t[n]=i)}return t},ph=function(t,e,i){for(var n=t.length,o=e.length,r=0,s=0,a=[];r<n||s<o;)a.push(r<n&&s<o?i(t[r],e[s])<=0?t[r++]:e[s++]:r<n?t[r++]:e[s++]);return a},gh=uh,mh=Jt.match(/firefox\/(\d+)/i),vh=!!mh&&+mh[1],yh=/MSIE|Trident/.test(Jt),bh=Jt.match(/AppleWebKit\/(\d+)\./),wh=!!bh&&+bh[1],kh=[],_h=kh.sort,xh=c(function(){kh.sort(void 0)}),Ch=c(function(){kh.sort(null)}),Eh=Dn("sort"),Th=!c(function(){if(ne)return ne<70;if(!(vh&&vh>3)){if(yh)return!0;if(wh)return wh<603;var t,e,i,n,o="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)kh.push({k:e+n,v:i})}for(kh.sort(function(t,e){return e.v-t.v}),n=0;n<kh.length;n++)e=kh[n].k.charAt(0),o.charAt(o.length-1)!==e&&(o+=e);return"DGBEFHACIJK"!==o}});Z({target:"Array",proto:!0,forced:xh||!Ch||!Eh||!Th},{sort:function(t){void 0!==t&&j(t);var e=x(this);if(Th)return void 0===t?_h.call(e):_h.call(e,t);var i,n,o=[],r=et(e.length);for(n=0;n<r;n++)n in e&&o.push(e[n]);for(i=(o=gh(o,function(t){return function(e,i){return void 0===i?-1:void 0===e?1:void 0!==t?+t(e,i)||0:String(e)>String(i)?1:-1}}(t))).length,n=0;n<i;)e[n]=o[n++];for(;n<r;)delete e[n++];return e}});var Sh=En("Array").sort,Ah=Array.prototype,Oh=function(t){var e=t.sort;return t===Ah||t instanceof Array&&e===Ah.sort?Sh:e};function Ih(t,e,i){if(i&&!Cn(i))return Ih(t,e,[i]);if(e.hiddenDates=[],i&&1==Cn(i)){for(var n,o=0;o<i.length;o++)if(void 0===hh(i[o])){var r={};r.start=t(i[o].start).toDate().valueOf(),r.end=t(i[o].end).toDate().valueOf(),e.hiddenDates.push(r)}Oh(n=e.hiddenDates).call(n,function(t,e){return t.start-e.start})}}function Ph(t,e,i){if(i&&!Cn(i))return Ph(t,e,[i]);if(i&&void 0!==e.domProps.centerContainer.width){Ih(t,e,i);for(var n=t(e.range.start),o=t(e.range.end),r=(e.range.end-e.range.start)/e.domProps.centerContainer.width,s=0;s<i.length;s++)if(void 0!==hh(i[s])){var a=t(i[s].start),l=t(i[s].end);if("Invalid Date"==a._d)throw new Error("Supplied start date is not valid: ".concat(i[s].start));if("Invalid Date"==l._d)throw new Error("Supplied end date is not valid: ".concat(i[s].end));if(l-a>=4*r){var c=0,h=o.clone();switch(hh(i[s])){case"daily":a.day()!=l.day()&&(c=1),a.dayOfYear(n.dayOfYear()),a.year(n.year()),a.subtract(7,"days"),l.dayOfYear(n.dayOfYear()),l.year(n.year()),l.subtract(7-c,"days"),h.add(1,"weeks");break;case"weekly":var d=l.diff(a,"days"),u=a.day();a.date(n.date()),a.month(n.month()),a.year(n.year()),l=a.clone(),a.day(u),l.day(u),l.add(d,"days"),a.subtract(1,"weeks"),l.subtract(1,"weeks"),h.add(1,"weeks");break;case"monthly":a.month()!=l.month()&&(c=1),a.month(n.month()),a.year(n.year()),a.subtract(1,"months"),l.month(n.month()),l.year(n.year()),l.subtract(1,"months"),l.add(c,"months"),h.add(1,"months");break;case"yearly":a.year()!=l.year()&&(c=1),a.year(n.year()),a.subtract(1,"years"),l.year(n.year()),l.subtract(1,"years"),l.add(c,"years"),h.add(1,"years");break;default:return void console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",hh(i[s]))}for(;a<h;)switch(e.hiddenDates.push({start:a.valueOf(),end:l.valueOf()}),hh(i[s])){case"daily":a.add(1,"days"),l.add(1,"days");break;case"weekly":a.add(1,"weeks"),l.add(1,"weeks");break;case"monthly":a.add(1,"months"),l.add(1,"months");break;case"yearly":a.add(1,"y"),l.add(1,"y");break;default:return void console.log("Wrong repeat format, allowed are: daily, weekly, monthly, yearly. Given:",hh(i[s]))}e.hiddenDates.push({start:a.valueOf(),end:l.valueOf()})}}Mh(e);var f=Hh(e.range.start,e.hiddenDates),p=Hh(e.range.end,e.hiddenDates),g=e.range.start,m=e.range.end;1==f.hidden&&(g=1==e.range.startToFront?f.startDate-1:f.endDate+1),1==p.hidden&&(m=1==e.range.endToFront?p.startDate-1:p.endDate+1),1!=f.hidden&&1!=p.hidden||e.range._applyRange(g,m)}}function Mh(t){for(var e,i=t.hiddenDates,n=[],o=0;o<i.length;o++)for(var r=0;r<i.length;r++)o!=r&&1!=i[r].remove&&1!=i[o].remove&&(i[r].start>=i[o].start&&i[r].end<=i[o].end?i[r].remove=!0:i[r].start>=i[o].start&&i[r].start<=i[o].end?(i[o].end=i[r].end,i[r].remove=!0):i[r].end>=i[o].start&&i[r].end<=i[o].end&&(i[o].start=i[r].start,i[r].remove=!0));for(o=0;o<i.length;o++)!0!==i[o].remove&&n.push(i[o]);t.hiddenDates=n,Oh(e=t.hiddenDates).call(e,function(t,e){return t.start-e.start})}function Dh(t,e,i){for(var n=!1,o=e.current.valueOf(),r=0;r<e.hiddenDates.length;r++){var s=e.hiddenDates[r].end;if(o>=e.hiddenDates[r].start&&o<s){n=!0;break}}if(1==n&&o<e._end.valueOf()&&o!=i){var a=t(i),l=t(s);a.year()!=l.year()?e.switchedYear=!0:a.month()!=l.month()?e.switchedMonth=!0:a.dayOfYear()!=l.dayOfYear()&&(e.switchedDay=!0),e.current=l}}function Nh(t,e,i){var n;if(0==t.body.hiddenDates.length)return n=t.range.conversion(i),(e.valueOf()-n.offset)*n.scale;var o=Hh(e,t.body.hiddenDates);1==o.hidden&&(e=o.startDate);var r=zh(t.body.hiddenDates,t.range.start,t.range.end);if(e<t.range.start){n=t.range.conversion(i,r);var s=Fh(t.body.hiddenDates,e,n.offset);return e=t.options.moment(e).toDate().valueOf(),-(n.offset-(e+=s).valueOf())*n.scale}return e>t.range.end?(e=Lh(t.options.moment,t.body.hiddenDates,{start:t.range.start,end:e},e),n=t.range.conversion(i,r),(e.valueOf()-n.offset)*n.scale):(e=Lh(t.options.moment,t.body.hiddenDates,t.range,e),n=t.range.conversion(i,r),(e.valueOf()-n.offset)*n.scale)}function Rh(t,e,i){if(0==t.body.hiddenDates.length){var n=t.range.conversion(i);return new Date(e/n.scale+n.offset)}var o=zh(t.body.hiddenDates,t.range.start,t.range.end),r=(t.range.end-t.range.start-o)*e/i,s=jh(t.body.hiddenDates,t.range,r);return new Date(s+r+t.range.start)}function zh(t,e,i){for(var n=0,o=0;o<t.length;o++){var r=t[o].start,s=t[o].end;r>=e&&s<i&&(n+=s-r)}return n}function Fh(t,e,i){for(var n=0,o=0;o<t.length;o++){var r=t[o].start,s=t[o].end;r>=e&&s<=i&&(n+=s-r)}return n}function Lh(t,e,i,n){return(n=t(n).toDate().valueOf())-Bh(t,e,i,n)}function Bh(t,e,i,n){var o=0;n=t(n).toDate().valueOf();for(var r=0;r<e.length;r++){var s=e[r].start,a=e[r].end;s>=i.start&&a<i.end&&n>=a&&(o+=a-s)}return o}function jh(t,e,i){for(var n=0,o=0,r=e.start,s=0;s<t.length;s++){var a=t[s].start,l=t[s].end;if(a>=e.start&&l<e.end){if(o+=a-r,r=l,o>=i)break;n+=l-a}}return n}function Vh(t,e,i,n){var o=Hh(e,t);return 1==o.hidden?i<0?1==n?o.startDate-(o.endDate-e)-1:o.startDate-1:1==n?o.endDate+(e-o.startDate)+1:o.endDate+1:e}function Hh(t,e){for(var i=0;i<e.length;i++){var n=e[i].start,o=e[i].end;if(t>=n&&t<o)return{hidden:!0,startDate:n,endDate:o}}return{hidden:!1,startDate:n,endDate:o}}var Wh=Object.freeze({__proto__:null,convertHiddenOptions:Ih,updateHiddenDates:Ph,removeDuplicates:Mh,printDates:function(t){for(var e=0;e<t.length;e++)console.log(e,new Date(t[e].start),new Date(t[e].end),t[e].start,t[e].end,t[e].remove)},stepOverHiddenDates:Dh,toScreen:Nh,toTime:Rh,getHiddenDurationBetween:zh,getHiddenDurationBeforeStart:Fh,correctTimeForHidden:Lh,getHiddenDurationBefore:Bh,getAccumulatedHiddenDuration:jh,snapAwayFromHidden:Vh,getIsHidden:Hh}),qh=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n){var o,r,s,a,l,c,h,d;zt(this,i),d=e.call(this);var u=jn().hours(0).minutes(0).seconds(0).milliseconds(0),f=u.clone().add(-3,"days").valueOf(),p=u.clone().add(3,"days").valueOf();return d.millisecondsPerPixelCache=void 0,void 0===n?(d.start=f,d.end=p):(d.start=n.start||f,d.end=n.end||p),d.rolling=!1,d.body=t,d.deltaDifference=0,d.scaleOffset=0,d.startToFront=!1,d.endToFront=!0,d.defaultOptions={rtl:!1,start:null,end:null,moment:jn,direction:"horizontal",moveable:!0,zoomable:!0,min:null,max:null,zoomMin:10,zoomMax:31536e10,rollingMode:{follow:!1,offset:.5}},d.options=ih.extend({},d.defaultOptions),d.props={touch:{}},d.animationTimer=null,d.body.emitter.on("panstart",An(o=d._onDragStart).call(o,Vt(d))),d.body.emitter.on("panmove",An(r=d._onDrag).call(r,Vt(d))),d.body.emitter.on("panend",An(s=d._onDragEnd).call(s,Vt(d))),d.body.emitter.on("mousewheel",An(a=d._onMouseWheel).call(a,Vt(d))),d.body.emitter.on("touch",An(l=d._onTouch).call(l,Vt(d))),d.body.emitter.on("pinch",An(c=d._onPinch).call(c,Vt(d))),d.body.dom.rollingModeBtn.addEventListener("click",An(h=d.startRolling).call(h,Vt(d))),d.setOptions(n),d}return jt(i,[{key:"setOptions",value:function(t){t&&(ih.selectiveExtend(["animation","direction","min","max","zoomMin","zoomMax","moveable","zoomable","moment","activate","hiddenDates","zoomKey","zoomFriction","rtl","showCurrentTime","rollingMode","horizontalScroll"],this.options,t),t.rollingMode&&t.rollingMode.follow&&this.startRolling(),("start"in t||"end"in t)&&this.setRange(t.start,t.end))}},{key:"startRolling",value:function(){var t=this;!function e(){t.stopRolling(),t.rolling=!0;var i=t.end-t.start,n=ih.convert(new Date,"Date").valueOf(),o=t.options.rollingMode&&t.options.rollingMode.offset||.5;t.setRange(n-i*o,n+i*(1-o),{animation:!1}),(i=1/t.conversion(t.body.domProps.center.width).scale/10)<30&&(i=30),i>1e3&&(i=1e3),t.body.dom.rollingModeBtn.style.visibility="hidden",t.currentTimeTimer=Mn(e,i)}()}},{key:"stopRolling",value:function(){void 0!==this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),this.rolling=!1,this.body.dom.rollingModeBtn.style.visibility="visible")}},{key:"setRange",value:function(t,e,i,n,o){i||(i={}),!0!==i.byUser&&(i.byUser=!1);var r=this,s=null!=t?ih.convert(t,"Date").valueOf():null,a=null!=e?ih.convert(e,"Date").valueOf():null;if(this._cancelAnimation(),this.millisecondsPerPixelCache=void 0,i.animation){var l,c=this.start,h=this.end,d="object"===vn(i.animation)&&"duration"in i.animation?i.animation.duration:500,u="object"===vn(i.animation)&&"easingFunction"in i.animation?i.animation.easingFunction:"easeInOutQuad",f=ih.easingFunctions[u];if(!f)throw new Error(Zo(l="Unknown easing function ".concat(os(u),". Choose from: ")).call(l,go(ih.easingFunctions).join(", ")));var p=Ko(),g=!1;return function t(){if(!r.props.touch.dragging){var e=Ko()-p,l=f(e/d),u=e>d;m=r._applyRange(u||null===s?s:c+(s-c)*l,u||null===a?a:h+(a-h)*l),Ph(r.options.moment,r.body,r.options.hiddenDates),g=g||m;var v={start:new Date(r.start),end:new Date(r.end),byUser:i.byUser,event:i.event};if(o&&o(l,m,u),m&&r.body.emitter.emit("rangechange",v),u){if(g&&(r.body.emitter.emit("rangechanged",v),n))return n()}else r.animationTimer=Mn(t,20)}}()}var m=this._applyRange(s,a);if(Ph(this.options.moment,this.body,this.options.hiddenDates),m){var v={start:new Date(this.start),end:new Date(this.end),byUser:i.byUser,event:i.event};if(this.body.emitter.emit("rangechange",v),clearTimeout(r.timeoutID),r.timeoutID=Mn(function(){r.body.emitter.emit("rangechanged",v)},200),n)return n()}}},{key:"getMillisecondsPerPixel",value:function(){return void 0===this.millisecondsPerPixelCache&&(this.millisecondsPerPixelCache=(this.end-this.start)/this.body.dom.center.clientWidth),this.millisecondsPerPixelCache}},{key:"_cancelAnimation",value:function(){this.animationTimer&&(clearTimeout(this.animationTimer),this.animationTimer=null)}},{key:"_applyRange",value:function(t,e){var i,n=null!=t?ih.convert(t,"Date").valueOf():this.start,o=null!=e?ih.convert(e,"Date").valueOf():this.end,r=null!=this.options.max?ih.convert(this.options.max,"Date").valueOf():null,s=null!=this.options.min?ih.convert(this.options.min,"Date").valueOf():null;if(isNaN(n)||null===n)throw new Error('Invalid start "'.concat(t,'"'));if(isNaN(o)||null===o)throw new Error('Invalid end "'.concat(e,'"'));if(o<n&&(o=n),null!==s&&n<s&&(n+=i=s-n,o+=i,null!=r&&o>r&&(o=r)),null!==r&&o>r&&(n-=i=o-r,o-=i,null!=s&&n<s&&(n=s)),null!==this.options.zoomMin){var a=sh(this.options.zoomMin);a<0&&(a=0),o-n<a&&(this.end-this.start===a&&n>=this.start-.5&&o<=this.end?(n=this.start,o=this.end):(n-=(i=a-(o-n))/2,o+=i/2))}if(null!==this.options.zoomMax){var l=sh(this.options.zoomMax);l<0&&(l=0),o-n>l&&(this.end-this.start===l&&n<this.start&&o>this.end?(n=this.start,o=this.end):(n+=(i=o-n-l)/2,o-=i/2))}var c=this.start!=n||this.end!=o;return n>=this.start&&n<=this.end||o>=this.start&&o<=this.end||this.start>=n&&this.start<=o||this.end>=n&&this.end<=o||this.body.emitter.emit("checkRangedItems"),this.start=n,this.end=o,c}},{key:"getRange",value:function(){return{start:this.start,end:this.end}}},{key:"conversion",value:function(t,e){return i.conversion(this.start,this.end,t,e)}},{key:"_onDragStart",value:function(t){this.deltaDifference=0,this.previousDelta=0,this.options.moveable&&this._isInsideRange(t)&&this.props.touch.allowDragging&&(this.stopRolling(),this.props.touch.start=this.start,this.props.touch.end=this.end,this.props.touch.dragging=!0,this.body.dom.root&&(this.body.dom.root.style.cursor="move"))}},{key:"_onDrag",value:function(t){if(t&&this.props.touch.dragging&&this.options.moveable&&this.props.touch.allowDragging){var e=this.options.direction;Uh(e);var i="horizontal"==e?t.deltaX:t.deltaY;i-=this.deltaDifference;var n=this.props.touch.end-this.props.touch.start;n-=zh(this.body.hiddenDates,this.start,this.end);var o,r="horizontal"==e?this.body.domProps.center.width:this.body.domProps.center.height,s=this.props.touch.start+(o=this.options.rtl?i/r*n:-i/r*n),a=this.props.touch.end+o,l=Vh(this.body.hiddenDates,s,this.previousDelta-i,!0),c=Vh(this.body.hiddenDates,a,this.previousDelta-i,!0);if(l!=s||c!=a)return this.deltaDifference+=i,this.props.touch.start=l,this.props.touch.end=c,void this._onDrag(t);this.previousDelta=i,this._applyRange(s,a);var h=new Date(this.start),d=new Date(this.end);this.body.emitter.emit("rangechange",{start:h,end:d,byUser:!0,event:t}),this.body.emitter.emit("panmove")}}},{key:"_onDragEnd",value:function(t){this.props.touch.dragging&&this.options.moveable&&this.props.touch.allowDragging&&(this.props.touch.dragging=!1,this.body.dom.root&&(this.body.dom.root.style.cursor="auto"),this.body.emitter.emit("rangechanged",{start:new Date(this.start),end:new Date(this.end),byUser:!0,event:t}))}},{key:"_onMouseWheel",value:function(t){var e=0;if(t.wheelDelta?e=t.wheelDelta/120:t.detail?e=-t.detail/3:t.deltaY&&(e=-t.deltaY/3),!(this.options.zoomKey&&!t[this.options.zoomKey]&&this.options.zoomable||!this.options.zoomable&&this.options.moveable)&&this.options.zoomable&&this.options.moveable&&this._isInsideRange(t)&&e){var i,n,o=this.options.zoomFriction||5;if(i=e<0?1-e/o:1/(1+e/o),this.rolling)n=this.start+(this.end-this.start)*(this.options.rollingMode&&this.options.rollingMode.offset||.5);else{var r=this.getPointer({x:t.clientX,y:t.clientY},this.body.dom.center);n=this._pointerToDate(r)}this.zoom(i,n,e,t),t.preventDefault()}}},{key:"_onTouch",value:function(t){this.props.touch.start=this.start,this.props.touch.end=this.end,this.props.touch.allowDragging=!0,this.props.touch.center=null,this.props.touch.centerDate=null,this.scaleOffset=0,this.deltaDifference=0,ih.preventDefault(t)}},{key:"_onPinch",value:function(t){if(this.options.zoomable&&this.options.moveable){ih.preventDefault(t),this.props.touch.allowDragging=!1,this.props.touch.center||(this.props.touch.center=this.getPointer(t.center,this.body.dom.center),this.props.touch.centerDate=this._pointerToDate(this.props.touch.center)),this.stopRolling();var e=1/(t.scale+this.scaleOffset),i=this.props.touch.centerDate,n=zh(this.body.hiddenDates,this.start,this.end),o=Bh(this.options.moment,this.body.hiddenDates,this,i),r=n-o,s=i-o+(this.props.touch.start-(i-o))*e,a=i+r+(this.props.touch.end-(i+r))*e;this.startToFront=1-e<=0,this.endToFront=e-1<=0;var l=Vh(this.body.hiddenDates,s,1-e,!0),c=Vh(this.body.hiddenDates,a,e-1,!0);l==s&&c==a||(this.props.touch.start=l,this.props.touch.end=c,this.scaleOffset=1-t.scale,s=l,a=c),this.setRange(s,a,{animation:!1,byUser:!0,event:t}),this.startToFront=!1,this.endToFront=!0}}},{key:"_isInsideRange",value:function(t){var e=t.center?t.center.x:t.clientX,i=this.body.dom.centerContainer.getBoundingClientRect(),n=this.body.util.toTime(this.options.rtl?e-i.left:i.right-e);return n>=this.start&&n<=this.end}},{key:"_pointerToDate",value:function(t){var e,i=this.options.direction;return Uh(i),"horizontal"==i?this.body.util.toTime(t.x).valueOf():(e=this.conversion(this.body.domProps.center.height),t.y/e.scale+e.offset)}},{key:"getPointer",value:function(t,e){var i=e.getBoundingClientRect();return this.options.rtl?{x:i.right-t.x,y:t.y-i.top}:{x:t.x-i.left,y:t.y-i.top}}},{key:"zoom",value:function(t,e,i,n){null==e&&(e=(this.start+this.end)/2);var o=zh(this.body.hiddenDates,this.start,this.end),r=Bh(this.options.moment,this.body.hiddenDates,this,e),s=o-r,a=e-r+(this.start-(e-r))*t,l=e+s+(this.end-(e+s))*t;this.startToFront=!(i>0),this.endToFront=!(-i>0);var c=Vh(this.body.hiddenDates,a,i,!0),h=Vh(this.body.hiddenDates,l,-i,!0);c==a&&h==l||(a=c,l=h),this.setRange(a,l,{animation:!1,byUser:!0,event:n}),this.startToFront=!1,this.endToFront=!0}},{key:"move",value:function(t){var e=this.end-this.start,i=this.end+e*t;this.start=this.start+e*t,this.end=i}},{key:"moveTo",value:function(t){var e=(this.start+this.end)/2-t;this.setRange(this.start-e,this.end-e,{animation:!1,byUser:!0,event:null})}}],[{key:"conversion",value:function(t,e,i,n){return void 0===n&&(n=0),0!=i&&e-t!=0?{offset:t,scale:i/(e-t-n)}:{offset:0,scale:1}}}]),i}(ah);function Uh(t){if("horizontal"!=t&&"vertical"!=t)throw new TypeError('Unknown direction "'.concat(t,'". Choose "horizontal" or "vertical".'))}var Yh=ei.some,Gh=Dn("some");Z({target:"Array",proto:!0,forced:!Gh},{some:function(t){return Yh(this,t,arguments.length>1?arguments[1]:void 0)}});var Zh=En("Array").some,$h=Array.prototype,Xh=function(t){var e=t.some;return t===$h||t instanceof Array&&e===$h.some?Zh:e},Kh=B.setInterval,Qh=null,Jh="undefined"!=typeof window?function t(e,i){var n=i||{preventDefault:!1};if(e.Manager){var o=e,r=function(e,i){var r=Object.create(n);return i&&o.assign(r,i),t(new o(e,r),r)};return o.assign(r,o),r.Manager=function(e,i){var r=Object.create(n);return i&&o.assign(r,i),t(new o.Manager(e,r),r)},r}var s=Object.create(e),a=e.element;function l(t){return t.match(/[^ ]+/g)}function c(t){if("hammer.input"!==t.type){if(t.srcEvent._handled||(t.srcEvent._handled={}),t.srcEvent._handled[t.type])return;t.srcEvent._handled[t.type]=!0}var e=!1;t.stopPropagation=function(){e=!0};var i=t.srcEvent.stopPropagation.bind(t.srcEvent);"function"==typeof i&&(t.srcEvent.stopPropagation=function(){i(),t.stopPropagation()}),t.firstTarget=Qh;for(var n=Qh;n&&!e;){var o=n.hammer;if(o)for(var r,s=0;s<o.length;s++)if(r=o[s]._handlers[t.type])for(var a=0;a<r.length&&!e;a++)r[a](t);n=n.parentNode}}return a.hammer||(a.hammer=[]),a.hammer.push(s),e.on("hammer.input",function(t){!0!==n.preventDefault&&n.preventDefault!==t.pointerType||t.preventDefault(),t.isFirst&&(Qh=t.target)}),s._handlers={},s.on=function(t,i){return l(t).forEach(function(t){var n=s._handlers[t];n||(s._handlers[t]=n=[],e.on(t,c)),n.push(i)}),s},s.off=function(t,i){return l(t).forEach(function(t){var n=s._handlers[t];n&&((n=i?n.filter(function(t){return t!==i}):[]).length>0?s._handlers[t]=n:(e.off(t,c),delete s._handlers[t]))}),s},s.emit=function(t,i){Qh=i.target,e.emit(t,i)},s.destroy=function(){var t=e.element.hammer,i=t.indexOf(s);-1!==i&&t.splice(i,1),t.length||delete e.element.hammer,s._handlers={},e.destroy()},s}(window.Hammer||Ga,{preventDefault:"mouse"}):function(){return{on:t=function(){},off:t,destroy:t,emit:t,get:function(e){return{set:t}}};var t};function td(t,e){e.inputHandler=function(t){t.isFirst&&e(t)},t.on("hammer.input",e.inputHandler)}var ed=function(){function t(e,i,n,o,r){zt(this,t),this.moment=r&&r.moment||jn,this.options=r||{},this.current=this.moment(),this._start=this.moment(),this._end=this.moment(),this.autoScale=!0,this.scale="day",this.step=1,this.setRange(e,i,n),this.switchedDay=!1,this.switchedMonth=!1,this.switchedYear=!1,this.hiddenDates=Cn(o)?o:null!=o?[o]:[],this.format=t.FORMAT}return jt(t,[{key:"setMoment",value:function(t){this.moment=t,this.current=this.moment(this.current.valueOf()),this._start=this.moment(this._start.valueOf()),this._end=this.moment(this._end.valueOf())}},{key:"setFormat",value:function(e){var i=ih.deepExtend({},t.FORMAT);this.format=ih.deepExtend(i,e)}},{key:"setRange",value:function(t,e,i){if(!(t instanceof Date&&e instanceof Date))throw"No legal start or end date in method setRange";this._start=null!=t?this.moment(t.valueOf()):Ko(),this._end=null!=e?this.moment(e.valueOf()):Ko(),this.autoScale&&this.setMinimumStep(i)}},{key:"start",value:function(){this.current=this._start.clone(),this.roundToMinor()}},{key:"roundToMinor",value:function(){switch("week"==this.scale&&this.current.weekday(0),this.scale){case"year":this.current.year(this.step*Math.floor(this.current.year()/this.step)),this.current.month(0);case"month":this.current.date(1);case"week":case"day":case"weekday":this.current.hours(0);case"hour":this.current.minutes(0);case"minute":this.current.seconds(0);case"second":this.current.milliseconds(0)}if(1!=this.step){var t=this.current.clone();switch(this.scale){case"millisecond":this.current.subtract(this.current.milliseconds()%this.step,"milliseconds");break;case"second":this.current.subtract(this.current.seconds()%this.step,"seconds");break;case"minute":this.current.subtract(this.current.minutes()%this.step,"minutes");break;case"hour":this.current.subtract(this.current.hours()%this.step,"hours");break;case"weekday":case"day":this.current.subtract((this.current.date()-1)%this.step,"day");break;case"week":this.current.subtract(this.current.week()%this.step,"week");break;case"month":this.current.subtract(this.current.month()%this.step,"month");break;case"year":this.current.subtract(this.current.year()%this.step,"year")}t.isSame(this.current)||(this.current=this.moment(Vh(this.hiddenDates,this.current.valueOf(),-1,!0)))}}},{key:"hasNext",value:function(){return this.current.valueOf()<=this._end.valueOf()}},{key:"next",value:function(){var t=this.current.valueOf();switch(this.scale){case"millisecond":this.current.add(this.step,"millisecond");break;case"second":this.current.add(this.step,"second");break;case"minute":this.current.add(this.step,"minute");break;case"hour":this.current.add(this.step,"hour"),this.current.month()<6?this.current.subtract(this.current.hours()%this.step,"hour"):this.current.hours()%this.step!=0&&this.current.add(this.step-this.current.hours()%this.step,"hour");break;case"weekday":case"day":this.current.add(this.step,"day");break;case"week":if(0!==this.current.weekday())this.current.weekday(0),this.current.add(this.step,"week");else if(!1===this.options.showMajorLabels)this.current.add(this.step,"week");else{var e=this.current.clone();e.add(1,"week"),e.isSame(this.current,"month")?this.current.add(this.step,"week"):(this.current.add(this.step,"week"),this.current.date(1))}break;case"month":this.current.add(this.step,"month");break;case"year":this.current.add(this.step,"year")}if(1!=this.step)switch(this.scale){case"millisecond":this.current.milliseconds()>0&&this.current.milliseconds()<this.step&&this.current.milliseconds(0);break;case"second":this.current.seconds()>0&&this.current.seconds()<this.step&&this.current.seconds(0);break;case"minute":this.current.minutes()>0&&this.current.minutes()<this.step&&this.current.minutes(0);break;case"hour":this.current.hours()>0&&this.current.hours()<this.step&&this.current.hours(0);break;case"weekday":case"day":this.current.date()<this.step+1&&this.current.date(1);break;case"week":this.current.week()<this.step&&this.current.week(1);break;case"month":this.current.month()<this.step&&this.current.month(0)}this.current.valueOf()==t&&(this.current=this._end.clone()),this.switchedDay=!1,this.switchedMonth=!1,this.switchedYear=!1,Dh(this.moment,this,t)}},{key:"getCurrent",value:function(){return this.current.clone()}},{key:"setScale",value:function(t){t&&"string"==typeof t.scale&&(this.scale=t.scale,this.step=t.step>0?t.step:1,this.autoScale=!1)}},{key:"setAutoScale",value:function(t){this.autoScale=t}},{key:"setMinimumStep",value:function(t){if(null!=t){var e=31104e6;1e3*e>t&&(this.scale="year",this.step=1e3),500*e>t&&(this.scale="year",this.step=500),100*e>t&&(this.scale="year",this.step=100),50*e>t&&(this.scale="year",this.step=50),10*e>t&&(this.scale="year",this.step=10),5*e>t&&(this.scale="year",this.step=5),e>t&&(this.scale="year",this.step=1),7776e6>t&&(this.scale="month",this.step=3),2592e6>t&&(this.scale="month",this.step=1),6048e5>t&&this.options.showWeekScale&&(this.scale="week",this.step=1),1728e5>t&&(this.scale="day",this.step=2),864e5>t&&(this.scale="day",this.step=1),432e5>t&&(this.scale="weekday",this.step=1),144e5>t&&(this.scale="hour",this.step=4),36e5>t&&(this.scale="hour",this.step=1),9e5>t&&(this.scale="minute",this.step=15),6e5>t&&(this.scale="minute",this.step=10),3e5>t&&(this.scale="minute",this.step=5),6e4>t&&(this.scale="minute",this.step=1),15e3>t&&(this.scale="second",this.step=15),1e4>t&&(this.scale="second",this.step=10),5e3>t&&(this.scale="second",this.step=5),1e3>t&&(this.scale="second",this.step=1),200>t&&(this.scale="millisecond",this.step=200),100>t&&(this.scale="millisecond",this.step=100),50>t&&(this.scale="millisecond",this.step=50),10>t&&(this.scale="millisecond",this.step=10),5>t&&(this.scale="millisecond",this.step=5),1>t&&(this.scale="millisecond",this.step=1)}}},{key:"isMajor",value:function(){if(1==this.switchedYear)switch(this.scale){case"year":case"month":case"week":case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return!0;default:return!1}else if(1==this.switchedMonth)switch(this.scale){case"week":case"weekday":case"day":case"hour":case"minute":case"second":case"millisecond":return!0;default:return!1}else if(1==this.switchedDay)switch(this.scale){case"millisecond":case"second":case"minute":case"hour":return!0;default:return!1}var t=this.moment(this.current);switch(this.scale){case"millisecond":return 0==t.milliseconds();case"second":return 0==t.seconds();case"minute":return 0==t.hours()&&0==t.minutes();case"hour":return 0==t.hours();case"weekday":case"day":case"week":return 1==t.date();case"month":return 0==t.month();case"year":default:return!1}}},{key:"getLabelMinor",value:function(t){if(null==t&&(t=this.current),t instanceof Date&&(t=this.moment(t)),"function"==typeof this.format.minorLabels)return this.format.minorLabels(t,this.scale,this.step);var e=this.format.minorLabels[this.scale];switch(this.scale){case"week":if(1===t.date()&&0!==t.weekday())return"";default:return e&&e.length>0?this.moment(t).format(e):""}}},{key:"getLabelMajor",value:function(t){if(null==t&&(t=this.current),t instanceof Date&&(t=this.moment(t)),"function"==typeof this.format.majorLabels)return this.format.majorLabels(t,this.scale,this.step);var e=this.format.majorLabels[this.scale];return e&&e.length>0?this.moment(t).format(e):""}},{key:"getClassName",value:function(){var t,e=this.moment,i=this.moment(this.current),n=i.locale?i.locale("en"):i.lang("en"),o=this.step,r=[];function s(t){return t/o%2==0?" vis-even":" vis-odd"}function a(t){return t.isSame(Ko(),"day")?" vis-today":t.isSame(e().add(1,"day"),"day")?" vis-tomorrow":t.isSame(e().add(-1,"day"),"day")?" vis-yesterday":""}function l(t){return t.isSame(Ko(),"week")?" vis-current-week":""}function c(t){return t.isSame(Ko(),"month")?" vis-current-month":""}switch(this.scale){case"millisecond":r.push(a(n)),r.push(s(n.milliseconds()));break;case"second":r.push(a(n)),r.push(s(n.seconds()));break;case"minute":r.push(a(n)),r.push(s(n.minutes()));break;case"hour":r.push(Zo(t="vis-h".concat(n.hours())).call(t,4==this.step?"-h"+(n.hours()+4):"")),r.push(a(n)),r.push(s(n.hours()));break;case"weekday":r.push("vis-".concat(n.format("dddd").toLowerCase())),r.push(a(n)),r.push(l(n)),r.push(s(n.date()));break;case"day":r.push("vis-day".concat(n.date())),r.push("vis-".concat(n.format("MMMM").toLowerCase())),r.push(a(n)),r.push(c(n)),r.push(this.step<=2?a(n):""),r.push(this.step<=2?"vis-".concat(n.format("dddd").toLowerCase()):""),r.push(s(n.date()-1));break;case"week":r.push("vis-week".concat(n.format("w"))),r.push(l(n)),r.push(s(n.week()));break;case"month":r.push("vis-".concat(n.format("MMMM").toLowerCase())),r.push(c(n)),r.push(s(n.month()));break;case"year":r.push("vis-year".concat(n.year())),r.push(function(t){return t.isSame(Ko(),"year")?" vis-current-year":""}(n)),r.push(s(n.year()))}return Yn(r).call(r,String).join(" ")}}],[{key:"snap",value:function(t,e,i){var n=jn(t);if("year"==e){var o=n.year()+Math.round(n.month()/12);n.year(Math.round(o/i)*i),n.month(0),n.date(0),n.hours(0),n.minutes(0),n.seconds(0),n.milliseconds(0)}else if("month"==e)n.date()>15?(n.date(1),n.add(1,"month")):n.date(1),n.hours(0),n.minutes(0),n.seconds(0),n.milliseconds(0);else if("week"==e)n.weekday()>2?(n.weekday(0),n.add(1,"week")):n.weekday(0),n.hours(0),n.minutes(0),n.seconds(0),n.milliseconds(0);else if("day"==e){switch(i){case 5:case 2:n.hours(24*Math.round(n.hours()/24));break;default:n.hours(12*Math.round(n.hours()/12))}n.minutes(0),n.seconds(0),n.milliseconds(0)}else if("weekday"==e){switch(i){case 5:case 2:n.hours(12*Math.round(n.hours()/12));break;default:n.hours(6*Math.round(n.hours()/6))}n.minutes(0),n.seconds(0),n.milliseconds(0)}else if("hour"==e){switch(i){case 4:n.minutes(60*Math.round(n.minutes()/60));break;default:n.minutes(30*Math.round(n.minutes()/30))}n.seconds(0),n.milliseconds(0)}else if("minute"==e){switch(i){case 15:case 10:n.minutes(5*Math.round(n.minutes()/5)),n.seconds(0);break;case 5:n.seconds(60*Math.round(n.seconds()/60));break;default:n.seconds(30*Math.round(n.seconds()/30))}n.milliseconds(0)}else if("second"==e)switch(i){case 15:case 10:n.seconds(5*Math.round(n.seconds()/5)),n.milliseconds(0);break;case 5:n.milliseconds(1e3*Math.round(n.milliseconds()/1e3));break;default:n.milliseconds(500*Math.round(n.milliseconds()/500))}else if("millisecond"==e){var r=i>5?i/2:1;n.milliseconds(Math.round(n.milliseconds()/r)*r)}return n}}]),t}();ed.FORMAT={minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",year:""}};var id=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n){var o;return zt(this,i),(o=e.call(this)).dom={foreground:null,lines:[],majorTexts:[],minorTexts:[],redundant:{lines:[],majorTexts:[],minorTexts:[]}},o.props={range:{start:0,end:0,minimumStep:0},lineTop:0},o.defaultOptions={orientation:{axis:"bottom"},showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,maxMinorChars:7,format:ih.extend({},ed.FORMAT),moment:jn,timeAxis:null},o.options=ih.extend({},o.defaultOptions),o.body=t,o._create(),o.setOptions(n),o}return jt(i,[{key:"setOptions",value:function(t){t&&(ih.selectiveExtend(["showMinorLabels","showMajorLabels","showWeekScale","maxMinorChars","hiddenDates","timeAxis","moment","rtl"],this.options,t),ih.selectiveDeepExtend(["format"],this.options,t),"orientation"in t&&("string"==typeof t.orientation?this.options.orientation.axis=t.orientation:"object"===vn(t.orientation)&&"axis"in t.orientation&&(this.options.orientation.axis=t.orientation.axis)),"locale"in t&&("function"==typeof jn.locale?jn.locale(t.locale):jn.lang(t.locale)))}},{key:"_create",value:function(){this.dom.foreground=document.createElement("div"),this.dom.background=document.createElement("div"),this.dom.foreground.className="vis-time-axis vis-foreground",this.dom.background.className="vis-time-axis vis-background"}},{key:"destroy",value:function(){this.dom.foreground.parentNode&&this.dom.foreground.parentNode.removeChild(this.dom.foreground),this.dom.background.parentNode&&this.dom.background.parentNode.removeChild(this.dom.background),this.body=null}},{key:"redraw",value:function(){var t=this.props,e=this.dom.foreground,i=this.dom.background,n="top"==this.options.orientation.axis?this.body.dom.top:this.body.dom.bottom,o=e.parentNode!==n;this._calculateCharSize();var r=this.options.showMajorLabels&&"none"!==this.options.orientation.axis;t.minorLabelHeight=this.options.showMinorLabels&&"none"!==this.options.orientation.axis?t.minorCharHeight:0,t.majorLabelHeight=r?t.majorCharHeight:0,t.height=t.minorLabelHeight+t.majorLabelHeight,t.width=e.offsetWidth,t.minorLineHeight=this.body.domProps.root.height-t.majorLabelHeight-("top"==this.options.orientation.axis?this.body.domProps.bottom.height:this.body.domProps.top.height),t.minorLineWidth=1,t.majorLineHeight=t.minorLineHeight+t.majorLabelHeight,t.majorLineWidth=1;var s=e.nextSibling,a=i.nextSibling;return e.parentNode&&e.parentNode.removeChild(e),i.parentNode&&i.parentNode.removeChild(i),e.style.height="".concat(this.props.height,"px"),this._repaintLabels(),s?n.insertBefore(e,s):n.appendChild(e),a?this.body.dom.backgroundVertical.insertBefore(i,a):this.body.dom.backgroundVertical.appendChild(i),this._isResized()||o}},{key:"_repaintLabels",value:function(){var t=this.options.orientation.axis,e=ih.convert(this.body.range.start,"Number"),i=ih.convert(this.body.range.end,"Number"),n=this.body.util.toTime((this.props.minorCharWidth||10)*this.options.maxMinorChars).valueOf(),o=n-Bh(this.options.moment,this.body.hiddenDates,this.body.range,n);o-=this.body.util.toTime(0).valueOf();var r=new ed(new Date(e),new Date(i),o,this.body.hiddenDates,this.options);r.setMoment(this.options.moment),this.options.format&&r.setFormat(this.options.format),this.options.timeAxis&&r.setScale(this.options.timeAxis),this.step=r;var s,a,l,c,h,d,u=this.dom;u.redundant.lines=u.lines,u.redundant.majorTexts=u.majorTexts,u.redundant.minorTexts=u.minorTexts,u.lines=[],u.majorTexts=[],u.minorTexts=[];var f,p,g,m=0,v=void 0,y=0,b=1e3;for(r.start(),a=r.getCurrent(),c=this.body.util.toScreen(a);r.hasNext()&&y<b;){switch(y++,h=r.isMajor(),g=r.getClassName(),s=a,l=c,r.next(),a=r.getCurrent(),f=m,m=(c=this.body.util.toScreen(a))-l,r.scale){case"week":d=!0;break;default:d=m>=.4*f}if(this.options.showMinorLabels&&d){var w=this._repaintMinorText(l,r.getLabelMinor(s),t,g);w.style.width="".concat(m,"px")}h&&this.options.showMajorLabels?(l>0&&(null==v&&(v=l),w=this._repaintMajorText(l,r.getLabelMajor(s),t,g)),p=this._repaintMajorLine(l,m,t,g)):d?p=this._repaintMinorLine(l,m,t,g):p&&(p.style.width="".concat(Lr(p.style.width)+m,"px"))}if(y!==b||nd||(console.warn("Something is wrong with the Timeline scale. Limited drawing of grid lines to ".concat(b," lines.")),nd=!0),this.options.showMajorLabels){var k=this.body.util.toTime(0),_=r.getLabelMajor(k);(null==v||_.length*(this.props.majorCharWidth||10)+10<v)&&this._repaintMajorText(0,_,t,g)}Bn(ih).call(ih,this.dom.redundant,function(t){for(;t.length;){var e=t.pop();e&&e.parentNode&&e.parentNode.removeChild(e)}})}},{key:"_repaintMinorText",value:function(t,e,i,n){var o=this.dom.redundant.minorTexts.shift();if(!o){var r=document.createTextNode("");(o=document.createElement("div")).appendChild(r),this.dom.foreground.appendChild(o)}return this.dom.minorTexts.push(o),o.innerHTML=ih.xss(e),this._setXY(o,t,"top"==i?this.props.majorLabelHeight:0),o.className="vis-text vis-minor ".concat(n),o}},{key:"_repaintMajorText",value:function(t,e,i,n){var o=this.dom.redundant.majorTexts.shift();if(!o){var r=document.createElement("div");(o=document.createElement("div")).appendChild(r),this.dom.foreground.appendChild(o)}return o.childNodes[0].innerHTML=ih.xss(e),o.className="vis-text vis-major ".concat(n),this._setXY(o,t,"top"==i?0:this.props.minorLabelHeight),this.dom.majorTexts.push(o),o}},{key:"_setXY",value:function(t,e,i){var n;t.style.transform=Zo(n="translate(".concat(this.options.rtl?-1*e:e,"px, ")).call(n,i,"px)")}},{key:"_repaintMinorLine",value:function(t,e,i,n){var o,r=this.dom.redundant.lines.shift();r||(r=document.createElement("div"),this.dom.background.appendChild(r)),this.dom.lines.push(r);var s=this.props;return r.style.width="".concat(e,"px"),r.style.height="".concat(s.minorLineHeight,"px"),this._setXY(r,t-s.minorLineWidth/2,"top"==i?s.majorLabelHeight:this.body.domProps.top.height),r.className=Zo(o="vis-grid ".concat(this.options.rtl?"vis-vertical-rtl":"vis-vertical"," vis-minor ")).call(o,n),r}},{key:"_repaintMajorLine",value:function(t,e,i,n){var o,r=this.dom.redundant.lines.shift();r||(r=document.createElement("div"),this.dom.background.appendChild(r)),this.dom.lines.push(r);var s=this.props;return r.style.width="".concat(e,"px"),r.style.height="".concat(s.majorLineHeight,"px"),this._setXY(r,t-s.majorLineWidth/2,"top"==i?0:this.body.domProps.top.height),r.className=Zo(o="vis-grid ".concat(this.options.rtl?"vis-vertical-rtl":"vis-vertical"," vis-major ")).call(o,n),r}},{key:"_calculateCharSize",value:function(){this.dom.measureCharMinor||(this.dom.measureCharMinor=document.createElement("DIV"),this.dom.measureCharMinor.className="vis-text vis-minor vis-measure",this.dom.measureCharMinor.style.position="absolute",this.dom.measureCharMinor.appendChild(document.createTextNode("0")),this.dom.foreground.appendChild(this.dom.measureCharMinor)),this.props.minorCharHeight=this.dom.measureCharMinor.clientHeight,this.props.minorCharWidth=this.dom.measureCharMinor.clientWidth,this.dom.measureCharMajor||(this.dom.measureCharMajor=document.createElement("DIV"),this.dom.measureCharMajor.className="vis-text vis-major vis-measure",this.dom.measureCharMajor.style.position="absolute",this.dom.measureCharMajor.appendChild(document.createTextNode("0")),this.dom.foreground.appendChild(this.dom.measureCharMajor)),this.props.majorCharHeight=this.dom.measureCharMajor.clientHeight,this.props.majorCharWidth=this.dom.measureCharMajor.clientWidth}}]),i}(ah),nd=!1;function od(t){var e,i;this.active=!1,this.dom={container:t},this.dom.overlay=document.createElement("div"),this.dom.overlay.className="vis-overlay",this.dom.container.appendChild(this.dom.overlay),this.hammer=Jh(this.dom.overlay),this.hammer.on("tap",An(e=this._onTapOverlay).call(e,this));var n=this,o=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];Bn(o).call(o,function(t){n.hammer.on(t,function(t){t.stopPropagation()})}),document&&document.body&&(this.onClick=function(e){(function(t,e){for(;t;){if(t===e)return!0;t=t.parentNode}return!1})(e.target,t)||n.deactivate()},document.body.addEventListener("click",this.onClick)),void 0!==this.keycharm&&this.keycharm.destroy(),this.keycharm=function(t){var e,i=window,n={},o={keydown:{},keyup:{}},r={};for(e=97;e<=122;e++)r[String.fromCharCode(e)]={code:e-97+65,shift:!1};for(e=65;e<=90;e++)r[String.fromCharCode(e)]={code:e,shift:!0};for(e=0;e<=9;e++)r[""+e]={code:48+e,shift:!1};for(e=1;e<=12;e++)r["F"+e]={code:111+e,shift:!1};for(e=0;e<=9;e++)r["num"+e]={code:96+e,shift:!1};r["num*"]={code:106,shift:!1},r["num+"]={code:107,shift:!1},r["num-"]={code:109,shift:!1},r["num/"]={code:111,shift:!1},r["num."]={code:110,shift:!1},r.left={code:37,shift:!1},r.up={code:38,shift:!1},r.right={code:39,shift:!1},r.down={code:40,shift:!1},r.space={code:32,shift:!1},r.enter={code:13,shift:!1},r.shift={code:16,shift:void 0},r.esc={code:27,shift:!1},r.backspace={code:8,shift:!1},r.tab={code:9,shift:!1},r.ctrl={code:17,shift:!1},r.alt={code:18,shift:!1},r.delete={code:46,shift:!1},r.pageup={code:33,shift:!1},r.pagedown={code:34,shift:!1},r["="]={code:187,shift:!1},r["-"]={code:189,shift:!1},r["]"]={code:221,shift:!1},r["["]={code:219,shift:!1};var s=function(t){l(t,"keydown")},a=function(t){l(t,"keyup")},l=function(t,e){if(void 0!==o[e][t.keyCode])for(var i=o[e][t.keyCode],n=0;n<i.length;n++)(void 0===i[n].shift||1==i[n].shift&&1==t.shiftKey||0==i[n].shift&&0==t.shiftKey)&&i[n].fn(t)};return n.bind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===r[t])throw new Error("unsupported key: "+t);void 0===o[i][r[t].code]&&(o[i][r[t].code]=[]),o[i][r[t].code].push({fn:e,shift:r[t].shift})},n.bindAll=function(t,e){for(var i in void 0===e&&(e="keydown"),r)r.hasOwnProperty(i)&&n.bind(i,t,e)},n.getKey=function(t){for(var e in r)if(r.hasOwnProperty(e)){if(1==t.shiftKey&&1==r[e].shift&&t.keyCode==r[e].code)return e;if(0==t.shiftKey&&0==r[e].shift&&t.keyCode==r[e].code)return e;if(t.keyCode==r[e].code&&"shift"==e)return e}return"unknown key, currently not supported"},n.unbind=function(t,e,i){if(void 0===i&&(i="keydown"),void 0===r[t])throw new Error("unsupported key: "+t);if(void 0!==e){var n=[],s=o[i][r[t].code];if(void 0!==s)for(var a=0;a<s.length;a++)s[a].fn==e&&s[a].shift==r[t].shift||n.push(o[i][r[t].code][a]);o[i][r[t].code]=n}else o[i][r[t].code]=[]},n.reset=function(){o={keydown:{},keyup:{}}},n.destroy=function(){o={keydown:{},keyup:{}},i.removeEventListener("keydown",s,!0),i.removeEventListener("keyup",a,!0)},i.addEventListener("keydown",s,!0),i.addEventListener("keyup",a,!0),n}(),this.escListener=An(i=this.deactivate).call(i,this)}ls(od.prototype),od.current=null,od.prototype.destroy=function(){this.deactivate(),this.dom.overlay.parentNode.removeChild(this.dom.overlay),this.onClick&&document.body.removeEventListener("click",this.onClick),void 0!==this.keycharm&&this.keycharm.destroy(),this.keycharm=null,this.hammer.destroy(),this.hammer=null},od.prototype.activate=function(){var t;od.current&&od.current.deactivate(),od.current=this,this.active=!0,this.dom.overlay.style.display="none",ih.addClassName(this.dom.container,"vis-active"),this.emit("change"),this.emit("activate"),An(t=this.keycharm).call(t,"esc",this.escListener)},od.prototype.deactivate=function(){od.current===this&&(od.current=null),this.active=!1,this.dom.overlay.style.display="",ih.removeClassName(this.dom.container,"vis-active"),this.keycharm.unbind("esc",this.escListener),this.emit("change"),this.emit("deactivate")},od.prototype._onTapOverlay=function(t){this.activate(),t.stopPropagation()};var rd={current:"current",time:"time",deleteSelected:"Delete selected"},sd={current:"attuale",time:"tempo",deleteSelected:"Cancella la selezione"},ad={current:"huidige",time:"tijd",deleteSelected:"Selectie verwijderen"},ld={current:"Aktuelle",time:"Zeit",deleteSelected:"L\xf6sche Auswahl"},cd={current:"actuel",time:"heure",deleteSelected:"Effacer la selection"},hd={current:"corriente",time:"hora",deleteSelected:"Eliminar selecci\xf3n"},dd={current:"\u043f\u043e\u0442\u043e\u0447\u043d\u0438\u0439",time:"\u0447\u0430\u0441",deleteSelected:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u043e\u0431\u0440\u0430\u043d\u0435"},ud={current:"\u0442\u0435\u043a\u0443\u0449\u0435\u0435",time:"\u0432\u0440\u0435\u043c\u044f",deleteSelected:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u0435"},fd={current:"aktualny",time:"czas",deleteSelected:"Usu\u0144 wybrane"},pd={current:"atual",time:"data",deleteSelected:"Apagar selecionado"},gd={current:"\u73fe\u5728",time:"\u6642\u523b",deleteSelected:"\u9078\u629e\u3055\u308c\u305f\u3082\u306e\u3092\u524a\u9664"},md={current:"nuvarande",time:"tid",deleteSelected:"Radera valda"},vd={current:"n\xe5v\xe6rende",time:"tid",deleteSelected:"Slett valgte"},yd={en:rd,en_EN:rd,en_US:rd,it:sd,it_IT:sd,it_CH:sd,nl:ad,nl_NL:ad,nl_BE:ad,de:ld,de_DE:ld,fr:cd,fr_FR:cd,fr_CA:cd,fr_BE:cd,es:hd,es_ES:hd,uk:dd,uk_UA:dd,ru:ud,ru_RU:ud,pl:fd,pl_PL:fd,pt:pd,pt_BR:pd,pt_PT:pd,ja:gd,ja_JP:gd,sv:md,sv_SE:md,nb:vd,nn:vd,nb_NO:vd,nn_NO:vd},bd=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n){var o,r;zt(this,i),(r=e.call(this)).body=t,r.defaultOptions={moment:jn,locales:yd,locale:"en",id:void 0,title:void 0},r.options=ih.extend({},r.defaultOptions),r.setOptions(n),r.options.locales=ih.extend({},yd,r.options.locales);var s=r.defaultOptions.locales[r.defaultOptions.locale];return Bn(o=go(r.options.locales)).call(o,function(t){r.options.locales[t]=ih.extend({},s,r.options.locales[t])}),r.customTime=n&&null!=n.time?n.time:new Date,r.eventParams={},r._create(),r}return jt(i,[{key:"setOptions",value:function(t){t&&ih.selectiveExtend(["moment","locale","locales","id","title","rtl","snap"],this.options,t)}},{key:"_create",value:function(){var t,e,i,n=document.createElement("div");n["custom-time"]=this,n.className="vis-custom-time ".concat(this.options.id||""),n.style.position="absolute",n.style.top="0px",n.style.height="100%",this.bar=n;var o=document.createElement("div");function r(t){this.body.range._onMouseWheel(t)}o.style.position="relative",o.style.top="0px",this.options.rtl?o.style.right="-10px":o.style.left="-10px",o.style.height="100%",o.style.width="20px",o.addEventListener?(o.addEventListener("mousewheel",An(r).call(r,this),!1),o.addEventListener("DOMMouseScroll",An(r).call(r,this),!1)):o.attachEvent("onmousewheel",An(r).call(r,this)),n.appendChild(o),this.hammer=new Jh(o),this.hammer.on("panstart",An(t=this._onDragStart).call(t,this)),this.hammer.on("panmove",An(e=this._onDrag).call(e,this)),this.hammer.on("panend",An(i=this._onDragEnd).call(i,this)),this.hammer.get("pan").set({threshold:5,direction:Jh.DIRECTION_ALL}),this.hammer.get("press").set({time:1e4})}},{key:"destroy",value:function(){this.hide(),this.hammer.destroy(),this.hammer=null,this.body=null}},{key:"redraw",value:function(){var t=this.body.dom.backgroundVertical;this.bar.parentNode!=t&&(this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),t.appendChild(this.bar));var e=this.body.util.toScreen(this.customTime),i=this.options.locales[this.options.locale];i||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),i=this.options.locales.en);var n,o=this.options.title;return void 0===o?o=(o=Zo(n="".concat(i.time,": ")).call(n,this.options.moment(this.customTime).format("dddd, MMMM Do YYYY, H:mm:ss"))).charAt(0).toUpperCase()+o.substring(1):"function"==typeof o&&(o=o.call(this,this.customTime)),this.options.rtl?this.bar.style.right="".concat(e,"px"):this.bar.style.left="".concat(e,"px"),this.bar.title=o,!1}},{key:"hide",value:function(){this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar)}},{key:"setCustomTime",value:function(t){this.customTime=ih.convert(t,"Date"),this.redraw()}},{key:"getCustomTime",value:function(){return new Date(this.customTime.valueOf())}},{key:"setCustomMarker",value:function(t,e){var i,n,o=document.createElement("div");o.className="vis-custom-time-marker",o.innerHTML=ih.xss(t),o.style.position="absolute",e&&(o.setAttribute("contenteditable","true"),o.addEventListener("pointerdown",function(){o.focus()}),o.addEventListener("input",An(i=this._onMarkerChange).call(i,this)),o.title=t,o.addEventListener("blur",An(n=function(t){this.title!=t.target.innerHTML&&(this._onMarkerChanged(t),this.title=t.target.innerHTML)}).call(n,this))),this.bar.appendChild(o)}},{key:"setCustomTitle",value:function(t){this.options.title=t}},{key:"_onDragStart",value:function(t){this.eventParams.dragging=!0,this.eventParams.customTime=this.customTime,t.stopPropagation()}},{key:"_onDrag",value:function(t){if(this.eventParams.dragging){var e=this.options.rtl?-1*t.deltaX:t.deltaX,i=this.body.util.toScreen(this.eventParams.customTime)+e,n=this.body.util.toTime(i),o=this.body.util.getScale(),r=this.body.util.getStep(),s=this.options.snap,a=s?s(n,o,r):n;this.setCustomTime(a),this.body.emitter.emit("timechange",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:t}),t.stopPropagation()}}},{key:"_onDragEnd",value:function(t){this.eventParams.dragging&&(this.body.emitter.emit("timechanged",{id:this.options.id,time:new Date(this.customTime.valueOf()),event:t}),t.stopPropagation())}},{key:"_onMarkerChange",value:function(t){this.body.emitter.emit("markerchange",{id:this.options.id,title:t.target.innerHTML,event:t}),t.stopPropagation()}},{key:"_onMarkerChanged",value:function(t){this.body.emitter.emit("markerchanged",{id:this.options.id,title:t.target.innerHTML,event:t}),t.stopPropagation()}}],[{key:"customTimeFromTarget",value:function(t){for(var e=t.target;e;){if(e.hasOwnProperty("custom-time"))return e["custom-time"];e=e.parentNode}return null}}]),i}(ah),wd=function(){function t(){zt(this,t)}return jt(t,[{key:"_create",value:function(t){var e,i,n,o=this;this.dom={},this.dom.container=t,this.dom.container.style.position="relative",this.dom.root=document.createElement("div"),this.dom.background=document.createElement("div"),this.dom.backgroundVertical=document.createElement("div"),this.dom.backgroundHorizontal=document.createElement("div"),this.dom.centerContainer=document.createElement("div"),this.dom.leftContainer=document.createElement("div"),this.dom.rightContainer=document.createElement("div"),this.dom.center=document.createElement("div"),this.dom.left=document.createElement("div"),this.dom.right=document.createElement("div"),this.dom.top=document.createElement("div"),this.dom.bottom=document.createElement("div"),this.dom.shadowTop=document.createElement("div"),this.dom.shadowBottom=document.createElement("div"),this.dom.shadowTopLeft=document.createElement("div"),this.dom.shadowBottomLeft=document.createElement("div"),this.dom.shadowTopRight=document.createElement("div"),this.dom.shadowBottomRight=document.createElement("div"),this.dom.rollingModeBtn=document.createElement("div"),this.dom.loadingScreen=document.createElement("div"),this.dom.root.className="vis-timeline",this.dom.background.className="vis-panel vis-background",this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical",this.dom.backgroundHorizontal.className="vis-panel vis-background vis-horizontal",this.dom.centerContainer.className="vis-panel vis-center",this.dom.leftContainer.className="vis-panel vis-left",this.dom.rightContainer.className="vis-panel vis-right",this.dom.top.className="vis-panel vis-top",this.dom.bottom.className="vis-panel vis-bottom",this.dom.left.className="vis-content",this.dom.center.className="vis-content",this.dom.right.className="vis-content",this.dom.shadowTop.className="vis-shadow vis-top",this.dom.shadowBottom.className="vis-shadow vis-bottom",this.dom.shadowTopLeft.className="vis-shadow vis-top",this.dom.shadowBottomLeft.className="vis-shadow vis-bottom",this.dom.shadowTopRight.className="vis-shadow vis-top",this.dom.shadowBottomRight.className="vis-shadow vis-bottom",this.dom.rollingModeBtn.className="vis-rolling-mode-btn",this.dom.loadingScreen.className="vis-loading-screen",this.dom.root.appendChild(this.dom.background),this.dom.root.appendChild(this.dom.backgroundVertical),this.dom.root.appendChild(this.dom.backgroundHorizontal),this.dom.root.appendChild(this.dom.centerContainer),this.dom.root.appendChild(this.dom.leftContainer),this.dom.root.appendChild(this.dom.rightContainer),this.dom.root.appendChild(this.dom.top),this.dom.root.appendChild(this.dom.bottom),this.dom.root.appendChild(this.dom.rollingModeBtn),this.dom.centerContainer.appendChild(this.dom.center),this.dom.leftContainer.appendChild(this.dom.left),this.dom.rightContainer.appendChild(this.dom.right),this.dom.centerContainer.appendChild(this.dom.shadowTop),this.dom.centerContainer.appendChild(this.dom.shadowBottom),this.dom.leftContainer.appendChild(this.dom.shadowTopLeft),this.dom.leftContainer.appendChild(this.dom.shadowBottomLeft),this.dom.rightContainer.appendChild(this.dom.shadowTopRight),this.dom.rightContainer.appendChild(this.dom.shadowBottomRight),this.props={root:{},background:{},centerContainer:{},leftContainer:{},rightContainer:{},center:{},left:{},right:{},top:{},bottom:{},border:{},scrollTop:0,scrollTopMin:0},this.on("rangechange",function(){!0===o.initialDrawDone&&o._redraw()}),this.on("rangechanged",function(){o.initialRangeChangeDone||(o.initialRangeChangeDone=!0)}),this.on("touch",An(e=this._onTouch).call(e,this)),this.on("panmove",An(i=this._onDrag).call(i,this));var r=this;this._origRedraw=An(n=this._redraw).call(n,this),this._redraw=ih.throttle(this._origRedraw),this.on("_change",function(t){r.itemSet&&r.itemSet.initialItemSetDrawn&&t&&1==t.queue?r._redraw():r._origRedraw()}),this.hammer=new Jh(this.dom.root);var s=this.hammer.get("pinch").set({enable:!0});s&&function(t){t.getTouchAction=function(){return["pan-y"]}}(s),this.hammer.get("pan").set({threshold:5,direction:Jh.DIRECTION_ALL}),this.timelineListeners={};var a,l,c=["tap","doubletap","press","pinch","pan","panstart","panmove","panend"];function h(t){this.isActive()&&this.emit("mousewheel",t);var e=0,i=0;if("detail"in t&&(i=-1*t.detail),"wheelDelta"in t&&(i=t.wheelDelta),"wheelDeltaY"in t&&(i=t.wheelDeltaY),"wheelDeltaX"in t&&(e=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=-1*i,i=0),"deltaY"in t&&(i=-1*t.deltaY),"deltaX"in t&&(e=t.deltaX),t.deltaMode&&(1===t.deltaMode?(e*=40,i*=40):(e*=40,i*=800)),this.options.preferZoom){if(!this.options.zoomKey||t[this.options.zoomKey])return}else if(this.options.zoomKey&&t[this.options.zoomKey])return;if(this.options.verticalScroll||this.options.horizontalScroll)if(this.options.verticalScroll&&Math.abs(i)>=Math.abs(e)){var n=this.props.scrollTop,o=n+i;this.isActive()&&this._setScrollTop(o)!==n&&(this._redraw(),this.emit("scroll",t),t.preventDefault())}else if(this.options.horizontalScroll){var r=(Math.abs(e)>=Math.abs(i)?e:i)/120*(this.range.end-this.range.start)/20;this.range.setRange(this.range.start+r,this.range.end+r,{animation:!1,byUser:!0,event:t}),t.preventDefault()}}Bn(c).call(c,function(t){var e=function(e){r.isActive()&&r.emit(t,e)};r.hammer.on(t,e),r.timelineListeners[t]=e}),td(this.hammer,function(t){r.emit("touch",t)}),a=this.hammer,(l=function(t){r.emit("release",t)}).inputHandler=function(t){t.isFinal&&l(t)},a.on("hammer.input",l.inputHandler);var d="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":this.dom.centerContainer.addEventListener?"DOMMouseScroll":"onmousewheel";function u(t){r.options.verticalScroll&&(t.preventDefault(),r.isActive())&&(r._setScrollTop(-t.target.scrollTop),r._redraw(),r.emit("scrollSide",t))}this.dom.centerContainer.addEventListener(d,An(h).call(h,this),!1),this.dom.top.addEventListener(d,An(h).call(h,this),!1),this.dom.bottom.addEventListener(d,An(h).call(h,this),!1),this.dom.left.parentNode.addEventListener("scroll",An(u).call(u,this)),this.dom.right.parentNode.addEventListener("scroll",An(u).call(u,this));var f=!1;function p(t){var e;if(t.preventDefault&&(r.emit("dragover",r.getEventProperties(t)),t.preventDefault()),Yr(e=t.target.className).call(e,"timeline")>-1&&!f)return t.dataTransfer.dropEffect="move",f=!0,!1}function g(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation();try{var e=JSON.parse(t.dataTransfer.getData("text"));if(!e||!e.content)return}catch(t){return!1}return f=!1,t.center={x:t.clientX,y:t.clientY},"item"!==e.target?r.itemSet._onAddItem(t):r.itemSet._onDropObjectOnItem(t),r.emit("drop",r.getEventProperties(t)),!1}if(this.dom.center.addEventListener("dragover",An(p).call(p,this),!1),this.dom.center.addEventListener("drop",An(g).call(g,this),!1),this.customTimes=[],this.touch={},this.redrawCount=0,this.initialDrawDone=!1,this.initialRangeChangeDone=!1,!t)throw new Error("No container provided");t.appendChild(this.dom.root),t.appendChild(this.dom.loadingScreen)}},{key:"setOptions",value:function(t){var e;if(t){if(ih.selectiveExtend(["width","height","minHeight","maxHeight","autoResize","start","end","clickToUse","dataAttributes","hiddenDates","locale","locales","moment","preferZoom","rtl","zoomKey","horizontalScroll","verticalScroll","longSelectPressTime","snap"],this.options,t),this.dom.rollingModeBtn.style.visibility="hidden",this.options.rtl&&(this.dom.container.style.direction="rtl",this.dom.backgroundVertical.className="vis-panel vis-background vis-vertical-rtl"),this.options.verticalScroll&&(this.options.rtl?this.dom.rightContainer.className="vis-panel vis-right vis-vertical-scroll":this.dom.leftContainer.className="vis-panel vis-left vis-vertical-scroll"),"object"!==vn(this.options.orientation)&&(this.options.orientation={item:void 0,axis:void 0}),"orientation"in t&&("string"==typeof t.orientation?this.options.orientation={item:t.orientation,axis:t.orientation}:"object"===vn(t.orientation)&&("item"in t.orientation&&(this.options.orientation.item=t.orientation.item),"axis"in t.orientation&&(this.options.orientation.axis=t.orientation.axis))),"both"===this.options.orientation.axis){if(!this.timeAxis2){var i=this.timeAxis2=new id(this.body);i.setOptions=function(t){var e=t?ih.extend({},t):{};e.orientation="top",id.prototype.setOptions.call(i,e)},this.components.push(i)}}else if(this.timeAxis2){var n,o,r=Yr(n=this.components).call(n,this.timeAxis2);-1!==r&&cr(o=this.components).call(o,r,1),this.timeAxis2.destroy(),this.timeAxis2=null}"function"==typeof t.drawPoints&&(t.drawPoints={onRender:t.drawPoints}),"hiddenDates"in this.options&&Ih(this.options.moment,this.body,this.options.hiddenDates),"clickToUse"in t&&(t.clickToUse?this.activator||(this.activator=new od(this.dom.root)):this.activator&&(this.activator.destroy(),delete this.activator)),this._initAutoResize()}if(Bn(e=this.components).call(e,function(e){return e.setOptions(t)}),"configure"in t){var s;this.configurator||(this.configurator=this._createConfigurator()),this.configurator.setOptions(t.configure);var a=ih.deepExtend({},this.options);Bn(s=this.components).call(s,function(t){ih.deepExtend(a,t.options)}),this.configurator.setModuleOptions({global:a})}this._redraw()}},{key:"isActive",value:function(){return!this.activator||this.activator.active}},{key:"destroy",value:function(){var t;for(var e in this.setItems(null),this.setGroups(null),this.off(),this._stopAutoResize(),this.dom.root.parentNode&&this.dom.root.parentNode.removeChild(this.dom.root),this.dom=null,this.activator&&(this.activator.destroy(),delete this.activator),this.timelineListeners)this.timelineListeners.hasOwnProperty(e)&&delete this.timelineListeners[e];this.timelineListeners=null,this.hammer&&this.hammer.destroy(),this.hammer=null,Bn(t=this.components).call(t,function(t){return t.destroy()}),this.body=null}},{key:"setCustomTime",value:function(t,e){var i,n=Yn(i=this.customTimes).call(i,function(t){return e===t.options.id});if(0===n.length)throw new Error("No custom time bar found with id ".concat(os(e)));n.length>0&&n[0].setCustomTime(t)}},{key:"getCustomTime",value:function(t){var e,i=Yn(e=this.customTimes).call(e,function(e){return e.options.id===t});if(0===i.length)throw new Error("No custom time bar found with id ".concat(os(t)));return i[0].getCustomTime()}},{key:"setCustomTimeMarker",value:function(t,e,i){var n,o=Yn(n=this.customTimes).call(n,function(t){return t.options.id===e});if(0===o.length)throw new Error("No custom time bar found with id ".concat(os(e)));o.length>0&&o[0].setCustomMarker(t,i)}},{key:"setCustomTimeTitle",value:function(t,e){var i,n=Yn(i=this.customTimes).call(i,function(t){return t.options.id===e});if(0===n.length)throw new Error("No custom time bar found with id ".concat(os(e)));if(n.length>0)return n[0].setCustomTitle(t)}},{key:"getEventProperties",value:function(t){return{event:t}}},{key:"addCustomTime",value:function(t,e){var i,n=void 0!==t?ih.convert(t,"Date"):new Date;if(Xh(i=this.customTimes).call(i,function(t){return t.options.id===e}))throw new Error("A custom time with id ".concat(os(e)," already exists"));var o=new bd(this.body,ih.extend({},this.options,{time:n,id:e,snap:this.itemSet?this.itemSet.options.snap:this.options.snap}));return this.customTimes.push(o),this.components.push(o),this._redraw(),e}},{key:"removeCustomTime",value:function(t){var e,i=this,n=Yn(e=this.customTimes).call(e,function(e){return e.options.id===t});if(0===n.length)throw new Error("No custom time bar found with id ".concat(os(t)));Bn(n).call(n,function(t){var e,n,o,r;cr(e=i.customTimes).call(e,Yr(n=i.customTimes).call(n,t),1),cr(o=i.components).call(o,Yr(r=i.components).call(r,t),1),t.destroy()})}},{key:"getVisibleItems",value:function(){return this.itemSet&&this.itemSet.getVisibleItems()||[]}},{key:"getItemsAtCurrentTime",value:function(t){return this.time=t,this.itemSet&&this.itemSet.getItemsAtCurrentTime(this.time)||[]}},{key:"getVisibleGroups",value:function(){return this.itemSet&&this.itemSet.getVisibleGroups()||[]}},{key:"fit",value:function(t,e){var i=this.getDataRange();if(null!==i.min||null!==i.max){var n=i.max-i.min,o=new Date(i.min.valueOf()-.01*n),r=new Date(i.max.valueOf()+.01*n);this.range.setRange(o,r,{animation:!t||void 0===t.animation||t.animation},e)}}},{key:"getDataRange",value:function(){throw new Error("Cannot invoke abstract method getDataRange")}},{key:"setWindow",value:function(t,e,i,n){var o,r;"function"==typeof arguments[2]&&(n=arguments[2],i={}),1==arguments.length?(o=void 0===(r=arguments[0]).animation||r.animation,this.range.setRange(r.start,r.end,{animation:o})):2==arguments.length&&"function"==typeof arguments[1]?(o=void 0===(r=arguments[0]).animation||r.animation,this.range.setRange(r.start,r.end,{animation:o},n=arguments[1])):this.range.setRange(t,e,{animation:o=!i||void 0===i.animation||i.animation},n)}},{key:"moveTo",value:function(t,e,i){"function"==typeof arguments[1]&&(i=arguments[1],e={});var n=this.range.end-this.range.start,o=ih.convert(t,"Date").valueOf();this.range.setRange(o-n/2,o+n/2,{animation:!e||void 0===e.animation||e.animation},i)}},{key:"getWindow",value:function(){var t=this.range.getRange();return{start:new Date(t.start),end:new Date(t.end)}}},{key:"zoomIn",value:function(t,e,i){if(!(!t||t<0||t>1)){"function"==typeof arguments[1]&&(i=arguments[1],e={});var n=this.getWindow(),o=n.start.valueOf(),r=n.end.valueOf(),s=r-o,a=(s-s/(1+t))/2;this.setWindow(o+a,r-a,e,i)}}},{key:"zoomOut",value:function(t,e,i){if(!(!t||t<0||t>1)){"function"==typeof arguments[1]&&(i=arguments[1],e={});var n=this.getWindow(),o=n.start.valueOf(),r=n.end.valueOf(),s=r-o;this.setWindow(o-s*t/2,r+s*t/2,e,i)}}},{key:"redraw",value:function(){this._redraw()}},{key:"_redraw",value:function(){var t;this.redrawCount++;var e=this.dom;if(e&&e.container&&0!=e.root.offsetWidth){var i=!1,n=this.options,o=this.props;Ph(this.options.moment,this.body,this.options.hiddenDates),"top"==n.orientation?(ih.addClassName(e.root,"vis-top"),ih.removeClassName(e.root,"vis-bottom")):(ih.removeClassName(e.root,"vis-top"),ih.addClassName(e.root,"vis-bottom")),n.rtl?(ih.addClassName(e.root,"vis-rtl"),ih.removeClassName(e.root,"vis-ltr")):(ih.addClassName(e.root,"vis-ltr"),ih.removeClassName(e.root,"vis-rtl")),e.root.style.maxHeight=ih.option.asSize(n.maxHeight,""),e.root.style.minHeight=ih.option.asSize(n.minHeight,""),e.root.style.width=ih.option.asSize(n.width,"");var r=e.root.offsetWidth;o.border.left=1,o.border.right=1,o.border.top=1,o.border.bottom=1,o.center.height=e.center.offsetHeight,o.left.height=e.left.offsetHeight,o.right.height=e.right.offsetHeight,o.top.height=e.top.clientHeight||-o.border.top,o.bottom.height=Math.round(e.bottom.getBoundingClientRect().height)||e.bottom.clientHeight||-o.border.bottom;var s=Math.max(o.left.height,o.center.height,o.right.height);e.root.style.height=ih.option.asSize(n.height,"".concat(o.top.height+s+o.bottom.height+o.border.top+o.border.bottom,"px")),o.root.height=e.root.offsetHeight,o.background.height=o.root.height;var a=o.root.height-o.top.height-o.bottom.height;o.centerContainer.height=a,o.leftContainer.height=a,o.rightContainer.height=o.leftContainer.height,o.root.width=r,o.background.width=o.root.width,this.initialDrawDone||(o.scrollbarWidth=ih.getScrollBarWidth());var l=e.leftContainer.clientWidth,c=e.rightContainer.clientWidth;n.verticalScroll?n.rtl?(o.left.width=l||-o.border.left,o.right.width=c+o.scrollbarWidth||-o.border.right):(o.left.width=l+o.scrollbarWidth||-o.border.left,o.right.width=c||-o.border.right):(o.left.width=l||-o.border.left,o.right.width=c||-o.border.right),this._setDOM();var h=this._updateScrollTop();"top"!=n.orientation.item&&(h+=Math.max(o.centerContainer.height-o.center.height-o.border.top-o.border.bottom,0)),e.center.style.transform="translateY(".concat(h,"px)");var d=0==o.scrollTop?"hidden":"",u=o.scrollTop==o.scrollTopMin?"hidden":"";e.shadowTop.style.visibility=d,e.shadowBottom.style.visibility=u,e.shadowTopLeft.style.visibility=d,e.shadowBottomLeft.style.visibility=u,e.shadowTopRight.style.visibility=d,e.shadowBottomRight.style.visibility=u,n.verticalScroll&&(e.rightContainer.className="vis-panel vis-right vis-vertical-scroll",e.leftContainer.className="vis-panel vis-left vis-vertical-scroll",e.shadowTopRight.style.visibility="hidden",e.shadowBottomRight.style.visibility="hidden",e.shadowTopLeft.style.visibility="hidden",e.shadowBottomLeft.style.visibility="hidden",e.left.style.top="0px",e.right.style.top="0px"),(!n.verticalScroll||o.center.height<o.centerContainer.height)&&(e.left.style.top="".concat(h,"px"),e.right.style.top="".concat(h,"px"),e.rightContainer.className=e.rightContainer.className.replace(new RegExp("(?:^|\\s)vis-vertical-scroll(?:\\s|$)")," "),e.leftContainer.className=e.leftContainer.className.replace(new RegExp("(?:^|\\s)vis-vertical-scroll(?:\\s|$)")," "),o.left.width=l||-o.border.left,o.right.width=c||-o.border.right,this._setDOM());var f=o.center.height>o.centerContainer.height;if(this.hammer.get("pan").set({direction:f?Jh.DIRECTION_ALL:Jh.DIRECTION_HORIZONTAL}),this.hammer.get("press").set({time:this.options.longSelectPressTime}),Bn(t=this.components).call(t,function(t){i=t.redraw()||i}),i){if(this.redrawCount<5)return void this.body.emitter.emit("_change");console.log("WARNING: infinite loop in redraw?")}else this.redrawCount=0;this.body.emitter.emit("changed")}}},{key:"_setDOM",value:function(){var t=this.props,e=this.dom;t.leftContainer.width=t.left.width,t.rightContainer.width=t.right.width;var i=t.root.width-t.left.width-t.right.width;t.center.width=i,t.centerContainer.width=i,t.top.width=i,t.bottom.width=i,e.background.style.height="".concat(t.background.height,"px"),e.backgroundVertical.style.height="".concat(t.background.height,"px"),e.backgroundHorizontal.style.height="".concat(t.centerContainer.height,"px"),e.centerContainer.style.height="".concat(t.centerContainer.height,"px"),e.leftContainer.style.height="".concat(t.leftContainer.height,"px"),e.rightContainer.style.height="".concat(t.rightContainer.height,"px"),e.background.style.width="".concat(t.background.width,"px"),e.backgroundVertical.style.width="".concat(t.centerContainer.width,"px"),e.backgroundHorizontal.style.width="".concat(t.background.width,"px"),e.centerContainer.style.width="".concat(t.center.width,"px"),e.top.style.width="".concat(t.top.width,"px"),e.bottom.style.width="".concat(t.bottom.width,"px"),e.background.style.left="0",e.background.style.top="0",e.backgroundVertical.style.left="".concat(t.left.width+t.border.left,"px"),e.backgroundVertical.style.top="0",e.backgroundHorizontal.style.left="0",e.backgroundHorizontal.style.top="".concat(t.top.height,"px"),e.centerContainer.style.left="".concat(t.left.width,"px"),e.centerContainer.style.top="".concat(t.top.height,"px"),e.leftContainer.style.left="0",e.leftContainer.style.top="".concat(t.top.height,"px"),e.rightContainer.style.left="".concat(t.left.width+t.center.width,"px"),e.rightContainer.style.top="".concat(t.top.height,"px"),e.top.style.left="".concat(t.left.width,"px"),e.top.style.top="0",e.bottom.style.left="".concat(t.left.width,"px"),e.bottom.style.top="".concat(t.top.height+t.centerContainer.height,"px"),e.center.style.left="0",e.left.style.left="0",e.right.style.left="0"}},{key:"setCurrentTime",value:function(t){if(!this.currentTime)throw new Error("Option showCurrentTime must be true");this.currentTime.setCurrentTime(t)}},{key:"getCurrentTime",value:function(){if(!this.currentTime)throw new Error("Option showCurrentTime must be true");return this.currentTime.getCurrentTime()}},{key:"_toTime",value:function(t){return Rh(this,t,this.props.center.width)}},{key:"_toGlobalTime",value:function(t){return Rh(this,t,this.props.root.width)}},{key:"_toScreen",value:function(t){return Nh(this,t,this.props.center.width)}},{key:"_toGlobalScreen",value:function(t){return Nh(this,t,this.props.root.width)}},{key:"_initAutoResize",value:function(){1==this.options.autoResize?this._startAutoResize():this._stopAutoResize()}},{key:"_startAutoResize",value:function(){var t=this;this._stopAutoResize(),this._onResize=function(){if(1==t.options.autoResize){if(t.dom.root){var e=t.dom.root.offsetHeight,i=t.dom.root.offsetWidth;i==t.props.lastWidth&&e==t.props.lastHeight||(t.props.lastWidth=i,t.props.lastHeight=e,t.props.scrollbarWidth=ih.getScrollBarWidth(),t.body.emitter.emit("_change"))}}else t._stopAutoResize()},ih.addEventListener(window,"resize",this._onResize),t.dom.root&&(t.props.lastWidth=t.dom.root.offsetWidth,t.props.lastHeight=t.dom.root.offsetHeight),this.watchTimer=Kh(this._onResize,1e3)}},{key:"_stopAutoResize",value:function(){this.watchTimer&&(clearInterval(this.watchTimer),this.watchTimer=void 0),this._onResize&&(ih.removeEventListener(window,"resize",this._onResize),this._onResize=null)}},{key:"_onTouch",value:function(t){this.touch.allowDragging=!0,this.touch.initialScrollTop=this.props.scrollTop}},{key:"_onPinch",value:function(t){this.touch.allowDragging=!1}},{key:"_onDrag",value:function(t){if(t&&this.touch.allowDragging){var e=t.deltaY,i=this._getScrollTop(),n=this._setScrollTop(this.touch.initialScrollTop+e);this.options.verticalScroll&&(this.dom.left.parentNode.scrollTop=-this.props.scrollTop,this.dom.right.parentNode.scrollTop=-this.props.scrollTop),n!=i&&this.emit("verticalDrag")}}},{key:"_setScrollTop",value:function(t){return this.props.scrollTop=t,this._updateScrollTop(),this.props.scrollTop}},{key:"_updateScrollTop",value:function(){var t=Math.min(this.props.centerContainer.height-this.props.border.top-this.props.border.bottom-this.props.center.height,0);return t!=this.props.scrollTopMin&&("top"!=this.options.orientation.item&&(this.props.scrollTop+=t-this.props.scrollTopMin),this.props.scrollTopMin=t),this.props.scrollTop>0&&(this.props.scrollTop=0),this.props.scrollTop<t&&(this.props.scrollTop=t),this.options.verticalScroll&&(this.dom.left.parentNode.scrollTop=-this.props.scrollTop,this.dom.right.parentNode.scrollTop=-this.props.scrollTop),this.props.scrollTop}},{key:"_getScrollTop",value:function(){return this.props.scrollTop}},{key:"_createConfigurator",value:function(){throw new Error("Cannot invoke abstract method _createConfigurator")}}]),t}();ls(wd.prototype);var kd=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n){var o,r;zt(this,i),(r=e.call(this)).body=t,r.defaultOptions={rtl:!1,showCurrentTime:!0,alignCurrentTime:void 0,moment:jn,locales:yd,locale:"en"},r.options=ih.extend({},r.defaultOptions),r.setOptions(n),r.options.locales=ih.extend({},yd,r.options.locales);var s=r.defaultOptions.locales[r.defaultOptions.locale];return Bn(o=go(r.options.locales)).call(o,function(t){r.options.locales[t]=ih.extend({},s,r.options.locales[t])}),r.offset=0,r._create(),r}return jt(i,[{key:"_create",value:function(){var t=document.createElement("div");t.className="vis-current-time",t.style.position="absolute",t.style.top="0px",t.style.height="100%",this.bar=t}},{key:"destroy",value:function(){this.options.showCurrentTime=!1,this.redraw(),this.body=null}},{key:"setOptions",value:function(t){t&&ih.selectiveExtend(["rtl","showCurrentTime","alignCurrentTime","moment","locale","locales"],this.options,t)}},{key:"redraw",value:function(){if(this.options.showCurrentTime){var t,e,i=this.body.dom.backgroundVertical;this.bar.parentNode!=i&&(this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),i.appendChild(this.bar),this.start());var n=this.options.moment(Ko()+this.offset);this.options.alignCurrentTime&&(n=n.startOf(this.options.alignCurrentTime));var o=this.body.util.toScreen(n),r=this.options.locales[this.options.locale];r||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),r=this.options.locales.en);var s=Zo(t=Zo(e="".concat(r.current," ")).call(e,r.time,": ")).call(t,n.format("dddd, MMMM Do YYYY, H:mm:ss"));s=s.charAt(0).toUpperCase()+s.substring(1),this.bar.style.transform="translateX(".concat(this.options.rtl?-1*o:o,"px)"),this.bar.title=s}else this.bar.parentNode&&this.bar.parentNode.removeChild(this.bar),this.stop();return!1}},{key:"start",value:function(){var t=this;!function e(){t.stop();var i=1/t.body.range.conversion(t.body.domProps.center.width).scale/10;i<30&&(i=30),i>1e3&&(i=1e3),t.redraw(),t.body.emitter.emit("currentTimeTick"),t.currentTimeTimer=Mn(e,i)}()}},{key:"stop",value:function(){void 0!==this.currentTimeTimer&&(clearTimeout(this.currentTimeTimer),delete this.currentTimeTimer)}},{key:"setCurrentTime",value:function(t){var e=ih.convert(t,"Date").valueOf(),i=Ko();this.offset=e-i,this.redraw()}},{key:"getCurrentTime",value:function(){return new Date(Ko()+this.offset)}}]),i}(ah),_d=ei.find,xd=!0;"find"in[]&&Array(1).find(function(){xd=!1}),Z({target:"Array",proto:!0,forced:xd},{find:function(t){return _d(this,t,arguments.length>1?arguments[1]:void 0)}});var Cd=En("Array").find,Ed=Array.prototype,Td=!c(function(){return Object.isExtensible(Object.preventExtensions({}))}),Sd=r(function(t){var e=q.f,i=bt("meta"),n=0,o=Object.isExtensible||function(){return!0},r=function(t){e(t,i,{value:{objectID:"O"+ ++n,weakData:{}}})},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!k(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!E(t,i)){if(!o(t))return"F";if(!e)return"E";r(t)}return t[i].objectID},getWeakData:function(t,e){if(!E(t,i)){if(!o(t))return!0;if(!e)return!1;r(t)}return t[i].weakData},onFreeze:function(t){return Td&&s.REQUIRED&&o(t)&&!E(t,i)&&r(t),t}};at[i]=!0}),Ad=function(t,e){this.stopped=t,this.result=e},Od=function(t,e,i){var n,o,r,s,a,l,c,h=!(!i||!i.AS_ENTRIES),d=!(!i||!i.IS_ITERATOR),u=!(!i||!i.INTERRUPTED),f=V(e,i&&i.that,1+h+u),p=function(t){return n&&vo(n),new Ad(!0,t)},g=function(t){return h?(H(t),u?f(t[0],t[1],p):f(t[0],t[1])):u?f(t,p):f(t)};if(d)n=t;else{if("function"!=typeof(o=xo(t)))throw TypeError("Target is not iterable");if(ko(o)){for(r=0,s=et(t.length);s>r;r++)if((a=g(t[r]))&&a instanceof Ad)return a;return new Ad(!1)}n=o.call(t)}for(l=n.next;!(c=l.call(n)).done;){try{a=g(c.value)}catch(t){throw vo(n),t}if("object"==typeof a&&a&&a instanceof Ad)return a}return new Ad(!1)},Id=function(t,e,i){if(!(t instanceof e))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return t},Pd=q.f,Md=ei.forEach,Dd=Qe.set,Nd=Qe.getterFor,Rd=function(t,e,i){for(var n in e)i&&i.unsafe&&t[n]?t[n]=e[n]:Se(t,n,e[n],i);return t},zd=ce("species"),Fd=q.f,Ld=Sd.fastKey,Bd=Qe.set,jd=Qe.getterFor;!function(t,e,i){var n,o=-1!==t.indexOf("Map"),r=-1!==t.indexOf("Weak"),s=o?"set":"add",a=l[t],d=a&&a.prototype,u={};if(h&&"function"==typeof a&&(r||d.forEach&&!c(function(){(new a).entries().next()}))){n=e(function(e,i){Dd(Id(e,n,t),{type:t,collection:new a}),null!=i&&Od(i,e[s],{that:e,AS_ENTRIES:o})});var f=Nd(t);Md(["add","clear","delete","forEach","get","has","set","keys","values","entries"],function(t){var e="add"==t||"set"==t;!(t in d)||r&&"clear"==t||U(n.prototype,t,function(i,n){var o=f(this).collection;if(!e&&r&&!k(i))return"get"==t&&void 0;var s=o[t](0===i?0:i,n);return e?this:s})}),r||Pd(n.prototype,"size",{configurable:!0,get:function(){return f(this).collection.size}})}else n=i.getConstructor(e,t,o,s),Sd.REQUIRED=!0;Be(n,t,!1,!0),u[t]=n,Z({global:!0,forced:!0},u),r||i.setStrong(n,t,o)}("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},{getConstructor:function(t,e,i,n){var o=t(function(t,r){Id(t,o,e),Bd(t,{type:e,index:Tt(null),first:void 0,last:void 0,size:0}),h||(t.size=0),null!=r&&Od(r,t[n],{that:t,AS_ENTRIES:i})}),r=jd(e),s=function(t,e,i){var n,o,s=r(t),l=a(t,e);return l?l.value=i:(s.last=l={index:o=Ld(e,!0),key:e,value:i,previous:n=s.last,next:void 0,removed:!1},s.first||(s.first=l),n&&(n.next=l),h?s.size++:t.size++,"F"!==o&&(s.index[o]=l)),t},a=function(t,e){var i,n=r(t),o=Ld(e);if("F"!==o)return n.index[o];for(i=n.first;i;i=i.next)if(i.key==e)return i};return Rd(o.prototype,{clear:function(){for(var t=r(this),e=t.index,i=t.first;i;)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete e[i.index],i=i.next;t.first=t.last=void 0,h?t.size=0:this.size=0},delete:function(t){var e=this,i=r(e),n=a(e,t);if(n){var o=n.next,s=n.previous;delete i.index[n.index],n.removed=!0,s&&(s.next=o),o&&(o.previous=s),i.first==n&&(i.first=o),i.last==n&&(i.last=s),h?i.size--:e.size--}return!!n},forEach:function(t){for(var e,i=r(this),n=V(t,arguments.length>1?arguments[1]:void 0,3);e=e?e.next:i.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),Rd(o.prototype,i?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return s(this,0===t?0:t,e)}}:{add:function(t){return s(this,t=0===t?0:t,t)}}),h&&Fd(o.prototype,"size",{get:function(){return r(this).size}}),o},setStrong:function(t,e,i){var n=e+" Iterator",o=jd(e),r=jd(n);on(t,e,function(t,e){Bd(this,{type:n,target:t,state:o(t),kind:e,last:void 0})},function(){for(var t=r(this),e=t.kind,i=t.last;i&&i.removed;)i=i.previous;return t.target&&(t.last=i=i?i.next:t.state.first)?"keys"==e?{value:i.key,done:!1}:"values"==e?{value:i.value,done:!1}:{value:[i.key,i.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})},i?"entries":"values",!i,!0),function(t){var e=X(t);h&&e&&!e[zd]&&(0,q.f)(e,zd,{configurable:!0,get:function(){return this}})}(e)}});var Vd=B.Set,Hd=.001;function Wd(t){Oh(t).call(t,function(t,e){return t.data.start-e.data.start})}function qd(t){Oh(t).call(t,function(t,e){return("end"in t.data?t.data.end:t.data.start)-("end"in e.data?e.data.end:e.data.start)})}function Ud(t,e,i,n){if(i)for(var o=0;o<t.length;o++)t[o].top=null;for(o=0;o<t.length;o++){var r=t[o];if(r.stack&&null===r.top){r.top=e.axis;var s=!1;do{for(var a=null,l=0,c=t.length;l<c;l++){var h=t[l];if(s=n()||!1)return!0;if(null!==h.top&&h!==r&&h.stack&&Xd(r,h,e.item,h.options.rtl)){a=h;break}}null!=a&&(r.top=a.top+a.height+e.item.vertical)}while(a)}}return s}function Yd(t,e,i){for(var n=0;n<t.length;n++)t[n].top=null;var o=i.height;for(n=0;n<t.length;n++){var r=t[n];if(r.stack&&null===r.top){r.top=r.baseTop;do{for(var s=null,a=0,l=t.length;a<l;a++){var c=t[a];if(null!==c.top&&c!==r&&Xd(r,c,e.item,c.options.rtl)){s=c;break}}null!=s&&(r.top=s.top+s.height+e.item.vertical),r.top+r.height>o&&(o=r.top+r.height)}while(s)}}i.height=o-i.top+.5*e.item.vertical}function Gd(t,e,i,n){for(var o=0;o<t.length;o++)if(null==t[o].data.subgroup)t[o].top=e.item.vertical;else if(void 0!==t[o].data.subgroup&&n){var r=0;for(var s in i)i.hasOwnProperty(s)&&1==i[s].visible&&i[s].index<i[t[o].data.subgroup].index&&(i[t[o].data.subgroup].top=r+=i[s].height);t[o].top=r+.5*e.item.vertical}n||Zd(t,e,i)}function Zd(t,e,i){for(var n in i)if(i.hasOwnProperty(n)){i[n].top=0;do{var o=null;for(var r in i)if(null!==i[r].top&&r!==n&&i[n].index>i[r].index&&Kd(i[n],i[r])){o=i[r];break}null!=o&&(i[n].top=o.top+o.height)}while(o)}for(var s=0;s<t.length;s++)void 0!==t[s].data.subgroup&&(t[s].top=i[t[s].data.subgroup].top+.5*e.item.vertical)}function $d(t,e,i){var n=!1,o=[];for(var r in i)i[r].hasOwnProperty("index")?o[i[r].index]=r:o.push(r);for(var s=0;s<o.length;s++)if(i.hasOwnProperty(r=o[s])){for(var a in n=n||i[r].stack,i[r].top=0,i)i[a].visible&&i[r].index>i[a].index&&(i[r].top+=i[a].height);for(var l=t[r],c=0;c<l.length;c++)void 0!==l[c].data.subgroup&&(l[c].top=i[l[c].data.subgroup].top+.5*e.item.vertical,i[r].stack&&(l[c].baseTop=l[c].top));n&&i[r].stack&&Yd(t[r],e,i[r])}}function Xd(t,e,i,n){return n?t.right-i.horizontal+Hd<e.right+e.width&&t.right+t.width+i.horizontal-Hd>e.right&&t.top-i.vertical+Hd<e.top+e.height&&t.top+t.height+i.vertical-Hd>e.top:t.left-i.horizontal+Hd<e.left+e.width&&t.left+t.width+i.horizontal-Hd>e.left&&t.top-i.vertical+Hd<e.top+e.height&&t.top+t.height+i.vertical-Hd>e.top}function Kd(t,e){return t.start<e.end&&t.end>e.start&&t.top<e.top+e.height&&t.top+t.height>e.top}var Qd=Object.freeze({__proto__:null,orderByStart:Wd,orderByEnd:qd,stack:Ud,substack:Yd,nostack:Gd,stackSubgroups:Zd,stackSubgroupsWithInnerStack:$d,collision:Xd,collisionByTimes:Kd}),Jd="__background__",tu=function(){function t(e,i,n){var o=this;if(zt(this,t),this.groupId=e,this.subgroups={},this.subgroupStack={},this.subgroupStackAll=!1,this.subgroupVisibility={},this.doInnerStack=!1,this.shouldBailStackItems=!1,this.subgroupIndex=0,this.subgroupOrderer=i&&i.subgroupOrder,this.itemSet=n,this.isVisible=null,this.stackDirty=!0,this._disposeCallbacks=[],i&&i.nestedGroups&&(this.nestedGroups=i.nestedGroups,this.showNested=0!=i.showNested),i&&i.subgroupStack)if("boolean"==typeof i.subgroupStack)this.doInnerStack=i.subgroupStack,this.subgroupStackAll=i.subgroupStack;else for(var r in i.subgroupStack)this.subgroupStack[r]=i.subgroupStack[r],this.doInnerStack=this.doInnerStack||i.subgroupStack[r];this.heightMode=i&&i.heightMode?i.heightMode:n.options.groupHeightMode,this.nestedInGroup=null,this.dom={},this.props={label:{width:0,height:0}},this.className=null,this.items={},this.visibleItems=[],this.itemsInRange=[],this.orderedItems={byStart:[],byEnd:[]},this.checkRangedItems=!1;var s=function(){o.checkRangedItems=!0};this.itemSet.body.emitter.on("checkRangedItems",s),this._disposeCallbacks.push(function(){o.itemSet.body.emitter.off("checkRangedItems",s)}),this._create(),this.setData(i)}return jt(t,[{key:"_create",value:function(){var t=document.createElement("div");t.className=this.itemSet.options.groupEditable.order?"vis-label draggable":"vis-label",this.dom.label=t;var e=document.createElement("div");e.className="vis-inner",t.appendChild(e),this.dom.inner=e;var i=document.createElement("div");i.className="vis-group",i["vis-group"]=this,this.dom.foreground=i,this.dom.background=document.createElement("div"),this.dom.background.className="vis-group",this.dom.axis=document.createElement("div"),this.dom.axis.className="vis-group",this.dom.marker=document.createElement("div"),this.dom.marker.style.visibility="hidden",this.dom.marker.style.position="absolute",this.dom.marker.innerHTML="",this.dom.background.appendChild(this.dom.marker)}},{key:"setData",value:function(t){if(!this.itemSet.groupTouchParams.isDragging){var e,i,n;if(t&&t.subgroupVisibility)for(var o in t.subgroupVisibility)this.subgroupVisibility[o]=t.subgroupVisibility[o];if((e=this.itemSet.options&&this.itemSet.options.groupTemplate?(i=An(n=this.itemSet.options.groupTemplate).call(n,this))(t,this.dom.inner):t&&t.content)instanceof Element){for(;this.dom.inner.firstChild;)this.dom.inner.removeChild(this.dom.inner.firstChild);this.dom.inner.appendChild(e)}else e instanceof Object&&e.isReactComponent||(e instanceof Object?i(t,this.dom.inner):this.dom.inner.innerHTML=ih.xss(null!=e?e:this.groupId||""));this.dom.label.title=t&&t.title||"",this.dom.inner.firstChild?ih.removeClassName(this.dom.inner,"vis-hidden"):ih.addClassName(this.dom.inner,"vis-hidden"),t&&t.nestedGroups?(this.nestedGroups&&this.nestedGroups==t.nestedGroups||(this.nestedGroups=t.nestedGroups),void 0===t.showNested&&void 0!==this.showNested||(this.showNested=0!=t.showNested),ih.addClassName(this.dom.label,"vis-nesting-group"),this.showNested?(ih.removeClassName(this.dom.label,"collapsed"),ih.addClassName(this.dom.label,"expanded")):(ih.removeClassName(this.dom.label,"expanded"),ih.addClassName(this.dom.label,"collapsed"))):this.nestedGroups&&(this.nestedGroups=null,ih.removeClassName(this.dom.label,"collapsed"),ih.removeClassName(this.dom.label,"expanded"),ih.removeClassName(this.dom.label,"vis-nesting-group")),t&&(t.treeLevel||t.nestedInGroup)?(ih.addClassName(this.dom.label,"vis-nested-group"),ih.addClassName(this.dom.label,t.treeLevel?"vis-group-level-"+t.treeLevel:"vis-group-level-unknown-but-gte1")):ih.addClassName(this.dom.label,"vis-group-level-0");var r=t&&t.className||null;r!=this.className&&(this.className&&(ih.removeClassName(this.dom.label,this.className),ih.removeClassName(this.dom.foreground,this.className),ih.removeClassName(this.dom.background,this.className),ih.removeClassName(this.dom.axis,this.className)),ih.addClassName(this.dom.label,r),ih.addClassName(this.dom.foreground,r),ih.addClassName(this.dom.background,r),ih.addClassName(this.dom.axis,r),this.className=r),this.style&&(ih.removeCssText(this.dom.label,this.style),this.style=null),t&&t.style&&(ih.addCssText(this.dom.label,t.style),this.style=t.style)}}},{key:"getLabelWidth",value:function(){return this.props.label.width}},{key:"_didMarkerHeightChange",value:function(){var t=this.dom.marker.clientHeight;if(t!=this.lastMarkerHeight){this.lastMarkerHeight=t;var e={},i=0;if(Bn(ih).call(ih,this.items,function(t,n){t.dirty=!0,t.displayed&&(e[n]=t.redraw(!0),i=e[n].length)}),i>0)for(var n=function(t){Bn(ih).call(ih,e,function(e){e[t]()})},o=0;o<i;o++)n(o);return!0}return!1}},{key:"_calculateGroupSizeAndPosition",value:function(){var t=this.dom.foreground,e=t.offsetLeft,i=t.offsetWidth;this.top=t.offsetTop,this.right=e,this.width=i}},{key:"_shouldBailItemsRedraw",value:function(){var t=this,e=this.itemSet.options.onTimeout,i={relativeBailingTime:this.itemSet.itemsSettingTime,bailTimeMs:e&&e.timeoutMs,userBailFunction:e&&e.callback,shouldBailStackItems:this.shouldBailStackItems},n=null;if(!this.itemSet.initialDrawDone){if(i.shouldBailStackItems)return!0;Math.abs(Ko()-new Date(i.relativeBailingTime))>i.bailTimeMs&&(i.userBailFunction&&null==this.itemSet.userContinueNotBail?i.userBailFunction(function(e){t.itemSet.userContinueNotBail=e,n=!e}):n=0==t.itemSet.userContinueNotBail)}return n}},{key:"_redrawItems",value:function(t,e,i,n){var o=this;if(t||this.stackDirty||this.isVisible&&!e){var r,s,a,l,c,h,d={byEnd:Yn(r=this.orderedItems.byEnd).call(r,function(t){return!t.isCluster}),byStart:Yn(s=this.orderedItems.byStart).call(s,function(t){return!t.isCluster})},u={byEnd:qo(new Vd(Yn(a=oo(l=this.orderedItems.byEnd).call(l,function(t){return t.cluster})).call(a,function(t){return!!t}))),byStart:qo(new Vd(Yn(c=oo(h=this.orderedItems.byStart).call(h,function(t){return t.cluster})).call(c,function(t){return!!t})))},f=function(){var t,e,i,r=o._updateItemsInRange(d,Yn(t=o.visibleItems).call(t,function(t){return!t.isCluster}),n),s=o._updateClustersInRange(u,Yn(e=o.visibleItems).call(e,function(t){return t.isCluster}),n);return Zo(i=[]).call(i,qo(r),qo(s))},p=function(t){var e={},i=function(i){var n,r=Yn(n=o.visibleItems).call(n,function(t){return t.data.subgroup===i});e[i]=t?Oh(r).call(r,function(e,i){return t(e.data,i.data)}):r};for(var n in o.subgroups)i(n);return e};if("function"==typeof this.itemSet.options.order){var g=this;if(this.doInnerStack&&this.itemSet.options.stackSubgroups)$d(p(this.itemSet.options.order),i,this.subgroups),this.visibleItems=f(),this._updateSubGroupHeights(i);else{var m,v,y,b;this.visibleItems=f(),this._updateSubGroupHeights(i);var w=Oh(m=Yn(v=$o(y=this.visibleItems).call(y)).call(v,function(t){return t.isCluster||!t.isCluster&&!t.cluster})).call(m,function(t,e){return g.itemSet.options.order(t.data,e.data)});this.shouldBailStackItems=Ud(w,i,!0,An(b=this._shouldBailItemsRedraw).call(b,this))}}else{var k;this.visibleItems=f(),this._updateSubGroupHeights(i),this.itemSet.options.stack?this.doInnerStack&&this.itemSet.options.stackSubgroups?$d(p(),i,this.subgroups):this.shouldBailStackItems=Ud(this.visibleItems,i,!0,An(k=this._shouldBailItemsRedraw).call(k,this)):Gd(this.visibleItems,i,this.subgroups,this.itemSet.options.stackSubgroups)}for(var _=0;_<this.visibleItems.length;_++)this.visibleItems[_].repositionX(),void 0!==this.subgroupVisibility[this.visibleItems[_].data.subgroup]&&(this.subgroupVisibility[this.visibleItems[_].data.subgroup]||this.visibleItems[_].hide());this.itemSet.options.cluster&&Bn(ih).call(ih,this.items,function(t){t.cluster&&t.displayed&&t.hide()}),this.shouldBailStackItems&&this.itemSet.body.emitter.emit("destroyTimeline"),this.stackDirty=!1}}},{key:"_didResize",value:function(t,e){t=ih.updateProperty(this,"height",e)||t;var i=this.dom.inner.clientHeight;return t=ih.updateProperty(this.props.label,"width",this.dom.inner.clientWidth)||t,ih.updateProperty(this.props.label,"height",i)||t}},{key:"_applyGroupHeight",value:function(t){this.dom.background.style.height="".concat(t,"px"),this.dom.foreground.style.height="".concat(t,"px"),this.dom.label.style.height="".concat(t,"px")}},{key:"_updateItemsVerticalPosition",value:function(t){for(var e=0,i=this.visibleItems.length;e<i;e++){var n=this.visibleItems[e];n.repositionY(t),this.isVisible||this.groupId==Jd||n.displayed&&n.hide()}}},{key:"redraw",value:function(t,e,i,n){var o,r,s,a,l,c,h,d=this,u=!1,f=this.isVisible,p=[function(){i=d._didMarkerHeightChange.call(d)||i},An(o=this._updateSubGroupHeights).call(o,this,e),An(r=this._calculateGroupSizeAndPosition).call(r,this),function(){var i;d.isVisible=An(i=d._isGroupVisible).call(i,d)(t,e)},function(){var n;An(n=d._redrawItems).call(n,d)(i,f,e,t)},An(s=this._updateSubgroupsSizes).call(s,this),function(){var t;c=An(t=d._calculateHeight).call(t,d)(e)},An(a=this._calculateGroupSizeAndPosition).call(a,this),function(){var t;u=An(t=d._didResize).call(t,d)(u,c)},function(){var t;An(t=d._applyGroupHeight).call(t,d)(c)},function(){var t;An(t=d._updateItemsVerticalPosition).call(t,d)(e)},An(l=function(){return!d.isVisible&&d.height&&(u=!1),u}).call(l,this)];return n?p:(Bn(p).call(p,function(t){h=t()}),h)}},{key:"_updateSubGroupHeights",value:function(t){var e=this;if(go(this.subgroups).length>0){var i=this;this._resetSubgroups(),Bn(ih).call(ih,this.visibleItems,function(n){void 0!==n.data.subgroup&&(i.subgroups[n.data.subgroup].height=Math.max(i.subgroups[n.data.subgroup].height,n.height+t.item.vertical),i.subgroups[n.data.subgroup].visible=void 0===e.subgroupVisibility[n.data.subgroup]||Boolean(e.subgroupVisibility[n.data.subgroup]))})}}},{key:"_isGroupVisible",value:function(t,e){return this.top<=t.body.domProps.centerContainer.height-t.body.domProps.scrollTop+e.axis&&this.top+this.height+e.axis>=-t.body.domProps.scrollTop}},{key:"_calculateHeight",value:function(t){var e,i;if((i="fixed"===this.heightMode?ih.toArray(this.items):this.visibleItems).length>0){var n=i[0].top,o=i[0].top+i[0].height;if(Bn(ih).call(ih,i,function(t){n=Math.min(n,t.top),o=Math.max(o,t.top+t.height)}),n>t.axis){var r=n-t.axis;o-=r,Bn(ih).call(ih,i,function(t){t.top-=r})}e=Math.ceil(o+t.item.vertical/2),"fitItems"!==this.heightMode&&(e=Math.max(e,this.props.label.height))}else e=this.props.label.height;return e}},{key:"show",value:function(){this.dom.label.parentNode||this.itemSet.dom.labelSet.appendChild(this.dom.label),this.dom.foreground.parentNode||this.itemSet.dom.foreground.appendChild(this.dom.foreground),this.dom.background.parentNode||this.itemSet.dom.background.appendChild(this.dom.background),this.dom.axis.parentNode||this.itemSet.dom.axis.appendChild(this.dom.axis)}},{key:"hide",value:function(){var t=this.dom.label;t.parentNode&&t.parentNode.removeChild(t);var e=this.dom.foreground;e.parentNode&&e.parentNode.removeChild(e);var i=this.dom.background;i.parentNode&&i.parentNode.removeChild(i);var n=this.dom.axis;n.parentNode&&n.parentNode.removeChild(n)}},{key:"add",value:function(t){var e;this.items[t.id]=t,t.setParent(this),this.stackDirty=!0,void 0!==t.data.subgroup&&(this._addToSubgroup(t),this.orderSubgroups()),_r(e=this.visibleItems).call(e,t)||this._checkIfVisible(t,this.visibleItems,this.itemSet.body.range)}},{key:"_addToSubgroup",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.data.subgroup;null!=e&&void 0===this.subgroups[e]&&(this.subgroups[e]={height:0,top:0,start:t.data.start,end:t.data.end||t.data.start,visible:!1,index:this.subgroupIndex,items:[],stack:this.subgroupStackAll||this.subgroupStack[e]||!1},this.subgroupIndex++),new Date(t.data.start)<new Date(this.subgroups[e].start)&&(this.subgroups[e].start=t.data.start);var i=t.data.end||t.data.start;new Date(i)>new Date(this.subgroups[e].end)&&(this.subgroups[e].end=i),this.subgroups[e].items.push(t)}},{key:"_updateSubgroupsSizes",value:function(){var t=this;if(t.subgroups){var e=function(e){var i,n=t.subgroups[e].items[0].data.start,o=(t.subgroups[e].items[0].data.end||t.subgroups[e].items[0].data.start)-1;Bn(i=t.subgroups[e].items).call(i,function(t){new Date(t.data.start)<new Date(n)&&(n=t.data.start);var e=t.data.end||t.data.start;new Date(e)>new Date(o)&&(o=e)}),t.subgroups[e].start=n,t.subgroups[e].end=new Date(o-1)};for(var i in t.subgroups)e(i)}}},{key:"orderSubgroups",value:function(){if(void 0!==this.subgroupOrderer){var t=[];if("string"==typeof this.subgroupOrderer){for(var e in this.subgroups)t.push({subgroup:e,sortField:this.subgroups[e].items[0].data[this.subgroupOrderer]});Oh(t).call(t,function(t,e){return t.sortField-e.sortField})}else if("function"==typeof this.subgroupOrderer){for(var i in this.subgroups)t.push(this.subgroups[i].items[0].data);Oh(t).call(t,this.subgroupOrderer)}if(t.length>0)for(var n=0;n<t.length;n++)this.subgroups[t[n].subgroup].index=n}}},{key:"_resetSubgroups",value:function(){for(var t in this.subgroups)this.subgroups.hasOwnProperty(t)&&(this.subgroups[t].visible=!1,this.subgroups[t].height=0)}},{key:"remove",value:function(t){var e,i;delete this.items[t.id],t.setParent(null),this.stackDirty=!0;var n=Yr(e=this.visibleItems).call(e,t);-1!=n&&cr(i=this.visibleItems).call(i,n,1),void 0!==t.data.subgroup&&(this._removeFromSubgroup(t),this.orderSubgroups())}},{key:"_removeFromSubgroup",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.data.subgroup;if(null!=e){var i=this.subgroups[e];if(i){var n,o,r=Yr(n=i.items).call(n,t);r>=0&&(cr(o=i.items).call(o,r,1),i.items.length?this._updateSubgroupsSizes():delete this.subgroups[e])}}}},{key:"removeFromDataSet",value:function(t){this.itemSet.removeItem(t.id)}},{key:"order",value:function(){for(var t=ih.toArray(this.items),e=[],i=[],n=0;n<t.length;n++)void 0!==t[n].data.end&&i.push(t[n]),e.push(t[n]);this.orderedItems={byStart:e,byEnd:i},Wd(this.orderedItems.byStart),qd(this.orderedItems.byEnd)}},{key:"_updateItemsInRange",value:function(t,e,i){var n=[],o={};if(!this.isVisible&&this.groupId!=Jd){for(var r=0;r<e.length;r++){var s=e[r];s.displayed&&s.hide()}return n}var a=(i.end-i.start)/4,l=i.start-a,c=i.end+a;if(e.length>0)for(var h=0;h<e.length;h++)this._checkIfVisibleWithReference(e[h],n,o,i);var d=ih.binarySearchCustom(t.byStart,function(t){return t<l?-1:t<=c?0:1},"data","start");if(this._traceVisible(d,t.byStart,n,o,function(t){return t.data.start<l||t.data.start>c}),1==this.checkRangedItems){this.checkRangedItems=!1;for(var u=0;u<t.byEnd.length;u++)this._checkIfVisibleWithReference(t.byEnd[u],n,o,i)}else{var f=ih.binarySearchCustom(t.byEnd,function(t){return t.end<l?-1:t.start<=c?0:1},"data");this._traceVisible(f,t.byEnd,n,o,function(t){return t.data.end<l||t.data.start>c})}for(var p={},g=0,m=0;m<n.length;m++){var v=n[m];v.displayed||(p[m]=v.redraw(!0),g=p[m].length)}if(g>0)for(var y=function(t){Bn(ih).call(ih,p,function(e){e[t]()})},b=0;b<g;b++)y(b);for(var w=0;w<n.length;w++)n[w].repositionX();return n}},{key:"_traceVisible",value:function(t,e,i,n,o){if(-1!=t){for(var r=t;r>=0;r--){var s=e[r];if(o(s))break;s.isCluster&&!s.hasItems()||s.cluster||void 0===n[s.id]&&(n[s.id]=!0,i.push(s))}for(var a=t+1;a<e.length;a++){var l=e[a];if(o(l))break;l.isCluster&&!l.hasItems()||l.cluster||void 0===n[l.id]&&(n[l.id]=!0,i.push(l))}}}},{key:"_checkIfVisible",value:function(t,e,i){t.isVisible(i)?(t.displayed||t.show(),t.repositionX(),e.push(t)):t.displayed&&t.hide()}},{key:"_checkIfVisibleWithReference",value:function(t,e,i,n){t.isVisible(n)?void 0===i[t.id]&&(i[t.id]=!0,e.push(t)):t.displayed&&t.hide()}},{key:"_updateClustersInRange",value:function(t,e,i){var n=[],o={};if(e.length>0)for(var r=0;r<e.length;r++)this._checkIfVisibleWithReference(e[r],n,o,i);for(var s=0;s<t.byStart.length;s++)this._checkIfVisibleWithReference(t.byStart[s],n,o,i);for(var a=0;a<t.byEnd.length;a++)this._checkIfVisibleWithReference(t.byEnd[a],n,o,i);for(var l={},c=0,h=0;h<n.length;h++){var d=n[h];d.displayed||(l[h]=d.redraw(!0),c=l[h].length)}if(c>0)for(var u=0;u<c;u++)Bn(ih).call(ih,l,function(t){t[u]()});for(var f=0;f<n.length;f++)n[f].repositionX();return n}},{key:"changeSubgroup",value:function(t,e,i){this._removeFromSubgroup(t,e),this._addToSubgroup(t,i),this.orderSubgroups()}},{key:"dispose",value:function(){var t;for(this.hide();t=this._disposeCallbacks.pop();)t()}}]),t}(),eu=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;return zt(this,i),(r=e.call(this,t,n,o)).width=0,r.height=0,r.top=0,r.left=0,r}return jt(i,[{key:"redraw",value:function(t,e,i){this.visibleItems=this._updateItemsInRange(this.orderedItems,this.visibleItems,t),this.width=this.dom.background.offsetWidth,this.dom.background.style.height="0";for(var n=0,o=this.visibleItems.length;n<o;n++)this.visibleItems[n].repositionY(e);return!1}},{key:"show",value:function(){this.dom.background.parentNode||this.itemSet.dom.background.appendChild(this.dom.background)}}]),i}(tu);function iu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var nu=function(){function t(e,i,n){var o,r=this;zt(this,t),this.id=null,this.parent=null,this.data=e,this.dom=null,this.conversion=i||{},this.defaultOptions={locales:yd,locale:"en"},this.options=ih.extend({},this.defaultOptions,n),this.options.locales=ih.extend({},yd,this.options.locales);var s=this.defaultOptions.locales[this.defaultOptions.locale];Bn(o=go(this.options.locales)).call(o,function(t){r.options.locales[t]=ih.extend({},s,r.options.locales[t])}),this.selected=!1,this.displayed=!1,this.groupShowing=!0,this.selectable=n&&n.selectable||!1,this.dirty=!0,this.top=null,this.right=null,this.left=null,this.width=null,this.height=null,this.setSelectability(e),this.editable=null,this._updateEditStatus()}return jt(t,[{key:"select",value:function(){this.selectable&&(this.selected=!0,this.dirty=!0,this.displayed&&this.redraw())}},{key:"unselect",value:function(){this.selected=!1,this.dirty=!0,this.displayed&&this.redraw()}},{key:"setData",value:function(t){null!=t.group&&this.data.group!=t.group&&null!=this.parent&&this.parent.itemSet._moveToGroup(this,t.group),this.setSelectability(t),this.parent&&(this.parent.stackDirty=!0),null!=t.subgroup&&this.data.subgroup!=t.subgroup&&null!=this.parent&&this.parent.changeSubgroup(this,this.data.subgroup,t.subgroup),this.data=t,this._updateEditStatus(),this.dirty=!0,this.displayed&&this.redraw()}},{key:"setSelectability",value:function(t){t&&(this.selectable=void 0===t.selectable||Boolean(t.selectable))}},{key:"setParent",value:function(t){this.displayed?(this.hide(),this.parent=t,this.parent&&this.show()):this.parent=t}},{key:"isVisible",value:function(t){return!1}},{key:"show",value:function(){return!1}},{key:"hide",value:function(){return!1}},{key:"redraw",value:function(){}},{key:"repositionX",value:function(){}},{key:"repositionY",value:function(){}},{key:"_repaintDragCenter",value:function(){if(this.selected&&this.editable.updateTime&&!this.dom.dragCenter){var t,e,i=this,n=document.createElement("div");n.className="vis-drag-center",n.dragCenterItem=this,this.hammerDragCenter=new Jh(n),this.hammerDragCenter.on("tap",function(t){i.parent.itemSet.body.emitter.emit("click",{event:t,item:i.id})}),this.hammerDragCenter.on("doubletap",function(t){t.stopPropagation(),i.parent.itemSet._onUpdateItem(i),i.parent.itemSet.body.emitter.emit("doubleClick",{event:t,item:i.id})}),this.hammerDragCenter.on("panstart",function(t){t.stopPropagation(),i.parent.itemSet._onDragStart(t)}),this.hammerDragCenter.on("panmove",An(t=i.parent.itemSet._onDrag).call(t,i.parent.itemSet)),this.hammerDragCenter.on("panend",An(e=i.parent.itemSet._onDragEnd).call(e,i.parent.itemSet)),this.hammerDragCenter.get("press").set({time:1e4}),this.dom.box?this.dom.dragLeft?this.dom.box.insertBefore(n,this.dom.dragLeft):this.dom.box.appendChild(n):this.dom.point&&this.dom.point.appendChild(n),this.dom.dragCenter=n}else!this.selected&&this.dom.dragCenter&&(this.dom.dragCenter.parentNode&&this.dom.dragCenter.parentNode.removeChild(this.dom.dragCenter),this.dom.dragCenter=null,this.hammerDragCenter&&(this.hammerDragCenter.destroy(),this.hammerDragCenter=null))}},{key:"_repaintDeleteButton",value:function(t){var e=(this.options.editable.overrideItems||null==this.editable)&&this.options.editable.remove||!this.options.editable.overrideItems&&null!=this.editable&&this.editable.remove;if(this.selected&&e&&!this.dom.deleteButton){var i=this,n=document.createElement("div");n.className=this.options.rtl?"vis-delete-rtl":"vis-delete";var o=this.options.locales[this.options.locale];o||(this.warned||(console.warn("WARNING: options.locales['".concat(this.options.locale,"'] not found. See https://visjs.github.io/vis-timeline/docs/timeline/#Localization")),this.warned=!0),o=this.options.locales.en),n.title=o.deleteSelected,this.hammerDeleteButton=new Jh(n).on("tap",function(t){t.stopPropagation(),i.parent.removeFromDataSet(i)}),t.appendChild(n),this.dom.deleteButton=n}else this.selected&&e||!this.dom.deleteButton||(this.dom.deleteButton.parentNode&&this.dom.deleteButton.parentNode.removeChild(this.dom.deleteButton),this.dom.deleteButton=null,this.hammerDeleteButton&&(this.hammerDeleteButton.destroy(),this.hammerDeleteButton=null))}},{key:"_repaintOnItemUpdateTimeTooltip",value:function(t){if(this.options.tooltipOnItemUpdateTime){var e,i;if(!this.selected||!this.options.editable.updateTime&&!0!==this.data.editable||!1===this.data.editable||this.dom.onItemUpdateTimeTooltip)!this.selected&&this.dom.onItemUpdateTimeTooltip&&(this.dom.onItemUpdateTimeTooltip.parentNode&&this.dom.onItemUpdateTimeTooltip.parentNode.removeChild(this.dom.onItemUpdateTimeTooltip),this.dom.onItemUpdateTimeTooltip=null);else{var n=document.createElement("div");n.className="vis-onUpdateTime-tooltip",t.appendChild(n),this.dom.onItemUpdateTimeTooltip=n}this.dom.onItemUpdateTimeTooltip&&(this.dom.onItemUpdateTimeTooltip.style.visibility=this.parent.itemSet.touchParams.itemIsDragging?"visible":"hidden",this.dom.onItemUpdateTimeTooltip.style.transform="translateX(-50%)",this.dom.onItemUpdateTimeTooltip.style.left="50%",("top"==this.options.orientation.item?this.top:this.parent.height-this.top-this.height)+this.parent.top-50<-this.parent.itemSet.body.domProps.scrollTop?(this.dom.onItemUpdateTimeTooltip.style.bottom="",this.dom.onItemUpdateTimeTooltip.style.top="".concat(this.height+2,"px")):(this.dom.onItemUpdateTimeTooltip.style.top="",this.dom.onItemUpdateTimeTooltip.style.bottom="".concat(this.height+2,"px")),this.options.tooltipOnItemUpdateTime&&this.options.tooltipOnItemUpdateTime.template?e=An(i=this.options.tooltipOnItemUpdateTime.template).call(i,this)(this.data):(e="start: ".concat(jn(this.data.start).format("MM/DD/YYYY hh:mm")),this.data.end&&(e+="<br> end: ".concat(jn(this.data.end).format("MM/DD/YYYY hh:mm")))),this.dom.onItemUpdateTimeTooltip.innerHTML=ih.xss(e))}}},{key:"_getItemData",value:function(){return this.parent.itemSet.itemsData.get(this.id)}},{key:"_updateContents",value:function(t){var e,i,n,o,r,s,a=this._getItemData(),l=(this.dom.box||this.dom.point).getElementsByClassName("vis-item-visible-frame")[0];if(this.options.visibleFrameTemplate?(o=An(r=this.options.visibleFrameTemplate).call(r,this),n=ih.xss(o(a,l))):n="",l)if(n instanceof Object&&!(n instanceof Element))o(a,l);else if(this._contentToString(this.itemVisibleFrameContent)!==this._contentToString(n)){if(n instanceof Element)l.innerHTML="",l.appendChild(n);else if(null!=n)l.innerHTML=ih.xss(n);else if("background"!=this.data.type||void 0!==this.data.content)throw new Error('Property "content" missing in item '.concat(this.id));this.itemVisibleFrameContent=n}if((e=this.options.template?(i=An(s=this.options.template).call(s,this))(a,t,this.data):this.data.content)instanceof Object&&!(e instanceof Element))i(a,t);else if(this._contentToString(this.content)!==this._contentToString(e)){if(e instanceof Element)t.innerHTML="",t.appendChild(e);else if(null!=e)t.innerHTML=ih.xss(e);else if("background"!=this.data.type||void 0!==this.data.content)throw new Error('Property "content" missing in item '.concat(this.id));this.content=e}}},{key:"_updateDataAttributes",value:function(t){if(this.options.dataAttributes&&this.options.dataAttributes.length>0){var e=[];if(Cn(this.options.dataAttributes))e=this.options.dataAttributes;else{if("all"!=this.options.dataAttributes)return;e=go(this.data)}var i,n=function(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return iu(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iu(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(e);try{for(n.s();!(i=n.n()).done;){var o=i.value,r=this.data[o];null!=r?t.setAttribute("data-".concat(o),r):t.removeAttribute("data-".concat(o))}}catch(t){n.e(t)}finally{n.f()}}}},{key:"_updateStyle",value:function(t){this.style&&(ih.removeCssText(t,this.style),this.style=null),this.data.style&&(ih.addCssText(t,this.data.style),this.style=this.data.style)}},{key:"_contentToString",value:function(t){return"string"==typeof t?t:t&&"outerHTML"in t?t.outerHTML:t}},{key:"_updateEditStatus",value:function(){this.options&&("boolean"==typeof this.options.editable?this.editable={updateTime:this.options.editable,updateGroup:this.options.editable,remove:this.options.editable}:"object"===vn(this.options.editable)&&(this.editable={},ih.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,this.options.editable))),this.options&&this.options.editable&&!0===this.options.editable.overrideItems||this.data&&("boolean"==typeof this.data.editable?this.editable={updateTime:this.data.editable,updateGroup:this.data.editable,remove:this.data.editable}:"object"===vn(this.data.editable)&&(this.editable={},ih.selectiveExtend(["updateTime","updateGroup","remove"],this.editable,this.data.editable)))}},{key:"getWidthLeft",value:function(){return 0}},{key:"getWidthRight",value:function(){return 0}},{key:"getTitle",value:function(){var t;return this.options.tooltip&&this.options.tooltip.template?An(t=this.options.tooltip.template).call(t,this)(this._getItemData(),this.data):this.data.title}}]),t}();nu.prototype.stack=!0;var ou=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;if(zt(this,i),(r=e.call(this,t,n,o)).props={dot:{width:0,height:0},line:{width:0,height:0}},t&&null==t.start)throw new Error('Property "start" missing in item '.concat(t));return r}return jt(i,[{key:"isVisible",value:function(t){if(this.cluster)return!1;var e=this.data.align||this.options.align,i=this.width*t.getMillisecondsPerPixel();return"right"==e?this.data.start.getTime()>t.start&&this.data.start.getTime()-i<t.end:"left"==e?this.data.start.getTime()+i>t.start&&this.data.start.getTime()<t.end:this.data.start.getTime()+i/2>t.start&&this.data.start.getTime()-i/2<t.end}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("DIV"),this.dom.content=document.createElement("DIV"),this.dom.content.className="vis-item-content",this.dom.box.appendChild(this.dom.content),this.dom.line=document.createElement("DIV"),this.dom.line.className="vis-line",this.dom.dot=document.createElement("DIV"),this.dom.dot.className="vis-dot",this.dom.box["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var t=this.parent.dom.foreground;if(!t)throw new Error("Cannot redraw item: parent has no foreground container element");t.appendChild(this.dom.box)}if(!this.dom.line.parentNode){var e=this.parent.dom.background;if(!e)throw new Error("Cannot redraw item: parent has no background container element");e.appendChild(this.dom.line)}if(!this.dom.dot.parentNode){var i=this.parent.dom.axis;if(!e)throw new Error("Cannot redraw item: parent has no axis container element");i.appendChild(this.dom.dot)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box);var t=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(this.editable.updateTime||this.editable.updateGroup?" vis-editable":" vis-readonly");this.dom.box.className="vis-item vis-box".concat(t),this.dom.line.className="vis-item vis-line".concat(t),this.dom.dot.className="vis-item vis-dot".concat(t)}}},{key:"_getDomComponentsSizes",value:function(){return{previous:{right:this.dom.box.style.right,left:this.dom.box.style.left},dot:{height:this.dom.dot.offsetHeight,width:this.dom.dot.offsetWidth},line:{width:this.dom.line.offsetWidth},box:{width:this.dom.box.offsetWidth,height:this.dom.box.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(t){this.options.rtl?this.dom.box.style.right="0px":this.dom.box.style.left="0px",this.props.dot.height=t.dot.height,this.props.dot.width=t.dot.width,this.props.line.width=t.line.width,this.width=t.box.width,this.height=t.box.height,this.options.rtl?this.dom.box.style.right=t.previous.right:this.dom.box.style.left=t.previous.left,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box),this._repaintDragCenter(),this._repaintDeleteButton(this.dom.box)}},{key:"redraw",value:function(t){var e,i,n,o,r,s,a=this,l=[An(e=this._createDomElement).call(e,this),An(i=this._appendDomElement).call(i,this),An(n=this._updateDirtyDomComponents).call(n,this),function(){a.dirty&&(r=a._getDomComponentsSizes())},function(){var t;a.dirty&&An(t=a._updateDomComponentsSizes).call(t,a)(r)},An(o=this._repaintDomAdditionals).call(o,this)];return t?l:(Bn(l).call(l,function(t){s=t()}),s)}},{key:"show",value:function(t){if(!this.displayed)return this.redraw(t)}},{key:"hide",value:function(){if(this.displayed){var t=this.dom;t.box.remove?t.box.remove():t.box.parentNode&&t.box.parentNode.removeChild(t.box),t.line.remove?t.line.remove():t.line.parentNode&&t.line.parentNode.removeChild(t.line),t.dot.remove?t.dot.remove():t.dot.parentNode&&t.dot.parentNode.removeChild(t.dot),this.displayed=!1}}},{key:"repositionXY",value:function(){var t=this.options.rtl,e=function(t,e,i){var n;if(void 0!==e||void 0!==i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?-1*e:e;t.style.transform=void 0!==i?void 0!==e?Zo(n="translate(".concat(o,"px, ")).call(n,i,"px)"):"translateY(".concat(i,"px)"):"translateX(".concat(o,"px)")}};e(this.dom.box,this.boxX,this.boxY,t),e(this.dom.dot,this.dotX,this.dotY,t),e(this.dom.line,this.lineX,this.lineY,t)}},{key:"repositionX",value:function(){var t=this.conversion.toScreen(this.data.start),e=void 0===this.data.align?this.options.align:this.data.align,i=this.props.line.width,n=this.props.dot.width;"right"==e?(this.boxX=t-this.width,this.lineX=t-i,this.dotX=t-i/2-n/2):"left"==e?(this.boxX=t,this.lineX=t,this.dotX=t+i/2-n/2):(this.boxX=t-this.width/2,this.lineX=this.options.rtl?t-i:t-i/2,this.dotX=t-n/2),this.options.rtl?this.right=this.boxX:this.left=this.boxX,this.repositionXY()}},{key:"repositionY",value:function(){var t=this.dom.line.style;if("top"==this.options.orientation.item){var e=this.parent.top+this.top+1;this.boxY=this.top||0,t.height="".concat(e,"px"),t.bottom="",t.top="0"}else{var i=this.parent.itemSet.props.height-this.parent.top-this.parent.height+this.top;this.boxY=this.parent.height-this.top-(this.height||0),t.height="".concat(i,"px"),t.top="",t.bottom="0"}this.dotY=-this.props.dot.height/2,this.repositionXY()}},{key:"getWidthLeft",value:function(){return this.width/2}},{key:"getWidthRight",value:function(){return this.width/2}}]),i}(nu),ru=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;if(zt(this,i),(r=e.call(this,t,n,o)).props={dot:{top:0,width:0,height:0},content:{height:0,marginLeft:0,marginRight:0}},t&&null==t.start)throw new Error('Property "start" missing in item '.concat(t));return r}return jt(i,[{key:"isVisible",value:function(t){if(this.cluster)return!1;var e=this.width*t.getMillisecondsPerPixel();return this.data.start.getTime()+e>t.start&&this.data.start<t.end}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.point=document.createElement("div"),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.point.appendChild(this.dom.content),this.dom.dot=document.createElement("div"),this.dom.point.appendChild(this.dom.dot),this.dom.point["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.point.parentNode){var t=this.parent.dom.foreground;if(!t)throw new Error("Cannot redraw item: parent has no foreground container element");t.appendChild(this.dom.point)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){if(this.dirty){this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.point),this._updateStyle(this.dom.point);var t=(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(this.editable.updateTime||this.editable.updateGroup?" vis-editable":" vis-readonly");this.dom.point.className="vis-item vis-point".concat(t),this.dom.dot.className="vis-item vis-dot".concat(t)}}},{key:"_getDomComponentsSizes",value:function(){return{dot:{width:this.dom.dot.offsetWidth,height:this.dom.dot.offsetHeight},content:{width:this.dom.content.offsetWidth,height:this.dom.content.offsetHeight},point:{width:this.dom.point.offsetWidth,height:this.dom.point.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(t){this.props.dot.width=t.dot.width,this.props.dot.height=t.dot.height,this.props.content.height=t.content.height,this.options.rtl?this.dom.content.style.marginRight="".concat(this.props.dot.width/2,"px"):this.dom.content.style.marginLeft="".concat(this.props.dot.width/2,"px"),this.width=t.point.width,this.height=t.point.height,this.dom.dot.style.top="".concat((this.height-this.props.dot.height)/2,"px");var e=this.props.dot.width;this.dom.dot.style.transform="translateX(".concat(this.options.rtl?e/2:e/2*-1,"px"),this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.point),this._repaintDragCenter(),this._repaintDeleteButton(this.dom.point)}},{key:"redraw",value:function(t){var e,i,n,o,r,s,a=this,l=[An(e=this._createDomElement).call(e,this),An(i=this._appendDomElement).call(i,this),An(n=this._updateDirtyDomComponents).call(n,this),function(){a.dirty&&(r=a._getDomComponentsSizes())},function(){var t;a.dirty&&An(t=a._updateDomComponentsSizes).call(t,a)(r)},An(o=this._repaintDomAdditionals).call(o,this)];return t?l:(Bn(l).call(l,function(t){s=t()}),s)}},{key:"repositionXY",value:function(){!function(t,e,i){var n;if(void 0!==e||void 0!==i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?-1*e:e;t.style.transform=void 0!==i?void 0!==e?Zo(n="translate(".concat(o,"px, ")).call(n,i,"px)"):"translateY(".concat(i,"px)"):"translateX(".concat(o,"px)")}}(this.dom.point,this.pointX,this.pointY,this.options.rtl)}},{key:"show",value:function(t){if(!this.displayed)return this.redraw(t)}},{key:"hide",value:function(){this.displayed&&(this.dom.point.parentNode&&this.dom.point.parentNode.removeChild(this.dom.point),this.displayed=!1)}},{key:"repositionX",value:function(){var t=this.conversion.toScreen(this.data.start);this.pointX=t,this.options.rtl?this.right=t-this.props.dot.width:this.left=t-this.props.dot.width,this.repositionXY()}},{key:"repositionY",value:function(){this.pointY="top"==this.options.orientation.item?this.top:this.parent.height-this.top-this.height,this.repositionXY()}},{key:"getWidthLeft",value:function(){return this.props.dot.width}},{key:"getWidthRight",value:function(){return this.props.dot.width}}]),i}(nu),su=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;if(zt(this,i),(r=e.call(this,t,n,o)).props={content:{width:0}},r.overflow=!1,t){if(null==t.start)throw new Error('Property "start" missing in item '.concat(t.id));if(null==t.end)throw new Error('Property "end" missing in item '.concat(t.id))}return r}return jt(i,[{key:"isVisible",value:function(t){return!this.cluster&&this.data.start<t.end&&this.data.end>t.start}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("div"),this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-item-overflow",this.dom.box.appendChild(this.dom.frame),this.dom.visibleFrame=document.createElement("div"),this.dom.visibleFrame.className="vis-item-visible-frame",this.dom.box.appendChild(this.dom.visibleFrame),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.frame.appendChild(this.dom.content),this.dom.box["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var t=this.parent.dom.foreground;if(!t)throw new Error("Cannot redraw item: parent has no foreground container element");t.appendChild(this.dom.box)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){this.dirty&&(this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box),this.dom.box.className=this.baseClassName+(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+(this.editable.updateTime||this.editable.updateGroup?" vis-editable":" vis-readonly"),this.dom.content.style.maxWidth="none")}},{key:"_getDomComponentsSizes",value:function(){return this.overflow="hidden"!==window.getComputedStyle(this.dom.frame).overflow,this.whiteSpace="nowrap"!==window.getComputedStyle(this.dom.content).whiteSpace,{content:{width:this.dom.content.offsetWidth},box:{height:this.dom.box.offsetHeight}}}},{key:"_updateDomComponentsSizes",value:function(t){this.props.content.width=t.content.width,this.height=t.box.height,this.dom.content.style.maxWidth="",this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box),this._repaintDeleteButton(this.dom.box),this._repaintDragCenter(),this._repaintDragLeft(),this._repaintDragRight()}},{key:"redraw",value:function(t){var e,i,n,o,r,s,a=this,l=[An(e=this._createDomElement).call(e,this),An(i=this._appendDomElement).call(i,this),An(n=this._updateDirtyDomComponents).call(n,this),function(){var t;a.dirty&&(r=An(t=a._getDomComponentsSizes).call(t,a)())},function(){var t;a.dirty&&An(t=a._updateDomComponentsSizes).call(t,a)(r)},An(o=this._repaintDomAdditionals).call(o,this)];return t?l:(Bn(l).call(l,function(t){s=t()}),s)}},{key:"show",value:function(t){if(!this.displayed)return this.redraw(t)}},{key:"hide",value:function(){if(this.displayed){var t=this.dom.box;t.parentNode&&t.parentNode.removeChild(t),this.displayed=!1}}},{key:"repositionX",value:function(t){var e,i,n=this.parent.width,o=this.conversion.toScreen(this.data.start),r=this.conversion.toScreen(this.data.end),s=void 0===this.data.align?this.options.align:this.data.align;!1===this.data.limitSize||void 0!==t&&!0!==t||(o<-n&&(o=-n),r>2*n&&(r=2*n));var a=Math.max(Math.round(1e3*(r-o))/1e3,1);switch(this.overflow?(this.options.rtl?this.right=o:this.left=o,this.width=a+this.props.content.width,i=this.props.content.width):(this.options.rtl?this.right=o:this.left=o,this.width=a,i=Math.min(r-o,this.props.content.width)),this.dom.box.style.transform="translateX(".concat(this.options.rtl?-1*this.right:this.left,"px)"),this.dom.box.style.width="".concat(a,"px"),this.whiteSpace&&(this.height=this.dom.box.offsetHeight),s){case"left":this.dom.content.style.transform="translateX(0)";break;case"right":if(this.options.rtl){var l=-1*Math.max(a-i,0);this.dom.content.style.transform="translateX(".concat(l,"px)")}else this.dom.content.style.transform="translateX(".concat(Math.max(a-i,0),"px)");break;case"center":if(this.options.rtl){var c=-1*Math.max((a-i)/2,0);this.dom.content.style.transform="translateX(".concat(c,"px)")}else this.dom.content.style.transform="translateX(".concat(Math.max((a-i)/2,0),"px)");break;default:e=this.overflow?r>0?Math.max(-o,0):-i:o<0?-o:0,this.dom.content.style.transform="translateX(".concat(this.options.rtl?-1*e:e,"px)")}}},{key:"repositionY",value:function(){this.dom.box.style.top="".concat("top"==this.options.orientation.item?this.top:this.parent.height-this.top-this.height,"px")}},{key:"_repaintDragLeft",value:function(){if((this.selected||this.options.itemsAlwaysDraggable.range)&&this.editable.updateTime&&!this.dom.dragLeft){var t=document.createElement("div");t.className="vis-drag-left",t.dragLeftItem=this,this.dom.box.appendChild(t),this.dom.dragLeft=t}else this.selected||this.options.itemsAlwaysDraggable.range||!this.dom.dragLeft||(this.dom.dragLeft.parentNode&&this.dom.dragLeft.parentNode.removeChild(this.dom.dragLeft),this.dom.dragLeft=null)}},{key:"_repaintDragRight",value:function(){if((this.selected||this.options.itemsAlwaysDraggable.range)&&this.editable.updateTime&&!this.dom.dragRight){var t=document.createElement("div");t.className="vis-drag-right",t.dragRightItem=this,this.dom.box.appendChild(t),this.dom.dragRight=t}else this.selected||this.options.itemsAlwaysDraggable.range||!this.dom.dragRight||(this.dom.dragRight.parentNode&&this.dom.dragRight.parentNode.removeChild(this.dom.dragRight),this.dom.dragRight=null)}}]),i}(nu);su.prototype.baseClassName="vis-item vis-range";var au=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;if(zt(this,i),(r=e.call(this,t,n,o)).props={content:{width:0}},r.overflow=!1,t){if(null==t.start)throw new Error('Property "start" missing in item '.concat(t.id));if(null==t.end)throw new Error('Property "end" missing in item '.concat(t.id))}return r}return jt(i,[{key:"isVisible",value:function(t){return this.data.start<t.end&&this.data.end>t.start}},{key:"_createDomElement",value:function(){this.dom||(this.dom={},this.dom.box=document.createElement("div"),this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-item-overflow",this.dom.box.appendChild(this.dom.frame),this.dom.content=document.createElement("div"),this.dom.content.className="vis-item-content",this.dom.frame.appendChild(this.dom.content),this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var t=this.parent.dom.background;if(!t)throw new Error("Cannot redraw item: parent has no background container element");t.appendChild(this.dom.box)}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){this.dirty&&(this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.content),this._updateStyle(this.dom.box),this.dom.box.className=this.baseClassName+(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":""))}},{key:"_getDomComponentsSizes",value:function(){return this.overflow="hidden"!==window.getComputedStyle(this.dom.content).overflow,{content:{width:this.dom.content.offsetWidth}}}},{key:"_updateDomComponentsSizes",value:function(t){this.props.content.width=t.content.width,this.height=0,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){}},{key:"redraw",value:function(t){var e,i,n,o,r,s,a=this,l=[An(e=this._createDomElement).call(e,this),An(i=this._appendDomElement).call(i,this),An(n=this._updateDirtyDomComponents).call(n,this),function(){var t;a.dirty&&(r=An(t=a._getDomComponentsSizes).call(t,a)())},function(){var t;a.dirty&&An(t=a._updateDomComponentsSizes).call(t,a)(r)},An(o=this._repaintDomAdditionals).call(o,this)];return t?l:(Bn(l).call(l,function(t){s=t()}),s)}},{key:"repositionY",value:function(t){var e,i=this.options.orientation.item;if(void 0!==this.data.subgroup){var n=this.data.subgroup;this.dom.box.style.height="".concat(this.parent.subgroups[n].height,"px"),this.dom.box.style.top="".concat("top"==i?this.parent.top+this.parent.subgroups[n].top:this.parent.top+this.parent.height-this.parent.subgroups[n].top-this.parent.subgroups[n].height,"px"),this.dom.box.style.bottom=""}else this.parent instanceof eu?(e=Math.max(this.parent.height,this.parent.itemSet.body.domProps.center.height,this.parent.itemSet.body.domProps.centerContainer.height),this.dom.box.style.bottom="bottom"==i?"0":"",this.dom.box.style.top="top"==i?"0":""):(e=this.parent.height,this.dom.box.style.top="".concat(this.parent.top,"px"),this.dom.box.style.bottom="");this.dom.box.style.height="".concat(e,"px")}}]),i}(nu);au.prototype.baseClassName="vis-item vis-background",au.prototype.stack=!1,au.prototype.show=su.prototype.show,au.prototype.hide=su.prototype.hide,au.prototype.repositionX=su.prototype.repositionX;var lu=function(){function t(e,i){zt(this,t),this.container=e,this.overflowMethod=i||"cap",this.x=0,this.y=0,this.padding=5,this.hidden=!1,this.frame=document.createElement("div"),this.frame.className="vis-tooltip",this.container.appendChild(this.frame)}return jt(t,[{key:"setPosition",value:function(t,e){this.x=Lr(t),this.y=Lr(e)}},{key:"setText",value:function(t){t instanceof Element?(this.frame.innerHTML="",this.frame.appendChild(t)):this.frame.innerHTML=ih.xss(t)}},{key:"show",value:function(t){if(void 0===t&&(t=!0),!0===t){var e=this.frame.clientHeight,i=this.frame.clientWidth,n=this.frame.parentNode.clientHeight,o=this.frame.parentNode.clientWidth,r=0,s=0;if("flip"==this.overflowMethod||"none"==this.overflowMethod){var a=!1,l=!0;"flip"==this.overflowMethod&&(this.y-e<this.padding&&(l=!1),this.x+i>o-this.padding&&(a=!0)),r=a?this.x-i:this.x,s=l?this.y-e:this.y}else(s=this.y-e)+e+this.padding>n&&(s=n-e-this.padding),s<this.padding&&(s=this.padding),(r=this.x)+i+this.padding>o&&(r=o-i-this.padding),r<this.padding&&(r=this.padding);this.frame.style.left=r+"px",this.frame.style.top=s+"px",this.frame.style.visibility="visible",this.hidden=!1}else this.hide()}},{key:"hide",value:function(){this.hidden=!0,this.frame.style.left="0",this.frame.style.top="0",this.frame.style.visibility="hidden"}},{key:"destroy",value:function(){this.frame.parentNode.removeChild(this.frame)}}]),t}(),cu=ei.every,hu=Dn("every");Z({target:"Array",proto:!0,forced:!hu},{every:function(t){return cu(this,t,arguments.length>1?arguments[1]:void 0)}});var du=En("Array").every,uu=Array.prototype;function fu(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return pu(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pu(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function pu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var gu=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o){var r;zt(this,i);var s=fr({},{fitOnDoubleClick:!0},o,{editable:!1});if((r=e.call(this,t,n,s)).props={content:{width:0,height:0}},!t||null==t.uiItems)throw new Error('Property "uiItems" missing in item '+t.id);return r.id=Yc(),r.group=t.group,r._setupRange(),r.emitter=r.data.eventEmitter,r.range=r.data.range,r.attached=!1,r.isCluster=!0,r.data.isCluster=!0,r}return jt(i,[{key:"hasItems",value:function(){return this.data.uiItems&&this.data.uiItems.length&&this.attached}},{key:"setUiItems",value:function(t){this.detach(),this.data.uiItems=t,this._setupRange(),this.attach()}},{key:"isVisible",value:function(t){var e=this.data.end?this.data.end-this.data.start:0,i=this.width*t.getMillisecondsPerPixel(),n=Math.max(this.data.start.getTime()+e,this.data.start.getTime()+i);return this.data.start<t.end&&n>t.start&&this.hasItems()}},{key:"getData",value:function(){return{isCluster:!0,id:this.id,items:this.data.items||[],data:this.data}}},{key:"redraw",value:function(t){var e,i,n,o,r,s,a,l,c=[An(e=this._createDomElement).call(e,this),An(i=this._appendDomElement).call(i,this),An(n=this._updateDirtyDomComponents).call(n,this),An(o=function(){this.dirty&&(a=this._getDomComponentsSizes())}).call(o,this),An(r=function(){var t;this.dirty&&An(t=this._updateDomComponentsSizes).call(t,this)(a)}).call(r,this),An(s=this._repaintDomAdditionals).call(s,this)];return t?c:(Bn(c).call(c,function(t){l=t()}),l)}},{key:"show",value:function(){this.displayed||this.redraw()}},{key:"hide",value:function(){if(this.displayed){var t=this.dom;t.box.parentNode&&t.box.parentNode.removeChild(t.box),this.options.showStipes&&(t.line.parentNode&&t.line.parentNode.removeChild(t.line),t.dot.parentNode&&t.dot.parentNode.removeChild(t.dot)),this.displayed=!1}}},{key:"repositionX",value:function(){var t=this.conversion.toScreen(this.data.start),e=this.data.end?this.conversion.toScreen(this.data.end):0;e?this.repositionXWithRanges(t,e):this.repositionXWithoutRanges(t,void 0===this.data.align?this.options.align:this.data.align),this.options.showStipes&&(this.dom.line.style.display=this._isStipeVisible()?"block":"none",this.dom.dot.style.display=this._isStipeVisible()?"block":"none",this._isStipeVisible()&&this.repositionStype(t,e))}},{key:"repositionStype",value:function(t,e){this.dom.line.style.display="block",this.dom.dot.style.display="block";var i=this.dom.dot.offsetWidth;if(e){var n=this.dom.line.offsetWidth+t+(e-t)/2,o=n-i/2,r=this.options.rtl?-1*o:o;this.dom.line.style.transform="translateX(".concat(this.options.rtl?-1*n:n,"px)"),this.dom.dot.style.transform="translateX(".concat(r,"px)")}else{var s=this.options.rtl?-1*(t-i/2):t-i/2;this.dom.line.style.transform="translateX(".concat(this.options.rtl?-1*t:t,"px)"),this.dom.dot.style.transform="translateX(".concat(s,"px)")}}},{key:"repositionXWithoutRanges",value:function(t,e){"right"==e?this.options.rtl?(this.right=t-this.width,this.dom.box.style.right=this.right+"px"):(this.left=t-this.width,this.dom.box.style.left=this.left+"px"):"left"==e?this.options.rtl?(this.right=t,this.dom.box.style.right=this.right+"px"):(this.left=t,this.dom.box.style.left=this.left+"px"):this.options.rtl?(this.right=t-this.width/2,this.dom.box.style.right=this.right+"px"):(this.left=t-this.width/2,this.dom.box.style.left=this.left+"px")}},{key:"repositionXWithRanges",value:function(t,e){var i=Math.round(Math.max(e-t+.5,1));this.options.rtl?this.right=t:this.left=t,this.width=Math.max(i,this.minWidth||0),this.options.rtl?this.dom.box.style.right=this.right+"px":this.dom.box.style.left=this.left+"px",this.dom.box.style.width=i+"px"}},{key:"repositionY",value:function(){var t=this.options.orientation.item;if(this.dom.box.style.top="top"==t?(this.top||0)+"px":(this.parent.height-this.top-this.height||0)+"px",this.options.showStipes){if("top"==t)this.dom.line.style.top="0",this.dom.line.style.height=this.parent.top+this.top+1+"px",this.dom.line.style.bottom="";else{var e=this.parent.itemSet.props.height;this.dom.line.style.top=e-(e-this.parent.top-this.parent.height+this.top)+"px",this.dom.line.style.bottom="0"}this.dom.dot.style.top=-this.dom.dot.offsetHeight/2+"px"}}},{key:"getWidthLeft",value:function(){return this.width/2}},{key:"getWidthRight",value:function(){return this.width/2}},{key:"move",value:function(){this.repositionX(),this.repositionY()}},{key:"attach",value:function(){var t,e,i=fu(this.data.uiItems);try{for(i.s();!(e=i.n()).done;)e.value.cluster=this}catch(t){i.e(t)}finally{i.f()}this.data.items=oo(t=this.data.uiItems).call(t,function(t){return t.data}),this.attached=!0,this.dirty=!0}},{key:"detach",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.hasItems()){var e,i=fu(this.data.uiItems);try{for(i.s();!(e=i.n()).done;)delete e.value.cluster}catch(t){i.e(t)}finally{i.f()}this.attached=!1,t&&this.group&&(this.group.remove(this),this.group=null),this.data.items=[],this.dirty=!0}}},{key:"_onDoubleClick",value:function(){this._fit()}},{key:"_setupRange",value:function(){var t,e,i,n=oo(t=this.data.uiItems).call(t,function(t){return{start:t.data.start.valueOf(),end:t.data.end?t.data.end.valueOf():t.data.start.valueOf()}});this.data.min=Math.min.apply(Math,qo(oo(n).call(n,function(t){return Math.min(t.start,t.end||t.start)}))),this.data.max=Math.max.apply(Math,qo(oo(n).call(n,function(t){return Math.max(t.start,t.end||t.start)})));var o=oo(e=this.data.uiItems).call(e,function(t){return t.center}),r=fo(o).call(o,function(t,e){return t+e},0)/this.data.uiItems.length;Xh(i=this.data.uiItems).call(i,function(t){return t.data.end})?(this.data.start=new Date(this.data.min),this.data.end=new Date(this.data.max)):(this.data.start=new Date(r),this.data.end=null)}},{key:"_getUiItems",value:function(){var t,e=this;return this.data.uiItems&&this.data.uiItems.length?Yn(t=this.data.uiItems).call(t,function(t){return t.cluster===e}):[]}},{key:"_createDomElement",value:function(){var t;this.dom||(this.dom={},this.dom.box=document.createElement("DIV"),this.dom.content=document.createElement("DIV"),this.dom.content.className="vis-item-content",this.dom.box.appendChild(this.dom.content),this.options.showStipes&&(this.dom.line=document.createElement("DIV"),this.dom.line.className="vis-cluster-line",this.dom.line.style.display="none",this.dom.dot=document.createElement("DIV"),this.dom.dot.className="vis-cluster-dot",this.dom.dot.style.display="none"),this.options.fitOnDoubleClick&&(this.dom.box.ondblclick=An(t=i.prototype._onDoubleClick).call(t,this)),this.dom.box["vis-item"]=this,this.dirty=!0)}},{key:"_appendDomElement",value:function(){if(!this.parent)throw new Error("Cannot redraw item: no parent attached");if(!this.dom.box.parentNode){var t=this.parent.dom.foreground;if(!t)throw new Error("Cannot redraw item: parent has no foreground container element");t.appendChild(this.dom.box)}var e=this.parent.dom.background;if(this.options.showStipes){if(!this.dom.line.parentNode){if(!e)throw new Error("Cannot redraw item: parent has no background container element");e.appendChild(this.dom.line)}if(!this.dom.dot.parentNode){var i=this.parent.dom.axis;if(!e)throw new Error("Cannot redraw item: parent has no axis container element");i.appendChild(this.dom.dot)}}this.displayed=!0}},{key:"_updateDirtyDomComponents",value:function(){this.dirty&&(this._updateContents(this.dom.content),this._updateDataAttributes(this.dom.box),this._updateStyle(this.dom.box),this.dom.box.className="vis-item "+this.baseClassName+" "+(this.data.className?" "+this.data.className:"")+(this.selected?" vis-selected":"")+" vis-readonly",this.options.showStipes&&(this.dom.line.className="vis-item vis-cluster-line "+(this.selected?" vis-selected":""),this.dom.dot.className="vis-item vis-cluster-dot "+(this.selected?" vis-selected":"")),this.data.end&&(this.dom.content.style.maxWidth="none"))}},{key:"_getDomComponentsSizes",value:function(){var t={previous:{right:this.dom.box.style.right,left:this.dom.box.style.left},box:{width:this.dom.box.offsetWidth,height:this.dom.box.offsetHeight}};return this.options.showStipes&&(t.dot={height:this.dom.dot.offsetHeight,width:this.dom.dot.offsetWidth},t.line={width:this.dom.line.offsetWidth}),t}},{key:"_updateDomComponentsSizes",value:function(t){this.options.rtl?this.dom.box.style.right="0px":this.dom.box.style.left="0px",this.data.end?this.minWidth=t.box.width:this.width=t.box.width,this.height=t.box.height,this.options.rtl?this.dom.box.style.right=t.previous.right:this.dom.box.style.left=t.previous.left,this.dirty=!1}},{key:"_repaintDomAdditionals",value:function(){this._repaintOnItemUpdateTimeTooltip(this.dom.box)}},{key:"_isStipeVisible",value:function(){return this.minWidth>=this.width||!this.data.end}},{key:"_getFitRange",value:function(){var t=.05*(this.data.max-this.data.min)/2;return{fitStart:this.data.min-t,fitEnd:this.data.max+t}}},{key:"_fit",value:function(){if(this.emitter){var t=this._getFitRange(),e=t.fitEnd,i={start:new Date(t.fitStart),end:new Date(e),animation:!0};this.emitter.emit("fit",i)}}},{key:"_getItemData",value:function(){return this.data}}]),i}(nu);function mu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}gu.prototype.baseClassName="vis-item vis-range vis-cluster";var vu=function(){function t(e){zt(this,t),this.itemSet=e,this.groups={},this.cache={},this.cache[-1]=[]}return jt(t,[{key:"createClusterItem",value:function(t,e,i){return new gu(t,e,i)}},{key:"setItems",value:function(t,e){this.items=t||[],this.dataChanged=!0,this.applyOnChangedLevel=!1,e&&e.applyOnChangedLevel&&(this.applyOnChangedLevel=e.applyOnChangedLevel)}},{key:"updateData",value:function(){this.dataChanged=!0,this.applyOnChangedLevel=!1}},{key:"getClusters",value:function(t,e,i){var n="boolean"==typeof i?{}:i,o=n.maxItems,r=n.clusterCriteria;r||(r=function(){return!0}),o=o||1;var s=-1,a=0;if(e>0){if(e>=1)return[];s=Math.abs(Math.round(Math.log(100/e)/Math.log(2))),a=Math.abs(Math.pow(2,s))}this.dataChanged&&(!this.applyOnChangedLevel||s!=this.cacheLevel)&&(this._dropLevelsCache(),this._filterData()),this.cacheLevel=s;var l=this.cache[s];if(!l){for(var c in l=[],this.groups)if(this.groups.hasOwnProperty(c))for(var h=this.groups[c],d=h.length,u=0;u<d;){for(var f=h[u],p=1,g=u-1;g>=0&&f.center-h[g].center<a/2;)!h[g].cluster&&r(f.data,h[g].data)&&p++,g--;for(var m=u+1;m<h.length&&h[m].center-f.center<a/2;)r(f.data,h[m].data)&&p++,m++;for(var v=l.length-1;v>=0&&f.center-l[v].center<a;)f.group==l[v].group&&r(f.data,l[v].data)&&p++,v--;if(p>o){for(var y=p-o+1,b=[],w=u;b.length<y&&w<h.length;)r(h[u].data,h[w].data)&&b.push(h[w]),w++;var k=this.itemSet.getGroupId(f.data),_=this._getClusterForItems(b,this.itemSet.groups[k]||this.itemSet.groups.__ungrouped__,t,i);l.push(_),u+=y}else delete f.cluster,u+=1}this.cache[s]=l}return l}},{key:"_filterData",value:function(){var t={};this.groups=t;for(var e=0,i=Sr(this.items);e<i.length;e++){var n=i[e],o=n.parent?n.parent.groupId:"",r=t[o];r||(t[o]=r=[]),r.push(n),n.data.start&&(n.center=n.data.end?(n.data.start.valueOf()+n.data.end.valueOf())/2:n.data.start.valueOf())}for(var s in t){var a;t.hasOwnProperty(s)&&Oh(a=t[s]).call(a,function(t,e){return t.center-e.center})}this.dataChanged=!1}},{key:"_getClusterForItems",value:function(t,e,i,n){var o,r,s=oo(o=i||[]).call(o,function(t){var e;return{cluster:t,itemsIds:new Vd(oo(e=t.data.uiItems).call(e,function(t){return t.id}))}});if(s.length){var a,l=function(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return mu(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mu(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(s);try{var c=function(){var e=a.value;if(e.itemsIds.size===t.length&&function(t){var e=t.every;return t===uu||t instanceof Array&&e===uu.every?du:e}(t).call(t,function(t){return e.itemsIds.has(t.id)}))return r=e.cluster,"break"};for(l.s();!(a=l.n()).done&&"break"!==c(););}catch(t){l.e(t)}finally{l.f()}}if(r)return r.setUiItems(t),r.group!==e&&(r.group&&r.group.remove(r),e&&(e.add(r),r.group=e)),r;var h={toScreen:this.itemSet.body.util.toScreen,toTime:this.itemSet.body.util.toTime},d=(n.titleTemplate||"").replace(/{count}/,t.length),u='<div title="'+d+'">'+t.length+"</div>",f=fr({},n,this.itemSet.options);return r=this.createClusterItem({content:u,title:d,group:e,uiItems:t,eventEmitter:this.itemSet.body.emitter,range:this.itemSet.body.range},h,f),e&&(e.add(r),r.group=e),r.attach(),r}},{key:"_dropLevelsCache",value:function(){this.cache={},this.cacheLevel=-1,this.cache[this.cacheLevel]=[]}}]),t}();function yu(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return bu(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bu(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}function bu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var wu="__ungrouped__",ku="__background__",_u=function(t){Zt(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(n);function n(t,i){var o;zt(this,n),(o=e.call(this)).body=t,o.defaultOptions={type:null,orientation:{item:"bottom"},align:"auto",stack:!0,stackSubgroups:!0,groupOrderSwap:function(t,e,i){var n=e.order;e.order=t.order,t.order=n},groupOrder:"order",selectable:!0,multiselect:!1,longSelectPressTime:251,itemsAlwaysDraggable:{item:!1,range:!1},editable:{updateTime:!1,updateGroup:!1,add:!1,remove:!1,overrideItems:!1},groupEditable:{order:!1,add:!1,remove:!1},snap:ed.snap,onDropObjectOnItem:function(t,e,i){i(e)},onAdd:function(t,e){e(t)},onUpdate:function(t,e){e(t)},onMove:function(t,e){e(t)},onRemove:function(t,e){e(t)},onMoving:function(t,e){e(t)},onAddGroup:function(t,e){e(t)},onMoveGroup:function(t,e){e(t)},onRemoveGroup:function(t,e){e(t)},margin:{item:{horizontal:10,vertical:10},axis:20},showTooltips:!0,tooltip:{followMouse:!1,overflowMethod:"flip",delay:500},tooltipOnItemUpdateTime:!1},o.options=ih.extend({},o.defaultOptions),o.options.rtl=i.rtl,o.options.onTimeout=i.onTimeout,o.conversion={toScreen:t.util.toScreen,toTime:t.util.toTime},o.dom={},o.props={},o.hammer=null;var r=Vt(o);return o.itemsData=null,o.groupsData=null,o.itemsSettingTime=null,o.initialItemSetDrawn=!1,o.userContinueNotBail=null,o.sequentialSelection=!1,o.itemListeners={add:function(t,e,i){r._onAdd(e.items),r.options.cluster&&r.clusterGenerator.setItems(r.items,{applyOnChangedLevel:!1}),r.redraw()},update:function(t,e,i){r._onUpdate(e.items),r.options.cluster&&r.clusterGenerator.setItems(r.items,{applyOnChangedLevel:!1}),r.redraw()},remove:function(t,e,i){r._onRemove(e.items),r.options.cluster&&r.clusterGenerator.setItems(r.items,{applyOnChangedLevel:!1}),r.redraw()}},o.groupListeners={add:function(t,e,i){if(r._onAddGroups(e.items),r.groupsData&&r.groupsData.length>0){var n,o=r.groupsData.getDataSet();Bn(n=o.get()).call(n,function(t){if(t.nestedGroups){var e;0!=t.showNested&&(t.showNested=!0);var n=[];Bn(e=t.nestedGroups).call(e,function(e){var i=o.get(e);i&&(i.nestedInGroup=t.id,0==t.showNested&&(i.visible=!1),n=Zo(n).call(n,i))}),o.update(n,i)}})}},update:function(t,e,i){r._onUpdateGroups(e.items)},remove:function(t,e,i){r._onRemoveGroups(e.items)}},o.items={},o.groups={},o.groupIds=[],o.selection=[],o.popup=null,o.popupTimer=null,o.touchParams={},o.groupTouchParams={group:null,isDragging:!1},o._create(),o.setOptions(i),o.clusters=[],o}return jt(n,[{key:"_create",value:function(){var t,e,i,n,o,r,s,a,l,c,h,d,u,f,p,g=this,m=document.createElement("div");m.className="vis-itemset",m["vis-itemset"]=this,this.dom.frame=m;var v=document.createElement("div");v.className="vis-background",m.appendChild(v),this.dom.background=v;var y=document.createElement("div");y.className="vis-foreground",m.appendChild(y),this.dom.foreground=y;var b=document.createElement("div");b.className="vis-axis",this.dom.axis=b;var w=document.createElement("div");w.className="vis-labelset",this.dom.labelSet=w,this._updateUngrouped();var k=new eu(ku,null,this);k.show(),this.groups[ku]=k,this.hammer=new Jh(this.body.dom.centerContainer),this.hammer.on("hammer.input",function(t){t.isFirst&&g._onTouch(t)}),this.hammer.on("panstart",An(t=this._onDragStart).call(t,this)),this.hammer.on("panmove",An(e=this._onDrag).call(e,this)),this.hammer.on("panend",An(i=this._onDragEnd).call(i,this)),this.hammer.get("pan").set({threshold:5,direction:Jh.ALL}),this.hammer.get("press").set({time:1e4}),this.hammer.on("tap",An(n=this._onSelectItem).call(n,this)),this.hammer.on("press",An(o=this._onMultiSelectItem).call(o,this)),this.hammer.get("press").set({time:1e4}),this.hammer.on("doubletap",An(r=this._onAddItem).call(r,this)),this.groupHammer=new Jh(this.options.rtl?this.body.dom.rightContainer:this.body.dom.leftContainer),this.groupHammer.on("tap",An(s=this._onGroupClick).call(s,this)),this.groupHammer.on("panstart",An(a=this._onGroupDragStart).call(a,this)),this.groupHammer.on("panmove",An(l=this._onGroupDrag).call(l,this)),this.groupHammer.on("panend",An(c=this._onGroupDragEnd).call(c,this)),this.groupHammer.get("pan").set({threshold:5,direction:Jh.DIRECTION_VERTICAL}),this.body.dom.centerContainer.addEventListener("mouseover",An(h=this._onMouseOver).call(h,this)),this.body.dom.centerContainer.addEventListener("mouseout",An(d=this._onMouseOut).call(d,this)),this.body.dom.centerContainer.addEventListener("mousemove",An(u=this._onMouseMove).call(u,this)),this.body.dom.centerContainer.addEventListener("contextmenu",An(f=this._onDragEnd).call(f,this)),this.body.dom.centerContainer.addEventListener("mousewheel",An(p=this._onMouseWheel).call(p,this)),this.show()}},{key:"setOptions",value:function(t){var e,i,n=this;t&&(ih.selectiveExtend(["type","rtl","align","order","stack","stackSubgroups","selectable","multiselect","sequentialSelection","multiselectPerGroup","longSelectPressTime","groupOrder","dataAttributes","template","groupTemplate","visibleFrameTemplate","hide","snap","groupOrderSwap","showTooltips","tooltip","tooltipOnItemUpdateTime","groupHeightMode","onTimeout"],this.options,t),"itemsAlwaysDraggable"in t&&("boolean"==typeof t.itemsAlwaysDraggable?(this.options.itemsAlwaysDraggable.item=t.itemsAlwaysDraggable,this.options.itemsAlwaysDraggable.range=!1):"object"===vn(t.itemsAlwaysDraggable)&&(ih.selectiveExtend(["item","range"],this.options.itemsAlwaysDraggable,t.itemsAlwaysDraggable),this.options.itemsAlwaysDraggable.item||(this.options.itemsAlwaysDraggable.range=!1))),"sequentialSelection"in t&&"boolean"==typeof t.sequentialSelection&&(this.options.sequentialSelection=t.sequentialSelection),"orientation"in t&&("string"==typeof t.orientation?this.options.orientation.item="top"===t.orientation?"top":"bottom":"object"===vn(t.orientation)&&"item"in t.orientation&&(this.options.orientation.item=t.orientation.item)),"margin"in t&&("number"==typeof t.margin?(this.options.margin.axis=t.margin,this.options.margin.item.horizontal=t.margin,this.options.margin.item.vertical=t.margin):"object"===vn(t.margin)&&(ih.selectiveExtend(["axis"],this.options.margin,t.margin),"item"in t.margin&&("number"==typeof t.margin.item?(this.options.margin.item.horizontal=t.margin.item,this.options.margin.item.vertical=t.margin.item):"object"===vn(t.margin.item)&&ih.selectiveExtend(["horizontal","vertical"],this.options.margin.item,t.margin.item)))),Bn(e=["locale","locales"]).call(e,function(e){e in t&&(n.options[e]=t[e])}),"editable"in t&&("boolean"==typeof t.editable?(this.options.editable.updateTime=t.editable,this.options.editable.updateGroup=t.editable,this.options.editable.add=t.editable,this.options.editable.remove=t.editable,this.options.editable.overrideItems=!1):"object"===vn(t.editable)&&ih.selectiveExtend(["updateTime","updateGroup","add","remove","overrideItems"],this.options.editable,t.editable)),"groupEditable"in t&&("boolean"==typeof t.groupEditable?(this.options.groupEditable.order=t.groupEditable,this.options.groupEditable.add=t.groupEditable,this.options.groupEditable.remove=t.groupEditable):"object"===vn(t.groupEditable)&&ih.selectiveExtend(["order","add","remove"],this.options.groupEditable,t.groupEditable)),Bn(i=["onDropObjectOnItem","onAdd","onUpdate","onRemove","onMove","onMoving","onAddGroup","onMoveGroup","onRemoveGroup"]).call(i,function(e){var i=t[e];if(i){var o;if("function"!=typeof i)throw new Error(Zo(o="option ".concat(e," must be a function ")).call(o,e,"(item, callback)"));n.options[e]=i}}),t.cluster?(fr(this.options,{cluster:t.cluster}),this.clusterGenerator||(this.clusterGenerator=new vu(this)),this.clusterGenerator.setItems(this.items,{applyOnChangedLevel:!1}),this.markDirty({refreshItems:!0,restackGroups:!0}),this.redraw()):this.clusterGenerator?(this._detachAllClusters(),this.clusters=[],this.clusterGenerator=null,this.options.cluster=void 0,this.markDirty({refreshItems:!0,restackGroups:!0}),this.redraw()):this.markDirty())}},{key:"markDirty",value:function(t){this.groupIds=[],t&&(t.refreshItems&&Bn(ih).call(ih,this.items,function(t){t.dirty=!0,t.displayed&&t.redraw()}),t.restackGroups&&Bn(ih).call(ih,this.groups,function(t,e){e!==ku&&(t.stackDirty=!0)}))}},{key:"destroy",value:function(){this.clearPopupTimer(),this.hide(),this.setItems(null),this.setGroups(null),this.hammer&&this.hammer.destroy(),this.groupHammer&&this.groupHammer.destroy(),this.hammer=null,this.body=null,this.conversion=null}},{key:"hide",value:function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame),this.dom.axis.parentNode&&this.dom.axis.parentNode.removeChild(this.dom.axis),this.dom.labelSet.parentNode&&this.dom.labelSet.parentNode.removeChild(this.dom.labelSet)}},{key:"show",value:function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame),this.dom.axis.parentNode||this.body.dom.backgroundVertical.appendChild(this.dom.axis),this.dom.labelSet.parentNode||(this.options.rtl?this.body.dom.right.appendChild(this.dom.labelSet):this.body.dom.left.appendChild(this.dom.labelSet))}},{key:"setPopupTimer",value:function(t){this.clearPopupTimer(),t&&(this.popupTimer=Mn(function(){t.show()},this.options.tooltip.delay||"number"==typeof this.options.tooltip.delay?this.options.tooltip.delay:500))}},{key:"clearPopupTimer",value:function(){null!=this.popupTimer&&(clearTimeout(this.popupTimer),this.popupTimer=null)}},{key:"setSelection",value:function(t){var e;null==t&&(t=[]),Cn(t)||(t=[t]);var i,n=yu(Yn(e=this.selection).call(e,function(e){return-1===Yr(t).call(t,e)}));try{for(n.s();!(i=n.n()).done;){var o=this.getItemById(i.value);o&&o.unselect()}}catch(t){n.e(t)}finally{n.f()}this.selection=qo(t);var r,s=yu(t);try{for(s.s();!(r=s.n()).done;){var a=this.getItemById(r.value);a&&a.select()}}catch(t){s.e(t)}finally{s.f()}}},{key:"getSelection",value:function(){var t;return Zo(t=this.selection).call(t,[])}},{key:"getVisibleItems",value:function(){var t,e,i=this.body.range.getRange();this.options.rtl?(t=this.body.util.toScreen(i.start),e=this.body.util.toScreen(i.end)):(e=this.body.util.toScreen(i.start),t=this.body.util.toScreen(i.end));var n=[];for(var o in this.groups)if(this.groups.hasOwnProperty(o)){var r,s=this.groups[o],a=yu(s.isVisible?s.visibleItems:[]);try{for(a.s();!(r=a.n()).done;){var l=r.value;this.options.rtl?l.right<e&&l.right+l.width>t&&n.push(l.id):l.left<t&&l.left+l.width>e&&n.push(l.id)}}catch(t){a.e(t)}finally{a.f()}}return n}},{key:"getItemsAtCurrentTime",value:function(t){var e,i;this.options.rtl?(e=this.body.util.toScreen(t),i=this.body.util.toScreen(t)):(i=this.body.util.toScreen(t),e=this.body.util.toScreen(t));var n=[];for(var o in this.groups)if(this.groups.hasOwnProperty(o)){var r,s=this.groups[o],a=yu(s.isVisible?s.visibleItems:[]);try{for(a.s();!(r=a.n()).done;){var l=r.value;this.options.rtl?l.right<i&&l.right+l.width>e&&n.push(l.id):l.left<e&&l.left+l.width>i&&n.push(l.id)}}catch(t){a.e(t)}finally{a.f()}}return n}},{key:"getVisibleGroups",value:function(){var t=[];for(var e in this.groups)this.groups.hasOwnProperty(e)&&this.groups[e].isVisible&&t.push(e);return t}},{key:"getItemById",value:function(t){var e;return this.items[t]||function(t){var e=t.find;return t===Ed||t instanceof Array&&e===Ed.find?Cd:e}(e=this.clusters).call(e,function(e){return e.id===t})}},{key:"_deselect",value:function(t){for(var e=this.selection,i=0,n=e.length;i<n;i++)if(e[i]==t){cr(e).call(e,i,1);break}}},{key:"redraw",value:function(){var t=this,e=this.options.margin,i=this.body.range,n=ih.option.asSize,o=this.options,r=o.orientation.item,s=!1,a=this.dom.frame;this.props.top=this.body.domProps.top.height+this.body.domProps.border.top,this.options.rtl?this.props.right=this.body.domProps.right.width+this.body.domProps.border.right:this.props.left=this.body.domProps.left.width+this.body.domProps.border.left,a.className="vis-itemset",this.options.cluster&&this._clusterItems(),s=this._orderGroups()||s;var l=i.end-i.start,c=l!=this.lastVisibleInterval||this.props.width!=this.props.lastWidth||i.start!=this.lastRangeStart||o.stack!=this.lastStack||o.stackSubgroups!=this.lastStackSubgroups;this.lastVisibleInterval=l,this.lastRangeStart=i.start,this.lastStack=o.stack,this.lastStackSubgroups=o.stackSubgroups,this.props.lastWidth=this.props.width;var h=this._firstGroup(),d={item:e.item,axis:e.axis},u={item:e.item,axis:e.item.vertical/2},f=0,p=e.axis+e.item.vertical;this.groups[ku].redraw(i,u,c);var g={},m=0;return Bn(ih).call(ih,this.groups,function(t,e){e!==ku&&(g[e]=t.redraw(i,t==h?d:u,c,!0),m=g[e].length)}),m>0&&function(){for(var e={},i=function(t){Bn(ih).call(ih,g,function(i,n){e[n]=i[t]()})},n=0;n<m;n++)i(n);Bn(ih).call(ih,t.groups,function(t,i){i!==ku&&(s=e[i]||s,f+=t.height)}),f=Math.max(f,p)}(),f=Math.max(f,p),a.style.height=n(f),this.props.width=a.offsetWidth,this.props.height=f,this.dom.axis.style.top=n("top"==r?this.body.domProps.top.height+this.body.domProps.border.top:this.body.domProps.top.height+this.body.domProps.centerContainer.height),this.options.rtl?this.dom.axis.style.right="0":this.dom.axis.style.left="0",this.hammer.get("press").set({time:this.options.longSelectPressTime}),this.initialItemSetDrawn=!0,s=this._isResized()||s}},{key:"_firstGroup",value:function(){return this.groups[this.groupIds["top"==this.options.orientation.item?0:this.groupIds.length-1]]||this.groups[wu]||null}},{key:"_updateUngrouped",value:function(){var t,e,i=this.groups[wu];if(this.groupsData){if(i)for(e in i.dispose(),delete this.groups[wu],this.items)if(this.items.hasOwnProperty(e)){(t=this.items[e]).parent&&t.parent.remove(t);var n=this.getGroupId(t.data),o=this.groups[n];o&&o.add(t)||t.hide()}}else if(!i){for(e in i=new tu(null,null,this),this.groups[wu]=i,this.items)this.items.hasOwnProperty(e)&&i.add(t=this.items[e]);i.show()}}},{key:"getLabelSet",value:function(){return this.dom.labelSet}},{key:"setItems",value:function(t){this.itemsSettingTime=new Date;var e,n=this,o=this.itemsData;if(t){if(!i.isDataViewLike("id",t))throw new TypeError("Data must implement the interface of DataSet or DataView");this.itemsData=Qc(t)}else this.itemsData=null;if(o&&(Bn(ih).call(ih,this.itemListeners,function(t,e){o.off(e,t)}),o.dispose(),e=o.getIds(),this._onRemove(e)),this.itemsData){var r=this.id;Bn(ih).call(ih,this.itemListeners,function(t,e){n.itemsData.on(e,t,r)}),e=this.itemsData.getIds(),this._onAdd(e),this._updateUngrouped()}this.body.emitter.emit("_change",{queue:!0})}},{key:"getItems",value:function(){return null!=this.itemsData?this.itemsData.rawDS:null}},{key:"setGroups",value:function(t){var e,n=this;if(this.groupsData&&(Bn(ih).call(ih,this.groupListeners,function(t,e){n.groupsData.off(e,t)}),e=this.groupsData.getIds(),this.groupsData=null,this._onRemoveGroups(e)),t){if(!i.isDataViewLike("id",t))throw new TypeError("Data must implement the interface of DataSet or DataView");this.groupsData=t}else this.groupsData=null;if(this.groupsData){var o,r=this.groupsData.getDataSet();Bn(o=r.get()).call(o,function(t){var e;t.nestedGroups&&Bn(e=t.nestedGroups).call(e,function(e){var i=r.get(e);i.nestedInGroup=t.id,0==t.showNested&&(i.visible=!1),r.update(i)})});var s=this.id;Bn(ih).call(ih,this.groupListeners,function(t,e){n.groupsData.on(e,t,s)}),e=this.groupsData.getIds(),this._onAddGroups(e)}this._updateUngrouped(),this._order(),this.options.cluster&&(this.clusterGenerator.updateData(),this._clusterItems(),this.markDirty({refreshItems:!0,restackGroups:!0})),this.body.emitter.emit("_change",{queue:!0})}},{key:"getGroups",value:function(){return this.groupsData}},{key:"removeItem",value:function(t){var e=this,i=this.itemsData.get(t);i&&this.options.onRemove(i,function(i){i&&e.itemsData.remove(t)})}},{key:"_getType",value:function(t){return t.type||this.options.type||(t.end?"range":"box")}},{key:"getGroupId",value:function(t){return"background"==this._getType(t)&&null==t.group?ku:this.groupsData?t.group:wu}},{key:"_onUpdate",value:function(t){var e=this,i=this;Bn(t).call(t,function(t){var o,r=i.itemsData.get(t),s=i.items[t],a=r?i._getType(r):null,l=n.types[a];if(s&&(l&&s instanceof l?i._updateItem(s,r):(o=s.selected,i._removeItem(s),s=null)),!s&&r){if(!l)throw new TypeError('Unknown item type "'.concat(a,'"'));(s=new l(r,i.conversion,i.options)).id=t,i._addItem(s),o&&(e.selection.push(t),s.select())}}),this._order(),this.options.cluster&&(this.clusterGenerator.setItems(this.items,{applyOnChangedLevel:!1}),this._clusterItems()),this.body.emitter.emit("_change",{queue:!0})}},{key:"_onRemove",value:function(t){var e=0,i=this;Bn(t).call(t,function(t){var n=i.items[t];n&&(e++,i._removeItem(n))}),e&&(this._order(),this.body.emitter.emit("_change",{queue:!0}))}},{key:"_order",value:function(){Bn(ih).call(ih,this.groups,function(t){t.order()})}},{key:"_onUpdateGroups",value:function(t){this._onAddGroups(t)}},{key:"_onAddGroups",value:function(t){var e=this;Bn(t).call(t,function(t){var i=e.groupsData.get(t),n=e.groups[t];if(n)n.setData(i);else{if(t==wu||t==ku)throw new Error("Illegal group id. ".concat(t," is a reserved id."));var o=Kr(e.options);for(var r in ih.extend(o,{height:null}),n=new tu(t,i,e),e.groups[t]=n,e.items)if(e.items.hasOwnProperty(r)){var s=e.items[r];s.data.group==t&&n.add(s)}n.order(),n.show()}}),this.body.emitter.emit("_change",{queue:!0})}},{key:"_onRemoveGroups",value:function(t){var e=this;Bn(t).call(t,function(t){var i=e.groups[t];i&&(i.dispose(),delete e.groups[t])}),this.options.cluster&&(this.clusterGenerator.updateData(),this._clusterItems()),this.markDirty({restackGroups:!!this.options.cluster}),this.body.emitter.emit("_change",{queue:!0})}},{key:"_orderGroups",value:function(){if(this.groupsData){var t=this.groupsData.getIds({order:this.options.groupOrder});t=this._orderNestedGroups(t);var e=!ih.equalArray(t,this.groupIds);if(e){var i=this.groups;Bn(t).call(t,function(t){i[t].hide()}),Bn(t).call(t,function(t){i[t].show()}),this.groupIds=t}return e}return!1}},{key:"_orderNestedGroups",value:function(t){var e=this;return function t(e,i){var n=[];return Bn(i).call(i,function(i){if(n.push(i),e.groupsData.get(i).nestedGroups){var o,r=oo(o=e.groupsData.get({filter:function(t){return t.nestedInGroup==i},order:e.options.groupOrder})).call(o,function(t){return t.id});n=Zo(n).call(n,t(e,r))}}),n}(this,Yn(t).call(t,function(t){return!e.groupsData.get(t).nestedInGroup}))}},{key:"_addItem",value:function(t){this.items[t.id]=t;var e=this.getGroupId(t.data),i=this.groups[e];i?i&&i.data&&i.data.showNested&&(t.groupShowing=!0):t.groupShowing=!1,i&&i.add(t)}},{key:"_updateItem",value:function(t,e){t.setData(e);var i=this.getGroupId(t.data),n=this.groups[i];n?n&&n.data&&n.data.showNested&&(t.groupShowing=!0):t.groupShowing=!1}},{key:"_removeItem",value:function(t){var e,i;t.hide(),delete this.items[t.id];var n=Yr(e=this.selection).call(e,t.id);-1!=n&&cr(i=this.selection).call(i,n,1),t.parent&&t.parent.remove(t),null!=this.popup&&this.popup.hide()}},{key:"_constructByEndArray",value:function(t){for(var e=[],i=0;i<t.length;i++)t[i]instanceof su&&e.push(t[i]);return e}},{key:"_onTouch",value:function(t){this.touchParams.item=this.itemFromTarget(t),this.touchParams.dragLeftItem=t.target.dragLeftItem||!1,this.touchParams.dragRightItem=t.target.dragRightItem||!1,this.touchParams.itemProps=null}},{key:"_getGroupIndex",value:function(t){for(var e=0;e<this.groupIds.length;e++)if(t==this.groupIds[e])return e}},{key:"_onDragStart",value:function(t){var e=this;if(!this.touchParams.itemIsDragging){var i,n=this.touchParams.item||null,o=this;if(n&&(n.selected||this.options.itemsAlwaysDraggable.item)){if(this.options.editable.overrideItems&&!this.options.editable.updateTime&&!this.options.editable.updateGroup)return;if(null!=n.editable&&!n.editable.updateTime&&!n.editable.updateGroup&&!this.options.editable.overrideItems)return;var r=this.touchParams.dragLeftItem,s=this.touchParams.dragRightItem;if(this.touchParams.itemIsDragging=!0,this.touchParams.selectedItem=n,r)i={item:r,initialX:t.center.x,dragLeft:!0,data:this._cloneItemData(n.data)},this.touchParams.itemProps=[i];else if(s)i={item:s,initialX:t.center.x,dragRight:!0,data:this._cloneItemData(n.data)},this.touchParams.itemProps=[i];else if(this.options.editable.add&&(t.srcEvent.ctrlKey||t.srcEvent.metaKey))this._onDragStartAddItem(t);else{this.groupIds.length<1&&this.redraw();var a=this._getGroupIndex(n.data.group),l=this.options.itemsAlwaysDraggable.item&&!n.selected?[n.id]:this.getSelection();this.touchParams.itemProps=oo(l).call(l,function(i){var n=o.items[i],r=o._getGroupIndex(n.data.group);return{item:n,initialX:t.center.x,groupOffset:a-r,data:e._cloneItemData(n.data)}})}t.stopPropagation()}else this.options.editable.add&&(t.srcEvent.ctrlKey||t.srcEvent.metaKey)&&this._onDragStartAddItem(t)}}},{key:"_onDragStartAddItem",value:function(t){var e=this.options.snap||null,i=this.dom.frame.getBoundingClientRect(),n=this.body.util.toTime(this.options.rtl?i.right-t.center.x+10:t.center.x-i.left-10),o=this.body.util.getScale(),r=this.body.util.getStep(),s=e?e(n,o,r):n,a={type:"range",start:s,end:s,content:"new item"},l=Yc();a[this.itemsData.idProp]=l;var c=this.groupFromTarget(t);c&&(a.group=c.groupId);var h=new su(a,this.conversion,this.options);h.id=l,h.data=this._cloneItemData(a),this._addItem(h),this.touchParams.selectedItem=h;var d={item:h,initialX:t.center.x,data:h.data};this.options.rtl?d.dragLeft=!0:d.dragRight=!0,this.touchParams.itemProps=[d],t.stopPropagation()}},{key:"_onDrag",value:function(t){var e=this;if(null!=this.popup&&this.options.showTooltips&&!this.popup.hidden){var i=this.body.dom.centerContainer,n=i.getBoundingClientRect();this.popup.setPosition(t.center.x-n.left+i.offsetLeft,t.center.y-n.top+i.offsetTop),this.popup.show()}if(this.touchParams.itemProps){var o;t.stopPropagation();var r=this,s=this.options.snap||null,a=this.body.dom.root.offsetLeft,l=this.options.rtl?a+this.body.domProps.right.width:a+this.body.domProps.left.width,c=this.body.util.getScale(),h=this.body.util.getStep(),d=this.touchParams.selectedItem,u=(this.options.editable.overrideItems||null==d.editable)&&this.options.editable.updateGroup||!this.options.editable.overrideItems&&null!=d.editable&&d.editable.updateGroup,f=null;if(u&&d&&null!=d.data.group){var p=r.groupFromTarget(t);p&&(f=this._getGroupIndex(p.groupId))}Bn(o=this.touchParams.itemProps).call(o,function(i){var n,o,a,p,g,m=r.body.util.toTime(t.center.x-l),v=r.body.util.toTime(i.initialX-l);n=e.options.rtl?-(m-v):m-v;var y=e._cloneItemData(i.item.data);if(null==i.item.editable||i.item.editable.updateTime||i.item.editable.updateGroup||r.options.editable.overrideItems){if((e.options.editable.overrideItems||null==d.editable)&&e.options.editable.updateTime||!e.options.editable.overrideItems&&null!=d.editable&&d.editable.updateTime)if(i.dragLeft)e.options.rtl?null!=y.end&&(a=ih.convert(i.data.end,"Date"),g=new Date(a.valueOf()+n),y.end=s?s(g,c,h):g):null!=y.start&&(o=ih.convert(i.data.start,"Date"),p=new Date(o.valueOf()+n),y.start=s?s(p,c,h):p);else if(i.dragRight)e.options.rtl?null!=y.start&&(o=ih.convert(i.data.start,"Date"),p=new Date(o.valueOf()+n),y.start=s?s(p,c,h):p):null!=y.end&&(a=ih.convert(i.data.end,"Date"),g=new Date(a.valueOf()+n),y.end=s?s(g,c,h):g);else if(null!=y.start)if(o=ih.convert(i.data.start,"Date").valueOf(),p=new Date(o+n),null!=y.end){var b=(a=ih.convert(i.data.end,"Date")).valueOf()-o.valueOf();y.start=s?s(p,c,h):p,y.end=new Date(y.start.valueOf()+b)}else y.start=s?s(p,c,h):p;if(u&&!i.dragLeft&&!i.dragRight&&null!=f&&null!=y.group){var w=f-i.groupOffset;w=Math.max(0,w),w=Math.min(r.groupIds.length-1,w),y.group=r.groupIds[w]}y=e._cloneItemData(y),r.options.onMoving(y,function(t){t&&i.item.setData(e._cloneItemData(t,"Date"))})}}),this.body.emitter.emit("_change")}}},{key:"_moveToGroup",value:function(t,e){var i=this.groups[e];if(i&&i.groupId!=t.data.group){var n=t.parent;n.remove(t),n.order(),t.data.group=i.groupId,i.add(t),i.order()}}},{key:"_onDragEnd",value:function(t){var e=this;if(this.touchParams.itemIsDragging=!1,this.touchParams.itemProps){t.stopPropagation();var i=this,n=this.touchParams.itemProps;this.touchParams.itemProps=null,Bn(n).call(n,function(t){var n=t.item.id;if(null!=i.itemsData.get(n)){var o=e._cloneItemData(t.item.data);i.options.onMove(o,function(o){o?(o[e.itemsData.idProp]=n,e.itemsData.update(o)):(t.item.setData(t.data),i.body.emitter.emit("_change"))})}else i.options.onAdd(t.item.data,function(e){i._removeItem(t.item),e&&i.itemsData.add(e),i.body.emitter.emit("_change")})})}}},{key:"_onGroupClick",value:function(t){var e=this,i=this.groupFromTarget(t);Mn(function(){e.toggleGroupShowNested(i)},1)}},{key:"toggleGroupShowNested",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(t&&t.nestedGroups){var n=this.groupsData.getDataSet();t.showNested=null!=i?!!i:!t.showNested;var o=n.get(t.groupId);o.showNested=t.showNested;for(var r=t.nestedGroups,s=r;s.length>0;){var a=s;s=[];for(var l=0;l<a.length;l++){var c=n.get(a[l]);c.nestedGroups&&(s=Zo(s).call(s,c.nestedGroups))}s.length>0&&(r=Zo(r).call(r,s))}var h=oo(e=n.get(r)).call(e,function(t){return null==t.visible&&(t.visible=!0),t.visible=!!o.showNested,t});n.update(Zo(h).call(h,o)),o.showNested?(ih.removeClassName(t.dom.label,"collapsed"),ih.addClassName(t.dom.label,"expanded")):(ih.removeClassName(t.dom.label,"expanded"),ih.addClassName(t.dom.label,"collapsed"))}}},{key:"toggleGroupDragClassName",value:function(t){t.dom.label.classList.toggle("vis-group-is-dragging"),t.dom.foreground.classList.toggle("vis-group-is-dragging")}},{key:"_onGroupDragStart",value:function(t){this.groupTouchParams.isDragging||this.options.groupEditable.order&&(this.groupTouchParams.group=this.groupFromTarget(t),this.groupTouchParams.group&&(t.stopPropagation(),this.groupTouchParams.isDragging=!0,this.toggleGroupDragClassName(this.groupTouchParams.group),this.groupTouchParams.originalOrder=this.groupsData.getIds({order:this.options.groupOrder})))}},{key:"_onGroupDrag",value:function(t){if(this.options.groupEditable.order&&this.groupTouchParams.group){t.stopPropagation();var e=this.groupsData.getDataSet(),i=this.groupFromTarget(t);if(i&&i.height!=this.groupTouchParams.group.height){var n=i.top<this.groupTouchParams.group.top,o=t.center?t.center.y:t.clientY,r=i.dom.foreground.getBoundingClientRect(),s=this.groupTouchParams.group.height;if(n){if(r.top+s<o)return}else if(r.top+i.height-s>o)return}if(i&&i!=this.groupTouchParams.group){var a=e.get(i.groupId),l=e.get(this.groupTouchParams.group.groupId);l&&a&&(this.options.groupOrderSwap(l,a,e),e.update(l),e.update(a));var c=e.getIds({order:this.options.groupOrder});if(!ih.equalArray(c,this.groupTouchParams.originalOrder))for(var h=this.groupTouchParams.originalOrder,d=this.groupTouchParams.group.groupId,u=Math.min(h.length,c.length),f=0,p=0,g=0;f<u;){for(;f+p<u&&f+g<u&&c[f+p]==h[f+g];)f++;if(f+p>=u)break;if(c[f+p]==d)p=1;else if(h[f+g]==d)g=1;else{var m=Yr(c).call(c,h[f+g]),v=e.get(c[f+p]),y=e.get(h[f+g]);this.options.groupOrderSwap(v,y,e),e.update(v),e.update(y);var b=c[f+p];c[f+p]=h[f+g],c[m]=b,f++}}}}}},{key:"_onGroupDragEnd",value:function(t){if(this.groupTouchParams.isDragging=!1,this.options.groupEditable.order&&this.groupTouchParams.group){t.stopPropagation();var e=this,i=e.groupTouchParams.group.groupId,n=e.groupsData.getDataSet(),o=ih.extend({},n.get(i));e.options.onMoveGroup(o,function(t){if(t)t[n._idProp]=i,n.update(t);else{var o=n.getIds({order:e.options.groupOrder});if(!ih.equalArray(o,e.groupTouchParams.originalOrder))for(var r=e.groupTouchParams.originalOrder,s=Math.min(r.length,o.length),a=0;a<s;){for(;a<s&&o[a]==r[a];)a++;if(a>=s)break;var l=Yr(o).call(o,r[a]),c=n.get(o[a]),h=n.get(r[a]);e.options.groupOrderSwap(c,h,n),n.update(c),n.update(h);var d=o[a];o[a]=r[a],o[l]=d,a++}}}),e.body.emitter.emit("groupDragged",{groupId:i}),this.toggleGroupDragClassName(this.groupTouchParams.group),this.groupTouchParams.group=null}}},{key:"_onSelectItem",value:function(t){if(this.options.selectable)if(t.srcEvent&&(t.srcEvent.ctrlKey||t.srcEvent.metaKey)||t.srcEvent&&t.srcEvent.shiftKey)this._onMultiSelectItem(t);else{var e=this.getSelection(),i=this.itemFromTarget(t);this.setSelection(i&&i.selectable?[i.id]:[]);var n=this.getSelection();(n.length>0||e.length>0)&&this.body.emitter.emit("select",{items:n,event:t})}}},{key:"_onMouseOver",value:function(t){var e=this.itemFromTarget(t);if(e&&e!==this.itemFromRelatedTarget(t)){var i=e.getTitle();if(this.options.showTooltips&&i){null==this.popup&&(this.popup=new lu(this.body.dom.root,this.options.tooltip.overflowMethod||"flip")),this.popup.setText(i);var n=this.body.dom.centerContainer,o=n.getBoundingClientRect();this.popup.setPosition(t.clientX-o.left+n.offsetLeft,t.clientY-o.top+n.offsetTop),this.setPopupTimer(this.popup)}else this.clearPopupTimer(),null!=this.popup&&this.popup.hide();this.body.emitter.emit("itemover",{item:e.id,event:t})}}},{key:"_onMouseOut",value:function(t){var e=this.itemFromTarget(t);e&&e!==this.itemFromRelatedTarget(t)&&(this.clearPopupTimer(),null!=this.popup&&this.popup.hide(),this.body.emitter.emit("itemout",{item:e.id,event:t}))}},{key:"_onMouseMove",value:function(t){if(this.itemFromTarget(t)&&(null!=this.popupTimer&&this.setPopupTimer(this.popup),this.options.showTooltips&&this.options.tooltip.followMouse&&this.popup&&!this.popup.hidden)){var e=this.body.dom.centerContainer,i=e.getBoundingClientRect();this.popup.setPosition(t.clientX-i.left+e.offsetLeft,t.clientY-i.top+e.offsetTop),this.popup.show()}}},{key:"_onMouseWheel",value:function(t){this.touchParams.itemIsDragging&&this._onDragEnd(t)}},{key:"_onUpdateItem",value:function(t){if(this.options.selectable&&(this.options.editable.updateTime||this.options.editable.updateGroup)){var e=this;if(t){var i=e.itemsData.get(t.id);this.options.onUpdate(i,function(t){t&&e.itemsData.update(t)})}}}},{key:"_onDropObjectOnItem",value:function(t){var e=this.itemFromTarget(t),i=JSON.parse(t.dataTransfer.getData("text"));this.options.onDropObjectOnItem(i,e)}},{key:"_onAddItem",value:function(t){if(this.options.selectable&&this.options.editable.add){var e,i,n=this,o=this.options.snap||null,r=this.dom.frame.getBoundingClientRect(),s=this.options.rtl?r.right-t.center.x:t.center.x-r.left,a=this.body.util.toTime(s),l=this.body.util.getScale(),c=this.body.util.getStep();"drop"==t.type?((i=JSON.parse(t.dataTransfer.getData("text"))).content=i.content?i.content:"new item",i.start=i.start?i.start:o?o(a,l,c):a,i.type=i.type||"box",i[this.itemsData.idProp]=i.id||Yc(),"range"!=i.type||i.end||(e=this.body.util.toTime(s+this.props.width/5),i.end=o?o(e,l,c):e)):((i={start:o?o(a,l,c):a,content:"new item"})[this.itemsData.idProp]=Yc(),"range"===this.options.type&&(e=this.body.util.toTime(s+this.props.width/5),i.end=o?o(e,l,c):e));var h=this.groupFromTarget(t);h&&(i.group=h.groupId),i=this._cloneItemData(i),this.options.onAdd(i,function(e){e&&(n.itemsData.add(e),"drop"==t.type&&n.setSelection([e.id]))})}}},{key:"_onMultiSelectItem",value:function(t){var e=this;if(this.options.selectable){var i=this.itemFromTarget(t);if(i){var o=this.options.multiselect?this.getSelection():[];if((t.srcEvent&&t.srcEvent.shiftKey||this.options.sequentialSelection)&&this.options.multiselect){var r=this.itemsData.get(i.id).group,s=void 0;this.options.multiselectPerGroup&&o.length>0&&(s=this.itemsData.get(o[0]).group),this.options.multiselectPerGroup&&null!=s&&s!=r||o.push(i.id);var a=n._getItemRange(this.itemsData.get(o));if(!this.options.multiselectPerGroup||s==r)for(var l in o=[],this.items)if(this.items.hasOwnProperty(l)){var c=this.items[l],h=c.data.start;!(h>=a.min&&(void 0!==c.data.end?c.data.end:h)<=a.max)||this.options.multiselectPerGroup&&s!=this.itemsData.get(c.id).group||c instanceof au||o.push(c.id)}}else{var d=Yr(o).call(o,i.id);-1==d?o.push(i.id):cr(o).call(o,d,1)}var u=Yn(o).call(o,function(t){return e.getItemById(t).selectable});this.setSelection(u),this.body.emitter.emit("select",{items:this.getSelection(),event:t})}}}},{key:"itemFromElement",value:function(t){for(var e=t;e;){if(e.hasOwnProperty("vis-item"))return e["vis-item"];e=e.parentNode}return null}},{key:"itemFromTarget",value:function(t){return this.itemFromElement(t.target)}},{key:"itemFromRelatedTarget",value:function(t){return this.itemFromElement(t.relatedTarget)}},{key:"groupFromTarget",value:function(t){var e=t.center?t.center.y:t.clientY,i=this.groupIds;i.length<=0&&this.groupsData&&(i=this.groupsData.getIds({order:this.options.groupOrder}));for(var n=0;n<i.length;n++){var o=this.groups[i[n]],r=o.dom.foreground,s=r.getBoundingClientRect();if(e>=s.top&&e<s.top+r.offsetHeight)return o;if("top"===this.options.orientation.item){if(n===this.groupIds.length-1&&e>s.top)return o}else if(0===n&&e<s.top+r.offset)return o}return null}},{key:"_cloneItemData",value:function(t,e){var i=ih.extend({},t);return e||(e=this.itemsData.type),null!=i.start&&(i.start=ih.convert(i.start,e&&e.start||"Date")),null!=i.end&&(i.end=ih.convert(i.end,e&&e.end||"Date")),i}},{key:"_clusterItems",value:function(){if(this.options.cluster){var t=this.body.range.conversion(this.body.domProps.center.width).scale,e=this.clusterGenerator.getClusters(this.clusters,t,this.options.cluster);if(this.clusters!=e){if(this._detachAllClusters(),e){var i,n=yu(e);try{for(n.s();!(i=n.n()).done;)i.value.attach()}catch(t){n.e(t)}finally{n.f()}this.clusters=e}this._updateClusters(e)}}}},{key:"_detachAllClusters",value:function(){if(this.options.cluster&&this.clusters&&this.clusters.length){var t,e=yu(this.clusters);try{for(e.s();!(t=e.n()).done;)t.value.detach()}catch(t){e.e(t)}finally{e.f()}}}},{key:"_updateClusters",value:function(t){if(this.clusters&&this.clusters.length){var e,i,n=new Vd(oo(t).call(t,function(t){return t.id})),o=!1,r=yu(Yn(e=this.clusters).call(e,function(t){return!n.has(t.id)}));try{for(r.s();!(i=r.n()).done;){var s,a,l=i.value,c=Yr(s=this.selection).call(s,l.id);-1!==c&&(l.unselect(),cr(a=this.selection).call(a,c,1),o=!0)}}catch(t){r.e(t)}finally{r.f()}if(o){var h=this.getSelection();this.body.emitter.emit("select",{items:h,event:event})}}this.clusters=t||[]}}],[{key:"_getItemRange",value:function(t){var e=null,i=null;return Bn(t).call(t,function(t){(null==i||t.start<i)&&(i=t.start),null!=t.end?(null==e||t.end>e)&&(e=t.end):(null==e||t.start>e)&&(e=t.start)}),{min:i,max:e}}},{key:"itemSetFromTarget",value:function(t){for(var e=t.target;e;){if(e.hasOwnProperty("vis-itemset"))return e["vis-itemset"];e=e.parentNode}return null}}]),n}(ah);_u.types={background:au,box:ou,range:su,point:ru},_u.prototype._onAdd=_u.prototype._onUpdate;var xu,Cu=!1,Eu="background: #FFeeee; color: #dd0000",Tu=function(){function t(){zt(this,t)}return jt(t,null,[{key:"validate",value:function(e,i,n){Cu=!1,xu=i;var o=i;return void 0!==n&&(o=i[n]),t.parse(e,o,[]),Cu}},{key:"parse",value:function(e,i,n){for(var o in e)e.hasOwnProperty(o)&&t.check(o,e,i,n)}},{key:"check",value:function(e,i,n,o){if(void 0!==n[e]||void 0!==n.__any__){var r=e,s=!0;void 0===n[e]&&void 0!==n.__any__&&(r="__any__",s="object"===t.getType(i[e]));var a=n[r];s&&void 0!==a.__type__&&(a=a.__type__),t.checkFields(e,i,n,r,a,o)}else t.getSuggestion(e,n,o)}},{key:"checkFields",value:function(e,i,n,o,r,s){var a=function(i){console.log("%c"+i+t.printLocation(s,e),Eu)},l=t.getType(i[e]),c=r[l];void 0!==c?"array"===t.getType(c)&&-1===Yr(c).call(c,i[e])?(a('Invalid option detected in "'+e+'". Allowed values are:'+t.print(c)+' not "'+i[e]+'". '),Cu=!0):"object"===l&&"__any__"!==o&&(s=ih.copyAndExtendArray(s,e),t.parse(i[e],n[o],s)):void 0===r.any&&(a('Invalid type received for "'+e+'". Expected: '+t.print(go(r))+". Received ["+l+'] "'+i[e]+'"'),Cu=!0)}},{key:"getType",value:function(t){var e=vn(t);return"object"===e?null===t?"null":t instanceof Boolean?"boolean":t instanceof Number?"number":t instanceof String?"string":Cn(t)?"array":t instanceof Date?"date":void 0!==t.nodeType?"dom":!0===t._isAMomentObject?"moment":"object":"number"===e?"number":"boolean"===e?"boolean":"string"===e?"string":void 0===e?"undefined":e}},{key:"getSuggestion",value:function(e,i,n){var o,r=t.findInOptions(e,i,n,!1),s=t.findInOptions(e,xu,[],!0);o=void 0!==r.indexMatch?" in "+t.printLocation(r.path,e,"")+'Perhaps it was incomplete? Did you mean: "'+r.indexMatch+'"?\n\n':s.distance<=4&&r.distance>s.distance?" in "+t.printLocation(r.path,e,"")+"Perhaps it was misplaced? Matching option found at: "+t.printLocation(s.path,s.closestMatch,""):r.distance<=8?'. Did you mean "'+r.closestMatch+'"?'+t.printLocation(r.path,e):". Did you mean one of these: "+t.print(go(i))+t.printLocation(n,e),console.log('%cUnknown option detected: "'+e+'"'+o,Eu),Cu=!0}},{key:"findInOptions",value:function(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=1e9,s="",a=[],l=e.toLowerCase(),c=void 0;for(var h in i){var d=void 0;if(void 0!==i[h].__type__&&!0===o){var u=t.findInOptions(e,i[h],ih.copyAndExtendArray(n,h));r>u.distance&&(s=u.closestMatch,a=u.path,r=u.distance,c=u.indexMatch)}else{var f;-1!==Yr(f=h.toLowerCase()).call(f,l)&&(c=h),r>(d=t.levenshteinDistance(e,h))&&(s=h,a=ih.copyArray(n),r=d)}}return{closestMatch:s,path:a,distance:r,indexMatch:c}}},{key:"printLocation",value:function(t,e){for(var i="\n\n"+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Problem value found at: \n")+"options = {\n",n=0;n<t.length;n++){for(var o=0;o<n+1;o++)i+="  ";i+=t[n]+": {\n"}for(var r=0;r<t.length+1;r++)i+="  ";i+=e+"\n";for(var s=0;s<t.length+1;s++){for(var a=0;a<t.length-s;a++)i+="  ";i+="}\n"}return i+"\n\n"}},{key:"print",value:function(t){return os(t).replace(/(\")|(\[)|(\])|(,"__type__")/g,"").replace(/(\,)/g,", ")}},{key:"levenshteinDistance",value:function(t,e){if(0===t.length)return e.length;if(0===e.length)return t.length;var i,n,o=[];for(i=0;i<=e.length;i++)o[i]=[i];for(n=0;n<=t.length;n++)o[0][n]=n;for(i=1;i<=e.length;i++)for(n=1;n<=t.length;n++)o[i][n]=e.charAt(i-1)==t.charAt(n-1)?o[i-1][n-1]:Math.min(o[i-1][n-1]+1,Math.min(o[i][n-1]+1,o[i-1][n]+1));return o[e.length][t.length]}}]),t}(),Su="string",Au="boolean",Ou="number",Iu="array",Pu="date",Mu="object",Du="moment",Nu={configure:{enabled:{boolean:Au},filter:{boolean:Au,function:"function"},container:{dom:"dom"},__type__:{object:Mu,boolean:Au,function:"function"}},align:{string:Su},alignCurrentTime:{string:Su,undefined:"undefined"},rtl:{boolean:Au,undefined:"undefined"},rollingMode:{follow:{boolean:Au},offset:{number:Ou,undefined:"undefined"},__type__:{object:Mu}},onTimeout:{timeoutMs:{number:Ou},callback:{function:"function"},__type__:{object:Mu}},verticalScroll:{boolean:Au,undefined:"undefined"},horizontalScroll:{boolean:Au,undefined:"undefined"},autoResize:{boolean:Au},throttleRedraw:{number:Ou},clickToUse:{boolean:Au},dataAttributes:{string:Su,array:Iu},editable:{add:{boolean:Au,undefined:"undefined"},remove:{boolean:Au,undefined:"undefined"},updateGroup:{boolean:Au,undefined:"undefined"},updateTime:{boolean:Au,undefined:"undefined"},overrideItems:{boolean:Au,undefined:"undefined"},__type__:{boolean:Au,object:Mu}},end:{number:Ou,date:Pu,string:Su,moment:Du},format:{minorLabels:{millisecond:{string:Su,undefined:"undefined"},second:{string:Su,undefined:"undefined"},minute:{string:Su,undefined:"undefined"},hour:{string:Su,undefined:"undefined"},weekday:{string:Su,undefined:"undefined"},day:{string:Su,undefined:"undefined"},week:{string:Su,undefined:"undefined"},month:{string:Su,undefined:"undefined"},year:{string:Su,undefined:"undefined"},__type__:{object:Mu,function:"function"}},majorLabels:{millisecond:{string:Su,undefined:"undefined"},second:{string:Su,undefined:"undefined"},minute:{string:Su,undefined:"undefined"},hour:{string:Su,undefined:"undefined"},weekday:{string:Su,undefined:"undefined"},day:{string:Su,undefined:"undefined"},week:{string:Su,undefined:"undefined"},month:{string:Su,undefined:"undefined"},year:{string:Su,undefined:"undefined"},__type__:{object:Mu,function:"function"}},__type__:{object:Mu}},moment:{function:"function"},groupHeightMode:{string:Su},groupOrder:{string:Su,function:"function"},groupEditable:{add:{boolean:Au,undefined:"undefined"},remove:{boolean:Au,undefined:"undefined"},order:{boolean:Au,undefined:"undefined"},__type__:{boolean:Au,object:Mu}},groupOrderSwap:{function:"function"},height:{string:Su,number:Ou},hiddenDates:{start:{date:Pu,number:Ou,string:Su,moment:Du},end:{date:Pu,number:Ou,string:Su,moment:Du},repeat:{string:Su},__type__:{object:Mu,array:Iu}},itemsAlwaysDraggable:{item:{boolean:Au,undefined:"undefined"},range:{boolean:Au,undefined:"undefined"},__type__:{boolean:Au,object:Mu}},limitSize:{boolean:Au},locale:{string:Su},locales:{__any__:{any:"any"},__type__:{object:Mu}},longSelectPressTime:{number:Ou},margin:{axis:{number:Ou},item:{horizontal:{number:Ou,undefined:"undefined"},vertical:{number:Ou,undefined:"undefined"},__type__:{object:Mu,number:Ou}},__type__:{object:Mu,number:Ou}},max:{date:Pu,number:Ou,string:Su,moment:Du},maxHeight:{number:Ou,string:Su},maxMinorChars:{number:Ou},min:{date:Pu,number:Ou,string:Su,moment:Du},minHeight:{number:Ou,string:Su},moveable:{boolean:Au},multiselect:{boolean:Au},multiselectPerGroup:{boolean:Au},onAdd:{function:"function"},onDropObjectOnItem:{function:"function"},onUpdate:{function:"function"},onMove:{function:"function"},onMoving:{function:"function"},onRemove:{function:"function"},onAddGroup:{function:"function"},onMoveGroup:{function:"function"},onRemoveGroup:{function:"function"},onInitialDrawComplete:{function:"function"},order:{function:"function"},orientation:{axis:{string:Su,undefined:"undefined"},item:{string:Su,undefined:"undefined"},__type__:{string:Su,object:Mu}},selectable:{boolean:Au},sequentialSelection:{boolean:Au},showCurrentTime:{boolean:Au},showMajorLabels:{boolean:Au},showMinorLabels:{boolean:Au},showWeekScale:{boolean:Au},stack:{boolean:Au},stackSubgroups:{boolean:Au},cluster:{maxItems:{number:Ou,undefined:"undefined"},titleTemplate:{string:Su,undefined:"undefined"},clusterCriteria:{function:"function",undefined:"undefined"},showStipes:{boolean:Au,undefined:"undefined"},fitOnDoubleClick:{boolean:Au,undefined:"undefined"},__type__:{boolean:Au,object:Mu}},snap:{function:"function",null:"null"},start:{date:Pu,number:Ou,string:Su,moment:Du},template:{function:"function"},loadingScreenTemplate:{function:"function"},groupTemplate:{function:"function"},visibleFrameTemplate:{string:Su,function:"function"},showTooltips:{boolean:Au},tooltip:{followMouse:{boolean:Au},overflowMethod:{string:["cap","flip","none"]},delay:{number:Ou},template:{function:"function"},__type__:{object:Mu}},tooltipOnItemUpdateTime:{template:{function:"function"},__type__:{boolean:Au,object:Mu}},timeAxis:{scale:{string:Su,undefined:"undefined"},step:{number:Ou,undefined:"undefined"},__type__:{object:Mu}},type:{string:Su},width:{string:Su,number:Ou},preferZoom:{boolean:Au},zoomable:{boolean:Au},zoomKey:{string:["ctrlKey","altKey","shiftKey","metaKey",""]},zoomFriction:{number:Ou},zoomMax:{number:Ou},zoomMin:{number:Ou},xss:{disabled:{boolean:Au},filterOptions:{__any__:{any:"any"},__type__:{object:Mu}},__type__:{object:Mu}},__type__:{object:Mu}},Ru={global:{align:["center","left","right"],alignCurrentTime:["none","year","month","quarter","week","isoWeek","day","date","hour","minute","second"],direction:!1,autoResize:!0,clickToUse:!1,editable:{add:!1,remove:!1,updateGroup:!1,updateTime:!1},end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",year:""}},groupHeightMode:["auto","fixed","fitItems"],groupsDraggable:!1,height:"",locale:"",longSelectPressTime:251,margin:{axis:[20,0,100,1],item:{horizontal:[10,0,100,1],vertical:[10,0,100,1]}},max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:!1,multiselect:!1,multiselectPerGroup:!1,orientation:{axis:["both","bottom","top"],item:["bottom","top"]},preferZoom:!1,selectable:!0,showCurrentTime:!1,showMajorLabels:!0,showMinorLabels:!0,stack:!0,stackSubgroups:!0,cluster:!1,start:"",showTooltips:!0,tooltip:{followMouse:!1,overflowMethod:"flip",delay:[500,0,99999,100]},tooltipOnItemUpdateTime:!1,type:["box","point","range","background"],width:"100%",zoomable:!0,zoomKey:["ctrlKey","altKey","shiftKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1],xss:{disabled:!1}}},zu={black:"#000000",navy:"#000080",darkblue:"#00008B",mediumblue:"#0000CD",blue:"#0000FF",darkgreen:"#006400",green:"#008000",teal:"#008080",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",lime:"#00FF00",springgreen:"#00FF7F",aqua:"#00FFFF",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",mediumaquamarine:"#66CDAA",dimgray:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",lightslategray:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",maroon:"#800000",purple:"#800080",olive:"#808000",gray:"#808080",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370D8",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",silver:"#C0C0C0",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgrey:"#D3D3D3",palevioletred:"#D87093",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",red:"#FF0000",fuchsia:"#FF00FF",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",yellow:"#FFFF00",lightyellow:"#FFFFE0",ivory:"#FFFFF0",white:"#FFFFFF"},Fu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;zt(this,t),this.pixelRatio=e,this.generated=!1,this.centerCoordinates={x:144.5,y:144.5},this.r=289*.49,this.color={r:255,g:255,b:255,a:1},this.hueCircle=void 0,this.initialColor={r:255,g:255,b:255,a:1},this.previousColor=void 0,this.applied=!1,this.updateCallback=function(){},this.closeCallback=function(){},this._create()}return jt(t,[{key:"insertTo",value:function(t){void 0!==this.hammer&&(this.hammer.destroy(),this.hammer=void 0),this.container=t,this.container.appendChild(this.frame),this._bindHammer(),this._setSize()}},{key:"setUpdateCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker update callback is not a function.");this.updateCallback=t}},{key:"setCloseCallback",value:function(t){if("function"!=typeof t)throw new Error("Function attempted to set as colorPicker closing callback is not a function.");this.closeCallback=t}},{key:"_isColorString",value:function(t){if("string"==typeof t)return zu[t]}},{key:"setColor",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("none"!==t){var i,n=this._isColorString(t);if(void 0!==n&&(t=n),!0===ih.isString(t)){if(!0===ih.isValidRGB(t)){var o=t.substr(4).substr(0,t.length-5).split(",");i={r:o[0],g:o[1],b:o[2],a:1}}else if(!0===ih.isValidRGBA(t)){var r=t.substr(5).substr(0,t.length-6).split(",");i={r:r[0],g:r[1],b:r[2],a:r[3]}}else if(!0===ih.isValidHex(t)){var s=ih.hexToRGB(t);i={r:s.r,g:s.g,b:s.b,a:1}}}else t instanceof Object&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&(i={r:t.r,g:t.g,b:t.b,a:void 0!==t.a?t.a:"1.0"});if(void 0===i)throw new Error("Unknown color passed to the colorPicker. Supported are strings: rgb, hex, rgba. Object: rgb ({r:r,g:g,b:b,[a:a]}). Supplied: "+os(t));this._setColor(i,e)}}},{key:"show",value:function(){void 0!==this.closeCallback&&(this.closeCallback(),this.closeCallback=void 0),this.applied=!1,this.frame.style.display="block",this._generateHueCircle()}},{key:"_hide",value:function(){var t=this;!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.previousColor=ih.extend({},this.color)),!0===this.applied&&this.updateCallback(this.initialColor),this.frame.style.display="none",Mn(function(){void 0!==t.closeCallback&&(t.closeCallback(),t.closeCallback=void 0)},0)}},{key:"_save",value:function(){this.updateCallback(this.color),this.applied=!1,this._hide()}},{key:"_apply",value:function(){this.applied=!0,this.updateCallback(this.color),this._updatePicker(this.color)}},{key:"_loadLast",value:function(){void 0!==this.previousColor?this.setColor(this.previousColor,!1):alert("There is no last color to load...")}},{key:"_setColor",value:function(t){!0===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(this.initialColor=ih.extend({},t)),this.color=t;var e=ih.RGBToHSV(t.r,t.g,t.b),i=2*Math.PI,n=this.r*e.s,o=this.centerCoordinates.x+n*Math.sin(i*e.h),r=this.centerCoordinates.y+n*Math.cos(i*e.h);this.colorPickerSelector.style.left=o-.5*this.colorPickerSelector.clientWidth+"px",this.colorPickerSelector.style.top=r-.5*this.colorPickerSelector.clientHeight+"px",this._updatePicker(t)}},{key:"_setOpacity",value:function(t){this.color.a=t/100,this._updatePicker(this.color)}},{key:"_setBrightness",value:function(t){var e=ih.RGBToHSV(this.color.r,this.color.g,this.color.b);e.v=t/100;var i=ih.HSVToRGB(e.h,e.s,e.v);i.a=this.color.a,this.color=i,this._updatePicker()}},{key:"_updatePicker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.color,e=ih.RGBToHSV(t.r,t.g,t.b),i=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1)),i.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0),i.clearRect(0,0,this.colorPickerCanvas.clientWidth,this.colorPickerCanvas.clientHeight),i.putImageData(this.hueCircle,0,0),i.fillStyle="rgba(0,0,0,"+(1-e.v)+")",i.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),as(i).call(i),this.brightnessRange.value=100*e.v,this.opacityRange.value=100*t.a,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}},{key:"_setSize",value:function(){this.colorPickerCanvas.style.width="100%",this.colorPickerCanvas.style.height="100%",this.colorPickerCanvas.width=289*this.pixelRatio,this.colorPickerCanvas.height=289*this.pixelRatio}},{key:"_create",value:function(){var t,e,i,n;if(this.frame=document.createElement("div"),this.frame.className="vis-color-picker",this.colorPickerDiv=document.createElement("div"),this.colorPickerSelector=document.createElement("div"),this.colorPickerSelector.className="vis-selector",this.colorPickerDiv.appendChild(this.colorPickerSelector),this.colorPickerCanvas=document.createElement("canvas"),this.colorPickerDiv.appendChild(this.colorPickerCanvas),this.colorPickerCanvas.getContext){var o=this.colorPickerCanvas.getContext("2d");this.pixelRatio=(window.devicePixelRatio||1)/(o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1),this.colorPickerCanvas.getContext("2d").setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0)}else{var r=document.createElement("DIV");r.style.color="red",r.style.fontWeight="bold",r.style.padding="10px",r.innerHTML="Error: your browser does not support HTML canvas",this.colorPickerCanvas.appendChild(r)}this.colorPickerDiv.className="vis-color",this.opacityDiv=document.createElement("div"),this.opacityDiv.className="vis-opacity",this.brightnessDiv=document.createElement("div"),this.brightnessDiv.className="vis-brightness",this.arrowDiv=document.createElement("div"),this.arrowDiv.className="vis-arrow",this.opacityRange=document.createElement("input");try{this.opacityRange.type="range",this.opacityRange.min="0",this.opacityRange.max="100"}catch(t){}this.opacityRange.value="100",this.opacityRange.className="vis-range",this.brightnessRange=document.createElement("input");try{this.brightnessRange.type="range",this.brightnessRange.min="0",this.brightnessRange.max="100"}catch(t){}this.brightnessRange.value="100",this.brightnessRange.className="vis-range",this.opacityDiv.appendChild(this.opacityRange),this.brightnessDiv.appendChild(this.brightnessRange);var s=this;this.opacityRange.onchange=function(){s._setOpacity(this.value)},this.opacityRange.oninput=function(){s._setOpacity(this.value)},this.brightnessRange.onchange=function(){s._setBrightness(this.value)},this.brightnessRange.oninput=function(){s._setBrightness(this.value)},this.brightnessLabel=document.createElement("div"),this.brightnessLabel.className="vis-label vis-brightness",this.brightnessLabel.innerHTML="brightness:",this.opacityLabel=document.createElement("div"),this.opacityLabel.className="vis-label vis-opacity",this.opacityLabel.innerHTML="opacity:",this.newColorDiv=document.createElement("div"),this.newColorDiv.className="vis-new-color",this.newColorDiv.innerHTML="new",this.initialColorDiv=document.createElement("div"),this.initialColorDiv.className="vis-initial-color",this.initialColorDiv.innerHTML="initial",this.cancelButton=document.createElement("div"),this.cancelButton.className="vis-button vis-cancel",this.cancelButton.innerHTML="cancel",this.cancelButton.onclick=An(t=this._hide).call(t,this,!1),this.applyButton=document.createElement("div"),this.applyButton.className="vis-button vis-apply",this.applyButton.innerHTML="apply",this.applyButton.onclick=An(e=this._apply).call(e,this),this.saveButton=document.createElement("div"),this.saveButton.className="vis-button vis-save",this.saveButton.innerHTML="save",this.saveButton.onclick=An(i=this._save).call(i,this),this.loadButton=document.createElement("div"),this.loadButton.className="vis-button vis-load",this.loadButton.innerHTML="load last",this.loadButton.onclick=An(n=this._loadLast).call(n,this),this.frame.appendChild(this.colorPickerDiv),this.frame.appendChild(this.arrowDiv),this.frame.appendChild(this.brightnessLabel),this.frame.appendChild(this.brightnessDiv),this.frame.appendChild(this.opacityLabel),this.frame.appendChild(this.opacityDiv),this.frame.appendChild(this.newColorDiv),this.frame.appendChild(this.initialColorDiv),this.frame.appendChild(this.cancelButton),this.frame.appendChild(this.applyButton),this.frame.appendChild(this.saveButton),this.frame.appendChild(this.loadButton)}},{key:"_bindHammer",value:function(){var t=this;this.drag={},this.pinch={},this.hammer=new Jh(this.colorPickerCanvas),this.hammer.get("pinch").set({enable:!0}),td(this.hammer,function(e){t._moveSelector(e)}),this.hammer.on("tap",function(e){t._moveSelector(e)}),this.hammer.on("panstart",function(e){t._moveSelector(e)}),this.hammer.on("panmove",function(e){t._moveSelector(e)}),this.hammer.on("panend",function(e){t._moveSelector(e)})}},{key:"_generateHueCircle",value:function(){if(!1===this.generated){var t=this.colorPickerCanvas.getContext("2d");void 0===this.pixelRation&&(this.pixelRatio=(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)),t.setTransform(this.pixelRatio,0,0,this.pixelRatio,0,0);var e,i,n,o,r=this.colorPickerCanvas.clientWidth,s=this.colorPickerCanvas.clientHeight;t.clearRect(0,0,r,s),this.centerCoordinates={x:.5*r,y:.5*s},this.r=.49*r;var a,l=2*Math.PI/360,c=1/this.r;for(n=0;n<360;n++)for(o=0;o<this.r;o++)e=this.centerCoordinates.x+o*Math.sin(l*n),i=this.centerCoordinates.y+o*Math.cos(l*n),a=ih.HSVToRGB(.002777777777777778*n,o*c,1),t.fillStyle="rgb("+a.r+","+a.g+","+a.b+")",t.fillRect(e-.5,i-.5,2,2);t.strokeStyle="rgba(0,0,0,1)",t.circle(this.centerCoordinates.x,this.centerCoordinates.y,this.r),t.stroke(),this.hueCircle=t.getImageData(0,0,r,s)}this.generated=!0}},{key:"_moveSelector",value:function(t){var e=this.colorPickerDiv.getBoundingClientRect(),i=.5*this.colorPickerDiv.clientHeight,n=.5*this.colorPickerDiv.clientWidth,o=t.center.x-e.left-n,r=t.center.y-e.top-i,s=Math.atan2(o,r),a=.98*Math.min(Math.sqrt(o*o+r*r),n),l=Math.cos(s)*a+i,c=Math.sin(s)*a+n;this.colorPickerSelector.style.top=l-.5*this.colorPickerSelector.clientHeight+"px",this.colorPickerSelector.style.left=c-.5*this.colorPickerSelector.clientWidth+"px";var h=s/(2*Math.PI);h=h<0?h+1:h;var d=a/this.r,u=ih.RGBToHSV(this.color.r,this.color.g,this.color.b);u.h=h,u.s=d;var f=ih.HSVToRGB(u.h,u.s,u.v);f.a=this.color.a,this.color=f,this.initialColorDiv.style.backgroundColor="rgba("+this.initialColor.r+","+this.initialColor.g+","+this.initialColor.b+","+this.initialColor.a+")",this.newColorDiv.style.backgroundColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")"}}]),t}(),Lu=function(){function t(e,i,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;zt(this,t),this.parent=e,this.changedOptions=[],this.container=i,this.allowCreation=!1,this.options={},this.initialized=!1,this.popupCounter=0,this.defaultOptions={enabled:!1,filter:!0,container:void 0,showButton:!0},ih.extend(this.options,this.defaultOptions),this.configureOptions=n,this.moduleOptions={},this.domElements=[],this.popupDiv={},this.popupLimit=5,this.popupHistory={},this.colorPicker=new Fu(o),this.wrapper=void 0}return jt(t,[{key:"setOptions",value:function(t){if(void 0!==t){this.popupHistory={},this._removePopup();var e=!0;if("string"==typeof t)this.options.filter=t;else if(Cn(t))this.options.filter=t.join();else if("object"===vn(t)){if(null==t)throw new TypeError("options cannot be null");void 0!==t.container&&(this.options.container=t.container),void 0!==Yn(t)&&(this.options.filter=Yn(t)),void 0!==t.showButton&&(this.options.showButton=t.showButton),void 0!==t.enabled&&(e=t.enabled)}else"boolean"==typeof t?(this.options.filter=!0,e=t):"function"==typeof t&&(this.options.filter=t,e=!0);!1===Yn(this.options)&&(e=!1),this.options.enabled=e}this._clean()}},{key:"setModuleOptions",value:function(t){this.moduleOptions=t,!0===this.options.enabled&&(this._clean(),void 0!==this.options.container&&(this.container=this.options.container),this._create())}},{key:"_create",value:function(){this._clean(),this.changedOptions=[];var t=Yn(this.options),e=0,i=!1;for(var n in this.configureOptions)this.configureOptions.hasOwnProperty(n)&&(this.allowCreation=!1,i=!1,"function"==typeof t?i=(i=t(n,[]))||this._handleObject(this.configureOptions[n],[n],!0):!0!==t&&-1===Yr(t).call(t,n)||(i=!0),!1!==i&&(this.allowCreation=!0,e>0&&this._makeItem([]),this._makeHeader(n),this._handleObject(this.configureOptions[n],[n])),e++);this._makeButton(),this._push()}},{key:"_push",value:function(){this.wrapper=document.createElement("div"),this.wrapper.className="vis-configuration-wrapper",this.container.appendChild(this.wrapper);for(var t=0;t<this.domElements.length;t++)this.wrapper.appendChild(this.domElements[t]);this._showPopupIfNeeded()}},{key:"_clean",value:function(){for(var t=0;t<this.domElements.length;t++)this.wrapper.removeChild(this.domElements[t]);void 0!==this.wrapper&&(this.container.removeChild(this.wrapper),this.wrapper=void 0),this.domElements=[],this._removePopup()}},{key:"_getValue",value:function(t){for(var e=this.moduleOptions,i=0;i<t.length;i++){if(void 0===e[t[i]]){e=void 0;break}e=e[t[i]]}return e}},{key:"_makeItem",value:function(t){if(!0===this.allowCreation){var e=document.createElement("div");e.className="vis-configuration vis-config-item vis-config-s"+t.length;for(var i=arguments.length,n=new Array(i>1?i-1:0),o=1;o<i;o++)n[o-1]=arguments[o];return Bn(n).call(n,function(t){e.appendChild(t)}),this.domElements.push(e),this.domElements.length}return 0}},{key:"_makeHeader",value:function(t){var e=document.createElement("div");e.className="vis-configuration vis-config-header",e.innerHTML=ih.xss(t),this._makeItem([],e)}},{key:"_makeLabel",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=document.createElement("div");return n.className="vis-configuration vis-config-label vis-config-s"+e.length,n.innerHTML=ih.xss(!0===i?"<i><b>"+t+":</b></i>":t+":"),n}},{key:"_makeDropdown",value:function(t,e,i){var n=document.createElement("select");n.className="vis-configuration vis-config-select";var o=0;void 0!==e&&-1!==Yr(t).call(t,e)&&(o=Yr(t).call(t,e));for(var r=0;r<t.length;r++){var s=document.createElement("option");s.value=t[r],r===o&&(s.selected="selected"),s.innerHTML=t[r],n.appendChild(s)}var a=this;n.onchange=function(){a._update(this.value,i)};var l=this._makeLabel(i[i.length-1],i);this._makeItem(i,l,n)}},{key:"_makeRange",value:function(t,e,i){var n=t[0],o=t[1],r=t[2],s=t[3],a=document.createElement("input");a.className="vis-configuration vis-config-range";try{a.type="range",a.min=o,a.max=r}catch(t){}a.step=s;var l="",c=0;if(void 0!==e){var h=1.2;e<0&&e*h<o?(a.min=Math.ceil(e*h),c=a.min,l="range increased"):e/h<o&&(a.min=Math.ceil(e/h),c=a.min,l="range increased"),e*h>r&&1!==r&&(a.max=Math.ceil(e*h),c=a.max,l="range increased"),a.value=e}else a.value=n;var d=document.createElement("input");d.className="vis-configuration vis-config-rangeinput",d.value=Number(a.value);var u=this;a.onchange=function(){d.value=this.value,u._update(Number(this.value),i)},a.oninput=function(){d.value=this.value};var f=this._makeLabel(i[i.length-1],i),p=this._makeItem(i,f,a,d);""!==l&&this.popupHistory[p]!==c&&(this.popupHistory[p]=c,this._setupPopup(l,p))}},{key:"_makeButton",value:function(){var t=this;if(!0===this.options.showButton){var e=document.createElement("div");e.className="vis-configuration vis-config-button",e.innerHTML="generate options",e.onclick=function(){t._printOptions()},e.onmouseover=function(){e.className="vis-configuration vis-config-button hover"},e.onmouseout=function(){e.className="vis-configuration vis-config-button"},this.optionsContainer=document.createElement("div"),this.optionsContainer.className="vis-configuration vis-config-option-container",this.domElements.push(this.optionsContainer),this.domElements.push(e)}}},{key:"_setupPopup",value:function(t,e){var i=this;if(!0===this.initialized&&!0===this.allowCreation&&this.popupCounter<this.popupLimit){var n=document.createElement("div");n.id="vis-configuration-popup",n.className="vis-configuration-popup",n.innerHTML=ih.xss(t),n.onclick=function(){i._removePopup()},this.popupCounter+=1,this.popupDiv={html:n,index:e}}}},{key:"_removePopup",value:function(){void 0!==this.popupDiv.html&&(this.popupDiv.html.parentNode.removeChild(this.popupDiv.html),clearTimeout(this.popupDiv.hideTimeout),clearTimeout(this.popupDiv.deleteTimeout),this.popupDiv={})}},{key:"_showPopupIfNeeded",value:function(){var t=this;if(void 0!==this.popupDiv.html){var e=this.domElements[this.popupDiv.index].getBoundingClientRect();this.popupDiv.html.style.left=e.left+"px",this.popupDiv.html.style.top=e.top-30+"px",document.body.appendChild(this.popupDiv.html),this.popupDiv.hideTimeout=Mn(function(){t.popupDiv.html.style.opacity=0},1500),this.popupDiv.deleteTimeout=Mn(function(){t._removePopup()},1800)}}},{key:"_makeCheckbox",value:function(t,e,i){var n=document.createElement("input");n.type="checkbox",n.className="vis-configuration vis-config-checkbox",n.checked=t,void 0!==e&&(n.checked=e,e!==t&&("object"===vn(t)?e!==t.enabled&&this.changedOptions.push({path:i,value:e}):this.changedOptions.push({path:i,value:e})));var o=this;n.onchange=function(){o._update(this.checked,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeTextInput",value:function(t,e,i){var n=document.createElement("input");n.type="text",n.className="vis-configuration vis-config-text",n.value=e,e!==t&&this.changedOptions.push({path:i,value:e});var o=this;n.onchange=function(){o._update(this.value,i)};var r=this._makeLabel(i[i.length-1],i);this._makeItem(i,r,n)}},{key:"_makeColorField",value:function(t,e,i){var n=this,o=t[1],r=document.createElement("div");"none"!==(e=void 0===e?o:e)?(r.className="vis-configuration vis-config-colorBlock",r.style.backgroundColor=e):r.className="vis-configuration vis-config-colorBlock none",e=void 0===e?o:e,r.onclick=function(){n._showColorPicker(e,r,i)};var s=this._makeLabel(i[i.length-1],i);this._makeItem(i,s,r)}},{key:"_showColorPicker",value:function(t,e,i){var n=this;e.onclick=function(){},this.colorPicker.insertTo(e),this.colorPicker.show(),this.colorPicker.setColor(t),this.colorPicker.setUpdateCallback(function(t){var o="rgba("+t.r+","+t.g+","+t.b+","+t.a+")";e.style.backgroundColor=o,n._update(o,i)}),this.colorPicker.setCloseCallback(function(){e.onclick=function(){n._showColorPicker(t,e,i)}})}},{key:"_handleObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=Yn(this.options),r=!1;for(var s in t)if(t.hasOwnProperty(s)){n=!0;var a=t[s],l=ih.copyAndExtendArray(e,s);if("function"==typeof o&&!1===(n=o(s,e))&&!Cn(a)&&"string"!=typeof a&&"boolean"!=typeof a&&a instanceof Object&&(this.allowCreation=!1,n=this._handleObject(a,l,!0),this.allowCreation=!1===i),!1!==n){r=!0;var c=this._getValue(l);if(Cn(a))this._handleArray(a,c,l);else if("string"==typeof a)this._makeTextInput(a,c,l);else if("boolean"==typeof a)this._makeCheckbox(a,c,l);else if(a instanceof Object){var h=!0;if(-1!==Yr(e).call(e,"physics")&&this.moduleOptions.physics.solver!==s&&(h=!1),!0===h)if(void 0!==a.enabled){var d=ih.copyAndExtendArray(l,"enabled"),u=this._getValue(d);if(!0===u){var f=this._makeLabel(s,l,!0);this._makeItem(l,f),r=this._handleObject(a,l)||r}else this._makeCheckbox(a,u,l)}else{var p=this._makeLabel(s,l,!0);this._makeItem(l,p),r=this._handleObject(a,l)||r}}else console.error("dont know how to handle",a,s,l)}}return r}},{key:"_handleArray",value:function(t,e,i){"string"==typeof t[0]&&"color"===t[0]?(this._makeColorField(t,e,i),t[1]!==e&&this.changedOptions.push({path:i,value:e})):"string"==typeof t[0]?(this._makeDropdown(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:e})):"number"==typeof t[0]&&(this._makeRange(t,e,i),t[0]!==e&&this.changedOptions.push({path:i,value:Number(e)}))}},{key:"_update",value:function(t,e){var i=this._constructOptions(t,e);this.parent.body&&this.parent.body.emitter&&this.parent.body.emitter.emit&&this.parent.body.emitter.emit("configChange",i),this.initialized=!0,this.parent.setOptions(i)}},{key:"_constructOptions",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=i;t="false"!==(t="true"===t||t)&&t;for(var o=0;o<e.length;o++)"global"!==e[o]&&(void 0===n[e[o]]&&(n[e[o]]={}),o!==e.length-1?n=n[e[o]]:n[e[o]]=t);return i}},{key:"_printOptions",value:function(){var t=this.getOptions();this.optionsContainer.innerHTML="<pre>var options = "+os(t,null,2)+"</pre>"}},{key:"getOptions",value:function(){for(var t={},e=0;e<this.changedOptions.length;e++)this._constructOptions(this.changedOptions[e].value,this.changedOptions[e].path,t);return t}}]),t}(),Bu=function(t){Zt(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(n);function n(t,o,r,s){var a,l,c,h,d,u,f,p;if(zt(this,n),(p=e.call(this)).initTime=new Date,p.itemsDone=!1,!(Vt(p)instanceof n))throw new SyntaxError("Constructor must be called with the new operator");if(!Cn(r)&&!i.isDataViewLike("id",r)&&r instanceof Object){var g=s;s=r,r=g}s&&s.throttleRedraw&&console.warn('Timeline option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.');var m=Vt(p);if(p.defaultOptions={autoResize:!0,longSelectPressTime:251,orientation:{axis:"bottom",item:"bottom"},moment:jn},p.options=ih.deepExtend({},p.defaultOptions),s&&ih.setupXSSProtection(s.xss),p._create(t),!s||s&&void 0===s.rtl){var v;p.dom.root.style.visibility="hidden";for(var y=p.dom.root;!v&&y;)v=window.getComputedStyle(y,null).direction,y=y.parentElement;p.options.rtl=v&&"rtl"==v.toLowerCase()}else p.options.rtl=s.rtl;s&&(s.rollingMode&&(p.options.rollingMode=s.rollingMode),s.onInitialDrawComplete&&(p.options.onInitialDrawComplete=s.onInitialDrawComplete),s.onTimeout&&(p.options.onTimeout=s.onTimeout),s.loadingScreenTemplate&&(p.options.loadingScreenTemplate=s.loadingScreenTemplate));var b=document.createElement("div");if(p.options.loadingScreenTemplate){var w,k=An(w=p.options.loadingScreenTemplate).call(w,Vt(p)),_=k(p.dom.loadingScreen);_ instanceof Object&&!(_ instanceof Element)?k(b):_ instanceof Element?(b.innerHTML="",b.appendChild(_)):null!=_&&(b.innerHTML=ih.xss(_))}function x(t,e){m.hasListeners(t)&&m.emit(t,m.getEventProperties(e))}return p.dom.loadingScreen.appendChild(b),p.components=[],p.body={dom:p.dom,domProps:p.props,emitter:{on:An(a=p.on).call(a,Vt(p)),off:An(l=p.off).call(l,Vt(p)),emit:An(c=p.emit).call(c,Vt(p))},hiddenDates:[],util:{getScale:function(){return m.timeAxis.step.scale},getStep:function(){return m.timeAxis.step.step},toScreen:An(h=m._toScreen).call(h,m),toGlobalScreen:An(d=m._toGlobalScreen).call(d,m),toTime:An(u=m._toTime).call(u,m),toGlobalTime:An(f=m._toGlobalTime).call(f,m)}},p.range=new qh(p.body,p.options),p.components.push(p.range),p.body.range=p.range,p.timeAxis=new id(p.body,p.options),p.timeAxis2=null,p.components.push(p.timeAxis),p.currentTime=new kd(p.body,p.options),p.components.push(p.currentTime),p.itemSet=new _u(p.body,p.options),p.components.push(p.itemSet),p.itemsData=null,p.groupsData=null,p.dom.root.onclick=function(t){x("click",t)},p.dom.root.ondblclick=function(t){x("doubleClick",t)},p.dom.root.oncontextmenu=function(t){x("contextmenu",t)},p.dom.root.onmouseover=function(t){x("mouseOver",t)},window.PointerEvent?(p.dom.root.onpointerdown=function(t){x("mouseDown",t)},p.dom.root.onpointermove=function(t){x("mouseMove",t)},p.dom.root.onpointerup=function(t){x("mouseUp",t)}):(p.dom.root.onmousemove=function(t){x("mouseMove",t)},p.dom.root.onmousedown=function(t){x("mouseDown",t)},p.dom.root.onmouseup=function(t){x("mouseUp",t)}),p.initialFitDone=!1,p.on("changed",function(){if(null!=m.itemsData){if(!m.initialFitDone&&!m.options.rollingMode)if(m.initialFitDone=!0,null!=m.options.start||null!=m.options.end){if(null==m.options.start||null==m.options.end)var t=m.getItemRange();m.setWindow(null!=m.options.start?m.options.start:t.min,null!=m.options.end?m.options.end:t.max,{animation:!1})}else m.fit({animation:!1});m.initialDrawDone||!m.initialRangeChangeDone&&(m.options.start||m.options.end)&&!m.options.rollingMode||(m.initialDrawDone=!0,m.itemSet.initialDrawDone=!0,m.dom.root.style.visibility="visible",m.dom.loadingScreen.parentNode.removeChild(m.dom.loadingScreen),m.options.onInitialDrawComplete&&Mn(function(){return m.options.onInitialDrawComplete()},0))}}),p.on("destroyTimeline",function(){m.destroy()}),s&&p.setOptions(s),p.body.emitter.on("fit",function(t){p._onFit(t),p.redraw()}),r&&p.setGroups(r),o&&p.setItems(o),p._redraw(),p}return jt(n,[{key:"_createConfigurator",value:function(){return new Lu(this,this.dom.container,Ru)}},{key:"redraw",value:function(){this.itemSet&&this.itemSet.markDirty({refreshItems:!0}),this._redraw()}},{key:"setOptions",value:function(t){if(!0===Tu.validate(t,Nu)&&console.log("%cErrors have been found in the supplied options object.",Eu),wd.prototype.setOptions.call(this,t),"type"in t&&t.type!==this.options.type){this.options.type=t.type;var e=this.itemsData;if(e){var i=this.getSelection();this.setItems(null),this.setItems(e.rawDS),this.setSelection(i)}}}},{key:"setItems",value:function(t){var e;this.itemsDone=!1,e=t?i.isDataViewLike("id",t)?Qc(t):Qc(new i.DataSet(t)):null,this.itemsData&&this.itemsData.dispose(),this.itemsData=e,this.itemSet&&this.itemSet.setItems(null!=e?e.rawDS:null)}},{key:"setGroups",value:function(t){var e;t?(Cn(t)&&(t=new i.DataSet(t)),e=new i.DataView(t,{filter:function(t){return!1!==t.visible}})):e=null,null!=this.groupsData&&"function"==typeof this.groupsData.setData&&this.groupsData.setData(null),this.groupsData=e,this.itemSet.setGroups(e)}},{key:"setData",value:function(t){t&&t.groups&&this.setGroups(t.groups),t&&t.items&&this.setItems(t.items)}},{key:"setSelection",value:function(t,e){this.itemSet&&this.itemSet.setSelection(t),e&&e.focus&&this.focus(t,e)}},{key:"getSelection",value:function(){return this.itemSet&&this.itemSet.getSelection()||[]}},{key:"focus",value:function(t,e){if(this.itemsData&&null!=t){var i=Cn(t)?t:[t],n=this.itemsData.get(i),o=null,r=null;if(Bn(n).call(n,function(t){var e=t.start.valueOf(),i="end"in t?t.end.valueOf():t.start.valueOf();(null===o||e<o)&&(o=e),(null===r||i>r)&&(r=i)}),null!==o&&null!==r){var s=this,a=this.itemSet.items[i[0]],l=-1*this._getScrollTop(),c=null,h=function(){var t=Hu(s,a);t.shouldScroll&&t.itemTop!=c.itemTop&&(s._setScrollTop(-t.scrollOffset),s._redraw())},d=(o+r)/2,u=!e||void 0===e.zoom||e.zoom?1.1*(r-o):Math.max(this.range.end-this.range.start,1.1*(r-o)),f=!e||void 0===e.animation||e.animation;f||(c={shouldScroll:!1,scrollOffset:-1,itemTop:-1}),this.range.setRange(d-u/2,d+u/2,{animation:f},function(){h(),Mn(h,100)},function(t,e,i){var n=Hu(s,a);if(!1!==n&&(c||(c=n),c.itemTop!=n.itemTop||c.shouldScroll)){c.itemTop!=n.itemTop&&n.shouldScroll&&(c=n,l=-1*s._getScrollTop());var o=c.scrollOffset;s._setScrollTop(-(i?o:l+(o-l)*t)),e||s._redraw()}})}}}},{key:"fit",value:function(t,e){var i,n=!t||void 0===t.animation||t.animation;1===this.itemsData.length&&void 0===this.itemsData.get()[0].end?(i=this.getDataRange(),this.moveTo(i.min.valueOf(),{animation:n},e)):(i=this.getItemRange(),this.range.setRange(i.min,i.max,{animation:n},e))}},{key:"getItemRange",value:function(){var t=this,e=this.getDataRange(),i=null!==e.min?e.min.valueOf():null,n=null!==e.max?e.max.valueOf():null,o=null,r=null;if(null!=i&&null!=n){var s=n-i;s<=0&&(s=10);var a=s/this.props.center.width,l={},c=0;if(Bn(ih).call(ih,this.itemSet.items,function(t,e){t.groupShowing&&(l[e]=t.redraw(!0),c=l[e].length)}),c>0)for(var h=function(t){Bn(ih).call(ih,l,function(e){e[t]()})},d=0;d<c;d++)h(d);if(Bn(ih).call(ih,this.itemSet.items,function(e){var s,l,c=ju(e),h=Vu(e);t.options.rtl?(s=c-(e.getWidthRight()+10)*a,l=h+(e.getWidthLeft()+10)*a):(s=c-(e.getWidthLeft()+10)*a,l=h+(e.getWidthRight()+10)*a),s<i&&(i=s,o=e),l>n&&(n=l,r=e)}),o&&r){var u=o.getWidthLeft()+10,f=r.getWidthRight()+10,p=this.props.center.width-u-f;p>0&&(this.options.rtl?(i=ju(o)-f*s/p,n=Vu(r)+u*s/p):(i=ju(o)-u*s/p,n=Vu(r)+f*s/p))}}return{min:null!=i?new Date(i):null,max:null!=n?new Date(n):null}}},{key:"getDataRange",value:function(){var t,e=null,i=null;return this.itemsData&&Bn(t=this.itemsData).call(t,function(t){var n=ih.convert(t.start,"Date").valueOf(),o=ih.convert(null!=t.end?t.end:t.start,"Date").valueOf();(null===e||n<e)&&(e=n),(null===i||o>i)&&(i=o)}),{min:null!=e?new Date(e):null,max:null!=i?new Date(i):null}}},{key:"getEventProperties",value:function(t){var e=t.center?t.center.x:t.clientX,i=t.center?t.center.y:t.clientY,n=this.dom.centerContainer.getBoundingClientRect(),o=this.options.rtl?n.right-e:e-n.left,r=i-n.top,s=this.itemSet.itemFromTarget(t),a=this.itemSet.groupFromTarget(t),l=bd.customTimeFromTarget(t),c=this.itemSet.options.snap||null,h=this.body.util.getScale(),d=this.body.util.getStep(),u=this._toTime(o),f=c?c(u,h,d):u,p=ih.getTarget(t),g=null;return null!=s?g="item":null!=l?g="custom-time":ih.hasParent(p,this.timeAxis.dom.foreground)||this.timeAxis2&&ih.hasParent(p,this.timeAxis2.dom.foreground)?g="axis":ih.hasParent(p,this.itemSet.dom.labelSet)?g="group-label":ih.hasParent(p,this.currentTime.bar)?g="current-time":ih.hasParent(p,this.dom.center)&&(g="background"),{event:t,item:s?s.id:null,isCluster:!!s&&!!s.isCluster,items:s?s.items||[]:null,group:a?a.groupId:null,customTime:l?l.options.id:null,what:g,pageX:t.srcEvent?t.srcEvent.pageX:t.pageX,pageY:t.srcEvent?t.srcEvent.pageY:t.pageY,x:o,y:r,time:u,snappedTime:f}}},{key:"toggleRollingMode",value:function(){this.range.rolling?this.range.stopRolling():(null==this.options.rollingMode&&this.setOptions(this.options),this.range.startRolling())}},{key:"_redraw",value:function(){wd.prototype._redraw.call(this)}},{key:"_onFit",value:function(t){var e=t.start,i=t.end,n=t.animation;i?this.range.setRange(e,i,{animation:n}):this.moveTo(e.valueOf(),{animation:n})}}]),n}(wd);function ju(t){return ih.convert(t.data.start,"Date").valueOf()}function Vu(t){return ih.convert(null!=t.data.end?t.data.end:t.data.start,"Date").valueOf()}function Hu(t,e){if(!e.parent)return!1;var i=t.options.rtl?t.props.rightContainer.height:t.props.leftContainer.height,n=t.props.center.height,o=e.parent,r=o.top,s=!0,a=t.timeAxis.options.orientation.axis,l=function(){return"bottom"==a?o.height-e.top-e.height:e.top},c=-1*t._getScrollTop(),h=r+l(),d=e.height;return h<c?r+i<=r+l()+d&&(r+=l()-t.itemSet.options.margin.item.vertical):h+d>c+i?r+=l()+d-i+t.itemSet.options.margin.item.vertical:s=!1,{shouldScroll:s,scrollOffset:r=Math.min(r,n-i),itemTop:h}}function Wu(t){for(var e in t)t.hasOwnProperty(e)&&(t[e].redundant=t[e].used,t[e].used=[])}function qu(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e].redundant){for(var i=0;i<t[e].redundant.length;i++)t[e].redundant[i].parentNode.removeChild(t[e].redundant[i]);t[e].redundant=[]}}function Uu(t,e,i){var n;return e.hasOwnProperty(t)?e[t].redundant.length>0?(n=e[t].redundant[0],e[t].redundant.shift()):(n=document.createElementNS("http://www.w3.org/2000/svg",t),i.appendChild(n)):(n=document.createElementNS("http://www.w3.org/2000/svg",t),e[t]={used:[],redundant:[]},i.appendChild(n)),e[t].used.push(n),n}function Yu(t,e,i,n){var o;return e.hasOwnProperty(t)?e[t].redundant.length>0?(o=e[t].redundant[0],e[t].redundant.shift()):(o=document.createElement(t),void 0!==n?i.insertBefore(o,n):i.appendChild(o)):(o=document.createElement(t),e[t]={used:[],redundant:[]},void 0!==n?i.insertBefore(o,n):i.appendChild(o)),e[t].used.push(o),o}function Gu(t,e,i,n,o,r){var s;if("circle"==i.style?((s=Uu("circle",n,o)).setAttributeNS(null,"cx",t),s.setAttributeNS(null,"cy",e),s.setAttributeNS(null,"r",.5*i.size)):((s=Uu("rect",n,o)).setAttributeNS(null,"x",t-.5*i.size),s.setAttributeNS(null,"y",e-.5*i.size),s.setAttributeNS(null,"width",i.size),s.setAttributeNS(null,"height",i.size)),void 0!==i.styles&&s.setAttributeNS(null,"style",i.styles),s.setAttributeNS(null,"class",i.className+" vis-point"),r){var a=Uu("text",n,o);r.xOffset&&(t+=r.xOffset),r.yOffset&&(e+=r.yOffset),r.content&&(a.textContent=r.content),r.className&&a.setAttributeNS(null,"class",r.className+" vis-label"),a.setAttributeNS(null,"x",t),a.setAttributeNS(null,"y",e)}return s}function Zu(t,e,i,n,o,r,s,a){if(0!=n){n<0&&(e-=n*=-1);var l=Uu("rect",r,s);l.setAttributeNS(null,"x",t-.5*i),l.setAttributeNS(null,"y",e),l.setAttributeNS(null,"width",i),l.setAttributeNS(null,"height",n),l.setAttributeNS(null,"class",o),a&&l.setAttributeNS(null,"style",a)}}var $u=function(){function t(e,i,n,o,r,s){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(zt(this,t),this.majorSteps=[1,2,5,10],this.minorSteps=[.25,.5,1,2],this.customLines=null,this.containerHeight=r,this.majorCharHeight=s,this._start=e,this._end=i,this.scale=1,this.minorStepIdx=-1,this.magnitudefactor=1,this.determineScale(),this.zeroAlign=a,this.autoScaleStart=n,this.autoScaleEnd=o,this.formattingFunction=l,n||o){var c=this,h=function(t){var e=t-t%(c.magnitudefactor*c.minorSteps[c.minorStepIdx]);return t%(c.magnitudefactor*c.minorSteps[c.minorStepIdx])>c.magnitudefactor*c.minorSteps[c.minorStepIdx]*.5?e+c.magnitudefactor*c.minorSteps[c.minorStepIdx]:e};n&&(this._start-=2*this.magnitudefactor*this.minorSteps[this.minorStepIdx],this._start=h(this._start)),o&&(this._end+=this.magnitudefactor*this.minorSteps[this.minorStepIdx],this._end=h(this._end)),this.determineScale()}}return jt(t,[{key:"setCharHeight",value:function(t){this.majorCharHeight=t}},{key:"setHeight",value:function(t){this.containerHeight=t}},{key:"determineScale",value:function(){var t=this._end-this._start;this.scale=this.containerHeight/t;var e=this.majorCharHeight/this.scale,i=t>0?Math.round(Math.log(t)/Math.LN10):0;this.minorStepIdx=-1,this.magnitudefactor=Math.pow(10,i);var n=0;i<0&&(n=i);for(var o=!1,r=n;Math.abs(r)<=Math.abs(i);r++){this.magnitudefactor=Math.pow(10,r);for(var s=0;s<this.minorSteps.length;s++)if(this.magnitudefactor*this.minorSteps[s]>=e){o=!0,this.minorStepIdx=s;break}if(!0===o)break}}},{key:"is_major",value:function(t){return t%(this.magnitudefactor*this.majorSteps[this.minorStepIdx])==0}},{key:"getStep",value:function(){return this.magnitudefactor*this.minorSteps[this.minorStepIdx]}},{key:"getFirstMajor",value:function(){var t=this.magnitudefactor*this.majorSteps[this.minorStepIdx];return this.convertValue(this._start+(t-this._start%t)%t)}},{key:"formatValue",value:function(t){var e=t.toPrecision(5);return"function"==typeof this.formattingFunction&&(e=this.formattingFunction(t)),"number"==typeof e?"".concat(e):"string"==typeof e?e:t.toPrecision(5)}},{key:"getLines",value:function(){for(var t=[],e=this.getStep(),i=this._start+(e-this._start%e)%e;this._end-i>1e-5;i+=e)i!=this._start&&t.push({major:this.is_major(i),y:this.convertValue(i),val:this.formatValue(i)});return t}},{key:"followScale",value:function(t){var e=this.minorStepIdx,i=this._start,n=this._end,o=this,r=function(){o.magnitudefactor*=2},s=function(){o.magnitudefactor/=2};t.minorStepIdx<=1&&this.minorStepIdx<=1||t.minorStepIdx>1&&this.minorStepIdx>1||(t.minorStepIdx<this.minorStepIdx?(this.minorStepIdx=1,2==e||r(),r()):(this.minorStepIdx=2,1==e||s(),s()));for(var a=t.convertValue(0),l=t.getStep()*t.scale,c=!1,h=0;!c&&h++<5;){this.scale=l/(this.minorSteps[this.minorStepIdx]*this.magnitudefactor);var d=this.containerHeight/this.scale;this._start=i,this._end=this._start+d;var u=this._end*this.scale,f=this.magnitudefactor*this.majorSteps[this.minorStepIdx],p=this.getFirstMajor()-t.getFirstMajor();if(this.zeroAlign?(this._end+=(a-u)/this.scale,this._start=this._end-d):this.autoScaleStart?(this._start-=p/this.scale,this._end=this._start+d):(this._start+=f-p/this.scale,this._end=this._start+d),!this.autoScaleEnd&&this._end>n+1e-5)s(),c=!1;else{if(!this.autoScaleStart&&this._start<i-1e-5){if(!(this.zeroAlign&&i>=0)){s(),c=!1;continue}console.warn("Can't adhere to given 'min' range, due to zeroalign")}this.autoScaleStart&&this.autoScaleEnd&&d<n-i?(r(),c=!1):c=!0}}}},{key:"convertValue",value:function(t){return this.containerHeight-(t-this._start)*this.scale}},{key:"screenToValue",value:function(t){return(this.containerHeight-t)/this.scale+this._start}}]),t}();function Xu(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var Ku=function(t){Zt(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Rt)return!1;if(Rt.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Rt(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var i,n=_n(t);if(e){var o=_n(this).constructor;i=Rt(n,arguments,o)}else i=n.apply(this,arguments);return yn(this,i)}}(i);function i(t,n,o,r){var s;zt(this,i),(s=e.call(this)).id=Yc(),s.body=t,s.defaultOptions={orientation:"left",showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,icons:!1,majorLinesOffset:7,minorLinesOffset:4,labelOffsetX:10,labelOffsetY:2,iconWidth:20,width:"40px",visible:!0,alignZeros:!0,left:{range:{min:void 0,max:void 0},format:function(t){return"".concat(sh(t.toPrecision(3)))},title:{text:void 0,style:void 0}},right:{range:{min:void 0,max:void 0},format:function(t){return"".concat(sh(t.toPrecision(3)))},title:{text:void 0,style:void 0}}},s.linegraphOptions=r,s.linegraphSVG=o,s.props={},s.DOMelements={lines:{},labels:{},title:{}},s.dom={},s.scale=void 0,s.range={start:0,end:0},s.options=ih.extend({},s.defaultOptions),s.conversionFactor=1,s.setOptions(n),s.width=Number("".concat(s.options.width).replace("px","")),s.minWidth=s.width,s.height=s.linegraphSVG.getBoundingClientRect().height,s.hidden=!1,s.stepPixels=25,s.zeroCrossing=-1,s.amountOfSteps=-1,s.lineOffset=0,s.master=!0,s.masterAxis=null,s.svgElements={},s.iconsRemoved=!1,s.groups={},s.amountOfGroups=0,s._create(),null==s.scale&&s._redrawLabels(),s.framework={svg:s.svg,svgElements:s.svgElements,options:s.options,groups:s.groups};var a=Vt(s);return s.body.emitter.on("verticalDrag",function(){a.dom.lineContainer.style.top="".concat(a.body.domProps.scrollTop,"px")}),s}return jt(i,[{key:"addGroup",value:function(t,e){this.groups.hasOwnProperty(t)||(this.groups[t]=e),this.amountOfGroups+=1}},{key:"updateGroup",value:function(t,e){this.groups.hasOwnProperty(t)||(this.amountOfGroups+=1),this.groups[t]=e}},{key:"removeGroup",value:function(t){this.groups.hasOwnProperty(t)&&(delete this.groups[t],this.amountOfGroups-=1)}},{key:"setOptions",value:function(t){if(t){var e=!1;this.options.orientation!=t.orientation&&void 0!==t.orientation&&(e=!0),ih.selectiveDeepExtend(["orientation","showMinorLabels","showMajorLabels","icons","majorLinesOffset","minorLinesOffset","labelOffsetX","labelOffsetY","iconWidth","width","visible","left","right","alignZeros"],this.options,t),this.minWidth=Number("".concat(this.options.width).replace("px","")),!0===e&&this.dom.frame&&(this.hide(),this.show())}}},{key:"_create",value:function(){this.dom.frame=document.createElement("div"),this.dom.frame.style.width=this.options.width,this.dom.frame.style.height=this.height,this.dom.lineContainer=document.createElement("div"),this.dom.lineContainer.style.width="100%",this.dom.lineContainer.style.height=this.height,this.dom.lineContainer.style.position="relative",this.dom.lineContainer.style.visibility="visible",this.dom.lineContainer.style.display="block",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="absolute",this.svg.style.top="0px",this.svg.style.height="100%",this.svg.style.width="100%",this.svg.style.display="block",this.dom.frame.appendChild(this.svg)}},{key:"_redrawGroupIcons",value:function(){var t;Wu(this.svgElements);var e=this.options.iconWidth,i=11.5;t="left"===this.options.orientation?4:this.width-e-4;var n=go(this.groups);Oh(n).call(n,function(t,e){return t<e?-1:1});var o,r=function(t,e){var i=void 0!==Uo&&Po(t)||t["@@iterator"];if(!i){if(Cn(t)||(i=function(t,e){var i;if(t){if("string"==typeof t)return Xu(t,e);var n=$o(i=Object.prototype.toString.call(t)).call(i,8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Io(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xu(t,e):void 0}}(t))){i&&(t=i);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,a=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){a=!0,r=t},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw r}}}}(n);try{for(r.s();!(o=r.n()).done;){var s=o.value;!0!==this.groups[s].visible||void 0!==this.linegraphOptions.visibility[s]&&!0!==this.linegraphOptions.visibility[s]||(this.groups[s].getLegend(e,15,this.framework,t,i),i+=19)}}catch(t){r.e(t)}finally{r.f()}qu(this.svgElements),this.iconsRemoved=!1}},{key:"_cleanupIcons",value:function(){!1===this.iconsRemoved&&(Wu(this.svgElements),qu(this.svgElements),this.iconsRemoved=!0)}},{key:"show",value:function(){this.hidden=!1,this.dom.frame.parentNode||("left"===this.options.orientation?this.body.dom.left.appendChild(this.dom.frame):this.body.dom.right.appendChild(this.dom.frame)),this.dom.lineContainer.parentNode||this.body.dom.backgroundHorizontal.appendChild(this.dom.lineContainer),this.dom.lineContainer.style.display="block"}},{key:"hide",value:function(){this.hidden=!0,this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame),this.dom.lineContainer.style.display="none"}},{key:"setRange",value:function(t,e){this.range.start=t,this.range.end=e}},{key:"redraw",value:function(){var t=!1,e=0;for(var i in this.dom.lineContainer.style.top="".concat(this.body.domProps.scrollTop,"px"),this.groups)this.groups.hasOwnProperty(i)&&(!0!==this.groups[i].visible||void 0!==this.linegraphOptions.visibility[i]&&!0!==this.linegraphOptions.visibility[i]||e++);if(0===this.amountOfGroups||0===e)this.hide();else{this.show(),this.height=Number(this.linegraphSVG.style.height.replace("px","")),this.dom.lineContainer.style.height="".concat(this.height,"px"),this.width=!0===this.options.visible?Number("".concat(this.options.width).replace("px","")):0;var n=this.props,o=this.dom.frame;o.className="vis-data-axis",this._calculateCharSize();var r=this.options.orientation,s=this.options.showMajorLabels,a=this.body.dom.backgroundHorizontal.offsetWidth;n.minorLabelHeight=this.options.showMinorLabels?n.minorCharHeight:0,n.majorLabelHeight=s?n.majorCharHeight:0,n.minorLineWidth=a-this.lineOffset-this.width+2*this.options.minorLinesOffset,n.minorLineHeight=1,n.majorLineWidth=a-this.lineOffset-this.width+2*this.options.majorLinesOffset,n.majorLineHeight=1,"left"===r?(o.style.top="0",o.style.left="0",o.style.bottom="",o.style.width="".concat(this.width,"px"),o.style.height="".concat(this.height,"px"),this.props.width=this.body.domProps.left.width,this.props.height=this.body.domProps.left.height):(o.style.top="",o.style.bottom="0",o.style.left="0",o.style.width="".concat(this.width,"px"),o.style.height="".concat(this.height,"px"),this.props.width=this.body.domProps.right.width,this.props.height=this.body.domProps.right.height),t=this._redrawLabels(),t=this._isResized()||t,!0===this.options.icons?this._redrawGroupIcons():this._cleanupIcons(),this._redrawTitle(r)}return t}},{key:"_redrawLabels",value:function(){var t=this,e=!1;Wu(this.DOMelements.lines),Wu(this.DOMelements.labels);var i=this.options.orientation,n=null!=this.options[i].range?this.options[i].range:{},o=!0;null!=n.max&&(this.range.end=n.max,o=!1);var r=!0;null!=n.min&&(this.range.start=n.min,r=!1),this.scale=new $u(this.range.start,this.range.end,r,o,this.dom.frame.offsetHeight,this.props.majorCharHeight,this.options.alignZeros,this.options[i].format),!1===this.master&&null!=this.masterAxis?(this.scale.followScale(this.masterAxis.scale),this.dom.lineContainer.style.display="none"):this.dom.lineContainer.style.display="block",this.maxLabelSize=0;var s=this.scale.getLines();Bn(s).call(s,function(e){var n=e.y,o=e.major;t.options.showMinorLabels&&!1===o&&t._redrawLabel(n-2,e.val,i,"vis-y-axis vis-minor",t.props.minorCharHeight),o&&n>=0&&t._redrawLabel(n-2,e.val,i,"vis-y-axis vis-major",t.props.majorCharHeight),!0===t.master&&(o?t._redrawLine(n,i,"vis-grid vis-horizontal vis-major",t.options.majorLinesOffset,t.props.majorLineWidth):t._redrawLine(n,i,"vis-grid vis-horizontal vis-minor",t.options.minorLinesOffset,t.props.minorLineWidth))});var a=0;void 0!==this.options[i].title&&void 0!==this.options[i].title.text&&(a=this.props.titleCharHeight);var l=!0===this.options.icons?Math.max(this.options.iconWidth,a)+this.options.labelOffsetX+15:a+this.options.labelOffsetX+15;return this.maxLabelSize>this.width-l&&!0===this.options.visible?(this.width=this.maxLabelSize+l,this.options.width="".concat(this.width,"px"),qu(this.DOMelements.lines),qu(this.DOMelements.labels),this.redraw(),e=!0):this.maxLabelSize<this.width-l&&!0===this.options.visible&&this.width>this.minWidth?(this.width=Math.max(this.minWidth,this.maxLabelSize+l),this.options.width="".concat(this.width,"px"),qu(this.DOMelements.lines),qu(this.DOMelements.labels),this.redraw(),e=!0):(qu(this.DOMelements.lines),qu(this.DOMelements.labels),e=!1),e}},{key:"convertValue",value:function(t){return this.scale.convertValue(t)}},{key:"screenToValue",value:function(t){return this.scale.screenToValue(t)}},{key:"_redrawLabel",value:function(t,e,i,n,o){var r=Yu("div",this.DOMelements.labels,this.dom.frame);r.className=n,r.innerHTML=ih.xss(e),"left"===i?(r.style.left="-".concat(this.options.labelOffsetX,"px"),r.style.textAlign="right"):(r.style.right="-".concat(this.options.labelOffsetX,"px"),r.style.textAlign="left"),r.style.top="".concat(t-.5*o+this.options.labelOffsetY,"px"),e+="";var s=Math.max(this.props.majorCharWidth,this.props.minorCharWidth);this.maxLabelSize<e.length*s&&(this.maxLabelSize=e.length*s)}},{key:"_redrawLine",value:function(t,e,i,n,o){if(!0===this.master){var r=Yu("div",this.DOMelements.lines,this.dom.lineContainer);r.className=i,r.innerHTML="","left"===e?r.style.left="".concat(this.width-n,"px"):r.style.right="".concat(this.width-n,"px"),r.style.width="".concat(o,"px"),r.style.top="".concat(t,"px")}}},{key:"_redrawTitle",value:function(t){if(Wu(this.DOMelements.title),void 0!==this.options[t].title&&void 0!==this.options[t].title.text){var e=Yu("div",this.DOMelements.title,this.dom.frame);e.className="vis-y-axis vis-title vis-".concat(t),e.innerHTML=ih.xss(this.options[t].title.text),void 0!==this.options[t].title.style&&ih.addCssText(e,this.options[t].title.style),"left"===t?e.style.left="".concat(this.props.titleCharHeight,"px"):e.style.right="".concat(this.props.titleCharHeight,"px"),e.style.width="".concat(this.height,"px")}qu(this.DOMelements.title)}},{key:"_calculateCharSize",value:function(){if(!("minorCharHeight"in this.props)){var t=document.createTextNode("0"),e=document.createElement("div");e.className="vis-y-axis vis-minor vis-measure",e.appendChild(t),this.dom.frame.appendChild(e),this.props.minorCharHeight=e.clientHeight,this.props.minorCharWidth=e.clientWidth,this.dom.frame.removeChild(e)}if(!("majorCharHeight"in this.props)){var i=document.createTextNode("0"),n=document.createElement("div");n.className="vis-y-axis vis-major vis-measure",n.appendChild(i),this.dom.frame.appendChild(n),this.props.majorCharHeight=n.clientHeight,this.props.majorCharWidth=n.clientWidth,this.dom.frame.removeChild(n)}if(!("titleCharHeight"in this.props)){var o=document.createTextNode("0"),r=document.createElement("div");r.className="vis-y-axis vis-title vis-measure",r.appendChild(o),this.dom.frame.appendChild(r),this.props.titleCharHeight=r.clientHeight,this.props.titleCharWidth=r.clientWidth,this.dom.frame.removeChild(r)}}}]),i}(ah);function Qu(t,e){}function Ju(t,e){return{style:(e=void 0===e?{}:e).style||t.options.drawPoints.style,styles:e.styles||t.options.drawPoints.styles,size:e.size||t.options.drawPoints.size,className:e.className||t.className}}function tf(t,e){}function ef(t,e){}function nf(t,e,i,n){this.id=e,this.options=ih.selectiveBridgeObject(["sampling","style","sort","yAxisOrientation","barChart","drawPoints","shaded","interpolation","zIndex","excludeFromStacking","excludeFromLegend"],i),this.usingDefaultStyle=void 0===t.className,this.groupsUsingDefaultStyles=n,this.zeroPosition=0,this.update(t),1==this.usingDefaultStyle&&(this.groupsUsingDefaultStyles[0]+=1),this.itemsData=[],this.visible=void 0===t.visible||t.visible}function of(t,e,i,n){this.body=t,this.defaultOptions={enabled:!1,icons:!0,iconSize:20,iconSpacing:6,left:{visible:!0,position:"top-left"},right:{visible:!0,position:"top-right"}},this.side=i,this.options=ih.extend({},this.defaultOptions),this.linegraphOptions=n,this.svgElements={},this.dom={},this.groups={},this.amountOfGroups=0,this._create(),this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups},this.setOptions(e)}Qu.draw=function(t,e,i,n){n=n||0;for(var o=function(t,e){var i=void 0;return t.options&&t.options.drawPoints&&t.options.drawPoints.onRender&&"function"==typeof t.options.drawPoints.onRender&&(i=t.options.drawPoints.onRender),e.group.options&&e.group.options.drawPoints&&e.group.options.drawPoints.onRender&&"function"==typeof e.group.options.drawPoints.onRender&&(i=e.group.options.drawPoints.onRender),i}(i,e),r=0;r<t.length;r++)if(o){var s=o(t[r],e);!0!==s&&"object"!==vn(s)||Gu(t[r].screen_x+n,t[r].screen_y,Ju(e,s),i.svgElements,i.svg,t[r].label)}else Gu(t[r].screen_x+n,t[r].screen_y,Ju(e),i.svgElements,i.svg,t[r].label)},Qu.drawIcon=function(t,e,i,n,o,r){var s=.5*o,a=Uu("rect",r.svgElements,r.svg);a.setAttributeNS(null,"x",e),a.setAttributeNS(null,"y",i-s),a.setAttributeNS(null,"width",n),a.setAttributeNS(null,"height",2*s),a.setAttributeNS(null,"class","vis-outline"),Gu(e+.5*n,i,Ju(t),r.svgElements,r.svg)},tf.drawIcon=function(t,e,i,n,o,r){var s=.5*o,a=Uu("rect",r.svgElements,r.svg);a.setAttributeNS(null,"x",e),a.setAttributeNS(null,"y",i-s),a.setAttributeNS(null,"width",n),a.setAttributeNS(null,"height",2*s),a.setAttributeNS(null,"class","vis-outline");var l=Math.round(.3*n),c=t.options.barChart.width/l,h=Math.round(.4*o),d=Math.round(.75*o),u=Math.round((n-2*l)/3);if(Zu(e+.5*l+u,i+s-h-1,l,h,t.className+" vis-bar",r.svgElements,r.svg,t.style),Zu(e+1.5*l+u+2,i+s-d-1,l,d,t.className+" vis-bar",r.svgElements,r.svg,t.style),1==t.options.drawPoints.enabled){var f={style:t.options.drawPoints.style,styles:t.options.drawPoints.styles,size:t.options.drawPoints.size/c,className:t.className};Gu(e+.5*l+u,i+s-h-1,f,r.svgElements,r.svg),Gu(e+1.5*l+u+2,i+s-d-1,f,r.svgElements,r.svg)}},tf.draw=function(t,e,i){var n,o,r,s,a,l,c=[],h={},d=0;for(a=0;a<t.length;a++)if("bar"===(s=i.groups[t[a]]).options.style&&!0===s.visible&&(void 0===i.options.groups.visibility[t[a]]||!0===i.options.groups.visibility[t[a]]))for(l=0;l<e[t[a]].length;l++)c.push({screen_x:e[t[a]][l].screen_x,screen_end:e[t[a]][l].screen_end,screen_y:e[t[a]][l].screen_y,x:e[t[a]][l].x,end:e[t[a]][l].end,y:e[t[a]][l].y,groupId:t[a],label:e[t[a]][l].label}),d+=1;if(0!==d)for(Oh(c).call(c,function(t,e){return t.screen_x===e.screen_x?t.groupId<e.groupId?-1:1:t.screen_x-e.screen_x}),tf._getDataIntersections(h,c),a=0;a<c.length;a++){var u=null!=(s=i.groups[c[a].groupId]).options.barChart.minWidth?s.options.barChart.minWidth:.1*s.options.barChart.width,f=0;if(void 0===h[o=c[a].screen_x])a+1<c.length&&(n=Math.abs(c[a+1].screen_x-o)),r=tf._getSafeDrawData(n,s,u);else{var p=a+(h[o].amount-h[o].resolved);p<c.length&&(n=Math.abs(c[p].screen_x-o)),r=tf._getSafeDrawData(n,s,u),h[o].resolved+=1,!0===s.options.stack&&!0!==s.options.excludeFromStacking?c[a].screen_y<s.zeroPosition?(f=h[o].accumulatedNegative,h[o].accumulatedNegative+=s.zeroPosition-c[a].screen_y):(f=h[o].accumulatedPositive,h[o].accumulatedPositive+=s.zeroPosition-c[a].screen_y):!0===s.options.barChart.sideBySide&&(r.width=r.width/h[o].amount,r.offset+=h[o].resolved*r.width-.5*r.width*(h[o].amount+1))}var g=r.width,m=c[a].screen_x;Zu(m+=null!=c[a].screen_end?.5*(g=c[a].screen_end-c[a].screen_x):r.offset,c[a].screen_y-f,g,s.zeroPosition-c[a].screen_y,s.className+" vis-bar",i.svgElements,i.svg,s.style),!0===s.options.drawPoints.enabled&&Qu.draw([{screen_x:c[a].screen_x,screen_y:c[a].screen_y-f,x:c[a].x,y:c[a].y,groupId:c[a].groupId,label:c[a].label}],s,i,r.offset)}},tf._getDataIntersections=function(t,e){for(var i,n=0;n<e.length;n++)n+1<e.length&&(i=Math.abs(e[n+1].screen_x-e[n].screen_x)),n>0&&(i=Math.min(i,Math.abs(e[n-1].screen_x-e[n].screen_x))),0===i&&(void 0===t[e[n].screen_x]&&(t[e[n].screen_x]={amount:0,resolved:0,accumulatedPositive:0,accumulatedNegative:0}),t[e[n].screen_x].amount+=1)},tf._getSafeDrawData=function(t,e,i){var n,o;return t<e.options.barChart.width&&t>0?(n=t<i?i:t,o=0,"left"===e.options.barChart.align?o-=.5*t:"right"===e.options.barChart.align&&(o+=.5*t)):(n=e.options.barChart.width,o=0,"left"===e.options.barChart.align?o-=.5*e.options.barChart.width:"right"===e.options.barChart.align&&(o+=.5*e.options.barChart.width)),{width:n,offset:o}},tf.getStackedYRange=function(t,e,i,n,o){if(t.length>0){Oh(t).call(t,function(t,e){return t.screen_x===e.screen_x?t.groupId<e.groupId?-1:1:t.screen_x-e.screen_x});var r={};tf._getDataIntersections(r,t),e[n]=tf._getStackedYRange(r,t),e[n].yAxisOrientation=o,i.push(n)}},tf._getStackedYRange=function(t,e){for(var i,n=e[0].screen_y,o=e[0].screen_y,r=0;r<e.length;r++)void 0===t[i=e[r].screen_x]?(n=n>e[r].screen_y?e[r].screen_y:n,o=o<e[r].screen_y?e[r].screen_y:o):e[r].screen_y<0?t[i].accumulatedNegative+=e[r].screen_y:t[i].accumulatedPositive+=e[r].screen_y;for(var s in t)t.hasOwnProperty(s)&&(n=(n=n>t[s].accumulatedNegative?t[s].accumulatedNegative:n)>t[s].accumulatedPositive?t[s].accumulatedPositive:n,o=(o=o<t[s].accumulatedNegative?t[s].accumulatedNegative:o)<t[s].accumulatedPositive?t[s].accumulatedPositive:o);return{min:n,max:o}},ef.calcPath=function(t,e){if(null!=t&&t.length>0)return 1==e.options.interpolation.enabled?ef._catmullRom(t,e):ef._linear(t)},ef.drawIcon=function(t,e,i,n,o,r){var s,a,l=.5*o,c=Uu("rect",r.svgElements,r.svg);c.setAttributeNS(null,"x",e),c.setAttributeNS(null,"y",i-l),c.setAttributeNS(null,"width",n),c.setAttributeNS(null,"height",2*l),c.setAttributeNS(null,"class","vis-outline"),(s=Uu("path",r.svgElements,r.svg)).setAttributeNS(null,"class",t.className),void 0!==t.style&&s.setAttributeNS(null,"style",t.style),s.setAttributeNS(null,"d","M"+e+","+i+" L"+(e+n)+","+i),1==t.options.shaded.enabled&&((a=Uu("path",r.svgElements,r.svg)).setAttributeNS(null,"d","top"==t.options.shaded.orientation?"M"+e+", "+(i-l)+"L"+e+","+i+" L"+(e+n)+","+i+" L"+(e+n)+","+(i-l):"M"+e+","+i+" L"+e+","+(i+l)+" L"+(e+n)+","+(i+l)+"L"+(e+n)+","+i),a.setAttributeNS(null,"class",t.className+" vis-icon-fill"),void 0!==t.options.shaded.style&&""!==t.options.shaded.style&&a.setAttributeNS(null,"style",t.options.shaded.style)),1==t.options.drawPoints.enabled&&Gu(e+.5*n,i,{style:t.options.drawPoints.style,styles:t.options.drawPoints.styles,size:t.options.drawPoints.size,className:t.className},r.svgElements,r.svg)},ef.drawShading=function(t,e,i,n){if(1==e.options.shaded.enabled){var o,r,s=Number(n.svg.style.height.replace("px","")),a=Uu("path",n.svgElements,n.svg),l="L";1==e.options.interpolation.enabled&&(l="C"),r="top"==e.options.shaded.orientation?0:"bottom"==e.options.shaded.orientation?s:Math.min(Math.max(0,e.zeroPosition),s),o="group"==e.options.shaded.orientation&&null!=i&&null!=i?"M"+t[0][0]+","+t[0][1]+" "+this.serializePath(t,l,!1)+" L"+i[i.length-1][0]+","+i[i.length-1][1]+" "+this.serializePath(i,l,!0)+i[0][0]+","+i[0][1]+" Z":"M"+t[0][0]+","+t[0][1]+" "+this.serializePath(t,l,!1)+" V"+r+" H"+t[0][0]+" Z",a.setAttributeNS(null,"class",e.className+" vis-fill"),void 0!==e.options.shaded.style&&a.setAttributeNS(null,"style",e.options.shaded.style),a.setAttributeNS(null,"d",o)}},ef.draw=function(t,e,i){if(null!=t&&null!=t){var n=Uu("path",i.svgElements,i.svg);n.setAttributeNS(null,"class",e.className),void 0!==e.style&&n.setAttributeNS(null,"style",e.style);var o="L";1==e.options.interpolation.enabled&&(o="C"),n.setAttributeNS(null,"d","M"+t[0][0]+","+t[0][1]+" "+this.serializePath(t,o,!1))}},ef.serializePath=function(t,e,i){if(t.length<2)return"";var n,o=e;if(i)for(n=t.length-2;n>0;n--)o+=t[n][0]+","+t[n][1]+" ";else for(n=1;n<t.length;n++)o+=t[n][0]+","+t[n][1]+" ";return o},ef._catmullRomUniform=function(t){var e,i,n,o,r,s,a=[];a.push([Math.round(t[0].screen_x),Math.round(t[0].screen_y)]);for(var l=1/6,c=t.length,h=0;h<c-1;h++)s={screen_x:((i=t[h]).screen_x+6*(n=t[h+1]).screen_x-(o=h+2<c?t[h+2]:n).screen_x)*l,screen_y:(i.screen_y+6*n.screen_y-o.screen_y)*l},a.push([(r={screen_x:(6*i.screen_x-(e=0==h?t[0]:t[h-1]).screen_x+n.screen_x)*l,screen_y:(6*i.screen_y-e.screen_y+n.screen_y)*l}).screen_x,r.screen_y]),a.push([s.screen_x,s.screen_y]),a.push([n.screen_x,n.screen_y]);return a},ef._catmullRom=function(t,e){var i=e.options.interpolation.alpha;if(0==i||void 0===i)return this._catmullRomUniform(t);var n,o,r,s,a,l,c,h,d,u,f,p,g,m,v,y,b,w,k,_=[];_.push([Math.round(t[0].screen_x),Math.round(t[0].screen_y)]);for(var x=t.length,C=0;C<x-1;C++)n=0==C?t[0]:t[C-1],o=t[C],r=t[C+1],s=C+2<x?t[C+2]:r,c=Math.sqrt(Math.pow(n.screen_x-o.screen_x,2)+Math.pow(n.screen_y-o.screen_y,2)),h=Math.sqrt(Math.pow(o.screen_x-r.screen_x,2)+Math.pow(o.screen_y-r.screen_y,2)),d=Math.sqrt(Math.pow(r.screen_x-s.screen_x,2)+Math.pow(r.screen_y-s.screen_y,2)),m=Math.pow(d,i),y=Math.pow(d,2*i),v=Math.pow(h,i),b=Math.pow(h,2*i),k=Math.pow(c,i),u=2*(w=Math.pow(c,2*i))+3*k*v+b,(p=3*k*(k+v))>0&&(p=1/p),(g=3*m*(m+v))>0&&(g=1/g),0==(a={screen_x:(-b*n.screen_x+u*o.screen_x+w*r.screen_x)*p,screen_y:(-b*n.screen_y+u*o.screen_y+w*r.screen_y)*p}).screen_x&&0==a.screen_y&&(a=o),0==(l={screen_x:(y*o.screen_x+(f=2*y+3*m*v+b)*r.screen_x-b*s.screen_x)*g,screen_y:(y*o.screen_y+f*r.screen_y-b*s.screen_y)*g}).screen_x&&0==l.screen_y&&(l=r),_.push([a.screen_x,a.screen_y]),_.push([l.screen_x,l.screen_y]),_.push([r.screen_x,r.screen_y]);return _},ef._linear=function(t){for(var e=[],i=0;i<t.length;i++)e.push([t[i].screen_x,t[i].screen_y]);return e},nf.prototype.setItems=function(t){null!=t?(this.itemsData=t,1==Oh(this.options)&&ih.insertSort(this.itemsData,function(t,e){return t.x>e.x?1:-1})):this.itemsData=[]},nf.prototype.getItems=function(){return this.itemsData},nf.prototype.setZeroPosition=function(t){this.zeroPosition=t},nf.prototype.setOptions=function(t){void 0!==t&&(ih.selectiveDeepExtend(["sampling","style","sort","yAxisOrientation","barChart","zIndex","excludeFromStacking","excludeFromLegend"],this.options,t),"function"==typeof t.drawPoints&&(t.drawPoints={onRender:t.drawPoints}),ih.mergeOptions(this.options,t,"interpolation"),ih.mergeOptions(this.options,t,"drawPoints"),ih.mergeOptions(this.options,t,"shaded"),t.interpolation&&"object"==vn(t.interpolation)&&t.interpolation.parametrization&&("uniform"==t.interpolation.parametrization?this.options.interpolation.alpha=0:"chordal"==t.interpolation.parametrization?this.options.interpolation.alpha=1:(this.options.interpolation.parametrization="centripetal",this.options.interpolation.alpha=.5)))},nf.prototype.update=function(t){this.group=t,this.content=t.content||"graph",this.className=t.className||this.className||"vis-graph-group"+this.groupsUsingDefaultStyles[0]%10,this.visible=void 0===t.visible||t.visible,this.style=t.style,this.setOptions(t.options)},nf.prototype.getLegend=function(t,e,i,n,o){switch(null!=i&&null!=i||(i={svg:document.createElementNS("http://www.w3.org/2000/svg","svg"),svgElements:{},options:this.options,groups:[this]}),null!=n&&null!=n||(n=0),null!=o&&null!=o||(o=.5*e),this.options.style){case"line":ef.drawIcon(this,n,o,t,e,i);break;case"points":case"point":Qu.drawIcon(this,n,o,t,e,i);break;case"bar":tf.drawIcon(this,n,o,t,e,i)}return{icon:i.svg,label:this.content,orientation:this.options.yAxisOrientation}},nf.prototype.getYRange=function(t){for(var e=t[0].y,i=t[0].y,n=0;n<t.length;n++)e=e>t[n].y?t[n].y:e,i=i<t[n].y?t[n].y:i;return{min:e,max:i,yAxisOrientation:this.options.yAxisOrientation}},(of.prototype=new ah).clear=function(){this.groups={},this.amountOfGroups=0},of.prototype.addGroup=function(t,e){1!=e.options.excludeFromLegend&&(this.groups.hasOwnProperty(t)||(this.groups[t]=e),this.amountOfGroups+=1)},of.prototype.updateGroup=function(t,e){this.groups[t]=e},of.prototype.removeGroup=function(t){this.groups.hasOwnProperty(t)&&(delete this.groups[t],this.amountOfGroups-=1)},of.prototype._create=function(){this.dom.frame=document.createElement("div"),this.dom.frame.className="vis-legend",this.dom.frame.style.position="absolute",this.dom.frame.style.top="10px",this.dom.frame.style.display="block",this.dom.textArea=document.createElement("div"),this.dom.textArea.className="vis-legend-text",this.dom.textArea.style.position="relative",this.dom.textArea.style.top="0px",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="absolute",this.svg.style.top="0px",this.svg.style.width=this.options.iconSize+5+"px",this.svg.style.height="100%",this.dom.frame.appendChild(this.svg),this.dom.frame.appendChild(this.dom.textArea)},of.prototype.hide=function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame)},of.prototype.show=function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame)},of.prototype.setOptions=function(t){ih.selectiveDeepExtend(["enabled","orientation","icons","left","right"],this.options,t)},of.prototype.redraw=function(){var t=0,e=go(this.groups);Oh(e).call(e,function(t,e){return t<e?-1:1});for(var i=0;i<e.length;i++){var n=e[i];1!=this.groups[n].visible||void 0!==this.linegraphOptions.visibility[n]&&1!=this.linegraphOptions.visibility[n]||t++}if(0==this.options[this.side].visible||0==this.amountOfGroups||0==this.options.enabled||0==t)this.hide();else{this.show(),"top-left"==this.options[this.side].position||"bottom-left"==this.options[this.side].position?(this.dom.frame.style.left="4px",this.dom.frame.style.textAlign="left",this.dom.textArea.style.textAlign="left",this.dom.textArea.style.left=this.options.iconSize+15+"px",this.dom.textArea.style.right="",this.svg.style.left="0px",this.svg.style.right=""):(this.dom.frame.style.right="4px",this.dom.frame.style.textAlign="right",this.dom.textArea.style.textAlign="right",this.dom.textArea.style.right=this.options.iconSize+15+"px",this.dom.textArea.style.left="",this.svg.style.right="0px",this.svg.style.left=""),"top-left"==this.options[this.side].position||"top-right"==this.options[this.side].position?(this.dom.frame.style.top=4-Number(this.body.dom.center.style.top.replace("px",""))+"px",this.dom.frame.style.bottom=""):(this.dom.frame.style.bottom=this.body.domProps.center.height-this.body.domProps.centerContainer.height+4+Number(this.body.dom.center.style.top.replace("px",""))+"px",this.dom.frame.style.top=""),0==this.options.icons?(this.dom.frame.style.width=this.dom.textArea.offsetWidth+10+"px",this.dom.textArea.style.right="",this.dom.textArea.style.left="",this.svg.style.width="0px"):(this.dom.frame.style.width=this.options.iconSize+15+this.dom.textArea.offsetWidth+10+"px",this.drawLegendIcons());var o="";for(i=0;i<e.length;i++)1!=this.groups[n=e[i]].visible||void 0!==this.linegraphOptions.visibility[n]&&1!=this.linegraphOptions.visibility[n]||(o+=this.groups[n].content+"<br />");this.dom.textArea.innerHTML=ih.xss(o),this.dom.textArea.style.lineHeight=.75*this.options.iconSize+this.options.iconSpacing+"px"}},of.prototype.drawLegendIcons=function(){if(this.dom.frame.parentNode){var t=go(this.groups);Oh(t).call(t,function(t,e){return t<e?-1:1}),Wu(c=this.svgElements),qu(c),Wu(c);var e=window.getComputedStyle(this.dom.frame).paddingTop,i=Number(e.replace("px","")),n=i,o=this.options.iconSize,r=.75*this.options.iconSize,s=i+.5*r+3;this.svg.style.width=o+5+i+"px";for(var a=0;a<t.length;a++){var l=t[a];1!=this.groups[l].visible||void 0!==this.linegraphOptions.visibility[l]&&1!=this.linegraphOptions.visibility[l]||(this.groups[l].getLegend(o,r,this.framework,n,s),s+=r+this.options.iconSpacing)}}var c};var rf="__ungrouped__";function sf(t,e){this.id=Yc(),this.body=t,this.defaultOptions={yAxisOrientation:"left",defaultGroup:"default",sort:!0,sampling:!0,stack:!1,graphHeight:"400px",shaded:{enabled:!1,orientation:"bottom"},style:"line",barChart:{width:50,sideBySide:!1,align:"center"},interpolation:{enabled:!0,parametrization:"centripetal",alpha:.5},drawPoints:{enabled:!0,size:6,style:"square"},dataAxis:{},legend:{},groups:{visibility:{}}},this.options=ih.extend({},this.defaultOptions),this.dom={},this.props={},this.hammer=null,this.groups={},this.abortedGraphUpdate=!1,this.updateSVGheight=!1,this.updateSVGheightOnResize=!1,this.forceGraphUpdate=!0;var i=this;this.itemsData=null,this.groupsData=null,this.itemListeners={add:function(t,e,n){i._onAdd(e.items)},update:function(t,e,n){i._onUpdate(e.items)},remove:function(t,e,n){i._onRemove(e.items)}},this.groupListeners={add:function(t,e,n){i._onAddGroups(e.items)},update:function(t,e,n){i._onUpdateGroups(e.items)},remove:function(t,e,n){i._onRemoveGroups(e.items)}},this.items={},this.selection=[],this.lastStart=this.body.range.start,this.touchParams={},this.svgElements={},this.setOptions(e),this.groupsUsingDefaultStyles=[0],this.body.emitter.on("rangechanged",function(){i.svg.style.left=ih.option.asSize(-i.props.width),i.forceGraphUpdate=!0,i.redraw.call(i)}),this._create(),this.framework={svg:this.svg,svgElements:this.svgElements,options:this.options,groups:this.groups}}(sf.prototype=new ah)._create=function(){var t=document.createElement("div");t.className="vis-line-graph",this.dom.frame=t,this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.style.position="relative",this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px",this.svg.style.display="block",t.appendChild(this.svg),this.options.dataAxis.orientation="left",this.yAxisLeft=new Ku(this.body,this.options.dataAxis,this.svg,this.options.groups),this.options.dataAxis.orientation="right",this.yAxisRight=new Ku(this.body,this.options.dataAxis,this.svg,this.options.groups),delete this.options.dataAxis.orientation,this.legendLeft=new of(this.body,this.options.legend,"left",this.options.groups),this.legendRight=new of(this.body,this.options.legend,"right",this.options.groups),this.show()},sf.prototype.setOptions=function(t){t&&(void 0===t.graphHeight&&void 0!==t.height?(this.updateSVGheight=!0,this.updateSVGheightOnResize=!0):void 0!==this.body.domProps.centerContainer.height&&void 0!==t.graphHeight&&Lr((t.graphHeight+"").replace("px",""))<this.body.domProps.centerContainer.height&&(this.updateSVGheight=!0),ih.selectiveDeepExtend(["sampling","defaultGroup","stack","height","graphHeight","yAxisOrientation","style","barChart","dataAxis","sort","groups"],this.options,t),ih.mergeOptions(this.options,t,"interpolation"),ih.mergeOptions(this.options,t,"drawPoints"),ih.mergeOptions(this.options,t,"shaded"),ih.mergeOptions(this.options,t,"legend"),t.interpolation&&"object"==vn(t.interpolation)&&t.interpolation.parametrization&&("uniform"==t.interpolation.parametrization?this.options.interpolation.alpha=0:"chordal"==t.interpolation.parametrization?this.options.interpolation.alpha=1:(this.options.interpolation.parametrization="centripetal",this.options.interpolation.alpha=.5)),this.yAxisLeft&&void 0!==t.dataAxis&&(this.yAxisLeft.setOptions(this.options.dataAxis),this.yAxisRight.setOptions(this.options.dataAxis)),this.legendLeft&&void 0!==t.legend&&(this.legendLeft.setOptions(this.options.legend),this.legendRight.setOptions(this.options.legend)),this.groups.hasOwnProperty(rf)&&this.groups[rf].setOptions(t)),this.dom.frame&&(this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0}))},sf.prototype.hide=function(){this.dom.frame.parentNode&&this.dom.frame.parentNode.removeChild(this.dom.frame)},sf.prototype.show=function(){this.dom.frame.parentNode||this.body.dom.center.appendChild(this.dom.frame)},sf.prototype.setItems=function(t){var e,n=this,o=this.itemsData;if(t){if(!i.isDataViewLike("id",t))throw new TypeError("Data must implement the interface of DataSet or DataView");this.itemsData=Qc(t)}else this.itemsData=null;if(o&&(Bn(ih).call(ih,this.itemListeners,function(t,e){o.off(e,t)}),o.dispose(),e=o.getIds(),this._onRemove(e)),this.itemsData){var r=this.id;Bn(ih).call(ih,this.itemListeners,function(t,e){n.itemsData.on(e,t,r)}),e=this.itemsData.getIds(),this._onAdd(e)}},sf.prototype.setGroups=function(t){var e,n=this;if(this.groupsData){Bn(ih).call(ih,this.groupListeners,function(t,e){n.groupsData.off(e,t)}),e=this.groupsData.getIds(),this.groupsData=null;for(var o=0;o<e.length;o++)this._removeGroup(e[o])}if(t){if(!i.isDataViewLike("id",t))throw new TypeError("Data must implement the interface of DataSet or DataView");this.groupsData=t}else this.groupsData=null;if(this.groupsData){var r=this.id;Bn(ih).call(ih,this.groupListeners,function(t,e){n.groupsData.on(e,t,r)}),e=this.groupsData.getIds(),this._onAddGroups(e)}},sf.prototype._onUpdate=function(t){this._updateAllGroupData(t)},sf.prototype._onAdd=function(t){this._onUpdate(t)},sf.prototype._onRemove=function(t){this._onUpdate(t)},sf.prototype._onUpdateGroups=function(t){this._updateAllGroupData(null,t)},sf.prototype._onAddGroups=function(t){this._onUpdateGroups(t)},sf.prototype._onRemoveGroups=function(t){for(var e=0;e<t.length;e++)this._removeGroup(t[e]);this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0})},sf.prototype._removeGroup=function(t){this.groups.hasOwnProperty(t)&&("right"==this.groups[t].options.yAxisOrientation?(this.yAxisRight.removeGroup(t),this.legendRight.removeGroup(t),this.legendRight.redraw()):(this.yAxisLeft.removeGroup(t),this.legendLeft.removeGroup(t),this.legendLeft.redraw()),delete this.groups[t])},sf.prototype._updateGroup=function(t,e){this.groups.hasOwnProperty(e)?(this.groups[e].update(t),"right"==this.groups[e].options.yAxisOrientation?(this.yAxisRight.updateGroup(e,this.groups[e]),this.legendRight.updateGroup(e,this.groups[e]),this.yAxisLeft.removeGroup(e),this.legendLeft.removeGroup(e)):(this.yAxisLeft.updateGroup(e,this.groups[e]),this.legendLeft.updateGroup(e,this.groups[e]),this.yAxisRight.removeGroup(e),this.legendRight.removeGroup(e))):(this.groups[e]=new nf(t,e,this.options,this.groupsUsingDefaultStyles),"right"==this.groups[e].options.yAxisOrientation?(this.yAxisRight.addGroup(e,this.groups[e]),this.legendRight.addGroup(e,this.groups[e])):(this.yAxisLeft.addGroup(e,this.groups[e]),this.legendLeft.addGroup(e,this.groups[e]))),this.legendLeft.redraw(),this.legendRight.redraw()},sf.prototype._updateAllGroupData=function(t,e){if(null!=this.itemsData){var i={},n=this.itemsData.get(),o=this.itemsData.idProp,r={};t&&oo(t).call(t,function(t){r[t]=t});for(var s={},a=0;a<n.length;a++){var l=n[a],c=l.group;null==c&&(c=rf),s.hasOwnProperty(c)?s[c]++:s[c]=1}var h={};if(!e&&t)for(c in this.groups)if(this.groups.hasOwnProperty(c)){var d=(g=this.groups[c]).getItems();i[c]=Yn(d).call(d,function(t){return h[t[o]]=t[o],t[o]!==r[t[o]]});var u=s[c];s[c]-=i[c].length,i[c].length<u&&(i[c][u-1]={})}for(a=0;a<n.length;a++)if(null==(c=(l=n[a]).group)&&(c=rf),e||!t||l[o]===r[l[o]]||!h.hasOwnProperty(l[o])){i.hasOwnProperty(c)||(i[c]=new Array(s[c]));var f=ih.bridgeObject(l);f.x=ih.convert(l.x,"Date"),f.end=ih.convert(l.end,"Date"),f.orginalY=l.y,f.y=Number(l.y),f[o]=l[o];var p=i[c].length-s[c]--;i[c][p]=f}for(c in this.groups)this.groups.hasOwnProperty(c)&&(i.hasOwnProperty(c)||(i[c]=new Array(0)));for(c in i)if(i.hasOwnProperty(c))if(0==i[c].length)this.groups.hasOwnProperty(c)&&this._removeGroup(c);else{var g=void 0;null!=this.groupsData&&(g=this.groupsData.get(c)),null==g&&(g={id:c,content:this.options.defaultGroup+c}),this._updateGroup(g,c),this.groups[c].setItems(i[c])}this.forceGraphUpdate=!0,this.body.emitter.emit("_change",{queue:!0})}},sf.prototype.redraw=function(){var t=!1;this.props.width=this.dom.frame.offsetWidth,this.props.height=this.body.domProps.centerContainer.height-this.body.domProps.border.top-this.body.domProps.border.bottom,t=this._isResized()||t;var e,i=this.body.range.end-this.body.range.start,n=i!=this.lastVisibleInterval;return this.lastVisibleInterval=i,1==t&&(this.svg.style.width=ih.option.asSize(3*this.props.width),this.svg.style.left=ih.option.asSize(-this.props.width),-1==Yr(e=this.options.height+"").call(e,"%")&&1!=this.updateSVGheightOnResize||(this.updateSVGheight=!0)),1==this.updateSVGheight?(this.options.graphHeight!=this.props.height+"px"&&(this.options.graphHeight=this.props.height+"px",this.svg.style.height=this.props.height+"px"),this.updateSVGheight=!1):this.svg.style.height=(""+this.options.graphHeight).replace("px","")+"px",1==t||1==n||1==this.abortedGraphUpdate||1==this.forceGraphUpdate?(t=this._updateGraph()||t,this.forceGraphUpdate=!1,this.lastStart=this.body.range.start,this.svg.style.left=-this.props.width+"px"):0!=this.lastStart&&0!=this.props.width&&(this.svg.style.left=-this.props.width-this.props.width/(this.body.range.end-this.body.range.start)*(this.body.range.start-this.lastStart)+"px"),this.legendLeft.redraw(),this.legendRight.redraw(),t},sf.prototype._getSortedGroupIds=function(){var t=[];for(var e in this.groups)if(this.groups.hasOwnProperty(e)){var i=this.groups[e];1!=i.visible||void 0!==this.options.groups.visibility[e]&&1!=this.options.groups.visibility[e]||t.push({id:e,zIndex:i.options.zIndex})}ih.insertSort(t,function(t,e){var i=t.zIndex,n=e.zIndex;return void 0===i&&(i=0),void 0===n&&(n=0),i==n?0:i<n?-1:1});for(var n=new Array(t.length),o=0;o<t.length;o++)n[o]=t[o].id;return n},sf.prototype._updateGraph=function(){if(Wu(this.svgElements),0!=this.props.width&&null!=this.itemsData){var t,e,i={},n=this.body.util.toGlobalTime(-this.body.domProps.root.width),o=this.body.util.toGlobalTime(2*this.body.domProps.root.width),r=this._getSortedGroupIds();if(r.length>0){var s={};for(this._getRelevantData(r,s,n,o),this._applySampling(r,s),e=0;e<r.length;e++)this._convertXcoordinates(s[r[e]]);if(this._getYRanges(r,s,i),1==this._updateYAxis(r,i))return qu(this.svgElements),this.abortedGraphUpdate=!0,!0;this.abortedGraphUpdate=!1;var a=void 0;for(e=0;e<r.length;e++)t=this.groups[r[e]],!0===this.options.stack&&"line"===this.options.style&&(null!=t.options.excludeFromStacking&&t.options.excludeFromStacking||(null!=a&&(this._stack(s[t.id],s[a.id]),1==t.options.shaded.enabled&&"group"!==t.options.shaded.orientation&&("top"==t.options.shaded.orientation&&"group"!==a.options.shaded.orientation?(a.options.shaded.orientation="group",a.options.shaded.groupId=t.id):(t.options.shaded.orientation="group",t.options.shaded.groupId=a.id))),a=t)),this._convertYcoordinates(s[r[e]],t);var l={};for(e=0;e<r.length;e++)if("line"===(t=this.groups[r[e]]).options.style&&1==t.options.shaded.enabled){var c=s[r[e]];if(null==c||0==c.length)continue;if(l.hasOwnProperty(r[e])||(l[r[e]]=ef.calcPath(c,t)),"group"===t.options.shaded.orientation){var h=t.options.shaded.groupId;if(-1===Yr(r).call(r,h)){console.log(t.id+": Unknown shading group target given:"+h);continue}l.hasOwnProperty(h)||(l[h]=ef.calcPath(s[h],this.groups[h])),ef.drawShading(l[r[e]],t,l[h],this.framework)}else ef.drawShading(l[r[e]],t,void 0,this.framework)}for(tf.draw(r,s,this.framework),e=0;e<r.length;e++)if(t=this.groups[r[e]],s[r[e]].length>0)switch(t.options.style){case"line":l.hasOwnProperty(r[e])||(l[r[e]]=ef.calcPath(s[r[e]],t)),ef.draw(l[r[e]],t,this.framework);case"point":case"points":"point"!=t.options.style&&"points"!=t.options.style&&1!=t.options.drawPoints.enabled||Qu.draw(s[r[e]],t,this.framework)}}}return qu(this.svgElements),!1},sf.prototype._stack=function(t,e){var i,n,o,r;i=0;for(var s=0;s<t.length;s++){o=void 0,r=void 0;for(var a=i;a<e.length;a++){if(e[a].x===t[s].x){o=e[a],r=e[a],i=a;break}if(e[a].x>t[s].x){r=e[a],o=0==a?r:e[a-1],i=a;break}}void 0===r&&(o=e[e.length-1],r=e[e.length-1]),t[s].y=0==(n=r.x-o.x)?t[s].orginalY+r.y:t[s].orginalY+(r.y-o.y)/n*(t[s].x-o.x)+o.y}},sf.prototype._getRelevantData=function(t,e,i,n){var o,r,s;if(t.length>0)for(r=0;r<t.length;r++){var a=(o=this.groups[t[r]]).getItems();if(1==Oh(o.options)){var l=function(t,e){return t.getTime()==e.getTime()?0:t<e?-1:1},c=Math.max(0,ih.binarySearchValue(a,i,"x","before",l)),h=Math.min(a.length,ih.binarySearchValue(a,n,"x","after",l)+1);h<=0&&(h=a.length);var d=new Array(h-c);for(s=c;s<h;s++)d[s-c]=o.itemsData[s];e[t[r]]=d}else e[t[r]]=o.itemsData}},sf.prototype._applySampling=function(t,e){if(t.length>0)for(var i=0;i<t.length;i++)if(1==this.groups[t[i]].options.sampling){var n=e[t[i]];if(n.length>0){var o,r=n.length,s=r/(this.body.util.toGlobalScreen(n[n.length-1].x)-this.body.util.toGlobalScreen(n[0].x));o=Math.min(Math.ceil(.2*r),Math.max(1,Math.round(s)));for(var a=new Array(r),l=0;l<r;l+=o)a[Math.round(l/o)]=n[l];e[t[i]]=cr(a).call(a,0,Math.round(r/o))}}},sf.prototype._getYRanges=function(t,e,i){var n,o,r,s,a=[],l=[];if(t.length>0){for(r=0;r<t.length;r++)s=this.groups[t[r]].options,(n=e[t[r]]).length>0&&(o=this.groups[t[r]],!0===s.stack&&"bar"===s.style?"left"===s.yAxisOrientation?a=Zo(a).call(a,n):l=Zo(l).call(l,n):i[t[r]]=o.getYRange(n,t[r]));tf.getStackedYRange(a,i,t,"__barStackLeft","left"),tf.getStackedYRange(l,i,t,"__barStackRight","right")}},sf.prototype._updateYAxis=function(t,e){var i,n,o=!1,r=!1,s=!1,a=1e9,l=1e9,c=-1e9,h=-1e9;if(t.length>0){for(var d=0;d<t.length;d++){var u=this.groups[t[d]];u&&"right"!=u.options.yAxisOrientation?(r=!0,a=1e9,c=-1e9):u&&u.options.yAxisOrientation&&(s=!0,l=1e9,h=-1e9)}for(d=0;d<t.length;d++)e.hasOwnProperty(t[d])&&!0!==e[t[d]].ignore&&(i=e[t[d]].min,n=e[t[d]].max,"right"!=e[t[d]].yAxisOrientation?(r=!0,a=a>i?i:a,c=c<n?n:c):(s=!0,l=l>i?i:l,h=h<n?n:h));1==r&&this.yAxisLeft.setRange(a,c),1==s&&this.yAxisRight.setRange(l,h)}o=this._toggleAxisVisiblity(r,this.yAxisLeft)||o,o=this._toggleAxisVisiblity(s,this.yAxisRight)||o,1==s&&1==r?(this.yAxisLeft.drawIcons=!0,this.yAxisRight.drawIcons=!0):(this.yAxisLeft.drawIcons=!1,this.yAxisRight.drawIcons=!1),this.yAxisRight.master=!r,this.yAxisRight.masterAxis=this.yAxisLeft,0==this.yAxisRight.master?(this.yAxisLeft.lineOffset=1==s?this.yAxisRight.width:0,o=this.yAxisLeft.redraw()||o,o=this.yAxisRight.redraw()||o):o=this.yAxisRight.redraw()||o;var f=["__barStackLeft","__barStackRight","__lineStackLeft","__lineStackRight"];for(d=0;d<f.length;d++)-1!=Yr(t).call(t,f[d])&&cr(t).call(t,Yr(t).call(t,f[d]),1);return o},sf.prototype._toggleAxisVisiblity=function(t,e){var i=!1;return 0==t?e.dom.frame.parentNode&&0==e.hidden&&(e.hide(),i=!0):e.dom.frame.parentNode||1!=e.hidden||(e.show(),i=!0),i},sf.prototype._convertXcoordinates=function(t){for(var e=this.body.util.toScreen,i=0;i<t.length;i++)t[i].screen_x=e(t[i].x)+this.props.width,t[i].screen_y=t[i].y,t[i].screen_end=null!=t[i].end?e(t[i].end)+this.props.width:void 0},sf.prototype._convertYcoordinates=function(t,e){var i=this.yAxisLeft,n=Number(this.svg.style.height.replace("px",""));"right"==e.options.yAxisOrientation&&(i=this.yAxisRight);for(var o=0;o<t.length;o++)t[o].screen_y=Math.round(i.convertValue(t[o].y));e.setZeroPosition(Math.min(n,i.convertValue(0)))};var af="string",lf="boolean",cf="number",hf="date",df="object",uf="moment",ff={configure:{enabled:{boolean:lf},filter:{boolean:lf,function:"function"},container:{dom:"dom"},__type__:{object:df,boolean:lf,function:"function"}},alignCurrentTime:{string:af,undefined:"undefined"},yAxisOrientation:{string:["left","right"]},defaultGroup:{string:af},sort:{boolean:lf},sampling:{boolean:lf},stack:{boolean:lf},graphHeight:{string:af,number:cf},shaded:{enabled:{boolean:lf},orientation:{string:["bottom","top","zero","group"]},groupId:{object:df},__type__:{boolean:lf,object:df}},style:{string:["line","bar","points"]},barChart:{width:{number:cf},minWidth:{number:cf},sideBySide:{boolean:lf},align:{string:["left","center","right"]},__type__:{object:df}},interpolation:{enabled:{boolean:lf},parametrization:{string:["centripetal","chordal","uniform"]},alpha:{number:cf},__type__:{object:df,boolean:lf}},drawPoints:{enabled:{boolean:lf},onRender:{function:"function"},size:{number:cf},style:{string:["square","circle"]},__type__:{object:df,boolean:lf,function:"function"}},dataAxis:{showMinorLabels:{boolean:lf},showMajorLabels:{boolean:lf},showWeekScale:{boolean:lf},icons:{boolean:lf},width:{string:af,number:cf},visible:{boolean:lf},alignZeros:{boolean:lf},left:{range:{min:{number:cf,undefined:"undefined"},max:{number:cf,undefined:"undefined"},__type__:{object:df}},format:{function:"function"},title:{text:{string:af,number:cf,undefined:"undefined"},style:{string:af,undefined:"undefined"},__type__:{object:df}},__type__:{object:df}},right:{range:{min:{number:cf,undefined:"undefined"},max:{number:cf,undefined:"undefined"},__type__:{object:df}},format:{function:"function"},title:{text:{string:af,number:cf,undefined:"undefined"},style:{string:af,undefined:"undefined"},__type__:{object:df}},__type__:{object:df}},__type__:{object:df}},legend:{enabled:{boolean:lf},icons:{boolean:lf},left:{visible:{boolean:lf},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:df}},right:{visible:{boolean:lf},position:{string:["top-right","bottom-right","top-left","bottom-left"]},__type__:{object:df}},__type__:{object:df,boolean:lf}},groups:{visibility:{any:"any"},__type__:{object:df}},autoResize:{boolean:lf},throttleRedraw:{number:cf},clickToUse:{boolean:lf},end:{number:cf,date:hf,string:af,moment:uf},format:{minorLabels:{millisecond:{string:af,undefined:"undefined"},second:{string:af,undefined:"undefined"},minute:{string:af,undefined:"undefined"},hour:{string:af,undefined:"undefined"},weekday:{string:af,undefined:"undefined"},day:{string:af,undefined:"undefined"},week:{string:af,undefined:"undefined"},month:{string:af,undefined:"undefined"},quarter:{string:af,undefined:"undefined"},year:{string:af,undefined:"undefined"},__type__:{object:df}},majorLabels:{millisecond:{string:af,undefined:"undefined"},second:{string:af,undefined:"undefined"},minute:{string:af,undefined:"undefined"},hour:{string:af,undefined:"undefined"},weekday:{string:af,undefined:"undefined"},day:{string:af,undefined:"undefined"},week:{string:af,undefined:"undefined"},month:{string:af,undefined:"undefined"},quarter:{string:af,undefined:"undefined"},year:{string:af,undefined:"undefined"},__type__:{object:df}},__type__:{object:df}},moment:{function:"function"},height:{string:af,number:cf},hiddenDates:{start:{date:hf,number:cf,string:af,moment:uf},end:{date:hf,number:cf,string:af,moment:uf},repeat:{string:af},__type__:{object:df,array:"array"}},locale:{string:af},locales:{__any__:{any:"any"},__type__:{object:df}},max:{date:hf,number:cf,string:af,moment:uf},maxHeight:{number:cf,string:af},maxMinorChars:{number:cf},min:{date:hf,number:cf,string:af,moment:uf},minHeight:{number:cf,string:af},moveable:{boolean:lf},multiselect:{boolean:lf},orientation:{string:af},showCurrentTime:{boolean:lf},showMajorLabels:{boolean:lf},showMinorLabels:{boolean:lf},showWeekScale:{boolean:lf},snap:{function:"function",null:"null"},start:{date:hf,number:cf,string:af,moment:uf},timeAxis:{scale:{string:af,undefined:"undefined"},step:{number:cf,undefined:"undefined"},__type__:{object:df}},width:{string:af,number:cf},zoomable:{boolean:lf},zoomKey:{string:["ctrlKey","altKey","metaKey",""]},zoomMax:{number:cf},zoomMin:{number:cf},zIndex:{number:cf},__type__:{object:df}},pf={global:{alignCurrentTime:["none","year","month","quarter","week","isoWeek","day","date","hour","minute","second"],sort:!0,sampling:!0,stack:!1,shaded:{enabled:!1,orientation:["zero","top","bottom","group"]},style:["line","bar","points"],barChart:{width:[50,5,100,5],minWidth:[50,5,100,5],sideBySide:!1,align:["left","center","right"]},interpolation:{enabled:!0,parametrization:["centripetal","chordal","uniform"]},drawPoints:{enabled:!0,size:[6,2,30,1],style:["square","circle"]},dataAxis:{showMinorLabels:!0,showMajorLabels:!0,showWeekScale:!1,icons:!1,width:[40,0,200,1],visible:!0,alignZeros:!0,left:{title:{text:"",style:""}},right:{title:{text:"",style:""}}},legend:{enabled:!1,icons:!0,left:{visible:!0,position:["top-right","bottom-right","top-left","bottom-left"]},right:{visible:!0,position:["top-right","bottom-right","top-left","bottom-left"]}},autoResize:!0,clickToUse:!1,end:"",format:{minorLabels:{millisecond:"SSS",second:"s",minute:"HH:mm",hour:"HH:mm",weekday:"ddd D",day:"D",week:"w",month:"MMM",quarter:"[Q]Q",year:"YYYY"},majorLabels:{millisecond:"HH:mm:ss",second:"D MMMM HH:mm",minute:"ddd D MMMM",hour:"ddd D MMMM",weekday:"MMMM YYYY",day:"MMMM YYYY",week:"MMMM YYYY",month:"YYYY",quarter:"YYYY",year:""}},height:"",locale:"",max:"",maxHeight:"",maxMinorChars:[7,0,20,1],min:"",minHeight:"",moveable:!0,orientation:["both","bottom","top"],showCurrentTime:!1,showMajorLabels:!0,showMinorLabels:!0,showWeekScale:!1,start:"",width:"100%",zoomable:!0,zoomKey:["ctrlKey","altKey","metaKey",""],zoomMax:[31536e10,10,31536e10,1],zoomMin:[10,10,31536e10,1],zIndex:0}};function gf(t,e,n,o){var r,s,a,l,c,h,d;if(!Cn(n)&&!i.isDataViewLike("id",n)&&n instanceof Object){var u=o;o=n,n=u}o&&o.throttleRedraw&&console.warn('Graph2d option "throttleRedraw" is DEPRICATED and no longer supported. It will be removed in the next MAJOR release.');var f=this;this.defaultOptions={start:null,end:null,autoResize:!0,orientation:{axis:"bottom",item:"bottom"},moment:jn,width:null,height:null,maxHeight:null,minHeight:null},this.options=ih.deepExtend({},this.defaultOptions),this._create(t),this.components=[],this.body={dom:this.dom,domProps:this.props,emitter:{on:An(r=this.on).call(r,this),off:An(s=this.off).call(s,this),emit:An(a=this.emit).call(a,this)},hiddenDates:[],util:{getScale:function(){return f.timeAxis.step.scale},getStep:function(){return f.timeAxis.step.step},toScreen:An(l=f._toScreen).call(l,f),toGlobalScreen:An(c=f._toGlobalScreen).call(c,f),toTime:An(h=f._toTime).call(h,f),toGlobalTime:An(d=f._toGlobalTime).call(d,f)}},this.range=new qh(this.body),this.components.push(this.range),this.body.range=this.range,this.timeAxis=new id(this.body),this.components.push(this.timeAxis),this.currentTime=new kd(this.body),this.components.push(this.currentTime),this.linegraph=new sf(this.body),this.components.push(this.linegraph),this.itemsData=null,this.groupsData=null,this.on("tap",function(t){f.emit("click",f.getEventProperties(t))}),this.on("doubletap",function(t){f.emit("doubleClick",f.getEventProperties(t))}),this.dom.root.oncontextmenu=function(t){f.emit("contextmenu",f.getEventProperties(t))},this.initialFitDone=!1,this.on("changed",function(){if(null!=f.itemsData){if(!f.initialFitDone&&!f.options.rollingMode)if(f.initialFitDone=!0,null!=f.options.start||null!=f.options.end){if(null==f.options.start||null==f.options.end)var t=f.getItemRange();f.setWindow(null!=f.options.start?f.options.start:t.min,null!=f.options.end?f.options.end:t.max,{animation:!1})}else f.fit({animation:!1});f.initialDrawDone||!f.initialRangeChangeDone&&(f.options.start||f.options.end)&&!f.options.rollingMode||(f.initialDrawDone=!0,f.dom.root.style.visibility="visible",f.dom.loadingScreen.parentNode.removeChild(f.dom.loadingScreen),f.options.onInitialDrawComplete&&Mn(function(){return f.options.onInitialDrawComplete()},0))}}),o&&this.setOptions(o),n&&this.setGroups(n),e&&this.setItems(e),this._redraw()}(gf.prototype=new wd).setOptions=function(t){!0===Tu.validate(t,ff)&&console.log("%cErrors have been found in the supplied options object.",Eu),wd.prototype.setOptions.call(this,t)},gf.prototype.setItems=function(t){var e,n=null==this.itemsData;e=t?i.isDataViewLike("id",t)?Qc(t):Qc(new i.DataSet(t)):null,this.itemsData&&this.itemsData.dispose(),this.itemsData=e,this.linegraph&&this.linegraph.setItems(null!=e?e.rawDS:null),n&&(null!=this.options.start||null!=this.options.end?this.setWindow(null!=this.options.start?this.options.start:null,null!=this.options.end?this.options.end:null,{animation:!1}):this.fit({animation:!1}))},gf.prototype.setGroups=function(t){var e;e=t?i.isDataViewLike("id",t)?t:new i.DataSet(t):null,this.groupsData=e,this.linegraph.setGroups(e)},gf.prototype.getLegend=function(t,e,i){return void 0===e&&(e=15),void 0===i&&(i=15),void 0!==this.linegraph.groups[t]?this.linegraph.groups[t].getLegend(e,i):"cannot find group:'"+t+"'"},gf.prototype.isGroupVisible=function(t){return void 0!==this.linegraph.groups[t]&&this.linegraph.groups[t].visible&&(void 0===this.linegraph.options.groups.visibility[t]||1==this.linegraph.options.groups.visibility[t])},gf.prototype.getDataRange=function(){var t=null,e=null;for(var i in this.linegraph.groups)if(this.linegraph.groups.hasOwnProperty(i)&&1==this.linegraph.groups[i].visible)for(var n=0;n<this.linegraph.groups[i].itemsData.length;n++){var o=ih.convert(this.linegraph.groups[i].itemsData[n].x,"Date").valueOf();t=null==t||t>o?o:t,e=null==e||e<o?o:e}return{min:null!=t?new Date(t):null,max:null!=e?new Date(e):null}},gf.prototype.getEventProperties=function(t){var e=t.center?t.center.y:t.clientY,i=(t.center?t.center.x:t.clientX)-ih.getAbsoluteLeft(this.dom.centerContainer),n=e-ih.getAbsoluteTop(this.dom.centerContainer),o=this._toTime(i),r=bd.customTimeFromTarget(t),s=ih.getTarget(t),a=null;ih.hasParent(s,this.timeAxis.dom.foreground)||this.timeAxis2&&ih.hasParent(s,this.timeAxis2.dom.foreground)?a="axis":ih.hasParent(s,this.linegraph.yAxisLeft.dom.frame)||ih.hasParent(s,this.linegraph.yAxisRight.dom.frame)?a="data-axis":ih.hasParent(s,this.linegraph.legendLeft.dom.frame)||ih.hasParent(s,this.linegraph.legendRight.dom.frame)?a="legend":null!=r?a="custom-time":ih.hasParent(s,this.currentTime.bar)?a="current-time":ih.hasParent(s,this.dom.center)&&(a="background");var l=[],c=this.linegraph.yAxisLeft,h=this.linegraph.yAxisRight;return!c.hidden&&this.itemsData.length>0&&l.push(c.screenToValue(n)),!h.hidden&&this.itemsData.length>0&&l.push(h.screenToValue(n)),{event:t,customTime:r?r.options.id:null,what:a,pageX:t.srcEvent?t.srcEvent.pageX:t.pageX,pageY:t.srcEvent?t.srcEvent.pageY:t.pageY,x:i,y:n,time:o,value:l}},gf.prototype._createConfigurator=function(){return new Lu(this,this.dom.container,pf)};var mf=function(){try{return navigator?navigator.languages&&navigator.languages.length?navigator.languages:navigator.userLanguage||navigator.language||navigator.browserLanguage||"en":"en"}catch(t){return"en"}}();n.default.locale(mf);var vf={Core:wd,DateUtil:Wh,Range:qh,stack:Qd,TimeStep:ed,components:{items:{Item:nu,BackgroundItem:au,BoxItem:ou,ClusterItem:gu,PointItem:ru,RangeItem:su},BackgroundGroup:eu,Component:ah,CurrentTime:kd,CustomTime:bd,DataAxis:Ku,DataScale:$u,GraphGroup:nf,Group:tu,ItemSet:_u,Legend:of,LineGraph:sf,TimeAxis:id}};t.Graph2d=gf,t.Timeline=Bu,t.timeline=vf,Object.defineProperty(t,"__esModule",{value:!0})}(e,i(9609),i(4493))},6677:(t,e,i)=>{"use strict";i.r(e),i.d(e,{AnalystsModule:()=>It});var n=i(1116),o=i(1462),r=i(5425),s=i(5848),a=i(6739),l=i(7349),c=i(7703),h=i(549),d=i(5366),u=i(3458),f=i(570);let p=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-shell"]],decls:5,vars:0,consts:[[1,"d-flex","flex-column","flex-root"],[1,"page","d-flex","flex-row","flex-column-fluid"],["module","analysts"],["title","Analysts Dashboard"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d._UZ(2,"app-sidebar",2),d._UZ(3,"app-header",3),d._UZ(4,"router-outlet"),d.qZA(),d.qZA())},directives:[u.k,f.G,c.lC],styles:[""]}),t})();var g=i(3559),m=i(4733),v=i(7320),y=i(3295),b=i(9151),w=i(6341);const k="function"==typeof btoa,_="function"==typeof Buffer,x=("function"==typeof TextDecoder&&new TextDecoder,"function"==typeof TextEncoder?new TextEncoder:void 0),C=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),E=((t=>{let e={};t.forEach((t,i)=>e[t]=i)})(C),String.fromCharCode.bind(String)),T=("function"==typeof Uint8Array.from&&Uint8Array.from.bind(Uint8Array),t=>t.replace(/=/g,"").replace(/[+\/]/g,t=>"+"==t?"-":"_")),S=k?t=>btoa(t):_?t=>Buffer.from(t,"binary").toString("base64"):t=>{let e,i,n,o,r="";const s=t.length%3;for(let a=0;a<t.length;){if((i=t.charCodeAt(a++))>255||(n=t.charCodeAt(a++))>255||(o=t.charCodeAt(a++))>255)throw new TypeError("invalid character found");e=i<<16|n<<8|o,r+=C[e>>18&63]+C[e>>12&63]+C[e>>6&63]+C[63&e]}return s?r.slice(0,s-3)+"===".substring(s):r},A=_?t=>Buffer.from(t).toString("base64"):t=>{let e=[];for(let i=0,n=t.length;i<n;i+=4096)e.push(E.apply(null,t.subarray(i,i+4096)));return S(e.join(""))},O=t=>{if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?E(192|e>>>6)+E(128|63&e):E(224|e>>>12&15)+E(128|e>>>6&63)+E(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return E(240|e>>>18&7)+E(128|e>>>12&63)+E(128|e>>>6&63)+E(128|63&e)},I=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,P=_?t=>Buffer.from(t,"utf8").toString("base64"):x?t=>A(x.encode(t)):t=>S(t.replace(I,O)),M=(t,e=!1)=>e?T(P(t)):P(t);var D=i(5943);const N=["content"];function R(t,e){if(1&t&&(d.TgZ(0,"option",18),d._uU(1),d.qZA()),2&t){const t=e.$implicit;d.s9C("value",t.ClassificationId),d.xp6(1),d.Oqu(t.ClassificationName)}}function z(t,e){if(1&t&&(d.TgZ(0,"span",25),d.TgZ(1,"span",25),d._uU(2),d.qZA(),d.TgZ(3,"span",28),d._uU(4,"Area"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Locality," ")}}function F(t,e){if(1&t&&(d.TgZ(0,"span",25),d.TgZ(1,"span",25),d._uU(2),d.qZA(),d.TgZ(3,"span",28),d._uU(4,"Ward"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Ward," ")}}function L(t,e){if(1&t&&(d.TgZ(0,"span",25),d.TgZ(1,"span",25),d._uU(2),d.qZA(),d.TgZ(3,"span",28),d._uU(4,"Village"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Village," ")}}function B(t,e){if(1&t&&(d.TgZ(0,"div",20),d.TgZ(1,"div",21),d.TgZ(2,"div",22),d.TgZ(3,"a",23),d._uU(4),d.qZA(),d.TgZ(5,"span",24),d.TgZ(6,"span",25),d._uU(7),d.qZA(),d.YNc(8,z,5,1,"span",26),d.YNc(9,F,5,1,"span",26),d.YNc(10,L,5,1,"span",26),d.TgZ(11,"span",25),d._uU(12),d.qZA(),d.qZA(),d.TgZ(13,"span",27),d._uU(14),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t){const t=e.$implicit;d.xp6(4),d.AsE("# ",t.IncidentId,": ",t.IncidentTypeName," "),d.xp6(3),d.AsE("",t.LGA,", ",t.State,""),d.xp6(1),d.Q6J("ngIf","UNKNOWN LOCALITY"!=t.Locality),d.xp6(1),d.Q6J("ngIf","UNKNOWN WARD"!=t.Ward),d.xp6(1),d.Q6J("ngIf","UNKNOWN VILLAGE"!=t.Village),d.xp6(2),d.hij(", ",t.Country,""),d.xp6(2),d.Oqu(t.IncidentDate)}}function j(t,e){if(1&t&&(d.TgZ(0,"div"),d.YNc(1,B,15,9,"div",19),d.qZA()),2&t){const t=d.oxw(2);d.xp6(1),d.Q6J("ngForOf",t.relatedIncidentData)}}function V(t,e){1&t&&(d.TgZ(0,"div"),d.TgZ(1,"div",20),d.TgZ(2,"div",29),d.TgZ(3,"div",22),d.TgZ(4,"a",30),d._uU(5,"No associated incidents "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA())}function H(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"div",4),d.TgZ(1,"h4",5),d._uU(2,"Save Analysis"),d.qZA(),d.TgZ(3,"button",6),d.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),d.TgZ(4,"span",7),d._uU(5,"\xd7"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"div",8),d.TgZ(7,"div",9),d.TgZ(8,"div",10),d.TgZ(9,"h3",11),d._uU(10),d.qZA(),d.TgZ(11,"label",12),d._uU(12,"Category:"),d.qZA(),d.TgZ(13,"div"),d.TgZ(14,"select",13),d.NdJ("ngModelChange",function(e){return d.CHM(t),d.oxw().analysisClassification=e}),d._UZ(15,"option"),d.YNc(16,R,2,2,"option",14),d.qZA(),d.qZA(),d.qZA(),d.YNc(17,j,2,1,"div",15),d.YNc(18,V,6,0,"div",15),d.qZA(),d.qZA(),d.TgZ(19,"div",16),d.TgZ(20,"button",17),d.NdJ("click",function(){return d.CHM(t),d.oxw().saveAnalysis()}),d._uU(21,"Save "),d.qZA(),d.qZA()}if(2&t){const t=d.oxw();d.xp6(10),d.Oqu(t.analysisTitle),d.xp6(4),d.Q6J("ngModel",t.analysisClassification),d.xp6(2),d.Q6J("ngForOf",t.classificationTypes),d.xp6(1),d.Q6J("ngIf",t.relatedIncidents.length>0),d.xp6(1),d.Q6J("ngIf",0==t.relatedIncidents.length)}}let W=(()=>{class t{constructor(t,e,i,n){this.events=t,this.serverRequest=e,this.modalService=i,this.storage=n,this.selectedIncidents=[],this.analysisTitle="",this.classificationTypes=[],this.relatedIncidents=[],this.Editor=w,this.config={}}ngOnInit(){this.storage.getItem("sessionInfo").subscribe(t=>{t=JSON.parse(t),this.userId=t.userId}),console.log(w.builtinPlugins),this.config={placeholder:"Type your analysis here!",toolbar:w.builtinPlugins.map(t=>t.pluginName),mention:{feeds:[{marker:"#",feed:t=>this.selectedIncidents.filter(e=>e.includes(t)).slice(0,10).map(t=>"#"+t)}]}},this.loadAnalysisClassifications(),this.events.getEvent("incident-data-selected").subscribe(t=>{this.selectedIncidents=[];for(let e in t)1==t[e]&&this.selectedIncidents.push(e)}),this.events.getEvent("save-current-analysis").subscribe(t=>{null!=t&&this.openConfirmModal()})}ngAfterViewInit(){}loadAnalysisClassifications(){this.serverRequest.get("general-analysis/analysis/view-classifications").subscribe(t=>{this.classificationTypes=t.contentData})}onReady(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement())}viewAnalysis(){}openConfirmModal(){$(this.analysisText).find("*[data-mention]").each((t,e)=>{this.relatedIncidents.push($(e).attr("data-mention").replace("#",""))}),this.relatedIncidents.length>0&&this.serverRequest.post("incidents/incident/view-multi-incidents-by-id",{incidents:this.relatedIncidents}).subscribe(t=>{this.relatedIncidentData=t.contentData}),this.modalRef=this.modalService.open(this.modalTemplate,{backdropClass:"modal-backdrop",size:"sm",scrollable:!0})}saveAnalysis(){let t={classification:this.analysisClassification,text:M(this.analysisText),userId:this.userId,relatedIncidents:this.relatedIncidents};this.serverRequest.post("general-analysis/analysis/new-analysis",t).subscribe(t=>{this.analysisText="",this.modalRef.close()})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(b.n),d.Y36(v.I),d.Y36(y.FF),d.Y36(D.V))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-analysis-editor"]],viewQuery:function(t,e){if(1&t&&d.Gf(N,7),2&t){let t;d.iGM(t=d.CRH())&&(e.modalTemplate=t.first)}},inputs:{incidentData:"incidentData"},decls:5,vars:3,consts:[[1,"row"],[1,"col-md-12","document-editor"],[3,"editor","config","ngModel","ready","ngModelChange"],["content",""],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","content-container",1,"row"],[1,"mb-10","pt-0"],[1,"fs-3","fw-bold"],[1,"form-label","fw-bold"],[1,"form-select","form-select-solid",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],[3,"value"],["class","card-body pt-0",4,"ngFor","ngForOf"],[1,"card-body","pt-0"],[1,"d-flex","align-items-center","bg-light-success","rounded","p-5","mb-7"],[1,"flex-grow","me-2"],["href","#",1,"fw-bolder","text-gray-800","text-hover-primary","fs-6"],[1,"fw-bold","d-block"],[1,""],["class"," ",4,"ngIf"],[1,"text-muted","fw-bold","d-block"],[1,"text-small"],[1,"d-flex","align-items-center","bg-light-warning","rounded","p-5","mb-7"],["href","#",1,"text-gray-800","text-hover-primary","fs-6"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"ckeditor",2),d.NdJ("ready",function(t){return e.onReady(t)})("ngModelChange",function(t){return e.analysisText=t}),d.qZA(),d.qZA(),d.qZA(),d.YNc(3,H,22,5,"ng-template",null,3,d.W1O)),2&t&&(d.xp6(2),d.Q6J("editor",e.Editor)("config",e.config)("ngModel",e.analysisText))},directives:[a.u,o.JJ,o.On,o.EJ,o.YN,o.Kr,n.sg,n.O5],styles:["[_nghost-%COMP%]     .ck-editor__editable_inline{height:80vh;overflow-y:scroll}"]}),t})();function q(t,e){1&t&&(d.TgZ(0,"span",22),d._uU(1,"Analysis Workspace"),d.qZA())}function U(t,e){if(1&t&&(d.TgZ(0,"span",22),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.hij("",t.selectedIncidents.length," Incidents")}}function Y(t,e){if(1&t&&(d.TgZ(0,"span",31),d.TgZ(1,"span",31),d._uU(2),d.qZA(),d.TgZ(3,"span",42),d._uU(4,"Area"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Locality," ")}}function G(t,e){if(1&t&&(d.TgZ(0,"span",31),d.TgZ(1,"span",31),d._uU(2),d.qZA(),d.TgZ(3,"span",42),d._uU(4,"Ward"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Ward," ")}}function Z(t,e){if(1&t&&(d.TgZ(0,"span",31),d.TgZ(1,"span",31),d._uU(2),d.qZA(),d.TgZ(3,"span",42),d._uU(4,"Village"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij(", ",t.Village," ")}}function X(t,e){if(1&t&&(d.TgZ(0,"tr"),d.TgZ(1,"td",26),d._uU(2),d.qZA(),d.TgZ(3,"td"),d._uU(4),d.qZA(),d.qZA()),2&t){const t=e.$implicit;d.xp6(2),d.Oqu(t.Field),d.xp6(2),d.Oqu(t.FieldValue)}}function K(t,e){if(1&t&&(d.TgZ(0,"div",23),d.TgZ(1,"h2",24),d.TgZ(2,"button",25),d.TgZ(3,"span",26),d._uU(4),d.qZA(),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"div",27),d.TgZ(7,"div",28),d.TgZ(8,"div",29),d.TgZ(9,"div",30),d.TgZ(10,"span",31),d._uU(11),d.qZA(),d.YNc(12,Y,5,1,"span",32),d.YNc(13,G,5,1,"span",32),d.YNc(14,Z,5,1,"span",32),d.TgZ(15,"span",31),d._uU(16),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"div",33),d.TgZ(18,"span",34),d._UZ(19,"i",35),d.qZA(),d.TgZ(20,"span",36),d._uU(21),d.qZA(),d.qZA(),d.TgZ(22,"div",37),d.TgZ(23,"div",38),d._uU(24),d.qZA(),d.TgZ(25,"div",39),d.TgZ(26,"table",40),d.YNc(27,X,5,2,"tr",41),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t){const t=e.$implicit,i=e.index;d.xp6(1),d.MGl("id","kt_accordion_1_header_",i,""),d.xp6(1),d.uIk("data-bs-target","#kt_accordion_1_body_"+i),d.xp6(2),d.hij("#",t.IncidentId,":"),d.xp6(1),d.hij(" ",t.IncidentTypeName," "),d.xp6(1),d.MGl("id","kt_accordion_1_body_",i,""),d.uIk("data-bs-parent","#kt_accordion_"+i),d.xp6(5),d.AsE("",t.LGA,", ",t.State,""),d.xp6(1),d.Q6J("ngIf","UNKNOWN LOCALITY"!=t.Locality),d.xp6(1),d.Q6J("ngIf","UNKNOWN WARD"!=t.Ward),d.xp6(1),d.Q6J("ngIf","UNKNOWN VILLAGE"!=t.Village),d.xp6(2),d.hij(", ",t.Country,""),d.xp6(5),d.hij("\xa0\xa0",t.IncidentDate,""),d.xp6(3),d.Oqu(t.IncidentName),d.xp6(3),d.Q6J("ngForOf",t.metadata)}}let Q=(()=>{class t{constructor(t,e){this.events=t,this.serverRequest=e,this.selectedIncidents=[],this.incidentData=[]}ngOnInit(){KTDrawer.init(),KTApp.init(),this.events.getEvent("incident-data-selected").subscribe(t=>{this.selectedIncidents=[];for(let e in t)1==t[e]&&this.selectedIncidents.push(e);this.selectedIncidents.length>0&&this.loadIncidents()})}loadIncidents(){this.serverRequest.post("incidents/incident/view-multi-incidents-by-id",{incidents:this.selectedIncidents}).subscribe(t=>{this.incidentData=t.contentData})}broadcastSaveRequest(){this.events.broadcast("save-current-analysis",{})}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(b.n),d.Y36(v.I))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-incidence-data-sidebar"]],decls:26,vars:4,consts:[["id","kt_explore_toggle","data-bs-toggle","tooltip","data-bs-placement","right","data-bs-trigger","hover",1,"explore-toggle","btn","btn-sm","bg-body","btn-color-gray-700","btn-active-primary","shadow-sm","position-fixed","px-5","fw-bolder","zindex-2","top-50","mt-10","end-0","transform-90","fs-6","rounded-top-0",2,"z-index","10",3,"title"],["id","kt_explore_toggle_label",4,"ngIf"],["id","kt_explore","data-kt-drawer","true","data-kt-drawer-name","explore","data-kt-drawer-activate","true","data-kt-drawer-overlay","true","data-kt-drawer-width","{default:'100vw', 'lg': '100vw'}","data-kt-drawer-direction","end","data-kt-drawer-toggle","#kt_explore_toggle","data-kt-drawer-close","#kt_explore_close",1,"bg-body"],[1,"card","shadow-none","rounded-0","w-100"],["id","kt_explore_header",1,"card-header"],[1,"card-title","fw-bolder","text-gray-700"],[1,"card-toolbar"],["type","button",1,"btn","btn-link","btn-active-light-primary",2,"margin-left","30px",3,"click"],[1,"fa","fa-save"],["type","button","id","kt_explore_close",1,"btn","btn-sm","btn-icon","btn-active-light-primary","me-n5"],[1,"svg-icon","svg-icon-2"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","24px","height","24px","viewBox","0 0 24 24","version","1.1"],["transform","translate(12.000000, 12.000000) rotate(-45.000000) translate(-12.000000, -12.000000) translate(4.000000, 4.000000)","fill","#000000"],["fill","#000000","x","0","y","7","width","16","height","2","rx","1"],["fill","#000000","opacity","0.5","transform","translate(8.000000, 8.000000) rotate(-270.000000) translate(-8.000000, -8.000000)","x","0","y","7","width","16","height","2","rx","1"],["id","kt_explore_body",1,"card-body"],[1,"row"],[1,"col-8"],[1,"col-4"],["id","kt_explore_scroll","data-kt-scroll","true","data-kt-scroll-height","80vh","data-kt-scroll-wrappers","#kt_explore_body","data-kt-scroll-dependencies","#kt_explore_header","data-kt-scroll-offset","5px",1,"scroll-y","me-n5","pe-5",2,"height","80vh"],["id","kt_accordion_1",1,"accordion"],["class","accordion-item",4,"ngFor","ngForOf"],["id","kt_explore_toggle_label"],[1,"accordion-item"],[1,"accordion-header",3,"id"],["type","button","data-bs-toggle","collapse","aria-expanded","true",1,"accordion-button","fs-4","fw-bold"],[1,"text-muted"],[1,"accordion-collapse","collapse","show",3,"id"],[1,"accordion-body"],[1,"d-flex","align-items-center","mb-1"],[1,"fs-7","text-gray-800","mb-0","me-1"],[1,""],["class"," ",4,"ngIf"],[1,"text-nowrap"],[1,"text-muted","fs-7","fw-bold","me-n1"],[1,"fa","fa-calendar"],[1,"text-muted","fs-7","fw-bolder"],[1,"col-12"],[1,"fs-7"],[1,"table-responsive","mb-4"],[1,"table"],[4,"ngFor","ngForOf"],[1,"text-small"]],template:function(t,e){1&t&&(d.TgZ(0,"button",0),d.YNc(1,q,2,0,"span",1),d.YNc(2,U,2,1,"span",1),d.qZA(),d.TgZ(3,"div",2),d.TgZ(4,"div",3),d.TgZ(5,"div",4),d.TgZ(6,"h3",5),d._uU(7,"Analysis Workspace"),d.qZA(),d.TgZ(8,"div",6),d.TgZ(9,"button",7),d.NdJ("click",function(){return e.broadcastSaveRequest()}),d._UZ(10,"i",8),d._uU(11," Save Analysis"),d.qZA(),d.TgZ(12,"button",9),d.TgZ(13,"span",10),d.O4$(),d.TgZ(14,"svg",11),d.TgZ(15,"g",12),d._UZ(16,"rect",13),d._UZ(17,"rect",14),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.kcU(),d.TgZ(18,"div",15),d.TgZ(19,"div",16),d.TgZ(20,"div",17),d._UZ(21,"app-analysis-editor"),d.qZA(),d.TgZ(22,"div",18),d.TgZ(23,"div",19),d.TgZ(24,"div",20),d.YNc(25,K,28,15,"div",21),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.MGl("title","",e.selectedIncidents.length," Incidents"),d.xp6(1),d.Q6J("ngIf",0==e.selectedIncidents.length),d.xp6(1),d.Q6J("ngIf",e.selectedIncidents.length>0),d.xp6(23),d.Q6J("ngForOf",e.incidentData))},directives:[n.O5,W,n.sg],styles:[""]}),t})();var J=i(2617),tt=i(2512);function et(t,e){if(1&t&&(d.TgZ(0,"span",33),d.TgZ(1,"span",34),d._uU(2),d.qZA(),d.TgZ(3,"span",35),d._uU(4,"Area"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij("",t.Locality," ")}}function it(t,e){if(1&t&&(d.TgZ(0,"span",33),d.TgZ(1,"span",34),d._uU(2),d.qZA(),d.TgZ(3,"span",35),d._uU(4,"Ward"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij("",t.Ward," ")}}function nt(t,e){if(1&t&&(d.TgZ(0,"span",33),d.TgZ(1,"span",34),d._uU(2),d.qZA(),d.TgZ(3,"span",35),d._uU(4,"Village"),d.qZA(),d.qZA()),2&t){const t=d.oxw().$implicit;d.xp6(2),d.hij("",t.Village," ")}}function ot(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"tr"),d.TgZ(1,"td"),d.TgZ(2,"div",13),d.TgZ(3,"input",22),d.NdJ("ngModelChange",function(e){const i=d.CHM(t).$implicit;return d.oxw(2).selectedIncidents[i.IncidentId]=e})("change",function(){return d.CHM(t),d.oxw(2).broadcastIncidentSelect()}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(4,"td",23),d.NdJ("click",function(){const e=d.CHM(t).$implicit;return d.oxw(2).openIncident(e)}),d.TgZ(5,"span",24),d.TgZ(6,"span",25),d._uU(7),d.qZA(),d._uU(8),d.qZA(),d.TgZ(9,"span",26),d._UZ(10,"i",27),d._uU(11),d.qZA(),d.TgZ(12,"span",26),d._UZ(13,"i",28),d._uU(14),d.qZA(),d.TgZ(15,"div",29),d._uU(16),d.qZA(),d.qZA(),d.TgZ(17,"td",30),d.NdJ("click",function(){const e=d.CHM(t).$implicit;return d.oxw(2).openIncident(e)}),d.TgZ(18,"span",24),d._uU(19),d.qZA(),d.YNc(20,et,5,1,"span",31),d.YNc(21,it,5,1,"span",31),d.YNc(22,nt,5,1,"span",31),d.TgZ(23,"span",32),d._uU(24),d.qZA(),d.qZA(),d.TgZ(25,"td",30),d.NdJ("click",function(){const e=d.CHM(t).$implicit;return d.oxw(2).openIncident(e)}),d._uU(26),d.qZA(),d.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=d.oxw(2);d.xp6(3),d.MGl("name","selectCheckbox-",i,""),d.Q6J("ngModel",n.selectedIncidents[t.IncidentId]),d.xp6(4),d.hij("#",t.IncidentId,":"),d.xp6(1),d.hij(" ",t.IncidentTypeName," "),d.xp6(3),d.hij(" ",t.metadata.length," associated metadata "),d.xp6(3),d.hij(" ",t.ReviewedByAccountName," "),d.xp6(2),d.Oqu(t.IncidentName),d.xp6(3),d.AsE("",t.LGA,", ",t.State,""),d.xp6(1),d.Q6J("ngIf","UNKNOWN LOCALITY"!=t.Locality),d.xp6(1),d.Q6J("ngIf","UNKNOWN WARD"!=t.Ward),d.xp6(1),d.Q6J("ngIf","UNKNOWN VILLAGE"!=t.Village),d.xp6(2),d.Oqu(t.Country),d.xp6(2),d.Oqu(t.IncidentDate)}}function rt(t,e){if(1&t&&(d.TgZ(0,"tbody",20),d.YNc(1,ot,27,14,"tr",21),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.Q6J("ngForOf",t.currentData)}}function st(t,e){1&t&&(d.TgZ(0,"tbody"),d.TgZ(1,"tr"),d.TgZ(2,"td",36),d._uU(3,"No incidences available"),d.qZA(),d.qZA(),d.qZA())}function at(t,e){if(1&t&&(d.TgZ(0,"tr"),d.TgZ(1,"td",56),d._uU(2),d.qZA(),d.TgZ(3,"td"),d._uU(4),d.qZA(),d.qZA()),2&t){const t=e.$implicit;d.xp6(2),d.Oqu(t.Field),d.xp6(2),d.Oqu(t.FieldValue)}}function lt(t,e){1&t&&(d.TgZ(0,"tr"),d.TgZ(1,"td",57),d._UZ(2,"i",58),d.TgZ(3,"span",25),d._uU(4,"No metadata has been added for this incident"),d.qZA(),d.qZA(),d.qZA())}function ct(t,e){if(1&t&&(d.TgZ(0,"div",37),d.TgZ(1,"div",38),d.TgZ(2,"div",39),d.TgZ(3,"h3",40),d.TgZ(4,"span",25),d._uU(5),d.qZA(),d._uU(6),d.qZA(),d.TgZ(7,"div",41),d.TgZ(8,"ul",42),d.TgZ(9,"li",43),d.TgZ(10,"a",44),d._uU(11,"View Incident"),d.qZA(),d.qZA(),d.TgZ(12,"li",43),d.TgZ(13,"a",45),d._uU(14,"View Metadata"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(15,"div",46),d.TgZ(16,"div",47),d.TgZ(17,"div",48),d._UZ(18,"app-view-single-field-report",49),d.qZA(),d.TgZ(19,"div",50),d.TgZ(20,"div",51),d.TgZ(21,"div",52),d.TgZ(22,"div",53),d.TgZ(23,"table",54),d.YNc(24,at,5,2,"tr",21),d.YNc(25,lt,5,0,"tr",17),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(26,"div",55),d._uU(27," ... "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&t){const t=d.oxw();d.xp6(5),d.hij("#",t.currentView.IncidentId,":\xa0 "),d.xp6(1),d.hij(" ",t.currentView.IncidentTypeName,""),d.xp6(12),d.Q6J("incidentData",t.currentView),d.xp6(6),d.Q6J("ngForOf",t.currentView.metadata),d.xp6(1),d.Q6J("ngIf",0==t.currentView.metadata.length)}}function ht(t,e){1&t&&(d.TgZ(0,"div",37),d.TgZ(1,"div",59),d._UZ(2,"img",60),d.TgZ(3,"h3",61),d._uU(4,"Click on an incident to view or add analysis"),d.qZA(),d.qZA(),d.qZA())}function dt(t,e){1&t&&(d.TgZ(0,"div",62),d.TgZ(1,"h4",63),d._uU(2,"Add new analysis"),d.qZA(),d.TgZ(3,"button",64),d.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),d.TgZ(4,"span",65),d._uU(5,"\xd7"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(6,"div",66),d._UZ(7,"div",67),d.qZA(),d.TgZ(8,"div",68),d.TgZ(9,"button",69),d._uU(10,"Save Analysis"),d.qZA(),d.qZA())}let ut=(()=>{class t{constructor(t,e,i){this.serverRequest=t,this.modalService=e,this.events=i,this.globalDateRange={startDate:"",endDate:""},this.performGlobalSearch=!1,this.searchParams={type:"basic",keyword:"",incidentType:"",location:""},this.currentData=[],this.currentView={},this.forReview=!1,this.forDecline=!1,this.incidentLoaded=!1,this.selectedIncidents={},this.groupSelect=!1,this.dtOptions={paging:!0,lengthChange:!0,pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!0,ajax:(t,e)=>{let i=t.length,n=t.search.value,o=t.start,r=this.globalDateRange.startDate,s=this.globalDateRange.endDate,a=0,l="";this.performGlobalSearch&&(n=this.searchParams.keyword,a=this.searchParams.incidentType,l=this.searchParams.location,""!=this.searchParams.dateRange.startDate&&(r=this.searchParams.dateRange.startDate.format("YYYY-MM-DD"),s=this.searchParams.dateRange.endDate.format("YYYY-MM-DD"))),this.serverRequest.get("incidents/incident/view-incidents?length="+i+"&start="+o+"&search="+n+"&startDate="+r+"&endDate="+s+"&incidentType="+a+"&location="+l).subscribe(t=>{this.performGlobalSearch=!1,this.currentData=[],this.currentData=t.contentData.data,e({recordsTotal:t.contentData.recordsTotal,recordsFiltered:t.contentData.recordsFiltered,data:[]})})},columnDefs:[{orderable:!1,targets:0}],order:[[1,"asc"]]},this.dtTrigger=new g.xQ}ngOnInit(){this.dtTrigger.next(),setTimeout(()=>{this.rerender()},500),this.events.getEvent("perform-global-search").subscribe(t=>{console.log(t),null!==t&&""!=t.type&&(this.searchParams=t,this.performGlobalSearch=!0,this.groupSelect=!1,setTimeout(()=>{this.dtElement.dtInstance.then(t=>{t.ajax.reload()})},800))})}ngAfterViewInit(){this.dtTrigger.next()}ngOnDestroy(){this.dtTrigger.unsubscribe()}rerender(){this.dtElement.dtInstance.then(t=>{t.destroy(),this.dtTrigger.next()})}openIncident(t){this.forReview=!1,this.forDecline=!1,this.currentView=t,this.incidentLoaded=!0}openEditor(t){this.modalService.open(t,{backdropClass:"modal-backdrop",size:"vw",scrollable:!0})}broadcastIncidentSelect(){this.events.broadcast("incident-data-selected",this.selectedIncidents)}selectAllIncidents(){for(let t in this.currentData)this.selectedIncidents[this.currentData[t].IncidentId]=this.groupSelect,this.broadcastIncidentSelect()}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(v.I),d.Y36(y.FF),d.Y36(b.n))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-view-incidents"]],viewQuery:function(t,e){if(1&t&&d.Gf(m.G,5),2&t){let t;d.iGM(t=d.CRH())&&(e.dtElement=t.first)}},decls:33,vars:7,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"d-flex","flex-column"],[1,"d-lg-flex","align-lg-items-center"],[1,"row",2,"margin-top","10px"],[1,"col-md-5","table-responsive","right-border",2,"padding-left","20px"],["id","kt_explore_scroll","data-kt-scroll","true","data-kt-scroll-height","auto","data-kt-scroll-wrappers","#kt_explore_body","data-kt-scroll-offset","5px",1,"scroll-y","me-n5","pe-5"],["datatable","",1,"table","table-hover","align-middle","gs-0","gy-4",3,"dtOptions","dtTrigger"],[1,"fw-bolder","text-muted","bg-light"],[1,"form-check","form-check-sm"],["type","checkbox","data-kt-check","true","data-kt-check-target",".widget-9-check","name","c0",1,"form-check-input",3,"ngModel","ngModelChange","change"],[1,"min-w-200px"],["style","max-height: 80vh; overflow: scroll;",4,"ngIf"],[4,"ngIf"],["class","col-md-7",4,"ngIf"],["content",""],[2,"max-height","80vh","overflow","scroll"],[4,"ngFor","ngForOf"],["type","checkbox",1,"form-check-input",3,"name","ngModel","ngModelChange","change"],[1,"min-w-200px",3,"click"],[1,"text-dark","fw-bolder","text-hover-primary","d-block","mb-1","fs-6"],[1,"text-muted"],[1,"text-muted","text-hover-primary","d-block","mb-1","fs-6"],[1,"fa","fa-database"],[1,"fa","fa-user"],[1,"wrap-text"],[3,"click"],["class","text-muted d-block fs-7",4,"ngIf"],[1,"text-muted","text-small","text-muted","d-block","fs-7"],[1,"text-muted","d-block","fs-7"],[1,"text-muted","fw-bold"],[1,"text-small"],["colspan","4"],[1,"col-md-7"],[1,"card"],[1,"card-header","card-header-stretch"],[1,"card-title"],[1,"card-toolbar"],[1,"nav","nav-tabs","nav-line-tabs","nav-stretch","fs-6","border-0"],[1,"nav-item"],["data-bs-toggle","tab","href","#kt_tab_pane_7",1,"nav-link","active"],["data-bs-toggle","tab","href","#kt_tab_pane_9",1,"nav-link"],[1,"card-body"],["id","myTabContent",1,"tab-content"],["id","kt_tab_pane_7","role","tabpanel",1,"tab-pane","fade","show","active"],[3,"incidentData"],["id","kt_tab_pane_9","role","tabpanel",1,"tab-pane","fade"],[1,"col-12"],[1,"fs-5","fw-bold"],[1,"table-responsive","mb-4"],[1,"table"],["id","kt_tab_pane_8","role","tabpanel",1,"tab-pane","fade"],[1,"text-bold"],["colspan","2",1,"fs-4","text-align-center"],[1,"fa","fa-exclamation-circle","text-warning"],[1,"col-md-12","mt-10","mb-5","text-center"],["src","assets/media/illustrations/undraw_visual_data_re_mxxo.svg",1,"img-fluid",2,"width","20vw","margin-top","20px"],[1,"text-muted","mt-5"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],["id","editor-container",1,"row"],[1,"modal-footer"],["type","button",1,"btn","btn-success"]],template:function(t,e){1&t&&(d._UZ(0,"app-incidence-data-sidebar"),d.TgZ(1,"div",0),d.TgZ(2,"div",1),d.TgZ(3,"div",2),d.TgZ(4,"div",3),d.TgZ(5,"h1",4),d._uU(6,"Field Incidents"),d.qZA(),d.TgZ(7,"span",5),d._uU(8,"Analysis & Report Portal"),d.qZA(),d.qZA(),d.TgZ(9,"div",6),d.TgZ(10,"div",7),d._UZ(11,"app-global-search"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(12,"div",8),d.TgZ(13,"div",9),d.TgZ(14,"div",10),d.TgZ(15,"table",11),d.TgZ(16,"thead"),d.TgZ(17,"tr",12),d.TgZ(18,"th"),d.TgZ(19,"div",13),d.TgZ(20,"input",14),d.NdJ("ngModelChange",function(t){return e.groupSelect=t})("change",function(){return e.selectAllIncidents()}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(21,"th",15),d._uU(22,"Incident"),d.qZA(),d.TgZ(23,"th"),d._uU(24,"Location"),d.qZA(),d.TgZ(25,"th"),d._uU(26,"Date"),d.qZA(),d.qZA(),d.qZA(),d.YNc(27,rt,2,1,"tbody",16),d.YNc(28,st,4,0,"tbody",17),d.qZA(),d.qZA(),d.qZA(),d.YNc(29,ct,28,5,"div",18),d.YNc(30,ht,5,0,"div",18),d.qZA(),d.YNc(31,dt,11,0,"ng-template",null,19,d.W1O)),2&t&&(d.xp6(15),d.Q6J("dtOptions",e.dtOptions)("dtTrigger",e.dtTrigger),d.xp6(5),d.Q6J("ngModel",e.groupSelect),d.xp6(7),d.Q6J("ngIf",0!=(null==e.currentData?null:e.currentData.length)),d.xp6(1),d.Q6J("ngIf",0==(null==e.currentData?null:e.currentData.length)),d.xp6(1),d.Q6J("ngIf",e.incidentLoaded),d.xp6(1),d.Q6J("ngIf",!e.incidentLoaded))},directives:[Q,J.v,m.G,o.Wl,o.JJ,o.On,n.O5,n.sg,tt.M],styles:[".wrapper[_ngcontent-%COMP%]{width:91vw;padding-left:0}.modal-backdrop[_ngcontent-%COMP%]{background-color:#4b5320}.w-50[_ngcontent-%COMP%]{width:50%!important}.left-border[_ngcontent-%COMP%]{min-height:100vh;border-left:1px solid #4b5320;border-radius:25px 0}.right-border[_ngcontent-%COMP%]{min-height:100vh;border-right:1px solid #4b5320;border-radius:0 25px}#edit-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;min-height:100vh}.wrap-text[_ngcontent-%COMP%]{max-height:60px;overflow:hidden;text-overflow:ellipsis}"]}),t})();var ft=i(1219);let pt=(()=>{class t{constructor(t,e,i){this.serverRequest=t,this.modalService=e,this.events=i,this.globalDateRange={startDate:"",endDate:""},this.performGlobalSearch=!1,this.searchParams={type:"basic",keyword:"",analysisType:"",location:""},this.currentData=[],this.currentView={},this.forReview=!1,this.forDecline=!1,this.analysisLoaded=!1,this.selectedanalysiss={},this.groupSelect=!1,this.dtOptions={paging:!0,lengthChange:!0,pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!0,ajax:(t,e)=>{let i=t.length,n=t.search.value,o=t.start,r=this.globalDateRange.startDate,s=this.globalDateRange.endDate,a=0,l="";this.performGlobalSearch&&(n=this.searchParams.keyword,a=this.searchParams.analysisType,l=this.searchParams.location,""!=this.searchParams.dateRange.startDate&&(r=this.searchParams.dateRange.startDate.format("YYYY-MM-DD"),s=this.searchParams.dateRange.endDate.format("YYYY-MM-DD"))),this.serverRequest.get("general-analysis/analysis/view-analysis?length="+i+"&start="+o+"&search="+n+"&startDate="+r+"&endDate="+s+"&analysisType="+a+"&location="+l).subscribe(t=>{this.performGlobalSearch=!1,this.currentData=[],this.currentData=t.contentData.data,e({recordsTotal:t.contentData.recordsTotal,recordsFiltered:t.contentData.recordsFiltered,data:[]})})},columnDefs:[{orderable:!1,targets:0}],order:[[1,"asc"]]},this.dtTrigger=new g.xQ}ngOnInit(){this.dtTrigger.next(),setTimeout(()=>{this.rerender()},500),this.events.getEvent("perform-global-search").subscribe(t=>{console.log(t),null!==t&&""!=t.type&&(this.searchParams=t,this.performGlobalSearch=!0,this.groupSelect=!1,setTimeout(()=>{this.dtElement.dtInstance.then(t=>{t.ajax.reload()})},800))})}ngAfterViewInit(){this.dtTrigger.next()}ngOnDestroy(){this.dtTrigger.unsubscribe()}rerender(){this.dtElement.dtInstance.then(t=>{t.destroy(),this.dtTrigger.next()})}openAnalysis(t){this.forReview=!1,this.forDecline=!1,this.currentView=t,this.analysisLoaded=!0}openEditor(t){this.modalService.open(t,{backdropClass:"modal-backdrop",size:"vw",scrollable:!0})}broadcastanalysisSelect(){this.events.broadcast("analysis-data-selected",this.selectedanalysiss)}selectAllanalysiss(){for(let t in this.currentData)this.selectedanalysiss[this.currentData[t].analysisId]=this.groupSelect,this.broadcastanalysisSelect()}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(v.I),d.Y36(y.FF),d.Y36(b.n))},t.\u0275cmp=d.Xpm({type:t,selectors:[["analysts-view-analysis"]],viewQuery:function(t,e){if(1&t&&d.Gf(m.G,5),2&t){let t;d.iGM(t=d.CRH())&&(e.dtElement=t.first)}},decls:1,vars:0,template:function(t,e){1&t&&d._UZ(0,"app-view-analysis")},directives:[ft.w],styles:[""]}),t})(),gt=(()=>{class t{constructor(t,e,i,n){this.events=t,this.serverRequest=e,this.modalService=i,this.storage=n,this.analysisTitle="",this.relatedAnalysis=[],this.Editor=w,this.config={}}ngOnInit(){this.storage.getItem("sessionInfo").subscribe(t=>{t=JSON.parse(t),this.userId=t.userId}),this.config={placeholder:"Type your analysis here!",toolbar:w.builtinPlugins.map(t=>t.pluginName)}}ngAfterViewInit(){}onReady(t){t.ui.getEditableElement().parentElement.insertBefore(t.ui.view.toolbar.element,t.ui.getEditableElement())}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(b.n),d.Y36(v.I),d.Y36(y.FF),d.Y36(D.V))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-analysis-workspace"]],inputs:{analysisData:"analysisData"},decls:13,vars:3,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"d-flex","flex-column"],[1,"d-lg-flex","align-lg-items-center"],[1,"row",2,"margin-top","10px"],[1,"col-md-12","document-editor"],[3,"editor","config","ngModel","ready","ngModelChange"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"div",3),d.TgZ(4,"h1",4),d._uU(5,"Analysis Workspace"),d.qZA(),d.TgZ(6,"span",5),d._uU(7,"Analysis & Report Portal"),d.qZA(),d.qZA(),d.TgZ(8,"div",6),d._UZ(9,"div",7),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(10,"div",8),d.TgZ(11,"div",9),d.TgZ(12,"ckeditor",10),d.NdJ("ready",function(t){return e.onReady(t)})("ngModelChange",function(t){return e.analysisText=t}),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(12),d.Q6J("editor",e.Editor)("config",e.config)("ngModel",e.analysisText))},directives:[a.u,o.JJ,o.On],styles:["[_nghost-%COMP%]     .ck-editor__editable_inline{height:80vh;overflow-y:scroll}"]}),t})(),mt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Xpm({type:t,selectors:[["analysts-analysis-workspace"]],decls:1,vars:0,template:function(t,e){1&t&&d._UZ(0,"app-analysis-workspace")},directives:[gt],styles:["[_nghost-%COMP%]     .ck-editor__editable_inline{height:80vh;overflow-y:scroll}"]}),t})();var vt=i(6368);let yt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-analyst-charts"]],decls:1,vars:0,template:function(t,e){1&t&&d._UZ(0,"app-charts")},directives:[vt.Z],styles:[""]}),t})();var bt=i(8012),wt=i(8395);const kt=["visNetwork"],_t=[{path:"",component:p,canActivate:[h.P],children:[{path:"incidents",component:ut},{path:"view-analyses",component:pt},{path:"analysis-workspace",component:mt},{path:"charts",component:yt},{path:"networks",component:(()=>{class t{constructor(){}ngOnInit(){}ngAfterViewInit(){this.nodes=new bt.DataSet([]),this.edges=new bt.DataSet([]),this.data={nodes:this.nodes,edges:this.edges},this.networkInstance=new wt.Network(this.visNetwork.nativeElement,this.data,{height:"100%",width:"100%",clickToUse:!0,nodes:{shape:"circle"},edges:{smooth:!0,arrows:{to:{enabled:!0}}},manipulation:{enabled:!0,initiallyActive:!0,addNode:(t,e)=>{t.label=this.nodeLabel,e(t)},addEdge:(t,e)=>{t.from===t.to?!0===confirm("Do you want to connect the node to itself?")&&e(t):e(t)},editEdge:!0}})}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-network-graph"]],viewQuery:function(t,e){if(1&t&&d.Gf(kt,5),2&t){let t;d.iGM(t=d.CRH())&&(e.visNetwork=t.first)}},decls:13,vars:1,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"row",2,"margin-top","10px","height","100vh"],[1,"col-md-12",2,"height","100vh"],["type","text","placeholder","Label",1,"form-control","my-5",3,"ngModel","ngModelChange"],["id","visNetwork",2,"height","100vh"],["visNetwork",""]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"div",3),d.TgZ(4,"h1",4),d._uU(5,"Dependencies and Relationships Mapper "),d.qZA(),d.TgZ(6,"span",5),d._uU(7,"Analysis & Report Portal"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"div",6),d.TgZ(9,"div",7),d.TgZ(10,"input",8),d.NdJ("ngModelChange",function(t){return e.nodeLabel=t}),d.qZA(),d._UZ(11,"div",9,10),d.qZA(),d.qZA()),2&t&&(d.xp6(10),d.Q6J("ngModel",e.nodeLabel))},directives:[o.Fj,o.JJ,o.On],styles:[".wrapper[_ngcontent-%COMP%]{width:91vw;padding-left:0}.modal-backdrop[_ngcontent-%COMP%]{background-color:#4b5320}.w-50[_ngcontent-%COMP%]{width:50%!important}.left-border[_ngcontent-%COMP%]{min-height:100vh;border-left:1px solid #4b5320;border-radius:25px 0}.right-border[_ngcontent-%COMP%]{min-height:100vh;border-right:1px solid #4b5320;border-radius:0 25px}#edit-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;min-height:100vh}.wrap-text[_ngcontent-%COMP%]{max-height:60px;overflow:hidden;text-overflow:ellipsis}"]}),t})()}]}];let xt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[c.Bz.forChild(_t)],c.Bz]}),t})();var Ct=i(7647),Et=i(3872),Tt=i(5909);let St=(()=>{let t=class{constructor(){this.click=new d.vpe,this.doubleClick=new d.vpe,this.oncontext=new d.vpe,this.hold=new d.vpe,this.release=new d.vpe,this.select=new d.vpe,this.selectNode=new d.vpe,this.selectEdge=new d.vpe,this.deselectNode=new d.vpe,this.deselectEdge=new d.vpe,this.dragStart=new d.vpe,this.dragging=new d.vpe,this.dragEnd=new d.vpe,this.hoverNode=new d.vpe,this.blurNode=new d.vpe,this.hoverEdge=new d.vpe,this.blurEdge=new d.vpe,this.zoom=new d.vpe,this.showPopup=new d.vpe,this.hidePopup=new d.vpe,this.startStabilizing=new d.vpe,this.stabilizationProgress=new d.vpe,this.stabilizationIterationsDone=new d.vpe,this.stabilized=new d.vpe,this.resize=new d.vpe,this.initRedraw=new d.vpe,this.beforeDrawing=new d.vpe,this.afterDrawing=new d.vpe,this.animationFinished=new d.vpe,this.configChange=new d.vpe,this.networks={}}create(t,e,i,n){if(this.networks[t])throw new Error(`Network with id ${t} already exists.`);this.networks[t]=new Et.Network(e,i,n)}destroy(t){this.networks[t]&&(this.networks[t].destroy(),delete this.networks[t])}on(t,e,i){if(this.networks[t]){const n=this;return this.networks[t].on(e,o=>{const r=n[e];r&&r.emit(o?[t].concat(o):t),i&&o.event&&o.event.preventDefault()}),!0}return!1}off(t,e){this.networks[t]&&this.networks[t].off(e)}once(t,e){if(this.networks[t]){const i=this;return this.networks[t].on(e,n=>{const o=i[e];o&&(o.emit(n?[t].concat(n):t),this.off(t,e))}),!0}return!1}setData(t,e){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].setData(e)}setOptions(t,e){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].setOptions(e)}selectNodes(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].selectNodes(e,i)}setSelection(t,e,i={}){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].setSelection(e,i)}getSelection(t){if(this.networks[t])return this.networks[t].getSelection()}getSelectedNodes(t){if(this.networks[t])return this.networks[t].getSelectedNodes()}getSelectedEdges(t){if(this.networks[t])return this.networks[t].getSelectedEdges()}unselectAll(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].unselectAll()}fit(t,e){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].fit(e)}redraw(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].redraw()}addNodeMode(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].addNodeMode()}enableEditMode(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].enableEditMode()}addEdgeMode(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].addEdgeMode()}disableEditMode(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].disableEditMode()}deleteSelected(t){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].deleteSelected()}cluster(t,e){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].cluster(e)}clusterByConnection(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].clusterByConnection(e,i)}clusterByHubsize(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].clusterByHubsize(e,i)}clusterOutliers(t,e){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].clusterOutliers(e)}findNode(t,e){if(this.networks[t])return this.networks[t].findNode(e);throw new Error(`Network with id ${t} not found.`)}getClusteredEdges(t,e){if(this.networks[t])return this.networks[t].getClusteredEdges(e);throw new Error(`Network with id ${t} not found.`)}getBaseEdge(t,e){if(this.networks[t])return this.networks[t].getBaseEdge(e);throw new Error(`Network with id ${t} not found.`)}updateEdge(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].updateEdge(e,i)}updateClusteredNode(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].updateClusteredNode(e,i)}getNodesInCluster(t,e){if(this.networks[t])return this.networks[t].getNodesInCluster(e);throw new Error(`Network with id ${t} not found.`)}openCluster(t,e,i){if(!this.networks[t])throw new Error(`Network with id ${t} not found.`);this.networks[t].openCluster(e,i)}isCluster(t,e){return!!this.networks[t]&&this.networks[t].isCluster(e)}getSeed(t){return this.networks[t]?this.networks[t].getSeed():-1}canvasToDOM(t,e){return this.networks[t].canvasToDOM(e)}DOMtoCanvas(t,e){return this.networks[t].DOMtoCanvas(e)}getNodeAt(t,e){return this.networks[t].getNodeAt(e)}getEdgeAt(t,e){return this.networks[t].getEdgeAt(e)}getConnectedEdges(t,e){return this.networks[t].getConnectedEdges(e)}getConnectedNodes(t,e){return this.networks[t].getConnectedNodes(e)}getPositions(t,e){return this.networks[t].getPositions(e)}getBoundingBox(t,e){return this.networks[t].getBoundingBox(e)}storePositions(t){return this.networks[t].storePositions()}moveTo(t,e){return this.networks[t].moveTo(e)}startSimulation(t){return this.networks[t].startSimulation()}stopSimulation(t){return this.networks[t].stopSimulation()}getScale(t){if(this.networks[t])return this.networks[t].getScale();throw new Error(`Network with id ${t} not found.`)}};return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=d.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t})(),At=(()=>{let t=class{constructor(t){this.ngZone=t,this.currentTimeTick=new d.vpe,this.click=new d.vpe,this.contextmenu=new d.vpe,this.doubleClick=new d.vpe,this.groupDragged=new d.vpe,this.changed=new d.vpe,this.rangechange=new d.vpe,this.rangechanged=new d.vpe,this.select=new d.vpe,this.itemover=new d.vpe,this.itemout=new d.vpe,this.timechange=new d.vpe,this.timechanged=new d.vpe,this.events=new Map,this.timelines={}}createWithItems(t,e,i,n){if(this.timelines[t])throw new Error(this.alreadyExistsError(t));this.timelines[t]=this.ngZone.runOutsideAngular(()=>new Tt.Timeline(e,i,n))}createWithItemsAndGroups(t,e,i,n,o){if(this.timelines[t])throw new Error(this.alreadyExistsError(t));this.timelines[t]=this.ngZone.runOutsideAngular(()=>new Tt.Timeline(e,i,n,o))}addCustomTime(t,e,i){if(this.timelines[t])return this.timelines[t].addCustomTime(e,i);throw new Error(this.doesNotExistError(t))}fit(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].fit(e)}focusOnId(t,e,i){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].focus(e,i)}focusOnIds(t,e,i){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].focus(e,i)}getCurrentTime(t){if(this.timelines[t])return this.timelines[t].getCurrentTime();throw new Error(this.doesNotExistError(t))}getCustomTime(t,e){if(this.timelines[t])return this.timelines[t].getCustomTime(e);throw new Error(this.doesNotExistError(t))}getEventProperties(t,e){if(this.timelines[t])return this.timelines[t].getEventProperties(e);throw new Error(this.doesNotExistError(t))}getItemRange(t){if(this.timelines[t])return this.timelines[t].getItemRange();throw new Error(this.doesNotExistError(t))}getSelection(t){if(this.timelines[t])return this.timelines[t].getSelection();throw new Error(this.doesNotExistError(t))}getVisibleItems(t){if(this.timelines[t])return this.timelines[t].getVisibleItems();throw new Error(this.doesNotExistError(t))}getWindow(t){if(this.timelines[t])return this.timelines[t].getWindow();throw new Error(this.doesNotExistError(t))}moveTo(t,e,i){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].moveTo(e,i)}redraw(t){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].redraw()}removeCustomTime(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].removeCustomTime(e)}setCurrentTime(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setCurrentTime(e)}setCustomTime(t,e,i){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setCustomTime(e,i)}setCustomTimeTitle(t,e,i){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setCustomTimeTitle(e,i)}setData(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setData(e)}setGroups(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setGroups(e)}setItems(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setItems(e)}setOptions(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setOptions(e)}setSelectionToId(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setSelection(e)}setSelectionToIds(t,e){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setSelection(e)}setWindow(t,e,i,n){if(!this.timelines[t])throw new Error(this.doesNotExistError(t));this.timelines[t].setWindow(e,i,n)}destroy(t){this.timelines[t]&&(this.timelines[t].destroy(),delete this.timelines[t])}on(t,e,i){if(this.timelines[t]){this.events.set(e,new d.vpe);const n=this;return this.timelines[t].on(e,o=>{const r=n[e]||n.events.get(e);r&&r.emit(o?[t].concat(o):t),i&&o.event&&o.event.preventDefault()}),!0}return!1}off(t,e){this.timelines[t]&&(this.events.delete(e),this.timelines[t].off(e,void 0))}getEmitter(t){return this.events.get(t)}doesNotExistError(t){return`Timeline with id ${t} does not exist.`}alreadyExistsError(t){return`Timeline with id ${t} already exists.`}};return t.\u0275fac=function(e){return new(e||t)(d.LFG(d.R0b))},t.\u0275prov=d.Yz7({token:t,factory:function(e){return t.\u0275fac(e)}}),t})(),Ot=(()=>{let t=class{};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({providers:[St,At],imports:[[n.ez]]}),t})(),It=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[[n.ez,xt,r.m,l.T,s.DataManagersModule,a.d,Ct.xD,o.u5,Ot]]}),t})()},6341:(t,e)=>{!function(t){const e=t.en=t.en||{};e.dictionary=Object.assign(e.dictionary||{},{"%0 of %1":"%0 of %1","Align center":"Align center","Align left":"Align left","Align right":"Align right",Aquamarine:"Aquamarine",Big:"Big",Black:"Black","Block quote":"Block quote",Blue:"Blue",Bold:"Bold","Break text":"Break text","Bulleted List":"Bulleted List","Bulleted list styles toolbar":"Bulleted list styles toolbar",Cancel:"Cancel","Cannot upload file:":"Cannot upload file:","Centered image":"Centered image","Change image text alternative":"Change image text alternative","Choose heading":"Choose heading",Circle:"Circle",Column:"Column","Could not insert image at the current position.":"Could not insert image at the current position.","Could not obtain resized image URL.":"Could not obtain resized image URL.",Decimal:"Decimal","Decimal with leading zero":"Decimal with leading zero","Decrease indent":"Decrease indent",Default:"Default","Delete column":"Delete column","Delete row":"Delete row","Dim grey":"Dim grey",Disc:"Disc","Document colors":"Document colors",Downloadable:"Downloadable","Dropdown toolbar":"Dropdown toolbar","Edit block":"Edit block","Edit link":"Edit link","Editor toolbar":"Editor toolbar","Enter image caption":"Enter image caption","Font Background Color":"Font Background Color","Font Color":"Font Color","Font Family":"Font Family","Font Size":"Font Size","Full size image":"Full size image",Green:"Green",Grey:"Grey","Header column":"Header column","Header row":"Header row",Heading:"Heading","Heading 1":"Heading 1","Heading 2":"Heading 2","Heading 3":"Heading 3","Heading 4":"Heading 4","Heading 5":"Heading 5","Heading 6":"Heading 6",Huge:"Huge","Image resize list":"Image resize list","Image toolbar":"Image toolbar","image widget":"image widget","In line":"In line","Increase indent":"Increase indent","Insert column left":"Insert column left","Insert column right":"Insert column right","Insert image":"Insert image","Insert image or file":"Insert image or file","Insert media":"Insert media","Insert paragraph after block":"Insert paragraph after block","Insert paragraph before block":"Insert paragraph before block","Insert row above":"Insert row above","Insert row below":"Insert row below","Insert table":"Insert table","Inserting image failed":"Inserting image failed",Italic:"Italic",Justify:"Justify","Left aligned image":"Left aligned image","Light blue":"Light blue","Light green":"Light green","Light grey":"Light grey",Link:"Link","Link URL":"Link URL","Lower-latin":"Lower-latin","Lower\u2013roman":"Lower\u2013roman","Media URL":"Media URL","media widget":"media widget","Merge cell down":"Merge cell down","Merge cell left":"Merge cell left","Merge cell right":"Merge cell right","Merge cell up":"Merge cell up","Merge cells":"Merge cells",Next:"Next","Numbered List":"Numbered List","Numbered list styles toolbar":"Numbered list styles toolbar","Open in a new tab":"Open in a new tab","Open link in new tab":"Open link in new tab",Orange:"Orange",Original:"Original",Paragraph:"Paragraph","Paste the media URL in the input.":"Paste the media URL in the input.",Previous:"Previous",Purple:"Purple",Red:"Red",Redo:"Redo","Remove color":"Remove color","Resize image":"Resize image","Resize image to %0":"Resize image to %0","Resize image to the original size":"Resize image to the original size","Rich Text Editor":"Rich Text Editor","Rich Text Editor, %0":"Rich Text Editor, %0","Right aligned image":"Right aligned image",Row:"Row",Save:"Save","Select all":"Select all","Select column":"Select column","Select row":"Select row","Selecting resized image failed":"Selecting resized image failed","Show more items":"Show more items","Side image":"Side image",Small:"Small","Split cell horizontally":"Split cell horizontally","Split cell vertically":"Split cell vertically",Square:"Square",Strikethrough:"Strikethrough","Table toolbar":"Table toolbar","Text alignment":"Text alignment","Text alignment toolbar":"Text alignment toolbar","Text alternative":"Text alternative","The URL must not be empty.":"The URL must not be empty.","This link has no URL":"This link has no URL","This media URL is not supported.":"This media URL is not supported.",Tiny:"Tiny","Tip: Paste the URL into the content to embed faster.":"Tip: Paste the URL into the content to embed faster.","Toggle caption off":"Toggle caption off","Toggle caption on":"Toggle caption on","Toggle the circle list style":"Toggle the circle list style","Toggle the decimal list style":"Toggle the decimal list style","Toggle the decimal with leading zero list style":"Toggle the decimal with leading zero list style","Toggle the disc list style":"Toggle the disc list style","Toggle the lower\u2013latin list style":"Toggle the lower\u2013latin list style","Toggle the lower\u2013roman list style":"Toggle the lower\u2013roman list style","Toggle the square list style":"Toggle the square list style","Toggle the upper\u2013latin list style":"Toggle the upper\u2013latin list style","Toggle the upper\u2013roman list style":"Toggle the upper\u2013roman list style",Turquoise:"Turquoise",Underline:"Underline",Undo:"Undo",Unlink:"Unlink","Upload failed":"Upload failed","Upload in progress":"Upload in progress","Upper-latin":"Upper-latin","Upper-roman":"Upper-roman",White:"White","Widget toolbar":"Widget toolbar","Wrap text":"Wrap text",Yellow:"Yellow"})}(window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={})),window,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,(function(e){return t[e]}).bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=120)}([function(t,e,i){"use strict";i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o});class n extends Error{constructor(t,e,i){super(function(t,e){const i=new WeakSet;return t+(e?" "+JSON.stringify(e,(t,e)=>{if("object"==typeof e&&null!==e){if(i.has(e))return`[object ${e.constructor.name}]`;i.add(e)}return e}):"")+r(t)}(t,i)),this.name="CKEditorError",this.context=e,this.data=i}is(t){return"CKEditorError"===t}static rethrowUnexpectedError(t,e){if(t.is&&t.is("CKEditorError"))throw t;const i=new n(t.message,e);throw i.stack=t.stack,i}}function o(t,e){console.warn(...function(t,e){const i=r(t);return e?[t,e,i]:[t,i]}(t,e))}function r(t){return"\nRead more: https://ckeditor.com/docs/ckeditor5/latest/framework/guides/support/error-codes.html#error-"+t}},function(t,e,i){"use strict";var n,o=function(){var t={};return function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}t[e]=i}return t[e]}}(),r=[];function s(t){for(var e=-1,i=0;i<r.length;i++)if(r[i].identifier===t){e=i;break}return e}function a(t,e){for(var i={},n=[],o=0;o<t.length;o++){var a=t[o],l=e.base?a[0]+e.base:a[0],c=i[l]||0,h="".concat(l," ").concat(c);i[l]=c+1;var d=s(h),u={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(r[d].references++,r[d].updater(u)):r.push({identifier:h,updater:g(u,e),references:1}),n.push(h)}return n}function l(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var r=i.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach(function(t){e.setAttribute(t,n[t])}),"function"==typeof t.insert)t.insert(e);else{var s=o(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var c,h=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function d(t,e,i,n){var o=i?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=h(e,o);else{var r=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function u(t,e,i){var n=i.css,o=i.media,r=i.sourceMap;if(o?t.setAttribute("media",o):t.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var f=null,p=0;function g(t,e){var i,n,o;if(e.singleton){var r=p++;i=f||(f=l(e)),n=d.bind(null,i,r,!1),o=d.bind(null,i,r,!0)}else i=l(e),n=u.bind(null,i,e),o=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(i)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var i=a(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<i.length;n++){var o=s(i[n]);r[o].references--}for(var l=a(t,e),c=0;c<i.length;c++){var h=s(i[c]);0===r[h].references&&(r[h].updater(),r.splice(h,1))}i=l}}}},,function(t,e,i){"use strict";var n=i(8),o="object"==typeof self&&self&&self.Object===Object&&self,r=n.a||o||Function("return this")();e.a=r},function(t,i,n){"use strict";(function(t){var o=n(3),r=n(14),s=e&&!e.nodeType&&e,a=s&&"object"==typeof t&&t&&!t.nodeType&&t,l=a&&a.exports===s?o.a.Buffer:void 0;i.a=(l?l.isBuffer:void 0)||r.a}).call(this,n(10)(t))},function(t,i,n){"use strict";(function(t){var o=n(8),r=e&&!e.nodeType&&e,s=r&&"object"==typeof t&&t&&!t.nodeType&&t,a=s&&s.exports===r&&o.a.process,l=function(){try{return s&&s.require&&s.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();i.a=l}).call(this,n(10)(t))},function(t,e,i){"use strict";(function(t){var e=i(0);const n="object"==typeof window?window:t;if(n.CKEDITOR_VERSION)throw new e.a("ckeditor-duplicated-modules",null);n.CKEDITOR_VERSION="31.0.0"}).call(this,i(12))},function(t,e,i){var n=i(1),o=i(80);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e,i){"use strict";(function(t){e.a="object"==typeof t&&t&&t.Object===Object&&t}).call(this,i(12))},function(t,i,n){"use strict";(function(t){var o=n(3),r=e&&!e.nodeType&&e,s=r&&"object"==typeof t&&t&&!t.nodeType&&t,a=s&&s.exports===r?o.a.Buffer:void 0,l=a?a.allocUnsafe:void 0;i.a=function(t,e){if(e)return t.slice();var i=t.length,n=l?l(i):new t.constructor(i);return t.copy(n),n}}).call(this,n(10)(t))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,i){var n=i(1),o=i(81);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n=i(1),o=i(75);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e,i){"use strict";e.a=function(){return!1}},function(t,e,i){var n=i(1),o=i(16);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-editor__editable span[data-ck-hidden]{display:none}"},function(t,e,i){var n=i(1),o=i(18);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-hidden{display:none!important}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{box-sizing:border-box;width:auto;height:auto;position:static}:root{--ck-z-default:1;--ck-z-modal:calc(var(--ck-z-default) + 999)}.ck-transitions-disabled,.ck-transitions-disabled *{transition:none!important}:root{--ck-color-base-foreground:#fafafa;--ck-color-base-background:#fff;--ck-color-base-border:#c4c4c4;--ck-color-base-action:#61b045;--ck-color-base-focus:#6cb5f9;--ck-color-base-text:#333;--ck-color-base-active:#198cf0;--ck-color-base-active-focus:#0e7fe1;--ck-color-base-error:#db3700;--ck-color-focus-border-coordinates:208,79%,51%;--ck-color-focus-border:hsl(var(--ck-color-focus-border-coordinates));--ck-color-focus-outer-shadow:#bcdefb;--ck-color-focus-disabled-shadow:rgba(119,186,248,0.3);--ck-color-focus-error-shadow:rgba(255,64,31,0.3);--ck-color-text:var(--ck-color-base-text);--ck-color-shadow-drop:rgba(0,0,0,0.15);--ck-color-shadow-drop-active:rgba(0,0,0,0.2);--ck-color-shadow-inner:rgba(0,0,0,0.1);--ck-color-button-default-background:transparent;--ck-color-button-default-hover-background:#e6e6e6;--ck-color-button-default-active-background:#d9d9d9;--ck-color-button-default-active-shadow:#bfbfbf;--ck-color-button-default-disabled-background:transparent;--ck-color-button-on-background:#dedede;--ck-color-button-on-hover-background:#c4c4c4;--ck-color-button-on-active-background:#bababa;--ck-color-button-on-active-shadow:#a1a1a1;--ck-color-button-on-disabled-background:#dedede;--ck-color-button-action-background:var(--ck-color-base-action);--ck-color-button-action-hover-background:#579e3d;--ck-color-button-action-active-background:#53973b;--ck-color-button-action-active-shadow:#498433;--ck-color-button-action-disabled-background:#7ec365;--ck-color-button-action-text:var(--ck-color-base-background);--ck-color-button-save:#008a00;--ck-color-button-cancel:#db3700;--ck-color-switch-button-off-background:#b0b0b0;--ck-color-switch-button-off-hover-background:#a3a3a3;--ck-color-switch-button-on-background:var(--ck-color-button-action-background);--ck-color-switch-button-on-hover-background:#579e3d;--ck-color-switch-button-inner-background:var(--ck-color-base-background);--ck-color-switch-button-inner-shadow:rgba(0,0,0,0.1);--ck-color-dropdown-panel-background:var(--ck-color-base-background);--ck-color-dropdown-panel-border:var(--ck-color-base-border);--ck-color-input-background:var(--ck-color-base-background);--ck-color-input-border:#c7c7c7;--ck-color-input-error-border:var(--ck-color-base-error);--ck-color-input-text:var(--ck-color-base-text);--ck-color-input-disabled-background:#f2f2f2;--ck-color-input-disabled-border:#c7c7c7;--ck-color-input-disabled-text:#757575;--ck-color-list-background:var(--ck-color-base-background);--ck-color-list-button-hover-background:var(--ck-color-button-default-hover-background);--ck-color-list-button-on-background:var(--ck-color-base-active);--ck-color-list-button-on-background-focus:var(--ck-color-base-active-focus);--ck-color-list-button-on-text:var(--ck-color-base-background);--ck-color-panel-background:var(--ck-color-base-background);--ck-color-panel-border:var(--ck-color-base-border);--ck-color-toolbar-background:var(--ck-color-base-foreground);--ck-color-toolbar-border:var(--ck-color-base-border);--ck-color-tooltip-background:var(--ck-color-base-text);--ck-color-tooltip-text:var(--ck-color-base-background);--ck-color-engine-placeholder-text:#707070;--ck-color-upload-bar-background:#6cb5f9;--ck-color-link-default:#0000f0;--ck-color-link-selected-background:rgba(31,177,255,0.1);--ck-color-link-fake-selection:rgba(31,177,255,0.3);--ck-disabled-opacity:.5;--ck-focus-outer-shadow-geometry:0 0 0 3px;--ck-focus-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-outer-shadow);--ck-focus-disabled-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-disabled-shadow);--ck-focus-error-outer-shadow:var(--ck-focus-outer-shadow-geometry) var(--ck-color-focus-error-shadow);--ck-focus-ring:1px solid var(--ck-color-focus-border);--ck-font-size-base:13px;--ck-line-height-base:1.84615;--ck-font-face:Helvetica,Arial,Tahoma,Verdana,Sans-Serif;--ck-font-size-tiny:0.7em;--ck-font-size-small:0.75em;--ck-font-size-normal:1em;--ck-font-size-big:1.4em;--ck-font-size-large:1.8em;--ck-ui-component-min-height:2.3em}.ck.ck-reset,.ck.ck-reset_all,.ck.ck-reset_all *{margin:0;padding:0;border:0;background:transparent;text-decoration:none;vertical-align:middle;transition:none;word-wrap:break-word}.ck.ck-reset_all,.ck.ck-reset_all *{border-collapse:collapse;font:normal normal normal var(--ck-font-size-base)/var(--ck-line-height-base) var(--ck-font-face);color:var(--ck-color-text);text-align:left;white-space:nowrap;cursor:auto;float:none}.ck.ck-reset_all .ck-rtl *{text-align:right}.ck.ck-reset_all iframe{vertical-align:inherit}.ck.ck-reset_all textarea{white-space:pre-wrap}.ck.ck-reset_all input[type=password],.ck.ck-reset_all input[type=text],.ck.ck-reset_all textarea{cursor:text}.ck.ck-reset_all input[type=password][disabled],.ck.ck-reset_all input[type=text][disabled],.ck.ck-reset_all textarea[disabled]{cursor:default}.ck.ck-reset_all fieldset{padding:10px;border:2px groove #dfdee3}.ck.ck-reset_all button::-moz-focus-inner{padding:0;border:0}.ck[dir=rtl],.ck[dir=rtl] .ck{text-align:right}:root{--ck-border-radius:2px;--ck-inner-shadow:2px 2px 3px var(--ck-color-shadow-inner) inset;--ck-drop-shadow:0 1px 2px 1px var(--ck-color-shadow-drop);--ck-drop-shadow-active:0 3px 6px 1px var(--ck-color-shadow-drop-active);--ck-spacing-unit:0.6em;--ck-spacing-large:calc(var(--ck-spacing-unit)*1.5);--ck-spacing-standard:var(--ck-spacing-unit);--ck-spacing-medium:calc(var(--ck-spacing-unit)*0.8);--ck-spacing-small:calc(var(--ck-spacing-unit)*0.5);--ck-spacing-tiny:calc(var(--ck-spacing-unit)*0.3);--ck-spacing-extra-tiny:calc(var(--ck-spacing-unit)*0.16)}"},function(t,e,i){var n=i(1),o=i(20);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-icon{vertical-align:middle}:root{--ck-icon-size:calc(var(--ck-line-height-base)*var(--ck-font-size-normal))}.ck.ck-icon{width:var(--ck-icon-size);height:var(--ck-icon-size);font-size:.8333350694em;will-change:transform}.ck.ck-icon,.ck.ck-icon *{color:inherit;cursor:inherit}.ck.ck-icon :not([fill]){fill:currentColor}"},function(t,e,i){var n=i(1),o=i(22);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck.ck-tooltip,.ck.ck-tooltip .ck-tooltip__text:after{position:absolute;pointer-events:none;-webkit-backface-visibility:hidden}.ck.ck-tooltip{visibility:hidden;opacity:0;display:none;z-index:var(--ck-z-modal)}.ck.ck-tooltip .ck-tooltip__text{display:inline-block}.ck.ck-tooltip .ck-tooltip__text:after{content:"";width:0;height:0}:root{--ck-tooltip-arrow-size:5px}.ck.ck-tooltip{left:50%;top:0;transition:opacity .2s ease-in-out .2s}.ck.ck-tooltip .ck-tooltip__text{border-radius:0}.ck-rounded-corners .ck.ck-tooltip .ck-tooltip__text,.ck.ck-tooltip .ck-tooltip__text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-tooltip .ck-tooltip__text{font-size:.9em;line-height:1.5;color:var(--ck-color-tooltip-text);padding:var(--ck-spacing-small) var(--ck-spacing-medium);background:var(--ck-color-tooltip-background);position:relative;left:-50%}.ck.ck-tooltip .ck-tooltip__text:after{transition:opacity .2s ease-in-out .2s;border-style:solid;left:50%}.ck.ck-tooltip.ck-tooltip_s,.ck.ck-tooltip.ck-tooltip_se,.ck.ck-tooltip.ck-tooltip_sw{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(100%)}.ck.ck-tooltip.ck-tooltip_s .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after,.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{top:calc(var(--ck-tooltip-arrow-size)*-1 + 1px);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:var(--ck-color-tooltip-background);border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:0}.ck.ck-tooltip.ck-tooltip_sw{right:50%;left:auto}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text{left:auto;right:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_sw .ck-tooltip__text:after{left:auto;right:0}.ck.ck-tooltip.ck-tooltip_se{left:50%;right:auto}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text{right:auto;left:calc(var(--ck-tooltip-arrow-size)*-2)}.ck.ck-tooltip.ck-tooltip_se .ck-tooltip__text:after{right:auto;left:0;transform:translateX(50%)}.ck.ck-tooltip.ck-tooltip_n{top:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateY(-100%)}.ck.ck-tooltip.ck-tooltip_n .ck-tooltip__text:after{bottom:calc(var(--ck-tooltip-arrow-size)*-1);transform:translateX(-50%);border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent;border-top-color:var(--ck-color-tooltip-background);border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:0;border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_e{left:calc(100% + var(--ck-tooltip-arrow-size));top:50%}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_e .ck-tooltip__text:after{left:calc(var(--ck-tooltip-arrow-size)*-1);top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:transparent;border-bottom-color:transparent;border-right-color:var(--ck-color-tooltip-background);border-top-color:transparent;border-left-width:0;border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:var(--ck-tooltip-arrow-size);border-top-width:var(--ck-tooltip-arrow-size)}.ck.ck-tooltip.ck-tooltip_w{right:calc(100% + var(--ck-tooltip-arrow-size));left:auto;top:50%}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text{left:0;transform:translateY(-50%)}.ck.ck-tooltip.ck-tooltip_w .ck-tooltip__text:after{left:100%;top:calc(50% - var(--ck-tooltip-arrow-size)*1);border-left-color:var(--ck-color-tooltip-background);border-bottom-color:transparent;border-right-color:transparent;border-top-color:transparent;border-left-width:var(--ck-tooltip-arrow-size);border-bottom-width:var(--ck-tooltip-arrow-size);border-right-width:0;border-top-width:var(--ck-tooltip-arrow-size)}'},function(t,e,i){var n=i(1),o=i(24);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-button,a.ck.ck-button{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:block}@media (hover:none){.ck.ck-button .ck-tooltip,a.ck.ck-button .ck-tooltip{display:none}}.ck.ck-button,a.ck.ck-button{position:relative;display:inline-flex;align-items:center;justify-content:left}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{display:none}.ck.ck-button.ck-button_with-text .ck-button__label,a.ck.ck-button.ck-button_with-text .ck-button__label{display:inline-block}.ck.ck-button:not(.ck-button_with-text),a.ck.ck-button:not(.ck-button_with-text){justify-content:center}.ck.ck-button:hover .ck-tooltip,a.ck.ck-button:hover .ck-tooltip{visibility:visible;opacity:1}.ck.ck-button:focus:not(:hover) .ck-tooltip,a.ck.ck-button:focus:not(:hover) .ck-tooltip{display:none}.ck.ck-button,a.ck.ck-button{background:var(--ck-color-button-default-background)}.ck.ck-button:not(.ck-disabled):hover,a.ck.ck-button:not(.ck-disabled):hover{background:var(--ck-color-button-default-hover-background)}.ck.ck-button:not(.ck-disabled):active,a.ck.ck-button:not(.ck-disabled):active{background:var(--ck-color-button-default-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-default-active-shadow)}.ck.ck-button.ck-disabled,a.ck.ck-button.ck-disabled{background:var(--ck-color-button-default-disabled-background)}.ck.ck-button,a.ck.ck-button{border-radius:0}.ck-rounded-corners .ck.ck-button,.ck-rounded-corners a.ck.ck-button,.ck.ck-button.ck-rounded-corners,a.ck.ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-button,a.ck.ck-button{white-space:nowrap;cursor:default;vertical-align:middle;padding:var(--ck-spacing-tiny);text-align:center;min-width:var(--ck-ui-component-min-height);min-height:var(--ck-ui-component-min-height);line-height:1;font-size:inherit;border:1px solid transparent;transition:box-shadow .2s ease-in-out,border .2s ease-in-out;-webkit-appearance:none}.ck.ck-button:active,.ck.ck-button:focus,a.ck.ck-button:active,a.ck.ck-button:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-button .ck-button__icon use,.ck.ck-button .ck-button__icon use *,a.ck.ck-button .ck-button__icon use,a.ck.ck-button .ck-button__icon use *{color:inherit}.ck.ck-button .ck-button__label,a.ck.ck-button .ck-button__label{font-size:inherit;font-weight:inherit;color:inherit;cursor:inherit;vertical-align:middle}[dir=ltr] .ck.ck-button .ck-button__label,[dir=ltr] a.ck.ck-button .ck-button__label{text-align:left}[dir=rtl] .ck.ck-button .ck-button__label,[dir=rtl] a.ck.ck-button .ck-button__label{text-align:right}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{color:inherit}[dir=ltr] .ck.ck-button .ck-button__keystroke,[dir=ltr] a.ck.ck-button .ck-button__keystroke{margin-left:var(--ck-spacing-large)}[dir=rtl] .ck.ck-button .ck-button__keystroke,[dir=rtl] a.ck.ck-button .ck-button__keystroke{margin-right:var(--ck-spacing-large)}.ck.ck-button .ck-button__keystroke,a.ck.ck-button .ck-button__keystroke{font-weight:700;opacity:.7}.ck.ck-button.ck-disabled:active,.ck.ck-button.ck-disabled:focus,a.ck.ck-button.ck-disabled:active,a.ck.ck-button.ck-disabled:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-button.ck-disabled .ck-button__icon,a.ck.ck-button.ck-disabled .ck-button__icon{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__label,a.ck.ck-button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-disabled .ck-button__keystroke,a.ck.ck-button.ck-disabled .ck-button__keystroke{opacity:.3}.ck.ck-button.ck-button_with-text,a.ck.ck-button.ck-button_with-text{padding:var(--ck-spacing-tiny) var(--ck-spacing-standard)}[dir=ltr] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=ltr] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-left:calc(var(--ck-spacing-small)*-1);margin-right:var(--ck-spacing-small)}[dir=rtl] .ck.ck-button.ck-button_with-text .ck-button__icon,[dir=rtl] a.ck.ck-button.ck-button_with-text .ck-button__icon{margin-right:calc(var(--ck-spacing-small)*-1);margin-left:var(--ck-spacing-small)}.ck.ck-button.ck-button_with-keystroke .ck-button__label,a.ck.ck-button.ck-button_with-keystroke .ck-button__label{flex-grow:1}.ck.ck-button.ck-on,a.ck.ck-button.ck-on{background:var(--ck-color-button-on-background)}.ck.ck-button.ck-on:not(.ck-disabled):hover,a.ck.ck-button.ck-on:not(.ck-disabled):hover{background:var(--ck-color-button-on-hover-background)}.ck.ck-button.ck-on:not(.ck-disabled):active,a.ck.ck-button.ck-on:not(.ck-disabled):active{background:var(--ck-color-button-on-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-on-active-shadow)}.ck.ck-button.ck-on.ck-disabled,a.ck.ck-button.ck-on.ck-disabled{background:var(--ck-color-button-on-disabled-background)}.ck.ck-button.ck-button-save,a.ck.ck-button.ck-button-save{color:var(--ck-color-button-save)}.ck.ck-button.ck-button-cancel,a.ck.ck-button.ck-button-cancel{color:var(--ck-color-button-cancel)}.ck.ck-button-action,a.ck.ck-button-action{background:var(--ck-color-button-action-background)}.ck.ck-button-action:not(.ck-disabled):hover,a.ck.ck-button-action:not(.ck-disabled):hover{background:var(--ck-color-button-action-hover-background)}.ck.ck-button-action:not(.ck-disabled):active,a.ck.ck-button-action:not(.ck-disabled):active{background:var(--ck-color-button-action-active-background);box-shadow:inset 0 2px 2px var(--ck-color-button-action-active-shadow)}.ck.ck-button-action.ck-disabled,a.ck.ck-button-action.ck-disabled{background:var(--ck-color-button-action-disabled-background)}.ck.ck-button-action,a.ck.ck-button-action{color:var(--ck-color-button-action-text)}.ck.ck-button-bold,a.ck.ck-button-bold{font-weight:700}"},function(t,e,i){var n=i(1),o=i(26);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{display:block}:root{--ck-switch-button-toggle-width:2.6153846154em;--ck-switch-button-toggle-inner-size:1.0769230769em;--ck-switch-button-toggle-spacing:1px;--ck-switch-button-translation:calc(var(--ck-switch-button-toggle-width) - var(--ck-switch-button-toggle-inner-size) - var(--ck-switch-button-toggle-spacing)*2)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__label{margin-right:calc(var(--ck-spacing-large)*2)}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__label{margin-left:calc(var(--ck-spacing-large)*2)}.ck.ck-button.ck-switchbutton .ck-button__toggle{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle,.ck.ck-button.ck-switchbutton .ck-button__toggle.ck-rounded-corners{border-radius:var(--ck-border-radius)}[dir=ltr] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-left:auto}[dir=rtl] .ck.ck-button.ck-switchbutton .ck-button__toggle{margin-right:auto}.ck.ck-button.ck-switchbutton .ck-button__toggle{transition:background .4s ease;width:var(--ck-switch-button-toggle-width);background:var(--ck-color-switch-button-off-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{border-radius:0}.ck-rounded-corners .ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner,.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner.ck-rounded-corners{border-radius:var(--ck-border-radius);border-radius:calc(var(--ck-border-radius)*0.5)}.ck.ck-button.ck-switchbutton .ck-button__toggle .ck-button__toggle__inner{margin:var(--ck-switch-button-toggle-spacing);width:var(--ck-switch-button-toggle-inner-size);height:var(--ck-switch-button-toggle-inner-size);background:var(--ck-color-switch-button-inner-background);transition:all .3s ease}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover{background:var(--ck-color-switch-button-off-hover-background)}.ck.ck-button.ck-switchbutton .ck-button__toggle:hover .ck-button__toggle__inner{box-shadow:0 0 0 5px var(--ck-color-switch-button-inner-shadow)}.ck.ck-button.ck-switchbutton.ck-disabled .ck-button__toggle{opacity:var(--ck-disabled-opacity)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle{background:var(--ck-color-switch-button-on-background)}.ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle:hover{background:var(--ck-color-switch-button-on-hover-background)}[dir=ltr] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(var(--ck-switch-button-translation))}[dir=rtl] .ck.ck-button.ck-switchbutton.ck-on .ck-button__toggle .ck-button__toggle__inner{transform:translateX(calc(var(--ck-switch-button-translation)*-1))}"},function(t,e,i){var n=i(1),o=i(28);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-color-grid{display:grid}:root{--ck-color-grid-tile-size:24px;--ck-color-color-grid-check-icon:#000}.ck.ck-color-grid{grid-gap:5px;padding:8px}.ck.ck-color-grid__tile{width:var(--ck-color-grid-tile-size);height:var(--ck-color-grid-tile-size);min-width:var(--ck-color-grid-tile-size);min-height:var(--ck-color-grid-tile-size);padding:0;transition:box-shadow .2s ease;border:0}.ck.ck-color-grid__tile.ck-disabled{cursor:unset;transition:unset}.ck.ck-color-grid__tile.ck-color-table__color-tile_bordered{box-shadow:0 0 0 1px var(--ck-color-base-border)}.ck.ck-color-grid__tile .ck.ck-icon{display:none;color:var(--ck-color-color-grid-check-icon)}.ck.ck-color-grid__tile.ck-on{box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-base-text)}.ck.ck-color-grid__tile.ck-on .ck.ck-icon{display:block}.ck.ck-color-grid__tile.ck-on,.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){border:0}.ck.ck-color-grid__tile:focus:not(.ck-disabled),.ck.ck-color-grid__tile:hover:not(.ck-disabled){box-shadow:inset 0 0 0 1px var(--ck-color-base-background),0 0 0 2px var(--ck-color-focus-border)}.ck.ck-color-grid__label{padding:0 var(--ck-spacing-standard)}"},function(t,e,i){var n=i(1),o=i(30);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck.ck-splitbutton{font-size:inherit}.ck.ck-splitbutton .ck-splitbutton__action:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button .ck-tooltip{display:none}:root{--ck-color-split-button-hover-background:#ebebeb;--ck-color-split-button-hover-border:#b3b3b3}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__action{border-top-right-radius:unset;border-bottom-right-radius:unset}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__action{border-top-left-radius:unset;border-bottom-left-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow{min-width:unset}[dir=ltr] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-left-radius:unset;border-bottom-left-radius:unset}[dir=rtl] .ck.ck-splitbutton>.ck-splitbutton__arrow{border-top-right-radius:unset;border-bottom-right-radius:unset}.ck.ck-splitbutton>.ck-splitbutton__arrow svg{width:var(--ck-dropdown-arrow-size)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover),.ck.ck-splitbutton:hover>.ck-button:not(.ck-on):not(.ck-disabled):not(:hover){background:var(--ck-color-split-button-hover-background)}.ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{content:"";position:absolute;width:1px;height:100%;background-color:var(--ck-color-split-button-hover-border)}[dir=ltr] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,[dir=ltr] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{left:-1px}[dir=rtl] .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,[dir=rtl] .ck.ck-splitbutton:hover>.ck-splitbutton__arrow:not(.ck-disabled):after{right:-1px}.ck.ck-splitbutton.ck-splitbutton_open{border-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__action,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__action{border-bottom-left-radius:0}.ck-rounded-corners .ck.ck-splitbutton.ck-splitbutton_open>.ck-splitbutton__arrow,.ck.ck-splitbutton.ck-splitbutton_open.ck-rounded-corners>.ck-splitbutton__arrow{border-bottom-right-radius:0}'},function(t,e,i){var n=i(1),o=i(32);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-dropdown-max-width:75vw}.ck.ck-dropdown{display:inline-block;position:relative}.ck.ck-dropdown .ck-dropdown__arrow{pointer-events:none;z-index:var(--ck-z-default)}.ck.ck-dropdown .ck-button.ck-dropdown__button{width:100%}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on .ck-tooltip{display:none}.ck.ck-dropdown .ck-dropdown__panel{-webkit-backface-visibility:hidden;display:none;z-index:var(--ck-z-modal);max-width:var(--ck-dropdown-max-width);position:absolute}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel-visible{display:inline-block}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw{bottom:100%}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{top:100%;bottom:auto}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_ne,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_se{left:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sw{right:0}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_n,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_s{left:50%;transform:translateX(-50%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nmw,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_smw{left:75%;transform:translateX(-75%)}.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_nme,.ck.ck-dropdown .ck-dropdown__panel.ck-dropdown__panel_sme{left:25%;transform:translateX(-25%)}.ck.ck-toolbar .ck-dropdown__panel{z-index:calc(var(--ck-z-modal) + 1)}:root{--ck-dropdown-arrow-size:calc(var(--ck-icon-size)*0.5)}.ck.ck-dropdown{font-size:inherit}.ck.ck-dropdown .ck-dropdown__arrow{width:var(--ck-dropdown-arrow-size)}[dir=ltr] .ck.ck-dropdown .ck-dropdown__arrow{right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-dropdown .ck-dropdown__arrow{left:var(--ck-spacing-standard);margin-right:var(--ck-spacing-small)}.ck.ck-dropdown.ck-disabled .ck-dropdown__arrow{opacity:var(--ck-disabled-opacity)}[dir=ltr] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-left:var(--ck-spacing-small)}[dir=rtl] .ck.ck-dropdown .ck-button.ck-dropdown__button:not(.ck-button_with-text){padding-right:var(--ck-spacing-small)}.ck.ck-dropdown .ck-button.ck-dropdown__button .ck-button__label{width:7em;overflow:hidden;text-overflow:ellipsis}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-disabled .ck-button__label{opacity:var(--ck-disabled-opacity)}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on{border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-dropdown__button_label-width_auto .ck-button__label{width:auto}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active{box-shadow:none}.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-off:active:focus,.ck.ck-dropdown .ck-button.ck-dropdown__button.ck-on:active:focus{box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-dropdown__panel{border-radius:0}.ck-rounded-corners .ck.ck-dropdown__panel,.ck.ck-dropdown__panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-dropdown__panel{box-shadow:var(--ck-drop-shadow),0 0;background:var(--ck-color-dropdown-panel-background);border:1px solid var(--ck-color-dropdown-panel-border);bottom:0;min-width:100%}.ck.ck-dropdown__panel.ck-dropdown__panel_se{border-top-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_sw{border-top-right-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_ne{border-bottom-left-radius:0}.ck.ck-dropdown__panel.ck-dropdown__panel_nw{border-bottom-right-radius:0}"},function(t,e,i){var n=i(1),o=i(34);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-toolbar{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-flow:row nowrap;align-items:center}.ck.ck-toolbar>.ck-toolbar__items{display:flex;flex-flow:row wrap;align-items:center;flex-grow:1}.ck.ck-toolbar .ck.ck-toolbar__separator{display:inline-block}.ck.ck-toolbar .ck.ck-toolbar__separator:first-child,.ck.ck-toolbar .ck.ck-toolbar__separator:last-child{display:none}.ck.ck-toolbar .ck-toolbar__line-break{flex-basis:100%}.ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items{flex-direction:column}.ck.ck-toolbar.ck-toolbar_floating>.ck-toolbar__items{flex-wrap:nowrap}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck-dropdown__button .ck-dropdown__arrow{display:none}.ck.ck-toolbar{border-radius:0}.ck-rounded-corners .ck.ck-toolbar,.ck.ck-toolbar.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-toolbar{background:var(--ck-color-toolbar-background);padding:0 var(--ck-spacing-small);border:1px solid var(--ck-color-toolbar-border)}.ck.ck-toolbar .ck.ck-toolbar__separator{align-self:stretch;width:1px;min-width:1px;background:var(--ck-color-toolbar-border);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar .ck-toolbar__line-break{height:0}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break){margin-right:var(--ck-spacing-small)}.ck.ck-toolbar>.ck-toolbar__items:empty+.ck.ck-toolbar__separator{display:none}.ck.ck-toolbar>.ck-toolbar__items>:not(.ck-toolbar__line-break),.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown{margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck.ck-toolbar.ck-toolbar_vertical{padding:0}.ck.ck-toolbar.ck-toolbar_vertical>.ck-toolbar__items>.ck{width:100%;margin:0;border-radius:0;border:0}.ck.ck-toolbar.ck-toolbar_compact{padding:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>*{margin:0}.ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>:not(:first-child):not(:last-child){border-radius:0}.ck.ck-toolbar>.ck.ck-toolbar__grouped-dropdown>.ck.ck-button.ck-dropdown__button{padding-left:var(--ck-spacing-tiny)}.ck-toolbar-container .ck.ck-toolbar{border:0}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck{margin-right:0}.ck.ck-toolbar[dir=rtl]:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck,[dir=rtl] .ck.ck-toolbar:not(.ck-toolbar_compact)>.ck-toolbar__items>.ck{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl]>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-left:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=rtl].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=rtl] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=rtl]>.ck.ck-toolbar__separator,[dir=rtl] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=rtl].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=rtl] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-left:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr]>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar>.ck-toolbar__items>.ck:last-child{margin-right:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:first-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:first-child{border-top-right-radius:0;border-bottom-right-radius:0}.ck.ck-toolbar[dir=ltr].ck-toolbar_compact>.ck-toolbar__items>.ck:last-child,[dir=ltr] .ck.ck-toolbar.ck-toolbar_compact>.ck-toolbar__items>.ck:last-child{border-top-left-radius:0;border-bottom-left-radius:0}.ck.ck-toolbar[dir=ltr]>.ck.ck-toolbar__separator,[dir=ltr] .ck.ck-toolbar>.ck.ck-toolbar__separator{margin-right:var(--ck-spacing-small)}.ck.ck-toolbar[dir=ltr].ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child),[dir=ltr] .ck.ck-toolbar.ck-toolbar_grouping>.ck-toolbar__items:not(:empty):not(:only-child){margin-right:var(--ck-spacing-small)}"},function(t,e,i){var n=i(1),o=i(36);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-list{-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column}.ck.ck-list .ck-list__item,.ck.ck-list .ck-list__separator{display:block}.ck.ck-list .ck-list__item>:focus{position:relative;z-index:var(--ck-z-default)}.ck.ck-list{border-radius:0}.ck-rounded-corners .ck.ck-list,.ck.ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-list{list-style-type:none;background:var(--ck-color-list-background)}.ck.ck-list__item{cursor:default;min-width:12em}.ck.ck-list__item .ck-button{min-height:unset;width:100%;text-align:left;border-radius:0;padding:calc(var(--ck-line-height-base)*0.2*var(--ck-font-size-base)) calc(var(--ck-line-height-base)*0.4*var(--ck-font-size-base))}.ck.ck-list__item .ck-button .ck-button__label{line-height:calc(var(--ck-line-height-base)*1.2*var(--ck-font-size-base))}.ck.ck-list__item .ck-button:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on{background:var(--ck-color-list-button-on-background);color:var(--ck-color-list-button-on-text)}.ck.ck-list__item .ck-button.ck-on:active{box-shadow:none}.ck.ck-list__item .ck-button.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-on-background-focus)}.ck.ck-list__item .ck-button.ck-on:focus:not(.ck-disabled){border-color:var(--ck-color-base-background)}.ck.ck-list__item .ck-button:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background)}.ck.ck-list__item .ck-switchbutton.ck-on{background:var(--ck-color-list-background);color:inherit}.ck.ck-list__item .ck-switchbutton.ck-on:hover:not(.ck-disabled){background:var(--ck-color-list-button-hover-background);color:inherit}.ck.ck-list__separator{height:1px;width:100%;background:var(--ck-color-base-border)}"},function(t,e,i){var n=i(1),o=i(38);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-toolbar-dropdown-max-width:60vw}.ck.ck-toolbar-dropdown>.ck-dropdown__panel{width:max-content;max-width:var(--ck-toolbar-dropdown-max-width)}.ck.ck-toolbar-dropdown>.ck-dropdown__panel .ck-button:focus{z-index:calc(var(--ck-z-default) + 1)}.ck.ck-toolbar-dropdown .ck-toolbar{border:0}"},function(t,e,i){var n=i(1),o=i(40);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-dropdown .ck-dropdown__panel .ck-list{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list,.ck.ck-dropdown .ck-dropdown__panel .ck-list.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:first-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-bottom-left-radius:0;border-bottom-right-radius:0}.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button{border-radius:0}.ck-rounded-corners .ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button,.ck.ck-dropdown .ck-dropdown__panel .ck-list .ck-list__item:last-child .ck-button.ck-rounded-corners{border-radius:var(--ck-border-radius);border-top-left-radius:0;border-top-right-radius:0}"},function(t,e,i){var n=i(1),o=i(42);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-color-editable-blur-selection:#d9d9d9}.ck.ck-editor__editable:not(.ck-editor__nested-editable){border-radius:0}.ck-rounded-corners .ck.ck-editor__editable:not(.ck-editor__nested-editable),.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-editor__editable:not(.ck-editor__nested-editable).ck-focused{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0}.ck.ck-editor__editable_inline{overflow:auto;padding:0 var(--ck-spacing-standard);border:1px solid transparent}.ck.ck-editor__editable_inline[dir=ltr]{text-align:left}.ck.ck-editor__editable_inline[dir=rtl]{text-align:right}.ck.ck-editor__editable_inline>:first-child{margin-top:var(--ck-spacing-large)}.ck.ck-editor__editable_inline>:last-child{margin-bottom:var(--ck-spacing-large)}.ck.ck-editor__editable_inline.ck-blurred ::selection{background:var(--ck-color-editable-blur-selection)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_n]:after{border-bottom-color:var(--ck-color-base-foreground)}.ck.ck-balloon-panel.ck-toolbar-container[class*=arrow_s]:after{border-top-color:var(--ck-color-base-foreground)}"},function(t,e,i){var n=i(1),o=i(44);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-label{display:block}.ck.ck-voice-label{display:none}.ck.ck-label{font-weight:700}"},function(t,e,i){var n=i(1),o=i(46);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-form__header{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;justify-content:space-between}:root{--ck-form-header-height:38px}.ck.ck-form__header{padding:var(--ck-spacing-small) var(--ck-spacing-large);height:var(--ck-form-header-height);line-height:var(--ck-form-header-height);border-bottom:1px solid var(--ck-color-base-border)}.ck.ck-form__header .ck-form__header__label{font-weight:700}"},function(t,e,i){var n=i(1),o=i(48);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-input-text-width:18em}.ck.ck-input-text{border-radius:0}.ck-rounded-corners .ck.ck-input-text,.ck.ck-input-text.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-input-text{background:var(--ck-color-input-background);border:1px solid var(--ck-color-input-border);padding:var(--ck-spacing-extra-tiny) var(--ck-spacing-medium);min-width:var(--ck-input-text-width);min-height:var(--ck-ui-component-min-height);transition:box-shadow .1s ease-in-out,border .1s ease-in-out}.ck.ck-input-text:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-focus-outer-shadow),0 0}.ck.ck-input-text[readonly]{border:1px solid var(--ck-color-input-disabled-border);background:var(--ck-color-input-disabled-background);color:var(--ck-color-input-disabled-text)}.ck.ck-input-text[readonly]:focus{box-shadow:var(--ck-focus-disabled-outer-shadow),0 0}.ck.ck-input-text.ck-error{border-color:var(--ck-color-input-error-border);animation:ck-text-input-shake .3s ease both}.ck.ck-input-text.ck-error:focus{box-shadow:var(--ck-focus-error-outer-shadow),0 0}@keyframes ck-text-input-shake{20%{transform:translateX(-2px)}40%{transform:translateX(2px)}60%{transform:translateX(-1px)}80%{transform:translateX(1px)}}"},function(t,e,i){var n=i(1),o=i(50);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{display:flex;position:relative}.ck.ck-labeled-field-view .ck.ck-label{display:block;position:absolute}:root{--ck-labeled-field-view-transition:.1s cubic-bezier(0,0,0.24,0.95);--ck-labeled-field-empty-unfocused-max-width:100% - 2 * var(--ck-spacing-medium);--ck-color-labeled-field-label-background:var(--ck-color-base-background)}.ck.ck-labeled-field-view{border-radius:0}.ck-rounded-corners .ck.ck-labeled-field-view,.ck.ck-labeled-field-view.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper{width:100%}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{top:0}[dir=ltr] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{left:0}[dir=rtl] .ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{right:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{pointer-events:none;transform-origin:0 0;transform:translate(var(--ck-spacing-medium),-6px) scale(.75);background:var(--ck-color-labeled-field-label-background);padding:0 calc(var(--ck-font-size-tiny)*0.5);line-height:normal;font-weight:400;text-overflow:ellipsis;overflow:hidden;max-width:100%;transition:transform var(--ck-labeled-field-view-transition),padding var(--ck-labeled-field-view-transition),background var(--ck-labeled-field-view-transition)}.ck.ck-labeled-field-view.ck-error .ck-input:not([readonly])+.ck.ck-label,.ck.ck-labeled-field-view.ck-error>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view .ck-labeled-field-view__status{font-size:var(--ck-font-size-small);margin-top:var(--ck-spacing-small);white-space:normal}.ck.ck-labeled-field-view .ck-labeled-field-view__status.ck-labeled-field-view__status_error{color:var(--ck-color-base-error)}.ck.ck-labeled-field-view.ck-disabled>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{color:var(--ck-color-input-disabled-text)}[dir=ltr] .ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=ltr] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(var(--ck-spacing-medium),calc(var(--ck-font-size-base)*0.6)) scale(1)}[dir=rtl] .ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,[dir=rtl] .ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{transform:translate(calc(var(--ck-spacing-medium)*-1),calc(var(--ck-font-size-base)*0.6)) scale(1)}.ck.ck-labeled-field-view.ck-disabled.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label,.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width));background:transparent;padding:0}.ck.ck-labeled-field-view>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck.ck-button{background:transparent}.ck.ck-labeled-field-view.ck-labeled-field-view_empty>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown>.ck-button>.ck-button__label{opacity:0}.ck.ck-labeled-field-view.ck-labeled-field-view_empty:not(.ck-labeled-field-view_focused):not(.ck-labeled-field-view_placeholder)>.ck.ck-labeled-field-view__input-wrapper>.ck-dropdown+.ck-label{max-width:calc(var(--ck-labeled-field-empty-unfocused-max-width) - var(--ck-dropdown-arrow-size) - var(--ck-spacing-standard))}"},function(t,e,i){var n=i(1),o=i(52);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=':root{--ck-balloon-panel-arrow-z-index:calc(var(--ck-z-default) - 3)}.ck.ck-balloon-panel{display:none;position:absolute;z-index:var(--ck-z-modal)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{content:"";position:absolute}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_n]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_n]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel[class*=arrow_s]:before{z-index:var(--ck-balloon-panel-arrow-z-index)}.ck.ck-balloon-panel[class*=arrow_s]:after{z-index:calc(var(--ck-balloon-panel-arrow-z-index) + 1)}.ck.ck-balloon-panel.ck-balloon-panel_visible{display:block}:root{--ck-balloon-arrow-offset:2px;--ck-balloon-arrow-height:10px;--ck-balloon-arrow-half-width:8px;--ck-balloon-arrow-drop-shadow:0 2px 2px var(--ck-color-shadow-drop)}.ck.ck-balloon-panel{border-radius:0}.ck-rounded-corners .ck.ck-balloon-panel,.ck.ck-balloon-panel.ck-rounded-corners{border-radius:var(--ck-border-radius)}.ck.ck-balloon-panel{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border)}.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:after,.ck.ck-balloon-panel.ck-balloon-panel_with-arrow:before{width:0;height:0;border-style:solid}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:var(--ck-balloon-arrow-height);border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:0}.ck.ck-balloon-panel[class*=arrow_n]:before{border-bottom-color:var(--ck-color-panel-border)}.ck.ck-balloon-panel[class*=arrow_n]:after,.ck.ck-balloon-panel[class*=arrow_n]:before{border-left-color:transparent;border-right-color:transparent;border-top-color:transparent}.ck.ck-balloon-panel[class*=arrow_n]:after{border-bottom-color:var(--ck-color-panel-background);margin-top:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-width:var(--ck-balloon-arrow-half-width);border-bottom-width:0;border-right-width:var(--ck-balloon-arrow-half-width);border-top-width:var(--ck-balloon-arrow-height)}.ck.ck-balloon-panel[class*=arrow_s]:before{border-top-color:var(--ck-color-panel-border);filter:drop-shadow(var(--ck-balloon-arrow-drop-shadow))}.ck.ck-balloon-panel[class*=arrow_s]:after,.ck.ck-balloon-panel[class*=arrow_s]:before{border-left-color:transparent;border-bottom-color:transparent;border-right-color:transparent}.ck.ck-balloon-panel[class*=arrow_s]:after{border-top-color:var(--ck-color-panel-background);margin-bottom:var(--ck-balloon-arrow-offset)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_n:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_ne:before{right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_s:before{left:50%;margin-left:calc(var(--ck-balloon-arrow-half-width)*-1);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sw:before{left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_se:before{right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_sme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_smw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);bottom:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nme:before{right:25%;margin-right:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:after,.ck.ck-balloon-panel.ck-balloon-panel_arrow_nmw:before{left:25%;margin-left:calc(var(--ck-balloon-arrow-half-width)*2);top:calc(var(--ck-balloon-arrow-height)*-1)}'},function(t,e,i){var n=i(1),o=i(54);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-balloon-rotator__navigation{display:flex;align-items:center;justify-content:center}.ck .ck-balloon-rotator__content .ck-toolbar{justify-content:center}.ck .ck-balloon-rotator__navigation{background:var(--ck-color-toolbar-background);border-bottom:1px solid var(--ck-color-toolbar-border);padding:0 var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation>*{margin-right:var(--ck-spacing-small);margin-top:var(--ck-spacing-small);margin-bottom:var(--ck-spacing-small)}.ck .ck-balloon-rotator__navigation .ck-balloon-rotator__counter{margin-right:var(--ck-spacing-standard);margin-left:var(--ck-spacing-small)}.ck .ck-balloon-rotator__content .ck.ck-annotation-wrapper{box-shadow:none}"},function(t,e,i){var n=i(1),o=i(56);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-fake-panel{position:absolute;z-index:calc(var(--ck-z-modal) - 1)}.ck .ck-fake-panel div{position:absolute}.ck .ck-fake-panel div:first-child{z-index:2}.ck .ck-fake-panel div:nth-child(2){z-index:1}:root{--ck-balloon-fake-panel-offset-horizontal:6px;--ck-balloon-fake-panel-offset-vertical:6px}.ck .ck-fake-panel div{box-shadow:var(--ck-drop-shadow),0 0;min-height:15px;background:var(--ck-color-panel-background);border:1px solid var(--ck-color-panel-border);border-radius:var(--ck-border-radius);width:100%;height:100%}.ck .ck-fake-panel div:first-child{margin-left:var(--ck-balloon-fake-panel-offset-horizontal);margin-top:var(--ck-balloon-fake-panel-offset-vertical)}.ck .ck-fake-panel div:nth-child(2){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*2);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*2)}.ck .ck-fake-panel div:nth-child(3){margin-left:calc(var(--ck-balloon-fake-panel-offset-horizontal)*3);margin-top:calc(var(--ck-balloon-fake-panel-offset-vertical)*3)}.ck .ck-balloon-panel_arrow_s+.ck-fake-panel,.ck .ck-balloon-panel_arrow_se+.ck-fake-panel,.ck .ck-balloon-panel_arrow_sw+.ck-fake-panel{--ck-balloon-fake-panel-offset-vertical:-6px}"},function(t,e,i){var n=i(1),o=i(58);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-sticky-panel .ck-sticky-panel__content_sticky{z-index:var(--ck-z-modal);position:fixed;top:0}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky_bottom-limit{top:auto;position:absolute}.ck.ck-sticky-panel .ck-sticky-panel__content_sticky{box-shadow:var(--ck-drop-shadow),0 0;border-width:0 1px 1px;border-top-left-radius:0;border-top-right-radius:0}"},function(t,e,i){var n=i(1),o=i(60);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-block-toolbar-button{position:absolute;z-index:var(--ck-z-default)}:root{--ck-color-block-toolbar-button:var(--ck-color-text);--ck-block-toolbar-button-size:var(--ck-font-size-normal)}.ck.ck-block-toolbar-button{color:var(--ck-color-block-toolbar-button);font-size:var(--ck-block-toolbar-size)}"},function(t,e,i){var n=i(1),o=i(62);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-placeholder,.ck .ck-placeholder{position:relative}.ck.ck-placeholder:before,.ck .ck-placeholder:before{position:absolute;left:0;right:0;content:attr(data-placeholder);pointer-events:none}.ck.ck-read-only .ck-placeholder:before{display:none}.ck.ck-placeholder:before,.ck .ck-placeholder:before{cursor:text;color:var(--ck-color-engine-placeholder-text)}"},function(t,e,i){var n=i(1),o=i(64);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck .ck-widget .ck-widget__type-around__button{display:block;position:absolute;overflow:hidden;z-index:var(--ck-z-default)}.ck .ck-widget .ck-widget__type-around__button svg{position:absolute;top:50%;left:50%;z-index:calc(var(--ck-z-default) + 2)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_before{top:calc(var(--ck-widget-outline-thickness)*-0.5);left:min(10%,30px);transform:translateY(-50%)}.ck .ck-widget .ck-widget__type-around__button.ck-widget__type-around__button_after{bottom:calc(var(--ck-widget-outline-thickness)*-0.5);right:min(10%,30px);transform:translateY(50%)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{content:"";display:block;position:absolute;top:1px;left:1px;z-index:calc(var(--ck-z-default) + 1)}.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__fake-caret{display:none;position:absolute;left:0;right:0}.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__fake-caret{left:calc(var(--ck-widget-outline-thickness)*-1);right:calc(var(--ck-widget-outline-thickness)*-1)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__fake-caret{top:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__fake-caret{bottom:calc(var(--ck-widget-outline-thickness)*-1 - 1px);display:block}.ck.ck-editor__editable.ck-read-only .ck-widget__type-around,.ck.ck-editor__editable.ck-restricted-editing_mode_restricted .ck-widget__type-around,.ck.ck-editor__editable.ck-widget__type-around_disabled .ck-widget__type-around{display:none}:root{--ck-widget-type-around-button-size:20px;--ck-color-widget-type-around-button-active:var(--ck-color-focus-border);--ck-color-widget-type-around-button-hover:var(--ck-color-widget-hover-border);--ck-color-widget-type-around-button-blurred-editable:var(--ck-color-widget-blurred-border);--ck-color-widget-type-around-button-radar-start-alpha:0;--ck-color-widget-type-around-button-radar-end-alpha:.3;--ck-color-widget-type-around-button-icon:var(--ck-color-base-background)}.ck .ck-widget .ck-widget__type-around__button{width:var(--ck-widget-type-around-button-size);height:var(--ck-widget-type-around-button-size);background:var(--ck-color-widget-type-around-button);border-radius:100px;transition:opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),background var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);opacity:0;pointer-events:none}.ck .ck-widget .ck-widget__type-around__button svg{width:10px;height:8px;transform:translate(-50%,-50%);transition:transform .5s ease;margin-top:1px}.ck .ck-widget .ck-widget__type-around__button svg *{stroke-dasharray:10;stroke-dashoffset:0;fill:none;stroke:var(--ck-color-widget-type-around-button-icon);stroke-width:1.5px;stroke-linecap:round;stroke-linejoin:round}.ck .ck-widget .ck-widget__type-around__button svg line{stroke-dasharray:7}.ck .ck-widget .ck-widget__type-around__button:hover{animation:ck-widget-type-around-button-sonar 1s ease infinite}.ck .ck-widget .ck-widget__type-around__button:hover svg polyline{animation:ck-widget-type-around-arrow-dash 2s linear}.ck .ck-widget .ck-widget__type-around__button:hover svg line{animation:ck-widget-type-around-arrow-tip-dash 2s linear}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:1;pointer-events:auto}.ck .ck-widget:not(.ck-widget_selected)>.ck-widget__type-around>.ck-widget__type-around__button{background:var(--ck-color-widget-type-around-button-hover)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover{background:var(--ck-color-widget-type-around-button-active)}.ck .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:after,.ck .ck-widget>.ck-widget__type-around>.ck-widget__type-around__button:hover:after{width:calc(var(--ck-widget-type-around-button-size) - 2px);height:calc(var(--ck-widget-type-around-button-size) - 2px);border-radius:100px;background:linear-gradient(135deg,hsla(0,0%,100%,0),hsla(0,0%,100%,.3))}.ck .ck-widget.ck-widget_with-selection-handle>.ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:20px}.ck .ck-widget .ck-widget__type-around__fake-caret{pointer-events:none;height:1px;animation:ck-widget-type-around-fake-caret-pulse 1s linear infinite normal forwards;outline:1px solid hsla(0,0%,100%,.5);background:var(--ck-color-base-text)}.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_after,.ck .ck-widget.ck-widget_selected.ck-widget_type-around_show-fake-caret_before{outline-color:transparent}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected:hover,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after>.ck-widget__type-around>.ck-widget__type-around__button,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle{opacity:0}.ck .ck-widget.ck-widget_type-around_show-fake-caret_after.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer,.ck .ck-widget.ck-widget_type-around_show-fake-caret_before.ck-widget_selected.ck-widget_with-resizer>.ck-widget__resizer{opacity:0}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__type-around>.ck-widget__type-around__button_before{margin-left:0;margin-right:20px}.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button,.ck-editor__nested-editable.ck-editor__editable_selected .ck-widget:hover>.ck-widget__type-around>.ck-widget__type-around__button{opacity:0;pointer-events:none}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover){background:var(--ck-color-widget-type-around-button-blurred-editable)}.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected>.ck-widget__type-around>.ck-widget__type-around__button:not(:hover) svg *{stroke:#999}@keyframes ck-widget-type-around-arrow-dash{0%{stroke-dashoffset:10}20%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-arrow-tip-dash{0%,20%{stroke-dashoffset:7}40%,to{stroke-dashoffset:0}}@keyframes ck-widget-type-around-button-sonar{0%{box-shadow:0 0 0 0 hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}50%{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-end-alpha))}to{box-shadow:0 0 0 5px hsla(var(--ck-color-focus-border-coordinates),var(--ck-color-widget-type-around-button-radar-start-alpha))}}@keyframes ck-widget-type-around-fake-caret-pulse{0%{opacity:1}49%{opacity:1}50%{opacity:0}99%{opacity:0}to{opacity:1}}'},function(t,e,i){var n=i(1),o=i(66);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-color-resizer:var(--ck-color-focus-border);--ck-color-resizer-tooltip-background:#262626;--ck-color-resizer-tooltip-text:#f2f2f2;--ck-resizer-border-radius:var(--ck-border-radius);--ck-resizer-tooltip-offset:10px;--ck-resizer-tooltip-height:calc(var(--ck-spacing-small)*2 + 10px)}.ck .ck-widget,.ck .ck-widget.ck-widget_with-selection-handle{position:relative}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{position:absolute}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{display:block}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle:hover>.ck-widget__selection-handle{visibility:visible}.ck .ck-size-view{background:var(--ck-color-resizer-tooltip-background);color:var(--ck-color-resizer-tooltip-text);border:1px solid var(--ck-color-resizer-tooltip-text);border-radius:var(--ck-resizer-border-radius);font-size:var(--ck-font-size-tiny);display:block;padding:0 var(--ck-spacing-small);height:var(--ck-resizer-tooltip-height);line-height:var(--ck-resizer-tooltip-height)}.ck .ck-size-view.ck-orientation-above-center,.ck .ck-size-view.ck-orientation-bottom-left,.ck .ck-size-view.ck-orientation-bottom-right,.ck .ck-size-view.ck-orientation-top-left,.ck .ck-size-view.ck-orientation-top-right{position:absolute}.ck .ck-size-view.ck-orientation-top-left{top:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-top-right{top:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-right{bottom:var(--ck-resizer-tooltip-offset);right:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-bottom-left{bottom:var(--ck-resizer-tooltip-offset);left:var(--ck-resizer-tooltip-offset)}.ck .ck-size-view.ck-orientation-above-center{top:calc(var(--ck-resizer-tooltip-height)*-1);left:50%;transform:translate(-50%)}:root{--ck-widget-outline-thickness:3px;--ck-widget-handler-icon-size:16px;--ck-widget-handler-animation-duration:200ms;--ck-widget-handler-animation-curve:ease;--ck-color-widget-blurred-border:#dedede;--ck-color-widget-hover-border:#ffc83d;--ck-color-widget-editable-focus-background:var(--ck-color-base-background);--ck-color-widget-drag-handler-icon-color:var(--ck-color-base-background)}.ck .ck-widget{outline-width:var(--ck-widget-outline-thickness);outline-style:solid;outline-color:transparent;transition:outline-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_selected,.ck .ck-widget.ck-widget_selected:hover{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-focus-border)}.ck .ck-widget:hover{outline-color:var(--ck-color-widget-hover-border)}.ck .ck-editor__nested-editable{border:1px solid transparent}.ck .ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck .ck-editor__nested-editable:focus{outline:none;border:var(--ck-focus-ring);box-shadow:var(--ck-inner-shadow),0 0;background-color:var(--ck-color-widget-editable-focus-background)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{padding:4px;box-sizing:border-box;background-color:transparent;opacity:0;transition:background-color var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),visibility var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve),opacity var(--ck-widget-handler-animation-duration) var(--ck-widget-handler-animation-curve);border-radius:var(--ck-border-radius) var(--ck-border-radius) 0 0;transform:translateY(-100%);left:calc(0px - var(--ck-widget-outline-thickness));top:0}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon{width:var(--ck-widget-handler-icon-size);height:var(--ck-widget-handler-icon-size);color:var(--ck-color-widget-drag-handler-icon-color)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:0;transition:opacity .3s var(--ck-widget-handler-animation-curve)}.ck .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover .ck-icon .ck-icon__selected-indicator{opacity:1}.ck .ck-widget.ck-widget_with-selection-handle:hover>.ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-widget-hover-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle{opacity:1;background-color:var(--ck-color-focus-border)}.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected:hover>.ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator,.ck .ck-widget.ck-widget_with-selection-handle.ck-widget_selected>.ck-widget__selection-handle .ck-icon .ck-icon__selected-indicator{opacity:1}.ck[dir=rtl] .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle{left:auto;right:calc(0px - var(--ck-widget-outline-thickness))}.ck.ck-editor__editable.ck-read-only .ck-widget{transition:none}.ck.ck-editor__editable.ck-read-only .ck-widget:not(.ck-widget_selected){--ck-widget-outline-thickness:0px}.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle,.ck.ck-editor__editable.ck-read-only .ck-widget.ck-widget_with-selection-handle .ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover{outline-color:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle>.ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected.ck-widget_with-selection-handle>.ck-widget__selection-handle:hover,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle>.ck-widget__selection-handle,.ck.ck-editor__editable.ck-blurred .ck-widget.ck-widget_selected:hover.ck-widget_with-selection-handle>.ck-widget__selection-handle:hover{background:var(--ck-color-widget-blurred-border)}.ck.ck-editor__editable>.ck-widget.ck-widget_with-selection-handle:first-child,.ck.ck-editor__editable blockquote>.ck-widget.ck-widget_with-selection-handle:first-child{margin-top:calc(1em + var(--ck-widget-handler-icon-size))}"},function(t,e,i){var n=i(1),o=i(68);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position{display:inline;position:relative;pointer-events:none}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span{position:absolute;width:0}.ck.ck-editor__editable .ck-widget:-webkit-drag>.ck-widget__selection-handle,.ck.ck-editor__editable .ck-widget:-webkit-drag>.ck-widget__type-around{display:none}:root{--ck-clipboard-drop-target-dot-width:12px;--ck-clipboard-drop-target-dot-height:8px;--ck-clipboard-drop-target-color:var(--ck-color-focus-border)}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span{bottom:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);top:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);border:1px solid var(--ck-clipboard-drop-target-color);background:var(--ck-clipboard-drop-target-color);margin-left:-1px}.ck.ck-editor__editable .ck.ck-clipboard-drop-target-position span:after{content:"";width:0;height:0;display:block;position:absolute;left:50%;top:calc(var(--ck-clipboard-drop-target-dot-height)*-0.5);transform:translateX(-50%);border-left:calc(var(--ck-clipboard-drop-target-dot-width)*0.5) solid transparent;border-bottom:0 solid transparent;border-right:calc(var(--ck-clipboard-drop-target-dot-width)*0.5) solid transparent;border-top:calc(var(--ck-clipboard-drop-target-dot-height)) solid var(--ck-clipboard-drop-target-color)}.ck.ck-editor__editable .ck-widget.ck-clipboard-drop-target-range{outline:var(--ck-widget-outline-thickness) solid var(--ck-clipboard-drop-target-color)!important}.ck.ck-editor__editable .ck-widget:-webkit-drag{zoom:.6;outline:none!important}'},function(t,e,i){var n=i(1),o=i(70);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-button.ck-color-table__remove-color{display:flex;align-items:center;width:100%}label.ck.ck-color-grid__label{font-weight:unset}.ck .ck-button.ck-color-table__remove-color{padding:calc(var(--ck-spacing-standard)/2) var(--ck-spacing-standard);border-bottom-left-radius:0;border-bottom-right-radius:0}.ck .ck-button.ck-color-table__remove-color:not(:focus){border-bottom:1px solid var(--ck-color-base-border)}[dir=ltr] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck .ck-button.ck-color-table__remove-color .ck.ck-icon{margin-left:var(--ck-spacing-standard)}"},function(t,e,i){var n=i(1),o=i(72);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-content .text-tiny{font-size:.7em}.ck-content .text-small{font-size:.85em}.ck-content .text-big{font-size:1.4em}.ck-content .text-huge{font-size:1.8em}"},function(t,e,i){var n=i(1),o=i(74);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-content blockquote{overflow:hidden;padding-right:1.5em;padding-left:1.5em;margin-left:0;margin-right:0;font-style:italic;border-left:5px solid #ccc}.ck-content[dir=rtl] blockquote{border-left:0;border-right:5px solid #ccc}"},function(t,e){t.exports=".ck.ck-heading_heading1{font-size:20px}.ck.ck-heading_heading2{font-size:17px}.ck.ck-heading_heading3{font-size:14px}.ck[class*=ck-heading_heading]{font-weight:700}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__button .ck-button__label{width:8em}.ck.ck-dropdown.ck-heading-dropdown .ck-dropdown__panel .ck-list__item{min-width:18em}"},function(t,e,i){var n=i(1),o=i(77);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-widget_with-resizer{position:relative}.ck .ck-widget__resizer{display:none;position:absolute;pointer-events:none;left:0;top:0}.ck-focused .ck-widget_with-resizer.ck-widget_selected>.ck-widget__resizer{display:block}.ck .ck-widget__resizer__handle{position:absolute;pointer-events:all}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{cursor:nwse-resize}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left,.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{cursor:nesw-resize}:root{--ck-resizer-size:10px;--ck-resizer-offset:calc(var(--ck-resizer-size)/-2 - 2px);--ck-resizer-border-width:1px}.ck .ck-widget__resizer{outline:1px solid var(--ck-color-resizer)}.ck .ck-widget__resizer__handle{width:var(--ck-resizer-size);height:var(--ck-resizer-size);background:var(--ck-color-focus-border);border:var(--ck-resizer-border-width) solid #fff;border-radius:var(--ck-resizer-border-radius)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-left{top:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-top-right{top:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-right{bottom:var(--ck-resizer-offset);right:var(--ck-resizer-offset)}.ck .ck-widget__resizer__handle.ck-widget__resizer__handle-bottom-left{bottom:var(--ck-resizer-offset);left:var(--ck-resizer-offset)}"},function(t,e,i){var n=i(1),o=i(79);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-text-alternative-form{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-text-alternative-form .ck-labeled-field-view{display:inline-block}.ck.ck-text-alternative-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-text-alternative-form{flex-wrap:wrap}.ck.ck-text-alternative-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-text-alternative-form .ck-button{flex-basis:50%}}"},function(t,e){t.exports='.ck-vertical-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}@media screen and (max-width:600px){.ck.ck-responsive-form .ck-button:after{content:"";width:0;position:absolute;right:-1px;top:var(--ck-spacing-small);bottom:var(--ck-spacing-small);z-index:1}}.ck-vertical-form>.ck-button:nth-last-child(2):after{border-right:1px solid var(--ck-color-base-border)}.ck.ck-responsive-form{padding:var(--ck-spacing-large)}.ck.ck-responsive-form:focus{outline:none}[dir=ltr] .ck.ck-responsive-form>:not(:first-child),[dir=rtl] .ck.ck-responsive-form>:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-responsive-form{padding:0;width:calc(var(--ck-input-text-width)*0.8)}.ck.ck-responsive-form .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) 0}.ck.ck-responsive-form .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-responsive-form .ck-labeled-field-view .ck-labeled-field-view__error{white-space:normal}.ck.ck-responsive-form>.ck-button:last-child,.ck.ck-responsive-form>.ck-button:nth-last-child(2){padding:var(--ck-spacing-standard);margin-top:var(--ck-spacing-large);border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border)}[dir=ltr] .ck.ck-responsive-form>.ck-button:last-child,[dir=ltr] .ck.ck-responsive-form>.ck-button:nth-last-child(2),[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2){margin-left:0}.ck.ck-responsive-form>.ck-button:nth-last-child(2):after,[dir=rtl] .ck.ck-responsive-form>.ck-button:last-child:last-of-type,[dir=rtl] .ck.ck-responsive-form>.ck-button:nth-last-child(2):last-of-type{border-right:1px solid var(--ck-color-base-border)}}'},function(t,e){t.exports=".ck-content .image{display:table;clear:both;text-align:center;margin:.9em auto;min-width:50px}.ck-content .image img{display:block;margin:0 auto;max-width:100%;min-width:100%}.ck-content .image-inline{display:inline-flex;max-width:100%;align-items:flex-start}.ck-content .image-inline picture{display:flex}.ck-content .image-inline img,.ck-content .image-inline picture{flex-grow:1;flex-shrink:1;max-width:100%}.ck.ck-editor__editable .image>figcaption.ck-placeholder:before{padding-left:inherit;padding-right:inherit;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ck.ck-editor__editable .image-inline.ck-widget_selected,.ck.ck-editor__editable .image.ck-widget_selected{z-index:1}.ck.ck-editor__editable .image-inline.ck-widget_selected ::selection{display:none}.ck.ck-editor__editable td .image-inline img,.ck.ck-editor__editable th .image-inline img{max-width:none}"},function(t,e,i){var n=i(1),o=i(83);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-color-image-caption-background:#f7f7f7;--ck-color-image-caption-text:#333;--ck-color-image-caption-highligted-background:#fd0}.ck-content .image>figcaption{display:table-caption;caption-side:bottom;word-break:break-word;color:var(--ck-color-image-caption-text);background-color:var(--ck-color-image-caption-background);padding:.6em;font-size:.75em;outline-offset:-1px}.ck.ck-editor__editable .image>figcaption.image__caption_highlighted{animation:ck-image-caption-highlight .6s ease-out}@keyframes ck-image-caption-highlight{0%{background-color:var(--ck-color-image-caption-highligted-background)}to{background-color:var(--ck-color-image-caption-background)}}"},function(t,e,i){var n=i(1),o=i(85);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-content .image.image_resized{max-width:100%;display:block;box-sizing:border-box}.ck-content .image.image_resized img{width:100%}.ck-content .image.image_resized>figcaption{display:block}.ck.ck-editor__editable td .image-inline.image_resized img,.ck.ck-editor__editable th .image-inline.image_resized img{max-width:100%}[dir=ltr] .ck.ck-button.ck-button_with-text.ck-resize-image-button .ck-button__icon{margin-right:var(--ck-spacing-standard)}[dir=rtl] .ck.ck-button.ck-button_with-text.ck-resize-image-button .ck-button__icon{margin-left:var(--ck-spacing-standard)}.ck.ck-dropdown .ck-button.ck-resize-image-button .ck-button__label{width:4em}"},function(t,e,i){var n=i(1),o=i(87);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-image-style-spacing:1.5em;--ck-inline-image-style-spacing:calc(var(--ck-image-style-spacing)/2)}.ck-content .image-style-block-align-left,.ck-content .image-style-block-align-right{max-width:calc(100% - var(--ck-image-style-spacing))}.ck-content .image-style-align-left,.ck-content .image-style-align-right{clear:none}.ck-content .image-style-side{float:right;margin-left:var(--ck-image-style-spacing);max-width:50%}.ck-content .image-style-align-left{float:left;margin-right:var(--ck-image-style-spacing)}.ck-content .image-style-align-center{margin-left:auto;margin-right:auto}.ck-content .image-style-align-right{float:right;margin-left:var(--ck-image-style-spacing)}.ck-content .image-style-block-align-right{margin-right:0;margin-left:auto}.ck-content .image-style-block-align-left{margin-left:0;margin-right:auto}.ck-content p+.image-style-align-left,.ck-content p+.image-style-align-right,.ck-content p+.image-style-side{margin-top:0}.ck-content .image-inline.image-style-align-left,.ck-content .image-inline.image-style-align-right{margin-top:var(--ck-inline-image-style-spacing);margin-bottom:var(--ck-inline-image-style-spacing)}.ck-content .image-inline.image-style-align-left{margin-right:var(--ck-inline-image-style-spacing)}.ck-content .image-inline.image-style-align-right{margin-left:var(--ck-inline-image-style-spacing)}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover){background-color:var(--ck-color-button-on-background)}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__action:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__action:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):after,.ck.ck-splitbutton.ck-splitbutton_flatten:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover):after{display:none}.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__action:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__arrow:not(.ck-disabled),.ck.ck-splitbutton.ck-splitbutton_flatten.ck-splitbutton_open:hover>.ck-splitbutton__arrow:not(.ck-disabled):not(:hover){background-color:var(--ck-color-button-on-hover-background)}"},function(t,e,i){var n=i(1),o=i(89);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-editor__editable .image,.ck.ck-editor__editable .image-inline{position:relative}.ck.ck-editor__editable .image-inline .ck-progress-bar,.ck.ck-editor__editable .image .ck-progress-bar{position:absolute;top:0;left:0}.ck.ck-editor__editable .image-inline.ck-appear,.ck.ck-editor__editable .image.ck-appear{animation:fadeIn .7s}.ck.ck-editor__editable .image-inline .ck-progress-bar,.ck.ck-editor__editable .image .ck-progress-bar{height:2px;width:0;background:var(--ck-color-upload-bar-background);transition:width .1s}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}"},function(t,e,i){var n=i(1),o=i(91);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck-image-upload-complete-icon{display:block;position:absolute;top:min(var(--ck-spacing-medium),6%);right:min(var(--ck-spacing-medium),6%);border-radius:50%;z-index:1}.ck-image-upload-complete-icon:after{content:"";position:absolute}:root{--ck-color-image-upload-icon:#fff;--ck-color-image-upload-icon-background:#008a00;--ck-image-upload-icon-size:20;--ck-image-upload-icon-width:2px;--ck-image-upload-icon-is-visible:clamp(0px,100% - 50px,1px)}.ck-image-upload-complete-icon{opacity:0;background:var(--ck-color-image-upload-icon-background);animation-name:ck-upload-complete-icon-show,ck-upload-complete-icon-hide;animation-fill-mode:forwards,forwards;animation-duration:.5s,.5s;font-size:calc(1px*var(--ck-image-upload-icon-size));animation-delay:0ms,3s;overflow:hidden;width:calc(var(--ck-image-upload-icon-is-visible)*var(--ck-image-upload-icon-size));height:calc(var(--ck-image-upload-icon-is-visible)*var(--ck-image-upload-icon-size))}.ck-image-upload-complete-icon:after{left:25%;top:50%;opacity:0;height:0;width:0;transform:scaleX(-1) rotate(135deg);transform-origin:left top;border-top:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);border-right:var(--ck-image-upload-icon-width) solid var(--ck-color-image-upload-icon);animation-name:ck-upload-complete-icon-check;animation-duration:.5s;animation-delay:.5s;animation-fill-mode:forwards;box-sizing:border-box}@keyframes ck-upload-complete-icon-show{0%{opacity:0}to{opacity:1}}@keyframes ck-upload-complete-icon-hide{0%{opacity:1}to{opacity:0}}@keyframes ck-upload-complete-icon-check{0%{opacity:1;width:0;height:0}33%{width:.3em;height:0}to{opacity:1;width:.3em;height:.45em}}'},function(t,e,i){var n=i(1),o=i(93);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck .ck-upload-placeholder-loader{position:absolute;display:flex;align-items:center;justify-content:center;top:0;left:0}.ck .ck-upload-placeholder-loader:before{content:"";position:relative}:root{--ck-color-upload-placeholder-loader:#b3b3b3;--ck-upload-placeholder-loader-size:32px}.ck .ck-image-upload-placeholder{width:100%;margin:0}.ck .ck-upload-placeholder-loader{width:100%;height:100%}.ck .ck-upload-placeholder-loader:before{width:var(--ck-upload-placeholder-loader-size);height:var(--ck-upload-placeholder-loader-size);border-radius:50%;border-top:3px solid var(--ck-color-upload-placeholder-loader);border-right:2px solid transparent;animation:ck-upload-placeholder-loader 1s linear infinite}@keyframes ck-upload-placeholder-loader{to{transform:rotate(1turn)}}'},function(t,e,i){var n=i(1),o=i(95);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-link_selected{background:var(--ck-color-link-selected-background)}.ck .ck-link_selected span.image-inline{outline:var(--ck-widget-outline-thickness) solid var(--ck-color-link-selected-background)}.ck .ck-fake-link-selection{background:var(--ck-color-link-fake-selection)}.ck .ck-fake-link-selection_collapsed{height:100%;border-right:1px solid var(--ck-color-base-text);margin-right:-1px;outline:1px solid hsla(0,0%,100%,.5)}"},function(t,e,i){var n=i(1),o=i(97);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-link-form{display:flex}.ck.ck-link-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-link-form{flex-wrap:wrap}.ck.ck-link-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-link-form .ck-button{flex-basis:50%}}.ck.ck-link-form_layout-vertical{display:block}.ck.ck-link-form_layout-vertical .ck-button.ck-button-cancel,.ck.ck-link-form_layout-vertical .ck-button.ck-button-save{margin-top:var(--ck-spacing-medium)}.ck.ck-link-form_layout-vertical{padding:0;min-width:var(--ck-input-text-width)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view{margin:var(--ck-spacing-large) var(--ck-spacing-large) var(--ck-spacing-small)}.ck.ck-link-form_layout-vertical .ck-labeled-field-view .ck-input-text{min-width:0;width:100%}.ck.ck-link-form_layout-vertical .ck-button{padding:var(--ck-spacing-standard);margin:0;border-radius:0;border:0;border-top:1px solid var(--ck-color-base-border);width:50%}[dir=ltr] .ck.ck-link-form_layout-vertical .ck-button,[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button{margin-left:0}[dir=rtl] .ck.ck-link-form_layout-vertical .ck-button:last-of-type{border-right:1px solid var(--ck-color-base-border)}.ck.ck-link-form_layout-vertical .ck.ck-list{margin:var(--ck-spacing-standard) var(--ck-spacing-large)}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton{border:0;padding:0;width:100%}.ck.ck-link-form_layout-vertical .ck.ck-list .ck-button.ck-switchbutton:hover{background:none}"},function(t,e,i){var n=i(1),o=i(99);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-link-actions{display:flex;flex-direction:row;flex-wrap:nowrap}.ck.ck-link-actions .ck-link-actions__preview{display:inline-block}.ck.ck-link-actions .ck-link-actions__preview .ck-button__label{overflow:hidden}@media screen and (max-width:600px){.ck.ck-link-actions{flex-wrap:wrap}.ck.ck-link-actions .ck-link-actions__preview{flex-basis:100%}.ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){flex-basis:50%}}.ck.ck-link-actions .ck-button.ck-link-actions__preview{padding-left:0;padding-right:0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{padding:0 var(--ck-spacing-medium);color:var(--ck-color-link-default);text-overflow:ellipsis;cursor:pointer;max-width:var(--ck-input-text-width);min-width:3em;text-align:center}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label:hover{text-decoration:underline}.ck.ck-link-actions .ck-button.ck-link-actions__preview,.ck.ck-link-actions .ck-button.ck-link-actions__preview:active,.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus,.ck.ck-link-actions .ck-button.ck-link-actions__preview:hover{background:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:active{box-shadow:none}.ck.ck-link-actions .ck-button.ck-link-actions__preview:focus .ck-button__label{text-decoration:underline}[dir=ltr] .ck.ck-link-actions .ck-button:not(:first-child),[dir=rtl] .ck.ck-link-actions .ck-button:not(:last-child){margin-left:var(--ck-spacing-standard)}@media screen and (max-width:600px){.ck.ck-link-actions .ck-button.ck-link-actions__preview{margin:var(--ck-spacing-standard) var(--ck-spacing-standard) 0}.ck.ck-link-actions .ck-button.ck-link-actions__preview .ck-button__label{min-width:0;max-width:100%}[dir=ltr] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview),[dir=rtl] .ck.ck-link-actions .ck-button:not(.ck-link-actions__preview){margin-left:0}}"},function(t,e,i){var n=i(1),o=i(101);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-list-styles-dropdown>.ck-dropdown__panel>.ck-toolbar>.ck-toolbar__items{display:grid}:root{--ck-list-style-button-size:44px}.ck.ck-list-styles-dropdown>.ck-dropdown__panel>.ck-toolbar{background:none;padding:0}.ck.ck-list-styles-dropdown>.ck-dropdown__panel>.ck-toolbar>.ck-toolbar__items{grid-template-columns:repeat(3,auto);row-gap:var(--ck-spacing-medium);column-gap:var(--ck-spacing-medium);padding:var(--ck-spacing-medium)}.ck.ck-list-styles-dropdown>.ck-dropdown__panel>.ck-toolbar>.ck-toolbar__items .ck-button{width:var(--ck-list-style-button-size);height:var(--ck-list-style-button-size);padding:0;margin:0;box-sizing:content-box}.ck.ck-list-styles-dropdown>.ck-dropdown__panel>.ck-toolbar>.ck-toolbar__items .ck-button .ck-icon{width:var(--ck-list-style-button-size);height:var(--ck-list-style-button-size)}"},function(t,e,i){var n=i(1),o=i(103);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports='.ck-media__wrapper .ck-media__placeholder{display:flex;flex-direction:column;align-items:center}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:block}@media (hover:none){.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-tooltip{display:none}}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url{max-width:100%;position:relative}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url:hover .ck-tooltip{visibility:visible;opacity:1}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url .ck-media__placeholder__url__text{overflow:hidden;display:block}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="goo.gl/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="maps.app.goo.gl"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="maps.google.com"] .ck-media__placeholder__icon *,.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck-media__placeholder__icon *{display:none}.ck-editor__editable:not(.ck-read-only) .ck-media__wrapper>:not(.ck-media__placeholder),.ck-editor__editable:not(.ck-read-only) .ck-widget:not(.ck-widget_selected) .ck-media__placeholder{pointer-events:none}:root{--ck-media-embed-placeholder-icon-size:3em;--ck-color-media-embed-placeholder-url-text:#757575;--ck-color-media-embed-placeholder-url-text-hover:var(--ck-color-base-text)}.ck-media__wrapper{margin:0 auto}.ck-media__wrapper .ck-media__placeholder{padding:calc(var(--ck-spacing-standard)*3);background:var(--ck-color-base-foreground)}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon{min-width:var(--ck-media-embed-placeholder-icon-size);height:var(--ck-media-embed-placeholder-icon-size);margin-bottom:var(--ck-spacing-large);background-position:50%;background-size:cover}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__icon .ck-icon{width:100%;height:100%}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text{color:var(--ck-color-media-embed-placeholder-url-text);white-space:nowrap;text-align:center;font-style:italic;text-overflow:ellipsis}.ck-media__wrapper .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:var(--ck-color-media-embed-placeholder-url-text-hover);cursor:pointer;text-decoration:underline}.ck-media__wrapper[data-oembed-url*="open.spotify.com"]{max-width:300px;max-height:380px}.ck-media__wrapper[data-oembed-url*="goo.gl/maps"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="google.com/maps"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="maps.app.goo.gl"] .ck-media__placeholder__icon,.ck-media__wrapper[data-oembed-url*="maps.google.com"] .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTAuMzc4IiBoZWlnaHQ9IjI1NC4xNjciIHZpZXdCb3g9IjAgMCA2Ni4yNDYgNjcuMjQ4Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTcyLjUzMSAtMjE4LjQ1NSkgc2NhbGUoLjk4MDEyKSI+PHJlY3Qgcnk9IjUuMjM4IiByeD0iNS4yMzgiIHk9IjIzMS4zOTkiIHg9IjE3Ni4wMzEiIGhlaWdodD0iNjAuMDk5IiB3aWR0aD0iNjAuMDk5IiBmaWxsPSIjMzRhNjY4IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0yMDYuNDc3IDI2MC45bC0yOC45ODcgMjguOTg3YTUuMjE4IDUuMjE4IDAgMDAzLjc4IDEuNjFoNDkuNjIxYzEuNjk0IDAgMy4xOS0uNzk4IDQuMTQ2LTIuMDM3eiIgZmlsbD0iIzVjODhjNSIvPjxwYXRoIGQ9Ik0yMjYuNzQyIDIyMi45ODhjLTkuMjY2IDAtMTYuNzc3IDcuMTctMTYuNzc3IDE2LjAxNC4wMDcgMi43NjIuNjYzIDUuNDc0IDIuMDkzIDcuODc1LjQzLjcwMy44MyAxLjQwOCAxLjE5IDIuMTA3LjMzMy41MDIuNjUgMS4wMDUuOTUgMS41MDguMzQzLjQ3Ny42NzMuOTU3Ljk4OCAxLjQ0IDEuMzEgMS43NjkgMi41IDMuNTAyIDMuNjM3IDUuMTY4Ljc5MyAxLjI3NSAxLjY4MyAyLjY0IDIuNDY2IDMuOTkgMi4zNjMgNC4wOTQgNC4wMDcgOC4wOTIgNC42IDEzLjkxNHYuMDEyYy4xODIuNDEyLjUxNi42NjYuODc5LjY2Ny40MDMtLjAwMS43NjgtLjMxNC45My0uNzk5LjYwMy01Ljc1NiAyLjIzOC05LjcyOSA0LjU4NS0xMy43OTQuNzgyLTEuMzUgMS42NzMtMi43MTUgMi40NjUtMy45OSAxLjEzNy0xLjY2NiAyLjMyOC0zLjQgMy42MzgtNS4xNjkuMzE1LS40ODIuNjQ1LS45NjIuOTg4LTEuNDM5LjMtLjUwMy42MTctMS4wMDYuOTUtMS41MDguMzU5LS43Ljc2LTEuNDA0IDEuMTktMi4xMDcgMS40MjYtMi40MDIgMi01LjExNCAyLjAwNC03Ljg3NSAwLTguODQ0LTcuNTExLTE2LjAxNC0xNi43NzYtMTYuMDE0eiIgZmlsbD0iI2RkNGIzZSIgcGFpbnQtb3JkZXI9Im1hcmtlcnMgc3Ryb2tlIGZpbGwiLz48ZWxsaXBzZSByeT0iNS41NjQiIHJ4PSI1LjgyOCIgY3k9IjIzOS4wMDIiIGN4PSIyMjYuNzQyIiBmaWxsPSIjODAyZDI3IiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjxwYXRoIGQ9Ik0xOTAuMzAxIDIzNy4yODNjLTQuNjcgMC04LjQ1NyAzLjg1My04LjQ1NyA4LjYwNnMzLjc4NiA4LjYwNyA4LjQ1NyA4LjYwN2MzLjA0MyAwIDQuODA2LS45NTggNi4zMzctMi41MTYgMS41My0xLjU1NyAyLjA4Ny0zLjkxMyAyLjA4Ny02LjI5IDAtLjM2Mi0uMDIzLS43MjItLjA2NC0xLjA3OWgtOC4yNTd2My4wNDNoNC44NWMtLjE5Ny43NTktLjUzMSAxLjQ1LTEuMDU4IDEuOTg2LS45NDIuOTU4LTIuMDI4IDEuNTQ4LTMuOTAxIDEuNTQ4LTIuODc2IDAtNS4yMDgtMi4zNzItNS4yMDgtNS4yOTkgMC0yLjkyNiAyLjMzMi01LjI5OSA1LjIwOC01LjI5OSAxLjM5OSAwIDIuNjE4LjQwNyAzLjU4NCAxLjI5M2wyLjM4MS0yLjM4YzAtLjAwMi0uMDAzLS4wMDQtLjAwNC0uMDA1LTEuNTg4LTEuNTI0LTMuNjItMi4yMTUtNS45NTUtMi4yMTV6bTQuNDMgNS42NmwuMDAzLjAwNnYtLjAwM3oiIGZpbGw9IiNmZmYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxNS4xODQgMjUxLjkyOWwtNy45OCA3Ljk3OSAyOC40NzcgMjguNDc1YTUuMjMzIDUuMjMzIDAgMDAuNDQ5LTIuMTIzdi0zMS4xNjVjLS40NjkuNjc1LS45MzQgMS4zNDktMS4zODIgMi4wMDUtLjc5MiAxLjI3NS0xLjY4MiAyLjY0LTIuNDY1IDMuOTktMi4zNDcgNC4wNjUtMy45ODIgOC4wMzgtNC41ODUgMTMuNzk0LS4xNjIuNDg1LS41MjcuNzk4LS45My43OTktLjM2My0uMDAxLS42OTctLjI1NS0uODc5LS42Njd2LS4wMTJjLS41OTMtNS44MjItMi4yMzctOS44Mi00LjYtMTMuOTE0LS43ODMtMS4zNS0xLjY3My0yLjcxNS0yLjQ2Ni0zLjk5LTEuMTM3LTEuNjY2LTIuMzI3LTMuNC0zLjYzNy01LjE2OWwtLjAwMi0uMDAzeiIgZmlsbD0iI2MzYzNjMyIvPjxwYXRoIGQ9Ik0yMTIuOTgzIDI0OC40OTVsLTM2Ljk1MiAzNi45NTN2LjgxMmE1LjIyNyA1LjIyNyAwIDAwNS4yMzggNS4yMzhoMS4wMTVsMzUuNjY2LTM1LjY2NmExMzYuMjc1IDEzNi4yNzUgMCAwMC0yLjc2NC0zLjkgMzcuNTc1IDM3LjU3NSAwIDAwLS45ODktMS40NCAzNS4xMjcgMzUuMTI3IDAgMDAtLjk1LTEuNTA4Yy0uMDgzLS4xNjItLjE3Ni0uMzI2LS4yNjQtLjQ4OXoiIGZpbGw9IiNmZGRjNGYiIHBhaW50LW9yZGVyPSJtYXJrZXJzIHN0cm9rZSBmaWxsIi8+PHBhdGggZD0iTTIxMS45OTggMjYxLjA4M2wtNi4xNTIgNi4xNTEgMjQuMjY0IDI0LjI2NGguNzgxYTUuMjI3IDUuMjI3IDAgMDA1LjIzOS01LjIzOHYtMS4wNDV6IiBmaWxsPSIjZmZmIiBwYWludC1vcmRlcj0ibWFya2VycyBzdHJva2UgZmlsbCIvPjwvZz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder{background:#4268b3}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik05NjcuNDg0IDBINTYuNTE3QzI1LjMwNCAwIDAgMjUuMzA0IDAgNTYuNTE3djkxMC45NjZDMCA5OTguNjk0IDI1LjI5NyAxMDI0IDU2LjUyMiAxMDI0SDU0N1Y2MjhINDE0VjQ3M2gxMzNWMzU5LjAyOWMwLTEzMi4yNjIgODAuNzczLTIwNC4yODIgMTk4Ljc1Ni0yMDQuMjgyIDU2LjUxMyAwIDEwNS4wODYgNC4yMDggMTE5LjI0NCA2LjA4OVYyOTlsLTgxLjYxNi4wMzdjLTYzLjk5MyAwLTc2LjM4NCAzMC40OTItNzYuMzg0IDc1LjIzNlY0NzNoMTUzLjQ4N2wtMTkuOTg2IDE1NUg3MDd2Mzk2aDI2MC40ODRjMzEuMjEzIDAgNTYuNTE2LTI1LjMwMyA1Ni41MTYtNTYuNTE2VjU2LjUxNUMxMDI0IDI1LjMwMyA5OTguNjk3IDAgOTY3LjQ4NCAwIiBmaWxsPSIjRkZGRkZFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#cdf}.ck-media__wrapper[data-oembed-url*="facebook.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder{background:linear-gradient(-135deg,#1400c7,#b800b1,#f50000)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTA0IiBoZWlnaHQ9IjUwNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0wIC4xNTloNTAzLjg0MVY1MDMuOTRIMHoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48cGF0aCBkPSJNMjUxLjkyMS4xNTljLTY4LjQxOCAwLTc2Ljk5Ny4yOS0xMDMuODY3IDEuNTE2LTI2LjgxNCAxLjIyMy00NS4xMjcgNS40ODItNjEuMTUxIDExLjcxLTE2LjU2NiA2LjQzNy0zMC42MTUgMTUuMDUxLTQ0LjYyMSAyOS4wNTYtMTQuMDA1IDE0LjAwNi0yMi42MTkgMjguMDU1LTI5LjA1NiA0NC42MjEtNi4yMjggMTYuMDI0LTEwLjQ4NyAzNC4zMzctMTEuNzEgNjEuMTUxQy4yOSAxNzUuMDgzIDAgMTgzLjY2MiAwIDI1Mi4wOGMwIDY4LjQxNy4yOSA3Ni45OTYgMS41MTYgMTAzLjg2NiAxLjIyMyAyNi44MTQgNS40ODIgNDUuMTI3IDExLjcxIDYxLjE1MSA2LjQzNyAxNi41NjYgMTUuMDUxIDMwLjYxNSAyOS4wNTYgNDQuNjIxIDE0LjAwNiAxNC4wMDUgMjguMDU1IDIyLjYxOSA0NC42MjEgMjkuMDU3IDE2LjAyNCA2LjIyNyAzNC4zMzcgMTAuNDg2IDYxLjE1MSAxMS43MDkgMjYuODcgMS4yMjYgMzUuNDQ5IDEuNTE2IDEwMy44NjcgMS41MTYgNjguNDE3IDAgNzYuOTk2LS4yOSAxMDMuODY2LTEuNTE2IDI2LjgxNC0xLjIyMyA0NS4xMjctNS40ODIgNjEuMTUxLTExLjcwOSAxNi41NjYtNi40MzggMzAuNjE1LTE1LjA1MiA0NC42MjEtMjkuMDU3IDE0LjAwNS0xNC4wMDYgMjIuNjE5LTI4LjA1NSAyOS4wNTctNDQuNjIxIDYuMjI3LTE2LjAyNCAxMC40ODYtMzQuMzM3IDExLjcwOS02MS4xNTEgMS4yMjYtMjYuODcgMS41MTYtMzUuNDQ5IDEuNTE2LTEwMy44NjYgMC02OC40MTgtLjI5LTc2Ljk5Ny0xLjUxNi0xMDMuODY3LTEuMjIzLTI2LjgxNC01LjQ4Mi00NS4xMjctMTEuNzA5LTYxLjE1MS02LjQzOC0xNi41NjYtMTUuMDUyLTMwLjYxNS0yOS4wNTctNDQuNjIxLTE0LjAwNi0xNC4wMDUtMjguMDU1LTIyLjYxOS00NC42MjEtMjkuMDU2LTE2LjAyNC02LjIyOC0zNC4zMzctMTAuNDg3LTYxLjE1MS0xMS43MUMzMjguOTE3LjQ0OSAzMjAuMzM4LjE1OSAyNTEuOTIxLjE1OXptMCA0NS4zOTFjNjcuMjY1IDAgNzUuMjMzLjI1NyAxMDEuNzk3IDEuNDY5IDI0LjU2MiAxLjEyIDM3LjkwMSA1LjIyNCA0Ni43NzggOC42NzQgMTEuNzU5IDQuNTcgMjAuMTUxIDEwLjAyOSAyOC45NjYgMTguODQ1IDguODE2IDguODE1IDE0LjI3NSAxNy4yMDcgMTguODQ1IDI4Ljk2NiAzLjQ1IDguODc3IDcuNTU0IDIyLjIxNiA4LjY3NCA0Ni43NzggMS4yMTIgMjYuNTY0IDEuNDY5IDM0LjUzMiAxLjQ2OSAxMDEuNzk4IDAgNjcuMjY1LS4yNTcgNzUuMjMzLTEuNDY5IDEwMS43OTctMS4xMiAyNC41NjItNS4yMjQgMzcuOTAxLTguNjc0IDQ2Ljc3OC00LjU3IDExLjc1OS0xMC4wMjkgMjAuMTUxLTE4Ljg0NSAyOC45NjYtOC44MTUgOC44MTYtMTcuMjA3IDE0LjI3NS0yOC45NjYgMTguODQ1LTguODc3IDMuNDUtMjIuMjE2IDcuNTU0LTQ2Ljc3OCA4LjY3NC0yNi41NiAxLjIxMi0zNC41MjcgMS40NjktMTAxLjc5NyAxLjQ2OS02Ny4yNzEgMC03NS4yMzctLjI1Ny0xMDEuNzk4LTEuNDY5LTI0LjU2Mi0xLjEyLTM3LjkwMS01LjIyNC00Ni43NzgtOC42NzQtMTEuNzU5LTQuNTctMjAuMTUxLTEwLjAyOS0yOC45NjYtMTguODQ1LTguODE1LTguODE1LTE0LjI3NS0xNy4yMDctMTguODQ1LTI4Ljk2Ni0zLjQ1LTguODc3LTcuNTU0LTIyLjIxNi04LjY3NC00Ni43NzgtMS4yMTItMjYuNTY0LTEuNDY5LTM0LjUzMi0xLjQ2OS0xMDEuNzk3IDAtNjcuMjY2LjI1Ny03NS4yMzQgMS40NjktMTAxLjc5OCAxLjEyLTI0LjU2MiA1LjIyNC0zNy45MDEgOC42NzQtNDYuNzc4IDQuNTctMTEuNzU5IDEwLjAyOS0yMC4xNTEgMTguODQ1LTI4Ljk2NiA4LjgxNS04LjgxNiAxNy4yMDctMTQuMjc1IDI4Ljk2Ni0xOC44NDUgOC44NzctMy40NSAyMi4yMTYtNy41NTQgNDYuNzc4LTguNjc0IDI2LjU2NC0xLjIxMiAzNC41MzItMS40NjkgMTAxLjc5OC0xLjQ2OXoiIGZpbGw9IiNGRkYiIG1hc2s9InVybCgjYikiLz48cGF0aCBkPSJNMjUxLjkyMSAzMzYuMDUzYy00Ni4zNzggMC04My45NzQtMzcuNTk2LTgzLjk3NC04My45NzMgMC00Ni4zNzggMzcuNTk2LTgzLjk3NCA4My45NzQtODMuOTc0IDQ2LjM3NyAwIDgzLjk3MyAzNy41OTYgODMuOTczIDgzLjk3NCAwIDQ2LjM3Ny0zNy41OTYgODMuOTczLTgzLjk3MyA4My45NzN6bTAtMjEzLjMzOGMtNzEuNDQ3IDAtMTI5LjM2NSA1Ny45MTgtMTI5LjM2NSAxMjkuMzY1IDAgNzEuNDQ2IDU3LjkxOCAxMjkuMzY0IDEyOS4zNjUgMTI5LjM2NCA3MS40NDYgMCAxMjkuMzY0LTU3LjkxOCAxMjkuMzY0LTEyOS4zNjQgMC03MS40NDctNTcuOTE4LTEyOS4zNjUtMTI5LjM2NC0xMjkuMzY1ek00MTYuNjI3IDExNy42MDRjMCAxNi42OTYtMTMuNTM1IDMwLjIzLTMwLjIzMSAzMC4yMy0xNi42OTUgMC0zMC4yMy0xMy41MzQtMzAuMjMtMzAuMjMgMC0xNi42OTYgMTMuNTM1LTMwLjIzMSAzMC4yMy0zMC4yMzEgMTYuNjk2IDAgMzAuMjMxIDEzLjUzNSAzMC4yMzEgMzAuMjMxIiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPg==)}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text{color:#ffe0fe}.ck-media__wrapper[data-oembed-url*="instagram.com"] .ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder{background:linear-gradient(90deg,#71c6f4,#0d70a5)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__icon{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0MDAgNDAwIj48cGF0aCBkPSJNNDAwIDIwMGMwIDExMC41LTg5LjUgMjAwLTIwMCAyMDBTMCAzMTAuNSAwIDIwMCA4OS41IDAgMjAwIDBzMjAwIDg5LjUgMjAwIDIwMHpNMTYzLjQgMzA1LjVjODguNyAwIDEzNy4yLTczLjUgMTM3LjItMTM3LjIgMC0yLjEgMC00LjItLjEtNi4yIDkuNC02LjggMTcuNi0xNS4zIDI0LjEtMjUtOC42IDMuOC0xNy45IDYuNC0yNy43IDcuNiAxMC02IDE3LjYtMTUuNCAyMS4yLTI2LjctOS4zIDUuNS0xOS42IDkuNS0zMC42IDExLjctOC44LTkuNC0yMS4zLTE1LjItMzUuMi0xNS4yLTI2LjYgMC00OC4yIDIxLjYtNDguMiA0OC4yIDAgMy44LjQgNy41IDEuMyAxMS00MC4xLTItNzUuNi0yMS4yLTk5LjQtNTAuNC00LjEgNy4xLTYuNSAxNS40LTYuNSAyNC4yIDAgMTYuNyA4LjUgMzEuNSAyMS41IDQwLjEtNy45LS4yLTE1LjMtMi40LTIxLjgtNnYuNmMwIDIzLjQgMTYuNiA0Mi44IDM4LjcgNDcuMy00IDEuMS04LjMgMS43LTEyLjcgMS43LTMuMSAwLTYuMS0uMy05LjEtLjkgNi4xIDE5LjIgMjMuOSAzMy4xIDQ1IDMzLjUtMTYuNSAxMi45LTM3LjMgMjAuNi01OS45IDIwLjYtMy45IDAtNy43LS4yLTExLjUtLjcgMjEuMSAxMy44IDQ2LjUgMjEuOCA3My43IDIxLjgiIGZpbGw9IiNmZmYiLz48L3N2Zz4=)}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text{color:#b8e6ff}.ck-media__wrapper[data-oembed-url*="twitter.com"] .ck.ck-media__placeholder .ck-media__placeholder__url__text:hover{color:#fff}'},function(t,e,i){var n=i(1),o=i(105);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck.ck-media-form{display:flex;align-items:flex-start;flex-direction:row;flex-wrap:nowrap}.ck.ck-media-form .ck-labeled-field-view{display:inline-block}.ck.ck-media-form .ck-label{display:none}@media screen and (max-width:600px){.ck.ck-media-form{flex-wrap:wrap}.ck.ck-media-form .ck-labeled-field-view{flex-basis:100%}.ck.ck-media-form .ck-button{flex-basis:50%}}"},function(t,e,i){var n=i(1),o=i(107);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-content .media{clear:both;margin:.9em 0;display:block;min-width:15em}"},function(t,e,i){var n=i(1),o=i(109);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-color-table-focused-cell-background:rgba(158,207,250,0.3)}.ck-widget.table td.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table td.ck-editor__nested-editable:focus,.ck-widget.table th.ck-editor__nested-editable.ck-editor__nested-editable_focused,.ck-widget.table th.ck-editor__nested-editable:focus{background:var(--ck-color-table-focused-cell-background);border-style:none;outline:1px solid var(--ck-color-focus-border);outline-offset:-1px}"},function(t,e,i){var n=i(1),o=i(111);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck .ck-insert-table-dropdown__grid{display:flex;flex-direction:row;flex-wrap:wrap}:root{--ck-insert-table-dropdown-padding:10px;--ck-insert-table-dropdown-box-height:11px;--ck-insert-table-dropdown-box-width:12px;--ck-insert-table-dropdown-box-margin:1px}.ck .ck-insert-table-dropdown__grid{width:calc(var(--ck-insert-table-dropdown-box-width)*10 + var(--ck-insert-table-dropdown-box-margin)*20 + var(--ck-insert-table-dropdown-padding)*2);padding:var(--ck-insert-table-dropdown-padding) var(--ck-insert-table-dropdown-padding) 0}.ck .ck-insert-table-dropdown__label{text-align:center}.ck .ck-insert-table-dropdown-grid-box{width:var(--ck-insert-table-dropdown-box-width);height:var(--ck-insert-table-dropdown-box-height);margin:var(--ck-insert-table-dropdown-box-margin);border:1px solid var(--ck-color-base-border);border-radius:1px}.ck .ck-insert-table-dropdown-grid-box.ck-on{border-color:var(--ck-color-focus-border);background:var(--ck-color-focus-outer-shadow)}"},function(t,e,i){var n=i(1),o=i(113);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=':root{--ck-table-selected-cell-background:rgba(158,207,250,0.3)}.ck.ck-editor__editable .table table td.ck-editor__editable_selected,.ck.ck-editor__editable .table table th.ck-editor__editable_selected{position:relative;caret-color:transparent;outline:unset;box-shadow:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected:after,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:after{content:"";pointer-events:none;background-color:var(--ck-table-selected-cell-background);position:absolute;top:0;left:0;right:0;bottom:0}.ck.ck-editor__editable .table table td.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table td.ck-editor__editable_selected:focus,.ck.ck-editor__editable .table table th.ck-editor__editable_selected ::selection,.ck.ck-editor__editable .table table th.ck-editor__editable_selected:focus{background-color:transparent}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget{outline:unset}.ck.ck-editor__editable .table table td.ck-editor__editable_selected .ck-widget>.ck-widget__selection-handle,.ck.ck-editor__editable .table table th.ck-editor__editable_selected .ck-widget>.ck-widget__selection-handle{display:none}'},function(t,e,i){var n=i(1),o=i(115);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=".ck-content .table{margin:.9em auto;display:table}.ck-content .table table{border-collapse:collapse;border-spacing:0;width:100%;height:100%;border:1px double #b3b3b3}.ck-content .table table td,.ck-content .table table th{min-width:2em;padding:.4em;border:1px solid #bfbfbf}.ck-content .table table th{font-weight:700;background:hsla(0,0%,0%,5%)}.ck-content[dir=rtl] .table th{text-align:right}.ck-content[dir=ltr] .table th{text-align:left}.ck-editor__editable .ck-table-bogus-paragraph{display:inline-block;width:100%}"},function(t,e,i){var n=i(1),o=i(117);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-mention-list-max-height:300px}.ck.ck-mentions{max-height:var(--ck-mention-list-max-height);overflow-y:auto;overflow-x:hidden;overscroll-behavior:contain}.ck.ck-mentions>.ck-list__item{overflow:hidden;flex-shrink:0}"},function(t,e,i){var n=i(1),o=i(119);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]),n(o,{injectType:"singletonStyleTag",attributes:{"data-cke":!0},insert:"head",singleton:!0}),t.exports=o.locals||{}},function(t,e){t.exports=":root{--ck-color-mention-background:rgba(153,0,48,0.1);--ck-color-mention-text:#990030}.ck-content .mention{background:var(--ck-color-mention-background);color:var(--ck-color-mention-text)}"},function(t,e,i){"use strict";i.r(e),i.d(e,"default",function(){return Py});class n{constructor(t,e){this.source=t,this.name=e,this.path=[],this.stop=function t(){t.called=!0},this.off=function t(){t.called=!0}}}const o=new Array(256).fill().map((t,e)=>("0"+e.toString(16)).slice(-2));function r(){const t=4294967296*Math.random()>>>0,e=4294967296*Math.random()>>>0,i=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return"e"+o[t>>0&255]+o[t>>8&255]+o[t>>16&255]+o[t>>24&255]+o[e>>0&255]+o[e>>8&255]+o[e>>16&255]+o[e>>24&255]+o[i>>0&255]+o[i>>8&255]+o[i>>16&255]+o[i>>24&255]+o[n>>0&255]+o[n>>8&255]+o[n>>16&255]+o[n>>24&255]}var s={get(t){return"number"!=typeof t?this[t]||this.normal:t},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5},a=(i(6),i(0));const l=Symbol("listeningTo"),c=Symbol("emitterId");var h={on(t,e,i={}){this.listenTo(this,t,e,i)},once(t,e,i){let n=!1;this.listenTo(this,t,function(t,...i){n||(n=!0,t.off(),e.call(this,t,...i))},i)},off(t,e){this.stopListening(this,t,e)},listenTo(t,e,i,n={}){let o,r;this[l]||(this[l]={});const s=this[l];u(t)||d(t);const a=u(t);(o=s[a])||(o=s[a]={emitter:t,callbacks:{}}),(r=o.callbacks[e])||(r=o.callbacks[e]=[]),r.push(i),function(t,e,i,n,o){e._addEventListener?e._addEventListener(i,n,o):t._addEventListener.call(e,i,n,o)}(this,t,e,i,n)},stopListening(t,e,i){const n=this[l];let o=t&&u(t);const r=n&&o&&n[o],s=r&&e&&r.callbacks[e];if(!(!n||t&&!r||e&&!s))if(i)m(this,t,e,i),-1!==s.indexOf(i)&&(1===s.length?delete r.callbacks[e]:m(this,t,e,i));else if(s){for(;i=s.pop();)m(this,t,e,i);delete r.callbacks[e]}else if(r){for(e in r.callbacks)this.stopListening(t,e);delete n[o]}else{for(o in n)this.stopListening(n[o].emitter);delete this[l]}},fire(t,...e){try{const i=t instanceof n?t:new n(this,t),o=i.name;let r=function t(e,i){let n;return e._events&&(n=e._events[i])&&n.callbacks.length?n.callbacks:i.indexOf(":")>-1?t(e,i.substr(0,i.lastIndexOf(":"))):null}(this,o);if(i.path.push(this),r){const t=[i,...e];r=Array.from(r);for(let e=0;e<r.length&&(r[e].callback.apply(this,t),i.off.called&&(delete i.off.called,this._removeEventListener(o,r[e].callback)),!i.stop.called);e++);}if(this._delegations){const t=this._delegations.get(o),n=this._delegations.get("*");t&&g(t,i,e),n&&g(n,i,e)}return i.return}catch(t){a.a.rethrowUnexpectedError(t,this)}},delegate(...t){return{to:(e,i)=>{this._delegations||(this._delegations=new Map),t.forEach(t=>{const n=this._delegations.get(t);n?n.set(e,i):this._delegations.set(t,new Map([[e,i]]))})}}},stopDelegating(t,e){if(this._delegations)if(t)if(e){const i=this._delegations.get(t);i&&i.delete(e)}else this._delegations.delete(t);else this._delegations.clear()},_addEventListener(t,e,i){!function(t,e){const i=f(t);if(i[e])return;let n=e,o=null;const r=[];for(;""!==n&&!i[n];)i[n]={callbacks:[],childEvents:[]},r.push(i[n]),o&&i[n].childEvents.push(o),o=n,n=n.substr(0,n.lastIndexOf(":"));if(""!==n){for(const t of r)t.callbacks=i[n].callbacks.slice();i[n].childEvents.push(o)}}(this,t);const n=p(this,t),o=s.get(i.priority),r={callback:e,priority:o};for(const s of n){let t=!1;for(let e=0;e<s.length;e++)if(s[e].priority<o){s.splice(e,0,r),t=!0;break}t||s.push(r)}},_removeEventListener(t,e){const i=p(this,t);for(const n of i)for(let t=0;t<n.length;t++)n[t].callback==e&&(n.splice(t,1),t--)}};function d(t,e){t[c]||(t[c]=e||r())}function u(t){return t[c]}function f(t){return t._events||Object.defineProperty(t,"_events",{value:{}}),t._events}function p(t,e){const i=f(t)[e];if(!i)return[];let n=[i.callbacks];for(let o=0;o<i.childEvents.length;o++){const e=p(t,i.childEvents[o]);n=n.concat(e)}return n}function g(t,e,i){for(let[o,r]of t){r?"function"==typeof r&&(r=r(e.name)):r=e.name;const t=new n(e.source,r);t.path=[...e.path],o.fire(t,...i)}}function m(t,e,i,n){e._removeEventListener?e._removeEventListener(i,n):t._removeEventListener.call(e,i,n)}var v,y=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},b=i(3),w=b.a.Symbol,k=Object.prototype,_=k.hasOwnProperty,x=k.toString,C=w?w.toStringTag:void 0,E=Object.prototype.toString,T=w?w.toStringTag:void 0,S=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":T&&T in Object(t)?function(t){var e=_.call(t,C),i=t[C];try{t[C]=void 0;var n=!0}catch(t){}var o=x.call(t);return n&&(e?t[C]=i:delete t[C]),o}(t):function(t){return E.call(t)}(t)},A=function(t){if(!y(t))return!1;var e=S(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},O=b.a["__core-js_shared__"],I=(v=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+v:"",P=Function.prototype.toString,M=function(t){if(null!=t){try{return P.call(t)}catch(t){}try{return t+""}catch(t){}}return""},D=/^\[object .+?Constructor\]$/,N=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),R=function(t,e){var i=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!y(t)||function(t){return!!I&&I in t}(t))&&(A(t)?N:D).test(M(t))}(i)?i:void 0},z=function(){try{var t=R(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),F=function(t,e,i){"__proto__"==e&&z?z(t,e,{configurable:!0,enumerable:!0,value:i,writable:!0}):t[e]=i},L=function(t,e){return t===e||t!=t&&e!=e},B=Object.prototype.hasOwnProperty,j=function(t,e,i){var n=t[e];B.call(t,e)&&L(n,i)&&(void 0!==i||e in t)||F(t,e,i)},V=function(t,e,i,n){var o=!i;i||(i={});for(var r=-1,s=e.length;++r<s;){var a=e[r],l=n?n(i[a],t[a],a,i,t):void 0;void 0===l&&(l=t[a]),o?F(i,a,l):j(i,a,l)}return i},H=function(t){return t},W=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)},q=Math.max,U=function(t){return function(){return t}},Y=Date.now,G=function(t){var e=0,i=0;return function(){var n=Y(),o=16-(n-i);if(i=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(z?function(t,e){return z(t,"toString",{configurable:!0,enumerable:!1,value:U(e),writable:!0})}:H),Z=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},$=function(t){return null!=t&&Z(t.length)&&!A(t)},X=/^(?:0|[1-9]\d*)$/,K=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&X.test(t))&&t>-1&&t%1==0&&t<e},Q=function(t){return function(t,e){return G(function(t,e,i){return e=q(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,r=q(n.length-e,0),s=Array(r);++o<r;)s[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=i(s),W(t,this,a)}}(t,e,H),t+"")}(function(e,i){var n=-1,o=i.length,r=o>1?i[o-1]:void 0,s=o>2?i[2]:void 0;for(r=t.length>3&&"function"==typeof r?(o--,r):void 0,s&&function(t,e,i){if(!y(i))return!1;var n=typeof e;return!!("number"==n?$(i)&&K(e,i.length):"string"==n&&e in i)&&L(i[e],t)}(i[0],i[1],s)&&(r=o<3?void 0:r,o=1),e=Object(e);++n<o;){var a=i[n];a&&t(e,a,n,r)}return e})},J=function(t){return null!=t&&"object"==typeof t},tt=function(t){return J(t)&&"[object Arguments]"==S(t)},et=Object.prototype,it=et.hasOwnProperty,nt=et.propertyIsEnumerable,ot=tt(function(){return arguments}())?tt:function(t){return J(t)&&it.call(t,"callee")&&!nt.call(t,"callee")},rt=Array.isArray,st=i(4),at={};at["[object Float32Array]"]=at["[object Float64Array]"]=at["[object Int8Array]"]=at["[object Int16Array]"]=at["[object Int32Array]"]=at["[object Uint8Array]"]=at["[object Uint8ClampedArray]"]=at["[object Uint16Array]"]=at["[object Uint32Array]"]=!0,at["[object Arguments]"]=at["[object Array]"]=at["[object ArrayBuffer]"]=at["[object Boolean]"]=at["[object DataView]"]=at["[object Date]"]=at["[object Error]"]=at["[object Function]"]=at["[object Map]"]=at["[object Number]"]=at["[object Object]"]=at["[object RegExp]"]=at["[object Set]"]=at["[object String]"]=at["[object WeakMap]"]=!1;var lt=function(t){return function(e){return t(e)}},ct=i(5),ht=ct.a&&ct.a.isTypedArray,dt=ht?lt(ht):function(t){return J(t)&&Z(t.length)&&!!at[S(t)]},ut=Object.prototype.hasOwnProperty,ft=function(t,e){var i=rt(t),n=!i&&ot(t),o=!i&&!n&&Object(st.a)(t),r=!i&&!n&&!o&&dt(t),s=i||n||o||r,a=s?function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}(t.length,String):[],l=a.length;for(var c in t)!e&&!ut.call(t,c)||s&&("length"==c||o&&("offset"==c||"parent"==c)||r&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||K(c,l))||a.push(c);return a},pt=Object.prototype,gt=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||pt)},mt=Object.prototype.hasOwnProperty,vt=function(t){return $(t)?ft(t,!0):function(t){if(!y(t))return function(t){var e=[];if(null!=t)for(var i in Object(t))e.push(i);return e}(t);var e=gt(t),i=[];for(var n in t)("constructor"!=n||!e&&mt.call(t,n))&&i.push(n);return i}(t)},yt=Q(function(t,e){V(e,vt(e),t)});const bt=Symbol("observableProperties"),wt=Symbol("boundObservables"),kt=Symbol("boundProperties"),_t=Symbol("decoratedMethods"),xt=Symbol("decoratedOriginal"),Ct={set(t,e){if(y(t))return void Object.keys(t).forEach(e=>{this.set(e,t[e])},this);Tt(this);const i=this[bt];if(t in this&&!i.has(t))throw new a.a("observable-set-cannot-override",this);Object.defineProperty(this,t,{enumerable:!0,configurable:!0,get:()=>i.get(t),set(e){const n=i.get(t);let o=this.fire("set:"+t,t,e,n);void 0===o&&(o=e),n===o&&i.has(t)||(i.set(t,o),this.fire("change:"+t,t,o,n))}}),this[t]=e},bind(...t){if(!t.length||!Ot(t))throw new a.a("observable-bind-wrong-properties",this);if(new Set(t).size!==t.length)throw new a.a("observable-bind-duplicate-properties",this);Tt(this);const e=this[kt];t.forEach(t=>{if(e.has(t))throw new a.a("observable-bind-rebind",this)});const i=new Map;return t.forEach(t=>{const n={property:t,to:[]};e.set(t,n),i.set(t,n)}),{to:St,toMany:At,_observable:this,_bindProperties:t,_to:[],_bindings:i}},unbind(...t){if(!this[bt])return;const e=this[kt],i=this[wt];if(t.length){if(!Ot(t))throw new a.a("observable-unbind-wrong-properties",this);t.forEach(t=>{const n=e.get(t);if(!n)return;let o,r,s,a;n.to.forEach(t=>{o=t[0],r=t[1],s=i.get(o),a=s[r],a.delete(n),a.size||delete s[r],Object.keys(s).length||(i.delete(o),this.stopListening(o,"change"))}),e.delete(t)})}else i.forEach((t,e)=>{this.stopListening(e,"change")}),i.clear(),e.clear()},decorate(t){const e=this[t];if(!e)throw new a.a("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:t});this.on(t,(t,i)=>{t.return=e.apply(this,i)}),this[t]=function(...e){return this.fire(t,e)},this[t][xt]=e,this[_t]||(this[_t]=[]),this[_t].push(t)}};yt(Ct,h),Ct.stopListening=function(t,e,i){if(!t&&this[_t]){for(const t of this[_t])this[t]=this[t][xt];delete this[_t]}h.stopListening.call(this,t,e,i)};var Et=Ct;function Tt(t){t[bt]||(Object.defineProperty(t,bt,{value:new Map}),Object.defineProperty(t,wt,{value:new Map}),Object.defineProperty(t,kt,{value:new Map}))}function St(...t){const e=function(...t){if(!t.length)throw new a.a("observable-bind-to-parse-error",null);const e={to:[]};let i;return"function"==typeof t[t.length-1]&&(e.callback=t.pop()),t.forEach(t=>{if("string"==typeof t)i.properties.push(t);else{if("object"!=typeof t)throw new a.a("observable-bind-to-parse-error",null);i={observable:t,properties:[]},e.to.push(i)}}),e}(...t),i=Array.from(this._bindings.keys()),n=i.length;if(!e.callback&&e.to.length>1)throw new a.a("observable-bind-to-no-callback",this);if(n>1&&e.callback)throw new a.a("observable-bind-to-extra-callback",this);var o;e.to.forEach(t=>{if(t.properties.length&&t.properties.length!==n)throw new a.a("observable-bind-to-properties-length",this);t.properties.length||(t.properties=this._bindProperties)}),this._to=e.to,e.callback&&(this._bindings.get(i[0]).callback=e.callback),o=this._observable,this._to.forEach(t=>{const e=o[wt];let i;e.get(t.observable)||o.listenTo(t.observable,"change",(n,r)=>{i=e.get(t.observable)[r],i&&i.forEach(t=>{It(o,t.property)})})}),function(t){let e;t._bindings.forEach((i,n)=>{t._to.forEach(o=>{e=o.properties[i.callback?0:t._bindProperties.indexOf(n)],i.to.push([o.observable,e]),function(t,e,i,n){const o=t[wt],r=o.get(i),s=r||{};s[n]||(s[n]=new Set),s[n].add(e),r||o.set(i,s)}(t._observable,i,o.observable,e)})})}(this),this._bindProperties.forEach(t=>{It(this._observable,t)})}function At(t,e,i){if(this._bindings.size>1)throw new a.a("observable-bind-to-many-not-one-binding",this);this.to(...function(t,e){const i=t.map(t=>[t,e]);return Array.prototype.concat.apply([],i)}(t,e),i)}function Ot(t){return t.every(t=>"string"==typeof t)}function It(t,e){const i=t[kt].get(e);let n;i.callback?n=i.callback.apply(t,i.to.map(t=>t[0][t[1]])):(n=i.to[0],n=n[0][n[1]]),Object.prototype.hasOwnProperty.call(t,e)?t[e]=n:t.set(e,n)}function Pt(t,...e){e.forEach(e=>{Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e)).forEach(i=>{if(i in t.prototype)return;const n=Object.getOwnPropertyDescriptor(e,i);n.enumerable=!1,Object.defineProperty(t.prototype,i,n)})})}class Mt{constructor(t){this.editor=t,this.set("isEnabled",!0),this._disableStack=new Set}forceDisabled(t){this._disableStack.add(t),1==this._disableStack.size&&(this.on("set:isEnabled",Dt,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),0==this._disableStack.size&&(this.off("set:isEnabled",Dt),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function Dt(t){t.return=!1,t.stop()}Pt(Mt,Et);class Nt{constructor(t){this.editor=t,this.set("value",void 0),this.set("isEnabled",!1),this.affectsData=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.on("execute",t=>{this.isEnabled||t.stop()},{priority:"high"}),this.listenTo(t,"change:isReadOnly",(t,e,i)=>{i&&this.affectsData?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")})}refresh(){this.isEnabled=!0}forceDisabled(t){this._disableStack.add(t),1==this._disableStack.size&&(this.on("set:isEnabled",Rt,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(t){this._disableStack.delete(t),0==this._disableStack.size&&(this.off("set:isEnabled",Rt),this.refresh())}execute(){}destroy(){this.stopListening()}}function Rt(t){t.return=!1,t.stop()}Pt(Nt,Et);class zt extends Nt{constructor(t){super(t),this._childCommands=[]}refresh(){}execute(...t){const e=this._getFirstEnabledCommand();return null!=e&&e.execute(t)}registerChildCommand(t){this._childCommands.push(t),t.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){return this._childCommands.find(t=>t.isEnabled)}}var Ft=function(t,e){return function(i){return t(e(i))}},Lt=Ft(Object.getPrototypeOf,Object),Bt=Function.prototype.toString,jt=Object.prototype.hasOwnProperty,Vt=Bt.call(Object),Ht=function(t){if(!J(t)||"[object Object]"!=S(t))return!1;var e=Lt(t);if(null===e)return!0;var i=jt.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Bt.call(i)==Vt},Wt=function(t,e){for(var i=t.length;i--;)if(L(t[i][0],e))return i;return-1},qt=Array.prototype.splice;function Ut(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}Ut.prototype.clear=function(){this.__data__=[],this.size=0},Ut.prototype.delete=function(t){var e=this.__data__,i=Wt(e,t);return!(i<0||(i==e.length-1?e.pop():qt.call(e,i,1),--this.size,0))},Ut.prototype.get=function(t){var e=this.__data__,i=Wt(e,t);return i<0?void 0:e[i][1]},Ut.prototype.has=function(t){return Wt(this.__data__,t)>-1},Ut.prototype.set=function(t,e){var i=this.__data__,n=Wt(i,t);return n<0?(++this.size,i.push([t,e])):i[n][1]=e,this};var Yt=Ut,Gt=R(b.a,"Map"),Zt=R(Object,"create"),$t=Object.prototype.hasOwnProperty,Xt=Object.prototype.hasOwnProperty;function Kt(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}Kt.prototype.clear=function(){this.__data__=Zt?Zt(null):{},this.size=0},Kt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Kt.prototype.get=function(t){var e=this.__data__;if(Zt){var i=e[t];return"__lodash_hash_undefined__"===i?void 0:i}return $t.call(e,t)?e[t]:void 0},Kt.prototype.has=function(t){var e=this.__data__;return Zt?void 0!==e[t]:Xt.call(e,t)},Kt.prototype.set=function(t,e){var i=this.__data__;return this.size+=this.has(t)?0:1,i[t]=Zt&&void 0===e?"__lodash_hash_undefined__":e,this};var Qt=Kt,Jt=function(t,e){var i=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?i["string"==typeof e?"string":"hash"]:i.map};function te(t){var e=-1,i=null==t?0:t.length;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}te.prototype.clear=function(){this.size=0,this.__data__={hash:new Qt,map:new(Gt||Yt),string:new Qt}},te.prototype.delete=function(t){var e=Jt(this,t).delete(t);return this.size-=e?1:0,e},te.prototype.get=function(t){return Jt(this,t).get(t)},te.prototype.has=function(t){return Jt(this,t).has(t)},te.prototype.set=function(t,e){var i=Jt(this,t),n=i.size;return i.set(t,e),this.size+=i.size==n?0:1,this};var ee=te;function ie(t){var e=this.__data__=new Yt(t);this.size=e.size}ie.prototype.clear=function(){this.__data__=new Yt,this.size=0},ie.prototype.delete=function(t){var e=this.__data__,i=e.delete(t);return this.size=e.size,i},ie.prototype.get=function(t){return this.__data__.get(t)},ie.prototype.has=function(t){return this.__data__.has(t)},ie.prototype.set=function(t,e){var i=this.__data__;if(i instanceof Yt){var n=i.__data__;if(!Gt||n.length<199)return n.push([t,e]),this.size=++i.size,this;i=this.__data__=new ee(n)}return i.set(t,e),this.size=i.size,this};var ne=ie,oe=Ft(Object.keys,Object),re=Object.prototype.hasOwnProperty,se=function(t){return $(t)?ft(t):function(t){if(!gt(t))return oe(t);var e=[];for(var i in Object(t))re.call(t,i)&&"constructor"!=i&&e.push(i);return e}(t)},ae=i(9),le=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e},ce=function(){return[]},he=Object.prototype.propertyIsEnumerable,de=Object.getOwnPropertySymbols,ue=de?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var i=-1,n=null==t?0:t.length,o=0,r=[];++i<n;){var s=t[i];e(s)&&(r[o++]=s)}return r}(de(t),function(e){return he.call(t,e)}))}:ce,fe=function(t,e){for(var i=-1,n=e.length,o=t.length;++i<n;)t[o+i]=e[i];return t},pe=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)fe(e,ue(t)),t=Lt(t);return e}:ce,ge=function(t,e,i){var n=e(t);return rt(t)?n:fe(n,i(t))},me=function(t){return ge(t,se,ue)},ve=function(t){return ge(t,vt,pe)},ye=R(b.a,"DataView"),be=R(b.a,"Promise"),we=R(b.a,"Set"),ke=R(b.a,"WeakMap"),_e=M(ye),xe=M(Gt),Ce=M(be),Ee=M(we),Te=M(ke),Se=S;(ye&&"[object DataView]"!=Se(new ye(new ArrayBuffer(1)))||Gt&&"[object Map]"!=Se(new Gt)||be&&"[object Promise]"!=Se(be.resolve())||we&&"[object Set]"!=Se(new we)||ke&&"[object WeakMap]"!=Se(new ke))&&(Se=function(t){var e=S(t),i="[object Object]"==e?t.constructor:void 0,n=i?M(i):"";if(n)switch(n){case _e:return"[object DataView]";case xe:return"[object Map]";case Ce:return"[object Promise]";case Ee:return"[object Set]";case Te:return"[object WeakMap]"}return e});var Ae=Se,Oe=Object.prototype.hasOwnProperty,Ie=b.a.Uint8Array,Pe=function(t){var e=new t.constructor(t.byteLength);return new Ie(e).set(new Ie(t)),e},Me=/\w*$/,De=w?w.prototype:void 0,Ne=De?De.valueOf:void 0,Re=function(t,e){var i=e?Pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)},ze=Object.create,Fe=function(){function t(){}return function(e){if(!y(e))return{};if(ze)return ze(e);t.prototype=e;var i=new t;return t.prototype=void 0,i}}(),Le=function(t){return"function"!=typeof t.constructor||gt(t)?{}:Fe(Lt(t))},Be=ct.a&&ct.a.isMap,je=Be?lt(Be):function(t){return J(t)&&"[object Map]"==Ae(t)},Ve=ct.a&&ct.a.isSet,He=Ve?lt(Ve):function(t){return J(t)&&"[object Set]"==Ae(t)},We={};We["[object Arguments]"]=We["[object Array]"]=We["[object ArrayBuffer]"]=We["[object DataView]"]=We["[object Boolean]"]=We["[object Date]"]=We["[object Float32Array]"]=We["[object Float64Array]"]=We["[object Int8Array]"]=We["[object Int16Array]"]=We["[object Int32Array]"]=We["[object Map]"]=We["[object Number]"]=We["[object Object]"]=We["[object RegExp]"]=We["[object Set]"]=We["[object String]"]=We["[object Symbol]"]=We["[object Uint8Array]"]=We["[object Uint8ClampedArray]"]=We["[object Uint16Array]"]=We["[object Uint32Array]"]=!0,We["[object Error]"]=We["[object Function]"]=We["[object WeakMap]"]=!1;var qe=function t(e,i,n,o,r,s){var a,l=1&i,c=2&i,h=4&i;if(n&&(a=r?n(e,o,r,s):n(e)),void 0!==a)return a;if(!y(e))return e;var d=rt(e);if(d){if(a=function(t){var e=t.length,i=new t.constructor(e);return e&&"string"==typeof t[0]&&Oe.call(t,"index")&&(i.index=t.index,i.input=t.input),i}(e),!l)return le(e,a)}else{var u=Ae(e),f="[object Function]"==u||"[object GeneratorFunction]"==u;if(Object(st.a)(e))return Object(ae.a)(e,l);if("[object Object]"==u||"[object Arguments]"==u||f&&!r){if(a=c||f?{}:Le(e),!l)return c?function(t,e){return V(t,pe(t),e)}(e,function(t,e){return t&&V(e,vt(e),t)}(a,e)):function(t,e){return V(t,ue(t),e)}(e,function(t,e){return t&&V(e,se(e),t)}(a,e))}else{if(!We[u])return r?e:{};a=function(t,e,i){var n=t.constructor;switch(e){case"[object ArrayBuffer]":return Pe(t);case"[object Boolean]":case"[object Date]":return new n(+t);case"[object DataView]":return function(t,e){var i=e?Pe(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}(t,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Re(t,i);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Me.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Set]":return new n;case"[object Symbol]":return function(t){return Ne?Object(Ne.call(t)):{}}(t)}}(e,u,l)}}s||(s=new ne);var p=s.get(e);if(p)return p;s.set(e,a),He(e)?e.forEach(function(o){a.add(t(o,i,n,o,e,s))}):je(e)&&e.forEach(function(o,r){a.set(r,t(o,i,n,r,e,s))});var g=d?void 0:(h?c?ve:me:c?vt:se)(e);return function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n&&!1!==e(t[i],i););}(g||e,function(o,r){g&&(o=e[r=o]),j(a,r,t(o,i,n,r,e,s))}),a},Ue=function(t,e){return qe(t,5,e="function"==typeof e?e:void 0)},Ye=function(t){return J(t)&&1===t.nodeType&&!Ht(t)};class Ge{constructor(t,e){this._config={},e&&this.define(Ze(e)),t&&this._setObjectToTarget(this._config,t)}set(t,e){this._setToTarget(this._config,t,e)}define(t,e){this._setToTarget(this._config,t,e,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,e,i,n=!1){if(Ht(e))return void this._setObjectToTarget(t,e,n);const o=e.split(".");e=o.pop();for(const r of o)Ht(t[r])||(t[r]={}),t=t[r];if(Ht(i))return Ht(t[e])||(t[e]={}),void this._setObjectToTarget(t=t[e],i,n);n&&void 0!==t[e]||(t[e]=i)}_getFromSource(t,e){const i=e.split(".");e=i.pop();for(const n of i){if(!Ht(t[n])){t=null;break}t=t[n]}return t?Ze(t[e]):void 0}_setObjectToTarget(t,e,i){Object.keys(e).forEach(n=>{this._setToTarget(t,n,e[n],i)})}}function Ze(t){return Ue(t,$e)}function $e(t){return Ye(t)?t:void 0}function Xe(t){return!(!t||!t[Symbol.iterator])}class Ke{constructor(t={},e={}){const i=Xe(t);if(i||(e=t),this._items=[],this._itemMap=new Map,this._idProperty=e.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],i)for(const n of t)this._items.push(n),this._itemMap.set(this._getItemIdBeforeAdding(n),n)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(t,e){return this.addMany([t],e)}addMany(t,e){if(void 0===e)e=this._items.length;else if(e>this._items.length||e<0)throw new a.a("collection-add-item-invalid-index",this);for(let i=0;i<t.length;i++){const n=t[i],o=this._getItemIdBeforeAdding(n),r=e+i;this._items.splice(r,0,n),this._itemMap.set(o,n),this.fire("add",n,r)}return this.fire("change",{added:t,removed:[],index:e}),this}get(t){let e;if("string"==typeof t)e=this._itemMap.get(t);else{if("number"!=typeof t)throw new a.a("collection-get-invalid-arg",this);e=this._items[t]}return e||null}has(t){return this._itemMap.has("string"==typeof t?t:t[this._idProperty])}getIndex(t){let e;return e="string"==typeof t?this._itemMap.get(t):t,this._items.indexOf(e)}remove(t){const[e,i]=this._remove(t);return this.fire("change",{added:[],removed:[e],index:i}),e}map(t,e){return this._items.map(t,e)}find(t,e){return this._items.find(t,e)}filter(t,e){return this._items.filter(t,e)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const t=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:t,index:0})}bindTo(t){if(this._bindToCollection)throw new a.a("collection-bind-to-rebind",this);return this._bindToCollection=t,{as:t=>{this._setUpBindToBinding(e=>new t(e))},using:t=>{this._setUpBindToBinding("function"==typeof t?e=>t(e):e=>e[t])}}}_setUpBindToBinding(t){const e=this._bindToCollection,i=(i,n,o)=>{const r=e._bindToCollection==this,s=e._bindToInternalToExternalMap.get(n);if(r&&s)this._bindToExternalToInternalMap.set(n,s),this._bindToInternalToExternalMap.set(s,n);else{const i=t(n);if(!i)return void this._skippedIndexesFromExternal.push(o);let r=o;for(const t of this._skippedIndexesFromExternal)o>t&&r--;for(const t of e._skippedIndexesFromExternal)r>=t&&r++;this._bindToExternalToInternalMap.set(n,i),this._bindToInternalToExternalMap.set(i,n),this.add(i,r);for(let t=0;t<e._skippedIndexesFromExternal.length;t++)r<=e._skippedIndexesFromExternal[t]&&e._skippedIndexesFromExternal[t]++}};for(const n of e)i(0,n,e.getIndex(n));this.listenTo(e,"add",i),this.listenTo(e,"remove",(t,e,i)=>{const n=this._bindToExternalToInternalMap.get(e);n&&this.remove(n),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((t,e)=>(i<e&&t.push(e-1),i>e&&t.push(e),t),[])})}_getItemIdBeforeAdding(t){const e=this._idProperty;let i;if(e in t){if(i=t[e],"string"!=typeof i)throw new a.a("collection-add-invalid-id",this);if(this.get(i))throw new a.a("collection-add-item-already-exists",this)}else t[e]=i=r();return i}_remove(t){let e,i,n,o=!1;const r=this._idProperty;if("string"==typeof t?(i=t,n=this._itemMap.get(i),o=!n,n&&(e=this._items.indexOf(n))):"number"==typeof t?(e=t,n=this._items[e],o=!n,n&&(i=n[r])):(n=t,i=n[r],e=this._items.indexOf(n),o=-1==e||!this._itemMap.get(i)),o)throw new a.a("collection-remove-404",this);this._items.splice(e,1),this._itemMap.delete(i);const s=this._bindToInternalToExternalMap.get(n);return this._bindToInternalToExternalMap.delete(n),this._bindToExternalToInternalMap.delete(s),this.fire("remove",n,e),[n,e]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}Pt(Ke,h);class Qe{constructor(t,e=[],i=[]){this._context=t,this._plugins=new Map,this._availablePlugins=new Map;for(const n of e)n.pluginName&&this._availablePlugins.set(n.pluginName,n);this._contextPlugins=new Map;for(const[n,o]of i)this._contextPlugins.set(n,o),this._contextPlugins.set(o,n),n.pluginName&&this._availablePlugins.set(n.pluginName,n)}*[Symbol.iterator](){for(const t of this._plugins)"function"==typeof t[0]&&(yield t)}get(t){const e=this._plugins.get(t);if(!e){let e=t;throw"function"==typeof t&&(e=t.pluginName||t.name),new a.a("plugincollection-plugin-not-loaded",this._context,{plugin:e})}return e}has(t){return this._plugins.has(t)}init(t,e=[],i=[]){const n=this,o=this._context;!function t(e,i=new Set){e.forEach(e=>{l(e)&&(i.has(e)||(i.add(e),e.pluginName&&!n._availablePlugins.has(e.pluginName)&&n._availablePlugins.set(e.pluginName,e),e.requires&&t(e.requires,i)))})}(t),u(t);const r=[...function t(e,i=new Set){return e.map(t=>l(t)?t:n._availablePlugins.get(t)).reduce((e,n)=>i.has(n)?e:(i.add(n),n.requires&&(u(n.requires,n),t(n.requires,i).forEach(t=>e.add(t))),e.add(n)),new Set)}(t.filter(t=>!h(t,e)))];!function(t,e){for(const i of e){if("function"!=typeof i)throw new a.a("plugincollection-replace-plugin-invalid-type",null,{pluginItem:i});const e=i.pluginName;if(!e)throw new a.a("plugincollection-replace-plugin-missing-name",null,{pluginItem:i});if(i.requires&&i.requires.length)throw new a.a("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:e});const o=n._availablePlugins.get(e);if(!o)throw new a.a("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:e});const r=t.indexOf(o);if(-1===r){if(n._contextPlugins.has(o))return;throw new a.a("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:e})}if(o.requires&&o.requires.length)throw new a.a("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:e});t.splice(r,1,i),n._availablePlugins.set(e,i)}}(r,i);const s=function(t){return t.map(t=>{const e=n._contextPlugins.get(t)||new t(o);return n._add(t,e),e})}(r);return f(s,"init").then(()=>f(s,"afterInit")).then(()=>s);function l(t){return"function"==typeof t}function c(t){return l(t)&&t.isContextPlugin}function h(t,e){return e.some(e=>e===t||d(t)===e||d(e)===t)}function d(t){return l(t)?t.pluginName||t.name:t}function u(t,i=null){t.map(t=>l(t)?t:n._availablePlugins.get(t)||t).forEach(t=>{!function(t,e){if(!l(t)){if(e)throw new a.a("plugincollection-soft-required",o,{missingPlugin:t,requiredBy:d(e)});throw new a.a("plugincollection-plugin-not-found",o,{plugin:t})}}(t,i),function(t,e){if(c(e)&&!c(t))throw new a.a("plugincollection-context-required",o,{plugin:d(t),requiredBy:d(e)})}(t,i),function(t,i){if(i&&h(t,e))throw new a.a("plugincollection-required",o,{plugin:d(t),requiredBy:d(i)})}(t,i)})}function f(t,e){return t.reduce((t,i)=>i[e]?n._contextPlugins.has(i)?t:t.then(i[e].bind(i)):t,Promise.resolve())}}destroy(){const t=[];for(const[,e]of this)"function"!=typeof e.destroy||this._contextPlugins.has(e)||t.push(e.destroy());return Promise.all(t)}_add(t,e){this._plugins.set(t,e);const i=t.pluginName;if(i){if(this._plugins.has(i))throw new a.a("plugincollection-plugin-name-conflict",null,{pluginName:i,plugin1:this._plugins.get(i).constructor,plugin2:t});this._plugins.set(i,e)}}}function Je(t){return Array.isArray(t)?t:[t]}Pt(Qe,h),window.CKEDITOR_TRANSLATIONS||(window.CKEDITOR_TRANSLATIONS={});const ti=["ar","ara","fa","per","fas","he","heb","ku","kur","ug","uig"];function ei(t){return ti.includes(t)?"rtl":"ltr"}class ii{constructor(t={}){this.uiLanguage=t.uiLanguage||"en",this.contentLanguage=t.contentLanguage||this.uiLanguage,this.uiLanguageDirection=ei(this.uiLanguage),this.contentLanguageDirection=ei(this.contentLanguage),this.t=(t,e)=>this._t(t,e)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,e=[]){return e=Je(e),"string"==typeof t&&(t={string:t}),function(t,e){return t.replace(/%(\d+)/g,(t,i)=>i<e.length?e[i]:t)}(function(t,e,i=1){if("number"!=typeof i)throw new a.a("translation-service-quantity-not-a-number",null,{quantity:i});const n=Object.keys(window.CKEDITOR_TRANSLATIONS).length;1===n&&(t=Object.keys(window.CKEDITOR_TRANSLATIONS)[0]);const o=e.id||e.string;if(0===n||!function(t,e){return!!window.CKEDITOR_TRANSLATIONS[t]&&!!window.CKEDITOR_TRANSLATIONS[t].dictionary[e]}(t,o))return 1!==i?e.plural:e.string;const r=window.CKEDITOR_TRANSLATIONS[t].dictionary,s=window.CKEDITOR_TRANSLATIONS[t].getPluralForm||(t=>1===t?0:1);if("string"==typeof r[o])return r[o];const l=Number(s(i));return r[o][l]}(this.uiLanguage,t,t.plural?e[0]:1),e)}}class ni{constructor(t){this.config=new Ge(t,this.constructor.defaultConfig);const e=this.constructor.builtinPlugins;this.config.define("plugins",e),this.plugins=new Qe(this,e);const i=this.config.get("language")||{};this.locale=new ii({uiLanguage:"string"==typeof i?i:i.ui,contentLanguage:this.config.get("language.content")}),this.t=this.locale.t,this.editors=new Ke,this._contextOwner=null}initPlugins(){const t=this.config.get("plugins")||[],e=this.config.get("substitutePlugins")||[];for(const i of t.concat(e)){if("function"!=typeof i)throw new a.a("context-initplugins-constructor-only",null,{Plugin:i});if(!0!==i.isContextPlugin)throw new a.a("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(t,[],e)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,e){if(this._contextOwner)throw new a.a("context-addeditor-private-context");this.editors.add(t),e&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const e of this.config.names())["plugins","removePlugins","extraPlugins"].includes(e)||(t[e]=this.config.get(e));return t}static create(t){return new Promise(e=>{const i=new this(t);e(i.initPlugins().then(()=>i))})}}class oi{constructor(t){this.context=t}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}function ri(t,e){const i=Math.min(t.length,e.length);for(let n=0;n<i;n++)if(t[n]!=e[n])return n;return t.length==e.length?"same":t.length<e.length?"prefix":"extension"}Pt(oi,Et);var si=function(t){return qe(t,4)};class ai{constructor(t){this.document=t,this.parent=null}get index(){let t;if(!this.parent)return null;if(-1==(t=this.parent.getChildIndex(this)))throw new a.a("view-node-not-found-in-parent",this);return t}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.index),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let i=t.includeSelf?this:this.parent;for(;i;)e[t.parentFirst?"push":"unshift"](i),i=i.parent;return e}getCommonAncestor(t,e={}){const i=this.getAncestors(e),n=t.getAncestors(e);let o=0;for(;i[o]==n[o]&&i[o];)o++;return 0===o?null:i[o-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),i=t.getPath(),n=ri(e,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return e[n]<i[n]}}isAfter(t){return this!=t&&this.root===t.root&&!this.isBefore(t)}_remove(){this.parent._removeChildren(this.index)}_fireChange(t,e){this.fire("change:"+t,e),this.parent&&this.parent._fireChange(t,e)}toJSON(){const t=si(this);return delete t.parent,t}is(t){return"node"===t||"view:node"===t}}Pt(ai,h);class li extends ai{constructor(t,e){super(t),this._textData=e}is(t){return"$text"===t||"view:$text"===t||"text"===t||"view:text"===t||"node"===t||"view:node"===t}get data(){return this._textData}get _data(){return this.data}set _data(t){this._fireChange("text",this),this._textData=t}isSimilar(t){return t instanceof li&&(this===t||this.data===t.data)}_clone(){return new li(this.document,this.data)}}class ci{constructor(t,e,i){if(this.textNode=t,e<0||e>t.data.length)throw new a.a("view-textproxy-wrong-offsetintext",this);if(i<0||e+i>t.data.length)throw new a.a("view-textproxy-wrong-length",this);this.data=t.data.substring(e,e+i),this.offsetInText=e}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}is(t){return"$textProxy"===t||"view:$textProxy"===t||"textProxy"===t||"view:textProxy"===t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let i=t.includeSelf?this.textNode:this.parent;for(;null!==i;)e[t.parentFirst?"push":"unshift"](i),i=i.parent;return e}}function hi(t){return Xe(t)?new Map(t):function(t){const e=new Map;for(const i in t)e.set(i,t[i]);return e}(t)}class di{constructor(...t){this._patterns=[],this.add(...t)}add(...t){for(let e of t)("string"==typeof e||e instanceof RegExp)&&(e={name:e}),this._patterns.push(e)}match(...t){for(const e of t)for(const t of this._patterns){const i=ui(e,t);if(i)return{element:e,pattern:t,match:i}}return null}matchAll(...t){const e=[];for(const i of t)for(const t of this._patterns){const n=ui(i,t);n&&e.push({element:i,pattern:t,match:n})}return e.length>0?e:null}getElementName(){if(1!==this._patterns.length)return null;const t=this._patterns[0],e=t.name;return"function"==typeof t||!e||e instanceof RegExp?null:e}}function ui(t,e){if("function"==typeof e)return e(t);const i={};return e.name&&(i.name=function(t,e){return t instanceof RegExp?!!e.match(t):t===e}(e.name,t.name),!i.name)||e.attributes&&(i.attributes=function(t,e){const i=new Set(e.getAttributeKeys());return Ht(t)?(void 0!==t.style&&Object(a.b)("matcher-pattern-deprecated-attributes-style-key",t),void 0!==t.class&&Object(a.b)("matcher-pattern-deprecated-attributes-class-key",t)):(i.delete("style"),i.delete("class")),fi(t,i,t=>e.getAttribute(t))}(e.attributes,t),!i.attributes)?null:!(e.classes&&(i.classes=function(t,e){return fi(t,e.getClassNames())}(e.classes,t),!i.classes))&&!(e.styles&&(i.styles=function(t,e){return fi(t,e.getStyleNames(!0),t=>e.getStyle(t))}(e.styles,t),!i.styles))&&i}function fi(t,e,i){const n=function(t){return Array.isArray(t)?t.map(t=>Ht(t)?(void 0!==t.key&&void 0!==t.value||Object(a.b)("matcher-pattern-missing-key-or-value",t),[t.key,t.value]):[t,!0]):Ht(t)?Object.entries(t):[[t,!0]]}(t),o=Array.from(e),r=[];return n.forEach(([t,e])=>{o.forEach(n=>{(function(t,e){return!0===t||t===e||t instanceof RegExp&&e.match(t)})(t,n)&&function(t,e,i){if(!0===t)return!0;const n=i(e);return t===n||t instanceof RegExp&&!!String(n).match(t)}(e,n,i)&&r.push(n)})}),!n.length||r.length<n.length?null:r}var pi=function(t){return"symbol"==typeof t||J(t)&&"[object Symbol]"==S(t)},gi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mi=/^\w*$/;function vi(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var i=function(){var n=arguments,o=e?e.apply(this,n):n[0],r=i.cache;if(r.has(o))return r.get(o);var s=t.apply(this,n);return i.cache=r.set(o,s)||r,s};return i.cache=new(vi.Cache||ee),i}vi.Cache=ee;var yi=vi,bi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,wi=/\\(\\)?/g,ki=function(t){var e=yi(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(bi,function(t,i,n,o){e.push(n?o.replace(wi,"$1"):i||t)}),e},function(t){return 500===i.size&&i.clear(),t}),i=e.cache;return e}(),_i=w?w.prototype:void 0,xi=_i?_i.toString:void 0,Ci=function t(e){if("string"==typeof e)return e;if(rt(e))return function(t,e){for(var i=-1,n=null==t?0:t.length,o=Array(n);++i<n;)o[i]=e(t[i],i,t);return o}(e,t)+"";if(pi(e))return xi?xi.call(e):"";var i=e+"";return"0"==i&&1/e==-1/0?"-0":i},Ei=function(t){return null==t?"":Ci(t)},Ti=function(t,e){return rt(t)?t:function(t,e){if(rt(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!pi(t))||mi.test(t)||!gi.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:ki(Ei(t))},Si=function(t){if("string"==typeof t||pi(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},Ai=function(t,e){for(var i=0,n=(e=Ti(e,t)).length;null!=t&&i<n;)t=t[Si(e[i++])];return i&&i==n?t:void 0},Oi=function(t,e,i){var n=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(i=i>o?o:i)<0&&(i+=o),o=e>i?0:i-e>>>0,e>>>=0;for(var r=Array(o);++n<o;)r[n]=t[n+e];return r},Ii=function(t,e,i){var n=null==t?void 0:Ai(t,e);return void 0===n?i:n},Pi=function(t,e,i){(void 0!==i&&!L(t[e],i)||void 0===i&&!(e in t))&&F(t,e,i)},Mi=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},Di=function t(e,i,n,o,r){e!==i&&function(t,e,i){for(var n=-1,o=Object(t),r=i(t),s=r.length;s--;){var a=r[++n];if(!1===e(o[a],a,o))break}}(i,function(s,a){if(r||(r=new ne),y(s))!function(t,e,i,n,o,r,s){var a=Mi(t,i),l=Mi(e,i),c=s.get(l);if(c)Pi(t,i,c);else{var h=r?r(a,l,i+"",t,e,s):void 0,d=void 0===h;if(d){var u=rt(l),f=!u&&Object(st.a)(l),p=!u&&!f&&dt(l);h=l,u||f||p?rt(a)?h=a:function(t){return J(t)&&$(t)}(a)?h=le(a):f?(d=!1,h=Object(ae.a)(l,!0)):p?(d=!1,h=Re(l,!0)):h=[]:Ht(l)||ot(l)?(h=a,ot(a)?h=function(t){return V(t,vt(t))}(a):y(a)&&!A(a)||(h=Le(l))):d=!1}d&&(s.set(l,h),o(h,l,n,r,s),s.delete(l)),Pi(t,i,h)}}(e,i,a,n,t,o,r);else{var l=o?o(Mi(e,a),s,a+"",e,i,r):void 0;void 0===l&&(l=s),Pi(e,a,l)}},vt)},Ni=Q(function(t,e,i){Di(t,e,i)});class Ri{constructor(t){this._styles={},this._styleProcessor=t}get isEmpty(){const t=Object.entries(this._styles);return!Array.from(t).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Array.from(function(t){let e=null,i=0,n=0,o=null;const r=new Map;if(""===t)return r;";"!=t.charAt(t.length-1)&&(t+=";");for(let s=0;s<t.length;s++){const a=t.charAt(s);if(null===e)switch(a){case":":o||(o=t.substr(i,s-i),n=s+1);break;case'"':case"'":e=a;break;case";":{const e=t.substr(n,s-n);o&&r.set(o.trim(),e.trim()),o=null,i=s+1;break}}else a===e&&(e=null)}return r}(t).entries());for(const[i,n]of e)this._styleProcessor.toNormalizedForm(i,n,this._styles)}has(t){if(this.isEmpty)return!1;const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)}set(t,e){if(y(t))for(const[i,n]of Object.entries(t))this._styleProcessor.toNormalizedForm(i,n,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Fi(t);(function(t,e){null==t||function(t,e){null==(t=function(t,e){return e.length<2?t:Ai(t,Oi(e,0,-1))}(t,e=Ti(e,t)))||delete t[Si(function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}(e))]}(t,e)})(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this._getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!y(this._styles[t]))return this._styles[t];const e=this._styleProcessor.getReducedForm(t,this._styles).find(([e])=>e===t);return Array.isArray(e)?e[1]:void 0}getStyleNames(t=!1){return this.isEmpty?[]:t?this._styleProcessor.getStyleNames(this._styles):this._getStylesEntries().map(([t])=>t)}clear(){this._styles={}}_getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const i of e)t.push(...this._styleProcessor.getReducedForm(i,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const i=e.splice(0,e.length-1).join("."),n=Ii(this._styles,i);n&&!Array.from(Object.keys(n)).length&&this.remove(i)}}class zi{constructor(){this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,e,i){if(y(e))Li(i,Fi(t),e);else if(this._normalizers.has(t)){const n=this._normalizers.get(t),{path:o,value:r}=n(e);Li(i,o,r)}else Li(i,t,e)}getNormalized(t,e){if(!t)return Ni({},e);if(void 0!==e[t])return e[t];if(this._extractors.has(t)){const i=this._extractors.get(t);if("string"==typeof i)return Ii(e,i);const n=i(t,e);if(n)return n}return Ii(e,Fi(t))}getReducedForm(t,e){const i=this.getNormalized(t,e);return void 0===i?[]:this._reducers.has(t)?this._reducers.get(t)(i):[[t,i]]}getStyleNames(t){const e=Array.from(this._consumables.keys()).filter(e=>{const i=this.getNormalized(e,t);return i&&"object"==typeof i?Object.keys(i).length:i}),i=new Set([...e,...Object.keys(t)]);return Array.from(i.values())}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,e){this._normalizers.set(t,e)}setExtractor(t,e){this._extractors.set(t,e)}setReducer(t,e){this._reducers.set(t,e)}setStyleRelation(t,e){this._mapStyleNames(t,e);for(const i of e)this._mapStyleNames(i,[t])}_mapStyleNames(t,e){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...e)}}function Fi(t){return t.replace("-",".")}function Li(t,e,i){let n=i;y(i)&&(n=Ni({},Ii(t,e),i)),function(t,e,i){null==t||function(t,e,i,n){if(!y(t))return t;for(var o=-1,r=(e=Ti(e,t)).length,s=r-1,a=t;null!=a&&++o<r;){var l=Si(e[o]),c=i;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(o!=s){var h=a[l];void 0===(c=void 0)&&(c=y(h)?h:K(e[o+1])?[]:{})}j(a,l,c),a=a[l]}}(t,e,i)}(t,e,n)}class Bi extends ai{constructor(t,e,i,n){if(super(t),this.name=e,this._attrs=function(t){t=hi(t);for(const[e,i]of t)null===i?t.delete(e):"string"!=typeof i&&t.set(e,String(i));return t}(i),this._children=[],n&&this._insertChild(0,n),this._classes=new Set,this._attrs.has("class")){const t=this._attrs.get("class");ji(this._classes,t),this._attrs.delete("class")}this._styles=new Ri(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style")),this._customProperties=new Map,this._isAllowedInsideAttributeElement=!1}get childCount(){return this._children.length}get isEmpty(){return 0===this._children.length}get isAllowedInsideAttributeElement(){return this._isAllowedInsideAttributeElement}is(t,e=null){return e?e===this.name&&("element"===t||"view:element"===t):"element"===t||"view:element"===t||"node"===t||"view:node"===t}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(t){if("class"==t)return this._classes.size>0?[...this._classes].join(" "):void 0;if("style"==t){const t=this._styles.toString();return""==t?void 0:t}return this._attrs.get(t)}hasAttribute(t){return"class"==t?this._classes.size>0:"style"==t?!this._styles.isEmpty:this._attrs.has(t)}isSimilar(t){if(!(t instanceof Bi))return!1;if(this===t)return!0;if(this.name!=t.name)return!1;if(this.isAllowedInsideAttributeElement!=t.isAllowedInsideAttributeElement)return!1;if(this._attrs.size!==t._attrs.size||this._classes.size!==t._classes.size||this._styles.size!==t._styles.size)return!1;for(const[e,i]of this._attrs)if(!t._attrs.has(e)||t._attrs.get(e)!==i)return!1;for(const e of this._classes)if(!t._classes.has(e))return!1;for(const e of this._styles.getStyleNames())if(!t._styles.has(e)||t._styles.getAsString(e)!==this._styles.getAsString(e))return!1;return!0}hasClass(...t){for(const e of t)if(!this._classes.has(e))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(t){return this._styles.getAsString(t)}getNormalizedStyle(t){return this._styles.getNormalized(t)}getStyleNames(t=!1){return this._styles.getStyleNames(t)}hasStyle(...t){for(const e of t)if(!this._styles.has(e))return!1;return!0}findAncestor(...t){const e=new di(...t);let i=this.parent;for(;i;){if(e.match(i))return i;i=i.parent}return null}getCustomProperty(t){return this._customProperties.get(t)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const t=Array.from(this._classes).sort().join(","),e=this._styles.toString(),i=Array.from(this._attrs).map(t=>`${t[0]}="${t[1]}"`).sort().join(" ");return this.name+(""==t?"":` class="${t}"`)+(e?` style="${e}"`:"")+(""==i?"":" "+i)}_clone(t=!1){const e=[];if(t)for(const n of this.getChildren())e.push(n._clone(t));const i=new this.constructor(this.document,this.name,this._attrs,e);return i._classes=new Set(this._classes),i._styles.set(this._styles.getNormalized()),i._customProperties=new Map(this._customProperties),i.getFillerOffset=this.getFillerOffset,i._isAllowedInsideAttributeElement=this.isAllowedInsideAttributeElement,i}_appendChild(t){return this._insertChild(this.childCount,t)}_insertChild(t,e){this._fireChange("children",this);let i=0;const n=function(t,e){return"string"==typeof e?[new li(t,e)]:(Xe(e)||(e=[e]),Array.from(e).map(e=>"string"==typeof e?new li(t,e):e instanceof ci?new li(t,e.data):e))}(this.document,e);for(const o of n)null!==o.parent&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(t,0,o),t++,i++;return i}_removeChildren(t,e=1){this._fireChange("children",this);for(let i=t;i<t+e;i++)this._children[i].parent=null;return this._children.splice(t,e)}_setAttribute(t,e){e=String(e),this._fireChange("attributes",this),"class"==t?ji(this._classes,e):"style"==t?this._styles.setTo(e):this._attrs.set(t,e)}_removeAttribute(t){return this._fireChange("attributes",this),"class"==t?this._classes.size>0&&(this._classes.clear(),!0):"style"==t?!this._styles.isEmpty&&(this._styles.clear(),!0):this._attrs.delete(t)}_addClass(t){this._fireChange("attributes",this);for(const e of Je(t))this._classes.add(e)}_removeClass(t){this._fireChange("attributes",this);for(const e of Je(t))this._classes.delete(e)}_setStyle(t,e){this._fireChange("attributes",this),this._styles.set(t,e)}_removeStyle(t){this._fireChange("attributes",this);for(const e of Je(t))this._styles.remove(e)}_setCustomProperty(t,e){this._customProperties.set(t,e)}_removeCustomProperty(t){return this._customProperties.delete(t)}}function ji(t,e){const i=e.split(/\s+/);t.clear(),i.forEach(e=>t.add(e))}class Vi extends Bi{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=Hi}is(t,e=null){return e?e===this.name&&("containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}}function Hi(){const t=[...this.getChildren()],e=t[this.childCount-1];if(e&&e.is("element","br"))return this.childCount;for(const i of t)if(!i.is("uiElement"))return null;return this.childCount}class Wi extends Vi{constructor(t,e,i,n){super(t,e,i,n),this.set("isReadOnly",!1),this.set("isFocused",!1),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",e=>e&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}is(t,e=null){return e?e===this.name&&("editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}destroy(){this.stopListening()}}Pt(Wi,Et);const qi=Symbol("rootName");class Ui extends Wi{constructor(t,e){super(t,e),this.rootName="main"}is(t,e=null){return e?e===this.name&&("rootElement"===t||"view:rootElement"===t||"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t):"rootElement"===t||"view:rootElement"===t||"editableElement"===t||"view:editableElement"===t||"containerElement"===t||"view:containerElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}get rootName(){return this.getCustomProperty(qi)}set rootName(t){this._setCustomProperty(qi,t)}set _name(t){this.name=t}}class Yi{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new a.a("view-tree-walker-no-start-position",null);if(t.direction&&"forward"!=t.direction&&"backward"!=t.direction)throw new a.a("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,this.position=Gi._createAt(t.startPosition?t.startPosition:t.boundaries["backward"==t.direction?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}skip(t){let e,i,n;do{n=this.position,({done:e,value:i}=this.next())}while(!e&&t(i));e||(this.position=n)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,i=t.parent;if(null===i.parent&&t.offset===i.childCount)return{done:!0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0};let n;if(i instanceof li){if(t.isAtEnd)return this.position=Gi._createAfter(i),this._next();n=i.data[t.offset]}else n=i.getChild(t.offset);if(n instanceof Bi)return this.shallow?t.offset++:t=new Gi(n,0),this.position=t,this._formatReturnValue("elementStart",n,e,t,1);if(n instanceof li){if(this.singleCharacters)return t=new Gi(n,0),this.position=t,this._next();{let i,o=n.data.length;return n==this._boundaryEndParent?(o=this.boundaries.end.offset,i=new ci(n,0,o),t=Gi._createAfter(i)):(i=new ci(n,0,n.data.length),t.offset++),this.position=t,this._formatReturnValue("text",i,e,t,o)}}if("string"==typeof n){let n;n=this.singleCharacters?1:(i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length)-t.offset;const o=new ci(i,t.offset,n);return t.offset+=n,this.position=t,this._formatReturnValue("text",o,e,t,n)}return t=Gi._createAfter(i),this.position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,e,t)}_previous(){let t=this.position.clone();const e=this.position,i=t.parent;if(null===i.parent&&0===t.offset)return{done:!0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0};let n;if(i instanceof li){if(t.isAtStart)return this.position=Gi._createBefore(i),this._previous();n=i.data[t.offset-1]}else n=i.getChild(t.offset-1);if(n instanceof Bi)return this.shallow?(t.offset--,this.position=t,this._formatReturnValue("elementStart",n,e,t,1)):(t=new Gi(n,n.childCount),this.position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",n,e,t));if(n instanceof li){if(this.singleCharacters)return t=new Gi(n,n.data.length),this.position=t,this._previous();{let i,o=n.data.length;if(n==this._boundaryStartParent){const e=this.boundaries.start.offset;i=new ci(n,e,n.data.length-e),o=i.data.length,t=Gi._createBefore(i)}else i=new ci(n,0,n.data.length),t.offset--;return this.position=t,this._formatReturnValue("text",i,e,t,o)}}if("string"==typeof n){let n;n=this.singleCharacters?1:t.offset-(i===this._boundaryStartParent?this.boundaries.start.offset:0),t.offset-=n;const o=new ci(i,t.offset,n);return this.position=t,this._formatReturnValue("text",o,e,t,n)}return t=Gi._createBefore(i),this.position=t,this._formatReturnValue("elementStart",i,e,t,1)}_formatReturnValue(t,e,i,n,o){return e instanceof ci&&(e.offsetInText+e.data.length==e.textNode.data.length&&("forward"!=this.direction||this.boundaries&&this.boundaries.end.isEqual(this.position)?i=Gi._createAfter(e.textNode):(n=Gi._createAfter(e.textNode),this.position=n)),0===e.offsetInText&&("backward"!=this.direction||this.boundaries&&this.boundaries.start.isEqual(this.position)?i=Gi._createBefore(e.textNode):(n=Gi._createBefore(e.textNode),this.position=n))),{done:!1,value:{type:t,item:e,previousPosition:i,nextPosition:n,length:o}}}}class Gi{constructor(t,e){this.parent=t,this.offset=e}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return 0===this.offset}get isAtEnd(){const t=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===t}get root(){return this.parent.root}get editableElement(){let t=this.parent;for(;!(t instanceof Wi);){if(!t.parent)return null;t=t.parent}return t}getShiftedBy(t){const e=Gi._createAt(this),i=e.offset+t;return e.offset=i<0?0:i,e}getLastMatchingPosition(t,e={}){e.startPosition=this;const i=new Yi(e);return i.skip(t),i.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(t){const e=this.getAncestors(),i=t.getAncestors();let n=0;for(;e[n]==i[n]&&e[n];)n++;return 0===n?null:e[n-1]}is(t){return"position"===t||"view:position"===t}isEqual(t){return this.parent==t.parent&&this.offset==t.offset}isBefore(t){return"before"==this.compareWith(t)}isAfter(t){return"after"==this.compareWith(t)}compareWith(t){if(this.root!==t.root)return"different";if(this.isEqual(t))return"same";const e=this.parent.is("node")?this.parent.getPath():[],i=t.parent.is("node")?t.parent.getPath():[];e.push(this.offset),i.push(t.offset);const n=ri(e,i);switch(n){case"prefix":return"before";case"extension":return"after";default:return e[n]<i[n]?"before":"after"}}getWalker(t={}){return t.startPosition=this,new Yi(t)}clone(){return new Gi(this.parent,this.offset)}static _createAt(t,e){if(t instanceof Gi)return new this(t.parent,t.offset);{const i=t;if("end"==e)e=i.is("$text")?i.data.length:i.childCount;else{if("before"==e)return this._createBefore(i);if("after"==e)return this._createAfter(i);if(0!==e&&!e)throw new a.a("view-createpositionat-offset-required",i)}return new Gi(i,e)}}static _createAfter(t){if(t.is("$textProxy"))return new Gi(t.textNode,t.offsetInText+t.data.length);if(!t.parent)throw new a.a("view-position-after-root",t,{root:t});return new Gi(t.parent,t.index+1)}static _createBefore(t){if(t.is("$textProxy"))return new Gi(t.textNode,t.offsetInText);if(!t.parent)throw new a.a("view-position-before-root",t,{root:t});return new Gi(t.parent,t.index)}}class Zi{constructor(t,e=null){this.start=t.clone(),this.end=e?e.clone():t.clone()}*[Symbol.iterator](){yield*new Yi({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let t=this.start.getLastMatchingPosition($i,{direction:"backward"}),e=this.end.getLastMatchingPosition($i);return t.parent.is("$text")&&t.isAtStart&&(t=Gi._createBefore(t.parent)),e.parent.is("$text")&&e.isAtEnd&&(e=Gi._createAfter(e.parent)),new Zi(t,e)}getTrimmed(){let t=this.start.getLastMatchingPosition($i);if(t.isAfter(this.end)||t.isEqual(this.end))return new Zi(t,t);let e=this.end.getLastMatchingPosition($i,{direction:"backward"});const i=t.nodeAfter,n=e.nodeBefore;return i&&i.is("$text")&&(t=new Gi(i,0)),n&&n.is("$text")&&(e=new Gi(n,n.data.length)),new Zi(t,e)}isEqual(t){return this==t||this.start.isEqual(t.start)&&this.end.isEqual(t.end)}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const i=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),n=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return i&&n}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new Zi(this.start,t.start)),this.containsPosition(t.end)&&e.push(new Zi(t.end,this.end))):e.push(this.clone()),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,i=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(i=t.end),new Zi(e,i)}return null}getWalker(t={}){return t.boundaries=this,new Yi(t)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let t=this.start.nodeAfter,e=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(t=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(e=this.end.parent.previousSibling),t&&t.is("element")&&t===e?t:null}clone(){return new Zi(this.start,this.end)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new Yi(t);for(const i of e)yield i.item}*getPositions(t={}){t.boundaries=this;const e=new Yi(t);yield e.position;for(const i of e)yield i.nextPosition}is(t){return"range"===t||"view:range"===t}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}static _createFromParentsAndOffsets(t,e,i,n){return new this(new Gi(t,e),new Gi(i,n))}static _createFromPositionAndShift(t,e){const i=t,n=t.getShiftedBy(e);return e>0?new this(i,n):new this(n,i)}static _createIn(t){return this._createFromParentsAndOffsets(t,0,t,t.childCount)}static _createOn(t){const e=t.is("$textProxy")?t.offsetSize:1;return this._createFromPositionAndShift(Gi._createBefore(t),e)}}function $i(t){return!(!t.item.is("attributeElement")&&!t.item.is("uiElement"))}function Xi(t){let e=0;for(const i of t)e++;return e}class Ki{constructor(t=null,e,i){this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",this.setTo(t,e,i)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.end:t.start).clone()}get focus(){if(!this._ranges.length)return null;const t=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?t.start:t.end).clone()}get isCollapsed(){return 1===this.rangeCount&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const t of this._ranges)yield t.clone()}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?t.clone():null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?t.clone():null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}isEqual(t){if(this.isFake!=t.isFake)return!1;if(this.isFake&&this.fakeSelectionLabel!=t.fakeSelectionLabel)return!1;if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let i=!1;for(const n of t._ranges)if(e.isEqual(n)){i=!0;break}if(!i)return!1}return!0}isSimilar(t){if(this.isBackward!=t.isBackward)return!1;const e=Xi(this.getRanges());if(e!=Xi(t.getRanges()))return!1;if(0==e)return!0;for(let i of this.getRanges()){i=i.getTrimmed();let e=!1;for(let n of t.getRanges())if(n=n.getTrimmed(),i.start.isEqual(n.start)&&i.end.isEqual(n.end)){e=!0;break}if(!e)return!1}return!0}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}setTo(t,e,i){if(null===t)this._setRanges([]),this._setFakeOptions(e);else if(t instanceof Ki||t instanceof Qi)this._setRanges(t.getRanges(),t.isBackward),this._setFakeOptions({fake:t.isFake,label:t.fakeSelectionLabel});else if(t instanceof Zi)this._setRanges([t],e&&e.backward),this._setFakeOptions(e);else if(t instanceof Gi)this._setRanges([new Zi(t)]),this._setFakeOptions(e);else if(t instanceof ai){const n=!!i&&!!i.backward;let o;if(void 0===e)throw new a.a("view-selection-setto-required-second-parameter",this);o="in"==e?Zi._createIn(t):"on"==e?Zi._createOn(t):new Zi(Gi._createAt(t,e)),this._setRanges([o],n),this._setFakeOptions(i)}else{if(!Xe(t))throw new a.a("view-selection-setto-not-selectable",this);this._setRanges(t,e&&e.backward),this._setFakeOptions(e)}this.fire("change")}setFocus(t,e){if(null===this.anchor)throw new a.a("view-selection-setfocus-no-ranges",this);const i=Gi._createAt(t,e);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.pop(),"before"==i.compareWith(n)?this._addRange(new Zi(i,n),!0):this._addRange(new Zi(n,i)),this.fire("change")}is(t){return"selection"===t||"view:selection"===t}_setRanges(t,e=!1){t=Array.from(t),this._ranges=[];for(const i of t)this._addRange(i);this._lastRangeBackward=!!e}_setFakeOptions(t={}){this._isFake=!!t.fake,this._fakeSelectionLabel=t.fake&&t.label||""}_addRange(t,e=!1){if(!(t instanceof Zi))throw new a.a("view-selection-add-range-not-range",this);this._pushRange(t),this._lastRangeBackward=!!e}_pushRange(t){for(const e of this._ranges)if(t.isIntersecting(e))throw new a.a("view-selection-range-intersects",this,{addedRange:t,intersectingRange:e});this._ranges.push(new Zi(t.start,t.end))}}Pt(Ki,h);class Qi{constructor(t=null,e,i){this._selection=new Ki,this._selection.delegate("change").to(this),this._selection.setTo(t,e,i)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(t){return this._selection.isEqual(t)}isSimilar(t){return this._selection.isSimilar(t)}is(t){return"selection"===t||"documentSelection"==t||"view:selection"==t||"view:documentSelection"==t}_setTo(t,e,i){this._selection.setTo(t,e,i)}_setFocus(t,e){this._selection.setFocus(t,e)}}Pt(Qi,h);class Ji extends n{constructor(t,e,i){super(t,e),this.startRange=i,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const tn=Symbol("bubbling contexts");var en={fire(t,...e){try{const i=t instanceof n?t:new n(this,t),o=sn(this);if(!o.size)return;if(nn(i,"capturing",this),on(o,"$capture",i,...e))return i.return;const r=i.startRange||this.selection.getFirstRange(),s=r?r.getContainedElement():null,a=!!s&&Boolean(rn(o,s));let l=s||function(t){if(!t)return null;const e=t.start.parent,i=t.end.parent,n=e.getPath(),o=i.getPath();return n.length>o.length?e:i}(r);if(nn(i,"atTarget",l),!a){if(on(o,"$text",i,...e))return i.return;nn(i,"bubbling",l)}for(;l;){if(l.is("rootElement")){if(on(o,"$root",i,...e))return i.return}else if(l.is("element")&&on(o,l.name,i,...e))return i.return;if(on(o,l,i,...e))return i.return;l=l.parent,nn(i,"bubbling",l)}return nn(i,"bubbling",this),on(o,"$document",i,...e),i.return}catch(t){a.a.rethrowUnexpectedError(t,this)}},_addEventListener(t,e,i){const n=Je(i.context||"$document"),o=sn(this);for(const r of n){let n=o.get(r);n||(n=Object.create(h),o.set(r,n)),this.listenTo(n,t,e,i)}},_removeEventListener(t,e){const i=sn(this);for(const n of i.values())this.stopListening(n,t,e)}};function nn(t,e,i){t instanceof Ji&&(t._eventPhase=e,t._currentTarget=i)}function on(t,e,i,...n){const o="string"==typeof e?t.get(e):rn(t,e);return!!o&&(o.fire(i,...n),i.stop.called)}function rn(t,e){for(const[i,n]of t)if("function"==typeof i&&i(e))return n;return null}function sn(t){return t[tn]||(t[tn]=new Map),t[tn]}class an{constructor(t){this.selection=new Qi,this.roots=new Ke({idProperty:"rootName"}),this.stylesProcessor=t,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1),this._postFixers=new Set}getRoot(t="main"){return this.roots.get(t)}registerPostFixer(t){this._postFixers.add(t)}destroy(){this.roots.map(t=>t.destroy()),this.stopListening()}_callPostFixers(t){let e=!1;do{for(const i of this._postFixers)if(e=i(t),e)break}while(e)}}Pt(an,en),Pt(an,Et);class ln extends Bi{constructor(t,e,i,n){super(t,e,i,n),this.getFillerOffset=cn,this._priority=10,this._id=null,this._clonesGroup=null}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(null===this.id)throw new a.a("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}is(t,e=null){return e?e===this.name&&("attributeElement"===t||"view:attributeElement"===t||"element"===t||"view:element"===t):"attributeElement"===t||"view:attributeElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}isSimilar(t){return null!==this.id||null!==t.id?this.id===t.id:super.isSimilar(t)&&this.priority==t.priority}_clone(t){const e=super._clone(t);return e._priority=this._priority,e._id=this._id,e}}function cn(){if(hn(this))return null;let t=this.parent;for(;t&&t.is("attributeElement");){if(hn(t)>1)return null;t=t.parent}return!t||hn(t)>1?null:this.childCount}function hn(t){return Array.from(t.getChildren()).filter(t=>!t.is("uiElement")).length}ln.DEFAULT_PRIORITY=10;class dn extends Bi{constructor(t,e,i,n){super(t,e,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=un}is(t,e=null){return e?e===this.name&&("emptyElement"===t||"view:emptyElement"===t||"element"===t||"view:element"===t):"emptyElement"===t||"view:emptyElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}_insertChild(t,e){if(e&&(e instanceof ai||Array.from(e).length>0))throw new a.a("view-emptyelement-cannot-add",[this,e])}}function un(){return null}const fn=navigator.userAgent.toLowerCase();var pn=function(t){return t.indexOf("macintosh")>-1}(fn),gn=function(t){return!!t.match(/gecko\/\d+/)}(fn),mn=function(t){return t.indexOf(" applewebkit/")>-1&&-1===t.indexOf("chrome")}(fn),vn=function(t){return t.indexOf("android")>-1}(fn),yn=function(t){return t.indexOf("chrome/")>-1&&t.indexOf("edge/")<0}(fn),bn=function(){let t=!1;try{t=0==="\u0107".search(new RegExp("[\\p{L}]","u"))}catch(t){}return t}();const wn={ctrl:"\u2303",cmd:"\u2318",alt:"\u2325",shift:"\u21e7"},kn={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},_n=function(){const t={arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let e=65;e<=90;e++)t[String.fromCharCode(e).toLowerCase()]=e;for(let e=48;e<=57;e++)t[e-48]=e;for(let e=112;e<=123;e++)t["f"+(e-111)]=e;for(const e of"`-=[];',./\\")t[e]=e.charCodeAt(0);return t}(),xn=Object.fromEntries(Object.entries(_n).map(([t,e])=>[e,t.charAt(0).toUpperCase()+t.slice(1)]));function Cn(t){let e;if("string"==typeof t){if(e=_n[t.toLowerCase()],!e)throw new a.a("keyboard-unknown-key",null,{key:t})}else e=t.keyCode+(t.altKey?_n.alt:0)+(t.ctrlKey?_n.ctrl:0)+(t.shiftKey?_n.shift:0)+(t.metaKey?_n.cmd:0);return e}function En(t){return"string"==typeof t&&(t=function(t){return t.split("+").map(t=>t.trim())}(t)),t.map(t=>"string"==typeof t?function(t){if(t.endsWith("!"))return Cn(t.slice(0,-1));const e=Cn(t);return pn&&e==_n.ctrl?_n.cmd:e}(t):t).reduce((t,e)=>e+t,0)}function Tn(t){let e=En(t);return Object.entries(pn?wn:kn).reduce((t,[i,n])=>(0!=(e&_n[i])&&(e&=~_n[i],t+=n),t),"")+(e?xn[e]:"")}function Sn(t,e){const i="ltr"===e;switch(t){case _n.arrowleft:return i?"left":"right";case _n.arrowright:return i?"right":"left";case _n.arrowup:return"up";case _n.arrowdown:return"down"}}class An extends Bi{constructor(t,e,i,n){super(t,e,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=On}is(t,e=null){return e?e===this.name&&("uiElement"===t||"view:uiElement"===t||"element"===t||"view:element"===t):"uiElement"===t||"view:uiElement"===t||"element"===t||"view:element"===t||"node"===t||"view:node"===t}_insertChild(t,e){if(e&&(e instanceof ai||Array.from(e).length>0))throw new a.a("view-uielement-cannot-add",this)}render(t){return this.toDomElement(t)}toDomElement(t){const e=t.createElement(this.name);for(const i of this.getAttributeKeys())e.setAttribute(i,this.getAttribute(i));return e}}function On(){return null}class In extends Bi{constructor(t,e,i,n){super(t,e,i,n),this._isAllowedInsideAttributeElement=!0,this.getFillerOffset=Pn}is(t,e=null){return e?e===this.name&&("rawElement"===t||"view:rawElement"===t||"element"===t||"view:element"===t):"rawElement"===t||"view:rawElement"===t||t===this.name||t==="view:"+this.name||"element"===t||"view:element"===t||"node"===t||"view:node"===t}_insertChild(t,e){if(e&&(e instanceof ai||Array.from(e).length>0))throw new a.a("view-rawelement-cannot-add",[this,e])}}function Pn(){return null}class Mn{constructor(t,e){this.document=t,this._children=[],e&&this._insertChild(0,e)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"view:documentFragment"===t}_appendChild(t){return this._insertChild(this.childCount,t)}getChild(t){return this._children[t]}getChildIndex(t){return this._children.indexOf(t)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(t,e){this._fireChange("children",this);let i=0;const n=function(t,e){return"string"==typeof e?[new li(t,e)]:(Xe(e)||(e=[e]),Array.from(e).map(e=>"string"==typeof e?new li(t,e):e instanceof ci?new li(t,e.data):e))}(this.document,e);for(const o of n)null!==o.parent&&o._remove(),o.parent=this,this._children.splice(t,0,o),t++,i++;return i}_removeChildren(t,e=1){this._fireChange("children",this);for(let i=t;i<t+e;i++)this._children[i].parent=null;return this._children.splice(t,e)}_fireChange(t,e){this.fire("change:"+t,e)}}Pt(Mn,h);class Dn{constructor(t){this.document=t,this._cloneGroups=new Map}setSelection(t,e,i){this.document.selection._setTo(t,e,i)}setSelectionFocus(t,e){this.document.selection._setFocus(t,e)}createDocumentFragment(t){return new Mn(this.document,t)}createText(t){return new li(this.document,t)}createAttributeElement(t,e,i={}){const n=new ln(this.document,t,e);return"number"==typeof i.priority&&(n._priority=i.priority),i.id&&(n._id=i.id),n}createContainerElement(t,e,i={}){const n=new Vi(this.document,t,e);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),n}createEditableElement(t,e){const i=new Wi(this.document,t,e);return i._document=this.document,i}createEmptyElement(t,e,i={}){const n=new dn(this.document,t,e);return void 0!==i.isAllowedInsideAttributeElement&&(n._isAllowedInsideAttributeElement=i.isAllowedInsideAttributeElement),n}createUIElement(t,e,i,n={}){const o=new An(this.document,t,e);return i&&(o.render=i),void 0!==n.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),o}createRawElement(t,e,i,n={}){const o=new In(this.document,t,e);return o.render=i||(()=>{}),void 0!==n.isAllowedInsideAttributeElement&&(o._isAllowedInsideAttributeElement=n.isAllowedInsideAttributeElement),o}setAttribute(t,e,i){i._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Ht(t)&&void 0===i&&(i=e),i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}breakAttributes(t){return t instanceof Gi?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const e=t.parent;if(!e.is("containerElement"))throw new a.a("view-writer-break-non-container-element",this.document);if(!e.parent)throw new a.a("view-writer-break-root",this.document);if(t.isAtStart)return Gi._createBefore(e);if(!t.isAtEnd){const i=e._clone(!1);this.insert(Gi._createAfter(e),i);const n=new Zi(t,Gi._createAt(e,"end")),o=new Gi(i,0);this.move(n,o)}return Gi._createAfter(e)}mergeAttributes(t){const e=t.offset,i=t.parent;if(i.is("$text"))return t;if(i.is("attributeElement")&&0===i.childCount){const t=i.parent,e=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new Gi(t,e))}const n=i.getChild(e-1),o=i.getChild(e);if(!n||!o)return t;if(n.is("$text")&&o.is("$text"))return Ln(n,o);if(n.is("attributeElement")&&o.is("attributeElement")&&n.isSimilar(o)){const t=n.childCount;return n._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new Gi(n,t))}return t}mergeContainers(t){const e=t.nodeBefore,i=t.nodeAfter;if(!(e&&i&&e.is("containerElement")&&i.is("containerElement")))throw new a.a("view-writer-merge-containers-invalid-position",this.document);const n=e.getChild(e.childCount-1),o=Gi._createAt(n instanceof li?n:e,"end");return this.move(Zi._createIn(i),Gi._createAt(e,"end")),this.remove(Zi._createOn(i)),o}insert(t,e){!function t(e,i){for(const n of e){if(!Bn.some(t=>n instanceof t))throw new a.a("view-writer-insert-invalid-node-type",i);n.is("$text")||t(n.getChildren(),i)}}(e=Xe(e)?[...e]:[e],this.document);const i=e.reduce((t,e)=>{const i=t[t.length-1],n=!(e.is("uiElement")&&e.isAllowedInsideAttributeElement);return i&&i.breakAttributes==n?i.nodes.push(e):t.push({breakAttributes:n,nodes:[e]}),t},[]);let n=null,o=t;for(const{nodes:r,breakAttributes:s}of i){const t=this._insertNodes(o,r,s);n||(n=t.start),o=t.end}return n?new Zi(n,o):new Zi(t)}remove(t){const e=t instanceof Zi?t:Zi._createOn(t);if(Vn(e,this.document),e.isCollapsed)return new Mn(this.document);const{start:i,end:n}=this._breakAttributesRange(e,!0),o=i.parent._removeChildren(i.offset,n.offset-i.offset);for(const s of o)this._removeFromClonedElementsGroup(s);const r=this.mergeAttributes(i);return e.start=r,e.end=r.clone(),new Mn(this.document,o)}clear(t,e){Vn(t,this.document);const i=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const n of i){const i=n.item;let o;if(i.is("element")&&e.isSimilar(i))o=Zi._createOn(i);else if(!n.nextPosition.isAfter(t.start)&&i.is("$textProxy")){const t=i.getAncestors().find(t=>t.is("element")&&e.isSimilar(t));t&&(o=Zi._createIn(t))}o&&(o.end.isAfter(t.end)&&(o.end=t.end),o.start.isBefore(t.start)&&(o.start=t.start),this.remove(o))}}move(t,e){let i;if(e.isAfter(t.end)){const n=(e=this._breakAttributes(e,!0)).parent,o=n.childCount;t=this._breakAttributesRange(t,!0),i=this.remove(t),e.offset+=n.childCount-o}else i=this.remove(t);return this.insert(e,i)}wrap(t,e){if(!(e instanceof ln))throw new a.a("view-writer-wrap-invalid-attribute",this.document);if(Vn(t,this.document),t.isCollapsed){let i=t.start;i.parent.is("element")&&!Array.from(i.parent.getChildren()).some(t=>!t.is("uiElement"))&&(i=i.getLastMatchingPosition(t=>t.item.is("uiElement"))),i=this._wrapPosition(i,e);const n=this.document.selection;return n.isCollapsed&&n.getFirstPosition().isEqual(t.start)&&this.setSelection(i),new Zi(i)}return this._wrapRange(t,e)}unwrap(t,e){if(!(e instanceof ln))throw new a.a("view-writer-unwrap-invalid-attribute",this.document);if(Vn(t,this.document),t.isCollapsed)return t;const{start:i,end:n}=this._breakAttributesRange(t,!0),o=this._unwrapChildren(i.parent,i.offset,n.offset,e),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const s=this.mergeAttributes(o.end);return new Zi(r,s)}rename(t,e){const i=new Vi(this.document,t,e.getAttributes());return this.insert(Gi._createAfter(e),i),this.move(Zi._createIn(e),Gi._createAt(i,0)),this.remove(Zi._createOn(e)),i}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,e){return Gi._createAt(t,e)}createPositionAfter(t){return Gi._createAfter(t)}createPositionBefore(t){return Gi._createBefore(t)}createRange(t,e){return new Zi(t,e)}createRangeOn(t){return Zi._createOn(t)}createRangeIn(t){return Zi._createIn(t)}createSelection(t,e,i){return new Ki(t,e,i)}_insertNodes(t,e,i){let n,o;if(n=i?Nn(t):t.parent.is("$text")?t.parent.parent:t.parent,!n)throw new a.a("view-writer-invalid-position-container",this.document);o=i?this._breakAttributes(t,!0):t.parent.is("$text")?Fn(t):t;const r=n._insertChild(o.offset,e);for(const a of e)this._addToClonedElementsGroup(a);const s=o.getShiftedBy(r),l=this.mergeAttributes(o);l.isEqual(o)||s.offset--;const c=this.mergeAttributes(s);return new Zi(l,c)}_wrapChildren(t,e,i,n){let o=e;const r=[];for(;o<i;){const e=t.getChild(o),i=e.is("$text"),s=e.is("attributeElement"),a=e.isAllowedInsideAttributeElement;if(s&&this._wrapAttributeElement(n,e))r.push(new Gi(t,o));else if(i||a||s&&Rn(n,e)){const i=n._clone();e._remove(),i._appendChild(e),t._insertChild(o,i),this._addToClonedElementsGroup(i),r.push(new Gi(t,o))}else s&&this._wrapChildren(e,0,e.childCount,n);o++}let s=0;for(const a of r)a.offset-=s,a.offset!=e&&(this.mergeAttributes(a).isEqual(a)||(s++,i--));return Zi._createFromParentsAndOffsets(t,e,t,i)}_unwrapChildren(t,e,i,n){let o=e;const r=[];for(;o<i;){const e=t.getChild(o);if(e.is("attributeElement"))if(e.isSimilar(n)){const n=e.getChildren(),s=e.childCount;e._remove(),t._insertChild(o,n),this._removeFromClonedElementsGroup(e),r.push(new Gi(t,o),new Gi(t,o+s)),o+=s,i+=s-1}else this._unwrapAttributeElement(n,e)?(r.push(new Gi(t,o),new Gi(t,o+1)),o++):(this._unwrapChildren(e,0,e.childCount,n),o++);else o++}let s=0;for(const a of r)a.offset-=s,a.offset!=e&&a.offset!=i&&(this.mergeAttributes(a).isEqual(a)||(s++,i--));return Zi._createFromParentsAndOffsets(t,e,t,i)}_wrapRange(t,e){const{start:i,end:n}=this._breakAttributesRange(t,!0),o=this._wrapChildren(i.parent,i.offset,n.offset,e),r=this.mergeAttributes(o.start);r.isEqual(o.start)||o.end.offset--;const s=this.mergeAttributes(o.end);return new Zi(r,s)}_wrapPosition(t,e){if(e.isSimilar(t.parent))return zn(t.clone());t.parent.is("$text")&&(t=Fn(t));const i=this.createAttributeElement();i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,t.parent._insertChild(t.offset,i);const n=new Zi(t,t.getShiftedBy(1));this.wrap(n,e);const o=new Gi(i.parent,i.index);i._remove();const r=o.nodeBefore,s=o.nodeAfter;return r instanceof li&&s instanceof li?Ln(r,s):zn(o)}_wrapAttributeElement(t,e){if(!Hn(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;for(const i of t.getAttributeKeys())if("class"!==i&&"style"!==i&&e.hasAttribute(i)&&e.getAttribute(i)!==t.getAttribute(i))return!1;for(const i of t.getStyleNames())if(e.hasStyle(i)&&e.getStyle(i)!==t.getStyle(i))return!1;for(const i of t.getAttributeKeys())"class"!==i&&"style"!==i&&(e.hasAttribute(i)||this.setAttribute(i,t.getAttribute(i),e));for(const i of t.getStyleNames())e.hasStyle(i)||this.setStyle(i,t.getStyle(i),e);for(const i of t.getClassNames())e.hasClass(i)||this.addClass(i,e);return!0}_unwrapAttributeElement(t,e){if(!Hn(t,e))return!1;if(t.name!==e.name||t.priority!==e.priority)return!1;for(const i of t.getAttributeKeys())if("class"!==i&&"style"!==i&&(!e.hasAttribute(i)||e.getAttribute(i)!==t.getAttribute(i)))return!1;if(!e.hasClass(...t.getClassNames()))return!1;for(const i of t.getStyleNames())if(!e.hasStyle(i)||e.getStyle(i)!==t.getStyle(i))return!1;for(const i of t.getAttributeKeys())"class"!==i&&"style"!==i&&this.removeAttribute(i,e);return this.removeClass(Array.from(t.getClassNames()),e),this.removeStyle(Array.from(t.getStyleNames()),e),!0}_breakAttributesRange(t,e=!1){const i=t.start,n=t.end;if(Vn(t,this.document),t.isCollapsed){const i=this._breakAttributes(t.start,e);return new Zi(i,i)}const o=this._breakAttributes(n,e),r=o.parent.childCount,s=this._breakAttributes(i,e);return o.offset+=o.parent.childCount-r,new Zi(s,o)}_breakAttributes(t,e=!1){const i=t.offset,n=t.parent;if(t.parent.is("emptyElement"))throw new a.a("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new a.a("view-writer-cannot-break-ui-element",this.document);if(t.parent.is("rawElement"))throw new a.a("view-writer-cannot-break-raw-element",this.document);if(!e&&n.is("$text")&&jn(n.parent))return t.clone();if(jn(n))return t.clone();if(n.is("$text"))return this._breakAttributes(Fn(t),e);if(i==n.childCount){const t=new Gi(n.parent,n.index+1);return this._breakAttributes(t,e)}if(0===i){const t=new Gi(n.parent,n.index);return this._breakAttributes(t,e)}{const t=n.index+1,o=n._clone();n.parent._insertChild(t,o),this._addToClonedElementsGroup(o);const r=n._removeChildren(i,n.childCount-i);o._appendChild(r);const s=new Gi(n.parent,t);return this._breakAttributes(s,e)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const n of t.getChildren())this._addToClonedElementsGroup(n);const e=t.id;if(!e)return;let i=this._cloneGroups.get(e);i||(i=new Set,this._cloneGroups.set(e,i)),i.add(t),t._clonesGroup=i}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const n of t.getChildren())this._removeFromClonedElementsGroup(n);const e=t.id;if(!e)return;const i=this._cloneGroups.get(e);i&&i.delete(t)}}function Nn(t){let e=t.parent;for(;!jn(e);){if(!e)return;e=e.parent}return e}function Rn(t,e){return t.priority<e.priority||!(t.priority>e.priority)&&t.getIdentity()<e.getIdentity()}function zn(t){const e=t.nodeBefore;if(e&&e.is("$text"))return new Gi(e,e.data.length);const i=t.nodeAfter;return i&&i.is("$text")?new Gi(i,0):t}function Fn(t){if(t.offset==t.parent.data.length)return new Gi(t.parent.parent,t.parent.index+1);if(0===t.offset)return new Gi(t.parent.parent,t.parent.index);const e=t.parent.data.slice(t.offset);return t.parent._data=t.parent.data.slice(0,t.offset),t.parent.parent._insertChild(t.parent.index+1,new li(t.root.document,e)),new Gi(t.parent.parent,t.parent.index+1)}function Ln(t,e){const i=t.data.length;return t._data+=e.data,e._remove(),new Gi(t,i)}const Bn=[li,ln,Vi,dn,In,An];function jn(t){return t&&(t.is("containerElement")||t.is("documentFragment"))}function Vn(t,e){const i=Nn(t.start),n=Nn(t.end);if(!i||!n||i!==n)throw new a.a("view-writer-invalid-range-container",e)}function Hn(t,e){return null===t.id&&null===e.id}function Wn(t){return"[object Text]"==Object.prototype.toString.call(t)}const qn=t=>t.createTextNode("\xa0"),Un=t=>{const e=t.createElement("span");return e.dataset.ckeFiller=!0,e.innerHTML="\xa0",e},Yn=t=>{const e=t.createElement("br");return e.dataset.ckeFiller=!0,e},Gn="\u2060".repeat(7);function Zn(t){return Wn(t)&&t.data.substr(0,7)===Gn}function $n(t){return 7==t.data.length&&Zn(t)}function Xn(t){return Zn(t)?t.data.slice(7):t.data}function Kn(t,e){if(e.keyCode==_n.arrowleft){const t=e.domTarget.ownerDocument.defaultView.getSelection();if(1==t.rangeCount&&t.getRangeAt(0).collapsed){const e=t.getRangeAt(0).startContainer,i=t.getRangeAt(0).startOffset;Zn(e)&&i<=7&&t.collapse(e,0)}}}function Qn(t,e,i,n=!1){i=i||function(t,e){return t===e},Array.isArray(t)||(t=Array.prototype.slice.call(t)),Array.isArray(e)||(e=Array.prototype.slice.call(e));const o=function(t,e,i){const n=Jn(t,e,i);if(-1===n)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const o=Jn(to(t,n),to(e,n),i);return{firstIndex:n,lastIndexOld:t.length-o,lastIndexNew:e.length-o}}(t,e,i);return n?function(t,e){const{firstIndex:i,lastIndexOld:n,lastIndexNew:o}=t;if(-1===i)return Array(e).fill("equal");let r=[];return i>0&&(r=r.concat(Array(i).fill("equal"))),o-i>0&&(r=r.concat(Array(o-i).fill("insert"))),n-i>0&&(r=r.concat(Array(n-i).fill("delete"))),o<e&&(r=r.concat(Array(e-o).fill("equal"))),r}(o,e.length):function(t,e){const i=[],{firstIndex:n,lastIndexOld:o,lastIndexNew:r}=e;return r-n>0&&i.push({index:n,type:"insert",values:t.slice(n,r)}),o-n>0&&i.push({index:n+(r-n),type:"delete",howMany:o-n}),i}(e,o)}function Jn(t,e,i){for(let n=0;n<Math.max(t.length,e.length);n++)if(void 0===t[n]||void 0===e[n]||!i(t[n],e[n]))return n;return-1}function to(t,e){return t.slice(e).reverse()}function eo(t,e,i){i=i||function(t,e){return t===e};const n=t.length,o=e.length;if(n>200||o>200||n+o>300)return eo.fastDiff(t,e,i,!0);let r,s;if(o<n){const i=t;t=e,e=i,r="delete",s="insert"}else r="insert",s="delete";const a=t.length,l=e.length,c=l-a,h={},d={};function u(n){const o=(void 0!==d[n-1]?d[n-1]:-1)+1,c=void 0!==d[n+1]?d[n+1]:-1,u=o>c?-1:1;h[n+u]&&(h[n]=h[n+u].slice(0)),h[n]||(h[n]=[]),h[n].push(o>c?r:s);let f=Math.max(o,c),p=f-n;for(;p<a&&f<l&&i(t[p],e[f]);)p++,f++,h[n].push("equal");return f}let f,p=0;do{for(f=-p;f<c;f++)d[f]=u(f);for(f=c+p;f>c;f--)d[f]=u(f);d[c]=u(c),p++}while(d[c]!==l);return h[c].slice(1)}function io(t,e,i){t.insertBefore(i,t.childNodes[e]||null)}function no(t){const e=t.parentNode;e&&e.removeChild(t)}function oo(t){if(t){if(t.defaultView)return t instanceof t.defaultView.Document;if(t.ownerDocument&&t.ownerDocument.defaultView)return t instanceof t.ownerDocument.defaultView.Node}return!1}eo.fastDiff=Qn,i(15);class ro{constructor(t,e){this.domDocuments=new Set,this.domConverter=t,this.markedAttributes=new Set,this.markedChildren=new Set,this.markedTexts=new Set,this.selection=e,this.set("isFocused",!1),this.set("isSelecting",!1),yn&&!vn&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this._inlineFiller=null,this._fakeSelectionContainer=null}markToSync(t,e){if("text"===t)this.domConverter.mapViewToDom(e.parent)&&this.markedTexts.add(e);else{if(!this.domConverter.mapViewToDom(e))return;if("attributes"===t)this.markedAttributes.add(e);else{if("children"!==t)throw new a.a("view-renderer-unknown-type",this);this.markedChildren.add(e)}}}render(){let t;const e=!(yn&&!vn&&this.isSelecting);for(const i of this.markedChildren)this._updateChildrenMappings(i);e?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?t=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(t=this.selection.getFirstPosition(),this.markedChildren.add(t.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(t=this.domConverter.domPositionToView(this._inlineFiller));for(const i of this.markedAttributes)this._updateAttrs(i);for(const i of this.markedChildren)this._updateChildren(i,{inlineFillerPosition:t});for(const i of this.markedTexts)!this.markedChildren.has(i.parent)&&this.domConverter.mapViewToDom(i.parent)&&this._updateText(i,{inlineFillerPosition:t});if(e)if(t){const e=this.domConverter.viewPositionToDom(t),i=e.parent.ownerDocument;this._inlineFiller=Zn(e.parent)?e.parent:so(i,e.parent,e.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(t){const e=this.domConverter.mapViewToDom(t);if(!e)return;const i=Array.from(this.domConverter.mapViewToDom(t).childNodes),n=Array.from(this.domConverter.viewChildrenToDom(t,e.ownerDocument,{withChildren:!1})),o=this._diffNodeLists(i,n),r=this._findReplaceActions(o,i,n);if(-1!==r.indexOf("replace")){const e={equal:0,insert:0,delete:0};for(const o of r)if("replace"===o){const o=e.equal+e.insert,r=e.equal+e.delete,s=t.getChild(o);!s||s.is("uiElement")||s.is("rawElement")||this._updateElementMappings(s,i[r]),no(n[o]),e.equal++}else e[o]++}}_updateElementMappings(t,e){this.domConverter.unbindDomElement(e),this.domConverter.bindElements(e,t),this.markedChildren.add(t),this.markedAttributes.add(t)}_getInlineFillerPosition(){const t=this.selection.getFirstPosition();return t.parent.is("$text")?Gi._createBefore(this.selection.getFirstPosition().parent):t}_isSelectionInInlineFiller(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),e=this.domConverter.viewPositionToDom(t);return!!(e&&Wn(e.parent)&&Zn(e.parent))}_removeInlineFiller(){const t=this._inlineFiller;if(!Zn(t))throw new a.a("view-renderer-filler-was-lost",this);$n(t)?t.remove():t.data=t.data.substr(7),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(1!=this.selection.rangeCount||!this.selection.isCollapsed)return!1;const t=this.selection.getFirstPosition(),e=t.parent,i=t.offset;return!(!this.domConverter.mapViewToDom(e.root)||!e.is("element")||!function(t){if("false"==t.getAttribute("contenteditable"))return!1;const e=t.findAncestor(t=>t.hasAttribute("contenteditable"));return!e||"true"==e.getAttribute("contenteditable")}(e)||i===e.getFillerOffset()||t.nodeBefore instanceof li||t.nodeAfter instanceof li)}_updateText(t,e){const i=this.domConverter.findCorrespondingDomText(t),n=this.domConverter.viewToDom(t,i.ownerDocument),o=i.data;let r=n.data;const s=e.inlineFillerPosition;if(s&&s.parent==t.parent&&s.offset==t.index&&(r=Gn+r),o!=r){const t=Qn(o,r);for(const e of t)"insert"===e.type?i.insertData(e.index,e.values.join("")):i.deleteData(e.index,e.howMany)}}_updateAttrs(t){const e=this.domConverter.mapViewToDom(t);if(!e)return;const i=Array.from(e.attributes).map(t=>t.name),n=t.getAttributeKeys();for(const o of n){const i=t.getAttribute(o);this.domConverter.shouldRenderAttribute(o,i)?e.setAttribute(o,i):e.removeAttribute(o)}for(const o of i)"script"===t.name&&"data-ck-hidden"===o||t.hasAttribute(o)||e.removeAttribute(o)}_updateChildren(t,e){const i=this.domConverter.mapViewToDom(t);if(!i)return;const n=e.inlineFillerPosition,o=this.domConverter.mapViewToDom(t).childNodes,r=Array.from(this.domConverter.viewChildrenToDom(t,i.ownerDocument,{bind:!0}));n&&n.parent===t&&so(i.ownerDocument,r,n.offset);const s=this._diffNodeLists(o,r);let a=0;const l=new Set;for(const c of s)"delete"===c?(l.add(o[a]),no(o[a])):"equal"===c&&a++;a=0;for(const c of s)"insert"===c?(io(i,a,r[a]),a++):"equal"===c&&(this._markDescendantTextToSync(this.domConverter.domToView(r[a])),a++);for(const c of l)c.parentNode||this.domConverter.unbindDomElement(c)}_diffNodeLists(t,e){return eo(t=function(t,e){const i=Array.from(t);return 0!=i.length&&e?(i[i.length-1]==e&&i.pop(),i):i}(t,this._fakeSelectionContainer),e,lo.bind(null,this.domConverter))}_findReplaceActions(t,e,i){if(-1===t.indexOf("insert")||-1===t.indexOf("delete"))return t;let n=[],o=[],r=[];const s={equal:0,insert:0,delete:0};for(const a of t)"insert"===a?r.push(i[s.equal+s.insert]):"delete"===a?o.push(e[s.equal+s.delete]):(n=n.concat(eo(o,r,ao).map(t=>"equal"===t?"replace":t)),n.push("equal"),o=[],r=[]),s[a]++;return n.concat(eo(o,r,ao).map(t=>"equal"===t?"replace":t))}_markDescendantTextToSync(t){if(t)if(t.is("$text"))this.markedTexts.add(t);else if(t.is("element"))for(const e of t.getChildren())this._markDescendantTextToSync(e)}_updateSelection(){if(yn&&!vn&&this.isSelecting&&!this.markedChildren.size)return;if(0===this.selection.rangeCount)return this._removeDomSelection(),void this._removeFakeSelection();const t=this.domConverter.mapViewToDom(this.selection.editableElement);this.isFocused&&t&&(this.selection.isFake?this._updateFakeSelection(t):(this._removeFakeSelection(),this._updateDomSelection(t)))}_updateFakeSelection(t){const e=t.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=function(t){const e=t.createElement("div");return e.className="ck-fake-selection-container",Object.assign(e.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),e.textContent="\xa0",e}(e));const i=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(i,this.selection),!this._fakeSelectionNeedsUpdate(t))return;i.parentElement&&i.parentElement==t||t.appendChild(i),i.textContent=this.selection.fakeSelectionLabel||"\xa0";const n=e.getSelection(),o=e.createRange();n.removeAllRanges(),o.selectNodeContents(i),n.addRange(o)}_updateDomSelection(t){const e=t.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(e))return;const i=this.domConverter.viewPositionToDom(this.selection.anchor),n=this.domConverter.viewPositionToDom(this.selection.focus);e.collapse(i.parent,i.offset),e.extend(n.parent,n.offset),gn&&function(t,e){const i=t.parent;if(i.nodeType!=Node.ELEMENT_NODE||t.offset!=i.childNodes.length-1)return;const n=i.childNodes[t.offset];n&&"BR"==n.tagName&&e.addRange(e.getRangeAt(0))}(n,e)}_domSelectionNeedsUpdate(t){if(!this.domConverter.isDomSelectionCorrect(t))return!0;const e=t&&this.domConverter.domSelectionToView(t);return!(e&&this.selection.isEqual(e)||!this.selection.isCollapsed&&this.selection.isSimilar(e))}_fakeSelectionNeedsUpdate(t){const e=this._fakeSelectionContainer,i=t.ownerDocument.getSelection();return!e||e.parentElement!==t||i.anchorNode!==e&&!e.contains(i.anchorNode)||e.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const t of this.domDocuments)if(t.getSelection().rangeCount){const e=t.activeElement,i=this.domConverter.mapDomToView(e);e&&i&&t.getSelection().removeAllRanges()}}_removeFakeSelection(){const t=this._fakeSelectionContainer;t&&t.remove()}_updateFocus(){if(this.isFocused){const t=this.selection.editableElement;t&&this.domConverter.focus(t)}}}function so(t,e,i){const n=e instanceof Array?e:e.childNodes,o=n[i];if(Wn(o))return o.data=Gn+o.data,o;{const o=t.createTextNode(Gn);return Array.isArray(e)?n.splice(i,0,o):io(e,i,o),o}}function ao(t,e){return oo(t)&&oo(e)&&!Wn(t)&&!Wn(e)&&t.nodeType!==Node.COMMENT_NODE&&e.nodeType!==Node.COMMENT_NODE&&t.tagName.toLowerCase()===e.tagName.toLowerCase()}function lo(t,e,i){return e===i||(Wn(e)&&Wn(i)?e.data===i.data:!(!t.isBlockFiller(e)||!t.isBlockFiller(i)))}Pt(ro,Et);var co={window:window,document:document};function ho(t){let e=0;for(;t.previousSibling;)t=t.previousSibling,e++;return e}function uo(t){const e=[];for(;t&&t.nodeType!=Node.DOCUMENT_NODE;)e.unshift(t),t=t.parentNode;return e}const fo=Yn(document),po=qn(document),go=Un(document);class mo{constructor(t,e={}){this.document=t,this.renderingMode=e.renderingMode||"editing",this.experimentalRenderingMode=!1,this.blockFillerMode=e.blockFillerMode||("editing"===this.renderingMode?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this._domToViewMapping=new WeakMap,this._viewToDomMapping=new WeakMap,this._fakeSelectionMapping=new WeakMap,this._rawContentElementMatcher=new di,this._encounteredRawContentDomNodes=new WeakSet}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new Ki(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const e of t.childNodes)this.unbindDomElement(e)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}shouldRenderAttribute(t,e){return!this.experimentalRenderingMode||"data"===this.renderingMode||!(t.toLowerCase().startsWith("on")||e.match(/(\b)(on\S+)(\s*)=|javascript:|(<\s*)(\/*)script/i)||e.match(/data:(?!image\/(png|jpeg|gif|webp))/i))}setContentOf(t,e){if(!this.experimentalRenderingMode||"data"===this.renderingMode)return void(t.innerHTML=e);const i=(new DOMParser).parseFromString(e,"text/html"),n=i.createDocumentFragment(),o=i.body.childNodes;for(;o.length>0;)n.appendChild(o[0]);const r=i.createTreeWalker(n,NodeFilter.SHOW_ELEMENT),s=[];let a;for(;a=r.nextNode();)s.push(a);for(const l of s){for(const e of l.getAttributeNames()){const t=l.getAttribute(e);this.shouldRenderAttribute(e,t)||l.removeAttribute(e)}const t=l.tagName.toLowerCase();this._shouldRenameElement(t)&&l.replaceWith(this._createReplacementDomElement(t,l))}for(;t.firstChild;)t.firstChild.remove();t.append(n)}viewToDom(t,e,i={}){if(t.is("$text")){const i=this._processDataFromViewText(t);return e.createTextNode(i)}{if(this.mapViewToDom(t))return this.mapViewToDom(t);let n;if(t.is("documentFragment"))n=e.createDocumentFragment(),i.bind&&this.bindDocumentFragments(n,t);else{if(t.is("uiElement"))return n="$comment"===t.name?e.createComment(t.getCustomProperty("$rawContent")):t.render(e,this),i.bind&&this.bindElements(n,t),n;n=this._shouldRenameElement(t.name)?this._createReplacementDomElement(t.name):t.hasAttribute("xmlns")?e.createElementNS(t.getAttribute("xmlns"),t.name):e.createElement(t.name),t.is("rawElement")&&t.render(n,this),i.bind&&this.bindElements(n,t);for(const e of t.getAttributeKeys()){const i=t.getAttribute(e);this.shouldRenderAttribute(e,i)&&n.setAttribute(e,i)}}if(!1!==i.withChildren)for(const o of this.viewChildrenToDom(t,e,i))n.appendChild(o);return n}}*viewChildrenToDom(t,e,i={}){const n=t.getFillerOffset&&t.getFillerOffset();let o=0;for(const r of t.getChildren())n===o&&(yield this._getBlockFiller(e)),yield this.viewToDom(r,e,i),o++;n===o&&(yield this._getBlockFiller(e))}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),i=this.viewPositionToDom(t.end),n=document.createRange();return n.setStart(e.parent,e.offset),n.setEnd(i.parent,i.offset),n}viewPositionToDom(t){const e=t.parent;if(e.is("$text")){const i=this.findCorrespondingDomText(e);if(!i)return null;let n=t.offset;return Zn(i)&&(n+=7),{parent:i,offset:n}}{let i,n,o;if(0===t.offset){if(i=this.mapViewToDom(e),!i)return null;o=i.childNodes[0]}else{const e=t.nodeBefore;if(n=e.is("$text")?this.findCorrespondingDomText(e):this.mapViewToDom(t.nodeBefore),!n)return null;i=n.parentNode,o=n.nextSibling}return Wn(o)&&Zn(o)?{parent:o,offset:7}:{parent:i,offset:n?ho(n)+1:0}}}domToView(t,e={}){if(this.isBlockFiller(t))return null;const i=this.getHostViewElement(t);if(i)return i;if(this.isComment(t)&&e.skipComments)return null;if(Wn(t)){if($n(t))return null;{const e=this._processDataFromDomText(t);return""===e?null:new li(this.document,e)}}{if(this.mapDomToView(t))return this.mapDomToView(t);let i;if(this.isDocumentFragment(t))i=new Mn(this.document),e.bind&&this.bindDocumentFragments(t,i);else{i=this._createViewElement(t,e),e.bind&&this.bindElements(t,i);const n=t.attributes;if(n)for(let t=n.length-1;t>=0;t--)i._setAttribute(n[t].name,n[t].value);if(this._isViewElementWithRawContent(i,e)||this.isComment(t)){const e=this.isComment(t)?t.data:t.innerHTML;return i._setCustomProperty("$rawContent",e),this._encounteredRawContentDomNodes.add(t),i}}if(!1!==e.withChildren)for(const n of this.domChildrenToView(t,e))i._appendChild(n);return i}}*domChildrenToView(t,e={}){for(let i=0;i<t.childNodes.length;i++){const n=this.domToView(t.childNodes[i],e);null!==n&&(yield n)}}domSelectionToView(t){if(1===t.rangeCount){let e=t.getRangeAt(0).startContainer;Wn(e)&&(e=e.parentNode);const i=this.fakeSelectionToView(e);if(i)return i}const e=this.isDomSelectionBackward(t),i=[];for(let n=0;n<t.rangeCount;n++){const e=t.getRangeAt(n),o=this.domRangeToView(e);o&&i.push(o)}return new Ki(i,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),i=this.domPositionToView(t.endContainer,t.endOffset);return e&&i?new Zi(e,i):null}domPositionToView(t,e=0){if(this.isBlockFiller(t))return this.domPositionToView(t.parentNode,ho(t));const i=this.mapDomToView(t);if(i&&(i.is("uiElement")||i.is("rawElement")))return Gi._createBefore(i);if(Wn(t)){if($n(t))return this.domPositionToView(t.parentNode,ho(t));const i=this.findCorrespondingViewText(t);let n=e;return i?(Zn(t)&&(n-=7,n=n<0?0:n),new Gi(i,n)):null}if(0===e){const e=this.mapDomToView(t);if(e)return new Gi(e,0)}else{const i=t.childNodes[e-1],n=Wn(i)?this.findCorrespondingViewText(i):this.mapDomToView(i);if(n&&n.parent)return new Gi(n.parent,n.index+1)}return null}mapDomToView(t){return this.getHostViewElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if($n(t))return null;const e=this.getHostViewElement(t);if(e)return e;const i=t.previousSibling;if(i){if(!this.isElement(i))return null;const t=this.mapDomToView(i);if(t)return t.nextSibling instanceof li?t.nextSibling:null}else{const e=this.mapDomToView(t.parentNode);if(e){const t=e.getChild(0);return t instanceof li?t:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:t,scrollY:i}=co.window,n=[];vo(e,t=>{const{scrollLeft:e,scrollTop:i}=t;n.push([e,i])}),e.focus(),vo(e,t=>{const[e,i]=n.shift();t.scrollLeft=e,t.scrollTop=i}),co.window.scrollTo(t,i)}}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isComment(t){return t&&t.nodeType==Node.COMMENT_NODE}isBlockFiller(t){return"br"==this.blockFillerMode?t.isEqualNode(fo):!("BR"!==t.tagName||!yo(t,this.blockElements)||1!==t.parentNode.childNodes.length)||t.isEqualNode(go)||function(t,e){return t.isEqualNode(po)&&yo(t,e)&&1===t.parentNode.childNodes.length}(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=document.createRange();e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);const i=e.collapsed;return e.detach(),i}getHostViewElement(t){const e=uo(t);for(e.pop();e.length;){const t=e.pop(),i=this._domToViewMapping.get(t);if(i&&(i.is("uiElement")||i.is("rawElement")))return i}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}registerRawContentMatcher(t){this._rawContentElementMatcher.add(t)}_getBlockFiller(t){switch(this.blockFillerMode){case"nbsp":return qn(t);case"markedNbsp":return Un(t);case"br":return Yn(t)}}_isDomSelectionPositionCorrect(t,e){if(Wn(t)&&Zn(t)&&e<7)return!1;if(this.isElement(t)&&Zn(t.childNodes[e]))return!1;const i=this.mapDomToView(t);return!i||!i.is("uiElement")&&!i.is("rawElement")}_processDataFromViewText(t){let e=t.data;if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return e;if(" "==e.charAt(0)){const i=this._getTouchingInlineViewNode(t,!1);!(i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i))&&i||(e="\xa0"+e.substr(1))}if(" "==e.charAt(e.length-1)){const i=this._getTouchingInlineViewNode(t,!0),n=i&&i.is("$textProxy")&&" "==i.data.charAt(0);" "!=e.charAt(e.length-2)&&i&&!n||(e=e.substr(0,e.length-1)+"\xa0")}return e.replace(/ {2}/g," \xa0")}_nodeEndsWithSpace(t){if(t.getAncestors().some(t=>this.preElements.includes(t.name)))return!1;const e=this._processDataFromViewText(t);return" "==e.charAt(e.length-1)}_processDataFromDomText(t){let e=t.data;if(function(t,e){return uo(t).some(t=>t.tagName&&e.includes(t.tagName.toLowerCase()))}(t,this.preElements))return Xn(t);e=e.replace(/[ \n\t\r]{1,}/g," ");const i=this._getTouchingInlineDomNode(t,!1),n=this._getTouchingInlineDomNode(t,!0),o=this._checkShouldLeftTrimDomText(t,i),r=this._checkShouldRightTrimDomText(t,n);o&&(e=e.replace(/^ /,"")),r&&(e=e.replace(/ $/,"")),e=Xn(new Text(e)),e=e.replace(/ \u00A0/g,"  ");const s=n&&this.isElement(n)&&"BR"!=n.tagName,a=n&&Wn(n)&&" "==n.data.charAt(0);return(/( |\u00A0)\u00A0$/.test(e)||!n||s||a)&&(e=e.replace(/\u00A0$/," ")),(o||i&&this.isElement(i)&&"BR"!=i.tagName)&&(e=e.replace(/^\u00A0/," ")),e}_checkShouldLeftTrimDomText(t,e){return!e||(this.isElement(e)?"BR"===e.tagName:!this._encounteredRawContentDomNodes.has(t.previousSibling)&&/[^\S\u00A0]/.test(e.data.charAt(e.data.length-1)))}_checkShouldRightTrimDomText(t,e){return!e&&!Zn(t)}_getTouchingInlineViewNode(t,e){const i=new Yi({startPosition:e?Gi._createAfter(t):Gi._createBefore(t),direction:e?"forward":"backward"});for(const n of i){if(n.item.is("element")&&this.inlineObjectElements.includes(n.item.name))return n.item;if(n.item.is("containerElement"))return null;if(n.item.is("element","br"))return null;if(n.item.is("$textProxy"))return n.item}return null}_getTouchingInlineDomNode(t,e){if(!t.parentNode)return null;const i=e?"firstChild":"lastChild",n=e?"nextSibling":"previousSibling";let o=!0;do{if(!o&&t[i]?t=t[i]:t[n]?(t=t[n],o=!1):(t=t.parentNode,o=!0),!t||this._isBlockElement(t))return null}while(!Wn(t)&&"BR"!=t.tagName&&!this._isInlineObjectElement(t));return t}_isBlockElement(t){return this.isElement(t)&&this.blockElements.includes(t.tagName.toLowerCase())}_isInlineObjectElement(t){return this.isElement(t)&&this.inlineObjectElements.includes(t.tagName.toLowerCase())}_createViewElement(t,e){if(this.isComment(t))return new An(this.document,"$comment");const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();return new Bi(this.document,i)}_isViewElementWithRawContent(t,e){return!1!==e.withChildren&&this._rawContentElementMatcher.match(t)}_shouldRenameElement(t){return this.experimentalRenderingMode&&"editing"==this.renderingMode&&"script"==t}_createReplacementDomElement(t,e=null){const i=document.createElement("span");if(i.setAttribute("data-ck-hidden",t),e){for(;e.firstChild;)i.appendChild(e.firstChild);for(const t of e.getAttributeNames())i.setAttribute(t,e.getAttribute(t))}return i}}function vo(t,e){for(;t&&t!=co.document;)e(t),t=t.parentNode}function yo(t,e){const i=t.parentNode;return i&&i.tagName&&e.includes(i.tagName.toLowerCase())}function bo(t){const e=Object.prototype.toString.apply(t);return"[object Window]"==e||"[object global]"==e}var wo=yt({},h,{listenTo(t,...e){if(oo(t)||bo(t)){const i=this._getProxyEmitter(t)||new ko(t);i.attach(...e),t=i}h.listenTo.call(this,t,...e)},stopListening(t,e,i){if(oo(t)||bo(t)){const e=this._getProxyEmitter(t);if(!e)return;t=e}h.stopListening.call(this,t,e,i),t instanceof ko&&t.detach(e)},_getProxyEmitter(t){return e=this,i=_o(t),e[l]&&e[l][i]?e[l][i].emitter:null;var e,i}});class ko{constructor(t){d(this,_o(t)),this._domNode=t}}function _o(t){return t["data-ck-expando"]||(t["data-ck-expando"]=r())}yt(ko.prototype,h,{attach(t,e,i={}){if(this._domListeners&&this._domListeners[t])return;const n={capture:!!i.useCapture,passive:!!i.usePassive},o=this._createDomListener(t,n);this._domNode.addEventListener(t,o,n),this._domListeners||(this._domListeners={}),this._domListeners[t]=o},detach(t){let e;!this._domListeners[t]||(e=this._events[t])&&e.callbacks.length||this._domListeners[t].removeListener()},_createDomListener(t,e){const i=e=>{this.fire(t,e)};return i.removeListener=()=>{this._domNode.removeEventListener(t,i,e),delete this._domListeners[t]},i}});class xo{constructor(t){this.view=t,this.document=t.document,this.isEnabled=!1}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(t){return t&&3===t.nodeType&&(t=t.parentNode),!(!t||1!==t.nodeType)&&t.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}function Co(t){var e=-1,i=null==t?0:t.length;for(this.__data__=new ee;++e<i;)this.add(t[e])}Pt(xo,wo),Co.prototype.add=Co.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Co.prototype.has=function(t){return this.__data__.has(t)};var Eo=Co,To=function(t,e){for(var i=-1,n=null==t?0:t.length;++i<n;)if(e(t[i],i,t))return!0;return!1},So=function(t,e){return t.has(e)},Ao=function(t,e,i,n,o,r){var s=1&i,a=t.length,l=e.length;if(a!=l&&!(s&&l>a))return!1;var c=r.get(t),h=r.get(e);if(c&&h)return c==e&&h==t;var d=-1,u=!0,f=2&i?new Eo:void 0;for(r.set(t,e),r.set(e,t);++d<a;){var p=t[d],g=e[d];if(n)var m=s?n(g,p,d,e,t,r):n(p,g,d,t,e,r);if(void 0!==m){if(m)continue;u=!1;break}if(f){if(!To(e,function(t,e){if(!So(f,e)&&(p===t||o(p,t,i,n,r)))return f.push(e)})){u=!1;break}}else if(p!==g&&!o(p,g,i,n,r)){u=!1;break}}return r.delete(t),r.delete(e),u},Oo=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t,n){i[++e]=[n,t]}),i},Io=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i},Po=w?w.prototype:void 0,Mo=Po?Po.valueOf:void 0,Do=Object.prototype.hasOwnProperty,No=Object.prototype.hasOwnProperty,Ro=function t(e,i,n,o,r){return e===i||(null==e||null==i||!J(e)&&!J(i)?e!=e&&i!=i:function(t,e,i,n,o,r){var s=rt(t),a=rt(e),l=s?"[object Array]":Ae(t),c=a?"[object Array]":Ae(e),h="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),u=l==c;if(u&&Object(st.a)(t)){if(!Object(st.a)(e))return!1;s=!0,h=!1}if(u&&!h)return r||(r=new ne),s||dt(t)?Ao(t,e,i,n,o,r):function(t,e,i,n,o,r,s){switch(i){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new Ie(t),new Ie(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return L(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var a=Oo;case"[object Set]":if(a||(a=Io),t.size!=e.size&&!(1&n))return!1;var l=s.get(t);if(l)return l==e;n|=2,s.set(t,e);var c=Ao(a(t),a(e),n,o,r,s);return s.delete(t),c;case"[object Symbol]":if(Mo)return Mo.call(t)==Mo.call(e)}return!1}(t,e,l,i,n,o,r);if(!(1&i)){var f=h&&No.call(t,"__wrapped__"),p=d&&No.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return r||(r=new ne),o(g,m,i,n,r)}}return!!u&&(r||(r=new ne),function(t,e,i,n,o,r){var s=1&i,a=me(t),l=a.length;if(l!=me(e).length&&!s)return!1;for(var c=l;c--;){var h=a[c];if(!(s?h in e:Do.call(e,h)))return!1}var d=r.get(t),u=r.get(e);if(d&&u)return d==e&&u==t;var f=!0;r.set(t,e),r.set(e,t);for(var p=s;++c<l;){var g=t[h=a[c]],m=e[h];if(n)var v=s?n(m,g,h,e,t,r):n(g,m,h,t,e,r);if(!(void 0===v?g===m||o(g,m,i,n,r):v)){f=!1;break}p||(p="constructor"==h)}if(f&&!p){var y=t.constructor,b=e.constructor;y==b||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(f=!1)}return r.delete(t),r.delete(e),f}(t,e,i,n,o,r))}(e,i,n,o,t,r))},zo=function(t,e,i){var n=(i="function"==typeof i?i:void 0)?i(t,e):void 0;return void 0===n?Ro(t,e,void 0,i):!!n};class Fo extends xo{constructor(t){super(t),this._config={childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},this.domConverter=t.domConverter,this.renderer=t._renderer,this._domElements=[],this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(t){this._domElements.push(t),this.isEnabled&&this._mutationObserver.observe(t,this._config)}enable(){super.enable();for(const t of this._domElements)this._mutationObserver.observe(t,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(t){if(0===t.length)return;const e=this.domConverter,i=new Map,n=new Set;for(const l of t)if("childList"===l.type){const t=e.mapDomToView(l.target);if(t&&(t.is("uiElement")||t.is("rawElement")))continue;t&&!this._isBogusBrMutation(l)&&n.add(t)}for(const l of t){const t=e.mapDomToView(l.target);if((!t||!t.is("uiElement")&&!t.is("rawElement"))&&"characterData"===l.type){const t=e.findCorrespondingViewText(l.target);t&&!n.has(t.parent)?i.set(t,{type:"text",oldText:t.data,newText:Xn(l.target),node:t}):!t&&Zn(l.target)&&n.add(e.mapDomToView(l.target.parentNode))}}const o=[];for(const l of i.values())this.renderer.markToSync("text",l.node),o.push(l);for(const l of n){const t=e.mapViewToDom(l),i=Array.from(l.getChildren()),n=Array.from(e.domChildrenToView(t,{withChildren:!1}));zo(i,n,a)||(this.renderer.markToSync("children",l),o.push({type:"children",oldChildren:i,newChildren:n,node:l}))}const r=t[0].target.ownerDocument.getSelection();let s=null;if(r&&r.anchorNode){const t=e.domPositionToView(r.anchorNode,r.anchorOffset),i=e.domPositionToView(r.focusNode,r.focusOffset);t&&i&&(s=new Ki(t),s.setFocus(i))}function a(t,e){if(!Array.isArray(t))return t===e||!(!t.is("$text")||!e.is("$text"))&&t.data===e.data}o.length&&(this.document.fire("mutations",o,s),this.view.forceRender())}_isBogusBrMutation(t){let e=null;return null===t.nextSibling&&0===t.removedNodes.length&&1==t.addedNodes.length&&(e=this.domConverter.domToView(t.addedNodes[0],{withChildren:!1})),e&&e.is("element","br")}}class Lo{constructor(t,e,i){this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,yt(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Bo extends xo{constructor(t){super(t),this.useCapture=!1}observe(t){("string"==typeof this.domEventType?[this.domEventType]:this.domEventType).forEach(e=>{this.listenTo(t,e,(t,e)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(e.target)&&this.onDomEvent(e)},{useCapture:this.useCapture})})}fire(t,e,i){this.isEnabled&&this.document.fire(t,new Lo(this.view,e,i))}}class jo extends Bo{constructor(t){super(t),this.domEventType=["keydown","keyup"]}onDomEvent(t){this.fire(t.type,t,{keyCode:t.keyCode,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey,metaKey:t.metaKey,get keystroke(){return Cn(this)}})}}var Vo=function(){return b.a.Date.now()},Ho=/\s/,Wo=/^\s+/,qo=/^[-+]0x[0-9a-f]+$/i,Uo=/^0b[01]+$/i,Yo=/^0o[0-7]+$/i,Go=parseInt,Zo=function(t){if("number"==typeof t)return t;if(pi(t))return NaN;if(y(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=y(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=function(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Ho.test(t.charAt(e)););return e}(t)+1).replace(Wo,""):t}(t);var i=Uo.test(t);return i||Yo.test(t)?Go(t.slice(2),i?2:8):qo.test(t)?NaN:+t},$o=Math.max,Xo=Math.min,Ko=function(t,e,i){var n,o,r,s,a,l,c=0,h=!1,d=!1,u=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=n,r=o;return n=o=void 0,c=e,s=t.apply(r,i)}function p(t){return c=t,a=setTimeout(m,e),h?f(t):s}function g(t){var i=t-l;return void 0===l||i>=e||i<0||d&&t-c>=r}function m(){var t=Vo();if(g(t))return v(t);a=setTimeout(m,function(t){var i=e-(t-l);return d?Xo(i,r-(t-c)):i}(t))}function v(t){return a=void 0,u&&n?f(t):(n=o=void 0,s)}function b(){var t=Vo(),i=g(t);if(n=arguments,o=this,l=t,i){if(void 0===a)return p(l);if(d)return clearTimeout(a),a=setTimeout(m,e),f(l)}return void 0===a&&(a=setTimeout(m,e)),s}return e=Zo(e)||0,y(i)&&(h=!!i.leading,r=(d="maxWait"in i)?$o(Zo(i.maxWait)||0,e):r,u="trailing"in i?!!i.trailing:u),b.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=o=a=void 0},b.flush=function(){return void 0===a?s:v(Vo())},b};class Qo extends xo{constructor(t){super(t),this._fireSelectionChangeDoneDebounced=Ko(t=>this.document.fire("selectionChangeDone",t),200)}observe(){const t=this.document;t.on("arrowKey",(e,i)=>{t.selection.isFake&&this.isEnabled&&i.preventDefault()},{context:"$capture"}),t.on("arrowKey",(e,i)=>{t.selection.isFake&&this.isEnabled&&this._handleSelectionMove(i.keyCode)},{priority:"lowest"})}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(t){const e=this.document.selection,i=new Ki(e.getRanges(),{backward:e.isBackward,fake:!1});t!=_n.arrowleft&&t!=_n.arrowup||i.setTo(i.getFirstPosition()),t!=_n.arrowright&&t!=_n.arrowdown||i.setTo(i.getLastPosition());const n={oldSelection:e,newSelection:i,domSelection:null};this.document.fire("selectionChange",n),this._fireSelectionChangeDoneDebounced(n)}}class Jo extends xo{constructor(t){super(t),this.mutationObserver=t.getObserver(Fo),this.selection=this.document.selection,this.domConverter=t.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Ko(t=>this.document.fire("selectionChangeDone",t),200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Ko(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(t){const e=t.ownerDocument,i=()=>{this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel()};this.listenTo(t,"selectstart",()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},{priority:"highest"}),this.listenTo(t,"keydown",i,{priority:"highest"}),this.listenTo(t,"keyup",i,{priority:"highest"}),this._documents.has(e)||(this.listenTo(e,"mouseup",i,{priority:"highest"}),this.listenTo(e,"selectionchange",(t,i)=>{this._handleSelectionChange(i,e),this._documentIsSelectingInactivityTimeoutDebounced()}),this._documents.add(e))}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_handleSelectionChange(t,e){if(!this.isEnabled)return;const i=e.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(i.anchorNode))return;this.mutationObserver.flush();const n=this.domConverter.domSelectionToView(i);if(0!=n.rangeCount){if(this.view.hasDomSelection=!0,!(this.selection.isEqual(n)&&this.domConverter.isDomSelectionCorrect(i)||++this._loopbackCounter>60))if(this.selection.isSimilar(n))this.view.forceRender();else{const t={oldSelection:this.selection,newSelection:n,domSelection:i};this.document.fire("selectionChange",t),this._fireSelectionChangeDoneDebounced(t)}}else this.view.hasDomSelection=!1}_clearInfiniteLoop(){this._loopbackCounter=0}}class tr extends Bo{constructor(t){super(t),this.domEventType=["focus","blur"],this.useCapture=!0;const e=this.document;e.on("focus",()=>{e.isFocused=!0,this._renderTimeoutId=setTimeout(()=>t.change(()=>{}),50)}),e.on("blur",(i,n)=>{const o=e.selection.editableElement;null!==o&&o!==n.target||(e.isFocused=!1,t.change(()=>{}))})}onDomEvent(t){this.fire(t.type,t)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class er extends Bo{constructor(t){super(t),this.domEventType=["compositionstart","compositionupdate","compositionend"];const e=this.document;e.on("compositionstart",()=>{e.isComposing=!0}),e.on("compositionend",()=>{e.isComposing=!1})}onDomEvent(t){this.fire(t.type,t)}}class ir extends Bo{constructor(t){super(t),this.domEventType=["beforeinput"]}onDomEvent(t){this.fire(t.type,t)}}var nr=function(t){return"string"==typeof t||!rt(t)&&J(t)&&"[object String]"==S(t)};function or(t){return"[object Range]"==Object.prototype.toString.apply(t)}function rr(t){const e=t.ownerDocument.defaultView.getComputedStyle(t);return{top:parseInt(e.borderTopWidth,10),right:parseInt(e.borderRightWidth,10),bottom:parseInt(e.borderBottomWidth,10),left:parseInt(e.borderLeftWidth,10)}}const sr=["top","right","bottom","left","width","height"];class ar{constructor(t){const e=or(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),Ye(t)||e)if(e){const e=ar.getDomRangeRects(t);lr(this,ar.getBoundingRect(e))}else lr(this,t.getBoundingClientRect());else if(bo(t)){const{innerWidth:e,innerHeight:i}=t;lr(this,{top:0,right:e,bottom:i,left:0,width:e,height:i})}else lr(this,t)}clone(){return new ar(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left)};return e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0?null:new ar(e)}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(!cr(t)){let i=t.parentNode||t.commonAncestorContainer;for(;i&&!cr(i);){const t=new ar(i),n=e.getIntersection(t);if(!n)return null;n.getArea()<e.getArea()&&(e=n),i=i.parentNode}}return e}isEqual(t){for(const e of sr)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!(!e||!e.isEqual(t))}excludeScrollbarsAndBorders(){const t=this._source;let e,i,n;if(bo(t))e=t.innerWidth-t.document.documentElement.clientWidth,i=t.innerHeight-t.document.documentElement.clientHeight,n=t.getComputedStyle(t.document.documentElement).direction;else{const o=rr(this._source);e=t.offsetWidth-t.clientWidth-o.left-o.right,i=t.offsetHeight-t.clientHeight-o.top-o.bottom,n=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,"ltr"===n?this.right-=e:this.left+=e,this.height-=i,this.bottom-=i,this}static getDomRangeRects(t){const e=[],i=Array.from(t.getClientRects());if(i.length)for(const n of i)e.push(new ar(n));else{let i=t.startContainer;Wn(i)&&(i=i.parentNode);const n=new ar(i.getBoundingClientRect());n.right=n.left,n.width=0,e.push(n)}return e}static getBoundingRect(t){const e={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY};let i=0;for(const n of t)i++,e.left=Math.min(e.left,n.left),e.top=Math.min(e.top,n.top),e.right=Math.max(e.right,n.right),e.bottom=Math.max(e.bottom,n.bottom);return 0==i?null:(e.width=e.right-e.left,e.height=e.bottom-e.top,new ar(e))}}function lr(t,e){for(const i of sr)t[i]=e[i]}function cr(t){return!!Ye(t)&&t===t.ownerDocument.body}class hr{constructor(t,e){hr._observerInstance||hr._createObserver(),this._element=t,this._callback=e,hr._addElementCallback(t,e),hr._observerInstance.observe(t)}destroy(){hr._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,e){hr._elementCallbacks||(hr._elementCallbacks=new Map);let i=hr._elementCallbacks.get(t);i||(i=new Set,hr._elementCallbacks.set(t,i)),i.add(e)}static _deleteElementCallback(t,e){const i=hr._getElementCallbacks(t);i&&(i.delete(e),i.size||(hr._elementCallbacks.delete(t),hr._observerInstance.unobserve(t))),hr._elementCallbacks&&!hr._elementCallbacks.size&&(hr._observerInstance=null,hr._elementCallbacks=null)}static _getElementCallbacks(t){return hr._elementCallbacks?hr._elementCallbacks.get(t):null}static _createObserver(){let t;t="function"==typeof co.window.ResizeObserver?co.window.ResizeObserver:dr,hr._observerInstance=new t(t=>{for(const e of t){const t=hr._getElementCallbacks(e.target);if(t)for(const i of t)i(e)}})}}hr._observerInstance=null,hr._elementCallbacks=null;class dr{constructor(t){this._callback=t,this._elements=new Set,this._previousRects=new Map,this._periodicCheckTimeout=null}observe(t){this._elements.add(t),this._checkElementRectsAndExecuteCallback(),1===this._elements.size&&this._startPeriodicCheck()}unobserve(t){this._elements.delete(t),this._previousRects.delete(t),this._elements.size||this._stopPeriodicCheck()}_startPeriodicCheck(){const t=()=>{this._checkElementRectsAndExecuteCallback(),this._periodicCheckTimeout=setTimeout(t,100)};this.listenTo(co.window,"resize",()=>{this._checkElementRectsAndExecuteCallback()}),this._periodicCheckTimeout=setTimeout(t,100)}_stopPeriodicCheck(){clearTimeout(this._periodicCheckTimeout),this.stopListening(),this._previousRects.clear()}_checkElementRectsAndExecuteCallback(){const t=[];for(const e of this._elements)this._hasRectChanged(e)&&t.push({target:e,contentRect:this._previousRects.get(e)});t.length&&this._callback(t)}_hasRectChanged(t){if(!t.ownerDocument.body.contains(t))return!1;const e=new ar(t),i=this._previousRects.get(t),n=!i||!i.isEqual(e);return this._previousRects.set(t,e),n}}function ur(t){return e=>e+t}function fr(t){const e=t.next();return e.done?null:e.value}Pt(dr,wo);class pr{constructor(){this.set("isFocused",!1),this.set("focusedElement",null),this._elements=new Set,this._nextEventLoopTimeout=null}add(t){if(this._elements.has(t))throw new a.a("focustracker-add-element-already-exist",this);this.listenTo(t,"focus",()=>this._focus(t),{useCapture:!0}),this.listenTo(t,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(t)}remove(t){t===this.focusedElement&&this._blur(t),this._elements.has(t)&&(this.stopListening(t),this._elements.delete(t))}destroy(){this.stopListening()}_focus(t){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=t,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}Pt(pr,wo),Pt(pr,Et);class gr{constructor(){this._listener=Object.create(wo)}listenTo(t){this._listener.listenTo(t,"keydown",(t,e)=>{this._listener.fire("_keydown:"+Cn(e),e)})}set(t,e,i={}){const n=En(t);this._listener.listenTo(this._listener,"_keydown:"+n,(t,i)=>{e(i,()=>{i.preventDefault(),i.stopPropagation(),t.stop()}),t.return=!0},{priority:i.priority})}press(t){return!!this._listener.fire("_keydown:"+Cn(t),t)}destroy(){this._listener.stopListening()}}class mr extends xo{constructor(t){super(t),this.document.on("keydown",(t,e)=>{if(this.isEnabled&&((i=e.keyCode)==_n.arrowright||i==_n.arrowleft||i==_n.arrowup||i==_n.arrowdown)){const i=new Ji(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(i,e),i.stop.called&&t.stop()}var i})}observe(){}}function vr({target:t,viewportOffset:e=0}){const i=Cr(t);let n=i,o=null;for(;n;){let r;r=Er(n==i?t:o),br(r,()=>Tr(t,n));const s=Tr(t,n);if(yr(n,s,e),n.parent!=n){if(o=n.frameElement,n=n.parent,!o)return}else n=null}}function yr(t,e,i){const n=e.clone().moveBy(0,i),o=e.clone().moveBy(0,-i),r=new ar(t).excludeScrollbarsAndBorders();if(![o,n].every(t=>r.contains(t))){let{scrollX:s,scrollY:a}=t;kr(o,r)?a-=r.top-e.top+i:wr(n,r)&&(a+=e.bottom-r.bottom+i),_r(e,r)?s-=r.left-e.left+i:xr(e,r)&&(s+=e.right-r.right+i),t.scrollTo(s,a)}}function br(t,e){const i=Cr(t);let n,o;for(;t!=i.document.body;)o=e(),n=new ar(t).excludeScrollbarsAndBorders(),n.contains(o)||(kr(o,n)?t.scrollTop-=n.top-o.top:wr(o,n)&&(t.scrollTop+=o.bottom-n.bottom),_r(o,n)?t.scrollLeft-=n.left-o.left:xr(o,n)&&(t.scrollLeft+=o.right-n.right)),t=t.parentNode}function wr(t,e){return t.bottom>e.bottom}function kr(t,e){return t.top<e.top}function _r(t,e){return t.left<e.left}function xr(t,e){return t.right>e.right}function Cr(t){return or(t)?t.startContainer.ownerDocument.defaultView:t.ownerDocument.defaultView}function Er(t){if(or(t)){let e=t.commonAncestorContainer;return Wn(e)&&(e=e.parentNode),e}return t.parentNode}function Tr(t,e){const i=Cr(t),n=new ar(t);if(i===e)return n;{let t=i;for(;t!=e;){const e=new ar(t.frameElement).excludeScrollbarsAndBorders();n.moveBy(e.left,e.top),t=t.parent}}return n}Object.assign({},{scrollViewportToShowTarget:vr,scrollAncestorsToShowTarget:function(t){br(Er(t),()=>new ar(t))}});class Sr{constructor(t){this.document=new an(t),this.domConverter=new mo(this.document),this.domRoots=new Map,this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new ro(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting").to(this.document),this._initialDomRootAttributes=new WeakMap,this._observers=new Map,this._ongoingChange=!1,this._postFixersInProgress=!1,this._renderingDisabled=!1,this._hasChangedSinceTheLastRendering=!1,this._writer=new Dn(this.document),this.addObserver(Fo),this.addObserver(Jo),this.addObserver(tr),this.addObserver(jo),this.addObserver(Qo),this.addObserver(er),this.addObserver(mr),vn&&this.addObserver(ir),this.document.on("arrowKey",Kn,{priority:"low"}),function(t){t.document.on("arrowKey",(e,i)=>function(t,e,i){if(e.keyCode==_n.arrowright){const t=e.domTarget.ownerDocument.defaultView.getSelection(),n=1==t.rangeCount&&t.getRangeAt(0).collapsed;if(n||e.shiftKey){const e=i.domPositionToView(t.focusNode,t.focusOffset);if(null===e)return;let o=!1;const r=e.getLastMatchingPosition(t=>(t.item.is("uiElement")&&(o=!0),!(!t.item.is("uiElement")&&!t.item.is("attributeElement"))));if(o){const e=i.viewPositionToDom(r);n?t.collapse(e.parent,e.offset):t.extend(e.parent,e.offset)}}}}(0,i,t.domConverter),{priority:"low"})}(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0})}attachDomRoot(t,e="main"){const i=this.document.getRoot(e);i._name=t.tagName.toLowerCase();const n={};for(const{name:r,value:s}of Array.from(t.attributes))n[r]=s,"class"===r?this._writer.addClass(s.split(" "),i):this._writer.setAttribute(r,s,i);this._initialDomRootAttributes.set(t,n);const o=()=>{this._writer.setAttribute("contenteditable",!i.isReadOnly,i),i.isReadOnly?this._writer.addClass("ck-read-only",i):this._writer.removeClass("ck-read-only",i)};o(),this.domRoots.set(e,t),this.domConverter.bindElements(t,i),this._renderer.markToSync("children",i),this._renderer.markToSync("attributes",i),this._renderer.domDocuments.add(t.ownerDocument),i.on("change:children",(t,e)=>this._renderer.markToSync("children",e)),i.on("change:attributes",(t,e)=>this._renderer.markToSync("attributes",e)),i.on("change:text",(t,e)=>this._renderer.markToSync("text",e)),i.on("change:isReadOnly",()=>this.change(o)),i.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const r of this._observers.values())r.observe(t,e)}detachDomRoot(t){const e=this.domRoots.get(t);Array.from(e.attributes).forEach(({name:t})=>e.removeAttribute(t));const i=this._initialDomRootAttributes.get(e);for(const n in i)e.setAttribute(n,i[n]);this.domRoots.delete(t),this.domConverter.unbindDomElement(e)}getDomRoot(t="main"){return this.domRoots.get(t)}addObserver(t){let e=this._observers.get(t);if(e)return e;e=new t(this),this._observers.set(t,e);for(const[i,n]of this.domRoots)e.observe(n,i);return e.enable(),e}getObserver(t){return this._observers.get(t)}disableObservers(){for(const t of this._observers.values())t.disable()}enableObservers(){for(const t of this._observers.values())t.enable()}scrollToTheSelection(){const t=this.document.selection.getFirstRange();t&&vr({target:this.domConverter.viewRangeToDom(t),viewportOffset:20})}focus(){if(!this.document.isFocused){const t=this.document.selection.editableElement;t&&(this.domConverter.focus(t),this.forceRender())}}change(t){if(this.isRenderingInProgress||this._postFixersInProgress)throw new a.a("cannot-change-view-tree",this);try{if(this._ongoingChange)return t(this._writer);this._ongoingChange=!0;const e=t(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),e}catch(t){a.a.rethrowUnexpectedError(t,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.change(()=>{})}destroy(){for(const t of this._observers.values())t.destroy();this.document.destroy(),this.stopListening()}createPositionAt(t,e){return Gi._createAt(t,e)}createPositionAfter(t){return Gi._createAfter(t)}createPositionBefore(t){return Gi._createBefore(t)}createRange(t,e){return new Zi(t,e)}createRangeOn(t){return Zi._createOn(t)}createRangeIn(t){return Zi._createIn(t)}createSelection(t,e,i){return new Ki(t,e,i)}_disableRendering(t){this._renderingDisabled=t,0==t&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}}Pt(Sr,Et);class Ar{constructor(t){this.parent=null,this._attrs=hi(t)}get index(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildIndex(this)))throw new a.a("model-node-not-found-in-parent",this);return t}get startOffset(){let t;if(!this.parent)return null;if(null===(t=this.parent.getChildStartOffset(this)))throw new a.a("model-node-not-found-in-parent",this);return t}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const t=this.index;return null!==t&&this.parent.getChild(t+1)||null}get previousSibling(){const t=this.index;return null!==t&&this.parent.getChild(t-1)||null}get root(){let t=this;for(;t.parent;)t=t.parent;return t}isAttached(){return this.root.is("rootElement")}getPath(){const t=[];let e=this;for(;e.parent;)t.unshift(e.startOffset),e=e.parent;return t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let i=t.includeSelf?this:this.parent;for(;i;)e[t.parentFirst?"push":"unshift"](i),i=i.parent;return e}getCommonAncestor(t,e={}){const i=this.getAncestors(e),n=t.getAncestors(e);let o=0;for(;i[o]==n[o]&&i[o];)o++;return 0===o?null:i[o-1]}isBefore(t){if(this==t)return!1;if(this.root!==t.root)return!1;const e=this.getPath(),i=t.getPath(),n=ri(e,i);switch(n){case"prefix":return!0;case"extension":return!1;default:return e[n]<i[n]}}isAfter(t){return this!=t&&this.root===t.root&&!this.isBefore(t)}hasAttribute(t){return this._attrs.has(t)}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const t={};return this._attrs.size&&(t.attributes=Array.from(this._attrs).reduce((t,e)=>(t[e[0]]=e[1],t),{})),t}is(t){return"node"===t||"model:node"===t}_clone(){return new Ar(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(t,e){this._attrs.set(t,e)}_setAttributesTo(t){this._attrs=hi(t)}_removeAttribute(t){return this._attrs.delete(t)}_clearAttributes(){this._attrs.clear()}}class Or extends Ar{constructor(t,e){super(e),this._data=t||""}get offsetSize(){return this.data.length}get data(){return this._data}is(t){return"$text"===t||"model:$text"===t||"text"===t||"model:text"===t||"node"===t||"model:node"===t}toJSON(){const t=super.toJSON();return t.data=this.data,t}_clone(){return new Or(this.data,this.getAttributes())}static fromJSON(t){return new Or(t.data,t.attributes)}}class Ir{constructor(t,e,i){if(this.textNode=t,e<0||e>t.offsetSize)throw new a.a("model-textproxy-wrong-offsetintext",this);if(i<0||e+i>t.offsetSize)throw new a.a("model-textproxy-wrong-length",this);this.data=t.data.substring(e,e+i),this.offsetInText=e}get startOffset(){return null!==this.textNode.startOffset?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return null!==this.startOffset?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}is(t){return"$textProxy"===t||"model:$textProxy"===t||"textProxy"===t||"model:textProxy"===t}getPath(){const t=this.textNode.getPath();return t.length>0&&(t[t.length-1]+=this.offsetInText),t}getAncestors(t={includeSelf:!1,parentFirst:!1}){const e=[];let i=t.includeSelf?this:this.parent;for(;i;)e[t.parentFirst?"push":"unshift"](i),i=i.parent;return e}hasAttribute(t){return this.textNode.hasAttribute(t)}getAttribute(t){return this.textNode.getAttribute(t)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}class Pr{constructor(t){this._nodes=[],t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return-1==e?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return null===e?null:this._nodes.slice(0,e).reduce((t,e)=>t+e.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new a.a("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const i of this._nodes){if(t>=e&&t<e+i.offsetSize)return this.getNodeIndex(i);e+=i.offsetSize}if(e!=t)throw new a.a("model-nodelist-offset-out-of-bounds",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const i of e)if(!(i instanceof Ar))throw new a.a("model-nodelist-insertnodes-not-node",this);this._nodes.splice(t,0,...e)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class Mr extends Ar{constructor(t,e,i){super(e),this.name=t,this._children=new Pr,i&&this._insertChild(0,i)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}is(t,e=null){return e?e===this.name&&("element"===t||"model:element"===t):"element"===t||"model:element"===t||"node"===t||"model:node"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}offsetToIndex(t){return this._children.offsetToIndex(t)}getNodeByPath(t){let e=this;for(const i of t)e=e.getChild(e.offsetToIndex(i));return e}findAncestor(t,e={includeSelf:!1}){let i=e.includeSelf?this:this.parent;for(;i;){if(i.name===t)return i;i=i.parent}return null}toJSON(){const t=super.toJSON();if(t.name=this.name,this._children.length>0){t.children=[];for(const e of this._children)t.children.push(e.toJSON())}return t}_clone(t=!1){const e=t?Array.from(this._children).map(t=>t._clone(!0)):null;return new Mr(this.name,this.getAttributes(),e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const i=function(t){return"string"==typeof t?[new Or(t)]:(Xe(t)||(t=[t]),Array.from(t).map(t=>"string"==typeof t?new Or(t):t instanceof Ir?new Or(t.data,t.getAttributes()):t))}(e);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(t,i)}_removeChildren(t,e=1){const i=this._children._removeNodes(t,e);for(const n of i)n.parent=null;return i}static fromJSON(t){let e=null;if(t.children){e=[];for(const i of t.children)e.push(i.name?Mr.fromJSON(i):Or.fromJSON(i))}return new Mr(t.name,t.attributes,e)}}class Dr{constructor(t={}){if(!t.boundaries&&!t.startPosition)throw new a.a("model-tree-walker-no-start-position",null);const e=t.direction||"forward";if("forward"!=e&&"backward"!=e)throw new a.a("model-tree-walker-unknown-direction",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,this.position=t.startPosition?t.startPosition.clone():Rr._createAt(this.boundaries["backward"==this.direction?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}skip(t){let e,i,n,o;do{n=this.position,o=this._visitedParent,({done:e,value:i}=this.next())}while(!e&&t(i));e||(this.position=n,this._visitedParent=o)}next(){return"forward"==this.direction?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(null===i.parent&&e.offset===i.maxOffset)return{done:!0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0};const n=e.parent,o=zr(e,n),r=o||Fr(e,n,o);if(r instanceof Mr)return this.shallow?e.offset++:(e.path.push(0),this._visitedParent=r),this.position=e,Nr("elementStart",r,t,e,1);if(r instanceof Or){let n;if(this.singleCharacters)n=1;else{let t=r.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<t&&(t=this.boundaries.end.offset),n=t-e.offset}const o=new Ir(r,e.offset-r.startOffset,n);return e.offset+=n,this.position=e,Nr("text",o,t,e,n)}return e.path.pop(),e.offset++,this.position=e,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():Nr("elementEnd",i,t,e)}_previous(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(null===i.parent&&0===e.offset)return{done:!0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0};const n=e.parent,o=zr(e,n),r=o||Lr(e,n,o);if(r instanceof Mr)return e.offset--,this.shallow?(this.position=e,Nr("elementStart",r,t,e,1)):(e.path.push(r.maxOffset),this.position=e,this._visitedParent=r,this.ignoreElementEnd?this._previous():Nr("elementEnd",r,t,e));if(r instanceof Or){let n;if(this.singleCharacters)n=1;else{let t=r.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>t&&(t=this.boundaries.start.offset),n=e.offset-t}const o=new Ir(r,e.offset-r.startOffset-n,n);return e.offset-=n,this.position=e,Nr("text",o,t,e,n)}return e.path.pop(),this.position=e,this._visitedParent=i.parent,Nr("elementStart",i,t,e,1)}}function Nr(t,e,i,n,o){return{done:!1,value:{type:t,item:e,previousPosition:i,nextPosition:n,length:o}}}class Rr{constructor(t,e,i="toNone"){if(!t.is("element")&&!t.is("documentFragment"))throw new a.a("model-position-root-invalid",t);if(!(e instanceof Array)||0===e.length)throw new a.a("model-position-path-incorrect-format",t,{path:e});t.is("rootElement")?e=e.slice():(e=[...t.getPath(),...e],t=t.root),this.root=t,this.path=e,this.stickiness=i}get offset(){return this.path[this.path.length-1]}set offset(t){this.path[this.path.length-1]=t}get parent(){let t=this.root;for(let e=0;e<this.path.length-1;e++)if(t=t.getChild(t.offsetToIndex(this.path[e])),!t)throw new a.a("model-position-path-incorrect",this,{position:this});if(t.is("$text"))throw new a.a("model-position-path-incorrect",this,{position:this});return t}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return zr(this,this.parent)}get nodeAfter(){const t=this.parent;return Fr(this,t,zr(this,t))}get nodeBefore(){const t=this.parent;return Lr(this,t,zr(this,t))}get isAtStart(){return 0===this.offset}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(t){if(this.root!=t.root)return"different";const e=ri(this.path,t.path);switch(e){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[e]<t.path[e]?"before":"after"}}getLastMatchingPosition(t,e={}){e.startPosition=this;const i=new Dr(e);return i.skip(t),i.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const t=this.parent;return t.is("documentFragment")?[t]:t.getAncestors({includeSelf:!0})}findAncestor(t){const e=this.parent;return e.is("element")?e.findAncestor(t,{includeSelf:!0}):null}getCommonPath(t){if(this.root!=t.root)return[];const e=ri(this.path,t.path),i="string"==typeof e?Math.min(this.path.length,t.path.length):e;return this.path.slice(0,i)}getCommonAncestor(t){const e=this.getAncestors(),i=t.getAncestors();let n=0;for(;e[n]==i[n]&&e[n];)n++;return 0===n?null:e[n-1]}getShiftedBy(t){const e=this.clone(),i=e.offset+t;return e.offset=i<0?0:i,e}isAfter(t){return"after"==this.compareWith(t)}isBefore(t){return"before"==this.compareWith(t)}isEqual(t){return"same"==this.compareWith(t)}isTouching(t){let e=null,i=null;switch(this.compareWith(t)){case"same":return!0;case"before":e=Rr._createAt(this),i=Rr._createAt(t);break;case"after":e=Rr._createAt(t),i=Rr._createAt(this);break;default:return!1}let n=e.parent;for(;e.path.length+i.path.length;){if(e.isEqual(i))return!0;if(e.path.length>i.path.length){if(e.offset!==n.maxOffset)return!1;e.path=e.path.slice(0,-1),n=n.parent,e.offset++}else{if(0!==i.offset)return!1;i.path=i.path.slice(0,-1)}}}is(t){return"position"===t||"model:position"===t}hasSameParentAs(t){return this.root===t.root&&"same"==ri(this.getParentPath(),t.getParentPath())}getTransformedByOperation(t){let e;switch(t.type){case"insert":e=this._getTransformedByInsertOperation(t);break;case"move":case"remove":case"reinsert":e=this._getTransformedByMoveOperation(t);break;case"split":e=this._getTransformedBySplitOperation(t);break;case"merge":e=this._getTransformedByMergeOperation(t);break;default:e=Rr._createAt(this)}return e}_getTransformedByInsertOperation(t){return this._getTransformedByInsertion(t.position,t.howMany)}_getTransformedByMoveOperation(t){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany)}_getTransformedBySplitOperation(t){const e=t.movedRange;return e.containsPosition(this)||e.start.isEqual(this)&&"toNext"==this.stickiness?this._getCombined(t.splitPosition,t.moveTargetPosition):t.graveyardPosition?this._getTransformedByMove(t.graveyardPosition,t.insertionPosition,1):this._getTransformedByInsertion(t.insertionPosition,1)}_getTransformedByMergeOperation(t){const e=t.movedRange;let i;return e.containsPosition(this)||e.start.isEqual(this)?(i=this._getCombined(t.sourcePosition,t.targetPosition),t.sourcePosition.isBefore(t.targetPosition)&&(i=i._getTransformedByDeletion(t.deletionPosition,1))):i=this.isEqual(t.deletionPosition)?Rr._createAt(t.deletionPosition):this._getTransformedByMove(t.deletionPosition,t.graveyardPosition,1),i}_getTransformedByDeletion(t,e){const i=Rr._createAt(this);if(this.root!=t.root)return i;if("same"==ri(t.getParentPath(),this.getParentPath())){if(t.offset<this.offset){if(t.offset+e>this.offset)return null;i.offset-=e}}else if("prefix"==ri(t.getParentPath(),this.getParentPath())){const n=t.path.length-1;if(t.offset<=this.path[n]){if(t.offset+e>this.path[n])return null;i.path[n]-=e}}return i}_getTransformedByInsertion(t,e){const i=Rr._createAt(this);if(this.root!=t.root)return i;if("same"==ri(t.getParentPath(),this.getParentPath()))(t.offset<this.offset||t.offset==this.offset&&"toPrevious"!=this.stickiness)&&(i.offset+=e);else if("prefix"==ri(t.getParentPath(),this.getParentPath())){const n=t.path.length-1;t.offset<=this.path[n]&&(i.path[n]+=e)}return i}_getTransformedByMove(t,e,i){if(e=e._getTransformedByDeletion(t,i),t.isEqual(e))return Rr._createAt(this);const n=this._getTransformedByDeletion(t,i);return null===n||t.isEqual(this)&&"toNext"==this.stickiness||t.getShiftedBy(i).isEqual(this)&&"toPrevious"==this.stickiness?this._getCombined(t,e):n._getTransformedByInsertion(e,i)}_getCombined(t,e){const i=t.path.length-1,n=Rr._createAt(e);return n.stickiness=this.stickiness,n.offset=n.offset+this.path[i]-t.offset,n.path=[...n.path,...this.path.slice(i+1)],n}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(t,e,i="toNone"){if(t instanceof Rr)return new Rr(t.root,t.path,t.stickiness);{const n=t;if("end"==e)e=n.maxOffset;else{if("before"==e)return this._createBefore(n,i);if("after"==e)return this._createAfter(n,i);if(0!==e&&!e)throw new a.a("model-createpositionat-offset-required",[this,t])}if(!n.is("element")&&!n.is("documentFragment"))throw new a.a("model-position-parent-incorrect",[this,t]);const o=n.getPath();return o.push(e),new this(n.root,o,i)}}static _createAfter(t,e){if(!t.parent)throw new a.a("model-position-after-root",[this,t],{root:t});return this._createAt(t.parent,t.endOffset,e)}static _createBefore(t,e){if(!t.parent)throw new a.a("model-position-before-root",t,{root:t});return this._createAt(t.parent,t.startOffset,e)}static fromJSON(t,e){if("$graveyard"===t.root){const i=new Rr(e.graveyard,t.path);return i.stickiness=t.stickiness,i}if(!e.getRoot(t.root))throw new a.a("model-position-fromjson-no-root",e,{rootName:t.root});return new Rr(e.getRoot(t.root),t.path,t.stickiness)}}function zr(t,e){const i=e.getChild(e.offsetToIndex(t.offset));return i&&i.is("$text")&&i.startOffset<t.offset?i:null}function Fr(t,e,i){return null!==i?null:e.getChild(e.offsetToIndex(t.offset))}function Lr(t,e,i){return null!==i?null:e.getChild(e.offsetToIndex(t.offset)-1)}class Br{constructor(t,e=null){this.start=Rr._createAt(t),this.end=Rr._createAt(e||t),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Dr({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return"same"==ri(this.start.getParentPath(),this.end.getParentPath())}get root(){return this.start.root}containsPosition(t){return t.isAfter(this.start)&&t.isBefore(this.end)}containsRange(t,e=!1){t.isCollapsed&&(e=!1);const i=this.containsPosition(t.start)||e&&this.start.isEqual(t.start),n=this.containsPosition(t.end)||e&&this.end.isEqual(t.end);return i&&n}containsItem(t){const e=Rr._createBefore(t);return this.containsPosition(e)||this.start.isEqual(e)}is(t){return"range"===t||"model:range"===t}isEqual(t){return this.start.isEqual(t.start)&&this.end.isEqual(t.end)}isIntersecting(t){return this.start.isBefore(t.end)&&this.end.isAfter(t.start)}getDifference(t){const e=[];return this.isIntersecting(t)?(this.containsPosition(t.start)&&e.push(new Br(this.start,t.start)),this.containsPosition(t.end)&&e.push(new Br(t.end,this.end))):e.push(new Br(this.start,this.end)),e}getIntersection(t){if(this.isIntersecting(t)){let e=this.start,i=this.end;return this.containsPosition(t.start)&&(e=t.start),this.containsPosition(t.end)&&(i=t.end),new Br(e,i)}return null}getJoined(t,e=!1){let i=this.isIntersecting(t);if(i||(i=this.start.isBefore(t.start)?e?this.end.isTouching(t.start):this.end.isEqual(t.start):e?t.end.isTouching(this.start):t.end.isEqual(this.start)),!i)return null;let n=this.start,o=this.end;return t.start.isBefore(n)&&(n=t.start),t.end.isAfter(o)&&(o=t.end),new Br(n,o)}getMinimalFlatRanges(){const t=[],e=this.start.getCommonPath(this.end).length,i=Rr._createAt(this.start);let n=i.parent;for(;i.path.length>e+1;){const e=n.maxOffset-i.offset;0!==e&&t.push(new Br(i,i.getShiftedBy(e))),i.path=i.path.slice(0,-1),i.offset++,n=n.parent}for(;i.path.length<=this.end.path.length;){const e=this.end.path[i.path.length-1],n=e-i.offset;0!==n&&t.push(new Br(i,i.getShiftedBy(n))),i.offset=e,i.path.push(0)}return t}getWalker(t={}){return t.boundaries=this,new Dr(t)}*getItems(t={}){t.boundaries=this,t.ignoreElementEnd=!0;const e=new Dr(t);for(const i of e)yield i.item}*getPositions(t={}){t.boundaries=this;const e=new Dr(t);yield e.position;for(const i of e)yield i.nextPosition}getTransformedByOperation(t){switch(t.type){case"insert":return this._getTransformedByInsertOperation(t);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(t);case"split":return[this._getTransformedBySplitOperation(t)];case"merge":return[this._getTransformedByMergeOperation(t)]}return[new Br(this.start,this.end)]}getTransformedByOperations(t){const e=[new Br(this.start,this.end)];for(const i of t)for(let t=0;t<e.length;t++){const n=e[t].getTransformedByOperation(i);e.splice(t,1,...n),t+=n.length-1}for(let i=0;i<e.length;i++){const t=e[i];for(let n=i+1;n<e.length;n++){const i=e[n];(t.containsRange(i)||i.containsRange(t)||t.isEqual(i))&&e.splice(n,1)}}return e}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const t=this.start.nodeAfter,e=this.end.nodeBefore;return t&&t.is("element")&&t===e?t:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(t,e=!1){return this._getTransformedByInsertion(t.position,t.howMany,e)}_getTransformedByMoveOperation(t,e=!1){return this._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,e)}_getTransformedBySplitOperation(t){const e=this.start._getTransformedBySplitOperation(t);let i=this.end._getTransformedBySplitOperation(t);return this.end.isEqual(t.insertionPosition)&&(i=this.end.getShiftedBy(1)),e.root!=i.root&&(i=this.end.getShiftedBy(-1)),new Br(e,i)}_getTransformedByMergeOperation(t){if(this.start.isEqual(t.targetPosition)&&this.end.isEqual(t.deletionPosition))return new Br(this.start);let e=this.start._getTransformedByMergeOperation(t),i=this.end._getTransformedByMergeOperation(t);return e.root!=i.root&&(i=this.end.getShiftedBy(-1)),e.isAfter(i)?(t.sourcePosition.isBefore(t.targetPosition)?(e=Rr._createAt(i),e.offset=0):(t.deletionPosition.isEqual(e)||(i=t.deletionPosition),e=t.targetPosition),new Br(e,i)):new Br(e,i)}_getTransformedByInsertion(t,e,i=!1){if(i&&this.containsPosition(t))return[new Br(this.start,t),new Br(t.getShiftedBy(e),this.end._getTransformedByInsertion(t,e))];{const i=new Br(this.start,this.end);return i.start=i.start._getTransformedByInsertion(t,e),i.end=i.end._getTransformedByInsertion(t,e),[i]}}_getTransformedByMove(t,e,i,n=!1){if(this.isCollapsed){const n=this.start._getTransformedByMove(t,e,i);return[new Br(n)]}const o=Br._createFromPositionAndShift(t,i),r=e._getTransformedByDeletion(t,i);if(this.containsPosition(e)&&!n&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const n=this.start._getTransformedByMove(t,e,i),o=this.end._getTransformedByMove(t,e,i);return[new Br(n,o)]}let s;const a=this.getDifference(o);let l=null;const c=this.getIntersection(o);if(1==a.length?l=new Br(a[0].start._getTransformedByDeletion(t,i),a[0].end._getTransformedByDeletion(t,i)):2==a.length&&(l=new Br(this.start,this.end._getTransformedByDeletion(t,i))),s=l?l._getTransformedByInsertion(r,i,null!==c||n):[],c){const t=new Br(c.start._getCombined(o.start,r),c.end._getCombined(o.start,r));2==s.length?s.splice(1,0,t):s.push(t)}return s}_getTransformedByDeletion(t,e){let i=this.start._getTransformedByDeletion(t,e),n=this.end._getTransformedByDeletion(t,e);return null==i&&null==n?null:(null==i&&(i=t),null==n&&(n=t),new Br(i,n))}static _createFromPositionAndShift(t,e){const i=t,n=t.getShiftedBy(e);return e>0?new this(i,n):new this(n,i)}static _createIn(t){return new this(Rr._createAt(t,0),Rr._createAt(t,t.maxOffset))}static _createOn(t){return this._createFromPositionAndShift(Rr._createBefore(t),t.offsetSize)}static _createFromRanges(t){if(0===t.length)throw new a.a("range-create-from-ranges-empty-array",null);if(1==t.length)return t[0].clone();const e=t[0];t.sort((t,e)=>t.start.isAfter(e.start)?1:-1);const i=t.indexOf(e),n=new this(e.start,e.end);if(i>0)for(let o=i-1;t[o].end.isEqual(n.start);o++)n.start=Rr._createAt(t[o].start);for(let o=i+1;o<t.length&&t[o].start.isEqual(n.end);o++)n.end=Rr._createAt(t[o].end);return n}static fromJSON(t,e){return new this(Rr.fromJSON(t.start,e),Rr.fromJSON(t.end,e))}}class jr{constructor(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._viewToModelLengthCallbacks=new Map,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this.on("modelToViewPosition",(t,e)=>{if(e.viewPosition)return;const i=this._modelToViewMapping.get(e.modelPosition.parent);e.viewPosition=this.findPositionIn(i,e.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(t,e)=>{if(e.modelPosition)return;const i=this.findMappedViewAncestor(e.viewPosition),n=this._viewToModelMapping.get(i),o=this._toModelOffset(e.viewPosition.parent,e.viewPosition.offset,i);e.modelPosition=Rr._createAt(n,o)},{priority:"low"})}bindElements(t,e){this._modelToViewMapping.set(t,e),this._viewToModelMapping.set(e,t)}unbindViewElement(t){const e=this.toModelElement(t);if(this._viewToModelMapping.delete(t),this._elementToMarkerNames.has(t))for(const i of this._elementToMarkerNames.get(t))this._unboundMarkerNames.add(i);this._modelToViewMapping.get(e)==t&&this._modelToViewMapping.delete(e)}unbindModelElement(t){const e=this.toViewElement(t);this._modelToViewMapping.delete(t),this._viewToModelMapping.get(e)==t&&this._viewToModelMapping.delete(e)}bindElementToMarker(t,e){const i=this._markerNameToElements.get(e)||new Set;i.add(t);const n=this._elementToMarkerNames.get(t)||new Set;n.add(e),this._markerNameToElements.set(e,i),this._elementToMarkerNames.set(t,n)}unbindElementFromMarkerName(t,e){const i=this._markerNameToElements.get(e);i&&(i.delete(t),0==i.size&&this._markerNameToElements.delete(e));const n=this._elementToMarkerNames.get(t);n&&(n.delete(e),0==n.size&&this._elementToMarkerNames.delete(t))}flushUnboundMarkerNames(){const t=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),t}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set}toModelElement(t){return this._viewToModelMapping.get(t)}toViewElement(t){return this._modelToViewMapping.get(t)}toModelRange(t){return new Br(this.toModelPosition(t.start),this.toModelPosition(t.end))}toViewRange(t){return new Zi(this.toViewPosition(t.start),this.toViewPosition(t.end))}toModelPosition(t){const e={viewPosition:t,mapper:this};return this.fire("viewToModelPosition",e),e.modelPosition}toViewPosition(t,e={isPhantom:!1}){const i={modelPosition:t,mapper:this,isPhantom:e.isPhantom};return this.fire("modelToViewPosition",i),i.viewPosition}markerNameToElements(t){const e=this._markerNameToElements.get(t);if(!e)return null;const i=new Set;for(const n of e)if(n.is("attributeElement"))for(const t of n.getElementsWithSameId())i.add(t);else i.add(n);return i}registerViewToModelLength(t,e){this._viewToModelLengthCallbacks.set(t,e)}findMappedViewAncestor(t){let e=t.parent;for(;!this._viewToModelMapping.has(e);)e=e.parent;return e}_toModelOffset(t,e,i){if(i!=t)return this._toModelOffset(t.parent,t.index,i)+this._toModelOffset(t,e,t);if(t.is("$text"))return e;let n=0;for(let o=0;o<e;o++)n+=this.getModelLength(t.getChild(o));return n}getModelLength(t){if(this._viewToModelLengthCallbacks.get(t.name))return this._viewToModelLengthCallbacks.get(t.name)(t);if(this._viewToModelMapping.has(t))return 1;if(t.is("$text"))return t.data.length;if(t.is("uiElement"))return 0;{let e=0;for(const i of t.getChildren())e+=this.getModelLength(i);return e}}findPositionIn(t,e){let i,n=0,o=0,r=0;if(t.is("$text"))return new Gi(t,e);for(;o<e;)i=t.getChild(r),n=this.getModelLength(i),o+=n,r++;return o==e?this._moveViewPositionToTextNode(new Gi(t,r)):this.findPositionIn(i,e-(o-n))}_moveViewPositionToTextNode(t){const e=t.nodeBefore,i=t.nodeAfter;return e instanceof li?new Gi(e,e.data.length):i instanceof li?new Gi(i,0):t}}Pt(jr,h);class Vr{constructor(){this._consumable=new Map,this._textProxyRegistry=new Map}add(t,e){e=Hr(e),t instanceof Ir&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}consume(t,e){return e=Hr(e),t instanceof Ir&&(t=this._getSymbolForTextProxy(t)),!!this.test(t,e)&&(this._consumable.get(t).set(e,!1),!0)}test(t,e){e=Hr(e),t instanceof Ir&&(t=this._getSymbolForTextProxy(t));const i=this._consumable.get(t);if(void 0===i)return null;const n=i.get(e);return void 0===n?null:n}revert(t,e){e=Hr(e),t instanceof Ir&&(t=this._getSymbolForTextProxy(t));const i=this.test(t,e);return!1===i?(this._consumable.get(t).set(e,!0),!0):!0!==i&&null}_getSymbolForTextProxy(t){let e=null;const i=this._textProxyRegistry.get(t.startOffset);if(i){const n=i.get(t.endOffset);n&&(e=n.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t.startOffset,t.endOffset,t.parent)),e}_addSymbolForTextProxy(t,e,i){const n=Symbol("textProxySymbol");let o,r;return o=this._textProxyRegistry.get(t),o||(o=new Map,this._textProxyRegistry.set(t,o)),r=o.get(e),r||(r=new Map,o.set(e,r)),r.set(i,n),n}}function Hr(t){const e=t.split(":");return"addMarker"==e[0]||"removeMarker"==e[0]?t:e.length>1?e[0]+":"+e[1]:e[0]}class Wr{constructor(t){this.conversionApi=Object.assign({dispatcher:this},t),this._reconversionEventsMapping=new Map}convertChanges(t,e,i){for(const o of t.getMarkersToRemove())this.convertMarkerRemove(o.name,o.range,i);const n=this._mapChangesWithAutomaticReconversion(t);for(const o of n)"insert"===o.type?this.convertInsert(Br._createFromPositionAndShift(o.position,o.length),i):"remove"===o.type?this.convertRemove(o.position,o.length,o.name,i):"reconvert"===o.type?this.reconvertElement(o.element,i):this.convertAttribute(o.range,o.attributeKey,o.attributeOldValue,o.attributeNewValue,i);for(const o of this.conversionApi.mapper.flushUnboundMarkerNames()){const t=e.get(o).getRange();this.convertMarkerRemove(o,t,i),this.convertMarkerAdd(o,t,i)}for(const o of t.getMarkersToAdd())this.convertMarkerAdd(o.name,o.range,i)}convertInsert(t,e){this.conversionApi.writer=e,this.conversionApi.consumable=this._createInsertConsumable(t);for(const i of Array.from(t).map(Ur))this._convertInsertWithAttributes(i);this._clearConversionApi()}convertRemove(t,e,i,n){this.conversionApi.writer=n,this.fire("remove:"+i,{position:t,length:e},this.conversionApi),this._clearConversionApi()}convertAttribute(t,e,i,n,o){this.conversionApi.writer=o,this.conversionApi.consumable=this._createConsumableForRange(t,"attribute:"+e);for(const r of t){const t={item:r.item,range:Br._createFromPositionAndShift(r.previousPosition,r.length),attributeKey:e,attributeOldValue:i,attributeNewValue:n};this._testAndFire("attribute:"+e,t)}this._clearConversionApi()}reconvertElement(t,e){const i=Br._createOn(t);this.conversionApi.writer=e,this.conversionApi.consumable=this._createInsertConsumable(i);const n=this.conversionApi.mapper,o=n.toViewElement(t);e.remove(o),this._convertInsertWithAttributes({item:t,range:i});const r=n.toViewElement(t);for(const s of Br._createIn(t)){const{item:t}=s,i=Yr(t,n);i?i.root!==r.root&&e.move(e.createRangeOn(i),n.toViewPosition(Rr._createBefore(t))):this._convertInsertWithAttributes(Ur(s))}n.unbindViewElement(o),this._clearConversionApi()}convertSelection(t,e,i){const n=Array.from(e.getMarkersAtPosition(t.getFirstPosition()));if(this.conversionApi.writer=i,this.conversionApi.consumable=this._createSelectionConsumable(t,n),this.fire("selection",{selection:t},this.conversionApi),t.isCollapsed){for(const e of n){const i=e.getRange();if(!qr(t.getFirstPosition(),e,this.conversionApi.mapper))continue;const n={item:t,markerName:e.name,markerRange:i};this.conversionApi.consumable.test(t,"addMarker:"+e.name)&&this.fire("addMarker:"+e.name,n,this.conversionApi)}for(const e of t.getAttributeKeys()){const i={item:t,range:t.getFirstRange(),attributeKey:e,attributeOldValue:null,attributeNewValue:t.getAttribute(e)};this.conversionApi.consumable.test(t,"attribute:"+i.attributeKey)&&this.fire("attribute:"+i.attributeKey+":$text",i,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerAdd(t,e,i){if("$graveyard"==e.root.rootName)return;this.conversionApi.writer=i;const n="addMarker:"+t,o=new Vr;if(o.add(e,n),this.conversionApi.consumable=o,this.fire(n,{markerName:t,markerRange:e},this.conversionApi),o.test(e,n)){this.conversionApi.consumable=this._createConsumableForRange(e,n);for(const i of e.getItems()){if(!this.conversionApi.consumable.test(i,n))continue;const o={item:i,range:Br._createOn(i),markerName:t,markerRange:e};this.fire(n,o,this.conversionApi)}this._clearConversionApi()}else this._clearConversionApi()}convertMarkerRemove(t,e,i){"$graveyard"!=e.root.rootName&&(this.conversionApi.writer=i,this.fire("removeMarker:"+t,{markerName:t,markerRange:e},this.conversionApi),this._clearConversionApi())}_mapReconversionTriggerEvent(t,e){this._reconversionEventsMapping.set(e,t)}_createInsertConsumable(t){const e=new Vr;for(const i of t){const t=i.item;e.add(t,"insert");for(const i of t.getAttributeKeys())e.add(t,"attribute:"+i)}return e}_createConsumableForRange(t,e){const i=new Vr;for(const n of t.getItems())i.add(n,e);return i}_createSelectionConsumable(t,e){const i=new Vr;i.add(t,"selection");for(const n of e)i.add(t,"addMarker:"+n.name);for(const n of t.getAttributeKeys())i.add(t,"attribute:"+n);return i}_testAndFire(t,e){this.conversionApi.consumable.test(e.item,t)&&this.fire(function(t,e){return`${t}:${e.item.name||"$text"}`}(t,e),e,this.conversionApi)}_clearConversionApi(){delete this.conversionApi.writer,delete this.conversionApi.consumable}_convertInsertWithAttributes(t){this._testAndFire("insert",t);for(const e of t.item.getAttributeKeys())t.attributeKey=e,t.attributeOldValue=null,t.attributeNewValue=t.item.getAttribute(e),this._testAndFire("attribute:"+e,t)}_mapChangesWithAutomaticReconversion(t){const e=new Set,i=[];for(const n of t.getChanges()){const t=n.position||n.range.start,o=t.parent;if(zr(t,o)){i.push(n);continue}const r="attribute"===n.type?Fr(t,o,null):o;if(r.is("$text")){i.push(n);continue}let s;if(s="attribute"===n.type?`attribute:${n.attributeKey}:${r.name}`:`${n.type}:${n.name}`,this._isReconvertTriggerEvent(s,r.name)){if(e.has(r))continue;e.add(r),i.push({type:"reconvert",element:r})}else i.push(n)}return i}_isReconvertTriggerEvent(t,e){return this._reconversionEventsMapping.get(t)===e}}function qr(t,e,i){const n=e.getRange(),o=Array.from(t.getAncestors());return o.shift(),o.reverse(),!o.some(t=>{if(n.containsItem(t))return!!i.toViewElement(t).getCustomProperty("addHighlight")})}function Ur(t){return{item:t.item,range:Br._createFromPositionAndShift(t.previousPosition,t.length)}}function Yr(t,e){if(t.is("textProxy")){const i=e.toViewPosition(Rr._createBefore(t)).parent;return i.is("$text")?i:null}return e.toViewElement(t)}Pt(Wr,h);class Gr{constructor(t,e,i){this._lastRangeBackward=!1,this._ranges=[],this._attrs=new Map,t&&this.setTo(t,e,i)}get anchor(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.end:t.start}return null}get focus(){if(this._ranges.length>0){const t=this._ranges[this._ranges.length-1];return this._lastRangeBackward?t.start:t.end}return null}get isCollapsed(){return 1===this._ranges.length&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(t){if(this.rangeCount!=t.rangeCount)return!1;if(0===this.rangeCount)return!0;if(!this.anchor.isEqual(t.anchor)||!this.focus.isEqual(t.focus))return!1;for(const e of this._ranges){let i=!1;for(const n of t._ranges)if(e.isEqual(n)){i=!0;break}if(!i)return!1}return!0}*getRanges(){for(const t of this._ranges)yield new Br(t.start,t.end)}getFirstRange(){let t=null;for(const e of this._ranges)t&&!e.start.isBefore(t.start)||(t=e);return t?new Br(t.start,t.end):null}getLastRange(){let t=null;for(const e of this._ranges)t&&!e.end.isAfter(t.end)||(t=e);return t?new Br(t.start,t.end):null}getFirstPosition(){const t=this.getFirstRange();return t?t.start.clone():null}getLastPosition(){const t=this.getLastRange();return t?t.end.clone():null}setTo(t,e,i){if(null===t)this._setRanges([]);else if(t instanceof Gr)this._setRanges(t.getRanges(),t.isBackward);else if(t&&"function"==typeof t.getRanges)this._setRanges(t.getRanges(),t.isBackward);else if(t instanceof Br)this._setRanges([t],!!e&&!!e.backward);else if(t instanceof Rr)this._setRanges([new Br(t)]);else if(t instanceof Ar){const n=!!i&&!!i.backward;let o;if("in"==e)o=Br._createIn(t);else if("on"==e)o=Br._createOn(t);else{if(void 0===e)throw new a.a("model-selection-setto-required-second-parameter",[this,t]);o=new Br(Rr._createAt(t,e))}this._setRanges([o],n)}else{if(!Xe(t))throw new a.a("model-selection-setto-not-selectable",[this,t]);this._setRanges(t,e&&!!e.backward)}}_setRanges(t,e=!1){const i=(t=Array.from(t)).some(e=>{if(!(e instanceof Br))throw new a.a("model-selection-set-ranges-not-range",[this,t]);return this._ranges.every(t=>!t.isEqual(e))});if(t.length!==this._ranges.length||i){this._removeAllRanges();for(const e of t)this._pushRange(e);this._lastRangeBackward=!!e,this.fire("change:range",{directChange:!0})}}setFocus(t,e){if(null===this.anchor)throw new a.a("model-selection-setfocus-no-ranges",[this,t]);const i=Rr._createAt(t,e);if("same"==i.compareWith(this.focus))return;const n=this.anchor;this._ranges.length&&this._popRange(),"before"==i.compareWith(n)?(this._pushRange(new Br(i,n)),this._lastRangeBackward=!0):(this._pushRange(new Br(n,i)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(t){return this._attrs.get(t)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(t){return this._attrs.has(t)}removeAttribute(t){this.hasAttribute(t)&&(this._attrs.delete(t),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}setAttribute(t,e){this.getAttribute(t)!==e&&(this._attrs.set(t,e),this.fire("change:attribute",{attributeKeys:[t],directChange:!0}))}getSelectedElement(){return 1!==this.rangeCount?null:this.getFirstRange().getContainedElement()}is(t){return"selection"===t||"model:selection"===t}*getSelectedBlocks(){const t=new WeakSet;for(const e of this.getRanges()){const i=Xr(e.start,t);i&&Kr(i,e)&&(yield i);for(const o of e.getWalker()){const i=o.item;"elementEnd"==o.type&&$r(i,t,e)&&(yield i)}const n=Xr(e.end,t);n&&!e.end.isTouching(Rr._createAt(n,0))&&Kr(n,e)&&(yield n)}}containsEntireContent(t=this.anchor.root){const e=Rr._createAt(t,0),i=Rr._createAt(t,"end");return e.isTouching(this.getFirstPosition())&&i.isTouching(this.getLastPosition())}_pushRange(t){this._checkRange(t),this._ranges.push(new Br(t.start,t.end))}_checkRange(t){for(let e=0;e<this._ranges.length;e++)if(t.isIntersecting(this._ranges[e]))throw new a.a("model-selection-range-intersects",[this,t],{addedRange:t,intersectingRange:this._ranges[e]})}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}function Zr(t,e){return!e.has(t)&&(e.add(t),t.root.document.model.schema.isBlock(t)&&t.parent)}function $r(t,e,i){return Zr(t,e)&&Kr(t,i)}function Xr(t,e){const i=t.parent.root.document.model.schema,n=t.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const r=n.find(t=>!o&&(o=i.isLimit(t),!o&&Zr(t,e)));return n.forEach(t=>e.add(t)),r}function Kr(t,e){const i=function(t){const e=t.root.document.model.schema;let i=t.parent;for(;i;){if(e.isBlock(i))return i;i=i.parent}}(t);return!i||!e.containsRange(Br._createOn(i),!0)}Pt(Gr,h);class Qr extends Br{constructor(t,e){super(t,e),Jr.call(this)}detach(){this.stopListening()}is(t){return"liveRange"===t||"model:liveRange"===t||"range"==t||"model:range"===t}toRange(){return new Br(this.start,this.end)}static fromRange(t){return new Qr(t.start,t.end)}}function Jr(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const i=e[0];i.isDocumentOperation&&ts.call(this,i)},{priority:"low"})}function ts(t){const e=this.getTransformedByOperation(t),i=Br._createFromRanges(e),n=!i.isEqual(this),o=function(t,e){switch(e.type){case"insert":return t.containsPosition(e.position);case"move":case"remove":case"reinsert":case"merge":return t.containsPosition(e.sourcePosition)||t.start.isEqual(e.sourcePosition)||t.containsPosition(e.targetPosition);case"split":return t.containsPosition(e.splitPosition)||t.containsPosition(e.insertionPosition)}return!1}(this,t);let r=null;if(n){"$graveyard"==i.root.rootName&&(r="remove"==t.type?t.sourcePosition:t.deletionPosition);const e=this.toRange();this.start=i.start,this.end=i.end,this.fire("change:range",e,{deletionPosition:r})}else o&&this.fire("change:content",this.toRange(),{deletionPosition:r})}Pt(Qr,h);class es{constructor(t){this._selection=new is(t),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(t){return this._selection.containsEntireContent(t)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(t){return this._selection.getAttribute(t)}hasAttribute(t){return this._selection.hasAttribute(t)}refresh(){this._selection._updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(t){this._selection.observeMarkers(t)}is(t){return"selection"===t||"model:selection"==t||"documentSelection"==t||"model:documentSelection"==t}_setFocus(t,e){this._selection.setFocus(t,e)}_setTo(t,e,i){this._selection.setTo(t,e,i)}_setAttribute(t,e){this._selection.setAttribute(t,e)}_removeAttribute(t){this._selection.removeAttribute(t)}_getStoredAttributes(){return this._selection._getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(t){this._selection.restoreGravity(t)}static _getStoreAttributeKey(t){return"selection:"+t}static _isStoreAttributeKey(t){return t.startsWith("selection:")}}Pt(es,h);class is extends Gr{constructor(t){super(),this.markers=new Ke({idProperty:"name"}),this._model=t.model,this._document=t,this._attributePriority=new Map,this._selectionRestorePosition=null,this._hasChangedRange=!1,this._overriddenGravityRegister=new Set,this._observedMarkers=new Set,this.listenTo(this._model,"applyOperation",(t,e)=>{const i=e[0];i.isDocumentOperation&&"marker"!=i.type&&"rename"!=i.type&&"noop"!=i.type&&(0==this._ranges.length&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{for(const t of this.getRanges())if(!this._document._validateSelectionRange(t))throw new a.a("document-selection-wrong-position",this,{range:t})}),this.listenTo(this._model.markers,"update",(t,e,i,n)=>{this._updateMarker(e,n)}),this.listenTo(this._document,"change",(t,e)=>{!function(t,e){const i=t.document.differ;for(const n of i.getChanges()){if("insert"!=n.type)continue;const i=n.position.parent;n.length===i.maxOffset&&t.enqueueChange(e,t=>{const e=Array.from(i.getAttributeKeys()).filter(t=>t.startsWith("selection:"));for(const n of e)t.removeAttribute(n,i)})}}(this._model,e)})}get isCollapsed(){return 0===this._ranges.length?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let t=0;t<this._ranges.length;t++)this._ranges[t].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(t,e,i){super.setTo(t,e,i),this._updateAttributes(!0),this._updateMarkers()}setFocus(t,e){super.setFocus(t,e),this._updateAttributes(!0),this._updateMarkers()}setAttribute(t,e){this._setAttribute(t,e)&&this.fire("change:attribute",{attributeKeys:[t],directChange:!0})}removeAttribute(t){this._removeAttribute(t)&&this.fire("change:attribute",{attributeKeys:[t],directChange:!0})}overrideGravity(){const t=r();return this._overriddenGravityRegister.add(t),1===this._overriddenGravityRegister.size&&this._updateAttributes(!0),t}restoreGravity(t){if(!this._overriddenGravityRegister.has(t))throw new a.a("document-selection-gravity-wrong-restore",this,{uid:t});this._overriddenGravityRegister.delete(t),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(t){this._observedMarkers.add(t),this._updateMarkers()}_popRange(){this._ranges.pop().detach()}_pushRange(t){const e=this._prepareRange(t);e&&this._ranges.push(e)}_prepareRange(t){if(this._checkRange(t),t.root==this._document.graveyard)return;const e=Qr.fromRange(t);return e.on("change:range",(t,i,n)=>{if(this._hasChangedRange=!0,e.root==this._document.graveyard){this._selectionRestorePosition=n.deletionPosition;const t=this._ranges.indexOf(e);this._ranges.splice(t,1),e.detach()}}),e}_updateMarkers(){if(!this._observedMarkers.size)return;const t=[];let e=!1;for(const n of this._model.markers){const e=n.name.split(":",1)[0];if(!this._observedMarkers.has(e))continue;const i=n.getRange();for(const o of this.getRanges())i.containsRange(o,!o.isCollapsed)&&t.push(n)}const i=Array.from(this.markers);for(const n of t)this.markers.has(n)||(this.markers.add(n),e=!0);for(const n of Array.from(this.markers))t.includes(n)||(this.markers.remove(n),e=!0);e&&this.fire("change:marker",{oldMarkers:i,directChange:!1})}_updateMarker(t,e){const i=t.name.split(":",1)[0];if(!this._observedMarkers.has(i))return;let n=!1;const o=Array.from(this.markers),r=this.markers.has(t);if(e){let i=!1;for(const t of this.getRanges())if(e.containsRange(t,!t.isCollapsed)){i=!0;break}i&&!r?(this.markers.add(t),n=!0):!i&&r&&(this.markers.remove(t),n=!0)}else r&&(this.markers.remove(t),n=!0);n&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(t){const e=hi(this._getSurroundingAttributes()),i=hi(this.getAttributes());if(t)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,r]of this._attributePriority)"low"==r&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(e);const n=[];for(const[o,r]of this.getAttributes())i.has(o)&&i.get(o)===r||n.push(o);for(const[o]of i)this.hasAttribute(o)||n.push(o);n.length>0&&this.fire("change:attribute",{attributeKeys:n,directChange:!1})}_setAttribute(t,e,i=!0){const n=i?"normal":"low";return("low"!=n||"normal"!=this._attributePriority.get(t))&&super.getAttribute(t)!==e&&(this._attrs.set(t,e),this._attributePriority.set(t,n),!0)}_removeAttribute(t,e=!0){const i=e?"normal":"low";return!("low"==i&&"normal"==this._attributePriority.get(t)||(this._attributePriority.set(t,i),!super.hasAttribute(t)||(this._attrs.delete(t),0)))}_setAttributesTo(t){const e=new Set;for(const[i,n]of this.getAttributes())t.get(i)!==n&&this._removeAttribute(i,!1);for(const[i,n]of t)this._setAttribute(i,n,!1)&&e.add(i);return e}*_getStoredAttributes(){const t=this.getFirstPosition().parent;if(this.isCollapsed&&t.isEmpty)for(const e of t.getAttributeKeys())if(e.startsWith("selection:")){const i=e.substr("selection:".length);yield[i,t.getAttribute(e)]}}_getSurroundingAttributes(){const t=this.getFirstPosition(),e=this._model.schema;let i=null;if(this.isCollapsed){const n=t.textNode?t.textNode:t.nodeBefore,o=t.textNode?t.textNode:t.nodeAfter;if(this.isGravityOverridden||(i=ns(n)),i||(i=ns(o)),!this.isGravityOverridden&&!i){let t=n;for(;t&&!e.isInline(t)&&!i;)t=t.previousSibling,i=ns(t)}if(!i){let t=o;for(;t&&!e.isInline(t)&&!i;)t=t.nextSibling,i=ns(t)}i||(i=this._getStoredAttributes())}else{const t=this.getFirstRange();for(const n of t){if(n.item.is("element")&&e.isObject(n.item))break;if("text"==n.type){i=n.item.getAttributes();break}}}return i}_fixGraveyardSelection(t){const e=this._model.schema.getNearestSelectionRange(t);e&&this._pushRange(e)}}function ns(t){return t instanceof Ir||t instanceof Or?t.getAttributes():null}class os{constructor(t){this._dispatchers=t}add(t){for(const e of this._dispatchers)t(e);return this}}var rs=function(t){return qe(t,5)};class ss extends os{elementToElement(t){return this.add(function(t){return(t=rs(t)).view=cs(t.view,"container"),e=>{var i;if(e.on("insert:"+t.model,(i=t.view,(t,e,n)=>{const o=i(e.item,n);if(!o)return;if(!n.consumable.consume(e.item,"insert"))return;const r=n.mapper.toViewPosition(e.range.start);n.mapper.bindElements(e.item,o),n.writer.insert(r,o)}),{priority:t.converterPriority||"normal"}),t.triggerBy){if(t.triggerBy.attributes)for(const i of t.triggerBy.attributes)e._mapReconversionTriggerEvent(t.model,`attribute:${i}:${t.model}`);if(t.triggerBy.children)for(const i of t.triggerBy.children)e._mapReconversionTriggerEvent(t.model,"insert:"+i),e._mapReconversionTriggerEvent(t.model,"remove:"+i)}}}(t))}attributeToElement(t){return this.add(function(t){let e="attribute:"+((t=rs(t)).model.key?t.model.key:t.model);if(t.model.name&&(e+=":"+t.model.name),t.model.values)for(const n of t.model.values)t.view[n]=cs(t.view[n],"attribute");else t.view=cs(t.view,"attribute");const i=hs(t);return n=>{n.on(e,function(t){return(e,i,n)=>{const o=t(i.attributeOldValue,n),r=t(i.attributeNewValue,n);if(!o&&!r)return;if(!n.consumable.consume(i.item,e.name))return;const s=n.writer;if(i.item instanceof Gr||i.item instanceof es)s.wrap(s.document.selection.getFirstRange(),r);else{let t=n.mapper.toViewRange(i.range);null!==i.attributeOldValue&&o&&(t=s.unwrap(t,o)),null!==i.attributeNewValue&&r&&s.wrap(t,r)}}}(i),{priority:t.converterPriority||"normal"})}}(t))}attributeToAttribute(t){return this.add(function(t){let e="attribute:"+((t=rs(t)).model.key?t.model.key:t.model);if(t.model.name&&(e+=":"+t.model.name),t.model.values)for(const n of t.model.values)t.view[n]=ds(t.view[n]);else t.view=ds(t.view);const i=hs(t);return n=>{var o;n.on(e,(o=i,(t,e,i)=>{const n=o(e.attributeOldValue,i),r=o(e.attributeNewValue,i);if(!n&&!r)return;if(!i.consumable.consume(e.item,t.name))return;const s=i.mapper.toViewElement(e.item),l=i.writer;if(!s)throw new a.a("conversion-attribute-to-attribute-on-text",[e,i]);if(null!==e.attributeOldValue&&n)if("class"==n.key){const t=Je(n.value);for(const e of t)l.removeClass(e,s)}else if("style"==n.key){const t=Object.keys(n.value);for(const e of t)l.removeStyle(e,s)}else l.removeAttribute(n.key,s);if(null!==e.attributeNewValue&&r)if("class"==r.key){const t=Je(r.value);for(const e of t)l.addClass(e,s)}else if("style"==r.key){const t=Object.keys(r.value);for(const e of t)l.setStyle(e,r.value[e],s)}else l.setAttribute(r.key,r.value,s)}),{priority:t.converterPriority||"normal"})}}(t))}markerToElement(t){return this.add(function(t){return(t=rs(t)).view=cs(t.view,"ui"),e=>{var i;e.on("addMarker:"+t.model,(i=t.view,(t,e,n)=>{e.isOpening=!0;const o=i(e,n);e.isOpening=!1;const r=i(e,n);if(!o||!r)return;const s=e.markerRange;if(s.isCollapsed&&!n.consumable.consume(s,t.name))return;for(const i of s)if(!n.consumable.consume(i.item,t.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(s.start),o),n.mapper.bindElementToMarker(o,e.markerName),s.isCollapsed||(l.insert(a.toViewPosition(s.end),r),n.mapper.bindElementToMarker(r,e.markerName)),t.stop()}),{priority:t.converterPriority||"normal"}),e.on("removeMarker:"+t.model,(t,e,i)=>{const n=i.mapper.markerNameToElements(e.markerName);if(n){for(const t of n)i.mapper.unbindElementFromMarkerName(t,e.markerName),i.writer.clear(i.writer.createRangeOn(t),t);i.writer.clearClonedElementsGroup(e.markerName),t.stop()}},{priority:t.converterPriority||"normal"})}}(t))}markerToHighlight(t){return this.add(function(t){return e=>{var i;e.on("addMarker:"+t.model,(i=t.view,(t,e,n)=>{if(!e.item)return;if(!(e.item instanceof Gr||e.item instanceof es||e.item.is("$textProxy")))return;const o=us(i,e,n);if(!o)return;if(!n.consumable.consume(e.item,t.name))return;const r=n.writer,s=as(r,o),a=r.document.selection;if(e.item instanceof Gr||e.item instanceof es)r.wrap(a.getFirstRange(),s,a);else{const t=n.mapper.toViewRange(e.range),i=r.wrap(t,s);for(const o of i.getItems())if(o.is("attributeElement")&&o.isSimilar(s)){n.mapper.bindElementToMarker(o,e.markerName);break}}}),{priority:t.converterPriority||"normal"}),e.on("addMarker:"+t.model,function(t){return(e,i,n)=>{if(!i.item)return;if(!(i.item instanceof Mr))return;const o=us(t,i,n);if(!o)return;if(!n.consumable.test(i.item,e.name))return;const r=n.mapper.toViewElement(i.item);if(r&&r.getCustomProperty("addHighlight")){n.consumable.consume(i.item,e.name);for(const t of Br._createIn(i.item))n.consumable.consume(t.item,e.name);r.getCustomProperty("addHighlight")(r,o,n.writer),n.mapper.bindElementToMarker(r,i.markerName)}}}(t.view),{priority:t.converterPriority||"normal"}),e.on("removeMarker:"+t.model,function(t){return(e,i,n)=>{if(i.markerRange.isCollapsed)return;const o=us(t,i,n);if(!o)return;const r=as(n.writer,o),s=n.mapper.markerNameToElements(i.markerName);if(s){for(const t of s)n.mapper.unbindElementFromMarkerName(t,i.markerName),t.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(t),r):t.getCustomProperty("removeHighlight")(t,o.id,n.writer);n.writer.clearClonedElementsGroup(i.markerName),e.stop()}}}(t.view),{priority:t.converterPriority||"normal"})}}(t))}markerToData(t){return this.add(function(t){const e=(t=rs(t)).model;return t.view||(t.view=i=>({group:e,name:i.substr(t.model.length+1)})),i=>{var n;i.on("addMarker:"+e,(n=t.view,(t,e,i)=>{const o=n(e.markerName,i);if(!o)return;const r=e.markerRange;i.consumable.consume(r,t.name)&&(ls(r,!1,i,e,o),ls(r,!0,i,e,o),t.stop())}),{priority:t.converterPriority||"normal"}),i.on("removeMarker:"+e,function(t){return(e,i,n)=>{const o=t(i.markerName,n);if(!o)return;const r=n.mapper.markerNameToElements(i.markerName);if(r){for(const t of r)n.mapper.unbindElementFromMarkerName(t,i.markerName),t.is("containerElement")?(s(`data-${o.group}-start-before`,t),s(`data-${o.group}-start-after`,t),s(`data-${o.group}-end-before`,t),s(`data-${o.group}-end-after`,t)):n.writer.clear(n.writer.createRangeOn(t),t);n.writer.clearClonedElementsGroup(i.markerName),e.stop()}function s(t,e){if(e.hasAttribute(t)){const i=new Set(e.getAttribute(t).split(","));i.delete(o.name),0==i.size?n.writer.removeAttribute(t,e):n.writer.setAttribute(t,Array.from(i).join(","),e)}}}}(t.view),{priority:t.converterPriority||"normal"})}}(t))}}function as(t,e){const i=t.createAttributeElement("span",e.attributes);return e.classes&&i._addClass(e.classes),"number"==typeof e.priority&&(i._priority=e.priority),i._id=e.id,i}function ls(t,e,i,n,o){const r=e?t.start:t.end,s=r.nodeAfter&&r.nodeAfter.is("element")?r.nodeAfter:null,a=r.nodeBefore&&r.nodeBefore.is("element")?r.nodeBefore:null;if(s||a){let t,r;e&&s||!e&&!a?(t=s,r=!0):(t=a,r=!1);const l=i.mapper.toViewElement(t);if(l)return void function(t,e,i,n,o,r){const s=`data-${r.group}-${e?"start":"end"}-${i?"before":"after"}`,a=t.hasAttribute(s)?t.getAttribute(s).split(","):[];a.unshift(r.name),n.writer.setAttribute(s,a.join(","),t),n.mapper.bindElementToMarker(t,o.markerName)}(l,e,r,i,n,o)}!function(t,e,i,n,o){const r=i.writer.createUIElement(`${o.group}-${e?"start":"end"}`,o.name?{name:o.name}:null);i.writer.insert(t,r),i.mapper.bindElementToMarker(r,n.markerName)}(i.mapper.toViewPosition(r),e,i,n,o)}function cs(t,e){return"function"==typeof t?t:(i,n)=>function(t,e,i){let n;"string"==typeof t&&(t={name:t});const o=e.writer,r=Object.assign({},t.attributes);if(n="container"==i?o.createContainerElement(t.name,r):"attribute"==i?o.createAttributeElement(t.name,r,{priority:t.priority||ln.DEFAULT_PRIORITY}):o.createUIElement(t.name,r),t.styles){const e=Object.keys(t.styles);for(const i of e)o.setStyle(i,t.styles[i],n)}if(t.classes){const e=t.classes;if("string"==typeof e)o.addClass(e,n);else for(const t of e)o.addClass(t,n)}return n}(t,n,e)}function hs(t){return t.model.values?(e,i)=>{const n=t.view[e];return n?n(e,i):null}:t.view}function ds(t){return"string"==typeof t?e=>({key:t,value:e}):"object"==typeof t?t.value?()=>t:e=>({key:t.key,value:e}):t}function us(t,e,i){const n="function"==typeof t?t(e,i):t;return n?(n.priority||(n.priority=10),n.id||(n.id=e.markerName),n):null}function fs(t){const{schema:e,document:i}=t.model;for(const n of i.getRootNames()){const o=i.getRoot(n);if(o.isEmpty&&!e.checkChild(o,"$text")&&e.checkChild(o,"paragraph"))return t.insertElement("paragraph",o),!0}return!1}function ps(t,e,i){const n=i.createContext(t);return!!i.checkChild(n,"paragraph")&&!!i.checkChild(n.push("paragraph"),e)}function gs(t,e){const i=e.createElement("paragraph");return e.insert(i,t),e.createPositionAt(i,0)}class ms extends os{elementToElement(t){return this.add(vs(t))}elementToAttribute(t){return this.add(function(t){ws(t=rs(t));const e=ks(t,!1),i=ys(t.view),n=i?"element:"+i:"element";return i=>{i.on(n,e,{priority:t.converterPriority||"low"})}}(t))}attributeToAttribute(t){return this.add(function(t){let e=null;("string"==typeof(t=rs(t)).view||t.view.key)&&(e=function(t){"string"==typeof t.view&&(t.view={key:t.view});const e=t.view.key;let i;return i="class"==e||"style"==e?{["class"==e?"classes":"styles"]:t.view.value}:{attributes:{[e]:void 0===t.view.value?/[\s\S]*/:t.view.value}},t.view.name&&(i.name=t.view.name),t.view=i,e}(t)),ws(t,e);const i=ks(t,!0);return e=>{e.on("element",i,{priority:t.converterPriority||"low"})}}(t))}elementToMarker(t){return this.add(function(t){return function(t){const e=t.model;t.model=(t,i)=>{const n="string"==typeof e?e:e(t,i);return i.writer.createElement("$marker",{"data-name":n})}}(t=rs(t)),vs(t)}(t))}dataToMarker(t){return this.add(function(t){(t=rs(t)).model||(t.model=e=>e?t.view+":"+e:t.view);const e=bs(_s(t,"start")),i=bs(_s(t,"end"));return n=>{n.on("element:"+t.view+"-start",e,{priority:t.converterPriority||"normal"}),n.on("element:"+t.view+"-end",i,{priority:t.converterPriority||"normal"});const o=s.get("low"),r=s.get("highest"),a=s.get(t.converterPriority)/r;n.on("element",function(t){return(e,i,n)=>{const o="data-"+t.view;function r(e,o){for(const r of o){const o=t.model(r,n),s=n.writer.createElement("$marker",{"data-name":o});n.writer.insert(s,e),i.modelCursor=i.modelCursor.isEqual(e)?i.modelCursor.getShiftedBy(1):i.modelCursor._getTransformedByInsertion(e,1),i.modelRange=i.modelRange._getTransformedByInsertion(e,1)[0]}}(n.consumable.test(i.viewItem,{attributes:o+"-end-after"})||n.consumable.test(i.viewItem,{attributes:o+"-start-after"})||n.consumable.test(i.viewItem,{attributes:o+"-end-before"})||n.consumable.test(i.viewItem,{attributes:o+"-start-before"}))&&(i.modelRange||Object.assign(i,n.convertChildren(i.viewItem,i.modelCursor)),n.consumable.consume(i.viewItem,{attributes:o+"-end-after"})&&r(i.modelRange.end,i.viewItem.getAttribute(o+"-end-after").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-start-after"})&&r(i.modelRange.end,i.viewItem.getAttribute(o+"-start-after").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-end-before"})&&r(i.modelRange.start,i.viewItem.getAttribute(o+"-end-before").split(",")),n.consumable.consume(i.viewItem,{attributes:o+"-start-before"})&&r(i.modelRange.start,i.viewItem.getAttribute(o+"-start-before").split(",")))}}(t),{priority:o+a})}}(t))}}function vs(t){const e=bs(t=rs(t)),i=ys(t.view),n=i?"element:"+i:"element";return i=>{i.on(n,e,{priority:t.converterPriority||"normal"})}}function ys(t){return"string"==typeof t?t:"object"==typeof t&&"string"==typeof t.name?t.name:null}function bs(t){const e=new di(t.view);return(i,n,o)=>{const r=e.match(n.viewItem);if(!r)return;const s=r.match;if(s.name=!0,!o.consumable.test(n.viewItem,s))return;const a=function(t,e,i){return t instanceof Function?t(e,i):i.writer.createElement(t)}(t.model,n.viewItem,o);a&&o.safeInsert(a,n.modelCursor)&&(o.consumable.consume(n.viewItem,s),o.convertChildren(n.viewItem,a),o.updateConversionResult(a,n))}}function ws(t,e=null){const i=null===e||(t=>t.getAttribute(e));t.model={key:"object"!=typeof t.model?t.model:t.model.key,value:"object"!=typeof t.model||void 0===t.model.value?i:t.model.value}}function ks(t,e){const i=new di(t.view);return(n,o,r)=>{const s=i.match(o.viewItem);if(!s)return;if(function(t,e){const i="function"==typeof t?t(e):t;return!("object"==typeof i&&!ys(i)||i.classes||i.attributes||i.styles)}(t.view,o.viewItem)?s.match.name=!0:delete s.match.name,!r.consumable.test(o.viewItem,s.match))return;const a=t.model.key,l="function"==typeof t.model.value?t.model.value(o.viewItem,r):t.model.value;null!==l&&(o.modelRange||Object.assign(o,r.convertChildren(o.viewItem,o.modelCursor)),function(t,e,i,n){let o=!1;for(const r of Array.from(t.getItems({shallow:i})))n.schema.checkAttribute(r,e.key)&&(o=!0,r.hasAttribute(e.key)||n.writer.setAttribute(e.key,e.value,r));return o}(o.modelRange,{key:a,value:l},e,r)&&r.consumable.consume(o.viewItem,s.match))}}function _s(t,e){const i={};return i.view=t.view+"-"+e,i.model=(e,i)=>{const n=e.getAttribute("name"),o=t.model(n,i);return i.writer.createElement("$marker",{"data-name":o})},i}class xs{constructor(t,e){this.model=t,this.view=new Sr(e),this.mapper=new jr,this.downcastDispatcher=new Wr({mapper:this.mapper,schema:t.schema});const i=this.model.document,n=i.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(i,"change",()=>{this.view.change(t=>{this.downcastDispatcher.convertChanges(i.differ,o,t),this.downcastDispatcher.convertSelection(n,o,t)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",function(t,e){return(i,n)=>{const o=n.newSelection,r=[];for(const t of o.getRanges())r.push(e.toModelRange(t));const s=t.createSelection(r,{backward:o.isBackward});s.isEqual(t.document.selection)||t.change(t=>{t.setSelection(s)})}}(this.model,this.mapper)),this.downcastDispatcher.on("insert:$text",(t,e,i)=>{if(!i.consumable.consume(e.item,"insert"))return;const n=i.writer,o=i.mapper.toViewPosition(e.range.start),r=n.createText(e.item.data);n.insert(o,r)},{priority:"lowest"}),this.downcastDispatcher.on("remove",(t,e,i)=>{const n=i.mapper.toViewPosition(e.position),o=e.position.getShiftedBy(e.length),r=i.mapper.toViewPosition(o,{isPhantom:!0}),s=i.writer.createRange(n,r),a=i.writer.remove(s.getTrimmed());for(const l of i.writer.createRangeIn(a).getItems())i.mapper.unbindViewElement(l)},{priority:"low"}),this.downcastDispatcher.on("selection",(t,e,i)=>{const n=i.writer,o=n.document.selection;for(const r of o.getRanges())r.isCollapsed&&r.end.parent.isAttached()&&i.writer.mergeAttributes(r.start);n.setSelection(null)},{priority:"high"}),this.downcastDispatcher.on("selection",(t,e,i)=>{const n=e.selection;if(n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const o=[];for(const r of n.getRanges()){const t=i.mapper.toViewRange(r);o.push(t)}i.writer.setSelection(o,{backward:n.isBackward})},{priority:"low"}),this.downcastDispatcher.on("selection",(t,e,i)=>{const n=e.selection;if(!n.isCollapsed)return;if(!i.consumable.consume(n,"selection"))return;const o=i.writer,r=n.getFirstPosition(),s=i.mapper.toViewPosition(r),a=o.breakAttributes(s);o.setSelection(a)},{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(t=>{if("$graveyard"==t.rootName)return null;const e=new Ui(this.view.document,t.name);return e.rootName=t.rootName,this.mapper.bindElements(t,e),e})}destroy(){this.view.destroy(),this.stopListening()}}Pt(xs,Et);class Cs{constructor(){this._commands=new Map}add(t,e){this._commands.set(t,e)}get(t){return this._commands.get(t)}execute(t,...e){const i=this.get(t);if(!i)throw new a.a("commandcollection-command-not-found",this,{commandName:t});return i.execute(...e)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class Es{constructor(){this._consumables=new Map}add(t,e){let i;t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):(this._consumables.has(t)?i=this._consumables.get(t):(i=new Ts(t),this._consumables.set(t,i)),i.add(e))}test(t,e){const i=this._consumables.get(t);return void 0===i?null:t.is("$text")||t.is("documentFragment")?i:i.test(e)}consume(t,e){return!!this.test(t,e)&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0)}revert(t,e){const i=this._consumables.get(t);void 0!==i&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):i.revert(e))}static consumablesFromElement(t){const e={element:t,name:!0,attributes:[],classes:[],styles:[]},i=t.getAttributeKeys();for(const r of i)"style"!=r&&"class"!=r&&e.attributes.push(r);const n=t.getClassNames();for(const r of n)e.classes.push(r);const o=t.getStyleNames();for(const r of o)e.styles.push(r);return e}static createFrom(t,e){if(e||(e=new Es(t)),t.is("$text"))return e.add(t),e;t.is("element")&&e.add(t,Es.consumablesFromElement(t)),t.is("documentFragment")&&e.add(t);for(const i of t.getChildren())e=Es.createFrom(i,e);return e}}class Ts{constructor(t){this.element=t,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(t){t.name&&(this._canConsumeName=!0);for(const e in this._consumables)e in t&&this._add(e,t[e])}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const e in this._consumables)if(e in t){const i=this._test(e,t[e]);if(!0!==i)return i}return!0}consume(t){t.name&&(this._canConsumeName=!1);for(const e in this._consumables)e in t&&this._consume(e,t[e])}revert(t){t.name&&(this._canConsumeName=!0);for(const e in this._consumables)e in t&&this._revert(e,t[e])}_add(t,e){const i=rt(e)?e:[e],n=this._consumables[t];for(const o of i){if("attributes"===t&&("class"===o||"style"===o))throw new a.a("viewconsumable-invalid-attribute",this);if(n.set(o,!0),"styles"===t)for(const t of this.element.document.stylesProcessor.getRelatedStyles(o))n.set(t,!0)}}_test(t,e){const i=rt(e)?e:[e],n=this._consumables[t];for(const o of i)if("attributes"!==t||"class"!==o&&"style"!==o){const t=n.get(o);if(void 0===t)return null;if(!t)return!1}else{const t="class"==o?"classes":"styles",e=this._test(t,[...this._consumables[t].keys()]);if(!0!==e)return e}return!0}_consume(t,e){const i=rt(e)?e:[e],n=this._consumables[t];for(const o of i)if("attributes"!==t||"class"!==o&&"style"!==o){if(n.set(o,!1),"styles"==t)for(const t of this.element.document.stylesProcessor.getRelatedStyles(o))n.set(t,!1)}else{const t="class"==o?"classes":"styles";this._consume(t,[...this._consumables[t].keys()])}}_revert(t,e){const i=rt(e)?e:[e],n=this._consumables[t];for(const o of i)if("attributes"!==t||"class"!==o&&"style"!==o)!1===n.get(o)&&n.set(o,!0);else{const t="class"==o?"classes":"styles";this._revert(t,[...this._consumables[t].keys()])}}}class Ss{constructor(){this._sourceDefinitions={},this._attributeProperties={},this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(t,e)=>{e[0]=new As(e[0])},{priority:"highest"}),this.on("checkChild",(t,e)=>{e[0]=new As(e[0]),e[1]=this.getDefinition(e[1])},{priority:"highest"})}register(t,e){if(this._sourceDefinitions[t])throw new a.a("schema-cannot-register-item-twice",this,{itemName:t});this._sourceDefinitions[t]=[Object.assign({},e)],this._clearCache()}extend(t,e){if(!this._sourceDefinitions[t])throw new a.a("schema-cannot-extend-missing-item",this,{itemName:t});this._sourceDefinitions[t].push(Object.assign({},e)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(t){let e;return e="string"==typeof t?t:t.is&&(t.is("$text")||t.is("$textProxy"))?"$text":t.name,this.getDefinitions()[e]}isRegistered(t){return!!this.getDefinition(t)}isBlock(t){const e=this.getDefinition(t);return!(!e||!e.isBlock)}isLimit(t){const e=this.getDefinition(t);return!(!e||!e.isLimit&&!e.isObject)}isObject(t){const e=this.getDefinition(t);return!!e&&!!(e.isObject||e.isLimit&&e.isSelectable&&e.isContent)}isInline(t){const e=this.getDefinition(t);return!(!e||!e.isInline)}isSelectable(t){const e=this.getDefinition(t);return!(!e||!e.isSelectable&&!e.isObject)}isContent(t){const e=this.getDefinition(t);return!(!e||!e.isContent&&!e.isObject)}checkChild(t,e){return!!e&&this._checkContextMatch(e,t)}checkAttribute(t,e){const i=this.getDefinition(t.last);return!!i&&i.allowAttributes.includes(e)}checkMerge(t,e=null){if(t instanceof Rr){const e=t.nodeBefore,i=t.nodeAfter;if(!(e instanceof Mr))throw new a.a("schema-check-merge-no-element-before",this);if(!(i instanceof Mr))throw new a.a("schema-check-merge-no-element-after",this);return this.checkMerge(e,i)}for(const i of e.getChildren())if(!this.checkChild(t,i))return!1;return!0}addChildCheck(t){this.on("checkChild",(e,[i,n])=>{if(!n)return;const o=t(i,n);"boolean"==typeof o&&(e.stop(),e.return=o)},{priority:"high"})}addAttributeCheck(t){this.on("checkAttribute",(e,[i,n])=>{const o=t(i,n);"boolean"==typeof o&&(e.stop(),e.return=o)},{priority:"high"})}setAttributeProperties(t,e){this._attributeProperties[t]=Object.assign(this.getAttributeProperties(t),e)}getAttributeProperties(t){return this._attributeProperties[t]||{}}getLimitElement(t){let e;for(e=t instanceof Rr?t.parent:(t instanceof Br?[t]:Array.from(t.getRanges())).reduce((t,e)=>{const i=e.getCommonAncestor();return t?t.getCommonAncestor(i,{includeSelf:!0}):i},null);!this.isLimit(e)&&e.parent;)e=e.parent;return e}checkAttributeInSelection(t,e){if(t.isCollapsed){const i=[...t.getFirstPosition().getAncestors(),new Or("",t.getAttributes())];return this.checkAttribute(i,e)}{const i=t.getRanges();for(const t of i)for(const i of t)if(this.checkAttribute(i.item,e))return!0}return!1}*getValidRanges(t,e){t=function*(t){for(const e of t)yield*e.getMinimalFlatRanges()}(t);for(const i of t)yield*this._getValidRangesForRange(i,e)}getNearestSelectionRange(t,e="both"){if(this.checkChild(t,"$text"))return new Br(t);let i,n;const o=t.getAncestors().reverse().find(t=>this.isLimit(t))||t.root;"both"!=e&&"backward"!=e||(i=new Dr({boundaries:Br._createIn(o),startPosition:t,direction:"backward"})),"both"!=e&&"forward"!=e||(n=new Dr({boundaries:Br._createIn(o),startPosition:t}));for(const r of function*(t,e){let i=!1;for(;!i;){if(i=!0,t){const e=t.next();e.done||(i=!1,yield{walker:t,value:e.value})}if(e){const t=e.next();t.done||(i=!1,yield{walker:e,value:t.value})}}}(i,n)){const t=r.value;if(t.type==(r.walker==i?"elementEnd":"elementStart")&&this.isObject(t.item))return Br._createOn(t.item);if(this.checkChild(t.nextPosition,"$text"))return new Br(t.nextPosition)}return null}findAllowedParent(t,e){let i=t.parent;for(;i;){if(this.checkChild(i,e))return i;if(this.isLimit(i))return null;i=i.parent}return null}removeDisallowedAttributes(t,e){for(const i of t)if(i.is("$text"))Vs(this,i,e);else{const t=Br._createIn(i).getPositions();for(const i of t)Vs(this,i.nodeBefore||i.parent,e)}}createContext(t){return new As(t)}_clearCache(){this._compiledDefinitions=null}_compile(){const t={},e=this._sourceDefinitions,i=Object.keys(e);for(const n of i)t[n]=Os(e[n],n);for(const n of i)Is(t,n);for(const n of i)Ps(t,n);for(const n of i)Ms(t,n);for(const n of i)Ds(t,n),Ns(t,n);for(const n of i)Rs(t,n),zs(t,n),Fs(t,n);this._compiledDefinitions=t}_checkContextMatch(t,e,i=e.length-1){const n=e.getItem(i);if(t.allowIn.includes(n.name)){if(0==i)return!0;{const t=this.getDefinition(n);return this._checkContextMatch(t,e,i-1)}}return!1}*_getValidRangesForRange(t,e){let i=t.start,n=t.start;for(const o of t.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(Br._createIn(o),e)),this.checkAttribute(o,e)||(i.isEqual(n)||(yield new Br(i,n)),i=Rr._createAfter(o)),n=Rr._createAfter(o);i.isEqual(n)||(yield new Br(i,n))}}Pt(Ss,Et);class As{constructor(t){if(t instanceof As)return t;"string"==typeof t?t=[t]:Array.isArray(t)||(t=t.getAncestors({includeSelf:!0})),this._items=t.map(js)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const e=new As([t]);return e._items=[...this._items,...e._items],e}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function Os(t,e){const i={name:e,allowIn:[],allowContentOf:[],allowWhere:[],allowAttributes:[],allowAttributesOf:[],allowChildren:[],inheritTypesFrom:[]};return function(t,e){for(const i of t){const t=Object.keys(i).filter(t=>t.startsWith("is"));for(const n of t)e[n]=i[n]}}(t,i),Ls(t,i,"allowIn"),Ls(t,i,"allowContentOf"),Ls(t,i,"allowWhere"),Ls(t,i,"allowAttributes"),Ls(t,i,"allowAttributesOf"),Ls(t,i,"allowChildren"),Ls(t,i,"inheritTypesFrom"),function(t,e){for(const i of t){const t=i.inheritAllFrom;t&&(e.allowContentOf.push(t),e.allowWhere.push(t),e.allowAttributesOf.push(t),e.inheritTypesFrom.push(t))}}(t,i),i}function Is(t,e){const i=t[e];for(const n of i.allowChildren){const i=t[n];i&&i.allowIn.push(e)}i.allowChildren.length=0}function Ps(t,e){for(const i of t[e].allowContentOf)t[i]&&Bs(t,i).forEach(t=>{t.allowIn.push(e)});delete t[e].allowContentOf}function Ms(t,e){for(const i of t[e].allowWhere){const n=t[i];n&&t[e].allowIn.push(...n.allowIn)}delete t[e].allowWhere}function Ds(t,e){for(const i of t[e].allowAttributesOf){const n=t[i];n&&t[e].allowAttributes.push(...n.allowAttributes)}delete t[e].allowAttributesOf}function Ns(t,e){const i=t[e];for(const n of i.inheritTypesFrom){const e=t[n];if(e){const t=Object.keys(e).filter(t=>t.startsWith("is"));for(const n of t)n in i||(i[n]=e[n])}}delete i.inheritTypesFrom}function Rs(t,e){const i=t[e],n=i.allowIn.filter(e=>t[e]);i.allowIn=Array.from(new Set(n))}function zs(t,e){const i=t[e];for(const n of i.allowIn)t[n].allowChildren.push(e)}function Fs(t,e){const i=t[e];i.allowAttributes=Array.from(new Set(i.allowAttributes))}function Ls(t,e,i){for(const n of t)"string"==typeof n[i]?e[i].push(n[i]):Array.isArray(n[i])&&e[i].push(...n[i])}function Bs(t,e){const i=t[e];return(n=t,Object.keys(n).map(t=>n[t])).filter(t=>t.allowIn.includes(i.name));var n}function js(t){return"string"==typeof t||t.is("documentFragment")?{name:"string"==typeof t?t:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:t.is("element")?t.name:"$text",*getAttributeKeys(){yield*t.getAttributeKeys()},getAttribute:e=>t.getAttribute(e)}}function Vs(t,e,i){for(const n of e.getAttributeKeys())t.checkAttribute(e,n)||i.removeAttribute(n,e)}class Hs{constructor(t={}){this._splitParts=new Map,this._cursorParents=new Map,this._modelCursor=null,this.conversionApi=Object.assign({},t),this.conversionApi.convertItem=this._convertItem.bind(this),this.conversionApi.convertChildren=this._convertChildren.bind(this),this.conversionApi.safeInsert=this._safeInsert.bind(this),this.conversionApi.updateConversionResult=this._updateConversionResult.bind(this),this.conversionApi.splitToAllowedParent=this._splitToAllowedParent.bind(this),this.conversionApi.getSplitParts=this._getSplitParts.bind(this)}convert(t,e,i=["$root"]){this.fire("viewCleanup",t),this._modelCursor=function(t,e){let i;for(const n of new As(t)){const t={};for(const e of n.getAttributeKeys())t[e]=n.getAttribute(e);const o=e.createElement(n.name,t);i&&e.append(o,i),i=Rr._createAt(o,0)}return i}(i,e),this.conversionApi.writer=e,this.conversionApi.consumable=Es.createFrom(t),this.conversionApi.store={};const{modelRange:n}=this._convertItem(t,this._modelCursor),o=e.createDocumentFragment();if(n){this._removeEmptyElements();for(const t of Array.from(this._modelCursor.parent.getChildren()))e.append(t,o);o.markers=function(t,e){const i=new Set,n=new Map,o=Br._createIn(t).getItems();for(const r of o)"$marker"==r.name&&i.add(r);for(const r of i){const t=r.getAttribute("data-name"),i=e.createPositionBefore(r);n.has(t)?n.get(t).end=i.clone():n.set(t,new Br(i.clone())),e.remove(r)}return n}(o,e)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(t,e){const i=Object.assign({viewItem:t,modelCursor:e,modelRange:null});if(t.is("element")?this.fire("element:"+t.name,i,this.conversionApi):t.is("$text")?this.fire("text",i,this.conversionApi):this.fire("documentFragment",i,this.conversionApi),i.modelRange&&!(i.modelRange instanceof Br))throw new a.a("view-conversion-dispatcher-incorrect-result",this);return{modelRange:i.modelRange,modelCursor:i.modelCursor}}_convertChildren(t,e){let i=e.is("position")?e:Rr._createAt(e,0);const n=new Br(i);for(const o of Array.from(t.getChildren())){const t=this._convertItem(o,i);t.modelRange instanceof Br&&(n.end=t.modelRange.end,i=t.modelCursor)}return{modelRange:n,modelCursor:i}}_safeInsert(t,e){const i=this._splitToAllowedParent(t,e);return!!i&&(this.conversionApi.writer.insert(t,i.position),!0)}_updateConversionResult(t,e){const i=this._getSplitParts(t),n=this.conversionApi.writer;e.modelRange||(e.modelRange=n.createRange(n.createPositionBefore(t),n.createPositionAfter(i[i.length-1])));const o=this._cursorParents.get(t);e.modelCursor=o?n.createPositionAt(o,0):e.modelRange.end}_splitToAllowedParent(t,e){const{schema:i,writer:n}=this.conversionApi;let o=i.findAllowedParent(e,t);if(o){if(o===e.parent)return{position:e};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return ps(e,t,i)?{position:gs(e,n)}:null;const r=this.conversionApi.writer.split(e,o),s=[];for(const l of r.range.getWalker())if("elementEnd"==l.type)s.push(l.item);else{const t=s.pop();this._registerSplitPair(t,l.item)}const a=r.range.end.parent;return this._cursorParents.set(t,a),{position:r.position,cursorParent:a}}_registerSplitPair(t,e){this._splitParts.has(t)||this._splitParts.set(t,[t]);const i=this._splitParts.get(t);this._splitParts.set(e,i),i.push(e)}_getSplitParts(t){let e;return e=this._splitParts.has(t)?this._splitParts.get(t):[t],e}_removeEmptyElements(){let t=!1;for(const e of this._splitParts.keys())e.isEmpty&&(this.conversionApi.writer.remove(e),this._splitParts.delete(e),t=!0);t&&this._removeEmptyElements()}}Pt(Hs,h);class Ws{getHtml(t){const e=document.implementation.createHTMLDocument("").createElement("div");return e.appendChild(t),e.innerHTML}}class qs{constructor(t){this.domParser=new DOMParser,this.domConverter=new mo(t,{renderingMode:"data"}),this.htmlWriter=new Ws}toData(t){const e=this.domConverter.viewToDom(t,document);return this.htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this.domConverter.domToView(e)}registerRawContentMatcher(t){this.domConverter.registerRawContentMatcher(t)}useFillerType(t){this.domConverter.blockFillerMode="marked"==t?"markedNbsp":"nbsp"}_toDom(t){const e=this.domParser.parseFromString(t,"text/html"),i=e.createDocumentFragment();let n=e.firstChild;for(;!n.isSameNode(e.documentElement);){const t=n;n=n.nextSibling,t.nodeType==Node.COMMENT_NODE&&i.appendChild(t)}const o=e.body.childNodes;for(;o.length>0;)i.appendChild(o[0]);return i}}class Us{constructor(t,e){this.model=t,this.mapper=new jr,this.downcastDispatcher=new Wr({mapper:this.mapper,schema:t.schema}),this.downcastDispatcher.on("insert:$text",(t,e,i)=>{if(!i.consumable.consume(e.item,"insert"))return;const n=i.writer,o=i.mapper.toViewPosition(e.range.start),r=n.createText(e.item.data);n.insert(o,r)},{priority:"lowest"}),this.upcastDispatcher=new Hs({schema:t.schema}),this.viewDocument=new an(e),this.stylesProcessor=e,this.htmlProcessor=new qs(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new Dn(this.viewDocument),this.upcastDispatcher.on("text",(t,e,{schema:i,consumable:n,writer:o})=>{let r=e.modelCursor;if(!n.test(e.viewItem))return;if(!i.checkChild(r,"$text")){if(!ps(r,"$text",i))return;r=gs(r,o)}n.consume(e.viewItem);const s=o.createText(e.viewItem.data);o.insert(s,r),e.modelRange=o.createRange(r,r.getShiftedBy(s.offsetSize)),e.modelCursor=e.modelRange.end},{priority:"lowest"}),this.upcastDispatcher.on("element",(t,e,i)=>{if(!e.modelRange&&i.consumable.consume(e.viewItem,{name:!0})){const{modelRange:t,modelCursor:n}=i.convertChildren(e.viewItem,e.modelCursor);e.modelRange=t,e.modelCursor=n}},{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",(t,e,i)=>{if(!e.modelRange&&i.consumable.consume(e.viewItem,{name:!0})){const{modelRange:t,modelCursor:n}=i.convertChildren(e.viewItem,e.modelCursor);e.modelRange=t,e.modelCursor=n}},{priority:"lowest"}),this.decorate("init"),this.decorate("set"),this.decorate("get"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange("transparent",fs)},{priority:"lowest"})}get(t={}){const{rootName:e="main",trim:i="empty"}=t;if(!this._checkIfRootsExists([e]))throw new a.a("datacontroller-get-non-existent-root",this);const n=this.model.document.getRoot(e);return"empty"!==i||this.model.hasContent(n,{ignoreWhitespaces:!0})?this.stringify(n,t):""}stringify(t,e={}){const i=this.toView(t,e);return this.processor.toData(i)}toView(t,e={}){const i=this.viewDocument,n=this._viewWriter;this.mapper.clearBindings();const o=Br._createIn(t),r=new Mn(i);this.mapper.bindElements(t,r),this.downcastDispatcher.conversionApi.options=e,this.downcastDispatcher.convertInsert(o,n);const s=t.is("documentFragment")?Array.from(t.markers):function(t){const e=[],i=t.root.document;if(!i)return[];const n=Br._createIn(t);for(const o of i.model.markers){const t=o.getRange(),i=t.isCollapsed,r=t.start.isEqual(n.start)||t.end.isEqual(n.end);if(i&&r)e.push([o.name,t]);else{const i=n.getIntersection(t);i&&e.push([o.name,i])}}return e.sort(([t,e],[i,n])=>{if("after"!==e.end.compareWith(n.start))return 1;if("before"!==e.start.compareWith(n.end))return-1;switch(e.start.compareWith(n.start)){case"before":return 1;case"after":return-1;default:switch(e.end.compareWith(n.end)){case"before":return 1;case"after":return-1;default:return i.localeCompare(t)}}})}(t);for(const[a,l]of s)this.downcastDispatcher.convertMarkerAdd(a,l,n);return delete this.downcastDispatcher.conversionApi.options,r}init(t){if(this.model.document.version)throw new a.a("datacontroller-init-document-not-empty",this);let e={};if("string"==typeof t?e.main=t:e=t,!this._checkIfRootsExists(Object.keys(e)))throw new a.a("datacontroller-init-non-existent-root",this);return this.model.enqueueChange("transparent",t=>{for(const i of Object.keys(e)){const n=this.model.document.getRoot(i);t.insert(this.parse(e[i],n),n,0)}}),Promise.resolve()}set(t,e={}){let i={};if("string"==typeof t?i.main=t:i=t,!this._checkIfRootsExists(Object.keys(i)))throw new a.a("datacontroller-set-non-existent-root",this);this.model.enqueueChange(e.batchType||"default",t=>{t.setSelection(null),t.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const e of Object.keys(i)){const n=this.model.document.getRoot(e);t.remove(t.createRangeIn(n)),t.insert(this.parse(i[e],n),n,0)}})}parse(t,e="$root"){const i=this.processor.toView(t);return this.toModel(i,e)}toModel(t,e="$root"){return this.model.change(i=>this.upcastDispatcher.convert(t,i,e))}addStyleProcessorRules(t){t(this.stylesProcessor)}registerRawContentMatcher(t){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(t),this.htmlProcessor.registerRawContentMatcher(t)}destroy(){this.stopListening()}_checkIfRootsExists(t){for(const e of t)if(!this.model.document.getRootNames().includes(e))return!1;return!0}}Pt(Us,Et);class Ys{constructor(t,e){this._helpers=new Map,this._downcast=Je(t),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Je(e),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,e){const i=this._downcast.includes(e);if(!this._upcast.includes(e)&&!i)throw new a.a("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:t,dispatchers:[e],isDowncast:i})}for(t){if(!this._helpers.has(t))throw new a.a("conversion-for-unknown-group",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:e,view:i}of Gs(t))this.for("upcast").elementToElement({model:e,view:i,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:e,view:i}of Gs(t))this.for("upcast").elementToAttribute({view:i,model:e,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:e,view:i}of Gs(t))this.for("upcast").attributeToAttribute({view:i,model:e})}_createConversionHelpers({name:t,dispatchers:e,isDowncast:i}){if(this._helpers.has(t))throw new a.a("conversion-group-exists",this);const n=i?new ss(e):new ms(e);this._helpers.set(t,n)}}function*Gs(t){if(t.model.values)for(const e of t.model.values){const i={key:t.model.key,value:e},n=t.view[e],o=t.upcastAlso?t.upcastAlso[e]:void 0;yield*Zs(i,n,o)}else yield*Zs(t.model,t.view,t.upcastAlso)}function*Zs(t,e,i){if(yield{model:t,view:e},i)for(const n of Je(i))yield{model:t,view:n}}class $s{constructor(t="default"){this.operations=[],this.type=t}get baseVersion(){for(const t of this.operations)if(null!==t.baseVersion)return t.baseVersion;return null}addOperation(t){return t.batch=this,this.operations.push(t),t}}class Xs{constructor(t){this.baseVersion=t,this.isDocumentOperation=null!==this.baseVersion,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t){return new this(t.baseVersion)}}class Ks{constructor(t){this.markers=new Map,this._children=new Pr,t&&this._insertChild(0,t)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return 0===this.childCount}get root(){return this}get parent(){return null}is(t){return"documentFragment"===t||"model:documentFragment"===t}getChild(t){return this._children.getNode(t)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(t){return this._children.getNodeIndex(t)}getChildStartOffset(t){return this._children.getNodeStartOffset(t)}getPath(){return[]}getNodeByPath(t){let e=this;for(const i of t)e=e.getChild(e.offsetToIndex(i));return e}offsetToIndex(t){return this._children.offsetToIndex(t)}toJSON(){const t=[];for(const e of this._children)t.push(e.toJSON());return t}static fromJSON(t){const e=[];for(const i of t)e.push(i.name?Mr.fromJSON(i):Or.fromJSON(i));return new Ks(e)}_appendChild(t){this._insertChild(this.childCount,t)}_insertChild(t,e){const i=function(t){return"string"==typeof t?[new Or(t)]:(Xe(t)||(t=[t]),Array.from(t).map(t=>"string"==typeof t?new Or(t):t instanceof Ir?new Or(t.data,t.getAttributes()):t))}(e);for(const n of i)null!==n.parent&&n._remove(),n.parent=this;this._children._insertNodes(t,i)}_removeChildren(t,e=1){const i=this._children._removeNodes(t,e);for(const n of i)n.parent=null;return i}}function Qs(t,e){const i=(e=ea(e)).reduce((t,e)=>t+e.offsetSize,0),n=t.parent;na(t);const o=t.index;return n._insertChild(o,e),ia(n,o+e.length),ia(n,o),new Br(t,t.getShiftedBy(i))}function Js(t){if(!t.isFlat)throw new a.a("operation-utils-remove-range-not-flat",this);const e=t.start.parent;na(t.start),na(t.end);const i=e._removeChildren(t.start.index,t.end.index-t.start.index);return ia(e,t.start.index),i}function ta(t,e){if(!t.isFlat)throw new a.a("operation-utils-move-range-not-flat",this);const i=Js(t);return Qs(e=e._getTransformedByDeletion(t.start,t.end.offset-t.start.offset),i)}function ea(t){const e=[];t instanceof Array||(t=[t]);for(let i=0;i<t.length;i++)if("string"==typeof t[i])e.push(new Or(t[i]));else if(t[i]instanceof Ir)e.push(new Or(t[i].data,t[i].getAttributes()));else if(t[i]instanceof Ks||t[i]instanceof Pr)for(const n of t[i])e.push(n);else t[i]instanceof Ar&&e.push(t[i]);for(let i=1;i<e.length;i++){const t=e[i],n=e[i-1];t instanceof Or&&n instanceof Or&&oa(t,n)&&(e.splice(i-1,2,new Or(n.data+t.data,n.getAttributes())),i--)}return e}function ia(t,e){const i=t.getChild(e-1),n=t.getChild(e);if(i&&n&&i.is("$text")&&n.is("$text")&&oa(i,n)){const o=new Or(i.data+n.data,i.getAttributes());t._removeChildren(e-1,2),t._insertChild(e-1,o)}}function na(t){const e=t.textNode,i=t.parent;if(e){const n=t.offset-e.startOffset,o=e.index;i._removeChildren(o,1);const r=new Or(e.data.substr(0,n),e.getAttributes()),s=new Or(e.data.substr(n),e.getAttributes());i._insertChild(o,[r,s])}}function oa(t,e){const i=t.getAttributes(),n=e.getAttributes();for(const o of i){if(o[1]!==e.getAttribute(o[0]))return!1;n.next()}return n.next().done}var ra=function(t,e){return Ro(t,e)};class sa extends Xs{constructor(t,e,i,n,o){super(o),this.range=t.clone(),this.key=e,this.oldValue=void 0===i?null:i,this.newValue=void 0===n?null:n}get type(){return null===this.oldValue?"addAttribute":null===this.newValue?"removeAttribute":"changeAttribute"}clone(){return new sa(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new sa(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const t=super.toJSON();return t.range=this.range.toJSON(),t}_validate(){if(!this.range.isFlat)throw new a.a("attribute-operation-range-not-flat",this);for(const t of this.range.getItems({shallow:!0})){if(null!==this.oldValue&&!ra(t.getAttribute(this.key),this.oldValue))throw new a.a("attribute-operation-wrong-old-value",this,{item:t,key:this.key,value:this.oldValue});if(null===this.oldValue&&null!==this.newValue&&t.hasAttribute(this.key))throw new a.a("attribute-operation-attribute-exists",this,{node:t,key:this.key})}}_execute(){ra(this.oldValue,this.newValue)||function(t,e,i){na(t.start),na(t.end);for(const n of t.getItems({shallow:!0})){const t=n.is("$textProxy")?n.textNode:n;null!==i?t._setAttribute(e,i):t._removeAttribute(e),ia(t.parent,t.index)}ia(t.end.parent,t.end.index)}(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(t,e){return new sa(Br.fromJSON(t.range,e),t.key,t.oldValue,t.newValue,t.baseVersion)}}class aa extends Xs{constructor(t,e){super(null),this.sourcePosition=t.clone(),this.howMany=e}get type(){return"detach"}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t}_validate(){if(this.sourcePosition.root.document)throw new a.a("detach-operation-on-document-node",this)}_execute(){Js(Br._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class la extends Xs{constructor(t,e,i,n){super(n),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toNext",this.howMany=e,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNone"}get type(){return"$graveyard"==this.targetPosition.root.rootName?"remove":"$graveyard"==this.sourcePosition.root.rootName?"reinsert":"move"}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const t=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new this.constructor(this.getMovedRangeStart(),this.howMany,t,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent,i=this.sourcePosition.offset,n=this.targetPosition.offset;if(i+this.howMany>t.maxOffset)throw new a.a("move-operation-nodes-do-not-exist",this);if(t===e&&i<n&&n<i+this.howMany)throw new a.a("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&"prefix"==ri(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())){const t=this.sourcePosition.path.length-1;if(this.targetPosition.path[t]>=i&&this.targetPosition.path[t]<i+this.howMany)throw new a.a("move-operation-node-into-itself",this)}}_execute(){ta(Br._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=this.sourcePosition.toJSON(),t.targetPosition=this.targetPosition.toJSON(),t}static get className(){return"MoveOperation"}static fromJSON(t,e){const i=Rr.fromJSON(t.sourcePosition,e),n=Rr.fromJSON(t.targetPosition,e);return new this(i,t.howMany,n,t.baseVersion)}}class ca extends Xs{constructor(t,e,i){super(i),this.position=t.clone(),this.position.stickiness="toNone",this.nodes=new Pr(ea(e)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}clone(){const t=new Pr([...this.nodes].map(t=>t._clone(!0))),e=new ca(this.position,t,this.baseVersion);return e.shouldReceiveAttributes=this.shouldReceiveAttributes,e}getReversed(){const t=new Rr(this.position.root.document.graveyard,[0]);return new la(this.position,this.nodes.maxOffset,t,this.baseVersion+1)}_validate(){const t=this.position.parent;if(!t||t.maxOffset<this.position.offset)throw new a.a("insert-operation-position-invalid",this)}_execute(){const t=this.nodes;this.nodes=new Pr([...t].map(t=>t._clone(!0))),Qs(this.position,t)}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t.nodes=this.nodes.toJSON(),t}static get className(){return"InsertOperation"}static fromJSON(t,e){const i=[];for(const o of t.nodes)i.push(o.name?Mr.fromJSON(o):Or.fromJSON(o));const n=new ca(Rr.fromJSON(t.position,e),i,t.baseVersion);return n.shouldReceiveAttributes=t.shouldReceiveAttributes,n}}class ha extends Xs{constructor(t,e,i,n,o,r){super(r),this.name=t,this.oldRange=e?e.clone():null,this.newRange=i?i.clone():null,this.affectsData=o,this._markers=n}get type(){return"marker"}clone(){return new ha(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new ha(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this._markers[this.newRange?"_set":"_remove"](this.name,this.newRange,!0,this.affectsData)}toJSON(){const t=super.toJSON();return this.oldRange&&(t.oldRange=this.oldRange.toJSON()),this.newRange&&(t.newRange=this.newRange.toJSON()),delete t._markers,t}static get className(){return"MarkerOperation"}static fromJSON(t,e){return new ha(t.name,t.oldRange?Br.fromJSON(t.oldRange,e):null,t.newRange?Br.fromJSON(t.newRange,e):null,e.model.markers,t.affectsData,t.baseVersion)}}class da extends Xs{constructor(t,e,i,n){super(n),this.position=t,this.position.stickiness="toNext",this.oldName=e,this.newName=i}get type(){return"rename"}clone(){return new da(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new da(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const t=this.position.nodeAfter;if(!(t instanceof Mr))throw new a.a("rename-operation-wrong-position",this);if(t.name!==this.oldName)throw new a.a("rename-operation-wrong-name",this)}_execute(){this.position.nodeAfter.name=this.newName}toJSON(){const t=super.toJSON();return t.position=this.position.toJSON(),t}static get className(){return"RenameOperation"}static fromJSON(t,e){return new da(Rr.fromJSON(t.position,e),t.oldName,t.newName,t.baseVersion)}}class ua extends Xs{constructor(t,e,i,n,o){super(o),this.root=t,this.key=e,this.oldValue=i,this.newValue=n}get type(){return null===this.oldValue?"addRootAttribute":null===this.newValue?"removeRootAttribute":"changeRootAttribute"}clone(){return new ua(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new ua(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new a.a("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(null!==this.oldValue&&this.root.getAttribute(this.key)!==this.oldValue)throw new a.a("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(null===this.oldValue&&null!==this.newValue&&this.root.hasAttribute(this.key))throw new a.a("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){null!==this.newValue?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const t=super.toJSON();return t.root=this.root.toJSON(),t}static get className(){return"RootAttributeOperation"}static fromJSON(t,e){if(!e.getRoot(t.root))throw new a.a("rootattribute-operation-fromjson-no-root",this,{rootName:t.root});return new ua(e.getRoot(t.root),t.key,t.oldValue,t.newValue,t.baseVersion)}}class fa extends Xs{constructor(t,e,i,n,o){super(o),this.sourcePosition=t.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=e,this.targetPosition=i.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=n.clone()}get type(){return"merge"}get deletionPosition(){return new Rr(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const t=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Br(this.sourcePosition,t)}clone(){return new this.constructor(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=this.targetPosition._getTransformedByMergeOperation(this),e=this.sourcePosition.path.slice(0,-1),i=new Rr(this.sourcePosition.root,e)._getTransformedByMergeOperation(this);return new pa(t,this.howMany,i,this.graveyardPosition,this.baseVersion+1)}_validate(){const t=this.sourcePosition.parent,e=this.targetPosition.parent;if(!t.parent)throw new a.a("merge-operation-source-position-invalid",this);if(!e.parent)throw new a.a("merge-operation-target-position-invalid",this);if(this.howMany!=t.maxOffset)throw new a.a("merge-operation-how-many-invalid",this)}_execute(){const t=this.sourcePosition.parent;ta(Br._createIn(t),this.targetPosition),ta(Br._createOn(t),this.graveyardPosition)}toJSON(){const t=super.toJSON();return t.sourcePosition=t.sourcePosition.toJSON(),t.targetPosition=t.targetPosition.toJSON(),t.graveyardPosition=t.graveyardPosition.toJSON(),t}static get className(){return"MergeOperation"}static fromJSON(t,e){const i=Rr.fromJSON(t.sourcePosition,e),n=Rr.fromJSON(t.targetPosition,e),o=Rr.fromJSON(t.graveyardPosition,e);return new this(i,t.howMany,n,o,t.baseVersion)}}class pa extends Xs{constructor(t,e,i,n,o){super(o),this.splitPosition=t.clone(),this.splitPosition.stickiness="toNext",this.howMany=e,this.insertionPosition=i,this.graveyardPosition=n?n.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const t=this.insertionPosition.path.slice();return t.push(0),new Rr(this.insertionPosition.root,t)}get movedRange(){const t=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new Br(this.splitPosition,t)}clone(){return new this.constructor(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const t=new Rr(this.splitPosition.root.document.graveyard,[0]);return new fa(this.moveTargetPosition,this.howMany,this.splitPosition,t,this.baseVersion+1)}_validate(){const t=this.splitPosition.parent;if(!t||t.maxOffset<this.splitPosition.offset)throw new a.a("split-operation-position-invalid",this);if(!t.parent)throw new a.a("split-operation-split-in-root",this);if(this.howMany!=t.maxOffset-this.splitPosition.offset)throw new a.a("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new a.a("split-operation-graveyard-position-invalid",this)}_execute(){const t=this.splitPosition.parent;if(this.graveyardPosition)ta(Br._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const e=t._clone();Qs(this.insertionPosition,e)}ta(new Br(Rr._createAt(t,this.splitPosition.offset),Rr._createAt(t,t.maxOffset)),this.moveTargetPosition)}toJSON(){const t=super.toJSON();return t.splitPosition=this.splitPosition.toJSON(),t.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(t.graveyardPosition=this.graveyardPosition.toJSON()),t}static get className(){return"SplitOperation"}static getInsertionPosition(t){const e=t.path.slice(0,-1);return e[e.length-1]++,new Rr(t.root,e,"toPrevious")}static fromJSON(t,e){const i=Rr.fromJSON(t.splitPosition,e),n=Rr.fromJSON(t.insertionPosition,e),o=t.graveyardPosition?Rr.fromJSON(t.graveyardPosition,e):null;return new this(i,t.howMany,n,o,t.baseVersion)}}class ga extends Mr{constructor(t,e,i="main"){super(e),this._document=t,this.rootName=i}get document(){return this._document}is(t,e){return e?e===this.name&&("rootElement"===t||"model:rootElement"===t||"element"===t||"model:element"===t):"rootElement"===t||"model:rootElement"===t||"element"===t||"model:element"===t||"node"===t||"model:node"===t}toJSON(){return this.rootName}}class ma{constructor(t,e){this.model=t,this.batch=e}createText(t,e){return new Or(t,e)}createElement(t,e){return new Mr(t,e)}createDocumentFragment(){return new Ks}cloneElement(t,e=!0){return t._clone(e)}insert(t,e,i=0){if(this._assertWriterUsedCorrectly(),t instanceof Or&&""==t.data)return;const n=Rr._createAt(e,i);if(t.parent){if(ka(t.root,n.root))return void this.move(Br._createOn(t),n);if(t.root.document)throw new a.a("model-writer-insert-forbidden-move",this);this.remove(t)}const o=new ca(n,t,n.root.document?n.root.document.version:null);if(t instanceof Or&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),t instanceof Ks)for(const[r,s]of t.markers){const t=Rr._createAt(s.root,0),e={range:new Br(s.start._getCombined(t,n),s.end._getCombined(t,n)),usingOperation:!0,affectsData:!0};this.model.markers.has(r)?this.updateMarker(r,e):this.addMarker(r,e)}}insertText(t,e,i,n){e instanceof Ks||e instanceof Mr||e instanceof Rr?this.insert(this.createText(t),e,i):this.insert(this.createText(t,e),i,n)}insertElement(t,e,i,n){e instanceof Ks||e instanceof Mr||e instanceof Rr?this.insert(this.createElement(t),e,i):this.insert(this.createElement(t,e),i,n)}append(t,e){this.insert(t,e,"end")}appendText(t,e,i){e instanceof Ks||e instanceof Mr?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),i,"end")}appendElement(t,e,i){e instanceof Ks||e instanceof Mr?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),i,"end")}setAttribute(t,e,i){if(this._assertWriterUsedCorrectly(),i instanceof Br){const n=i.getMinimalFlatRanges();for(const i of n)va(this,t,e,i)}else ya(this,t,e,i)}setAttributes(t,e){for(const[i,n]of hi(t))this.setAttribute(i,n,e)}removeAttribute(t,e){if(this._assertWriterUsedCorrectly(),e instanceof Br){const i=e.getMinimalFlatRanges();for(const e of i)va(this,t,null,e)}else ya(this,t,null,e)}clearAttributes(t){this._assertWriterUsedCorrectly();const e=t=>{for(const e of t.getAttributeKeys())this.removeAttribute(e,t)};if(t instanceof Br)for(const i of t.getItems())e(i);else e(t)}move(t,e,i){if(this._assertWriterUsedCorrectly(),!(t instanceof Br))throw new a.a("writer-move-invalid-range",this);if(!t.isFlat)throw new a.a("writer-move-range-not-flat",this);const n=Rr._createAt(e,i);if(n.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!ka(t.root,n.root))throw new a.a("writer-move-different-document",this);const o=new la(t.start,t.end.offset-t.start.offset,n,t.root.document?t.root.document.version:null);this.batch.addOperation(o),this.model.applyOperation(o)}remove(t){this._assertWriterUsedCorrectly();const e=(t instanceof Br?t:Br._createOn(t)).getMinimalFlatRanges().reverse();for(const i of e)this._addOperationForAffectedMarkers("move",i),wa(i.start,i.end.offset-i.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const e=t.nodeBefore,i=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(e instanceof Mr))throw new a.a("writer-merge-no-element-before",this);if(!(i instanceof Mr))throw new a.a("writer-merge-no-element-after",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,e,i){return this.model.createPositionFromPath(t,e,i)}createPositionAt(t,e){return this.model.createPositionAt(t,e)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,e){return this.model.createRange(t,e)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(t,e,i){return this.model.createSelection(t,e,i)}_mergeDetached(t){const e=t.nodeBefore,i=t.nodeAfter;this.move(Br._createIn(i),Rr._createAt(e,"end")),this.remove(i)}_merge(t){const e=Rr._createAt(t.nodeBefore,"end"),i=Rr._createAt(t.nodeAfter,0),n=new Rr(t.root.document.graveyard,[0]),o=new fa(i,t.nodeAfter.maxOffset,e,n,t.root.document.version);this.batch.addOperation(o),this.model.applyOperation(o)}rename(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof Mr))throw new a.a("writer-rename-not-element-instance",this);const i=t.root.document?t.root.document.version:null,n=new da(Rr._createBefore(t),t.name,e,i);this.batch.addOperation(n),this.model.applyOperation(n)}split(t,e){this._assertWriterUsedCorrectly();let i,n,o=t.parent;if(!o.parent)throw new a.a("writer-split-element-no-parent",this);if(e||(e=o.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new a.a("writer-split-invalid-limit-element",this);do{const e=o.root.document?o.root.document.version:null,r=o.maxOffset-t.offset,s=pa.getInsertionPosition(t),a=new pa(t,r,s,null,e);this.batch.addOperation(a),this.model.applyOperation(a),i||n||(i=o,n=t.parent.nextSibling),o=(t=this.createPositionAfter(t.parent)).parent}while(o!==e);return{position:t,range:new Br(Rr._createAt(i,"end"),Rr._createAt(n,0))}}wrap(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new a.a("writer-wrap-range-not-flat",this);const i=e instanceof Mr?e:new Mr(e);if(i.childCount>0)throw new a.a("writer-wrap-element-not-empty",this);if(null!==i.parent)throw new a.a("writer-wrap-element-attached",this);this.insert(i,t.start);const n=new Br(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(n,Rr._createAt(i,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),null===t.parent)throw new a.a("writer-unwrap-element-no-parent",this);this.move(Br._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,e){if(this._assertWriterUsedCorrectly(),!e||"boolean"!=typeof e.usingOperation)throw new a.a("writer-addmarker-no-usingoperation",this);const i=e.usingOperation,n=e.range,o=void 0!==e.affectsData&&e.affectsData;if(this.model.markers.has(t))throw new a.a("writer-addmarker-marker-exists",this);if(!n)throw new a.a("writer-addmarker-no-range",this);return i?(ba(this,t,null,n,o),this.model.markers.get(t)):this.model.markers._set(t,n,i,o)}updateMarker(t,e){this._assertWriterUsedCorrectly();const i="string"==typeof t?t:t.name,n=this.model.markers.get(i);if(!n)throw new a.a("writer-updatemarker-marker-not-exists",this);if(!e)return void this.model.markers._refresh(n);const o="boolean"==typeof e.usingOperation,r="boolean"==typeof e.affectsData,s=r?e.affectsData:n.affectsData;if(!o&&!e.range&&!r)throw new a.a("writer-updatemarker-wrong-options",this);const l=n.getRange(),c=e.range?e.range:l;o&&e.usingOperation!==n.managedUsingOperations?e.usingOperation?ba(this,i,null,c,s):(ba(this,i,l,null,s),this.model.markers._set(i,c,void 0,s)):n.managedUsingOperations?ba(this,i,l,c,s):this.model.markers._set(i,c,void 0,s)}removeMarker(t){this._assertWriterUsedCorrectly();const e="string"==typeof t?t:t.name;if(!this.model.markers.has(e))throw new a.a("writer-removemarker-no-marker",this);const i=this.model.markers.get(e);i.managedUsingOperations?ba(this,e,i.getRange(),null,i.affectsData):this.model.markers._remove(e)}setSelection(t,e,i){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(t,e,i)}setSelectionFocus(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}setSelectionAttribute(t,e){if(this._assertWriterUsedCorrectly(),"string"==typeof t)this._setSelectionAttribute(t,e);else for(const[i,n]of hi(t))this._setSelectionAttribute(i,n)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),"string"==typeof t)this._removeSelectionAttribute(t);else for(const e of t)this._removeSelectionAttribute(e)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,e){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const n=es._getStoreAttributeKey(t);this.setAttribute(n,e,i.anchor.parent)}i._setAttribute(t,e)}_removeSelectionAttribute(t){const e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){const i=es._getStoreAttributeKey(t);this.removeAttribute(i,e.anchor.parent)}e._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new a.a("writer-incorrect-use",this)}_addOperationForAffectedMarkers(t,e){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const n=i.getRange();let o=!1;if("move"===t)o=e.containsPosition(n.start)||e.start.isEqual(n.start)||e.containsPosition(n.end)||e.end.isEqual(n.end);else{const t=e.nodeAfter,i=n.end.parent==t&&0==n.end.offset,r=n.end.nodeAfter==t,s=n.start.nodeAfter==t;o=n.start.parent==e.nodeBefore&&n.start.isAtEnd||i||r||s}o&&this.updateMarker(i.name,{range:n})}}}function va(t,e,i,n){const o=t.model,r=o.document;let s,a,l,c=n.start;for(const d of n.getWalker({shallow:!0}))l=d.item.getAttribute(e),s&&a!=l&&(a!=i&&h(),c=s),s=d.nextPosition,a=l;function h(){const n=new Br(c,s),l=new sa(n,e,a,i,n.root.document?r.version:null);t.batch.addOperation(l),o.applyOperation(l)}s instanceof Rr&&s!=c&&a!=i&&h()}function ya(t,e,i,n){const o=t.model,r=o.document,s=n.getAttribute(e);let a,l;s!=i&&(n.root===n?l=new ua(n,e,s,i,n.document?r.version:null):(a=new Br(Rr._createBefore(n),t.createPositionAfter(n)),l=new sa(a,e,s,i,a.root.document?r.version:null)),t.batch.addOperation(l),o.applyOperation(l))}function ba(t,e,i,n,o){const r=t.model,s=new ha(e,i,n,r.markers,o,r.document.version);t.batch.addOperation(s),r.applyOperation(s)}function wa(t,e,i,n){let o;if(t.root.document){const i=n.document,r=new Rr(i.graveyard,[0]);o=new la(t,e,r,i.version)}else o=new aa(t,e);i.addOperation(o),n.applyOperation(o)}function ka(t,e){return t===e||t instanceof ga&&e instanceof ga}class _a{constructor(t){this._markerCollection=t,this._changesInElement=new Map,this._elementSnapshots=new Map,this._changedMarkers=new Map,this._changeCount=0,this._cachedChanges=null,this._cachedChangesWithGraveyard=null}get isEmpty(){return 0==this._changesInElement.size&&0==this._changedMarkers.size}refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize);const e=Br._createOn(t);for(const i of this._markerCollection.getMarkersIntersectingRange(e)){const t=i.getRange();this.bufferMarkerChange(i.name,t,t,i.affectsData)}this._cachedChanges=null}bufferOperation(t){switch(t.type){case"insert":if(this._isInInsertedElement(t.position.parent))return;this._markInsert(t.position.parent,t.position.offset,t.nodes.maxOffset);break;case"addAttribute":case"removeAttribute":case"changeAttribute":for(const e of t.range.getItems({shallow:!0}))this._isInInsertedElement(e.parent)||this._markAttribute(e);break;case"remove":case"move":case"reinsert":{if(t.sourcePosition.isEqual(t.targetPosition)||t.sourcePosition.getShiftedBy(t.howMany).isEqual(t.targetPosition))return;const e=this._isInInsertedElement(t.sourcePosition.parent),i=this._isInInsertedElement(t.targetPosition.parent);e||this._markRemove(t.sourcePosition.parent,t.sourcePosition.offset,t.howMany),i||this._markInsert(t.targetPosition.parent,t.getMovedRangeStart().offset,t.howMany);break}case"rename":{if(this._isInInsertedElement(t.position.parent))return;this._markRemove(t.position.parent,t.position.offset,1),this._markInsert(t.position.parent,t.position.offset,1);const e=Br._createFromPositionAndShift(t.position,1);for(const t of this._markerCollection.getMarkersIntersectingRange(e)){const e=t.getRange();this.bufferMarkerChange(t.name,e,e,t.affectsData)}break}case"split":{const e=t.splitPosition.parent;this._isInInsertedElement(e)||this._markRemove(e,t.splitPosition.offset,t.howMany),this._isInInsertedElement(t.insertionPosition.parent)||this._markInsert(t.insertionPosition.parent,t.insertionPosition.offset,1),t.graveyardPosition&&this._markRemove(t.graveyardPosition.parent,t.graveyardPosition.offset,1);break}case"merge":{const e=t.sourcePosition.parent;this._isInInsertedElement(e.parent)||this._markRemove(e.parent,e.startOffset,1),this._markInsert(t.graveyardPosition.parent,t.graveyardPosition.offset,1);const i=t.targetPosition.parent;this._isInInsertedElement(i)||this._markInsert(i,t.targetPosition.offset,e.maxOffset);break}}this._cachedChanges=null}bufferMarkerChange(t,e,i,n){const o=this._changedMarkers.get(t);o?(o.newRange=i,o.affectsData=n,null==o.oldRange&&null==o.newRange&&this._changedMarkers.delete(t)):this._changedMarkers.set(t,{oldRange:e,newRange:i,affectsData:n})}getMarkersToRemove(){const t=[];for(const[e,i]of this._changedMarkers)null!=i.oldRange&&t.push({name:e,range:i.oldRange});return t}getMarkersToAdd(){const t=[];for(const[e,i]of this._changedMarkers)null!=i.newRange&&t.push({name:e,range:i.newRange});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(t=>({name:t[0],data:{oldRange:t[1].oldRange,newRange:t[1].newRange}}))}hasDataChanges(){for(const[,t]of this._changedMarkers)if(t.affectsData)return!0;return this._changesInElement.size>0}getChanges(t={includeChangesInGraveyard:!1}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let e=[];for(const i of this._changesInElement.keys()){const t=this._changesInElement.get(i).sort((t,e)=>t.offset===e.offset?t.type!=e.type?"remove"==t.type?-1:1:0:t.offset<e.offset?-1:1),n=this._elementSnapshots.get(i),o=xa(i.getChildren()),r=Ca(n.length,t);let s=0,a=0;for(const l of r)if("i"===l)e.push(this._getInsertDiff(i,s,o[s].name)),s++;else if("r"===l)e.push(this._getRemoveDiff(i,s,n[a].name)),a++;else if("a"===l){const t=o[s].attributes,r=n[a].attributes;let l;if("$text"==o[s].name)l=new Br(Rr._createAt(i,s),Rr._createAt(i,s+1));else{const t=i.offsetToIndex(s);l=new Br(Rr._createAt(i,s),Rr._createAt(i.getChild(t),0))}e.push(...this._getAttributesDiff(l,r,t)),s++,a++}else s++,a++}e.sort((t,e)=>t.position.root!=e.position.root?t.position.root.rootName<e.position.root.rootName?-1:1:t.position.isEqual(e.position)?t.changeCount-e.changeCount:t.position.isBefore(e.position)?-1:1);for(let i=1,n=0;i<e.length;i++){const t=e[n],o=e[i],r="remove"==t.type&&"remove"==o.type&&"$text"==t.name&&"$text"==o.name&&t.position.isEqual(o.position),s="insert"==t.type&&"insert"==o.type&&"$text"==t.name&&"$text"==o.name&&t.position.parent==o.position.parent&&t.position.offset+t.length==o.position.offset,a="attribute"==t.type&&"attribute"==o.type&&t.position.parent==o.position.parent&&t.range.isFlat&&o.range.isFlat&&t.position.offset+t.length==o.position.offset&&t.attributeKey==o.attributeKey&&t.attributeOldValue==o.attributeOldValue&&t.attributeNewValue==o.attributeNewValue;r||s||a?(t.length++,a&&(t.range.end=t.range.end.getShiftedBy(1)),e[i]=null):n=i}e=e.filter(t=>t);for(const i of e)delete i.changeCount,"attribute"==i.type&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=e.slice(),this._cachedChanges=e.filter(Ea),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard:this._cachedChanges}reset(){this._changesInElement.clear(),this._elementSnapshots.clear(),this._changedMarkers.clear(),this._cachedChanges=null}_markInsert(t,e,i){const n={type:"insert",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,n)}_markRemove(t,e,i){const n={type:"remove",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,n),this._removeAllNestedChanges(t,e,i)}_markAttribute(t){const e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}_markChange(t,e){this._makeSnapshot(t);const i=this._getChangesForElement(t);this._handleChange(e,i),i.push(e);for(let n=0;n<i.length;n++)i[n].howMany<1&&(i.splice(n,1),n--)}_getChangesForElement(t){let e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}_makeSnapshot(t){this._elementSnapshots.has(t)||this._elementSnapshots.set(t,xa(t.getChildren()))}_handleChange(t,e){t.nodesToHandle=t.howMany;for(const i of e){const n=t.offset+t.howMany,o=i.offset+i.howMany;if("insert"==t.type&&("insert"==i.type&&(t.offset<=i.offset?i.offset+=t.howMany:t.offset<o&&(i.howMany+=t.nodesToHandle,t.nodesToHandle=0)),"remove"==i.type&&t.offset<i.offset&&(i.offset+=t.howMany),"attribute"==i.type))if(t.offset<=i.offset)i.offset+=t.howMany;else if(t.offset<o){const o=i.howMany;i.howMany=t.offset-i.offset,e.unshift({type:"attribute",offset:n,howMany:o-i.howMany,count:this._changeCount++})}if("remove"==t.type){if("insert"==i.type)if(n<=i.offset)i.offset-=t.howMany;else if(n<=o)if(t.offset<i.offset){const e=n-i.offset;i.offset=t.offset,i.howMany-=e,t.nodesToHandle-=e}else i.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=i.offset)t.nodesToHandle-=i.howMany,i.howMany=0;else if(t.offset<o){const e=o-t.offset;i.howMany-=e,t.nodesToHandle-=e}if("remove"==i.type&&(n<=i.offset?i.offset-=t.howMany:t.offset<i.offset&&(t.nodesToHandle+=i.howMany,i.howMany=0)),"attribute"==i.type)if(n<=i.offset)i.offset-=t.howMany;else if(t.offset<i.offset){const e=n-i.offset;i.offset=t.offset,i.howMany-=e}else if(t.offset<o)if(n<=o){const n=i.howMany;i.howMany=t.offset-i.offset,e.unshift({type:"attribute",offset:t.offset,howMany:n-i.howMany-t.nodesToHandle,count:this._changeCount++})}else i.howMany-=o-t.offset}if("attribute"==t.type){if("insert"==i.type)if(t.offset<i.offset&&n>i.offset){if(n>o){const t={type:"attribute",offset:o,howMany:n-o,count:this._changeCount++};this._handleChange(t,e),e.push(t)}t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=i.offset&&t.offset<o&&(n>o?(t.nodesToHandle=n-o,t.offset=o):t.nodesToHandle=0);if("remove"==i.type&&t.offset<i.offset&&n>i.offset){const o={type:"attribute",offset:i.offset,howMany:n-i.offset,count:this._changeCount++};this._handleChange(o,e),e.push(o),t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}"attribute"==i.type&&(t.offset>=i.offset&&n<=o?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=i.offset&&n>=o&&(i.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,e,i){return{type:"insert",position:Rr._createAt(t,e),name:i,length:1,changeCount:this._changeCount++}}_getRemoveDiff(t,e,i){return{type:"remove",position:Rr._createAt(t,e),name:i,length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,e,i){const n=[];i=new Map(i);for(const[o,r]of e){const e=i.has(o)?i.get(o):null;e!==r&&n.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:o,attributeOldValue:r,attributeNewValue:e,changeCount:this._changeCount++}),i.delete(o)}for(const[o,r]of i)n.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:r,changeCount:this._changeCount++});return n}_isInInsertedElement(t){const e=t.parent;if(!e)return!1;const i=this._changesInElement.get(e),n=t.startOffset;if(i)for(const o of i)if("insert"==o.type&&n>=o.offset&&n<o.offset+o.howMany)return!0;return this._isInInsertedElement(e)}_removeAllNestedChanges(t,e,i){const n=new Br(Rr._createAt(t,e),Rr._createAt(t,e+i));for(const o of n.getItems({shallow:!0}))o.is("element")&&(this._elementSnapshots.delete(o),this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}}function xa(t){const e=[];for(const i of t)if(i.is("$text"))for(let t=0;t<i.data.length;t++)e.push({name:"$text",attributes:new Map(i.getAttributes())});else e.push({name:i.name,attributes:new Map(i.getAttributes())});return e}function Ca(t,e){const i=[];let n=0,o=0;for(const r of e){if(r.offset>n){for(let t=0;t<r.offset-n;t++)i.push("e");o+=r.offset-n}if("insert"==r.type){for(let t=0;t<r.howMany;t++)i.push("i");n=r.offset+r.howMany}else if("remove"==r.type){for(let t=0;t<r.howMany;t++)i.push("r");n=r.offset,o+=r.howMany}else i.push(..."a".repeat(r.howMany).split("")),n=r.offset+r.howMany,o+=r.howMany}if(o<t)for(let r=0;r<t-o-n;r++)i.push("e");return i}function Ea(t){return!(t.position&&"$graveyard"==t.position.root.rootName||t.range&&"$graveyard"==t.range.root.rootName)}class Ta{constructor(){this._operations=[],this._undoPairs=new Map,this._undoneOperations=new Set}addOperation(t){this._operations.includes(t)||this._operations.push(t)}getOperations(t=Number.NEGATIVE_INFINITY,e=Number.POSITIVE_INFINITY){const i=[];for(const n of this._operations)n.baseVersion>=t&&n.baseVersion<e&&i.push(n);return i}getOperation(t){for(const e of this._operations)if(e.baseVersion==t)return e}setOperationAsUndone(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}}function Sa(t,e){return!!(i=t.charAt(e-1))&&1==i.length&&/[\ud800-\udbff]/.test(i)&&function(t){return!!t&&1==t.length&&/[\udc00-\udfff]/.test(t)}(t.charAt(e));var i}function Aa(t,e){return!!(i=t.charAt(e))&&1==i.length&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(i);var i}class Oa{constructor(t){this.model=t,this.version=0,this.history=new Ta(this),this.selection=new es(this),this.roots=new Ke({idProperty:"rootName"}),this.differ=new _a(t.markers),this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root","$graveyard"),this.listenTo(t,"applyOperation",(t,e)=>{const i=e[0];if(i.isDocumentOperation&&i.baseVersion!==this.version)throw new a.a("model-document-applyoperation-wrong-version",this,{operation:i})},{priority:"highest"}),this.listenTo(t,"applyOperation",(t,e)=>{const i=e[0];i.isDocumentOperation&&this.differ.bufferOperation(i)},{priority:"high"}),this.listenTo(t,"applyOperation",(t,e)=>{const i=e[0];i.isDocumentOperation&&(this.version++,this.history.addOperation(i))},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(t.markers,"update",(t,e,i,n)=>{this.differ.bufferMarkerChange(e.name,i,n,e.affectsData),null===i&&e.on("change",(t,i)=>{this.differ.bufferMarkerChange(e.name,i,e.getRange(),e.affectsData)})})}get graveyard(){return this.getRoot("$graveyard")}createRoot(t="$root",e="main"){if(this.roots.get(e))throw new a.a("model-document-createroot-name-exists",this,{name:e});const i=new ga(this,t,e);return this.roots.add(i),i}destroy(){this.selection.destroy(),this.stopListening()}getRoot(t="main"){return this.roots.get(t)}getRootNames(){return Array.from(this.roots,t=>t.rootName).filter(t=>"$graveyard"!=t)}registerPostFixer(t){this._postFixers.add(t)}toJSON(){const t=si(this);return t.selection="[engine.model.DocumentSelection]",t.model="[engine.model.Model]",t}_handleChangeBlock(t){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(t),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",t.batch):this.fire("change",t.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){for(const t of this.roots)if(t!==this.graveyard)return t;return this.graveyard}_getDefaultRange(){const t=this._getDefaultRoot(),e=this.model,i=e.schema,n=e.createPositionFromPath(t,[0]);return i.getNearestSelectionRange(n)||e.createRange(n)}_validateSelectionRange(t){return Ia(t.start)&&Ia(t.end)}_callPostFixers(t){let e=!1;do{for(const i of this._postFixers)if(this.selection.refresh(),e=i(t),e)break}while(e)}}function Ia(t){const e=t.textNode;if(e){const i=e.data,n=t.offset-e.startOffset;return!Sa(i,n)&&!Aa(i,n)}return!0}Pt(Oa,h);class Pa{constructor(){this._markers=new Map}[Symbol.iterator](){return this._markers.values()}has(t){return this._markers.has(t instanceof Ma?t.name:t)}get(t){return this._markers.get(t)||null}_set(t,e,i=!1,n=!1){const o=t instanceof Ma?t.name:t;if(o.includes(","))throw new a.a("markercollection-incorrect-marker-name",this);const r=this._markers.get(o);if(r){const t=r.getRange();let s=!1;return t.isEqual(e)||(r._attachLiveRange(Qr.fromRange(e)),s=!0),i!=r.managedUsingOperations&&(r._managedUsingOperations=i,s=!0),"boolean"==typeof n&&n!=r.affectsData&&(r._affectsData=n,s=!0),s&&this.fire("update:"+o,r,t,e),r}const s=Qr.fromRange(e),l=new Ma(o,s,i,n);return this._markers.set(o,l),this.fire("update:"+o,l,null,e),l}_remove(t){const e=t instanceof Ma?t.name:t,i=this._markers.get(e);return!!i&&(this._markers.delete(e),this.fire("update:"+e,i,i.getRange(),null),this._destroyMarker(i),!0)}_refresh(t){const e=t instanceof Ma?t.name:t,i=this._markers.get(e);if(!i)throw new a.a("markercollection-refresh-marker-not-exists",this);const n=i.getRange();this.fire("update:"+e,i,n,n,i.managedUsingOperations,i.affectsData)}*getMarkersAtPosition(t){for(const e of this)e.getRange().containsPosition(t)&&(yield e)}*getMarkersIntersectingRange(t){for(const e of this)null!==e.getRange().getIntersection(t)&&(yield e)}destroy(){for(const t of this._markers.values())this._destroyMarker(t);this._markers=null,this.stopListening()}*getMarkersGroup(t){for(const e of this._markers.values())e.name.startsWith(t+":")&&(yield e)}_destroyMarker(t){t.stopListening(),t._detachLiveRange()}}Pt(Pa,h);class Ma{constructor(t,e,i,n){this.name=t,this._liveRange=this._attachLiveRange(e),this._managedUsingOperations=i,this._affectsData=n}get managedUsingOperations(){if(!this._liveRange)throw new a.a("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new a.a("marker-destroyed",this);return this._affectsData}getStart(){if(!this._liveRange)throw new a.a("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new a.a("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new a.a("marker-destroyed",this);return this._liveRange.toRange()}is(t){return"marker"===t||"model:marker"===t}_attachLiveRange(t){return this._liveRange&&this._detachLiveRange(),t.delegate("change:range").to(this),t.delegate("change:content").to(this),this._liveRange=t,t}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}Pt(Ma,h);class Da extends Xs{get type(){return"noop"}clone(){return new Da(this.baseVersion)}getReversed(){return new Da(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}const Na={};Na[sa.className]=sa,Na[ca.className]=ca,Na[ha.className]=ha,Na[la.className]=la,Na[Da.className]=Da,Na[Xs.className]=Xs,Na[da.className]=da,Na[ua.className]=ua,Na[pa.className]=pa,Na[fa.className]=fa;class Ra extends Rr{constructor(t,e,i="toNone"){if(super(t,e,i),!this.root.is("rootElement"))throw new a.a("model-liveposition-root-not-rootelement",t);za.call(this)}detach(){this.stopListening()}is(t){return"livePosition"===t||"model:livePosition"===t||"position"==t||"model:position"===t}toPosition(){return new Rr(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}function za(){this.listenTo(this.root.document.model,"applyOperation",(t,e)=>{const i=e[0];i.isDocumentOperation&&Fa.call(this,i)},{priority:"low"})}function Fa(t){const e=this.getTransformedByOperation(t);if(!this.isEqual(e)){const t=this.toPosition();this.path=e.path,this.root=e.root,this.fire("change",t)}}Pt(Ra,h);class La{constructor(t,e,i){this.model=t,this.writer=e,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._documentFragment=e.createDocumentFragment(),this._documentFragmentPosition=e.createPositionAt(this._documentFragment,0),this._firstNode=null,this._lastNode=null,this._lastAutoParagraph=null,this._filterAttributesOf=[],this._affectedStart=null,this._affectedEnd=null}handleNodes(t){for(const e of Array.from(t))this._handleNode(e);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(t){const e=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(t);if(i.isAfter(e)){if(this._lastNode=t,this.position.parent!=t||!this.position.isAtEnd)throw new a.a("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this.nodeToSelect?Br._createOn(this.nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new Br(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t){if(this.schema.isObject(t))return void this._handleObject(t);let e=this._checkAndAutoParagraphToAllowedPosition(t);e||(e=this._checkAndSplitToAllowedPosition(t),e)?(this._appendToFragment(t),this._firstNode||(this._firstNode=t),this._lastNode=t):this._handleDisallowedNode(t)}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const t=Ra.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=t.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=t.toPosition(),t.detach()}_handleObject(t){this._checkAndSplitToAllowedPosition(t)?this._appendToFragment(t):this._tryAutoparagraphing(t)}_handleDisallowedNode(t){t.is("element")?this.handleNodes(t.getChildren()):this._tryAutoparagraphing(t)}_appendToFragment(t){if(!this.schema.checkChild(this.position,t))throw new a.a("insertcontent-wrong-position",this,{node:t,position:this.position});this.writer.insert(t,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(t.offsetSize),this.nodeToSelect=this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?t:null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=Ra.fromPosition(t,"toPrevious")),this._affectedEnd&&!this._affectedEnd.isBefore(t)||(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Ra.fromPosition(t,"toNext"))}_mergeOnLeft(){const t=this._firstNode;if(!(t instanceof Mr))return;if(!this._canMergeLeft(t))return;const e=Ra._createBefore(t);e.stickiness="toNext";const i=Ra.fromPosition(this.position,"toNext");this._affectedStart.isEqual(e)&&(this._affectedStart.detach(),this._affectedStart=Ra._createAt(e.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Ra._createAt(e.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_mergeOnRight(){const t=this._lastNode;if(!(t instanceof Mr))return;if(!this._canMergeRight(t))return;const e=Ra._createAfter(t);if(e.stickiness="toNext",!this.position.isEqual(e))throw new a.a("insertcontent-invalid-insertion-position",this);this.position=Rr._createAt(e.nodeBefore,"end");const i=Ra.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(e)&&(this._affectedEnd.detach(),this._affectedEnd=Ra._createAt(e.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Ra._createAt(e.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_canMergeLeft(t){const e=t.previousSibling;return e instanceof Mr&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(e,t)}_canMergeRight(t){const e=t.nextSibling;return e instanceof Mr&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(t,e)}_tryAutoparagraphing(t){const e=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,e)&&this.schema.checkChild(e,t)&&(e._appendChild(t),this._handleNode(e))}_checkAndAutoParagraphToAllowedPosition(t){if(this.schema.checkChild(this.position.parent,t))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",t))return!1;this._insertPartialFragment();const e=this.writer.createElement("paragraph");return this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0),!0}_checkAndSplitToAllowedPosition(t){const e=this._getAllowedIn(this.position.parent,t);if(!e)return!1;for(e!=this.position.parent&&this._insertPartialFragment();e!=this.position.parent;)if(this.position.isAtStart){const t=this.position.parent;this.position=this.writer.createPositionBefore(t),t.isEmpty&&t.parent===e&&this.writer.remove(t)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const t=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=t,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(t,e){return this.schema.checkChild(t,e)?t:this.schema.isLimit(t)?null:this._getAllowedIn(t.parent,e)}}function Ba(t,e,i){const n=e.parent,o=i.parent;return n!=o&&!t.isLimit(n)&&!t.isLimit(o)&&function(t,e,i){const n=new Br(t,e);for(const o of n.getWalker())if(i.isLimit(o.item))return!1;return!0}(e,i,t)}function ja(t,e,i){const n=t.createElement("paragraph");t.insert(n,e),Va(t,i,t.createPositionAt(n,0))}function Va(t,e,i){e instanceof es?t.setSelection(i):e.setTo(i)}function Ha(t,e){const{isForward:i,walker:n,unit:o,schema:r}=t,{type:s,item:a,nextPosition:l}=e;if("text"==s)return"word"===t.unit?function(t,e){let i=t.position.textNode;if(i){let n=t.position.offset-i.startOffset;for(;!qa(i.data,n,e)&&!Ua(i,n,e);){t.next();const o=e?t.position.nodeAfter:t.position.nodeBefore;if(o&&o.is("$text")){const n=o.data.charAt(e?0:o.data.length-1);' ,.?!:;"-()'.includes(n)||(t.next(),i=t.position.textNode)}n=t.position.offset-i.startOffset}}return t.position}(n,i):function(t,e){const i=t.position.textNode;if(i){const n=i.data;let o=t.position.offset-i.startOffset;for(;Sa(n,o)||"character"==e&&Aa(n,o);)t.next(),o=t.position.offset-i.startOffset}return t.position}(n,o);if(s==(i?"elementStart":"elementEnd")){if(r.isSelectable(a))return Rr._createAt(a,i?"after":"before");if(r.checkChild(l,"$text"))return l}else{if(r.isLimit(a))return void n.skip(()=>!0);if(r.checkChild(l,"$text"))return l}}function Wa(t,e){const i=Rr._createAt(t.root,e?"end":0);return e?new Br(t,i):new Br(i,t)}function qa(t,e,i){return' ,.?!:;"-()'.includes(t.charAt(e+(i?0:-1)))}function Ua(t,e,i){return e===(i?t.endOffset:0)}function Ya(t,e){const i=[];Array.from(t.getItems({direction:"backward"})).map(t=>e.createRangeOn(t)).filter(e=>(e.start.isAfter(t.start)||e.start.isEqual(t.start))&&(e.end.isBefore(t.end)||e.end.isEqual(t.end))).forEach(t=>{i.push(t.start.parent),e.remove(t)}),i.forEach(t=>{let i=t;for(;i.parent&&i.isEmpty;){const t=e.createRangeOn(i);i=i.parent,e.remove(t)}})}function Ga(t,e){return t.isCollapsed?function(t,e){const i=t.start,n=e.getNearestSelectionRange(i);if(!n){const t=i.getAncestors().reverse().find(t=>e.isObject(t));return t?Br._createOn(t):null}if(!n.isCollapsed)return n;const o=n.start;return i.isEqual(o)?null:new Br(o)}(t,e):function(t,e){const{start:i,end:n}=t,o=e.checkChild(i,"$text"),r=e.checkChild(n,"$text"),s=e.getLimitElement(i),a=e.getLimitElement(n);if(s===a){if(o&&r)return null;if(function(t,e,i){const n=t.nodeAfter&&!i.isLimit(t.nodeAfter)||i.checkChild(t,"$text"),o=e.nodeBefore&&!i.isLimit(e.nodeBefore)||i.checkChild(e,"$text");return n||o}(i,n,e)){const t=i.nodeAfter&&e.isSelectable(i.nodeAfter)?null:e.getNearestSelectionRange(i,"forward"),o=n.nodeBefore&&e.isSelectable(n.nodeBefore)?null:e.getNearestSelectionRange(n,"backward");return new Br(t?t.start:i,o?o.end:n)}}const l=s&&!s.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const t=i.nodeAfter&&n.nodeBefore&&i.nodeAfter.parent===n.nodeBefore.parent,o=l&&(!t||!$a(i.nodeAfter,e)),r=c&&(!t||!$a(n.nodeBefore,e));let h=i,d=n;return o&&(h=Rr._createBefore(Za(s,e))),r&&(d=Rr._createAfter(Za(a,e))),new Br(h,d)}return null}(t,e)}function Za(t,e){let i=t,n=i;for(;e.isLimit(n)&&n.parent;)i=n,n=n.parent;return i}function $a(t,e){return t&&e.isSelectable(t)}class Xa{constructor(){this.markers=new Pa,this.document=new Oa(this),this.schema=new Ss,this._pendingChanges=[],this._currentWriter=null,["insertContent","deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(t=>this.decorate(t)),this.on("applyOperation",(t,e)=>{e[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$block",{allowIn:"$root",isBlock:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((t,e)=>{if("$marker"===e.name)return!0}),function(t){t.document.registerPostFixer(e=>function(t,e){const i=e.document.selection,n=e.schema,o=[];let r=!1;for(const s of i.getRanges()){const t=Ga(s,n);t&&!t.isEqual(s)?(o.push(t),r=!0):o.push(s)}r&&t.setSelection(function(t){const e=[];e.push(t.shift());for(const i of t){const t=e.pop();if(i.isEqual(t))e.push(t);else if(i.isIntersecting(t)){const n=t.start.isAfter(i.start)?i.start:t.start,o=t.end.isAfter(i.end)?t.end:i.end,r=new Br(n,o);e.push(r)}else e.push(t),e.push(i)}return e}(o),{backward:i.isBackward})}(e,t))}(this),this.document.registerPostFixer(fs)}change(t){try{return 0===this._pendingChanges.length?(this._pendingChanges.push({batch:new $s,callback:t}),this._runPendingChanges()[0]):t(this._currentWriter)}catch(t){a.a.rethrowUnexpectedError(t,this)}}enqueueChange(t,e){try{"string"==typeof t?t=new $s(t):"function"==typeof t&&(e=t,t=new $s),this._pendingChanges.push({batch:t,callback:e}),1==this._pendingChanges.length&&this._runPendingChanges()}catch(t){a.a.rethrowUnexpectedError(t,this)}}applyOperation(t){t._execute()}insertContent(t,e,i){return function(t,e,i,n){return t.change(o=>{let r;r=i?i instanceof Gr||i instanceof es?i:o.createSelection(i,n):t.document.selection,r.isCollapsed||t.deleteContent(r,{doNotAutoparagraph:!0});const s=new La(t,o,r.anchor);let a;a=e.is("documentFragment")?e.getChildren():[e],s.handleNodes(a);const l=s.getSelectionRange();l&&(r instanceof es?o.setSelection(l):r.setTo(l));const c=s.getAffectedRange()||t.createRange(r.anchor);return s.destroy(),c})}(this,t,e,i)}deleteContent(t,e){!function(t,e,i={}){if(e.isCollapsed)return;const n=e.getFirstRange();if("$graveyard"==n.root.rootName)return;const o=t.schema;t.change(t=>{if(!i.doNotResetEntireContent&&function(t,e){const i=t.getLimitElement(e);if(!e.containsEntireContent(i))return!1;const n=e.getFirstRange();return n.start.parent!=n.end.parent&&t.checkChild(i,"paragraph")}(o,e))return void function(t,e){const i=t.model.schema.getLimitElement(e);t.remove(t.createRangeIn(i)),ja(t,t.createPositionAt(i,0),e)}(t,e);const[r,s]=function(t){const e=t.root.document.model,i=t.start;let n=t.end;if(e.hasContent(t,{ignoreMarkers:!0})){const i=function(t){const e=t.parent,i=e.root.document.model.schema,n=e.getAncestors({parentFirst:!0,includeSelf:!0});for(const o of n){if(i.isLimit(o))return null;if(i.isBlock(o))return o}}(n);if(i&&n.isTouching(e.createPositionAt(i,0))){const i=e.createSelection(t);e.modifySelection(i,{direction:"backward"});const o=i.getLastPosition(),r=e.createRange(o,n);e.hasContent(r,{ignoreMarkers:!0})||(n=o)}}return[Ra.fromPosition(i,"toPrevious"),Ra.fromPosition(n,"toNext")]}(n);r.isTouching(s)||t.remove(t.createRange(r,s)),i.leaveUnmerged||(function(t,e,i){const n=t.model;if(!Ba(t.model.schema,e,i))return;const[o,r]=function(t,e){const i=t.getAncestors(),n=e.getAncestors();let o=0;for(;i[o]&&i[o]==n[o];)o++;return[i[o],n[o]]}(e,i);o&&r&&(!n.hasContent(o,{ignoreMarkers:!0})&&n.hasContent(r,{ignoreMarkers:!0})?function t(e,i,n,o){const r=i.parent,s=n.parent;if(r!=o&&s!=o){for(i=e.createPositionAfter(r),(n=e.createPositionBefore(s)).isEqual(i)||e.insert(r,n);i.parent.isEmpty;){const t=i.parent;i=e.createPositionBefore(t),e.remove(t)}n=e.createPositionBefore(s),function(t,e){const i=e.nodeBefore,n=e.nodeAfter;i.name!=n.name&&t.rename(i,n.name),t.clearAttributes(i),t.setAttributes(Object.fromEntries(n.getAttributes()),i),t.merge(e)}(e,n),Ba(e.model.schema,i,n)&&t(e,i,n,o)}}(t,e,i,o.parent):function t(e,i,n,o){const r=i.parent,s=n.parent;if(r!=o&&s!=o){for(i=e.createPositionAfter(r),(n=e.createPositionBefore(s)).isEqual(i)||e.insert(s,i),e.merge(i);n.parent.isEmpty;){const t=n.parent;n=e.createPositionBefore(t),e.remove(t)}Ba(e.model.schema,i,n)&&t(e,i,n,o)}}(t,e,i,o.parent))}(t,r,s),o.removeDisallowedAttributes(r.parent.getChildren(),t)),Va(t,e,r),!i.doNotAutoparagraph&&function(t,e){const i=t.checkChild(e,"$text"),n=t.checkChild(e,"paragraph");return!i&&n}(o,r)&&ja(t,r,e),r.detach(),s.detach()})}(this,t,e)}modifySelection(t,e){!function(t,e,i={}){const n=t.schema,o="backward"!=i.direction,r=i.unit?i.unit:"character",s=new Dr({boundaries:Wa(e.focus,o),singleCharacters:!0,direction:o?"forward":"backward"}),a={walker:s,schema:n,isForward:o,unit:r};let l;for(;l=s.next();){if(l.done)return;const i=Ha(a,l.value);if(i)return void(e instanceof es?t.change(t=>{t.setSelectionFocus(i)}):e.setFocus(i))}}(this,t,e)}getSelectedContent(t){return function(t,e){return t.change(t=>{const i=t.createDocumentFragment(),n=e.getFirstRange();if(!n||n.isCollapsed)return i;const o=n.start.root,r=n.start.getCommonPath(n.end),s=o.getNodeByPath(r);let a;a=n.start.parent==n.end.parent?n:t.createRange(t.createPositionAt(s,n.start.path[r.length]),t.createPositionAt(s,n.end.path[r.length]+1));const l=a.end.offset-a.start.offset;for(const e of a.getItems({shallow:!0}))e.is("$textProxy")?t.appendText(e.data,e.getAttributes(),i):t.append(t.cloneElement(e,!0),i);if(a!=n){const e=n._getTransformedByMove(a.start,t.createPositionAt(i,0),l)[0],o=t.createRange(t.createPositionAt(i,0),e.start);Ya(t.createRange(e.end,t.createPositionAt(i,"end")),t),Ya(o,t)}return i})}(this,t)}hasContent(t,e={}){const i=t instanceof Mr?Br._createIn(t):t;if(i.isCollapsed)return!1;const{ignoreWhitespaces:n=!1,ignoreMarkers:o=!1}=e;if(!o)for(const r of this.markers.getMarkersIntersectingRange(i))if(r.affectsData)return!0;for(const r of i.getItems())if(this.schema.isContent(r)){if(!r.is("$textProxy"))return!0;if(!n)return!0;if(-1!==r.data.search(/\S/))return!0}return!1}createPositionFromPath(t,e,i){return new Rr(t,e,i)}createPositionAt(t,e){return Rr._createAt(t,e)}createPositionAfter(t){return Rr._createAfter(t)}createPositionBefore(t){return Rr._createBefore(t)}createRange(t,e){return new Br(t,e)}createRangeIn(t){return Br._createIn(t)}createRangeOn(t){return Br._createOn(t)}createSelection(t,e,i){return new Gr(t,e,i)}createBatch(t){return new $s(t)}createOperationFromJSON(t){return class{static fromJSON(t,e){return Na[t.__className].fromJSON(t,e)}}.fromJSON(t,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const t=[];for(this.fire("_beforeChanges");this._pendingChanges.length;){this._currentWriter=new ma(this,this._pendingChanges[0].batch);const e=this._pendingChanges[0].callback(this._currentWriter);t.push(e),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}return this.fire("_afterChanges"),t}}Pt(Xa,Et);class Ka extends gr{constructor(t){super(),this.editor=t}set(t,e,i={}){if("string"==typeof e){const t=e;e=(e,i)=>{this.editor.execute(t),i()}}super.set(t,e,i)}}class Qa{constructor(t={}){this._context=t.context||new ni({language:t.language}),this._context._addEditor(this,!t.context);const e=Array.from(this.constructor.builtinPlugins||[]);this.config=new Ge(t,this.constructor.defaultConfig),this.config.define("plugins",e),this.config.define(this._context._getEditorConfig()),this.plugins=new Qe(this,e,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this.commands=new Cs,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.set("isReadOnly",!1),this.model=new Xa;const i=new zi;this.data=new Us(this.model,i),this.editing=new xs(this.model,i),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new Ys([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new Ka(this),this.keystrokes.listenTo(this.editing.view.document)}initPlugins(){const t=this.config,e=t.get("plugins"),i=t.get("removePlugins")||[],n=t.get("extraPlugins")||[],o=t.get("substitutePlugins")||[];return this.plugins.init(e.concat(n),i,o)}destroy(){let t=Promise.resolve();return"initializing"==this.state&&(t=new Promise(t=>this.once("ready",t))),t.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(...t){try{return this.commands.execute(...t)}catch(t){a.a.rethrowUnexpectedError(t,this)}}focus(){this.editing.view.focus()}}Pt(Qa,Et);class Ja{constructor(t){this.editor=t,this._components=new Map}*names(){for(const t of this._components.values())yield t.originalName}add(t,e){this._components.set(tl(t),{callback:e,originalName:t})}create(t){if(!this.has(t))throw new a.a("componentfactory-item-missing",this,{name:t});return this._components.get(tl(t)).callback(this.editor.locale)}has(t){return this._components.has(tl(t))}}function tl(t){return String(t).toLowerCase()}class el{constructor(t){this.editor=t,this.componentFactory=new Ja(t),this.focusTracker=new pr,this.set("viewportOffset",this._readViewportOffsetFromConfig()),this._editableElementsMap=new Map,this.listenTo(t.editing.view.document,"layoutChanged",()=>this.update())}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy();for(const t of this._editableElementsMap.values())t.ckeditorInstance=null;this._editableElementsMap=new Map}setEditableElement(t,e){this._editableElementsMap.set(t,e),e.ckeditorInstance||(e.ckeditorInstance=this.editor)}getEditableElement(t="main"){return this._editableElementsMap.get(t)}getEditableElementsNames(){return this._editableElementsMap.keys()}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const t=this.editor,e=t.config.get("ui.viewportOffset");if(e)return e;const i=t.config.get("toolbar.viewportTopOffset");return i?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:i}):{top:0}}}Pt(el,Et);var il={setData(t){this.data.set(t)},getData(t){return this.data.get(t)}};class nl extends oi{static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new Ke({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(t){if("string"!=typeof t)throw new a.a("pendingactions-add-invalid-message",this);const e=Object.create(Et);return e.set("message",t),this._actions.add(e),this.hasAny=!0,e}remove(t){this._actions.remove(t),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var ol='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>';const rl={cancel:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',caption:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',check:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',cog:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',eraser:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',lowVision:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',image:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.91 10.54c.26-.23.64-.21.88.03l3.36 3.14 2.23-2.06a.64.64 0 0 1 .87 0l2.52 2.97V4.5H3.2v10.12l3.71-4.08zm10.27-7.51c.6 0 1.09.47 1.09 1.05v11.84c0 .59-.49 1.06-1.09 1.06H2.79c-.6 0-1.09-.47-1.09-1.06V4.08c0-.58.49-1.05 1.1-1.05h14.38zm-5.22 5.56a1.96 1.96 0 1 1 3.4-1.96 1.96 1.96 0 0 1-3.4 1.96z"/></svg>',alignBottom:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',alignMiddle:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',alignTop:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',alignLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',alignCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',alignRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',alignJustify:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',objectLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectCenter:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',objectRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectFullWidth:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',objectInline:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockLeft:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',objectBlockRight:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',objectSizeFull:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',objectSizeLarge:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M13 6H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5V8a.5.5 0 0 1 .5-.5h11z"/></svg>',objectSizeSmall:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M7 10H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4a.5.5 0 0 1 .5-.5h5z"/></svg>',objectSizeMedium:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M10 8H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2zm0 1.5a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6a.5.5 0 0 1 .5-.5h8z"/></svg>',pencil:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',pilcrow:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',quote:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',threeVerticalDots:ol};function sl({emitter:t,activator:e,callback:i,contextElements:n}){t.listenTo(document,"mousedown",(t,o)=>{if(!e())return;const r="function"==typeof o.composedPath?o.composedPath():[];for(const e of n)if(e.contains(o.target)||r.includes(e))return;i()})}function al(t){t.set("_isCssTransitionsDisabled",!1),t.disableCssTransitions=()=>{t._isCssTransitionsDisabled=!0},t.enableCssTransitions=()=>{t._isCssTransitionsDisabled=!1},t.extendTemplate({attributes:{class:[t.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}function ll({view:t}){t.listenTo(t.element,"submit",(e,i)=>{i.preventDefault(),t.fire("submit")},{useCapture:!0})}class cl extends Ke{constructor(t=[]){super(t,{idProperty:"viewUid"}),this.on("add",(t,e,i)=>{this._renderViewIntoCollectionParent(e,i)}),this.on("remove",(t,e)=>{e.element&&this._parentElement&&e.element.remove()}),this._parentElement=null}destroy(){this.map(t=>t.destroy())}setParent(t){this._parentElement=t;for(const e of this)this._renderViewIntoCollectionParent(e)}delegate(...t){if(!t.length||!t.every(t=>"string"==typeof t))throw new a.a("ui-viewcollection-delegate-wrong-events",this);return{to:e=>{for(const i of this)for(const n of t)i.delegate(n).to(e);this.on("add",(i,n)=>{for(const o of t)n.delegate(o).to(e)}),this.on("remove",(i,n)=>{for(const o of t)n.stopDelegating(o,e)})}}}_renderViewIntoCollectionParent(t,e){t.isRendered||t.render(),t.element&&this._parentElement&&this._parentElement.insertBefore(t.element,this._parentElement.children[e])}}i(17);class hl{constructor(t){this.element=null,this.isRendered=!1,this.locale=t,this.t=t&&t.t,this._viewCollections=new Ke,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(e,i)=>{i.locale=t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=dl.bind(this,this)}createCollection(t){const e=new cl(t);return this._viewCollections.add(e),e}registerChild(t){Xe(t)||(t=[t]);for(const e of t)this._unboundChildren.add(e)}deregisterChild(t){Xe(t)||(t=[t]);for(const e of t)this._unboundChildren.remove(e)}setTemplate(t){this.template=new dl(t)}extendTemplate(t){dl.extend(this.template,t)}render(){if(this.isRendered)throw new a.a("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(t=>t.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}Pt(hl,wo),Pt(hl,Et);class dl{constructor(t){Object.assign(this,kl(wl(t))),this._isRendered=!1,this._revertData=null}render(){const t=this._renderNode({intoFragment:!0});return this._isRendered=!0,t}apply(t){return this._revertData={children:[],bindings:[],attributes:{}},this._renderNode({node:t,isApplying:!0,revertData:this._revertData}),t}revert(t){if(!this._revertData)throw new a.a("ui-template-revert-not-applied",[this,t]);this._revertTemplateFromNode(t,this._revertData)}*getViews(){yield*function*t(e){if(e.children)for(const i of e.children)Tl(i)?yield i:Sl(i)&&(yield*t(i))}(this)}static bind(t,e){return{to:(i,n)=>new fl({eventNameOrFunction:i,attribute:i,observable:t,emitter:e,callback:n}),if:(i,n,o)=>new pl({observable:t,emitter:e,attribute:i,valueIfTrue:n,callback:o})}}static extend(t,e){if(t._isRendered)throw new a.a("template-extend-render",[this,t]);!function t(e,i){if(i.attributes&&(e.attributes||(e.attributes={}),Cl(e.attributes,i.attributes)),i.eventListeners&&(e.eventListeners||(e.eventListeners={}),Cl(e.eventListeners,i.eventListeners)),i.text&&e.text.push(...i.text),i.children&&i.children.length){if(e.children.length!=i.children.length)throw new a.a("ui-template-extend-children-mismatch",e);let n=0;for(const o of i.children)t(e.children[n++],o)}}(t,kl(wl(e)))}_renderNode(t){let e;if(e=t.node?this.tag&&this.text:this.tag?this.text:!this.text,e)throw new a.a("ui-template-wrong-syntax",this);return this.text?this._renderText(t):this._renderElement(t)}_renderElement(t){let e=t.node;return e||(e=t.node=document.createElementNS(this.ns||"http://www.w3.org/1999/xhtml",this.tag)),this._renderAttributes(t),this._renderElementChildren(t),this._setUpListeners(t),e}_renderText(t){let e=t.node;return e?t.revertData.text=e.textContent:e=t.node=document.createTextNode(""),gl(this.text)?this._bindToObservable({schema:this.text,updater:vl(e),data:t}):e.textContent=this.text.join(""),e}_renderAttributes(t){let e,i,n,o;if(!this.attributes)return;const r=t.node,s=t.revertData;for(e in this.attributes)if(n=r.getAttribute(e),i=this.attributes[e],s&&(s.attributes[e]=n),o=y(i[0])&&i[0].ns?i[0].ns:null,gl(i)){const a=o?i[0].value:i;s&&Ol(e)&&a.unshift(n),this._bindToObservable({schema:a,updater:yl(r,e,o),data:t})}else"style"==e&&"string"!=typeof i[0]?this._renderStyleAttribute(i[0],t):(s&&n&&Ol(e)&&i.unshift(n),i=i.map(t=>t&&t.value||t).reduce((t,e)=>t.concat(e),[]).reduce(xl,""),El(i)||r.setAttributeNS(o,e,i))}_renderStyleAttribute(t,e){const i=e.node;for(const n in t){const o=t[n];gl(o)?this._bindToObservable({schema:[o],updater:bl(i,n),data:e}):i.style[n]=o}}_renderElementChildren(t){const e=t.node,i=t.intoFragment?document.createDocumentFragment():e,n=t.isApplying;let o=0;for(const r of this.children)if(Al(r)){if(!n){r.setParent(e);for(const t of r)i.appendChild(t.element)}}else if(Tl(r))n||(r.isRendered||r.render(),i.appendChild(r.element));else if(oo(r))i.appendChild(r);else if(n){const e={children:[],bindings:[],attributes:{}};t.revertData.children.push(e),r._renderNode({node:i.childNodes[o++],isApplying:!0,revertData:e})}else i.appendChild(r.render());t.intoFragment&&e.appendChild(i)}_setUpListeners(t){if(this.eventListeners)for(const e in this.eventListeners){const i=this.eventListeners[e].map(i=>{const[n,o]=e.split("@");return i.activateDomEventListener(n,o,t)});t.revertData&&t.revertData.bindings.push(i)}}_bindToObservable({schema:t,updater:e,data:i}){const n=i.revertData;ml(t,e,i);const o=t.filter(t=>!El(t)).filter(t=>t.observable).map(n=>n.activateAttributeListener(t,e,i));n&&n.bindings.push(o)}_revertTemplateFromNode(t,e){for(const i of e.bindings)for(const t of i)t();if(e.text)t.textContent=e.text;else{for(const i in e.attributes){const n=e.attributes[i];null===n?t.removeAttribute(i):t.setAttribute(i,n)}for(let i=0;i<e.children.length;++i)this._revertTemplateFromNode(t.childNodes[i],e.children[i])}}}Pt(dl,h);class ul{constructor(t){Object.assign(this,t)}getValue(t){const e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}activateAttributeListener(t,e,i){const n=()=>ml(t,e,i);return this.emitter.listenTo(this.observable,"change:"+this.attribute,n),()=>{this.emitter.stopListening(this.observable,"change:"+this.attribute,n)}}}class fl extends ul{activateDomEventListener(t,e,i){const n=(t,i)=>{e&&!i.target.matches(e)||("function"==typeof this.eventNameOrFunction?this.eventNameOrFunction(i):this.observable.fire(this.eventNameOrFunction,i))};return this.emitter.listenTo(i.node,t,n),()=>{this.emitter.stopListening(i.node,t,n)}}}class pl extends ul{getValue(t){return!El(super.getValue(t))&&(this.valueIfTrue||!0)}}function gl(t){return!!t&&(t.value&&(t=t.value),Array.isArray(t)?t.some(gl):t instanceof ul)}function ml(t,e,{node:i}){let n=function(t,e){return t.map(t=>t instanceof ul?t.getValue(e):t)}(t,i);n=1==t.length&&t[0]instanceof pl?n[0]:n.reduce(xl,""),El(n)?e.remove():e.set(n)}function vl(t){return{set(e){t.textContent=e},remove(){t.textContent=""}}}function yl(t,e,i){return{set(n){t.setAttributeNS(i,e,n)},remove(){t.removeAttributeNS(i,e)}}}function bl(t,e){return{set(i){t.style[e]=i},remove(){t.style[e]=null}}}function wl(t){return Ue(t,t=>{if(t&&(t instanceof ul||Sl(t)||Tl(t)||Al(t)))return t})}function kl(t){if("string"==typeof t?t=function(t){return{text:[t]}}(t):t.text&&function(t){t.text=Je(t.text)}(t),t.on&&(t.eventListeners=function(t){for(const e in t)_l(t,e);return t}(t.on),delete t.on),!t.text){t.attributes&&function(t){for(const e in t)t[e].value&&(t[e].value=Je(t[e].value)),_l(t,e)}(t.attributes);const e=[];if(t.children)if(Al(t.children))e.push(t.children);else for(const i of t.children)Sl(i)||Tl(i)||oo(i)?e.push(i):e.push(new dl(i));t.children=e}return t}function _l(t,e){t[e]=Je(t[e])}function xl(t,e){return El(e)?t:El(t)?e:`${t} ${e}`}function Cl(t,e){for(const i in e)t[i]?t[i].push(...e[i]):t[i]=e[i]}function El(t){return!t&&0!==t}function Tl(t){return t instanceof hl}function Sl(t){return t instanceof dl}function Al(t){return t instanceof cl}function Ol(t){return"class"==t||"style"==t}class Il extends cl{constructor(t,e=[]){super(e),this.locale=t}attachToDom(){this._bodyCollectionContainer=new dl({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let t=document.querySelector(".ck-body-wrapper");t||(t=function(t,e,i={},n=[]){const o=i&&i.xmlns,r=o?t.createElementNS(o,e):t.createElement(e);for(const s in i)r.setAttribute(s,i[s]);!nr(n)&&Xe(n)||(n=[n]);for(let s of n)nr(s)&&(s=t.createTextNode(s)),r.appendChild(s);return r}(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(t)),t.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const t=document.querySelector(".ck-body-wrapper");t&&0==t.childElementCount&&t.remove()}}i(19);class Pl extends hl{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon"],viewBox:t.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const t=(new DOMParser).parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),e=t.getAttribute("viewBox");for(e&&(this.viewBox=e),this.element.innerHTML="";t.childNodes.length>0;)this.element.appendChild(t.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}}i(21);class Ml extends hl{constructor(t){super(t),this.set("text",""),this.set("position","s");const e=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip",e.to("position",t=>"ck-tooltip_"+t),e.if("text","ck-hidden",t=>!t.trim())]},children:[{tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:e.to("text")}]}]})}}i(23);class Dl extends hl{constructor(t){super(t);const e=this.bindTemplate,i=r();this.set("class"),this.set("labelStyle"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.tooltipView=this._createTooltipView(),this.labelView=this._createLabelView(i),this.iconView=new Pl,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this)),this.setTemplate({tag:"button",attributes:{class:["ck","ck-button",e.to("class"),e.if("isEnabled","ck-disabled",t=>!t),e.if("isVisible","ck-hidden",t=>!t),e.to("isOn",t=>t?"ck-on":"ck-off"),e.if("withText","ck-button_with-text"),e.if("withKeystroke","ck-button_with-keystroke")],type:e.to("type",t=>t||"button"),tabindex:e.to("tabindex"),"aria-labelledby":"ck-editor__aria-label_"+i,"aria-disabled":e.if("isEnabled",!0,t=>!t),"aria-pressed":e.to("isOn",t=>!!this.isToggleable&&String(t))},children:this.children,on:{mousedown:e.to(t=>{t.preventDefault()}),click:e.to(t=>{this.isEnabled?this.fire("execute"):t.preventDefault()})}})}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.tooltipView),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}_createTooltipView(){const t=new Ml;return t.bind("text").to(this,"_tooltipString"),t.bind("position").to(this,"tooltipPosition"),t}_createLabelView(t){const e=new hl;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:this.bindTemplate.to("labelStyle"),id:"ck-editor__aria-label_"+t},children:[{text:this.bindTemplate.to("label")}]}),e}_createKeystrokeView(){const t=new hl;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",t=>Tn(t))}]}),t}_getTooltipString(t,e,i){return t?"string"==typeof t?t:(i&&(i=Tn(i)),t instanceof Function?t(e,i):`${e}${i?` (${i})`:""}`):""}}i(25);class Nl extends Dl{constructor(t){super(t),this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const t=new hl;return t.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),t}}function Rl(t){return"string"==typeof t?{model:t,label:t,hasBorder:!1,view:{name:"span",styles:{color:t}}}:{model:t.color,label:t.label||t.color,hasBorder:void 0!==t.hasBorder&&t.hasBorder,view:{name:"span",styles:{color:""+t.color}}}}class zl extends Dl{constructor(t){super(t);const e=this.bindTemplate;this.set("color"),this.set("hasBorder"),this.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>',this.extendTemplate({attributes:{style:{backgroundColor:e.to("color")},class:["ck","ck-color-grid__tile",e.if("hasBorder","ck-color-table__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}class Fl{constructor(t){if(Object.assign(this,t),t.actions&&t.keystrokeHandler)for(const e in t.actions){let i=t.actions[e];"string"==typeof i&&(i=[i]);for(const n of i)t.keystrokeHandler.set(n,(t,i)=>{this[e](),i()})}}get first(){return this.focusables.find(Ll)||null}get last(){return this.focusables.filter(Ll).slice(-1)[0]||null}get next(){return this._getFocusableItem(1)}get previous(){return this._getFocusableItem(-1)}get current(){let t=null;return null===this.focusTracker.focusedElement?null:(this.focusables.find((e,i)=>{const n=e.element===this.focusTracker.focusedElement;return n&&(t=i),n}),t)}focusFirst(){this._focus(this.first)}focusLast(){this._focus(this.last)}focusNext(){this._focus(this.next)}focusPrevious(){this._focus(this.previous)}_focus(t){t&&t.focus()}_getFocusableItem(t){const e=this.current,i=this.focusables.length;if(!i)return null;if(null===e)return this[1===t?"first":"last"];let n=(e+i+t)%i;do{const e=this.focusables.get(n);if(Ll(e))return e;n=(n+i+t)%i}while(n!==e);return null}}function Ll(t){return!(!t.focus||"none"==co.window.getComputedStyle(t.element).display)}i(27);class Bl extends hl{constructor(t,e){super(t);const i=e&&e.colorDefinitions||[],n={};e&&e.columns&&(n.gridTemplateColumns=`repeat( ${e.columns}, 1fr)`),this.set("selectedColor"),this.items=this.createCollection(),this.focusTracker=new pr,this.keystrokes=new gr,this._focusCycler=new Fl({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowleft",focusNext:"arrowright"}}),this.items.on("add",(t,e)=>{e.isOn=e.color===this.selectedColor}),i.forEach(t=>{const e=new zl;e.set({color:t.color,label:t.label,tooltip:!0,hasBorder:t.options.hasBorder}),e.on("execute",()=>{this.fire("execute",{value:t.color,hasBorder:t.options.hasBorder,label:t.label})}),this.items.add(e)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:n}}),this.on("change:selectedColor",(t,e,i)=>{for(const n of this.items)n.isOn=n.color===i})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,e)=>{this.focusTracker.add(e.element)}),this.items.on("remove",(t,e)=>{this.focusTracker.remove(e.element)}),this.keystrokes.listenTo(this.element)}}var jl='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class Vl extends Dl{constructor(t){super(t),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const t=new Pl;return t.content=jl,t.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),t}}i(29);class Hl extends hl{constructor(t){super(t);const e=this.bindTemplate;this.set("class"),this.set("icon"),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke"),this.set("label"),this.set("tabindex",-1),this.set("tooltip"),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(),this.arrowView=this._createArrowView(),this.keystrokes=new gr,this.focusTracker=new pr,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",e.to("class"),e.if("isVisible","ck-hidden",t=>!t),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(t,e)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),e())}),this.keystrokes.set("arrowleft",(t,e)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),e())})}focus(){this.actionView.focus()}_createActionView(){const t=new Dl;return t.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),t.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),t.delegate("execute").to(this),t}_createArrowView(){const t=new Dl,e=t.bindTemplate;return t.icon=jl,t.extendTemplate({attributes:{class:"ck-splitbutton__arrow","aria-haspopup":!0,"aria-expanded":e.to("isOn",t=>String(t))}}),t.bind("isEnabled").to(this),t.delegate("execute").to(this,"open"),t}}class Wl extends hl{constructor(t){super(t);const e=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",e.to("position",t=>"ck-dropdown__panel_"+t),e.if("isVisible","ck-dropdown__panel-visible")]},children:this.children,on:{selectstart:e.to(t=>t.preventDefault())}})}focus(){this.children.length&&this.children.first.focus()}focusLast(){if(this.children.length){const t=this.children.last;"function"==typeof t.focusLast?t.focusLast():t.focus()}}}function ql({element:t,target:e,positions:i,limiter:n,fitInViewport:o,viewportOffsetConfig:r}){A(e)&&(e=e()),A(n)&&(n=n());const s=function(t){return t&&t.parentNode?t.offsetParent===co.document.body?null:t.offsetParent:null}(t),a=new ar(t);let l;const c={targetRect:new ar(e),elementRect:a,positionedElementAncestor:s};if(n||o){const t=n&&new ar(n).getVisible(),e=o&&function(t){t=Object.assign({top:0,bottom:0,left:0,right:0},t);const e=new ar(co.window);return e.top+=t.top,e.height-=t.top,e.bottom-=t.bottom,e.height-=t.bottom,e}(r);Object.assign(c,{limiterRect:t,viewportRect:e}),l=function(t,e){const{elementRect:i}=e,n=i.getArea(),o=t.map(t=>new Yl(t,e)).filter(t=>!!t.name);let r=0,s=null;for(const a of o){const{_limiterIntersectionArea:t,_viewportIntersectionArea:e}=a;if(t===n)return a;const i=e**2+t**2;i>r&&(r=i,s=a)}return s}(i,c)||new Yl(i[0],c)}else l=new Yl(i[0],c);return l}function Ul(t){const{scrollX:e,scrollY:i}=co.window;return t.clone().moveBy(e,i)}i(31);class Yl{constructor(t,e){const i=t(e.targetRect,e.elementRect,e.viewportRect);if(!i)return;const{left:n,top:o,name:r,config:s}=i;Object.assign(this,{name:r,config:s}),this._positioningFunctionCorrdinates={left:n,top:o},this._options=e}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get _limiterIntersectionArea(){const t=this._options.limiterRect;if(t){const e=this._options.viewportRect;if(!e)return t.getIntersectionArea(this._rect);{const i=t.getIntersection(e);if(i)return i.getIntersectionArea(this._rect)}}return 0}get _viewportIntersectionArea(){const t=this._options.viewportRect;return t?t.getIntersectionArea(this._rect):0}get _rect(){return this._cachedRect||(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCorrdinates.left,this._positioningFunctionCorrdinates.top)),this._cachedRect}get _absoluteRect(){return this._cachedAbsoluteRect||(this._cachedAbsoluteRect=Ul(this._rect),this._options.positionedElementAncestor&&function(t,e){const i=Ul(new ar(e)),n=rr(e);let o=0,r=0;o-=i.left,r-=i.top,o+=e.scrollLeft,r+=e.scrollTop,o-=n.left,r-=n.top,t.moveBy(o,r)}(this._cachedAbsoluteRect,this._options.positionedElementAncestor)),this._cachedAbsoluteRect}}class Gl extends hl{constructor(t,e,i){super(t);const n=this.bindTemplate;this.buttonView=e,this.panelView=i,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class"),this.set("id"),this.set("panelPosition","auto"),this.keystrokes=new gr,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",n.to("class"),n.if("isEnabled","ck-disabled",t=>!t)],id:n.to("id"),"aria-describedby":n.to("ariaDescribedById")},children:[e,i]}),e.extendTemplate({attributes:{class:["ck-dropdown__button"]}})}render(){super.render(),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.panelView.bind("isVisible").to(this,"isOpen"),this.on("change:isOpen",()=>{this.isOpen&&(this.panelView.position="auto"===this.panelPosition?Gl._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions}).name:this.panelPosition)}),this.keystrokes.listenTo(this.element);const t=(t,e)=>{this.isOpen&&(this.buttonView.focus(),this.isOpen=!1,e())};this.keystrokes.set("arrowdown",(t,e)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,e())}),this.keystrokes.set("arrowright",(t,e)=>{this.isOpen&&e()}),this.keystrokes.set("arrowleft",t),this.keystrokes.set("esc",t)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:t,north:e,southEast:i,southWest:n,northEast:o,northWest:r,southMiddleEast:s,southMiddleWest:a,northMiddleEast:l,northMiddleWest:c}=Gl.defaultPanelPositions;return"rtl"!==this.locale.uiLanguageDirection?[i,n,s,a,t,o,r,l,c,e]:[n,i,a,s,t,r,o,c,l,e]}}Gl.defaultPanelPositions={south:(t,e)=>({top:t.bottom,left:t.left-(e.width-t.width)/2,name:"s"}),southEast:t=>({top:t.bottom,left:t.left,name:"se"}),southWest:(t,e)=>({top:t.bottom,left:t.left-e.width+t.width,name:"sw"}),southMiddleEast:(t,e)=>({top:t.bottom,left:t.left-(e.width-t.width)/4,name:"sme"}),southMiddleWest:(t,e)=>({top:t.bottom,left:t.left-3*(e.width-t.width)/4,name:"smw"}),north:(t,e)=>({top:t.top-e.height,left:t.left-(e.width-t.width)/2,name:"n"}),northEast:(t,e)=>({top:t.top-e.height,left:t.left,name:"ne"}),northWest:(t,e)=>({top:t.top-e.height,left:t.left-e.width+t.width,name:"nw"}),northMiddleEast:(t,e)=>({top:t.top-e.height,left:t.left-(e.width-t.width)/4,name:"nme"}),northMiddleWest:(t,e)=>({top:t.top-e.height,left:t.left-3*(e.width-t.width)/4,name:"nmw"})},Gl._getOptimalPosition=ql;class Zl extends hl{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class $l extends hl{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}i(33);class Xl extends hl{constructor(t,e){super(t);const i=this.bindTemplate,n=this.t;this.options=e||{},this.set("ariaLabel",n("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new pr,this.keystrokes=new gr,this.set("class"),this.set("isCompact",!1),this.itemsView=new Kl(t),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o="rtl"===t.uiLanguageDirection;this._focusCycler=new Fl({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const r=["ck","ck-toolbar",i.to("class"),i.if("isCompact","ck-toolbar_compact")];var s;this.options.shouldGroupWhenFull&&this.options.isFloating&&r.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:r,role:"toolbar","aria-label":i.to("ariaLabel"),style:{maxWidth:i.to("maxWidth")}},children:this.children,on:{mousedown:(s=this,s.bindTemplate.to(t=>{t.target===s.element&&t.preventDefault()}))}}),this._behavior=this.options.shouldGroupWhenFull?new Jl(this):new Ql(this)}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,e)=>{this.focusTracker.add(e.element)}),this.items.on("remove",(t,e)=>{this.focusTracker.remove(e.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(t,e){const i=function(t){return Array.isArray(t)?{items:t,removeItems:[]}:t?Object.assign({items:[],removeItems:[]},t):{items:[],removeItems:[]}}(t),n=i.items.filter((t,n,o)=>"|"===t||-1===i.removeItems.indexOf(t)&&("-"===t?!this.options.shouldGroupWhenFull||(Object(a.b)("toolbarview-line-break-ignored-when-grouping-items",o),!1):!!e.has(t)||(Object(a.b)("toolbarview-item-unavailable",{name:t}),!1))),o=this._cleanSeparators(n).map(t=>"|"===t?new Zl:"-"===t?new $l:e.create(t));this.items.addMany(o)}_cleanSeparators(t){const e=t=>"-"!==t&&"|"!==t,i=t.length,n=t.findIndex(e),o=i-t.slice().reverse().findIndex(e);return t.slice(n,o).filter((t,i,n)=>!!e(t)||!(i>0&&n[i-1]===t))}}class Kl extends hl{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class Ql{constructor(t){const e=t.bindTemplate;t.set("isVertical",!1),t.itemsView.children.bindTo(t.items).using(t=>t),t.focusables.bindTo(t.items).using(t=>t),t.extendTemplate({attributes:{class:[e.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class Jl{constructor(t){this.view=t,this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),this.resizeObserver=null,this.cachedPadding=null,this.shouldUpdateGroupingOnNextResize=!1,t.itemsView.children.bindTo(this.ungroupedItems).using(t=>t),this.ungroupedItems.on("add",this._updateFocusCycleableItems.bind(this)),this.ungroupedItems.on("remove",this._updateFocusCycleableItems.bind(this)),t.children.on("add",this._updateFocusCycleableItems.bind(this)),t.children.on("remove",this._updateFocusCycleableItems.bind(this)),t.items.on("change",(t,e)=>{const i=e.index;for(const n of e.removed)i>=this.ungroupedItems.length?this.groupedItems.remove(n):this.ungroupedItems.remove(n);for(let n=i;n<i+e.added.length;n++){const t=e.added[n-i];n>this.ungroupedItems.length?this.groupedItems.add(t,n-this.ungroupedItems.length):this.ungroupedItems.add(t,n)}this._updateGrouping()}),t.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!this.viewElement.offsetParent)return void(this.shouldUpdateGroupingOnNextResize=!0);const t=this.groupedItems.length;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==t&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,e=this.viewLocale.uiLanguageDirection,i=new ar(t.lastChild),n=new ar(t);if(!this.cachedPadding){const i=co.window.getComputedStyle(t);this.cachedPadding=Number.parseInt(i["ltr"===e?"paddingRight":"paddingLeft"])}return"ltr"===e?i.right>n.right-this.cachedPadding:i.left<n.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new hr(this.viewElement,e=>{t&&t===e.contentRect.width&&!this.shouldUpdateGroupingOnNextResize||(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=e.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new Zl),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,e=t.t,i=nc(t);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition="ltr"===t.uiLanguageDirection?"sw":"se",oc(i,[]),i.buttonView.set({label:e("Show more items"),tooltip:!0,tooltipPosition:"rtl"===t.uiLanguageDirection?"se":"sw",icon:ol}),i.toolbarView.items.bindTo(this.groupedItems).using(t=>t),i}_updateFocusCycleableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}i(35);class tc extends hl{constructor(){super(),this.items=this.createCollection(),this.focusTracker=new pr,this.keystrokes=new gr,this._focusCycler=new Fl({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"]},children:this.items})}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.items.on("add",(t,e)=>{this.focusTracker.add(e.element)}),this.items.on("remove",(t,e)=>{this.focusTracker.remove(e.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}class ec extends hl{constructor(t){super(t),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item"]},children:this.children})}focus(){this.children.first.focus()}}class ic extends hl{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}function nc(t,e=Vl){const i=new e(t),n=new Wl(t),o=new Gl(t,i,n);return i.bind("isEnabled").to(o),i instanceof Vl?i.bind("isOn").to(o,"isOpen"):i.arrowView.bind("isOn").to(o,"isOpen"),function(t){(function(t){t.on("render",()=>{sl({emitter:t,activator:()=>t.isOpen,callback:()=>{t.isOpen=!1},contextElements:[t.element]})})})(t),function(t){t.on("execute",e=>{e.source instanceof Nl||(t.isOpen=!1)})}(t),function(t){t.keystrokes.set("arrowdown",(e,i)=>{t.isOpen&&(t.panelView.focus(),i())}),t.keystrokes.set("arrowup",(e,i)=>{t.isOpen&&(t.panelView.focusLast(),i())})}(t)}(o),o}function oc(t,e){const i=t.locale,n=i.t,o=t.toolbarView=new Xl(i);o.set("ariaLabel",n("Dropdown toolbar")),t.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),e.map(t=>o.items.add(t)),t.panelView.children.add(o),o.items.delegate("execute").to(t)}function rc(t,e){const i=t.locale,n=t.listView=new tc(i);n.items.bindTo(e).using(({type:t,model:e})=>{if("separator"===t)return new ic(i);if("button"===t||"switchbutton"===t){const n=new ec(i);let o;return o="button"===t?new Dl(i):new Nl(i),o.bind(...Object.keys(e)).to(e),o.delegate("execute").to(n),n.children.add(o),n}}),t.panelView.children.add(n),n.items.delegate("execute").to(t)}i(37),i(39),i(41);class sc extends hl{constructor(t){super(t),this.body=new Il(t)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}i(43);class ac extends hl{constructor(t){super(t),this.set("text"),this.set("for"),this.id="ck-editor__label_"+r();const e=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:e.to("for")},children:[{text:e.to("text")}]})}}class lc extends hl{constructor(t,e,i){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:t.contentLanguage,dir:t.contentLanguageDirection}}),this.name=null,this.set("isFocused",!1),this._editableElement=i,this._hasExternalElement=!!this._editableElement,this._editingView=e}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}_updateIsFocusedClasses(){const t=this._editingView;function e(e){t.change(i=>{const n=t.document.getRoot(e.name);i.addClass(e.isFocused?"ck-focused":"ck-blurred",n),i.removeClass(e.isFocused?"ck-blurred":"ck-focused",n)})}t.isRenderingInProgress?function i(n){t.once("change:isRenderingInProgress",(t,o,r)=>{r?i(n):e(n)})}(this):e(this)}}class cc extends lc{constructor(t,e,i){super(t,e,i),this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}})}render(){super.render();const t=this._editingView,e=this.t;t.change(i=>{const n=t.document.getRoot(this.name);i.setAttribute("aria-label",e("Rich Text Editor, %0",this.name),n)})}}i(45),i(47);class hc extends hl{constructor(t){super(t),this.set("value"),this.set("id"),this.set("placeholder"),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById"),this.focusTracker=new pr,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{type:"text",class:["ck","ck-input","ck-input-text",e.if("isFocused","ck-input_focused"),e.if("isEmpty","ck-input-text_empty"),e.if("hasError","ck-error")],id:e.to("id"),placeholder:e.to("placeholder"),readonly:e.to("isReadOnly"),"aria-invalid":e.if("hasError",!0),"aria-describedby":e.to("ariaDescribedById")},on:{input:e.to((...t)=>{this.fire("input",...t),this._updateIsEmpty()}),change:e.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(t,e,i)=>{this._setDomElementValue(i),this._updateIsEmpty()})}select(){this.element.select()}focus(){this.element.focus()}_updateIsEmpty(){this.isEmpty=!this.element.value}_setDomElementValue(t){this.element.value=t||0===t?t:""}}i(49);class dc extends hl{constructor(t,e){super(t);const i="ck-labeled-field-view-"+r(),n="ck-labeled-field-view-status-"+r();this.fieldView=e(this,i,n),this.set("label"),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class"),this.set("placeholder"),this.labelView=this._createLabelView(i),this.statusView=this._createStatusView(n),this.bind("_statusText").to(this,"errorText",this,"infoText",(t,e)=>t||e);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",t=>!t),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:[this.fieldView,this.labelView]},this.statusView]})}_createLabelView(t){const e=new ac(this.locale);return e.for=t,e.bind("text").to(this,"label"),e}_createStatusView(t){const e=new hl(this.locale),i=this.bindTemplate;return e.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",i.if("errorText","ck-labeled-field-view__status_error"),i.if("_statusText","ck-hidden",t=>!t)],id:t,role:i.if("errorText","alert")},children:[{text:i.to("_statusText")}]}),e}focus(){this.fieldView.focus()}}function uc(t,e,i){const n=new hc(t.locale);return n.set({id:e,ariaDescribedById:i}),n.bind("isReadOnly").to(t,"isEnabled",t=>!t),n.bind("hasError").to(t,"errorText",t=>!!t),n.on("input",()=>{t.errorText=null}),t.bind("isEmpty","isFocused","placeholder").to(n),n}class fc extends oi{static get pluginName(){return"Notification"}init(){this.on("show:warning",(t,e)=>{window.alert(e.message)},{priority:"lowest"})}showSuccess(t,e={}){this._showNotification({message:t,type:"success",namespace:e.namespace,title:e.title})}showInfo(t,e={}){this._showNotification({message:t,type:"info",namespace:e.namespace,title:e.title})}showWarning(t,e={}){this._showNotification({message:t,type:"warning",namespace:e.namespace,title:e.title})}_showNotification(t){this.fire("show:"+t.type+(t.namespace?":"+t.namespace:""),{message:t.message,type:t.type,title:t.title||""})}}class pc{constructor(t,e){e&&yt(this,e),t&&this.set(t)}}Pt(pc,Et),i(51);const gc=ur("px"),mc=co.document.body;class vc extends hl{constructor(t){super(t);const e=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class"),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",e.to("position",t=>"ck-balloon-panel_"+t),e.if("isVisible","ck-balloon-panel_visible"),e.if("withArrow","ck-balloon-panel_with-arrow"),e.to("class")],style:{top:e.to("top",gc),left:e.to("left",gc)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(t){this.show();const e=vc.defaultPositions,i=Object.assign({},{element:this.element,positions:[e.southArrowNorth,e.southArrowNorthMiddleWest,e.southArrowNorthMiddleEast,e.southArrowNorthWest,e.southArrowNorthEast,e.northArrowSouth,e.northArrowSouthMiddleWest,e.northArrowSouthMiddleEast,e.northArrowSouthWest,e.northArrowSouthEast,e.viewportStickyNorth],limiter:mc,fitInViewport:!0},t),n=vc._getOptimalPosition(i),o=parseInt(n.left),r=parseInt(n.top),{name:s,config:a={}}=n,{withArrow:l=!0}=a;Object.assign(this,{top:r,left:o,position:s,withArrow:l})}pin(t){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(t):this._stopPinning()},this._startPinning(t),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(t){this.attachTo(t);const e=yc(t.target),i=t.limiter?yc(t.limiter):mc;this.listenTo(co.document,"scroll",(n,o)=>{const r=o.target,s=e&&r.contains(e),a=i&&r.contains(i);!s&&!a&&e&&i||this.attachTo(t)},{useCapture:!0}),this.listenTo(co.window,"resize",()=>{this.attachTo(t)})}_stopPinning(){this.stopListening(co.document,"scroll"),this.stopListening(co.window,"resize")}}function yc(t){return Ye(t)?t:or(t)?t.commonAncestorContainer:"function"==typeof t?yc(t()):null}function bc(t,e){return t.top-e.height-vc.arrowVerticalOffset}function wc(t){return t.bottom+vc.arrowVerticalOffset}vc.arrowHorizontalOffset=25,vc.arrowVerticalOffset=10,vc.stickyVerticalOffset=20,vc._getOptimalPosition=ql,vc.defaultPositions={northWestArrowSouthWest:(t,e)=>({top:bc(t,e),left:t.left-vc.arrowHorizontalOffset,name:"arrow_sw"}),northWestArrowSouthMiddleWest:(t,e)=>({top:bc(t,e),left:t.left-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_smw"}),northWestArrowSouth:(t,e)=>({top:bc(t,e),left:t.left-e.width/2,name:"arrow_s"}),northWestArrowSouthMiddleEast:(t,e)=>({top:bc(t,e),left:t.left-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_sme"}),northWestArrowSouthEast:(t,e)=>({top:bc(t,e),left:t.left-e.width+vc.arrowHorizontalOffset,name:"arrow_se"}),northArrowSouthWest:(t,e)=>({top:bc(t,e),left:t.left+t.width/2-vc.arrowHorizontalOffset,name:"arrow_sw"}),northArrowSouthMiddleWest:(t,e)=>({top:bc(t,e),left:t.left+t.width/2-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_smw"}),northArrowSouth:(t,e)=>({top:bc(t,e),left:t.left+t.width/2-e.width/2,name:"arrow_s"}),northArrowSouthMiddleEast:(t,e)=>({top:bc(t,e),left:t.left+t.width/2-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_sme"}),northArrowSouthEast:(t,e)=>({top:bc(t,e),left:t.left+t.width/2-e.width+vc.arrowHorizontalOffset,name:"arrow_se"}),northEastArrowSouthWest:(t,e)=>({top:bc(t,e),left:t.right-vc.arrowHorizontalOffset,name:"arrow_sw"}),northEastArrowSouthMiddleWest:(t,e)=>({top:bc(t,e),left:t.right-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_smw"}),northEastArrowSouth:(t,e)=>({top:bc(t,e),left:t.right-e.width/2,name:"arrow_s"}),northEastArrowSouthMiddleEast:(t,e)=>({top:bc(t,e),left:t.right-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_sme"}),northEastArrowSouthEast:(t,e)=>({top:bc(t,e),left:t.right-e.width+vc.arrowHorizontalOffset,name:"arrow_se"}),southWestArrowNorthWest:(t,e)=>({top:wc(t),left:t.left-vc.arrowHorizontalOffset,name:"arrow_nw"}),southWestArrowNorthMiddleWest:(t,e)=>({top:wc(t),left:t.left-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_nmw"}),southWestArrowNorth:(t,e)=>({top:wc(t),left:t.left-e.width/2,name:"arrow_n"}),southWestArrowNorthMiddleEast:(t,e)=>({top:wc(t),left:t.left-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_nme"}),southWestArrowNorthEast:(t,e)=>({top:wc(t),left:t.left-e.width+vc.arrowHorizontalOffset,name:"arrow_ne"}),southArrowNorthWest:(t,e)=>({top:wc(t),left:t.left+t.width/2-vc.arrowHorizontalOffset,name:"arrow_nw"}),southArrowNorthMiddleWest:(t,e)=>({top:wc(t),left:t.left+t.width/2-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_nmw"}),southArrowNorth:(t,e)=>({top:wc(t),left:t.left+t.width/2-e.width/2,name:"arrow_n"}),southArrowNorthMiddleEast:(t,e)=>({top:wc(t),left:t.left+t.width/2-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_nme"}),southArrowNorthEast:(t,e)=>({top:wc(t),left:t.left+t.width/2-e.width+vc.arrowHorizontalOffset,name:"arrow_ne"}),southEastArrowNorthWest:(t,e)=>({top:wc(t),left:t.right-vc.arrowHorizontalOffset,name:"arrow_nw"}),southEastArrowNorthMiddleWest:(t,e)=>({top:wc(t),left:t.right-.25*e.width-vc.arrowHorizontalOffset,name:"arrow_nmw"}),southEastArrowNorth:(t,e)=>({top:wc(t),left:t.right-e.width/2,name:"arrow_n"}),southEastArrowNorthMiddleEast:(t,e)=>({top:wc(t),left:t.right-.75*e.width+vc.arrowHorizontalOffset,name:"arrow_nme"}),southEastArrowNorthEast:(t,e)=>({top:wc(t),left:t.right-e.width+vc.arrowHorizontalOffset,name:"arrow_ne"}),viewportStickyNorth:(t,e,i)=>t.getIntersection(i)?{top:i.top+vc.stickyVerticalOffset,left:t.left+t.width/2-e.width/2,name:"arrowless",config:{withArrow:!1}}:null},i(53),i(55);const kc=ur("px");class _c extends Mt{static get pluginName(){return"ContextualBalloon"}constructor(t){super(t),this.positionLimiter=()=>{const t=this.editor.editing.view,e=t.document.selection.editableElement;return e?t.domConverter.mapViewToDom(e.root):null},this.set("visibleView",null),this.view=new vc(t.locale),t.ui.view.body.add(this.view),t.ui.focusTracker.add(this.view.element),this._viewToStack=new Map,this._idToStack=new Map,this.set("_numberOfStacks",0),this.set("_singleViewMode",!1),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}hasView(t){return Array.from(this._viewToStack.keys()).includes(t)}add(t){if(this.hasView(t.view))throw new a.a("contextualballoon-add-view-exist",[this,t]);const e=t.stackId||"main";if(!this._idToStack.has(e))return this._idToStack.set(e,new Map([[t.view,t]])),this._viewToStack.set(t.view,this._idToStack.get(e)),this._numberOfStacks=this._idToStack.size,void(this._visibleStack&&!t.singleViewMode||this.showStack(e));const i=this._idToStack.get(e);t.singleViewMode&&this.showStack(e),i.set(t.view,t),this._viewToStack.set(t.view,i),i===this._visibleStack&&this._showView(t)}remove(t){if(!this.hasView(t))throw new a.a("contextualballoon-remove-view-not-exist",[this,t]);const e=this._viewToStack.get(t);this._singleViewMode&&this.visibleView===t&&(this._singleViewMode=!1),this.visibleView===t&&(1===e.size?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(e.values())[e.size-2])),1===e.size?(this._idToStack.delete(this._getStackId(e)),this._numberOfStacks=this._idToStack.size):e.delete(t),this._viewToStack.delete(t)}updatePosition(t){t&&(this._visibleStack.get(this.visibleView).position=t),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(t){this.visibleStack=t;const e=this._idToStack.get(t);if(!e)throw new a.a("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==e&&this._showView(Array.from(e.values()).pop())}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(t){return Array.from(this._idToStack.entries()).find(e=>e[1]===t)[0]}_showNextStack(){const t=Array.from(this._idToStack.values());let e=t.indexOf(this._visibleStack)+1;t[e]||(e=0),this.showStack(this._getStackId(t[e]))}_showPrevStack(){const t=Array.from(this._idToStack.values());let e=t.indexOf(this._visibleStack)-1;t[e]||(e=t.length-1),this.showStack(this._getStackId(t[e]))}_createRotatorView(){const t=new xc(this.editor.locale),e=this.editor.locale.t;return this.view.content.add(t),t.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(t,e)=>!e&&t>1),t.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),t.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(t,i)=>{if(i<2)return"";const n=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return e("%0 of %1",[n,i])}),t.buttonNextView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),t.buttonPrevView.on("execute",()=>{t.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),t}_createFakePanelsView(){const t=new Cc(this.editor.locale,this.view);return t.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(t,e)=>!e&&t>=2?Math.min(t-1,2):0),t.listenTo(this.view,"change:top",()=>t.updatePosition()),t.listenTo(this.view,"change:left",()=>t.updatePosition()),this.editor.ui.view.body.add(t),t}_showView({view:t,balloonClassName:e="",withArrow:i=!0,singleViewMode:n=!1}){this.view.class=e,this.view.withArrow=i,this._rotatorView.showView(t),this.visibleView=t,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),n&&(this._singleViewMode=!0)}_getBalloonPosition(){let t=Array.from(this._visibleStack.values()).pop().position;return t&&(t.limiter||(t=Object.assign({},t,{limiter:this.positionLimiter})),t=Object.assign({},t,{viewportOffsetConfig:this.editor.ui.viewportOffset})),t}}class xc extends hl{constructor(t){super(t);const e=t.t,i=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new pr,this.buttonPrevView=this._createButtonView(e("Previous"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>'),this.buttonNextView=this._createButtonView(e("Next"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>'),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",i.to("isNavigationVisible",t=>t?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:i.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}showView(t){this.hideView(),this.content.add(t)}hideView(){this.content.clear()}_createButtonView(t,e){const i=new Dl(this.locale);return i.set({label:t,icon:e,tooltip:!0}),i}}class Cc extends hl{constructor(t,e){super(t);const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=e,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",i.to("numberOfPanels",t=>t?"":"ck-hidden")],style:{top:i.to("top",kc),left:i.to("left",kc),width:i.to("width",kc),height:i.to("height",kc)}},children:this.content}),this.on("change:numberOfPanels",(t,e,i,n)=>{i>n?this._addPanels(i-n):this._removePanels(n-i),this.updatePosition()})}_addPanels(t){for(;t--;){const t=new hl;t.setTemplate({tag:"div"}),this.content.add(t),this.registerChild(t)}}_removePanels(t){for(;t--;){const t=this.content.last;this.content.remove(t),this.deregisterChild(t),t.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:t,left:e}=this._balloonPanelView,{width:i,height:n}=new ar(this._balloonPanelView.element);Object.assign(this,{top:t,left:e,width:i,height:n})}}}i(57),ur("px"),ur("px"),i(59),ur("px"),ur("px"),i(61);const Ec=new WeakMap;function Tc(t){const{view:e,element:i,text:n,isDirectHost:o=!0,keepOnFocus:r=!1}=t,s=e.document;Ec.has(s)||(Ec.set(s,new Map),s.registerPostFixer(t=>Sc(s,t))),Ec.get(s).set(i,{text:n,isDirectHost:o,keepOnFocus:r,hostElement:o?i:null}),e.change(t=>Sc(s,t))}function Sc(t,e){const i=Ec.get(t),n=[];let o=!1;for(const[r,s]of i)s.isDirectHost&&(n.push(r),Ac(e,r,s)&&(o=!0));for(const[r,s]of i){if(s.isDirectHost)continue;const t=Oc(r);t&&(n.includes(t)||(s.hostElement=t,Ac(e,r,s)&&(o=!0)))}return o}function Ac(t,e,i){const{text:n,isDirectHost:o,hostElement:r}=i;let s=!1;return r.getAttribute("data-placeholder")!==n&&(t.setAttribute("data-placeholder",n,r),s=!0),(o||1==e.childCount)&&function(t,e){if(!t.isAttached())return!1;if(Array.from(t.getChildren()).some(t=>!t.is("uiElement")))return!1;if(e)return!0;const i=t.document;if(!i.isFocused)return!0;const n=i.selection.anchor;return n&&n.parent!==t}(r,i.keepOnFocus)?function(t,e){return!e.hasClass("ck-placeholder")&&(t.addClass("ck-placeholder",e),!0)}(t,r)&&(s=!0):function(t,e){return!!e.hasClass("ck-placeholder")&&(t.removeClass("ck-placeholder",e),!0)}(t,r)&&(s=!0),s}function Oc(t){if(t.childCount){const e=t.getChild(0);if(e.is("element")&&!e.is("uiElement"))return e}return null}const Ic=new Map;function Pc(t,e,i){let n=Ic.get(t);n||(n=new Map,Ic.set(t,n)),n.set(e,i)}function Mc(t){return[t]}function Dc(t,e,i={}){const n=function(t,e){const i=Ic.get(t);return i&&i.has(e)?i.get(e):Mc}(t.constructor,e.constructor);try{return n(t=t.clone(),e,i)}catch(t){throw t}}function Nc(t,e,i){t=t.slice(),e=e.slice();const n=new Rc(i.document,i.useRelations,i.forceWeakRemove);n.setOriginalOperations(t),n.setOriginalOperations(e);const o=n.originalOperations;if(0==t.length||0==e.length)return{operationsA:t,operationsB:e,originalOperations:o};const r=new WeakMap;for(const l of t)r.set(l,0);const s={nextBaseVersionA:t[t.length-1].baseVersion+1,nextBaseVersionB:e[e.length-1].baseVersion+1,originalOperationsACount:t.length,originalOperationsBCount:e.length};let a=0;for(;a<t.length;){const i=t[a],o=r.get(i);if(o==e.length){a++;continue}const s=e[o],l=Dc(i,s,n.getContext(i,s,!0)),c=Dc(s,i,n.getContext(s,i,!1));n.updateRelation(i,s),n.setOriginalOperations(l,i),n.setOriginalOperations(c,s);for(const t of l)r.set(t,o+c.length);t.splice(a,1,...l),e.splice(o,1,...c)}if(i.padWithNoOps){const i=t.length-s.originalOperationsACount,n=e.length-s.originalOperationsBCount;Fc(t,n-i),Fc(e,i-n)}return zc(t,s.nextBaseVersionB),zc(e,s.nextBaseVersionA),{operationsA:t,operationsB:e,originalOperations:o}}class Rc{constructor(t,e,i=!1){this.originalOperations=new Map,this._history=t.history,this._useRelations=e,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(t,e=null){const i=e?this.originalOperations.get(e):null;for(const n of t)this.originalOperations.set(n,i||n)}updateRelation(t,e){switch(t.constructor){case la:switch(e.constructor){case fa:t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter");break;case la:t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter")}break;case pa:switch(e.constructor){case fa:t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");break;case la:if(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))this._setRelation(t,e,"splitBefore");else{const i=Br._createFromPositionAndShift(e.sourcePosition,e.howMany);t.splitPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.splitPosition)&&this._setRelation(t,e,{howMany:i.end.offset-t.splitPosition.offset,offset:t.splitPosition.offset-i.start.offset})}}break;case fa:switch(e.constructor){case fa:t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.targetPosition)&&this._setRelation(t,e,"mergeSourceNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement");break;case pa:t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource")}break;case ha:{const i=t.newRange;if(!i)return;switch(e.constructor){case la:{const n=Br._createFromPositionAndShift(e.sourcePosition,e.howMany),o=n.containsPosition(i.start)||n.start.isEqual(i.start),r=n.containsPosition(i.end)||n.end.isEqual(i.end);!o&&!r||n.containsRange(i)||this._setRelation(t,e,{side:o?"left":"right",path:o?i.start.path.slice():i.end.path.slice()});break}case fa:{const n=i.start.isEqual(e.targetPosition),o=i.start.isEqual(e.deletionPosition),r=i.end.isEqual(e.deletionPosition),s=i.end.isEqual(e.sourcePosition);(n||o||r||s)&&this._setRelation(t,e,{wasInLeftElement:n,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:r,wasInRightElement:s});break}}break}}}getContext(t,e,i){return{aIsStrong:i,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const e=this.originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}_getRelation(t,e){const i=this.originalOperations.get(e),n=this._history.getUndoneOperation(i);if(!n)return null;const o=this.originalOperations.get(t),r=this._relations.get(o);return r&&r.get(n)||null}_setRelation(t,e,i){const n=this.originalOperations.get(t),o=this.originalOperations.get(e);let r=this._relations.get(n);r||(r=new Map,this._relations.set(n,r)),r.set(o,i)}}function zc(t,e){for(const i of t)i.baseVersion=e++}function Fc(t,e){for(let i=0;i<e;i++)t.push(new Da(0))}function Lc(t,e,i){const n=t.nodes.getNode(0).getAttribute(e);if(n==i)return null;const o=new Br(t.position,t.position.getShiftedBy(t.howMany));return new sa(o,e,n,i,0)}function Bc(t,e){return null===t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany)}function jc(t,e){const i=[];for(let n=0;n<t.length;n++){const o=t[n],r=new la(o.start,o.end.offset-o.start.offset,e,0);i.push(r);for(let e=n+1;e<t.length;e++)t[e]=t[e]._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)[0];e=e._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)}return i}Pc(sa,sa,(t,e,i)=>{if(t.key===e.key&&t.range.start.hasSameParentAs(e.range.start)){const n=t.range.getDifference(e.range).map(e=>new sa(e,t.key,t.oldValue,t.newValue,0)),o=t.range.getIntersection(e.range);return o&&i.aIsStrong&&n.push(new sa(o,e.key,e.newValue,t.newValue,0)),0==n.length?[new Da(0)]:n}return[t]}),Pc(sa,ca,(t,e)=>{if(t.range.start.hasSameParentAs(e.position)&&t.range.containsPosition(e.position)){const i=t.range._getTransformedByInsertion(e.position,e.howMany,!e.shouldReceiveAttributes).map(e=>new sa(e,t.key,t.oldValue,t.newValue,t.baseVersion));if(e.shouldReceiveAttributes){const n=Lc(e,t.key,t.oldValue);n&&i.unshift(n)}return i}return t.range=t.range._getTransformedByInsertion(e.position,e.howMany,!1)[0],[t]}),Pc(sa,fa,(t,e)=>{const i=[];t.range.start.hasSameParentAs(e.deletionPosition)&&(t.range.containsPosition(e.deletionPosition)||t.range.start.isEqual(e.deletionPosition))&&i.push(Br._createFromPositionAndShift(e.graveyardPosition,1));const n=t.range._getTransformedByMergeOperation(e);return n.isCollapsed||i.push(n),i.map(e=>new sa(e,t.key,t.oldValue,t.newValue,t.baseVersion))}),Pc(sa,la,(t,e)=>function(t,e){const i=Br._createFromPositionAndShift(e.sourcePosition,e.howMany);let n=null,o=[];i.containsRange(t,!0)?n=t:t.start.hasSameParentAs(i.start)?(o=t.getDifference(i),n=t.getIntersection(i)):o=[t];const r=[];for(let s of o){s=s._getTransformedByDeletion(e.sourcePosition,e.howMany);const t=e.getMovedRangeStart(),i=s.start.hasSameParentAs(t);s=s._getTransformedByInsertion(t,e.howMany,i),r.push(...s)}return n&&r.push(n._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany,!1)[0]),r}(t.range,e).map(e=>new sa(e,t.key,t.oldValue,t.newValue,t.baseVersion))),Pc(sa,pa,(t,e)=>{if(t.range.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.range.end.offset++,[t];if(t.range.start.hasSameParentAs(e.splitPosition)&&t.range.containsPosition(e.splitPosition)){const i=t.clone();return i.range=new Br(e.moveTargetPosition.clone(),t.range.end._getCombined(e.splitPosition,e.moveTargetPosition)),t.range.end=e.splitPosition.clone(),t.range.end.stickiness="toPrevious",[t,i]}return t.range=t.range._getTransformedBySplitOperation(e),[t]}),Pc(ca,sa,(t,e)=>{const i=[t];if(t.shouldReceiveAttributes&&t.position.hasSameParentAs(e.range.start)&&e.range.containsPosition(t.position)){const n=Lc(t,e.key,e.newValue);n&&i.push(n)}return i}),Pc(ca,ca,(t,e,i)=>(t.position.isEqual(e.position)&&i.aIsStrong||(t.position=t.position._getTransformedByInsertOperation(e)),[t])),Pc(ca,la,(t,e)=>(t.position=t.position._getTransformedByMoveOperation(e),[t])),Pc(ca,pa,(t,e)=>(t.position=t.position._getTransformedBySplitOperation(e),[t])),Pc(ca,fa,(t,e)=>(t.position=t.position._getTransformedByMergeOperation(e),[t])),Pc(ha,ca,(t,e)=>(t.oldRange&&(t.oldRange=t.oldRange._getTransformedByInsertOperation(e)[0]),t.newRange&&(t.newRange=t.newRange._getTransformedByInsertOperation(e)[0]),[t])),Pc(ha,ha,(t,e,i)=>{if(t.name==e.name){if(!i.aIsStrong)return[new Da(0)];t.oldRange=e.newRange?e.newRange.clone():null}return[t]}),Pc(ha,fa,(t,e)=>(t.oldRange&&(t.oldRange=t.oldRange._getTransformedByMergeOperation(e)),t.newRange&&(t.newRange=t.newRange._getTransformedByMergeOperation(e)),[t])),Pc(ha,la,(t,e,i)=>{if(t.oldRange&&(t.oldRange=Br._createFromRanges(t.oldRange._getTransformedByMoveOperation(e))),t.newRange){if(i.abRelation){const n=Br._createFromRanges(t.newRange._getTransformedByMoveOperation(e));if("left"==i.abRelation.side&&e.targetPosition.isEqual(t.newRange.start))return t.newRange.start.path=i.abRelation.path,t.newRange.end=n.end,[t];if("right"==i.abRelation.side&&e.targetPosition.isEqual(t.newRange.end))return t.newRange.start=n.start,t.newRange.end.path=i.abRelation.path,[t]}t.newRange=Br._createFromRanges(t.newRange._getTransformedByMoveOperation(e))}return[t]}),Pc(ha,pa,(t,e,i)=>{if(t.oldRange&&(t.oldRange=t.oldRange._getTransformedBySplitOperation(e)),t.newRange){if(i.abRelation){const n=t.newRange._getTransformedBySplitOperation(e);return t.newRange.start.isEqual(e.splitPosition)&&i.abRelation.wasStartBeforeMergedElement?t.newRange.start=Rr._createAt(e.insertionPosition):t.newRange.start.isEqual(e.splitPosition)&&!i.abRelation.wasInLeftElement&&(t.newRange.start=Rr._createAt(e.moveTargetPosition)),t.newRange.end=t.newRange.end.isEqual(e.splitPosition)&&i.abRelation.wasInRightElement?Rr._createAt(e.moveTargetPosition):t.newRange.end.isEqual(e.splitPosition)&&i.abRelation.wasEndBeforeMergedElement?Rr._createAt(e.insertionPosition):n.end,[t]}t.newRange=t.newRange._getTransformedBySplitOperation(e)}return[t]}),Pc(fa,ca,(t,e)=>(t.sourcePosition.hasSameParentAs(e.position)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByInsertOperation(e),t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e),[t])),Pc(fa,fa,(t,e,i)=>{if(t.sourcePosition.isEqual(e.sourcePosition)&&t.targetPosition.isEqual(e.targetPosition)){if(i.bWasUndone){const i=e.graveyardPosition.path.slice();return i.push(0),t.sourcePosition=new Rr(e.graveyardPosition.root,i),t.howMany=0,[t]}return[new Da(0)]}if(t.sourcePosition.isEqual(e.sourcePosition)&&!t.targetPosition.isEqual(e.targetPosition)&&!i.bWasUndone&&"splitAtSource"!=i.abRelation){const n="$graveyard"==t.targetPosition.root.rootName,o="$graveyard"==e.targetPosition.root.rootName,r=n&&!o;if(o&&!n||!r&&i.aIsStrong){const i=e.targetPosition._getTransformedByMergeOperation(e),n=t.targetPosition._getTransformedByMergeOperation(e);return[new la(i,t.howMany,n,0)]}return[new Da(0)]}return t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMergeOperation(e),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),t.graveyardPosition.isEqual(e.graveyardPosition)&&i.aIsStrong||(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Pc(fa,la,(t,e,i)=>{const n=Br._createFromPositionAndShift(e.sourcePosition,e.howMany);return"remove"==e.type&&!i.bWasUndone&&!i.forceWeakRemove&&t.deletionPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.sourcePosition)?[new Da(0)]:(t.sourcePosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.sourcePosition.hasSameParentAs(e.sourcePosition)&&(t.howMany-=e.howMany),t.sourcePosition=t.sourcePosition._getTransformedByMoveOperation(e),t.targetPosition=t.targetPosition._getTransformedByMoveOperation(e),t.graveyardPosition.isEqual(e.targetPosition)||(t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)),[t])}),Pc(fa,pa,(t,e,i)=>{if(e.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByDeletion(e.graveyardPosition,1),t.deletionPosition.isEqual(e.graveyardPosition)&&(t.howMany=e.howMany)),t.targetPosition.isEqual(e.splitPosition)){const n=0!=e.howMany,o=e.graveyardPosition&&t.deletionPosition.isEqual(e.graveyardPosition);if(n||o||"mergeTargetNotMoved"==i.abRelation)return t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),[t]}if(t.sourcePosition.isEqual(e.splitPosition)){if("mergeSourceNotMoved"==i.abRelation)return t.howMany=0,t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t];if("mergeSameElement"==i.abRelation||t.sourcePosition.offset>0)return t.sourcePosition=e.moveTargetPosition.clone(),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t]}return t.sourcePosition.hasSameParentAs(e.splitPosition)&&(t.howMany=e.splitPosition.offset),t.sourcePosition=t.sourcePosition._getTransformedBySplitOperation(e),t.targetPosition=t.targetPosition._getTransformedBySplitOperation(e),[t]}),Pc(la,ca,(t,e)=>{const i=Br._createFromPositionAndShift(t.sourcePosition,t.howMany)._getTransformedByInsertOperation(e,!1)[0];return t.sourcePosition=i.start,t.howMany=i.end.offset-i.start.offset,t.targetPosition.isEqual(e.position)||(t.targetPosition=t.targetPosition._getTransformedByInsertOperation(e)),[t]}),Pc(la,la,(t,e,i)=>{const n=Br._createFromPositionAndShift(t.sourcePosition,t.howMany),o=Br._createFromPositionAndShift(e.sourcePosition,e.howMany);let r,s=i.aIsStrong,a=!i.aIsStrong;if("insertBefore"==i.abRelation||"insertAfter"==i.baRelation?a=!0:"insertAfter"!=i.abRelation&&"insertBefore"!=i.baRelation||(a=!1),r=t.targetPosition.isEqual(e.targetPosition)&&a?t.targetPosition._getTransformedByDeletion(e.sourcePosition,e.howMany):t.targetPosition._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),Bc(t,e)&&Bc(e,t))return[e.getReversed()];if(n.containsPosition(e.targetPosition)&&n.containsRange(o,!0))return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),jc([n],r);if(o.containsPosition(t.targetPosition)&&o.containsRange(n,!0))return n.start=n.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),n.end=n.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),jc([n],r);const l=ri(t.sourcePosition.getParentPath(),e.sourcePosition.getParentPath());if("prefix"==l||"extension"==l)return n.start=n.start._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),n.end=n.end._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany),jc([n],r);"remove"!=t.type||"remove"==e.type||i.aWasUndone||i.forceWeakRemove?"remove"==t.type||"remove"!=e.type||i.bWasUndone||i.forceWeakRemove||(s=!1):s=!0;const c=[],h=n.getDifference(o);for(const u of h){u.start=u.start._getTransformedByDeletion(e.sourcePosition,e.howMany),u.end=u.end._getTransformedByDeletion(e.sourcePosition,e.howMany);const t="same"==ri(u.start.getParentPath(),e.getMovedRangeStart().getParentPath()),i=u._getTransformedByInsertion(e.getMovedRangeStart(),e.howMany,t);c.push(...i)}const d=n.getIntersection(o);return null!==d&&s&&(d.start=d.start._getCombined(e.sourcePosition,e.getMovedRangeStart()),d.end=d.end._getCombined(e.sourcePosition,e.getMovedRangeStart()),0===c.length?c.push(d):1==c.length?o.start.isBefore(n.start)||o.start.isEqual(n.start)?c.unshift(d):c.push(d):c.splice(1,0,d)),0===c.length?[new Da(t.baseVersion)]:jc(c,r)}),Pc(la,pa,(t,e,i)=>{let n=t.targetPosition.clone();t.targetPosition.isEqual(e.insertionPosition)&&e.graveyardPosition&&"moveTargetAfter"!=i.abRelation||(n=t.targetPosition._getTransformedBySplitOperation(e));const o=Br._createFromPositionAndShift(t.sourcePosition,t.howMany);if(o.end.isEqual(e.insertionPosition))return e.graveyardPosition||t.howMany++,t.targetPosition=n,[t];if(o.start.hasSameParentAs(e.splitPosition)&&o.containsPosition(e.splitPosition)){let t=new Br(e.splitPosition,o.end);return t=t._getTransformedBySplitOperation(e),jc([new Br(o.start,e.splitPosition),t],n)}t.targetPosition.isEqual(e.splitPosition)&&"insertAtSource"==i.abRelation&&(n=e.moveTargetPosition),t.targetPosition.isEqual(e.insertionPosition)&&"insertBetween"==i.abRelation&&(n=t.targetPosition);const r=[o._getTransformedBySplitOperation(e)];if(e.graveyardPosition){const n=o.start.isEqual(e.graveyardPosition)||o.containsPosition(e.graveyardPosition);t.howMany>1&&n&&!i.aWasUndone&&r.push(Br._createFromPositionAndShift(e.insertionPosition,1))}return jc(r,n)}),Pc(la,fa,(t,e,i)=>{const n=Br._createFromPositionAndShift(t.sourcePosition,t.howMany);if(e.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(e.sourcePosition))if("remove"!=t.type||i.forceWeakRemove){if(1==t.howMany)return i.bWasUndone?(t.sourcePosition=e.graveyardPosition.clone(),t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]):[new Da(0)]}else if(!i.aWasUndone){const i=[];let n=e.graveyardPosition.clone(),o=e.targetPosition._getTransformedByMergeOperation(e);t.howMany>1&&(i.push(new la(t.sourcePosition,t.howMany-1,t.targetPosition,0)),n=n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany-1),o=o._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany-1));const r=e.deletionPosition._getCombined(t.sourcePosition,t.targetPosition),s=new la(n,1,r,0),a=s.getMovedRangeStart().path.slice();a.push(0);const l=new Rr(s.targetPosition.root,a);o=o._getTransformedByMove(n,r,1);const c=new la(o,e.howMany,l,0);return i.push(s),i.push(c),i}const o=Br._createFromPositionAndShift(t.sourcePosition,t.howMany)._getTransformedByMergeOperation(e);return t.sourcePosition=o.start,t.howMany=o.end.offset-o.start.offset,t.targetPosition=t.targetPosition._getTransformedByMergeOperation(e),[t]}),Pc(da,ca,(t,e)=>(t.position=t.position._getTransformedByInsertOperation(e),[t])),Pc(da,fa,(t,e)=>t.position.isEqual(e.deletionPosition)?(t.position=e.graveyardPosition.clone(),t.position.stickiness="toNext",[t]):(t.position=t.position._getTransformedByMergeOperation(e),[t])),Pc(da,la,(t,e)=>(t.position=t.position._getTransformedByMoveOperation(e),[t])),Pc(da,da,(t,e,i)=>{if(t.position.isEqual(e.position)){if(!i.aIsStrong)return[new Da(0)];t.oldName=e.newName}return[t]}),Pc(da,pa,(t,e)=>{if("same"==ri(t.position.path,e.splitPosition.getParentPath())&&!e.graveyardPosition){const e=new da(t.position.getShiftedBy(1),t.oldName,t.newName,0);return[t,e]}return t.position=t.position._getTransformedBySplitOperation(e),[t]}),Pc(ua,ua,(t,e,i)=>{if(t.root===e.root&&t.key===e.key){if(!i.aIsStrong||t.newValue===e.newValue)return[new Da(0)];t.oldValue=e.newValue}return[t]}),Pc(pa,ca,(t,e)=>(t.splitPosition.hasSameParentAs(e.position)&&t.splitPosition.offset<e.position.offset&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByInsertOperation(e),t.insertionPosition=t.insertionPosition._getTransformedByInsertOperation(e),[t])),Pc(pa,fa,(t,e,i)=>{if(!t.graveyardPosition&&!i.bWasUndone&&t.splitPosition.hasSameParentAs(e.sourcePosition)){const i=e.graveyardPosition.path.slice();i.push(0);const n=new Rr(e.graveyardPosition.root,i),o=pa.getInsertionPosition(new Rr(e.graveyardPosition.root,i)),r=new pa(n,0,o,null,0);return t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=pa.getInsertionPosition(t.splitPosition),t.graveyardPosition=r.insertionPosition.clone(),t.graveyardPosition.stickiness="toNext",[r,t]}return t.splitPosition.hasSameParentAs(e.deletionPosition)&&!t.splitPosition.isAfter(e.deletionPosition)&&t.howMany--,t.splitPosition.hasSameParentAs(e.targetPosition)&&(t.howMany+=e.howMany),t.splitPosition=t.splitPosition._getTransformedByMergeOperation(e),t.insertionPosition=pa.getInsertionPosition(t.splitPosition),t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedByMergeOperation(e)),[t]}),Pc(pa,la,(t,e,i)=>{const n=Br._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.graveyardPosition){const o=n.start.isEqual(t.graveyardPosition)||n.containsPosition(t.graveyardPosition);if(!i.bWasUndone&&o){const i=t.splitPosition._getTransformedByMoveOperation(e),n=t.graveyardPosition._getTransformedByMoveOperation(e),o=n.path.slice();o.push(0);const r=new Rr(n.root,o);return[new la(i,t.howMany,r,0)]}t.graveyardPosition=t.graveyardPosition._getTransformedByMoveOperation(e)}const o=t.splitPosition.isEqual(e.targetPosition);if(o&&("insertAtSource"==i.baRelation||"splitBefore"==i.abRelation))return t.howMany+=e.howMany,t.splitPosition=t.splitPosition._getTransformedByDeletion(e.sourcePosition,e.howMany),t.insertionPosition=pa.getInsertionPosition(t.splitPosition),[t];if(o&&i.abRelation&&i.abRelation.howMany){const{howMany:e,offset:n}=i.abRelation;return t.howMany+=e,t.splitPosition=t.splitPosition.getShiftedBy(n),[t]}return t.splitPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.splitPosition)?(t.howMany-=e.howMany-(t.splitPosition.offset-e.sourcePosition.offset),t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany),t.splitPosition=e.sourcePosition.clone(),t.insertionPosition=pa.getInsertionPosition(t.splitPosition),[t]):(e.sourcePosition.isEqual(e.targetPosition)||(t.splitPosition.hasSameParentAs(e.sourcePosition)&&t.splitPosition.offset<=e.sourcePosition.offset&&(t.howMany-=e.howMany),t.splitPosition.hasSameParentAs(e.targetPosition)&&t.splitPosition.offset<e.targetPosition.offset&&(t.howMany+=e.howMany)),t.splitPosition.stickiness="toNone",t.splitPosition=t.splitPosition._getTransformedByMoveOperation(e),t.splitPosition.stickiness="toNext",t.insertionPosition=t.graveyardPosition?t.insertionPosition._getTransformedByMoveOperation(e):pa.getInsertionPosition(t.splitPosition),[t])}),Pc(pa,pa,(t,e,i)=>{if(t.splitPosition.isEqual(e.splitPosition)){if(!t.graveyardPosition&&!e.graveyardPosition)return[new Da(0)];if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition))return[new Da(0)];if("splitBefore"==i.abRelation)return t.howMany=0,t.graveyardPosition=t.graveyardPosition._getTransformedBySplitOperation(e),[t]}if(t.graveyardPosition&&e.graveyardPosition&&t.graveyardPosition.isEqual(e.graveyardPosition)){const n="$graveyard"==t.splitPosition.root.rootName,o="$graveyard"==e.splitPosition.root.rootName,r=n&&!o;if(o&&!n||!r&&i.aIsStrong){const i=[];return e.howMany&&i.push(new la(e.moveTargetPosition,e.howMany,e.splitPosition,0)),t.howMany&&i.push(new la(t.splitPosition,t.howMany,t.moveTargetPosition,0)),i}return[new Da(0)]}if(t.graveyardPosition&&(t.graveyardPosition=t.graveyardPosition._getTransformedBySplitOperation(e)),t.splitPosition.isEqual(e.insertionPosition)&&"splitBefore"==i.abRelation)return t.howMany++,[t];if(e.splitPosition.isEqual(t.insertionPosition)&&"splitBefore"==i.baRelation){const i=e.insertionPosition.path.slice();i.push(0);const n=new Rr(e.insertionPosition.root,i);return[t,new la(t.insertionPosition,1,n,0)]}return t.splitPosition.hasSameParentAs(e.splitPosition)&&t.splitPosition.offset<e.splitPosition.offset&&(t.howMany-=e.howMany),t.splitPosition=t.splitPosition._getTransformedBySplitOperation(e),t.insertionPosition=pa.getInsertionPosition(t.splitPosition),[t]});class Vc extends Bo{constructor(t){super(t),this.domEventType="click"}onDomEvent(t){this.fire(t.type,t)}}class Hc extends Bo{constructor(t){super(t),this.domEventType=["mousedown","mouseup","mouseover","mouseout"]}onDomEvent(t){this.fire(t.type,t)}}class Wc{constructor(t){this.document=t}createDocumentFragment(t){return new Mn(this.document,t)}createElement(t,e,i){return new Bi(this.document,t,e,i)}createText(t){return new li(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,i){return i._insertChild(t,e)}removeChildren(t,e,i){return i._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const i=t.parent;if(i){const n=i.getChildIndex(t);return this.removeChildren(n,1,i),this.insertChild(n,e,i),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const i=e.getChildIndex(t);this.remove(t),this.insertChild(i,t.getChildren(),e)}}rename(t,e){const i=new Bi(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,i)?i:null}setAttribute(t,e,i){i._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Ht(t)&&void 0===i&&(i=e),i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return Gi._createAt(t,e)}createPositionAfter(t){return Gi._createAfter(t)}createPositionBefore(t){return Gi._createBefore(t)}createRange(t,e){return new Zi(t,e)}createRangeOn(t){return Zi._createOn(t)}createRangeIn(t){return Zi._createIn(t)}createSelection(t,e,i){return new Ki(t,e,i)}}const qc=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Uc=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,Yc=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,Gc=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,Zc=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,$c=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function Xc(t){return t.startsWith("#")?qc.test(t):t.startsWith("rgb")?Uc.test(t)||Yc.test(t):t.startsWith("hsl")?Gc.test(t)||Zc.test(t):$c.has(t.toLowerCase())}const Kc=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/,Qc=/^[+-]?[0-9]*([.][0-9]+)?%$/,Jc=["repeat-x","repeat-y","repeat","space","round","no-repeat"],th=["center","top","bottom","left","right"];function eh(t){return th.includes(t)}const ih=["fixed","scroll","local"];function nh(t){return ih.includes(t)}const oh=/^url\(/;function rh(t){return oh.test(t)}function sh(t=""){if(""===t)return{top:void 0,right:void 0,bottom:void 0,left:void 0};const e=lh(t),i=e[0],n=e[1]||i;return{top:i,bottom:e[2]||i,right:n,left:e[3]||n}}function ah({top:t,right:e,bottom:i,left:n}){const o=[];return n!==e?o.push(t,e,i,n):i!==t?o.push(t,e,i):e!==t?o.push(t,e):o.push(t),o.join(" ")}function lh(t){return t.replace(/, /g,",").split(" ").map(t=>t.replace(/,/g,", "))}function ch(t){t.setNormalizer("background",hh),t.setNormalizer("background-color",t=>({path:"background.color",value:t})),t.setReducer("background",t=>{const e=[];return e.push(["background-color",t.color]),e}),t.setStyleRelation("background",["background-color"])}function hh(t){const e={},i=lh(t);for(const n of i)Jc.includes(n)?(e.repeat=e.repeat||[],e.repeat.push(n)):eh(n)?(e.position=e.position||[],e.position.push(n)):nh(n)?e.attachment=n:Xc(n)?e.color=n:rh(n)&&(e.image=n);return{path:"background",value:e}}function dh(t){t.setNormalizer("margin",t=>({path:"margin",value:sh(t)})),t.setNormalizer("margin-top",t=>({path:"margin.top",value:t})),t.setNormalizer("margin-right",t=>({path:"margin.right",value:t})),t.setNormalizer("margin-bottom",t=>({path:"margin.bottom",value:t})),t.setNormalizer("margin-left",t=>({path:"margin.left",value:t})),t.setReducer("margin",function(t){return e=>{const{top:i,right:n,bottom:o,left:r}=e,s=[];return[i,n,r,o].every(t=>!!t)?s.push([t,ah(e)]):(i&&s.push([t+"-top",i]),n&&s.push([t+"-right",n]),o&&s.push([t+"-bottom",o]),r&&s.push([t+"-left",r])),s}}("margin")),t.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}class uh extends el{constructor(t,e){super(t),this.view=e}init(){const t=this.view,e=this.editor.editing.view,i=t.editable,n=e.document.getRoot();t.editable.name=n.rootName,t.render();const o=i.element;this.setEditableElement(i.name,o),this.focusTracker.add(o),t.editable.bind("isFocused").to(this.focusTracker),e.attachDomRoot(o),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){const t=this.view;this.editor.editing.view.detachDomRoot(t.editable.name),t.destroy(),super.destroy()}_initToolbar(){const t=this.editor,e=this.view.toolbar;e.fillFromConfig(t.config.get("toolbar"),this.componentFactory),function({origin:t,originKeystrokeHandler:e,originFocusTracker:i,toolbar:n,beforeFocus:o,afterBlur:r}){i.add(n.element),e.set("Alt+F10",(t,e)=>{i.isFocused&&!n.focusTracker.isFocused&&(o&&o(),n.focus(),e())}),n.keystrokes.set("Esc",(e,i)=>{n.focusTracker.isFocused&&(t.focus(),r&&r(),i())})}({origin:t.editing.view,originFocusTracker:this.focusTracker,originKeystrokeHandler:t.keystrokes,toolbar:e})}_initPlaceholder(){const t=this.editor,e=t.editing.view,i=e.document.getRoot(),n=t.sourceElement,o=t.config.get("placeholder")||n&&"textarea"===n.tagName.toLowerCase()&&n.getAttribute("placeholder");o&&Tc({view:e,element:i,text:o,isDirectHost:!1,keepOnFocus:!0})}}class fh extends sc{constructor(t,e,i={}){super(t),this.toolbar=new Xl(t,{shouldGroupWhenFull:i.shouldToolbarGroupWhenFull}),this.editable=new cc(t,e,i.editableElement),this.toolbar.extendTemplate({attributes:{class:["ck-reset_all","ck-rounded-corners"],dir:t.uiLanguageDirection}})}render(){super.render(),this.registerChild([this.toolbar,this.editable])}}class ph extends Qa{constructor(t,e){super(e),Ye(t)&&(this.sourceElement=t,function(t){const e=t.sourceElement;if(e){if(e.ckeditorInstance)throw new a.a("editor-source-element-already-used",t);e.ckeditorInstance=t,t.once("destroy",()=>{delete e.ckeditorInstance})}}(this)),this.model.document.createRoot();const i=!this.config.get("toolbar.shouldNotGroupWhenFull"),n=new fh(this.locale,this.editing.view,{editableElement:this.sourceElement,shouldToolbarGroupWhenFull:i});this.ui=new uh(this,n)}destroy(){const t=this.getData();return this.ui.destroy(),super.destroy().then(()=>{this.sourceElement&&function(t,e){t instanceof HTMLTextAreaElement&&(t.value=e),t.innerHTML=e}(this.sourceElement,t)})}static create(t,e={}){return new Promise(i=>{const n=Ye(t);if(n&&"TEXTAREA"===t.tagName)throw new a.a("editor-wrong-element",null);const o=new this(t,e);i(o.initPlugins().then(()=>{o.ui.init()}).then(()=>{if(!n&&e.initialData)throw new a.a("editor-create-initial-data",null);const i=void 0!==e.initialData?e.initialData:function(t){return Ye(t)?(e=t)instanceof HTMLTextAreaElement?e.value:e.innerHTML:t;var e}(t);return o.data.init(i)}).then(()=>o.fire("ready")).then(()=>o))})}}Pt(ph,il);class gh{constructor(t){this.files=function(t){const e=Array.from(t.files||[]),i=Array.from(t.items||[]);return e.length?e:i.filter(t=>"file"===t.kind).map(t=>t.getAsFile())}(t),this._native=t}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,e){this._native.setData(t,e)}set effectAllowed(t){this._native.effectAllowed=t}get effectAllowed(){return this._native.effectAllowed}set dropEffect(t){this._native.dropEffect=t}get dropEffect(){return this._native.dropEffect}get isCanceled(){return"none"==this._native.dropEffect||!!this._native.mozUserCancelled}}class mh extends Bo{constructor(t){super(t);const e=this.document;function i(t){return(i,o)=>{o.preventDefault();const r=o.dropRange?[o.dropRange]:null,s=new n(e,t);e.fire(s,{dataTransfer:o.dataTransfer,method:i.name,targetRanges:r,target:o.target}),s.stop.called&&o.stopPropagation()}}this.domEventType=["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"],this.listenTo(e,"paste",i("clipboardInput"),{priority:"low"}),this.listenTo(e,"drop",i("clipboardInput"),{priority:"low"}),this.listenTo(e,"dragover",i("dragging"),{priority:"low"})}onDomEvent(t){const e={dataTransfer:new gh(t.clipboardData?t.clipboardData:t.dataTransfer)};"drop"!=t.type&&"dragover"!=t.type||(e.dropRange=function(t,e){const i=e.target.ownerDocument,n=e.clientX,o=e.clientY;let r;return i.caretRangeFromPoint&&i.caretRangeFromPoint(n,o)?r=i.caretRangeFromPoint(n,o):e.rangeParent&&(r=i.createRange(),r.setStart(e.rangeParent,e.rangeOffset),r.collapse(!0)),r?t.domConverter.domRangeToView(r):null}(this.view,t)),this.fire(t.type,t,e)}}const vh=["figcaption","li"];class yh extends Mt{static get pluginName(){return"ClipboardPipeline"}init(){this.editor.editing.view.addObserver(mh),this._setupPasteDrop(),this._setupCopyCut()}_setupPasteDrop(){const t=this.editor,e=t.model,i=t.editing.view,o=i.document;this.listenTo(o,"clipboardInput",e=>{t.isReadOnly&&e.stop()},{priority:"highest"}),this.listenTo(o,"clipboardInput",(t,e)=>{const o=e.dataTransfer;let r=e.content||"";var s;r||(o.getData("text/html")?r=function(t){return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>1==e.length?" ":e).replace(/<!--[\s\S]*?-->/g,"")}(o.getData("text/html")):o.getData("text/plain")&&(((s=(s=o.getData("text/plain")).replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;")).includes("</p><p>")||s.includes("<br>"))&&(s=`<p>${s}</p>`),r=s),r=this.editor.data.htmlProcessor.toView(r));const a=new n(this,"inputTransformation");this.fire(a,{content:r,dataTransfer:o,targetRanges:e.targetRanges,method:e.method}),a.stop.called&&t.stop(),i.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(t,i)=>{if(i.content.isEmpty)return;const n=this.editor.data.toModel(i.content,"$clipboardHolder");0!=n.childCount&&(t.stop(),e.change(()=>{this.fire("contentInsertion",{content:n,method:i.method,dataTransfer:i.dataTransfer,targetRanges:i.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(t,i)=>{i.resultRange=e.insertContent(i.content)},{priority:"low"})}_setupCopyCut(){const t=this.editor,e=t.model.document,i=t.editing.view.document;function n(n,o){const r=o.dataTransfer;o.preventDefault();const s=t.data.toView(t.model.getSelectedContent(e.selection));i.fire("clipboardOutput",{dataTransfer:r,content:s,method:n.name})}this.listenTo(i,"copy",n,{priority:"low"}),this.listenTo(i,"cut",(e,i)=>{t.isReadOnly?i.preventDefault():n(e,i)},{priority:"low"}),this.listenTo(i,"clipboardOutput",(i,n)=>{n.content.isEmpty||(n.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(n.content)),n.dataTransfer.setData("text/plain",function t(e){let i="";if(e.is("$text")||e.is("$textProxy"))i=e.data;else if(e.is("element","img")&&e.hasAttribute("alt"))i=e.getAttribute("alt");else if(e.is("element","br"))i="\n";else{let n=null;for(const o of e.getChildren()){const e=t(o);n&&(n.is("containerElement")||o.is("containerElement"))&&(vh.includes(n.name)||vh.includes(o.name)?i+="\n":i+="\n\n"),i+=e,n=o}}return i}(n.content))),"cut"==n.method&&t.model.deleteContent(e.selection)},{priority:"low"})}}function*bh(t,e){for(const i of e)i&&t.getAttributeProperties(i[0]).copyOnEnter&&(yield i)}class wh extends Nt{execute(){const t=this.editor.model,e=t.document;t.change(i=>{!function(t,e,i,n){const o=i.isCollapsed,r=i.getFirstRange(),s=r.start.parent,a=r.end.parent;if(n.isLimit(s)||n.isLimit(a))o||s!=a||t.deleteContent(i);else if(o){const t=bh(e.model.schema,i.getAttributes());kh(e,r.start),e.setSelectionAttribute(t)}else{const n=!(r.start.isAtStart&&r.end.isAtEnd),o=s==a;t.deleteContent(i,{leaveUnmerged:n}),n&&(o?kh(e,i.focus):e.setSelection(a,0))}}(this.editor.model,i,e.selection,t.schema),this.fire("afterExecute",{writer:i})})}}function kh(t,e){t.split(e),t.setSelection(e.parent.nextSibling,0)}class _h extends xo{constructor(t){super(t);const e=this.document;e.on("keydown",(t,i)=>{if(this.isEnabled&&i.keyCode==_n.enter){const n=new Ji(e,"enter",e.selection.getFirstRange());e.fire(n,new Lo(e,i.domEvent,{isSoft:i.shiftKey})),n.stop.called&&t.stop()}})}observe(){}}class xh extends Mt{static get pluginName(){return"Enter"}init(){const t=this.editor,e=t.editing.view,i=e.document;e.addObserver(_h),t.commands.add("enter",new wh(t)),this.listenTo(i,"enter",(i,n)=>{n.preventDefault(),n.isSoft||(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"})}}class Ch{constructor(t,e=20){this.model=t,this.size=0,this.limit=e,this.isLocked=!1,this._changeCallback=(t,e)=>{"transparent"!=e.type&&e!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch()),this._batch}input(t){this.size+=t,this.size>=this.limit&&this._reset(!0)}lock(){this.isLocked=!0}unlock(){this.isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t){this.isLocked&&!t||(this._batch=null,this.size=0)}}class Eh extends Nt{constructor(t,e){super(t),this.direction=e,this._buffer=new Ch(t.model,t.config.get("typing.undoStep"))}get buffer(){return this._buffer}execute(t={}){const e=this.editor.model,i=e.document;e.enqueueChange(this._buffer.batch,n=>{this._buffer.lock();const o=n.createSelection(t.selection||i.selection),r=t.sequence||1,s=o.isCollapsed;if(o.isCollapsed&&e.modifySelection(o,{direction:this.direction,unit:t.unit}),this._shouldEntireContentBeReplacedWithParagraph(r))return void this._replaceEntireContentWithParagraph(n);if(this._shouldReplaceFirstBlockWithParagraph(o,r))return void this.editor.execute("paragraph",{selection:o});if(o.isCollapsed)return;let a=0;o.getFirstRange().getMinimalFlatRanges().forEach(t=>{a+=Xi(t.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),e.deleteContent(o,{doNotResetEntireContent:s,direction:this.direction}),this._buffer.input(a),n.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(t){if(t>1)return!1;const e=this.editor.model,i=e.document.selection,n=e.schema.getLimitElement(i);if(!i.isCollapsed||!i.containsEntireContent(n))return!1;if(!e.schema.checkChild(n,"paragraph"))return!1;const o=n.getChild(0);return!o||"paragraph"!==o.name}_replaceEntireContentWithParagraph(t){const e=this.editor.model,i=e.schema.getLimitElement(e.document.selection),n=t.createElement("paragraph");t.remove(t.createRangeIn(i)),t.insert(n,i),t.setSelection(n,0)}_shouldReplaceFirstBlockWithParagraph(t,e){const i=this.editor.model;if(e>1||"backward"!=this.direction)return!1;if(!t.isCollapsed)return!1;const n=t.getFirstPosition(),o=i.schema.getLimitElement(n),r=o.getChild(0);return n.parent==r&&!!t.containsEntireContent(r)&&!!i.schema.checkChild(o,"paragraph")&&"paragraph"!=r.name}}class Th extends xo{constructor(t){super(t);const e=t.document;let i=0;function n(t,i,n){const o=new Ji(e,"delete",e.selection.getFirstRange());e.fire(o,new Lo(e,i,n)),o.stop.called&&t.stop()}e.on("keyup",(t,e)=>{e.keyCode!=_n.delete&&e.keyCode!=_n.backspace||(i=0)}),e.on("keydown",(t,e)=>{const o={};if(e.keyCode==_n.delete)o.direction="forward",o.unit="character";else{if(e.keyCode!=_n.backspace)return;o.direction="backward",o.unit="codePoint"}o.unit=(pn?e.altKey:e.ctrlKey)?"word":o.unit,o.sequence=++i,n(t,e.domEvent,o)}),vn&&e.on("beforeinput",(e,i)=>{if("deleteContentBackward"!=i.domEvent.inputType)return;const o={unit:"codepoint",direction:"backward",sequence:1},r=i.domTarget.ownerDocument.defaultView.getSelection();r.anchorNode==r.focusNode&&r.anchorOffset+1!=r.focusOffset&&(o.selectionToRemove=t.domConverter.domSelectionToView(r)),n(e,i.domEvent,o)})}observe(){}}class Sh extends Mt{static get pluginName(){return"Delete"}init(){const t=this.editor,e=t.editing.view,i=e.document,n=t.model.document;e.addObserver(Th),this._undoOnBackspace=!1;const o=new Eh(t,"forward");if(t.commands.add("deleteForward",o),t.commands.add("forwardDelete",o),t.commands.add("delete",new Eh(t,"backward")),this.listenTo(i,"delete",(i,n)=>{const o={unit:n.unit,sequence:n.sequence};if(n.selectionToRemove){const e=t.model.createSelection(),i=[];for(const o of n.selectionToRemove.getRanges())i.push(t.editing.mapper.toModelRange(o));e.setTo(i),o.selection=e}t.execute("forward"==n.direction?"deleteForward":"delete",o),n.preventDefault(),e.scrollToTheSelection()},{priority:"low"}),vn){let t=null;this.listenTo(i,"delete",(e,i)=>{const n=i.domTarget.ownerDocument.defaultView.getSelection();t={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}},{priority:"lowest"}),this.listenTo(i,"keyup",(e,i)=>{if(t){const e=i.domTarget.ownerDocument.defaultView.getSelection();e.collapse(t.anchorNode,t.anchorOffset),e.extend(t.focusNode,t.focusOffset),t=null}})}this.editor.plugins.has("UndoEditing")&&(this.listenTo(i,"delete",(e,i)=>{this._undoOnBackspace&&"backward"==i.direction&&1==i.sequence&&"codePoint"==i.unit&&(this._undoOnBackspace=!1,t.execute("undo"),i.preventDefault(),e.stop())},{context:"$capture"}),this.listenTo(n,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class Ah{constructor(){this._stack=[]}add(t,e){const i=this._stack,n=i[0];this._insertDescriptor(t);const o=i[0];n===o||Oh(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:e})}remove(t,e){const i=this._stack,n=i[0];this._removeDescriptor(t);const o=i[0];n===o||Oh(n,o)||this.fire("change:top",{oldDescriptor:n,newDescriptor:o,writer:e})}_insertDescriptor(t){const e=this._stack,i=e.findIndex(e=>e.id===t.id);if(Oh(t,e[i]))return;i>-1&&e.splice(i,1);let n=0;for(;e[n]&&Ih(e[n],t);)n++;e.splice(n,0,t)}_removeDescriptor(t){const e=this._stack,i=e.findIndex(e=>e.id===t);i>-1&&e.splice(i,1)}}function Oh(t,e){return t&&e&&t.priority==e.priority&&Ph(t.classes)==Ph(e.classes)}function Ih(t,e){return t.priority>e.priority||!(t.priority<e.priority)&&Ph(t.classes)>Ph(e.classes)}function Ph(t){return Array.isArray(t)?t.sort().join(","):t}function Mh(t){return!!t.is("element")&&!!t.getCustomProperty("widget")}function Dh(t,e,i={}){if(!t.is("containerElement"))throw new a.a("widget-to-widget-wrong-element-type",null,{element:t});return e.setAttribute("contenteditable","false",t),e.addClass("ck-widget",t),e.setCustomProperty("widget",!0,t),t.getFillerOffset=jh,i.label&&function(t,e,i){i.setCustomProperty("widgetLabel",e,t)}(t,i.label,e),i.hasSelectionHandle&&function(t,e){const i=e.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(t){const e=this.toDomElement(t),i=new Pl;return i.set("content",'<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>'),i.render(),e.appendChild(i.element),e});e.insert(e.createPositionAt(t,0),i),e.addClass(["ck-widget_with-selection-handle"],t)}(t,e),zh(t,e),t}function Nh(t,e,i){if(e.classes&&i.addClass(Je(e.classes),t),e.attributes)for(const n in e.attributes)i.setAttribute(n,e.attributes[n],t)}function Rh(t,e,i){if(e.classes&&i.removeClass(Je(e.classes),t),e.attributes)for(const n in e.attributes)i.removeAttribute(n,t)}function zh(t,e,i=Nh,n=Rh){const o=new Ah;o.on("change:top",(e,o)=>{o.oldDescriptor&&n(t,o.oldDescriptor,o.writer),o.newDescriptor&&i(t,o.newDescriptor,o.writer)}),e.setCustomProperty("addHighlight",(t,e,i)=>o.add(e,i),t),e.setCustomProperty("removeHighlight",(t,e,i)=>o.remove(e,i),t)}function Fh(t){const e=t.getCustomProperty("widgetLabel");return e?"function"==typeof e?e():e:""}function Lh(t,e){return e.addClass(["ck-editor__editable","ck-editor__nested-editable"],t),e.setAttribute("contenteditable",t.isReadOnly?"false":"true",t),t.on("change:isReadOnly",(i,n,o)=>{e.setAttribute("contenteditable",o?"false":"true",t)}),t.on("change:isFocused",(i,n,o)=>{o?e.addClass("ck-editor__nested-editable_focused",t):e.removeClass("ck-editor__nested-editable_focused",t)}),zh(t,e),t}function Bh(t,e){const i=t.getSelectedElement();if(i){const n=Hh(t);if(n)return e.createRange(e.createPositionAt(i,n));if(e.schema.isObject(i)&&!e.schema.isInline(i))return e.createRangeOn(i)}const n=t.getSelectedBlocks().next().value;if(n){if(n.isEmpty)return e.createRange(e.createPositionAt(n,0));const i=e.createPositionAfter(n);return t.focus.isTouching(i)?e.createRange(i):e.createRange(e.createPositionBefore(n))}return e.createRange(t.focus)}function jh(){return null}function Vh(t,e,i){return t&&Mh(t)&&!i.isInline(e)}function Hh(t){return t.getAttribute("widget-type-around")}Pt(Ah,h);const Wh=[Cn("arrowUp"),Cn("arrowRight"),Cn("arrowDown"),Cn("arrowLeft"),9,16,17,18,19,20,27,33,34,35,36,45,91,93,144,145,173,174,175,176,177,178,179,255];for(let My=112;My<=135;My++)Wh.push(My);function qh(t){return!(!t.ctrlKey&&!t.metaKey)||Wh.includes(t.keyCode)}i(63);const Uh=["before","after"],Yh=(new DOMParser).parseFromString('<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>',"image/svg+xml").firstChild;class Gh extends Mt{static get pluginName(){return"WidgetTypeAround"}static get requires(){return[xh,Sh]}constructor(t){super(t),this._currentFakeCaretModelElement=null}init(){const t=this.editor,e=t.editing.view;this.on("change:isEnabled",(i,n,o)=>{e.change(t=>{for(const i of e.document.roots)o?t.removeClass("ck-widget__type-around_disabled",i):t.addClass("ck-widget__type-around_disabled",i)}),o||t.model.change(t=>{t.removeSelectionAttribute("widget-type-around")})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableDeleteContentIntegration()}destroy(){this._currentFakeCaretModelElement=null}_insertParagraph(t,e){const i=this.editor,n=i.editing.view;i.execute("insertParagraph",{position:i.model.createPositionAt(t,e)}),n.focus(),n.scrollToTheSelection()}_listenToIfEnabled(t,e,i,n){this.listenTo(t,e,(...t)=>{this.isEnabled&&i(...t)},n)}_insertParagraphAccordingToFakeCaretPosition(){const t=this.editor.model.document.selection,e=Hh(t);if(!e)return!1;const i=t.getSelectedElement();return this._insertParagraph(i,e),!0}_enableTypeAroundUIInjection(){const t=this.editor,e=t.model.schema,i=t.locale.t,n={before:i("Insert paragraph before block"),after:i("Insert paragraph after block")};t.editing.downcastDispatcher.on("insert",(t,i,o)=>{const r=o.mapper.toViewElement(i.item);Vh(r,i.item,e)&&function(t,e,i){const n=t.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(t){const i=this.toDomElement(t);return function(t,e){for(const i of Uh){const n=new dl({tag:"div",attributes:{class:["ck","ck-widget__type-around__button","ck-widget__type-around__button_"+i],title:e[i]},children:[t.ownerDocument.importNode(Yh,!0)]});t.appendChild(n.render())}}(i,e),function(t){const e=new dl({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});t.appendChild(e.render())}(i),i});t.insert(t.createPositionAt(i,"end"),n)}(o.writer,n,r)},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const t=this.editor,e=t.model,i=e.document.selection,n=e.schema;function o(t){return"ck-widget_type-around_show-fake-caret_"+t}this._listenToIfEnabled(t.editing.view.document,"arrowKey",(t,e)=>{this._handleArrowKeyPress(t,e)},{context:[Mh,"$text"],priority:"high"}),this._listenToIfEnabled(i,"change:range",(e,i)=>{i.directChange&&t.model.change(t=>{t.removeSelectionAttribute("widget-type-around")})}),this._listenToIfEnabled(e.document,"change:data",()=>{const e=i.getSelectedElement();e&&Vh(t.editing.mapper.toViewElement(e),e,n)||t.model.change(t=>{t.removeSelectionAttribute("widget-type-around")})}),this._listenToIfEnabled(t.editing.downcastDispatcher,"selection",(t,e,i)=>{const r=i.writer;if(this._currentFakeCaretModelElement){const t=i.mapper.toViewElement(this._currentFakeCaretModelElement);t&&(r.removeClass(Uh.map(o),t),this._currentFakeCaretModelElement=null)}const s=e.selection.getSelectedElement();if(!s)return;const a=i.mapper.toViewElement(s);if(!Vh(a,s,n))return;const l=Hh(e.selection);l&&(r.addClass(o(l),a),this._currentFakeCaretModelElement=s)}),this._listenToIfEnabled(t.ui.focusTracker,"change:isFocused",(e,i,n)=>{n||t.model.change(t=>{t.removeSelectionAttribute("widget-type-around")})})}_handleArrowKeyPress(t,e){const i=this.editor,n=i.model,o=n.document.selection,r=n.schema,s=i.editing.view,a=function(t,e){const i=Sn(t,e);return"down"===i||"right"===i}(e.keyCode,i.locale.contentLanguageDirection),l=s.document.selection.getSelectedElement();let c;Vh(l,i.editing.mapper.toModelElement(l),r)?c=this._handleArrowKeyPressOnSelectedWidget(a):o.isCollapsed?c=this._handleArrowKeyPressWhenSelectionNextToAWidget(a):e.shiftKey||(c=this._handleArrowKeyPressWhenNonCollapsedSelection(a)),c&&(e.preventDefault(),t.stop())}_handleArrowKeyPressOnSelectedWidget(t){const e=this.editor.model,i=Hh(e.document.selection);return e.change(e=>i?i!==(t?"after":"before")&&(e.removeSelectionAttribute("widget-type-around"),!0):(e.setSelectionAttribute("widget-type-around",t?"after":"before"),!0))}_handleArrowKeyPressWhenSelectionNextToAWidget(t){const e=this.editor,i=e.model,n=i.schema,o=e.plugins.get("Widget"),r=o._getObjectElementNextToSelection(t);return!!Vh(e.editing.mapper.toViewElement(r),r,n)&&(i.change(e=>{o._setSelectionOverElement(r),e.setSelectionAttribute("widget-type-around",t?"before":"after")}),!0)}_handleArrowKeyPressWhenNonCollapsedSelection(t){const e=this.editor,i=e.model,n=i.schema,o=e.editing.mapper,r=i.document.selection,s=t?r.getLastPosition().nodeBefore:r.getFirstPosition().nodeAfter;return!!Vh(o.toViewElement(s),s,n)&&(i.change(e=>{e.setSelection(s,"on"),e.setSelectionAttribute("widget-type-around",t?"after":"before")}),!0)}_enableInsertingParagraphsOnButtonClick(){const t=this.editor,e=t.editing.view;this._listenToIfEnabled(e.document,"mousedown",(i,n)=>{const o=n.domTarget.closest(".ck-widget__type-around__button");if(!o)return;const r=function(t){return t.classList.contains("ck-widget__type-around__button_before")?"before":"after"}(o),s=function(t,e){const i=t.closest(".ck-widget");return e.mapDomToView(i)}(o,e.domConverter),a=t.editing.mapper.toModelElement(s);this._insertParagraph(a,r),n.preventDefault(),i.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const t=this.editor,e=t.model.document.selection;this._listenToIfEnabled(t.editing.view.document,"enter",(i,n)=>{if("atTarget"!=i.eventPhase)return;const o=e.getSelectedElement(),r=t.editing.mapper.toViewElement(o),s=t.model.schema;let a;this._insertParagraphAccordingToFakeCaretPosition()?a=!0:Vh(r,o,s)&&(this._insertParagraph(o,n.isSoft?"before":"after"),a=!0),a&&(n.preventDefault(),i.stop())},{context:Mh})}_enableInsertingParagraphsOnTypingKeystroke(){const t=[_n.enter,_n.delete,_n.backspace];this._listenToIfEnabled(this.editor.editing.view.document,"keydown",(e,i)=>{t.includes(i.keyCode)||qh(i)||this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const t=this.editor,e=t.model,i=e.schema;this._listenToIfEnabled(t.editing.view.document,"delete",(n,o)=>{if("atTarget"!=n.eventPhase)return;const r=Hh(e.document.selection);if(!r)return;const s=o.direction,a=e.document.selection.getSelectedElement(),l="forward"==s;if("before"===r===l)t.execute("delete",{selection:e.createSelection(a,"on")});else{const n=i.getNearestSelectionRange(e.createPositionAt(a,r),s);if(n)if(n.isCollapsed){const o=e.createSelection(n.start);if(e.modifySelection(o,{direction:s}),o.focus.isEqual(n.start)){const t=function(t,e){let i=e;for(const n of e.getAncestors({parentFirst:!0})){if(n.childCount>1||t.isLimit(n))break;i=n}return i}(i,n.start.parent);e.deleteContent(e.createSelection(t,"on"),{doNotAutoparagraph:!0})}else e.change(e=>{e.setSelection(n),t.execute(l?"deleteForward":"delete")})}else e.change(e=>{e.setSelection(n),t.execute(l?"deleteForward":"delete")})}o.preventDefault(),n.stop()},{context:Mh})}_enableInsertContentIntegration(){const t=this.editor.model,e=t.document.selection;this._listenToIfEnabled(this.editor.model,"insertContent",(i,[n,o])=>{if(o&&!o.is("documentSelection"))return;const r=Hh(e);return r?(i.stop(),t.change(i=>{const o=e.getSelectedElement(),s=t.createPositionAt(o,r),a=i.createSelection(s),l=t.insertContent(n,a);return i.setSelection(a),l})):void 0},{priority:"high"})}_enableDeleteContentIntegration(){const t=this.editor.model.document.selection;this._listenToIfEnabled(this.editor.model,"deleteContent",(e,[i])=>{i&&!i.is("documentSelection")||Hh(t)&&e.stop()},{priority:"high"})}}function Zh(t,e,i){const n=t.schema,o=t.createRangeIn(e.root),r="forward"==i?"elementStart":"elementEnd";for(const{previousPosition:s,item:a,type:l}of o.getWalker({startPosition:e,direction:i})){if(n.isLimit(a)&&!n.isInline(a))return s;if(l==r&&n.isBlock(a))return null}return null}function $h(t,e,i){const n="backward"==i?e.end:e.start;if(t.checkChild(n,"$text"))return n;for(const{nextPosition:o}of e.getWalker({direction:i}))if(t.checkChild(o,"$text"))return o;return null}i(65);class Xh extends Mt{static get pluginName(){return"Widget"}static get requires(){return[Gh,Sh]}init(){const t=this.editor,e=t.editing.view,i=e.document;this._previouslySelected=new Set,this.editor.editing.downcastDispatcher.on("selection",(e,i,n)=>{const o=n.writer,r=i.selection;if(r.isCollapsed)return;const s=r.getSelectedElement();if(!s)return;const a=t.editing.mapper.toViewElement(s);Mh(a)&&n.consumable.consume(r,"selection")&&o.setSelection(o.createRangeOn(a),{fake:!0,label:Fh(a)})}),this.editor.editing.downcastDispatcher.on("selection",(t,e,i)=>{this._clearPreviouslySelectedWidgets(i.writer);const n=i.writer,o=n.document.selection;let r=null;for(const s of o.getRanges())for(const t of s){const e=t.item;Mh(e)&&!Kh(e,r)&&(n.addClass("ck-widget_selected",e),this._previouslySelected.add(e),r=e)}},{priority:"low"}),e.addObserver(Hc),this.listenTo(i,"mousedown",(...t)=>this._onMousedown(...t)),this.listenTo(i,"arrowKey",(...t)=>{this._handleSelectionChangeOnArrowKeyPress(...t)},{context:[Mh,"$text"]}),this.listenTo(i,"arrowKey",(...t)=>{this._preventDefaultOnArrowKeyPress(...t)},{context:"$root"}),this.listenTo(i,"arrowKey",function(t){const e=t.model;return(i,n)=>{const o=n.keyCode==_n.arrowdown,r=n.shiftKey,s=e.document.selection;if(n.keyCode!=_n.arrowup&&!o)return;const a=o;if(r&&function(t,e){return!t.isCollapsed&&t.isBackward==e}(s,a))return;const l=function(t,e,i){const n=t.model;if(i){const t=e.isCollapsed?e.focus:e.getLastPosition(),i=Zh(n,t,"forward");if(!i)return null;const o=n.createRange(t,i),r=$h(n.schema,o,"backward");return r?n.createRange(t,r):null}{const t=e.isCollapsed?e.focus:e.getFirstPosition(),i=Zh(n,t,"backward");if(!i)return null;const o=n.createRange(i,t),r=$h(n.schema,o,"forward");return r?n.createRange(r,t):null}}(t,s,a);if(l){if(l.isCollapsed){if(s.isCollapsed)return;if(r)return}(l.isCollapsed||function(t,e,i){const n=t.model,o=t.view.domConverter;if(i){const t=n.createSelection(e.start);n.modifySelection(t),t.focus.isAtEnd||e.start.isEqual(t.focus)||(e=n.createRange(t.focus,e.end))}const r=t.mapper.toViewRange(e),s=o.viewRangeToDom(r),a=ar.getDomRangeRects(s);let l;for(const c of a)if(void 0!==l){if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}else l=Math.round(c.bottom);return!0}(t,l,a))&&(e.change(t=>{const i=a?l.end:l.start;if(r){const n=e.createSelection(s.anchor);n.setFocus(i),t.setSelection(n)}else t.setSelection(i)}),i.stop(),n.preventDefault(),n.stopPropagation())}}}(this.editor.editing),{context:"$text"}),this.listenTo(i,"delete",(t,e)=>{this._handleDelete("forward"==e.direction)&&(e.preventDefault(),t.stop())},{context:"$root"})}_onMousedown(t,e){const i=this.editor,n=i.editing.view,o=n.document;let r=e.target;if(function(t){for(;t;){if(t.is("editableElement")&&!t.is("rootElement"))return!0;if(Mh(t))return!1;t=t.parent}return!1}(r)){if((mn||gn)&&e.domEvent.detail>=3){const t=i.editing.mapper,n=r.is("attributeElement")?r.findAncestor(t=>!t.is("attributeElement")):r,o=t.toModelElement(n);e.preventDefault(),this.editor.model.change(t=>{t.setSelection(o,"in")})}return}if(!Mh(r)&&(r=r.findAncestor(Mh),!r))return;vn&&e.preventDefault(),o.isFocused||n.focus();const s=i.editing.mapper.toModelElement(r);this._setSelectionOverElement(s)}_handleSelectionChangeOnArrowKeyPress(t,e){const i=e.keyCode,n=this.editor.model,o=n.schema,r=n.document.selection,s=r.getSelectedElement(),a=Sn(i,this.editor.locale.contentLanguageDirection),l="down"==a||"right"==a,c="up"==a||"down"==a;if(s&&o.isObject(s)){const i=l?r.getLastPosition():r.getFirstPosition(),s=o.getNearestSelectionRange(i,l?"forward":"backward");return void(s&&(n.change(t=>{t.setSelection(s)}),e.preventDefault(),t.stop()))}if(!r.isCollapsed&&!e.shiftKey){const i=r.getFirstPosition(),s=r.getLastPosition(),a=i.nodeAfter,c=s.nodeBefore;return void((a&&o.isObject(a)||c&&o.isObject(c))&&(n.change(t=>{t.setSelection(l?s:i)}),e.preventDefault(),t.stop()))}if(!r.isCollapsed)return;const h=this._getObjectElementNextToSelection(l);if(h&&o.isObject(h)){if(o.isInline(h)&&c)return;this._setSelectionOverElement(h),e.preventDefault(),t.stop()}}_preventDefaultOnArrowKeyPress(t,e){const i=this.editor.model,n=i.schema,o=i.document.selection.getSelectedElement();o&&n.isObject(o)&&(e.preventDefault(),t.stop())}_handleDelete(t){if(this.editor.isReadOnly)return;const e=this.editor.model.document.selection;if(!e.isCollapsed)return;const i=this._getObjectElementNextToSelection(t);return i?(this.editor.model.change(t=>{let n=e.anchor.parent;for(;n.isEmpty;){const e=n;n=e.parent,t.remove(e)}this._setSelectionOverElement(i)}),!0):void 0}_setSelectionOverElement(t){this.editor.model.change(e=>{e.setSelection(e.createRangeOn(t))})}_getObjectElementNextToSelection(t){const e=this.editor.model,i=e.schema,n=e.document.selection,o=e.createSelection(n);if(e.modifySelection(o,{direction:t?"forward":"backward"}),o.isEqual(n))return null;const r=t?o.focus.nodeBefore:o.focus.nodeAfter;return r&&i.isObject(r)?r:null}_clearPreviouslySelectedWidgets(t){for(const e of this._previouslySelected)t.removeClass("ck-widget_selected",e);this._previouslySelected.clear()}}function Kh(t,e){return!!e&&Array.from(t.getAncestors()).includes(e)}var Qh=function(t,e,i){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return y(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),Ko(t,e,{leading:n,maxWait:e,trailing:o})};i(67);class Jh extends Mt{static get pluginName(){return"DragDrop"}static get requires(){return[yh,Xh]}init(){const t=this.editor,e=t.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,this._updateDropMarkerThrottled=Qh(t=>this._updateDropMarker(t),40),this._removeDropMarkerDelayed=id(()=>this._removeDropMarker(),40),this._clearDraggableAttributesDelayed=id(()=>this._clearDraggableAttributes(),40),e.addObserver(mh),e.addObserver(Hc),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDropMarker(),this._setupDraggableAttributeHandling(),this.listenTo(t,"change:isReadOnly",(t,e,i)=>{i?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(t,e,i)=>{i||this._finalizeDragging(!1)}),vn&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._updateDropMarkerThrottled.cancel(),this._removeDropMarkerDelayed.cancel(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const t=this.editor,e=t.model,i=e.document,n=t.editing.view,o=n.document;this.listenTo(o,"dragstart",(n,s)=>{const a=i.selection;if(s.target&&s.target.is("editableElement"))return void s.preventDefault();const l=s.target?nd(s.target):null;if(l){const i=t.editing.mapper.toModelElement(l);this._draggedRange=Qr.fromRange(e.createRangeOn(i)),t.plugins.has("WidgetToolbarRepository")&&t.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop")}else if(!o.selection.isCollapsed){const t=o.selection.getSelectedElement();t&&Mh(t)||(this._draggedRange=Qr.fromRange(a.getFirstRange()))}if(!this._draggedRange)return void s.preventDefault();this._draggingUid=r(),s.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",s.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const c=e.createSelection(this._draggedRange.toRange()),h=t.data.toView(e.getSelectedContent(c));o.fire("clipboardOutput",{dataTransfer:s.dataTransfer,content:h,method:n.name}),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(o,"dragend",(t,e)=>{this._finalizeDragging(!e.dataTransfer.isCanceled&&"move"==e.dataTransfer.dropEffect)},{priority:"low"}),this.listenTo(o,"dragenter",()=>{this.isEnabled&&n.focus()}),this.listenTo(o,"dragleave",()=>{this._removeDropMarkerDelayed()}),this.listenTo(o,"dragging",(e,i)=>{if(!this.isEnabled)return void(i.dataTransfer.dropEffect="none");this._removeDropMarkerDelayed.cancel();const n=td(t,i.targetRanges,i.target);this._draggedRange||(i.dataTransfer.dropEffect="copy"),gn||("copy"==i.dataTransfer.effectAllowed?i.dataTransfer.dropEffect="copy":["all","copyMove"].includes(i.dataTransfer.effectAllowed)&&(i.dataTransfer.dropEffect="move")),n&&this._updateDropMarkerThrottled(n)},{priority:"low"})}_setupClipboardInputIntegration(){const t=this.editor;this.listenTo(t.editing.view.document,"clipboardInput",(e,i)=>{if("drop"!=i.method)return;const n=td(t,i.targetRanges,i.target);return this._removeDropMarker(),n?(this._draggedRange&&this._draggingUid!=i.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),"move"==ed(i.dataTransfer)&&this._draggedRange&&this._draggedRange.containsRange(n,!0)?(this._finalizeDragging(!1),void e.stop()):void(i.targetRanges=[t.editing.mapper.toViewRange(n)])):(this._finalizeDragging(!1),void e.stop())},{priority:"high"})}_setupContentInsertionIntegration(){const t=this.editor.plugins.get(yh);t.on("contentInsertion",(t,e)=>{if(!this.isEnabled||"drop"!==e.method)return;const i=e.targetRanges.map(t=>this.editor.editing.mapper.toModelRange(t));this.editor.model.change(t=>t.setSelection(i))},{priority:"high"}),t.on("contentInsertion",(t,e)=>{if(!this.isEnabled||"drop"!==e.method)return;const i="move"==ed(e.dataTransfer);this._finalizeDragging((!e.resultRange||!e.resultRange.isCollapsed)&&i)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const t=this.editor,e=t.editing.view,i=e.document;this.listenTo(i,"mousedown",(n,o)=>{if(vn||!o)return;this._clearDraggableAttributesDelayed.cancel();let r=nd(o.target);if(yn&&!t.isReadOnly&&!r&&!i.selection.isCollapsed){const t=i.selection.getSelectedElement();t&&Mh(t)||(r=i.selection.editableElement)}r&&(e.change(t=>{t.setAttribute("draggable","true",r)}),this._draggableElement=t.editing.mapper.toModelElement(r))}),this.listenTo(i,"mouseup",()=>{vn||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const t=this.editor.editing;t.view.change(e=>{this._draggableElement&&"$graveyard"!=this._draggableElement.root.rootName&&e.removeAttribute("draggable",t.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_setupDropMarker(){const t=this.editor;t.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),t.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(e,{writer:i})=>{if(t.model.schema.checkChild(e.markerRange.start,"$text"))return i.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(t){const e=this.toDomElement(t);return e.innerHTML="&NoBreak;<span></span>&NoBreak;",e})}})}_updateDropMarker(t){const e=this.editor,i=e.model.markers;e.model.change(e=>{i.has("drop-target")?i.get("drop-target").getRange().isEqual(t)||e.updateMarker("drop-target",{range:t}):e.addMarker("drop-target",{range:t,usingOperation:!1,affectsData:!1})})}_removeDropMarker(){const t=this.editor.model;this._removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),t.markers.has("drop-target")&&t.change(t=>{t.removeMarker("drop-target")})}_finalizeDragging(t){const e=this.editor,i=e.model;this._removeDropMarker(),this._clearDraggableAttributes(),e.plugins.has("WidgetToolbarRepository")&&e.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._draggedRange&&(t&&this.isEnabled&&i.deleteContent(i.createSelection(this._draggedRange),{doNotAutoparagraph:!0}),this._draggedRange.detach(),this._draggedRange=null)}}function td(t,e,i){const n=t.model,o=t.editing.mapper;let r=null;const s=e?e[0].start:null;if(i.is("uiElement")&&(i=i.parent),r=function(t,e){const i=t.model,n=t.editing.mapper;if(Mh(e))return i.createRangeOn(n.toModelElement(e));if(!e.is("editableElement")){const t=e.findAncestor(t=>Mh(t)||t.is("editableElement"));if(Mh(t))return i.createRangeOn(n.toModelElement(t))}return null}(t,i),r)return r;const a=function(t,e){const i=t.editing.mapper,n=t.editing.view,o=i.toModelElement(e);if(o)return o;const r=n.createPositionBefore(e),s=i.findMappedViewAncestor(r);return i.toModelElement(s)}(t,i),l=s?o.toModelPosition(s):null;return l?(r=function(t,e,i){const n=t.model;if(!n.schema.checkChild(i,"$block"))return null;const o=n.createPositionAt(i,0),r=e.path.slice(0,o.path.length),s=n.createPositionFromPath(e.root,r).nodeAfter;return s&&n.schema.isObject(s)?n.createRangeOn(s):null}(t,l,a),r||(r=n.schema.getNearestSelectionRange(l,gn?"forward":"backward"),r||function(t,e){const i=t.model;for(;e;){if(i.schema.isObject(e))return i.createRangeOn(e);e=e.parent}}(t,l.parent))):function(t,e){const i=t.model,n=i.schema,o=i.createPositionAt(e,0);return n.getNearestSelectionRange(o,"forward")}(t,a)}function ed(t){return gn?t.dropEffect:["all","copyMove"].includes(t.effectAllowed)?"move":"copy"}function id(t,e){let i;function n(...o){n.cancel(),i=setTimeout(()=>t(...o),e)}return n.cancel=()=>{clearTimeout(i)},n}function nd(t){if(t.is("editableElement"))return null;if(t.hasClass("ck-widget__selection-handle"))return t.findAncestor(Mh);if(Mh(t))return t;const e=t.findAncestor(t=>Mh(t)||t.is("editableElement"));return Mh(e)?e:null}class od extends Mt{static get pluginName(){return"PastePlainText"}static get requires(){return[yh]}init(){const t=this.editor,e=t.model,i=t.editing.view,n=i.document,o=e.document.selection;let r=!1;i.addObserver(mh),this.listenTo(n,"keydown",(t,e)=>{r=e.shiftKey}),t.plugins.get(yh).on("contentInsertion",(t,i)=>{(r||function(t,e){if(t.childCount>1)return!1;const i=t.getChild(0);return!e.isObject(i)&&0==[...i.getAttributeKeys()].length}(i.content,e.schema))&&e.change(t=>{const n=Array.from(o.getAttributes()).filter(([t])=>e.schema.getAttributeProperties(t).isFormatting);o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0}),n.push(...o.getAttributes());const r=t.createRangeIn(i.content);for(const e of r.getItems())e.is("$textProxy")&&t.setAttributes(n,e)})})}}class rd extends Mt{static get pluginName(){return"Clipboard"}static get requires(){return[yh,Jh,od]}}class sd extends Nt{execute(){const t=this.editor.model,e=t.document;t.change(i=>{!function(t,e,i){const n=i.isCollapsed,o=i.getFirstRange(),r=o.end.parent,s=o.start.parent==r;if(n){const n=bh(t.schema,i.getAttributes());ad(t,e,o.end),e.removeSelectionAttribute(i.getAttributeKeys()),e.setSelectionAttribute(n)}else{const n=!(o.start.isAtStart&&o.end.isAtEnd);t.deleteContent(i,{leaveUnmerged:n}),s?ad(t,e,i.focus):n&&e.setSelection(r,0)}}(t,i,e.selection),this.fire("afterExecute",{writer:i})})}refresh(){const t=this.editor.model;this.isEnabled=function(t,e){if(e.rangeCount>1)return!1;const i=e.anchor;if(!i||!t.checkChild(i,"softBreak"))return!1;const n=e.getFirstRange(),o=n.start.parent,r=n.end.parent;return!ld(o,t)&&!ld(r,t)||o===r}(t.schema,t.document.selection)}}function ad(t,e,i){const n=e.createElement("softBreak");t.insertContent(n,i),e.setSelection(n,"after")}function ld(t,e){return!t.is("rootElement")&&(e.isLimit(t)||ld(t.parent,e))}class cd extends Mt{static get pluginName(){return"ShiftEnter"}init(){const t=this.editor,e=t.conversion,i=t.editing.view,n=i.document;t.model.schema.register("softBreak",{allowWhere:"$text",isInline:!0}),e.for("upcast").elementToElement({model:"softBreak",view:"br"}),e.for("downcast").elementToElement({model:"softBreak",view:(t,{writer:e})=>e.createEmptyElement("br")}),i.addObserver(_h),t.commands.add("shiftEnter",new sd(t)),this.listenTo(n,"enter",(e,n)=>{n.preventDefault(),n.isSoft&&(t.execute("shiftEnter"),i.scrollToTheSelection())},{priority:"low"})}}class hd extends Nt{constructor(t){super(t),this.affectsData=!1}execute(){const t=this.editor.model,e=t.document.selection;let i=t.schema.getLimitElement(e);if(e.containsEntireContent(i)||!dd(t.schema,i))do{if(i=i.parent,!i)return}while(!dd(t.schema,i));t.change(t=>{t.setSelection(i,"in")})}}function dd(t,e){return t.isLimit(e)&&(t.checkChild(e,"$text")||t.checkChild(e,"paragraph"))}const ud=En("Ctrl+A");class fd extends Mt{static get pluginName(){return"SelectAllEditing"}init(){const t=this.editor,e=t.editing.view.document;t.commands.add("selectAll",new hd(t)),this.listenTo(e,"keydown",(e,i)=>{Cn(i)===ud&&(t.execute("selectAll"),i.preventDefault())})}}class pd extends Mt{static get pluginName(){return"SelectAllUI"}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",e=>{const i=t.commands.get("selectAll"),n=new Dl(e);return n.set({label:(0,e.t)("Select all"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>',keystroke:"Ctrl+A",tooltip:!0}),n.bind("isOn","isEnabled").to(i,"value","isEnabled"),this.listenTo(n,"execute",()=>{t.execute("selectAll"),t.editing.view.focus()}),n})}}class gd extends Mt{static get requires(){return[fd,pd]}static get pluginName(){return"SelectAll"}}class md extends Nt{constructor(t,e){super(t),this._buffer=new Ch(t.model,e),this._batches=new WeakSet}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(t={}){const e=this.editor.model,i=e.document,n=t.text||"",o=n.length,r=t.range?e.createSelection(t.range):i.selection,s=t.resultRange;e.enqueueChange(this._buffer.batch,t=>{this._buffer.lock(),this._batches.add(this._buffer.batch),e.deleteContent(r),n&&e.insertContent(t.createText(n,i.selection.getAttributes()),r),s?t.setSelection(s):r.is("documentSelection")||t.setSelection(r),this._buffer.unlock(),this._buffer.input(o)})}}function vd(t){if(t.newChildren.length-t.oldChildren.length!=1)return;const e=function(t,e){const i=[];let n,o=0;return t.forEach(t=>{"equal"==t?(r(),o++):"insert"==t?(s("insert")?n.values.push(e[o]):(r(),n={type:"insert",index:o,values:[e[o]]}),o++):s("delete")?n.howMany++:(r(),n={type:"delete",index:o,howMany:1})}),r(),i;function r(){n&&(i.push(n),n=null)}function s(t){return n&&n.type==t}}(eo(t.oldChildren,t.newChildren,yd),t.newChildren);if(e.length>1)return;const i=e[0];return i.values[0]&&i.values[0].is("$text")?i:void 0}function yd(t,e){return t&&t.is("$text")&&e&&e.is("$text")?t.data===e.data:t===e}class bd{constructor(t){this.editor=t,this.editing=this.editor.editing}handle(t,e){if(function(t){if(0==t.length)return!1;for(const e of t)if("children"===e.type&&!vd(e))return!0;return!1}(t))this._handleContainerChildrenMutations(t,e);else for(const i of t)this._handleTextMutation(i,e),this._handleTextNodeInsertion(i)}_handleContainerChildrenMutations(t,e){const i=function(t){const e=t.map(t=>t.node).reduce((t,e)=>t.getCommonAncestor(e,{includeSelf:!0}));if(e)return e.getAncestors({includeSelf:!0,parentFirst:!0}).find(t=>t.is("containerElement")||t.is("rootElement"))}(t);if(!i)return;const n=this.editor.editing.view.domConverter.mapViewToDom(i),o=new mo(this.editor.editing.view.document),r=this.editor.data.toModel(o.domToView(n)).getChild(0),s=this.editor.editing.mapper.toModelElement(i);if(!s)return;const a=Array.from(r.getChildren()),l=Array.from(s.getChildren()),c=a[a.length-1],h=l[l.length-1],d=c&&c.is("element","softBreak"),u=h&&!h.is("element","softBreak");d&&u&&a.pop();const f=this.editor.model.schema;if(!wd(a,f)||!wd(l,f))return;const p=a.map(t=>t.is("$text")?t.data:"@").join("").replace(/\u00A0/g," "),g=l.map(t=>t.is("$text")?t.data:"@").join("").replace(/\u00A0/g," ");if(g===p)return;const m=eo(g,p),{firstChangeAt:v,insertions:y,deletions:b}=kd(m);let w=null;e&&(w=this.editing.mapper.toModelRange(e.getFirstRange()));const k=p.substr(v,y),_=this.editor.model.createRange(this.editor.model.createPositionAt(s,v),this.editor.model.createPositionAt(s,v+b));this.editor.execute("input",{text:k,range:_,resultRange:w})}_handleTextMutation(t,e){if("text"!=t.type)return;const i=t.newText.replace(/\u00A0/g," "),n=t.oldText.replace(/\u00A0/g," ");if(n===i)return;const o=eo(n,i),{firstChangeAt:r,insertions:s,deletions:a}=kd(o);let l=null;e&&(l=this.editing.mapper.toModelRange(e.getFirstRange()));const c=this.editing.view.createPositionAt(t.node,r),h=this.editing.mapper.toModelPosition(c),d=this.editor.model.createRange(h,h.getShiftedBy(a)),u=i.substr(r,s);this.editor.execute("input",{text:u,range:d,resultRange:l})}_handleTextNodeInsertion(t){if("children"!=t.type)return;const e=vd(t),i=this.editing.view.createPositionAt(t.node,e.index),n=this.editing.mapper.toModelPosition(i);this.editor.execute("input",{text:e.values[0].data.replace(/\u00A0/g," "),range:this.editor.model.createRange(n)})}}function wd(t,e){return t.every(t=>e.isInline(t))}function kd(t){let e=null,i=null;for(let r=0;r<t.length;r++)"equal"!=t[r]&&(e=null===e?r:e,i=r);let n=0,o=0;for(let r=e;r<=i;r++)"insert"!=t[r]&&n++,"delete"!=t[r]&&o++;return{insertions:o,deletions:n,firstChangeAt:e}}class _d extends Mt{static get pluginName(){return"Input"}init(){const t=this.editor,e=new md(t,t.config.get("typing.undoStep")||20);t.commands.add("input",e),function(t){let e=null;const i=t.model,n=t.editing.view,o=t.commands.get("input");function r(t){const r=i.document,a=n.document.isComposing,l=e&&e.isEqual(r.selection);e=null,o.isEnabled&&(qh(t)||r.selection.isCollapsed||a&&229===t.keyCode||!a&&229===t.keyCode&&l||s())}function s(){const t=o.buffer;t.lock();const e=t.batch;o._batches.add(e),i.enqueueChange(e,()=>{i.deleteContent(i.document.selection)}),t.unlock()}n.document.on(vn?"beforeinput":"keydown",(t,e)=>r(e),{priority:"lowest"}),n.document.on("compositionstart",function(){const t=i.document,e=1!==t.selection.rangeCount||t.selection.getFirstRange().isFlat;t.selection.isCollapsed||e||s()},{priority:"lowest"}),n.document.on("compositionend",()=>{e=i.createSelection(i.document.selection)},{priority:"lowest"})}(t),function(t){t.editing.view.document.on("mutations",(e,i,n)=>{new bd(t).handle(i,n)})}(t)}isInput(t){return this.editor.commands.get("input")._batches.has(t)}}class xd extends Mt{static get requires(){return[_d,Sh]}static get pluginName(){return"Typing"}}function Cd(t,e){let i=t.start;return{text:Array.from(t.getItems()).reduce((t,n)=>n.is("$text")||n.is("$textProxy")?t+n.data:(i=e.createPositionAfter(n),""),""),range:e.createRange(i,t.end)}}class Ed{constructor(t,e){this.model=t,this.testCallback=e,this.hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(t.document.selection),this.stopListening(t.document))}),this._startListening()}_startListening(){const t=this.model.document;this.listenTo(t.selection,"change:range",(e,{directChange:i})=>{i&&(t.selection.isCollapsed?this._evaluateTextBeforeSelection("selection"):this.hasMatch&&(this.fire("unmatched"),this.hasMatch=!1))}),this.listenTo(t,"change:data",(t,e)=>{"transparent"!=e.type&&this._evaluateTextBeforeSelection("data",{batch:e})})}_evaluateTextBeforeSelection(t,e={}){const i=this.model,n=i.document.selection,o=i.createRange(i.createPositionAt(n.focus.parent,0),n.focus),{text:r,range:s}=Cd(o,i),a=this.testCallback(r);if(!a&&this.hasMatch&&this.fire("unmatched"),this.hasMatch=!!a,a){const i=Object.assign(e,{text:r,range:s});"object"==typeof a&&Object.assign(i,a),this.fire("matched:"+t,i)}}}Pt(Ed,Et);class Td extends Mt{static get pluginName(){return"TwoStepCaretMovement"}constructor(t){super(t),this.attributes=new Set,this._overrideUid=null}init(){const t=this.editor,e=t.locale,i=t.model.document.selection;this.listenTo(t.editing.view.document,"arrowKey",(t,n)=>{if(!i.isCollapsed)return;if(n.shiftKey||n.altKey||n.ctrlKey)return;const o=n.keyCode==_n.arrowright,r=n.keyCode==_n.arrowleft;if(!o&&!r)return;const s=e.contentLanguageDirection;let a=!1;a="ltr"===s&&o||"rtl"===s&&r?this._handleForwardMovement(n):this._handleBackwardMovement(n),!0===a&&t.stop()},{context:"$text",priority:"highest"}),this._isNextGravityRestorationSkipped=!1,this.listenTo(i,"change:range",(t,e)=>{this._isNextGravityRestorationSkipped?this._isNextGravityRestorationSkipped=!1:this._isGravityOverridden&&(!e.directChange&&Id(i.getFirstPosition(),this.attributes)||this._restoreGravity())})}registerAttribute(t){this.attributes.add(t)}_handleForwardMovement(t){const e=this.attributes,i=this.editor.model.document.selection,n=i.getFirstPosition();return!this._isGravityOverridden&&(!n.isAtStart||!Sd(i,e))&&(Id(n,e)?(Od(t),this._overrideGravity(),!0):void 0)}_handleBackwardMovement(t){const e=this.attributes,i=this.editor.model,n=i.document.selection,o=n.getFirstPosition();return this._isGravityOverridden?(Od(t),this._restoreGravity(),Ad(i,e,o),!0):o.isAtStart?!!Sd(n,e)&&(Od(t),Ad(i,e,o),!0):function(t,e){return Id(t.getShiftedBy(-1),e)}(o,e)?o.isAtEnd&&!Sd(n,e)&&Id(o,e)?(Od(t),Ad(i,e,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):void 0}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(t=>t.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(t=>{t.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Sd(t,e){for(const i of e)if(t.hasAttribute(i))return!0;return!1}function Ad(t,e,i){const n=i.nodeBefore;t.change(t=>{n?t.setSelectionAttribute(n.getAttributes()):t.removeSelectionAttribute(e)})}function Od(t){t.preventDefault()}function Id(t,e){const{nodeBefore:i,nodeAfter:n}=t;for(const o of e){const t=i?i.getAttribute(o):void 0;if((n?n.getAttribute(o):void 0)!==t)return!0}return!1}var Pd=/[\\^$.*+?()[\]{}|]/g,Md=RegExp(Pd.source);const Dd={copyright:{from:"(c)",to:"\xa9"},registeredTrademark:{from:"(r)",to:"\xae"},trademark:{from:"(tm)",to:"\u2122"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"\xbd",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"\u2153",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"\u2154",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"\xbc",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"\xbe",null]},lessThanOrEqual:{from:"<=",to:"\u2264"},greaterThanOrEqual:{from:">=",to:"\u2265"},notEqual:{from:"!=",to:"\u2260"},arrowLeft:{from:"<-",to:"\u2190"},arrowRight:{from:"->",to:"\u2192"},horizontalEllipsis:{from:"...",to:"\u2026"},enDash:{from:/(^| )(--)( )$/,to:[null,"\u2013",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"\u2014",null]},quotesPrimary:{from:Bd('"'),to:[null,"\u201c",null,"\u201d"]},quotesSecondary:{from:Bd("'"),to:[null,"\u2018",null,"\u2019"]},quotesPrimaryEnGb:{from:Bd("'"),to:[null,"\u2018",null,"\u2019"]},quotesSecondaryEnGb:{from:Bd('"'),to:[null,"\u201c",null,"\u201d"]},quotesPrimaryPl:{from:Bd('"'),to:[null,"\u201e",null,"\u201d"]},quotesSecondaryPl:{from:Bd("'"),to:[null,"\u201a",null,"\u2019"]}},Nd={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},Rd=["symbols","mathematical","typography","quotes"];function zd(t){return"string"==typeof t?new RegExp(`(${function(t){return(t=Ei(t))&&Md.test(t)?t.replace(Pd,"\\$&"):t}(t)})$`):t}function Fd(t){return"string"==typeof t?()=>[t]:t instanceof Array?()=>t:t}function Ld(t){return(t.textNode?t.textNode:t.nodeAfter).getAttributes()}function Bd(t){return new RegExp(`(^|\\s)(${t})([^${t}]*)(${t})$`)}function jd(t,e,i,n){return n.createRange(Vd(t,e,i,!0,n),Vd(t,e,i,!1,n))}function Vd(t,e,i,n,o){let r=t.textNode||(n?t.nodeBefore:t.nodeAfter),s=null;for(;r&&r.getAttribute(e)==i;)s=r,r=n?r.previousSibling:r.nextSibling;return s?o.createPositionAt(s,n?"before":"after"):t}class Hd extends Nt{constructor(t){super(t),this._stack=[],this._createdBatches=new WeakSet,this.refresh(),this.listenTo(t.data,"set",(t,e)=>{e[1]={...e[1]};const i=e[1];i.batchType||(i.batchType="transparent")},{priority:"high"}),this.listenTo(t.data,"set",(t,e)=>{"transparent"===e[1].batchType&&this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}addBatch(t){const e=this.editor.model.document.selection,i={ranges:e.hasOwnRange?Array.from(e.getRanges()):[],isBackward:e.isBackward};this._stack.push({batch:t,selection:i}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(t,e,i){const n=this.editor.model,o=n.document,r=[],s=t.map(t=>t.getTransformedByOperations(i)),a=s.flat();for(const l of s){const t=l.filter(t=>t.root!=o.graveyard).filter(t=>!qd(t,a));t.length&&(Wd(t),r.push(t[0]))}r.length&&n.change(t=>{t.setSelection(r,{backward:e})})}_undo(t,e){const i=this.editor.model,n=i.document;this._createdBatches.add(e);const o=t.operations.slice().filter(t=>t.isDocumentOperation);o.reverse();for(const r of o){const t=Array.from(n.history.getOperations(r.baseVersion+1)),o=Nc([r.getReversed()],t,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(const s of o)e.addOperation(s),i.applyOperation(s),n.history.setOperationAsUndone(r,s)}}}function Wd(t){t.sort((t,e)=>t.start.isBefore(e.start)?-1:1);for(let e=1;e<t.length;e++){const i=t[e-1].getJoined(t[e],!0);i&&(e--,t.splice(e,2,i))}}function qd(t,e){return e.some(e=>e!==t&&e.containsRange(t,!0))}class Ud extends Hd{execute(t=null){const e=t?this._stack.findIndex(e=>e.batch==t):this._stack.length-1,i=this._stack.splice(e,1)[0],n=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(n,()=>{this._undo(i.batch,n);const t=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,t),this.fire("revert",i.batch,n)}),this.refresh()}}class Yd extends Hd{execute(){const t=this._stack.pop(),e=this.editor.model.createBatch("transparent");this.editor.model.enqueueChange(e,()=>{const i=this.editor.model.document.history.getOperations(t.batch.operations[t.batch.operations.length-1].baseVersion+1);this._restoreSelection(t.selection.ranges,t.selection.isBackward,i),this._undo(t.batch,e)}),this.refresh()}}class Gd extends Mt{static get pluginName(){return"UndoEditing"}constructor(t){super(t),this._batchRegistry=new WeakSet}init(){const t=this.editor;this._undoCommand=new Ud(t),this._redoCommand=new Yd(t),t.commands.add("undo",this._undoCommand),t.commands.add("redo",this._redoCommand),this.listenTo(t.model,"applyOperation",(t,e)=>{const i=e[0];if(!i.isDocumentOperation)return;const n=i.batch,o=this._redoCommand._createdBatches.has(n),r=this._undoCommand._createdBatches.has(n);this._batchRegistry.has(n)||"transparent"==n.type&&!o&&!r||(o?this._undoCommand.addBatch(n):r||(this._undoCommand.addBatch(n),this._redoCommand.clearStack()),this._batchRegistry.add(n))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(t,e,i)=>{this._redoCommand.addBatch(i)}),t.keystrokes.set("CTRL+Z","undo"),t.keystrokes.set("CTRL+Y","redo"),t.keystrokes.set("CTRL+SHIFT+Z","redo")}}var Zd='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',$d='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>';class Xd extends Mt{static get pluginName(){return"UndoUI"}init(){const t=this.editor,e=t.locale,i=t.t,n="ltr"==e.uiLanguageDirection?Zd:$d,o="ltr"==e.uiLanguageDirection?$d:Zd;this._addButton("undo",i("Undo"),"CTRL+Z",n),this._addButton("redo",i("Redo"),"CTRL+Y",o)}_addButton(t,e,i,n){const o=this.editor;o.ui.componentFactory.add(t,r=>{const s=o.commands.get(t),a=new Dl(r);return a.set({label:e,icon:n,keystroke:i,tooltip:!0}),a.bind("isEnabled").to(s,"isEnabled"),this.listenTo(a,"execute",()=>{o.execute(t),o.editing.view.focus()}),a})}}class Kd extends Mt{static get requires(){return[Gd,Xd]}static get pluginName(){return"Undo"}}const Qd=["left","right","center","justify"];function Jd(t){return Qd.includes(t)}function tu(t,e){return"rtl"==e.contentLanguageDirection?"right"===t:"left"===t}function eu(t){const e=t.map(t=>{let e;return e="string"==typeof t?{name:t}:t,e}).filter(t=>{const e=!!Qd.includes(t.name);return e||Object(a.b)("alignment-config-name-not-recognized",{option:t}),e}),i=e.filter(t=>!!t.className).length;if(i&&i<e.length)throw new a.a("alignment-config-classnames-are-missing",{configuredOptions:t});return e.forEach((e,i,n)=>{const o=n.slice(i+1);if(o.some(t=>t.name==e.name))throw new a.a("alignment-config-name-already-defined",{option:e,configuredOptions:t});if(e.className&&o.some(t=>t.className==e.className))throw new a.a("alignment-config-classname-already-defined",{option:e,configuredOptions:t})}),e}class iu extends Nt{refresh(){const t=this.editor.locale,e=fr(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!e&&this._canBeAligned(e),this.value=this.isEnabled&&e.hasAttribute("alignment")?e.getAttribute("alignment"):"rtl"===t.contentLanguageDirection?"right":"left"}execute(t={}){const e=this.editor,i=e.locale,n=e.model,o=n.document,r=t.value;n.change(t=>{const e=Array.from(o.selection.getSelectedBlocks()).filter(t=>this._canBeAligned(t)),n=e[0].getAttribute("alignment");tu(r,i)||n===r||!r?function(t,e){for(const i of t)e.removeAttribute("alignment",i)}(e,t):function(t,e,i){for(const n of t)e.setAttribute("alignment",i,n)}(e,t,r)})}_canBeAligned(t){return this.editor.model.schema.checkAttribute(t,"alignment")}}class nu extends Mt{static get pluginName(){return"AlignmentEditing"}constructor(t){super(t),t.config.define("alignment",{options:[...Qd.map(t=>({name:t}))]})}init(){const t=this.editor,e=t.locale,i=t.model.schema,n=eu(t.config.get("alignment.options")).filter(t=>Jd(t.name)&&!tu(t.name,e)),o=n.some(t=>!!t.className);i.extend("$block",{allowAttributes:"alignment"}),t.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),o?t.conversion.attributeToAttribute(function(t){const e={model:{key:"alignment",values:t.map(t=>t.name)},view:{}};for(const i of t)e.view[i.name]={key:"class",value:i.className};return e}(n)):t.conversion.for("downcast").attributeToAttribute(function(t){const e={model:{key:"alignment",values:t.map(t=>t.name)},view:{}};for(const{name:i}of t)e.view[i]={key:"style",value:{"text-align":i}};return e}(n));const r=function(t){const e=[];for(const{name:i}of t)e.push({view:{key:"style",value:{"text-align":i}},model:{key:"alignment",value:i}});return e}(n);for(const a of r)t.conversion.for("upcast").attributeToAttribute(a);const s=function(t){const e=[];for(const{name:i}of t)e.push({view:{key:"align",value:i},model:{key:"alignment",value:i}});return e}(n);for(const a of s)t.conversion.for("upcast").attributeToAttribute(a);t.commands.add("alignment",new iu(t))}}const ou=new Map([["left",rl.alignLeft],["right",rl.alignRight],["center",rl.alignCenter],["justify",rl.alignJustify]]);class ru extends Mt{get localizedOptionTitles(){const t=this.editor.t;return{left:t("Align left"),right:t("Align right"),center:t("Align center"),justify:t("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const t=this.editor,e=t.ui.componentFactory,i=t.t,n=eu(t.config.get("alignment.options"));n.map(t=>t.name).filter(Jd).forEach(t=>this._addButton(t)),e.add("alignment",t=>{const o=nc(t),r=n.map(t=>e.create("alignment:"+t.name));oc(o,r),o.buttonView.set({label:i("Text alignment"),tooltip:!0}),o.toolbarView.isVertical=!0,o.toolbarView.ariaLabel=i("Text alignment toolbar"),o.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const s=ou.get("rtl"===t.contentLanguageDirection?"right":"left");return o.buttonView.bind("icon").toMany(r,"isOn",(...t)=>{const e=t.findIndex(t=>t);return e<0?s:r[e].icon}),o.bind("isEnabled").toMany(r,"isEnabled",(...t)=>t.some(t=>t)),o})}_addButton(t){const e=this.editor;e.ui.componentFactory.add("alignment:"+t,i=>{const n=e.commands.get("alignment"),o=new Dl(i);return o.set({label:this.localizedOptionTitles[t],icon:ou.get(t),tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n),o.bind("isOn").to(n,"value",e=>e===t),this.listenTo(o,"execute",()=>{e.execute("alignment",{value:t}),e.editing.view.focus()}),o})}}class su extends Nt{constructor(t,e){super(t),this.attributeKey=e}refresh(){const t=this.editor.model,e=t.document;this.value=e.selection.getAttribute(this.attributeKey),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,this.attributeKey)}execute(t={}){const e=this.editor.model,i=e.document.selection,n=t.value;e.change(t=>{if(i.isCollapsed)n?t.setSelectionAttribute(this.attributeKey,n):t.removeSelectionAttribute(this.attributeKey);else{const o=e.schema.getValidRanges(i.getRanges(),this.attributeKey);for(const e of o)n?t.setAttribute(this.attributeKey,n,e):t.removeAttribute(this.attributeKey,e)}})}}class au extends Ke{constructor(t){super(t),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",0===this.length)})}add(t,e){this.find(e=>e.color===t.color)||super.add(t,e)}hasColor(t){return!!this.find(e=>e.color===t)}}Pt(au,Et),i(69);class lu extends hl{constructor(t,{colors:e,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:r}){super(t),this.items=this.createCollection(),this.colorDefinitions=e,this.focusTracker=new pr,this.keystrokes=new gr,this.set("selectedColor"),this.removeButtonLabel=n,this.columns=i,this.documentColors=new au,this.documentColorsCount=r,this._focusCycler=new Fl({focusables:this.items,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-table"]},children:this.items}),this.items.add(this._removeColorButton())}updateDocumentColors(t,e){const i=t.document,n=this.documentColorsCount;this.documentColors.clear();for(const o of i.getRootNames()){const r=i.getRoot(o),s=t.createRangeIn(r);for(const t of s.getItems())if(t.is("$textProxy")&&t.hasAttribute(e)&&(this._addColorToDocumentColors(t.getAttribute(e)),this.documentColors.length>=n))return}}updateSelectedColors(){const t=this.documentColorsGrid,e=this.selectedColor;this.staticColorsGrid.selectedColor=e,t&&(t.selectedColor=e)}render(){super.render();for(const t of this.items)this.focusTracker.add(t.element);this.keystrokes.listenTo(this.element)}appendGrids(){if(!this.staticColorsGrid&&(this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount)){const t=dl.bind(this.documentColors,this.documentColors),e=new ac(this.locale);e.text=this._documentColorsLabel,e.extendTemplate({attributes:{class:["ck","ck-color-grid__label",t.if("isEmpty","ck-hidden")]}}),this.items.add(e),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_removeColorButton(){const t=new Dl;return t.set({withText:!0,icon:rl.eraser,tooltip:!0,label:this.removeButtonLabel}),t.class="ck-color-table__remove-color",t.on("execute",()=>{this.fire("execute",{value:null})}),t}_createStaticColorsGrid(){const t=new Bl(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return t.delegate("execute").to(this),t}_createDocumentColorsGrid(){const t=dl.bind(this.documentColors,this.documentColors),e=new Bl(this.locale,{columns:this.columns});return e.delegate("execute").to(this),e.extendTemplate({attributes:{class:t.if("isEmpty","ck-hidden")}}),e.items.bindTo(this.documentColors).using(t=>{const e=new zl;return e.set({color:t.color,hasBorder:t.options&&t.options.hasBorder}),t.label&&e.set({label:t.label,tooltip:!0}),e.on("execute",()=>{this.fire("execute",{value:t.color})}),e}),this.documentColors.on("change:isEmpty",(t,i,n)=>{n&&(e.selectedColor=null)}),e}_addColorToDocumentColors(t){const e=this.colorDefinitions.find(e=>e.color===t);this.documentColors.add(e?Object.assign({},e):{color:t,label:t,options:{hasBorder:!1}})}}function cu(t,e){const i={model:{key:t,values:[]},view:{},upcastAlso:{}};for(const n of e)i.model.values.push(n.model),i.view[n.model]=n.view,n.upcastAlso&&(i.upcastAlso[n.model]=n.upcastAlso);return i}function hu(t){return e=>e.getStyle(t).replace(/\s/g,"")}function du(t){return(e,{writer:i})=>i.createAttributeElement("span",{style:`${t}:${e}`},{priority:7})}class uu extends su{constructor(t){super(t,"fontSize")}}function fu(t){return t.map(t=>function(t){if("object"==typeof(e=t)&&e.title&&e.model&&e.view)return gu(t);var e;const i=function(t){return pu[t]||pu[t.model]}(t);return i?gu(i):"default"===t?{model:void 0,title:"Default"}:function(t){let e;if("object"==typeof t){if(!t.model)throw new a.a("font-size-invalid-definition",null,t);e=parseFloat(t.model)}else e=parseFloat(t);return isNaN(e)}(t)?void 0:function(t){return"number"!=typeof t&&"string"!=typeof t||(t={title:String(t),model:parseFloat(t)+"px"}),t.view={name:"span",styles:{"font-size":t.model}},gu(t)}(t)}(t)).filter(t=>!!t)}const pu={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function gu(t){return t.view.priority||(t.view.priority=7),t}const mu=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class vu extends Mt{static get pluginName(){return"FontSizeEditing"}constructor(t){super(t),t.config.define("fontSize",{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"fontSize"}),t.model.schema.setAttributeProperties("fontSize",{isFormatting:!0,copyOnEnter:!0});const e=t.config.get("fontSize.supportAllValues"),i=cu("fontSize",fu(this.editor.config.get("fontSize.options")).filter(t=>t.model));e?(this._prepareAnyValueConverters(i),this._prepareCompatibilityConverter()):t.conversion.attributeToElement(i),t.commands.add("fontSize",new uu(t))}_prepareAnyValueConverters(t){const e=this.editor,i=t.model.values.filter(t=>{return!function(t){return Kc.test(t)}(String(t))&&(e=String(t),!Qc.test(e));var e});if(i.length)throw new a.a("font-size-invalid-use-of-named-presets",null,{presets:i});e.conversion.for("downcast").attributeToElement({model:"fontSize",view:(t,{writer:e})=>{if(t)return e.createAttributeElement("span",{style:"font-size:"+t},{priority:7})}}),e.conversion.for("upcast").elementToAttribute({model:{key:"fontSize",value:t=>t.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:"fontSize",value:t=>{const e=t.getAttribute("size"),i="-"===e[0]||"+"===e[0];let n=parseInt(e,10);i&&(n=3+n);const o=mu.length-1,r=Math.min(Math.max(n,0),o);return mu[r]}}})}}i(71);class yu extends Mt{static get pluginName(){return"FontSizeUI"}init(){const t=this.editor,e=t.t,i=this._getLocalizedOptions(),n=t.commands.get("fontSize");t.ui.componentFactory.add("fontSize",o=>{const r=nc(o);return rc(r,function(t,e){const i=new Ke;for(const n of t){const t={type:"button",model:new pc({commandName:"fontSize",commandParam:n.model,label:n.title,class:"ck-fontsize-option",withText:!0})};n.view&&n.view.styles&&t.model.set("labelStyle","font-size:"+n.view.styles["font-size"]),n.view&&n.view.classes&&t.model.set("class",`${t.model.class} ${n.view.classes}`),t.model.bind("isOn").to(e,"value",t=>t===n.model),i.add(t)}return i}(i,n)),r.buttonView.set({label:e("Font Size"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>',tooltip:!0}),r.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),r.bind("isEnabled").to(n),this.listenTo(r,"execute",e=>{t.execute(e.source.commandName,{value:e.source.commandParam}),t.editing.view.focus()}),r})}_getLocalizedOptions(){const t=this.editor,e=t.t,i={Default:e("Default"),Tiny:e("Tiny"),Small:e("Small"),Big:e("Big"),Huge:e("Huge")};return fu(t.config.get("fontSize").options).map(t=>{const e=i[t.title];return e&&e!=t.title&&(t=Object.assign({},t,{title:e})),t})}}class bu extends su{constructor(t){super(t,"fontFamily")}}function wu(t){return t.map(ku).filter(t=>!!t)}function ku(t){return"object"==typeof t?t:"default"===t?{title:"Default",model:void 0}:"string"==typeof t?function(t){const e=t.replace(/"|'/g,"").split(","),i=e[0],n=e.map(_u).join(", ");return{title:i,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}(t):void 0}function _u(t){return(t=t.trim()).indexOf(" ")>0&&(t=`'${t}'`),t}class xu extends Mt{static get pluginName(){return"FontFamilyEditing"}constructor(t){super(t),t.config.define("fontFamily",{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"fontFamily"}),t.model.schema.setAttributeProperties("fontFamily",{isFormatting:!0,copyOnEnter:!0});const e=cu("fontFamily",wu(t.config.get("fontFamily.options")).filter(t=>t.model));t.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):t.conversion.attributeToElement(e),t.commands.add("fontFamily",new bu(t))}_prepareAnyValueConverters(){const t=this.editor;t.conversion.for("downcast").attributeToElement({model:"fontFamily",view:(t,{writer:e})=>e.createAttributeElement("span",{style:"font-family:"+t},{priority:7})}),t.conversion.for("upcast").elementToAttribute({model:{key:"fontFamily",value:t=>t.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:"fontFamily",value:t=>t.getAttribute("face")}})}}class Cu extends Mt{static get pluginName(){return"FontFamilyUI"}init(){const t=this.editor,e=t.t,i=this._getLocalizedOptions(),n=t.commands.get("fontFamily");t.ui.componentFactory.add("fontFamily",o=>{const r=nc(o);return rc(r,function(t,e){const i=new Ke;for(const n of t){const t={type:"button",model:new pc({commandName:"fontFamily",commandParam:n.model,label:n.title,withText:!0})};t.model.bind("isOn").to(e,"value",t=>t===n.model||!(!t||!n.model)&&t.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase()),n.view&&n.view.styles&&t.model.set("labelStyle","font-family: "+n.view.styles["font-family"]),i.add(t)}return i}(i,n)),r.buttonView.set({label:e("Font Family"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>',tooltip:!0}),r.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),r.bind("isEnabled").to(n),this.listenTo(r,"execute",e=>{t.execute(e.source.commandName,{value:e.source.commandParam}),t.editing.view.focus()}),r})}_getLocalizedOptions(){const t=this.editor,e=t.t;return wu(t.config.get("fontFamily").options).map(t=>("Default"===t.title&&(t.title=e("Default")),t))}}class Eu extends su{constructor(t){super(t,"fontColor")}}class Tu extends Mt{static get pluginName(){return"FontColorEditing"}constructor(t){super(t),t.config.define("fontColor",{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),t.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:"fontColor",value:hu("color")}}),t.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:"fontColor",value:t=>t.getAttribute("color")}}),t.conversion.for("downcast").attributeToElement({model:"fontColor",view:du("color")}),t.commands.add("fontColor",new Eu(t)),t.model.schema.extend("$text",{allowAttributes:"fontColor"}),t.model.schema.setAttributeProperties("fontColor",{isFormatting:!0,copyOnEnter:!0})}}class Su extends Mt{constructor(t,{commandName:e,icon:i,componentName:n,dropdownLabel:o}){super(t),this.commandName=e,this.componentName=n,this.icon=i,this.dropdownLabel=o,this.columns=t.config.get(this.componentName+".columns"),this.colorTableView=void 0}init(){const t=this.editor,e=t.locale,i=e.t,n=t.commands.get(this.commandName),o=function(t,e){const i=t.t,n={Black:i("Black"),"Dim grey":i("Dim grey"),Grey:i("Grey"),"Light grey":i("Light grey"),White:i("White"),Red:i("Red"),Orange:i("Orange"),Yellow:i("Yellow"),"Light green":i("Light green"),Green:i("Green"),Aquamarine:i("Aquamarine"),Turquoise:i("Turquoise"),"Light blue":i("Light blue"),Blue:i("Blue"),Purple:i("Purple")};return e.map(t=>{const e=n[t.label];return e&&e!=t.label&&(t.label=e),t})}(e,t.config.get(this.componentName).colors.map(Rl).filter(t=>!!t)),r=t.config.get(this.componentName+".documentColors");t.ui.componentFactory.add(this.componentName,e=>{const s=nc(e);return this.colorTableView=function({dropdownView:t,colors:e,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:r}){const s=new lu(t.locale,{colors:e,columns:i,removeButtonLabel:n,documentColorsLabel:o,documentColorsCount:r});return t.colorTableView=s,t.panelView.children.add(s),s.delegate("execute").to(t,"execute"),s}({dropdownView:s,colors:o.map(t=>({label:t.label,color:t.model,options:{hasBorder:t.hasBorder}})),columns:this.columns,removeButtonLabel:i("Remove color"),documentColorsLabel:0!==r?i("Document colors"):void 0,documentColorsCount:void 0===r?this.columns:r}),this.colorTableView.bind("selectedColor").to(n,"value"),s.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),s.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),s.bind("isEnabled").to(n),s.on("execute",(e,i)=>{t.execute(this.commandName,i),t.editing.view.focus()}),s.on("change:isOpen",(e,i,n)=>{s.colorTableView.appendGrids(),n&&(0!==r&&this.colorTableView.updateDocumentColors(t.model,this.componentName),this.colorTableView.updateSelectedColors())}),s})}}class Au extends Su{constructor(t){super(t,{commandName:"fontColor",componentName:"fontColor",icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>',dropdownLabel:(0,t.locale.t)("Font Color")})}static get pluginName(){return"FontColorUI"}}class Ou extends su{constructor(t){super(t,"fontBackgroundColor")}}class Iu extends Mt{static get pluginName(){return"FontBackgroundColorEditing"}constructor(t){super(t),t.config.define("fontBackgroundColor",{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),t.data.addStyleProcessorRules(ch),t.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:"fontBackgroundColor",value:hu("background-color")}}),t.conversion.for("downcast").attributeToElement({model:"fontBackgroundColor",view:du("background-color")}),t.commands.add("fontBackgroundColor",new Ou(t)),t.model.schema.extend("$text",{allowAttributes:"fontBackgroundColor"}),t.model.schema.setAttributeProperties("fontBackgroundColor",{isFormatting:!0,copyOnEnter:!0})}}class Pu extends Su{constructor(t){super(t,{commandName:"fontBackgroundColor",componentName:"fontBackgroundColor",icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>',dropdownLabel:(0,t.locale.t)("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}class Mu{constructor(){const t=new window.FileReader;this._reader=t,this._data=void 0,this.set("loaded",0),t.onprogress=t=>{this.loaded=t.loaded}}get error(){return this._reader.error}get data(){return this._data}read(t){const e=this._reader;return this.total=t.size,new Promise((i,n)=>{e.onload=()=>{const t=e.result;this._data=t,i(t)},e.onerror=()=>{n("error")},e.onabort=()=>{n("aborted")},this._reader.readAsDataURL(t)})}abort(){this._reader.abort()}}Pt(Mu,Et);class Du extends Mt{static get pluginName(){return"FileRepository"}static get requires(){return[nl]}init(){this.loaders=new Ke,this.loaders.on("add",()=>this._updatePendingAction()),this.loaders.on("remove",()=>this._updatePendingAction()),this._loadersMap=new Map,this._pendingAction=null,this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(t,e)=>e?t/e*100:0)}getLoader(t){return this._loadersMap.get(t)||null}createLoader(t){if(!this.createUploadAdapter)return Object(a.b)("filerepository-no-upload-adapter"),null;const e=new Nu(Promise.resolve(t),this.createUploadAdapter);return this.loaders.add(e),this._loadersMap.set(t,e),t instanceof Promise&&e.file.then(t=>{this._loadersMap.set(t,e)}).catch(()=>{}),e.on("change:uploaded",()=>{let t=0;for(const e of this.loaders)t+=e.uploaded;this.uploaded=t}),e.on("change:uploadTotal",()=>{let t=0;for(const e of this.loaders)e.uploadTotal&&(t+=e.uploadTotal);this.uploadTotal=t}),e}destroyLoader(t){const e=t instanceof Nu?t:this.getLoader(t);e._destroy(),this.loaders.remove(e),this._loadersMap.forEach((t,i)=>{t===e&&this._loadersMap.delete(i)})}_updatePendingAction(){const t=this.editor.plugins.get(nl);if(this.loaders.length){if(!this._pendingAction){const e=this.editor.t,i=t=>`${e("Upload in progress")} ${parseInt(t)}%.`;this._pendingAction=t.add(i(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",i)}}else t.remove(this._pendingAction),this._pendingAction=null}}Pt(Du,Et);class Nu{constructor(t,e){this.id=r(),this._filePromiseWrapper=this._createFilePromiseWrapper(t),this._adapter=e(this),this._reader=new Mu,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(t,e)=>e?t/e*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(t=>this._filePromiseWrapper?t:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if("idle"!=this.status)throw new a.a("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(t=>this._reader.read(t)).then(t=>{if("reading"!==this.status)throw this.status;return this.status="idle",t}).catch(t=>{if("aborted"===t)throw this.status="aborted","aborted";throw this.status="error",this._reader.error?this._reader.error:t})}upload(){if("idle"!=this.status)throw new a.a("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(t=>(this.uploadResponse=t,this.status="idle",t)).catch(t=>{if("aborted"===this.status)throw"aborted";throw this.status="error",t})}abort(){const t=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?"reading"==t?this._reader.abort():"uploading"==t&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(t){const e={};return e.promise=new Promise((i,n)=>{e.rejecter=n,e.isFulfilled=!1,t.then(t=>{e.isFulfilled=!0,i(t)}).catch(t=>{e.isFulfilled=!0,n(t)})}),e}}Pt(Nu,Et);class Ru extends hl{constructor(t){super(t),this.buttonView=new Dl(t),this._fileInputView=new zu(t),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.setTemplate({tag:"span",attributes:{class:"ck-file-dialog-button"},children:[this.buttonView,this._fileInputView]}),this.buttonView.on("execute",()=>{this._fileInputView.open()})}focus(){this.buttonView.focus()}}class zu extends hl{constructor(t){super(t),this.set("acceptedType"),this.set("allowMultipleFiles",!1);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:e.to("acceptedType"),multiple:e.to("allowMultipleFiles")},on:{change:e.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}class Fu{constructor(t){this.loader=t}upload(){return new Promise((t,e)=>{const i=this.reader=new window.FileReader;i.addEventListener("load",()=>{t({default:i.result})}),i.addEventListener("error",t=>{e(t)}),i.addEventListener("abort",()=>{e()}),this.loader.file.then(t=>{i.readAsDataURL(t)})})}abort(){this.reader.abort()}}class Lu{constructor(t,e,i){this.loader=t,this.url=e,this.t=i}upload(){return this.loader.file.then(t=>new Promise((e,i)=>{this._initRequest(),this._initListeners(e,i,t),this._sendRequest(t)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}_initListeners(t,e,i){const n=this.xhr,o=this.loader,r=(0,this.t)("Cannot upload file:")+` ${i.name}.`;n.addEventListener("error",()=>e(r)),n.addEventListener("abort",()=>e()),n.addEventListener("load",()=>{const i=n.response;if(!i||!i.uploaded)return e(i&&i.error&&i.error.message?i.error.message:r);t({default:i.url})}),n.upload&&n.upload.addEventListener("progress",t=>{t.lengthComputable&&(o.uploadTotal=t.total,o.uploaded=t.loaded)})}_sendRequest(t){const e=new FormData;e.append("upload",t),e.append("ckCsrfToken",function(){let t=function(t){t=t.toLowerCase();const e=document.cookie.split(";");for(const i of e){const e=i.split("=");if(decodeURIComponent(e[0].trim().toLowerCase())===t)return decodeURIComponent(e[1])}return null}("ckCsrfToken");var e;return t&&40==t.length||(t=function(t){let e="";const i=new Uint8Array(40);window.crypto.getRandomValues(i);for(let n=0;n<i.length;n++){const t="abcdefghijklmnopqrstuvwxyz0123456789".charAt(i[n]%"abcdefghijklmnopqrstuvwxyz0123456789".length);e+=Math.random()>.5?t.toUpperCase():t}return e}(),e=t,document.cookie=encodeURIComponent("ckCsrfToken")+"="+encodeURIComponent(e)+";path=/"),t}()),this.xhr.send(e)}}function Bu(t,e,i,n){let o,r=null;"function"==typeof n?o=n:(r=t.commands.get(n),o=()=>{t.execute(n)}),t.model.document.on("change:data",(s,a)=>{if(r&&!r.isEnabled||!e.isEnabled)return;const l=fr(t.model.document.selection.getRanges());if(!l.isCollapsed)return;if("transparent"==a.type)return;const c=Array.from(t.model.document.differ.getChanges()),h=c[0];if(1!=c.length||"insert"!==h.type||"$text"!=h.name||1!=h.length)return;const d=h.position.parent;if(d.is("element","codeBlock"))return;if(d.is("element","listItem")&&"function"!=typeof n&&!["numberedList","bulletedList","todoList"].includes(n))return;if(r&&!0===r.value)return;const u=d.getChild(0),f=t.model.createRangeOn(u);if(!f.containsRange(l)&&!l.end.isEqual(f.end))return;const p=i.exec(u.data.substr(0,l.end.offset));p&&t.model.enqueueChange(e=>{const i=e.createPositionAt(d,0),n=e.createPositionAt(d,p[0].length),r=new Qr(i,n);if(!1!==o({match:p})){e.remove(r);const i=t.model.document.selection.getFirstRange(),n=e.createRangeIn(d);!d.isEmpty||n.isEqual(i)||n.containsRange(i,!0)||e.remove(d)}r.detach(),t.model.enqueueChange(()=>{t.plugins.get("Delete").requestUndoOnBackspace()})})})}function ju(t,e,i,n){let o,r;i instanceof RegExp?o=i:r=i,r=r||(t=>{let e;const i=[],n=[];for(;null!==(e=o.exec(t))&&!(e&&e.length<4);){let{index:t,1:o,2:r,3:s}=e;t+=e[0].length-(o+r+s).length;const a=[t+o.length+r.length,t+o.length+r.length+s.length];i.push([t,t+o.length]),i.push(a),n.push([t+o.length,t+o.length+r.length])}return{remove:i,format:n}}),t.model.document.on("change:data",(i,o)=>{if("transparent"==o.type||!e.isEnabled)return;const s=t.model,a=s.document.selection;if(!a.isCollapsed)return;const l=Array.from(s.document.differ.getChanges()),c=l[0];if(1!=l.length||"insert"!==c.type||"$text"!=c.name||1!=c.length)return;const h=a.focus,d=h.parent,{text:u,range:f}=function(t,e){let i=t.start;return{text:Array.from(t.getItems()).reduce((t,n)=>!n.is("$text")&&!n.is("$textProxy")||n.getAttribute("code")?(i=e.createPositionAfter(n),""):t+n.data,""),range:e.createRange(i,t.end)}}(s.createRange(s.createPositionAt(d,0),h),s),p=r(u),g=Vu(f.start,p.format,s),m=Vu(f.start,p.remove,s);g.length&&m.length&&s.enqueueChange(e=>{if(!1!==n(e,g)){for(const t of m.reverse())e.remove(t);s.enqueueChange(()=>{t.plugins.get("Delete").requestUndoOnBackspace()})}})})}function Vu(t,e,i){return e.filter(t=>void 0!==t[0]&&void 0!==t[1]).map(e=>i.createRange(t.getShiftedBy(e[0]),t.getShiftedBy(e[1])))}function Hu(t,e){return(i,n)=>{if(!t.commands.get(e).isEnabled)return!1;const o=t.model.schema.getValidRanges(n,e);for(const t of o)i.setAttribute(e,!0,t);i.removeSelectionAttribute(e)}}class Wu extends Nt{constructor(t,e){super(t),this.attributeKey=e}refresh(){const t=this.editor.model,e=t.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=t.schema.checkAttributeInSelection(e.selection,this.attributeKey)}execute(t={}){const e=this.editor.model,i=e.document.selection,n=void 0===t.forceValue?!this.value:t.forceValue;e.change(t=>{if(i.isCollapsed)n?t.setSelectionAttribute(this.attributeKey,!0):t.removeSelectionAttribute(this.attributeKey);else{const o=e.schema.getValidRanges(i.getRanges(),this.attributeKey);for(const e of o)n?t.setAttribute(this.attributeKey,n,e):t.removeAttribute(this.attributeKey,e)}})}_getValueFromFirstAllowedNode(){const t=this.editor.model,e=t.schema,i=t.document.selection;if(i.isCollapsed)return i.hasAttribute(this.attributeKey);for(const n of i.getRanges())for(const t of n.getItems())if(e.checkAttribute(t,this.attributeKey))return t.hasAttribute(this.attributeKey);return!1}}class qu extends Mt{static get pluginName(){return"BoldEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"bold"}),t.model.schema.setAttributeProperties("bold",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"bold",view:"strong",upcastAlso:["b",t=>{const e=t.getStyle("font-weight");return e?"bold"==e||Number(e)>=600?{name:!0,styles:["font-weight"]}:void 0:null}]}),t.commands.add("bold",new Wu(t,"bold")),t.keystrokes.set("CTRL+B","bold")}}class Uu extends Mt{static get pluginName(){return"BoldUI"}init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("bold",i=>{const n=t.commands.get("bold"),o=new Dl(i);return o.set({label:e("Bold"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',keystroke:"CTRL+B",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{t.execute("bold"),t.editing.view.focus()}),o})}}class Yu extends Mt{static get pluginName(){return"ItalicEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"italic"}),t.model.schema.setAttributeProperties("italic",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"italic",view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add("italic",new Wu(t,"italic")),t.keystrokes.set("CTRL+I","italic")}}class Gu extends Mt{static get pluginName(){return"ItalicUI"}init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("italic",i=>{const n=t.commands.get("italic"),o=new Dl(i);return o.set({label:e("Italic"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>',keystroke:"CTRL+I",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{t.execute("italic"),t.editing.view.focus()}),o})}}class Zu extends Mt{static get pluginName(){return"StrikethroughEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"strikethrough"}),t.model.schema.setAttributeProperties("strikethrough",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"strikethrough",view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),t.commands.add("strikethrough",new Wu(t,"strikethrough")),t.keystrokes.set("CTRL+SHIFT+X","strikethrough")}}class $u extends Mt{static get pluginName(){return"StrikethroughUI"}init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("strikethrough",i=>{const n=t.commands.get("strikethrough"),o=new Dl(i);return o.set({label:e("Strikethrough"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>',keystroke:"CTRL+SHIFT+X",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{t.execute("strikethrough"),t.editing.view.focus()}),o})}}class Xu extends Mt{static get pluginName(){return"UnderlineEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"underline"}),t.model.schema.setAttributeProperties("underline",{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:"underline",view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),t.commands.add("underline",new Wu(t,"underline")),t.keystrokes.set("CTRL+U","underline")}}class Ku extends Mt{static get pluginName(){return"UnderlineUI"}init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("underline",i=>{const n=t.commands.get("underline"),o=new Dl(i);return o.set({label:e("Underline"),icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>',keystroke:"CTRL+U",tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{t.execute("underline"),t.editing.view.focus()}),o})}}class Qu extends Nt{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const e=this.editor.model,i=e.schema,n=Array.from(e.document.selection.getSelectedBlocks()),o=void 0===t.forceValue?!this.value:t.forceValue;e.change(t=>{if(o){const e=n.filter(t=>Ju(t)||ef(i,t));this._applyQuote(t,e)}else this._removeQuote(t,n.filter(Ju))})}_getValue(){const t=fr(this.editor.model.document.selection.getSelectedBlocks());return!(!t||!Ju(t))}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.schema,e=fr(this.editor.model.document.selection.getSelectedBlocks());return!!e&&ef(t,e)}_removeQuote(t,e){tf(t,e).reverse().forEach(e=>{if(e.start.isAtStart&&e.end.isAtEnd)return void t.unwrap(e.start.parent);if(e.start.isAtStart){const i=t.createPositionBefore(e.start.parent);return void t.move(e,i)}e.end.isAtEnd||t.split(e.end);const i=t.createPositionAfter(e.end.parent);t.move(e,i)})}_applyQuote(t,e){const i=[];tf(t,e).reverse().forEach(e=>{let n=Ju(e.start);n||(n=t.createElement("blockQuote"),t.wrap(e,n)),i.push(n)}),i.reverse().reduce((e,i)=>e.nextSibling==i?(t.merge(t.createPositionAfter(e)),e):i)}}function Ju(t){return"blockQuote"==t.parent.name?t.parent:null}function tf(t,e){let i,n=0;const o=[];for(;n<e.length;){const r=e[n],s=e[n+1];i||(i=t.createPositionBefore(r)),s&&r.nextSibling==s||(o.push(t.createRange(i,t.createPositionAfter(r))),i=null),n++}return o}function ef(t,e){const i=t.checkChild(e.parent,"blockQuote"),n=t.checkChild(["$root","blockQuote"],e);return i&&n}class nf extends Mt{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[xh,Sh]}init(){const t=this.editor,e=t.model.schema;t.commands.add("blockQuote",new Qu(t)),e.register("blockQuote",{allowWhere:"$block",allowContentOf:"$root"}),t.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),t.model.document.registerPostFixer(i=>{const n=t.model.document.differ.getChanges();for(const t of n)if("insert"==t.type){const n=t.position.nodeAfter;if(!n)continue;if(n.is("element","blockQuote")&&n.isEmpty)return i.remove(n),!0;if(n.is("element","blockQuote")&&!e.checkChild(t.position,n))return i.unwrap(n),!0;if(n.is("element")){const t=i.createRangeIn(n);for(const n of t.getItems())if(n.is("element","blockQuote")&&!e.checkChild(i.createPositionBefore(n),n))return i.unwrap(n),!0}}else if("remove"==t.type){const e=t.position.parent;if(e.is("element","blockQuote")&&e.isEmpty)return i.remove(e),!0}return!1});const i=this.editor.editing.view.document,n=t.model.document.selection,o=t.commands.get("blockQuote");this.listenTo(i,"enter",(e,i)=>{n.isCollapsed&&o.value&&n.getLastPosition().parent.isEmpty&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),i.preventDefault(),e.stop())},{context:"blockquote"}),this.listenTo(i,"delete",(e,i)=>{if("backward"!=i.direction||!n.isCollapsed||!o.value)return;const r=n.getLastPosition().parent;r.isEmpty&&!r.previousSibling&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),i.preventDefault(),e.stop())},{context:"blockquote"})}}i(73);class of extends Mt{static get pluginName(){return"BlockQuoteUI"}init(){const t=this.editor,e=t.t;t.ui.componentFactory.add("blockQuote",i=>{const n=t.commands.get("blockQuote"),o=new Dl(i);return o.set({label:e("Block quote"),icon:rl.quote,tooltip:!0,isToggleable:!0}),o.bind("isOn","isEnabled").to(n,"value","isEnabled"),this.listenTo(o,"execute",()=>{t.execute("blockQuote"),t.editing.view.focus()}),o})}}class rf extends Mt{static get pluginName(){return"CloudServicesUploadAdapter"}static get requires(){return["CloudServices",Du]}init(){const t=this.editor,e=t.plugins.get("CloudServices"),i=e.token,n=e.uploadUrl;i&&(this._uploadGateway=t.plugins.get("CloudServicesCore").createUploadGateway(i,n),t.plugins.get(Du).createUploadAdapter=t=>new sf(this._uploadGateway,t))}}class sf{constructor(t,e){this.uploadGateway=t,this.loader=e}upload(){return this.loader.file.then(t=>(this.fileUploader=this.uploadGateway.upload(t),this.fileUploader.on("progress",(t,e)=>{this.loader.uploadTotal=e.total,this.loader.uploaded=e.uploaded}),this.fileUploader.send()))}abort(){this.fileUploader.abort()}}class af extends Nt{refresh(){const t=this.editor.model,e=fr(t.document.selection.getSelectedBlocks());this.value=!!e&&e.is("element","paragraph"),this.isEnabled=!!e&&lf(e,t.schema)}execute(t={}){const e=this.editor.model,i=e.document;e.change(n=>{const o=(t.selection||i.selection).getSelectedBlocks();for(const t of o)!t.is("element","paragraph")&&lf(t,e.schema)&&n.rename(t,"paragraph")})}}function lf(t,e){return e.checkChild(t.parent,"paragraph")&&!e.isObject(t)}class cf extends Nt{execute(t){const e=this.editor.model;let i=t.position;e.change(t=>{const n=t.createElement("paragraph");if(!e.schema.checkChild(i.parent,n)){const o=e.schema.findAllowedParent(i,n);if(!o)return;i=t.split(i,o).position}e.insertContent(n,i),t.setSelection(n,"in")})}}class hf extends Mt{static get pluginName(){return"Paragraph"}init(){const t=this.editor,e=t.model;t.commands.add("paragraph",new af(t)),t.commands.add("insertParagraph",new cf(t)),e.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(t,{writer:e})=>hf.paragraphLikeElements.has(t.name)?t.isEmpty?null:e.createElement("paragraph"):null,view:/.+/,converterPriority:"low"})}}hf.paragraphLikeElements=new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]);class df extends Nt{constructor(t,e){super(t),this.modelElements=e}refresh(){const t=fr(this.editor.model.document.selection.getSelectedBlocks());this.value=!!t&&this.modelElements.includes(t.name)&&t.name,this.isEnabled=!!t&&this.modelElements.some(e=>uf(t,e,this.editor.model.schema))}execute(t){const e=this.editor.model,i=e.document,n=t.value;e.change(t=>{const o=Array.from(i.selection.getSelectedBlocks()).filter(t=>uf(t,n,e.schema));for(const e of o)e.is("element",n)||t.rename(e,n)})}}function uf(t,e,i){return i.checkChild(t.parent,e)&&!i.isObject(t)}class ff extends Mt{static get pluginName(){return"HeadingEditing"}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[hf]}init(){const t=this.editor,e=t.config.get("heading.options"),i=[];for(const n of e)"paragraph"!==n.model&&(t.model.schema.register(n.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(n),i.push(n.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new df(t,i))}afterInit(){const t=this.editor,e=t.commands.get("enter"),i=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",(e,n)=>{const o=t.model.document.selection.getFirstPosition().parent;i.some(t=>o.is("element",t.model))&&!o.is("element","paragraph")&&0===o.childCount&&n.writer.rename(o,"paragraph")})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:s.get("low")+1})}}i(13);class pf extends Mt{static get pluginName(){return"HeadingUI"}init(){const t=this.editor,e=t.t,i=function(t){const e=t.t,i={Paragraph:e("Paragraph"),"Heading 1":e("Heading 1"),"Heading 2":e("Heading 2"),"Heading 3":e("Heading 3"),"Heading 4":e("Heading 4"),"Heading 5":e("Heading 5"),"Heading 6":e("Heading 6")};return t.config.get("heading.options").map(t=>{const e=i[t.title];return e&&e!=t.title&&(t.title=e),t})}(t),n=e("Choose heading"),o=e("Heading");t.ui.componentFactory.add("heading",e=>{const r={},s=new Ke,a=t.commands.get("heading"),l=t.commands.get("paragraph"),c=[a];for(const t of i){const e={type:"button",model:new pc({label:t.title,class:t.class,withText:!0})};"paragraph"===t.model?(e.model.bind("isOn").to(l,"value"),e.model.set("commandName","paragraph"),c.push(l)):(e.model.bind("isOn").to(a,"value",e=>e===t.model),e.model.set({commandName:"heading",commandValue:t.model})),s.add(e),r[t.model]=t.title}const h=nc(e);return rc(h,s),h.buttonView.set({isOn:!1,withText:!0,tooltip:o}),h.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),h.bind("isEnabled").toMany(c,"isEnabled",(...t)=>t.some(t=>t)),h.buttonView.bind("label").to(a,"value",l,"value",(t,e)=>{const i=t||e&&"paragraph";return r[i]?r[i]:n}),this.listenTo(h,"execute",e=>{t.execute(e.source.commandName,e.source.commandValue?{value:e.source.commandValue}:void 0),t.editing.view.focus()}),h})}}class gf extends Mt{static get requires(){return[_c]}static get pluginName(){return"WidgetToolbarRepository"}init(){const t=this.editor;if(t.plugins.has("BalloonToolbar")){const e=t.plugins.get("BalloonToolbar");this.listenTo(e,"show",e=>{(function(t){const e=t.getSelectedElement();return!(!e||!Mh(e))})(t.editing.view.document.selection)&&e.stop()},{priority:"high"})}this._toolbarDefinitions=new Map,this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(t.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const t of this._toolbarDefinitions.values())t.view.destroy()}register(t,{ariaLabel:e,items:i,getRelatedElement:n,balloonClassName:o="ck-toolbar-container"}){if(!i.length)return void Object(a.b)("widget-toolbar-no-items",{toolbarId:t});const r=this.editor,s=r.t,l=new Xl(r.locale);if(l.ariaLabel=e||s("Widget toolbar"),this._toolbarDefinitions.has(t))throw new a.a("widget-toolbar-duplicated",this,{toolbarId:t});l.fillFromConfig(i,r.ui.componentFactory),this._toolbarDefinitions.set(t,{view:l,getRelatedElement:n,balloonClassName:o})}_updateToolbarsVisibility(){let t=0,e=null,i=null;for(const n of this._toolbarDefinitions.values()){const o=n.getRelatedElement(this.editor.editing.view.document.selection);if(this.isEnabled&&o)if(this.editor.ui.focusTracker.isFocused){const r=o.getAncestors().length;r>t&&(t=r,e=o,i=n)}else this._isToolbarVisible(n)&&this._hideToolbar(n);else this._isToolbarInBalloon(n)&&this._hideToolbar(n)}i&&this._showToolbar(i,e)}_hideToolbar(t){this._balloon.remove(t.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(t,e){this._isToolbarVisible(t)?mf(this.editor,e):this._isToolbarInBalloon(t)||(this._balloon.add({view:t.view,position:vf(this.editor,e),balloonClassName:t.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const t of this._toolbarDefinitions.values())if(this._isToolbarVisible(t)){const e=t.getRelatedElement(this.editor.editing.view.document.selection);mf(this.editor,e)}}))}_isToolbarVisible(t){return this._balloon.visibleView===t.view}_isToolbarInBalloon(t){return this._balloon.hasView(t.view)}}function mf(t,e){const i=t.plugins.get("ContextualBalloon"),n=vf(t,e);i.updatePosition(n)}function vf(t,e){const i=vc.defaultPositions;return{target:t.editing.view.domConverter.mapViewToDom(e),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}class yf{constructor(t){this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=t,this._referenceCoordinates=null}begin(t,e,i){const n=new ar(e);this.activeHandlePosition=function(t){const e=["top-left","top-right","bottom-right","bottom-left"];for(const i of e)if(t.classList.contains("ck-widget__resizer__handle-"+i))return i}(t),this._referenceCoordinates=function(t,e){const i=new ar(t),n=e.split("-"),o={x:"right"==n[1]?i.right:i.left,y:"bottom"==n[0]?i.bottom:i.top};return o.x+=t.ownerDocument.defaultView.scrollX,o.y+=t.ownerDocument.defaultView.scrollY,o}(e,function(t){const e=t.split("-"),i={top:"bottom",bottom:"top",left:"right",right:"left"};return`${i[e[0]]}-${i[e[1]]}`}(this.activeHandlePosition)),this.originalWidth=n.width,this.originalHeight=n.height,this.aspectRatio=n.width/n.height;const o=i.style.width;this.originalWidthPercents=o&&o.match(/^\d+(\.\d*)?%$/)?parseFloat(o):function(t,e){const i=t.parentElement,n=parseFloat(i.ownerDocument.defaultView.getComputedStyle(i).width);return e.width/n*100}(i,n)}update(t){this.proposedWidth=t.width,this.proposedHeight=t.height,this.proposedWidthPercents=t.widthPercents,this.proposedHandleHostWidth=t.handleHostWidth,this.proposedHandleHostHeight=t.handleHostHeight}}Pt(yf,Et);class bf extends hl{constructor(){super();const t=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",t.to("_viewPosition",t=>t?"ck-orientation-"+t:"")],style:{display:t.if("_isVisible","none",t=>!t)}},children:[{text:t.to("_label")}]})}_bindToState(t,e){this.bind("_isVisible").to(e,"proposedWidth",e,"proposedHeight",(t,e)=>null!==t&&null!==e),this.bind("_label").to(e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",e,"proposedWidthPercents",(e,i,n)=>"px"===t.unit?`${e}\xd7${i}`:n+"%"),this.bind("_viewPosition").to(e,"activeHandlePosition",e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",(t,e,i)=>e<50||i<50?"above-center":t)}_dismiss(){this.unbind(),this._isVisible=!1}}class wf{constructor(t){this._options=t,this._viewResizerWrapper=null,this.set("isEnabled",!0),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",t=>{this.state.proposedWidth||this.state.proposedWidthPercents||(this._cleanup(),t.stop())},{priority:"high"}),this.on("change:isEnabled",()=>{this.isEnabled&&this.redraw()})}attach(){const t=this,e=this._options.viewElement;this._options.editor.editing.view.change(i=>{const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(e){const i=this.toDomElement(e);return t._appendHandles(i),t._appendSizeUI(i),t.on("change:isEnabled",(t,e,n)=>{i.style.display=n?"":"none"}),i.style.display=t.isEnabled?"":"none",i});i.insert(i.createPositionAt(e,"end"),n),i.addClass("ck-widget_with-resizer",e),this._viewResizerWrapper=n})}begin(t){this.state=new yf(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(t,this._getHandleHost(),this._getResizeHost())}updateSize(t){const e=this._proposeNewSize(t);this._options.editor.editing.view.change(t=>{const i=this._options.unit||"%";t.setStyle("width",("%"===i?e.widthPercents:e.width)+i,this._options.viewElement)});const i=this._getHandleHost(),n=new ar(i);e.handleHostWidth=Math.round(n.width),e.handleHostHeight=Math.round(n.height);const o=new ar(i);e.width=Math.round(o.width),e.height=Math.round(o.height),this.redraw(n),this.state.update(e)}commit(){const t=this._options.unit||"%",e=("%"===t?this.state.proposedWidthPercents:this.state.proposedWidth)+t;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(e)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(t){const e=this._domResizerWrapper;if(!((i=e)&&i.ownerDocument&&i.ownerDocument.contains(i)))return;var i;const n=e.parentElement,o=this._getHandleHost(),r=this._viewResizerWrapper,s=[r.getStyle("width"),r.getStyle("height"),r.getStyle("left"),r.getStyle("top")];let a;if(n.isSameNode(o)){const e=t||new ar(o);a=[e.width+"px",e.height+"px",void 0,void 0]}else a=[o.offsetWidth+"px",o.offsetHeight+"px",o.offsetLeft+"px",o.offsetTop+"px"];"same"!==ri(s,a)&&this._options.editor.editing.view.change(t=>{t.setStyle({width:a[0],height:a[1],left:a[2],top:a[3]},r)})}containsHandle(t){return this._domResizerWrapper.contains(t)}static isResizeHandle(t){return t.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(t=>{t.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(t){const e=this.state,i=(o=t).pageX,n=o.pageY;var o;const r=!this._options.isCentered||this._options.isCentered(this),s={x:e._referenceCoordinates.x-(i+e.originalWidth),y:n-e.originalHeight-e._referenceCoordinates.y};r&&e.activeHandlePosition.endsWith("-right")&&(s.x=i-(e._referenceCoordinates.x+e.originalWidth)),r&&(s.x*=2);const a={width:Math.abs(e.originalWidth+s.x),height:Math.abs(e.originalHeight+s.y)};a.dominant=a.width/e.aspectRatio>a.height?"width":"height",a.max=a[a.dominant];const l={width:a.width,height:a.height};return"width"==a.dominant?l.height=l.width/e.aspectRatio:l.width=l.height*e.aspectRatio,{width:Math.round(l.width),height:Math.round(l.height),widthPercents:Math.min(Math.round(e.originalWidthPercents/e.originalWidth*l.width*100)/100,100)}}_getResizeHost(){return this._options.getResizeHost(this._domResizerWrapper.parentElement)}_getHandleHost(){return this._options.getHandleHost(this._domResizerWrapper.parentElement)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(t){const e=["top-left","top-right","bottom-right","bottom-left"];for(const n of e)t.appendChild(new dl({tag:"div",attributes:{class:"ck-widget__resizer__handle "+(i=n,"ck-widget__resizer__handle-"+i)}}).render());var i}_appendSizeUI(t){this._sizeView=new bf,this._sizeView.render(),t.appendChild(this._sizeView.element)}}Pt(wf,Et),i(76);class kf extends Mt{static get pluginName(){return"WidgetResize"}init(){const t=this.editor.editing,e=co.window.document;this.set("visibleResizer",null),this.set("_activeResizer",null),this._resizers=new Map,t.view.addObserver(Hc),this._observer=Object.create(wo),this.listenTo(t.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(e,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(e,"mouseup",this._mouseUpListener.bind(this));const i=()=>{this.visibleResizer&&this.visibleResizer.redraw()};this._redrawFocusedResizerThrottled=Qh(i,200),this.on("change:visibleResizer",i),this.editor.ui.on("update",this._redrawFocusedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[t,e]of this._resizers)t.isAttached()||(this._resizers.delete(t),e.destroy())},{priority:"lowest"}),this._observer.listenTo(co.window,"resize",this._redrawFocusedResizerThrottled);const n=this.editor.editing.view.document.selection;n.on("change",()=>{const t=n.getSelectedElement();this.visibleResizer=this.getResizerByViewElement(t)||null})}destroy(){this._observer.stopListening();for(const t of this._resizers.values())t.destroy();this._redrawFocusedResizerThrottled.cancel()}attachTo(t){const e=new wf(t),i=this.editor.plugins;if(e.attach(),i.has("WidgetToolbarRepository")){const t=i.get("WidgetToolbarRepository");e.on("begin",()=>{t.forceDisabled("resize")},{priority:"lowest"}),e.on("cancel",()=>{t.clearForceDisabled("resize")},{priority:"highest"}),e.on("commit",()=>{t.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(t.viewElement,e);const n=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(n)==e&&(this.visibleResizer=e),e}getResizerByViewElement(t){return this._resizers.get(t)}_getResizerByHandle(t){for(const e of this._resizers.values())if(e.containsHandle(t))return e}_mouseDownListener(t,e){const i=e.domTarget;wf.isResizeHandle(i)&&(this._activeResizer=this._getResizerByHandle(i),this._activeResizer&&(this._activeResizer.begin(i),t.stop(),e.preventDefault()))}_mouseMoveListener(t,e){this._activeResizer&&this._activeResizer.updateSize(e)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}Pt(kf,Et);class _f extends Nt{refresh(){const t=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!t,this.value=!(!this.isEnabled||!t.hasAttribute("alt"))&&t.getAttribute("alt")}execute(t){const e=this.editor,i=e.plugins.get("ImageUtils"),n=e.model,o=i.getClosestSelectedImageElement(n.document.selection);n.change(e=>{e.setAttribute("alt",t.newValue,o)})}}function xf(t,e){const i=t.createEmptyElement("img"),n="imageBlock"===e?t.createContainerElement("figure",{class:"image"}):t.createContainerElement("span",{class:"image-inline"},{isAllowedInsideAttributeElement:!0});return t.insert(t.createPositionAt(n,0),i),n}function Cf(t,e){if(t.plugins.has("ImageInlineEditing")!==t.plugins.has("ImageBlockEditing"))return{name:"img"};const i=t.plugins.get("ImageUtils");return t=>i.isInlineImageView(t)?(t.findAncestor(i.isBlockImageView)?"imageBlock":"imageInline")!==e?null:{name:!0}:null}function Ef(t,e){const i=fr(e.getSelectedBlocks());return!i||t.isObject(i)||i.isEmpty&&"listItem"!=i.name?"imageBlock":"imageInline"}class Tf extends Mt{static get pluginName(){return"ImageUtils"}isImage(t){return this.isInlineImage(t)||this.isBlockImage(t)}isInlineImageView(t){return!!t&&t.is("element","img")}isBlockImageView(t){return!!t&&t.is("element","figure")&&t.hasClass("image")}insertImage(t={},e=null,i=null){const n=this.editor,o=n.model,r=o.document.selection;i=Sf(n,e||r,i),t={...Object.fromEntries(r.getAttributes()),...t};for(const s in t)o.schema.checkAttribute(i,s)||delete t[s];return o.change(n=>{const s=n.createElement(i,t);return e||"imageInline"==i||(e=Bh(r,o)),o.insertContent(s,e),s.parent?(n.setSelection(s,"on"),s):null})}getClosestSelectedImageWidget(t){const e=t.getSelectedElement();if(e&&this.isImageWidget(e))return e;let i=t.getFirstPosition().parent;for(;i;){if(i.is("element")&&this.isImageWidget(i))return i;i=i.parent}return null}getClosestSelectedImageElement(t){const e=t.getSelectedElement();return this.isImage(e)?e:t.getFirstPosition().findAncestor("imageBlock")}isImageAllowed(){const t=this.editor.model.document.selection;return function(t,e){if("imageBlock"==Sf(t,e)){const i=function(t,e){const i=Bh(t,e).start.parent;return i.isEmpty&&!i.is("element","$root")?i.parent:i}(e,t.model);if(t.model.schema.checkChild(i,"imageBlock"))return!0}else if(t.model.schema.checkChild(e.focus,"imageInline"))return!0;return!1}(this.editor,t)&&function(t){return[...t.focus.getAncestors()].every(t=>!t.is("element","imageBlock"))}(t)}toImageWidget(t,e,i){return e.setCustomProperty("image",!0,t),Dh(t,e,{label:()=>{const e=this.findViewImgElement(t).getAttribute("alt");return e?`${e} ${i}`:i}})}isImageWidget(t){return!!t.getCustomProperty("image")&&Mh(t)}isBlockImage(t){return!!t&&t.is("element","imageBlock")}isInlineImage(t){return!!t&&t.is("element","imageInline")}findViewImgElement(t){if(this.isInlineImageView(t))return t;const e=this.editor.editing.view;for(const{item:i}of e.createRangeIn(t))if(this.isInlineImageView(i))return i}}function Sf(t,e,i){const n=t.model.schema,o=t.config.get("image.insert.type");return t.plugins.has("ImageBlockEditing")?t.plugins.has("ImageInlineEditing")?i||("inline"===o?"imageInline":"block"===o?"imageBlock":e.is("selection")?Ef(n,e):n.checkChild(e,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}class Af extends Mt{static get requires(){return[Tf]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new _f(this.editor))}}i(78),i(7);class Of extends hl{constructor(t){super(t);const e=this.locale.t;this.focusTracker=new pr,this.keystrokes=new gr,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(e("Save"),rl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(e("Cancel"),rl.cancel,"ck-button-cancel","cancel"),this._focusables=new cl,this._focusCycler=new Fl({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]}),al(this)}render(){super.render(),this.keystrokes.listenTo(this.element),ll({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)})}_createButton(t,e,i,n){const o=new Dl(this.locale);return o.set({label:t,icon:e,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}_createLabeledInputView(){const t=this.locale.t,e=new dc(this.locale,uc);return e.label=t("Text alternative"),e}}function If(t){const e=t.editing.view,i=vc.defaultPositions,n=t.plugins.get("ImageUtils");return{target:e.domConverter.viewToDom(n.getClosestSelectedImageWidget(e.document.selection)),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}class Pf extends Mt{static get requires(){return[_c]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton(),this._createForm()}destroy(){super.destroy(),this._form.destroy()}_createButton(){const t=this.editor,e=t.t;t.ui.componentFactory.add("imageTextAlternative",i=>{const n=t.commands.get("imageTextAlternative"),o=new Dl(i);return o.set({label:e("Change image text alternative"),icon:rl.lowVision,tooltip:!0}),o.bind("isEnabled").to(n,"isEnabled"),this.listenTo(o,"execute",()=>{this._showForm()}),o})}_createForm(){const t=this.editor,e=t.editing.view.document,i=t.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new Of(t.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{t.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(t,e)=>{this._hideForm(!0),e()}),this.listenTo(t.ui,"update",()=>{i.getClosestSelectedImageWidget(e.selection)?this._isVisible&&function(t){const e=t.plugins.get("ContextualBalloon");if(t.plugins.get("ImageUtils").getClosestSelectedImageWidget(t.editing.view.document.selection)){const i=If(t);e.updatePosition(i)}}(t):this._hideForm(!0)}),sl({emitter:this._form,activator:()=>this._isVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;const t=this.editor,e=t.commands.get("imageTextAlternative"),i=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:If(t)}),i.fieldView.value=i.fieldView.element.value=e.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(t){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),t&&this.editor.editing.view.focus())}get _isVisible(){return this._balloon.visibleView===this._form}get _isInBalloon(){return this._balloon.hasView(this._form)}}class Mf extends Mt{static get requires(){return[Af,Pf]}static get pluginName(){return"ImageTextAlternative"}}function Df(t,e){return t=>{t.on("attribute:srcset:"+e,i)};function i(e,i,n){if(!n.consumable.consume(i.item,e.name))return;const o=n.writer,r=n.mapper.toViewElement(i.item),s=t.findViewImgElement(r);if(null===i.attributeNewValue){const t=i.attributeOldValue;t.data&&(o.removeAttribute("srcset",s),o.removeAttribute("sizes",s),t.width&&o.removeAttribute("width",s))}else{const t=i.attributeNewValue;t.data&&(o.setAttribute("srcset",t.data,s),o.setAttribute("sizes","100vw",s),t.width&&o.setAttribute("width",t.width,s))}}}function Nf(t,e,i){return t=>{t.on(`attribute:${i}:${e}`,n)};function n(e,i,n){if(!n.consumable.consume(i.item,e.name))return;const o=n.writer,r=n.mapper.toViewElement(i.item),s=t.findViewImgElement(r);o.setAttribute(i.attributeKey,i.attributeNewValue||"",s)}}class Rf extends xo{observe(t){this.listenTo(t,"load",(t,e)=>{const i=e.target;this.checkShouldIgnoreEventFromTarget(i)||"IMG"==i.tagName&&this._fireEvents(e)},{useCapture:!0})}_fireEvents(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}}class zf extends Nt{constructor(t){super(t);const e=t.config.get("image.insert.type");t.plugins.has("ImageBlockEditing")||"block"===e&&Object(a.b)("image-block-plugin-required"),t.plugins.has("ImageInlineEditing")||"inline"===e&&Object(a.b)("image-inline-plugin-required")}refresh(){this.isEnabled=this.editor.plugins.get("ImageUtils").isImageAllowed()}execute(t){const e=Je(t.source),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());e.forEach((t,e)=>{const r=i.getSelectedElement();if("string"==typeof t&&(t={src:t}),e&&r&&n.isImage(r)){const e=this.editor.model.createPositionAfter(r);n.insertImage({...t,...o},e)}else n.insertImage({...t,...o})})}}class Ff extends Mt{static get requires(){return[Tf]}static get pluginName(){return"ImageEditing"}init(){const t=this.editor,e=t.conversion;t.editing.view.addObserver(Rf),e.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:{key:"srcset",value:t=>{const e={data:t.getAttribute("srcset")};return t.hasAttribute("width")&&(e.width=t.getAttribute("width")),e}}});const i=new zf(t);t.commands.add("insertImage",i),t.commands.add("imageInsert",i)}}class Lf extends Nt{constructor(t,e){super(t),this._modelElementName=e}refresh(){const t=this.editor.plugins.get("ImageUtils"),e=t.getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled="imageBlock"===this._modelElementName?t.isInlineImage(e):t.isBlockImage(e)}execute(){const t=this.editor.model,e=this.editor.plugins.get("ImageUtils"),i=e.getClosestSelectedImageElement(t.document.selection),n=Object.fromEntries(i.getAttributes());return n.src||n.uploadId?t.change(o=>{const r=Array.from(t.markers).filter(t=>t.getRange().containsItem(i)),s=e.insertImage(n,t.createSelection(i,"on"),this._modelElementName);if(!s)return null;const a=o.createRangeOn(s);for(const t of r){const e=t.getRange(),i="$graveyard"!=e.root.rootName?e.getJoined(a,!0):a;o.updateMarker(t,{range:i})}return{oldElement:i,newElement:s}}):null}}class Bf extends Mt{static get requires(){return[Ff,Tf,yh]}static get pluginName(){return"ImageBlockEditing"}init(){const t=this.editor;t.model.schema.register("imageBlock",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),t.plugins.has("ImageInlineEditing")&&(t.commands.add("imageTypeBlock",new Lf(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,n=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageBlock",view:(t,{writer:e})=>xf(e,"imageBlock")}),i.for("editingDowncast").elementToElement({model:"imageBlock",view:(t,{writer:i})=>n.toImageWidget(xf(i,"imageBlock"),i,e("image widget"))}),i.for("downcast").add(Nf(n,"imageBlock","src")).add(Nf(n,"imageBlock","alt")).add(Df(n,"imageBlock")),i.for("upcast").elementToElement({view:Cf(t,"imageBlock"),model:(t,{writer:e})=>e.createElement("imageBlock",t.hasAttribute("src")?{src:t.getAttribute("src")}:null)}).add(function(t){return t=>{t.on("element:figure",e)};function e(e,i,n){if(!n.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const o=t.findViewImgElement(i.viewItem);if(!o||!n.consumable.test(o,{name:!0}))return;const r=fr(n.convertItem(o,i.modelCursor).modelRange.getItems());r&&(n.consumable.consume(i.viewItem,{name:!0,classes:"image"}),n.convertChildren(i.viewItem,r),n.updateConversionResult(r,i))}}(n))}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,n=t.plugins.get("ImageUtils");this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(o,r)=>{const s=Array.from(r.content.getChildren());let a;if(!s.every(n.isInlineImageView))return;a=r.targetRanges?t.editing.mapper.toModelRange(r.targetRanges[0]):e.document.selection.getFirstRange();const l=e.createSelection(a);if("imageBlock"===Ef(e.schema,l)){const t=new Wc(i.document),e=s.map(e=>t.createElement("figure",{class:"image"},e));r.content=t.createDocumentFragment(e)}})}}i(11);class jf extends Mt{static get requires(){return[Bf,Xh,Mf]}static get pluginName(){return"ImageBlock"}}class Vf extends Mt{static get requires(){return[Ff,Tf,yh]}static get pluginName(){return"ImageInlineEditing"}init(){const t=this.editor,e=t.model.schema;e.register("imageInline",{isObject:!0,isInline:!0,allowWhere:"$text",allowAttributes:["alt","src","srcset"]}),e.addChildCheck((t,e)=>{if(t.endsWith("caption")&&"imageInline"===e.name)return!1}),this._setupConversion(),t.plugins.has("ImageBlockEditing")&&(t.commands.add("imageTypeInline",new Lf(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,n=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(t,{writer:e})=>e.createEmptyElement("img")}),i.for("editingDowncast").elementToElement({model:"imageInline",view:(t,{writer:i})=>n.toImageWidget(xf(i,"imageInline"),i,e("image widget"))}),i.for("downcast").add(Nf(n,"imageInline","src")).add(Nf(n,"imageInline","alt")).add(Df(n,"imageInline")),i.for("upcast").elementToElement({view:Cf(t,"imageInline"),model:(t,{writer:e})=>e.createElement("imageInline",t.hasAttribute("src")?{src:t.getAttribute("src")}:null)})}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,n=t.plugins.get("ImageUtils");this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(o,r)=>{const s=Array.from(r.content.getChildren());let a;if(!s.every(n.isBlockImageView))return;a=r.targetRanges?t.editing.mapper.toModelRange(r.targetRanges[0]):e.document.selection.getFirstRange();const l=e.createSelection(a);if("imageInline"===Ef(e.schema,l)){const t=new Wc(i.document),e=s.map(e=>1===e.childCount?(Array.from(e.getAttributes()).forEach(i=>t.setAttribute(...i,n.findViewImgElement(e))),e.getChild(0)):e);r.content=t.createDocumentFragment(e)}})}}class Hf extends Mt{static get requires(){return[Vf,Xh,Mf]}static get pluginName(){return"ImageInline"}}function Wf(t){for(const e of t.getChildren())if(e&&e.is("element","caption"))return e;return null}function qf(t,e){const i=e.getFirstPosition().findAncestor("caption");return i&&t.isBlockImage(i.parent)?i:null}class Uf extends Nt{refresh(){const t=this.editor,e=t.plugins.get("ImageUtils");if(!t.plugins.has(Bf))return this.isEnabled=!1,void(this.value=!1);const i=t.model.document.selection,n=i.getSelectedElement();if(!n){const t=qf(e,i);return this.isEnabled=!!t,void(this.value=!!t)}this.isEnabled=this.editor.plugins.get("ImageUtils").isImage(n),this.value=!!this.isEnabled&&!!Wf(n)}execute(t={}){const{focusCaptionOnShow:e}=t;this.editor.model.change(t=>{this.value?this._hideImageCaption(t):this._showImageCaption(t,e)})}_showImageCaption(t,e){const i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageCaptionEditing");let o=i.getSelectedElement();const r=n._getSavedCaption(o);this.editor.plugins.get("ImageUtils").isInlineImage(o)&&(this.editor.execute("imageTypeBlock"),o=i.getSelectedElement());const s=r||t.createElement("caption");t.append(s,o),e&&t.setSelection(s,"in")}_hideImageCaption(t){const e=this.editor,i=e.model.document.selection,n=e.plugins.get("ImageCaptionEditing"),o=e.plugins.get("ImageUtils");let r,s=i.getSelectedElement();s?r=Wf(s):(r=qf(o,i),s=r.parent),n._saveCaption(s,r),t.setSelection(s,"on"),t.remove(r)}}class Yf extends Mt{static get requires(){return[Tf]}static get pluginName(){return"ImageCaptionEditing"}constructor(t){super(t),this._savedCaptionsMap=new WeakMap}init(){const t=this.editor,e=t.model.schema;e.isRegistered("caption")?e.extend("caption",{allowIn:"imageBlock"}):e.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),t.commands.add("toggleImageCaption",new Uf(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration()}_setupConversion(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageUtils"),n=t.t;t.conversion.for("upcast").elementToElement({view:t=>function(t,e){return"figcaption"==e.name&&t.isBlockImageView(e.parent)?{name:!0}:null}(i,t),model:"caption"}),t.conversion.for("dataDowncast").elementToElement({model:"caption",view:(t,{writer:e})=>i.isBlockImage(t.parent)?e.createContainerElement("figcaption"):null}),t.conversion.for("editingDowncast").elementToElement({model:"caption",view:(t,{writer:o})=>{if(!i.isBlockImage(t.parent))return null;const r=o.createEditableElement("figcaption");return o.setCustomProperty("imageCaption",!0,r),Tc({view:e,element:r,text:n("Enter image caption"),keepOnFocus:!0}),Lh(r,o)}}),t.editing.mapper.on("modelToViewPosition",Gf(e)),t.data.mapper.on("modelToViewPosition",Gf(e))}_setupImageTypeCommandsIntegration(){const t=this.editor,e=t.plugins.get("ImageUtils"),i=t.commands.get("imageTypeInline"),n=t.commands.get("imageTypeBlock"),o=t=>{if(!t.return)return;const{oldElement:i,newElement:n}=t.return;if(!i)return;if(e.isBlockImage(i)){const t=Wf(i);if(t)return void this._saveCaption(n,t)}const o=this._getSavedCaption(i);o&&this._saveCaption(n,o)};i&&this.listenTo(i,"execute",o,{priority:"low"}),n&&this.listenTo(n,"execute",o,{priority:"low"})}_getSavedCaption(t){const e=this._savedCaptionsMap.get(t);return e?Mr.fromJSON(e):null}_saveCaption(t,e){this._savedCaptionsMap.set(t,e.toJSON())}}function Gf(t){return(e,i)=>{const n=i.modelPosition,o=n.parent;if(!o.is("element","imageBlock"))return;const r=i.mapper.toViewElement(o);i.viewPosition=t.createPositionAt(r,n.offset+1)}}class Zf extends Mt{static get requires(){return[Tf]}static get pluginName(){return"ImageCaptionUI"}init(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageUtils"),n=t.t;t.ui.componentFactory.add("toggleImageCaption",o=>{const r=t.commands.get("toggleImageCaption"),s=new Dl(o);return s.set({icon:rl.caption,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(r,"value","isEnabled"),s.bind("label").to(r,"value",t=>n(t?"Toggle caption off":"Toggle caption on")),this.listenTo(s,"execute",()=>{t.execute("toggleImageCaption",{focusCaptionOnShow:!0});const n=qf(i,t.model.document.selection);if(n){const i=t.editing.mapper.toViewElement(n);e.scrollToTheSelection(),e.change(t=>{t.addClass("image__caption_highlighted",i)})}}),s})}}i(82);class $f extends Nt{refresh(){const t=this.editor,e=t.plugins.get("ImageUtils").getClosestSelectedImageElement(t.model.document.selection);this.isEnabled=!!e,this.value=e&&e.hasAttribute("width")?{width:e.getAttribute("width"),height:null}:null}execute(t){const e=this.editor,i=e.model,n=e.plugins.get("ImageUtils").getClosestSelectedImageElement(i.document.selection);this.value={width:t.width,height:null},n&&i.change(e=>{e.setAttribute("width",t.width,n)})}}class Xf extends Mt{static get requires(){return[Tf]}static get pluginName(){return"ImageResizeEditing"}constructor(t){super(t),t.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const t=this.editor,e=new $f(t);this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline"),t.commands.add("resizeImage",e),t.commands.add("imageResize",e)}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:"width"}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:"width"})}_registerConverters(t){const e=this.editor;e.conversion.for("downcast").add(e=>e.on("attribute:width:"+t,(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const n=i.writer,o=i.mapper.toViewElement(e.item);null!==e.attributeNewValue?(n.setStyle("width",e.attributeNewValue,o),n.addClass("image_resized",o)):(n.removeStyle("width",o),n.removeClass("image_resized",o))})),e.conversion.for("upcast").attributeToAttribute({view:{name:"imageBlock"===t?"figure":"img",styles:{width:/.+/}},model:{key:"width",value:t=>t.getStyle("width")}})}}const Kf={small:rl.objectSizeSmall,medium:rl.objectSizeMedium,large:rl.objectSizeLarge,original:rl.objectSizeFull};class Qf extends Mt{static get requires(){return[Xf]}static get pluginName(){return"ImageResizeButtons"}constructor(t){super(t),this._resizeUnit=t.config.get("image.resizeUnit")}init(){const t=this.editor,e=t.config.get("image.resizeOptions"),i=t.commands.get("resizeImage");this.bind("isEnabled").to(i);for(const n of e)this._registerImageResizeButton(n);this._registerImageResizeDropdown(e)}_registerImageResizeButton(t){const e=this.editor,{name:i,value:n,icon:o}=t,r=n?n+this._resizeUnit:null;e.ui.componentFactory.add(i,i=>{const n=new Dl(i),s=e.commands.get("resizeImage"),l=this._getOptionLabelValue(t,!0);if(!Kf[o])throw new a.a("imageresizebuttons-missing-icon",e,t);return n.set({label:l,icon:Kf[o],tooltip:l,isToggleable:!0}),n.bind("isEnabled").to(this),n.bind("isOn").to(s,"value",Jf(r)),this.listenTo(n,"execute",()=>{e.execute("resizeImage",{width:r})}),n})}_registerImageResizeDropdown(t){const e=this.editor,i=e.t,n=t.find(t=>!t.value),o=o=>{const r=e.commands.get("resizeImage"),s=nc(o,Vl),a=s.buttonView;return a.set({tooltip:i("Resize image"),commandValue:n.value,icon:Kf.medium,isToggleable:!0,label:this._getOptionLabelValue(n),withText:!0,class:"ck-resize-image-button"}),a.bind("label").to(r,"value",t=>t&&t.width?t.width:this._getOptionLabelValue(n)),s.bind("isOn").to(r),s.bind("isEnabled").to(this),rc(s,this._getResizeDropdownListItemDefinitions(t,r)),s.listView.ariaLabel=i("Image resize list"),this.listenTo(s,"execute",t=>{e.execute(t.source.commandName,{width:t.source.commandValue}),e.editing.view.focus()}),s};e.ui.componentFactory.add("resizeImage",o),e.ui.componentFactory.add("imageResize",o)}_getOptionLabelValue(t,e){const i=this.editor.t;return t.label?t.label:e?t.value?i("Resize image to %0",t.value+this._resizeUnit):i("Resize image to the original size"):t.value?t.value+this._resizeUnit:i("Original")}_getResizeDropdownListItemDefinitions(t,e){const i=new Ke;return t.map(t=>{const n=t.value?t.value+this._resizeUnit:null,o={type:"button",model:new pc({commandName:"resizeImage",commandValue:n,label:this._getOptionLabelValue(t),withText:!0,icon:null})};o.model.bind("isOn").to(e,"value",Jf(n)),i.add(o)}),i}}function Jf(t){return e=>null===t&&e===t||e&&e.width===t}const tp=/(image|image-inline)/;class ep extends Mt{static get requires(){return[kf]}static get pluginName(){return"ImageResizeHandles"}init(){const t=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(t),this._setupResizerCreator()}_setupResizerCreator(){const t=this.editor,e=t.editing.view;e.addObserver(Rf),this.listenTo(e.document,"imageLoaded",(i,n)=>{if(!n.target.matches("figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img"))return;const o=t.editing.view.domConverter,r=o.domToView(n.target).findAncestor({classes:tp});let s=this.editor.plugins.get(kf).getResizerByViewElement(r);if(s)return void s.redraw();const a=t.editing.mapper,l=a.toModelElement(r);s=t.plugins.get(kf).attachTo({unit:t.config.get("image.resizeUnit"),modelElement:l,viewElement:r,editor:t,getHandleHost:t=>t.querySelector("img"),getResizeHost:()=>o.viewToDom(a.toViewElement(l.parent)),isCentered(){const t=l.getAttribute("imageStyle");return!t||"block"==t||"alignCenter"==t},onCommit(i){e.change(t=>{t.removeClass("image_resized",r)}),t.execute("resizeImage",{width:i})}}),s.on("updateSize",()=>{r.hasClass("image_resized")||e.change(t=>{t.addClass("image_resized",r)})}),s.bind("isEnabled").to(this)})}}i(84);class ip extends Nt{constructor(t,e){super(t),this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(e.map(t=>{if(t.isDefault)for(const e of t.modelElements)this._defaultStyles[e]=t.name;return[t.name,t]}))}refresh(){const t=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!t,this.value=!!this.isEnabled&&(t.hasAttribute("imageStyle")?t.getAttribute("imageStyle"):this._defaultStyles[t.name])}execute(t={}){const e=this.editor,i=e.model,n=e.plugins.get("ImageUtils");i.change(e=>{const o=t.value;let r=n.getClosestSelectedImageElement(i.document.selection);o&&this.shouldConvertImageType(o,r)&&(this.editor.execute(n.isBlockImage(r)?"imageTypeInline":"imageTypeBlock"),r=n.getClosestSelectedImageElement(i.document.selection)),!o||this._styles.get(o).isDefault?e.removeAttribute("imageStyle",r):e.setAttribute("imageStyle",o,r)})}shouldConvertImageType(t,e){return!this._styles.get(t).modelElements.includes(e.name)}}const{objectFullWidth:np,objectInline:op,objectLeft:rp,objectRight:sp,objectCenter:ap,objectBlockLeft:lp,objectBlockRight:cp}=rl,hp={inline:{name:"inline",title:"In line",icon:op,modelElements:["imageInline"],isDefault:!0},alignLeft:{name:"alignLeft",title:"Left aligned image",icon:rp,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"},alignBlockLeft:{name:"alignBlockLeft",title:"Left aligned image",icon:lp,modelElements:["imageBlock"],className:"image-style-block-align-left"},alignCenter:{name:"alignCenter",title:"Centered image",icon:ap,modelElements:["imageBlock"],className:"image-style-align-center"},alignRight:{name:"alignRight",title:"Right aligned image",icon:sp,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"},alignBlockRight:{name:"alignBlockRight",title:"Right aligned image",icon:cp,modelElements:["imageBlock"],className:"image-style-block-align-right"},block:{name:"block",title:"Centered image",icon:ap,modelElements:["imageBlock"],isDefault:!0},side:{name:"side",title:"Side image",icon:sp,modelElements:["imageBlock"],className:"image-style-side"}},dp={full:np,left:lp,right:cp,center:ap,inlineLeft:rp,inlineRight:sp,inline:op},up=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function fp(t){Object(a.b)("image-style-configuration-definition-invalid",t)}var pp={normalizeStyles:function(t){return(t.configuredStyles.options||[]).map(t=>function(t){return"string"==typeof(t="string"==typeof t?hp[t]?{...hp[t]}:{name:t}:function(t,e){const i={...e};for(const n in t)Object.prototype.hasOwnProperty.call(e,n)||(i[n]=t[n]);return i}(hp[t.name],t)).icon&&(t.icon=dp[t.icon]||t.icon),t}(t)).filter(e=>function(t,{isBlockPluginLoaded:e,isInlinePluginLoaded:i}){const{modelElements:n,name:o}=t;if(!(n&&n.length&&o))return fp({style:t}),!1;{const o=[e?"imageBlock":null,i?"imageInline":null];if(!n.some(t=>o.includes(t)))return Object(a.b)("image-style-missing-dependency",{style:t,missingPlugins:n.map(t=>"imageBlock"===t?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}(e,t))},getDefaultStylesConfiguration:function(t,e){return t&&e?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:t?{options:["block","side"]}:e?{options:["inline","alignLeft","alignRight"]}:{}},getDefaultDropdownDefinitions:function(t){return t.has("ImageBlockEditing")&&t.has("ImageInlineEditing")?[...up]:[]},warnInvalidStyle:fp,DEFAULT_OPTIONS:hp,DEFAULT_ICONS:dp,DEFAULT_DROPDOWN_DEFINITIONS:up};function gp(t,e){for(const i of e)if(i.name===t)return i}class mp extends Mt{static get pluginName(){return"ImageStyleEditing"}static get requires(){return[Tf]}init(){const{normalizeStyles:t,getDefaultStylesConfiguration:e}=pp,i=this.editor,n=i.plugins.has("ImageBlockEditing"),o=i.plugins.has("ImageInlineEditing");i.config.define("image.styles",e(n,o)),this.normalizedStyles=t({configuredStyles:i.config.get("image.styles"),isBlockPluginLoaded:n,isInlinePluginLoaded:o}),this._setupConversion(n,o),this._setupPostFixer(),i.commands.add("imageStyle",new ip(i,this.normalizedStyles))}_setupConversion(t,e){const i=this.editor,n=i.model.schema,o=(r=this.normalizedStyles,(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const n=gp(e.attributeNewValue,r),o=gp(e.attributeOldValue,r),s=i.mapper.toViewElement(e.item),a=i.writer;o&&a.removeClass(o.className,s),n&&a.addClass(n.className,s)});var r;const s=function(t){const e={imageInline:t.filter(t=>!t.isDefault&&t.modelElements.includes("imageInline")),imageBlock:t.filter(t=>!t.isDefault&&t.modelElements.includes("imageBlock"))};return(t,i,n)=>{if(!i.modelRange)return;const o=i.viewItem,r=fr(i.modelRange.getItems());if(r&&n.schema.checkAttribute(r,"imageStyle"))for(const s of e[r.name])n.consumable.consume(o,{classes:s.className})&&n.writer.setAttribute("imageStyle",s.name,r)}}(this.normalizedStyles);i.editing.downcastDispatcher.on("attribute:imageStyle",o),i.data.downcastDispatcher.on("attribute:imageStyle",o),t&&(n.extend("imageBlock",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:figure",s,{priority:"low"})),e&&(n.extend("imageInline",{allowAttributes:"imageStyle"}),i.data.upcastDispatcher.on("element:img",s,{priority:"low"}))}_setupPostFixer(){const t=this.editor,e=t.model.document,i=t.plugins.get(Tf),n=new Map(this.normalizedStyles.map(t=>[t.name,t]));e.registerPostFixer(t=>{let o=!1;for(const r of e.differ.getChanges())if("insert"==r.type||"attribute"==r.type&&"imageStyle"==r.attributeKey){let e="insert"==r.type?r.position.nodeAfter:r.range.start.nodeAfter;if(e&&e.is("element","paragraph")&&e.childCount>0&&(e=e.getChild(0)),!i.isImage(e))continue;const s=e.getAttribute("imageStyle");if(!s)continue;const a=n.get(s);a&&a.modelElements.includes(e.name)||(t.removeAttribute("imageStyle",e),o=!0)}return o})}}i(86);class vp extends Mt{static get requires(){return[mp]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const t=this.editor.t;return{"Wrap text":t("Wrap text"),"Break text":t("Break text"),"In line":t("In line"),"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}init(){const t=this.editor.plugins,e=this.editor.config.get("image.toolbar")||[],i=yp(t.get("ImageStyleEditing").normalizedStyles,this.localizedDefaultStylesTitles);for(const o of i)this._createButton(o);const n=yp([...e.filter(y),...pp.getDefaultDropdownDefinitions(t)],this.localizedDefaultStylesTitles);for(const o of n)this._createDropdown(o,i)}_createDropdown(t,e){const i=this.editor.ui.componentFactory;i.add(t.name,n=>{let o;const{defaultItem:r,items:s,title:a}=t,l=s.filter(t=>e.find(({name:e})=>bp(e)===t)).map(t=>{const e=i.create(t);return t===r&&(o=e),e});s.length!==l.length&&pp.warnInvalidStyle({dropdown:t});const c=nc(n,Hl),h=c.buttonView;return oc(c,l),h.set({label:wp(a,o.label),class:null,tooltip:!0}),h.bind("icon").toMany(l,"isOn",(...t)=>{const e=t.findIndex(H);return e<0?o.icon:l[e].icon}),h.bind("label").toMany(l,"isOn",(...t)=>{const e=t.findIndex(H);return wp(a,e<0?o.label:l[e].label)}),h.bind("isOn").toMany(l,"isOn",(...t)=>t.some(H)),h.bind("class").toMany(l,"isOn",(...t)=>t.some(H)?"ck-splitbutton_flatten":null),h.on("execute",()=>{l.some(({isOn:t})=>t)?c.isOpen=!c.isOpen:o.fire("execute")}),c.bind("isEnabled").toMany(l,"isEnabled",(...t)=>t.some(H)),c})}_createButton(t){const e=t.name;this.editor.ui.componentFactory.add(bp(e),i=>{const n=this.editor.commands.get("imageStyle"),o=new Dl(i);return o.set({label:t.title,icon:t.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(n,"isEnabled"),o.bind("isOn").to(n,"value",t=>t===e),o.on("execute",this._executeCommand.bind(this,e)),o})}_executeCommand(t){this.editor.execute("imageStyle",{value:t}),this.editor.editing.view.focus()}}function yp(t,e){for(const i of t)e[i.title]&&(i.title=e[i.title]);return t}function bp(t){return"imageStyle:"+t}function wp(t,e){return(t?t+": ":"")+e}function kp(t){const e=t.map(t=>t.replace("+","\\+"));return new RegExp(`^image\\/(${e.join("|")})$`)}function _p(t){return new Promise((e,i)=>{const n=t.getAttribute("src");fetch(n).then(t=>t.blob()).then(t=>{const i=xp(t,n),o=i.replace("image/",""),r=new File([t],"image."+o,{type:i});e(r)}).catch(t=>t&&"TypeError"===t.name?function(t){return function(t){return new Promise((e,i)=>{const n=co.document.createElement("img");n.addEventListener("load",()=>{const t=co.document.createElement("canvas");t.width=n.width,t.height=n.height,t.getContext("2d").drawImage(n,0,0),t.toBlob(t=>t?e(t):i())}),n.addEventListener("error",()=>i()),n.src=t})}(t).then(e=>{const i=xp(e,t),n=i.replace("image/","");return new File([e],"image."+n,{type:i})})}(n).then(e).catch(i):i(t))})}function xp(t,e){return t.type?t.type:e.match(/data:(image\/\w+);base64/)?e.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}class Cp extends Mt{static get pluginName(){return"ImageUploadUI"}init(){const t=this.editor,e=t.t,i=i=>{const n=new Ru(i),o=t.commands.get("uploadImage"),r=t.config.get("image.upload.types"),s=kp(r);return n.set({acceptedType:r.map(t=>"image/"+t).join(","),allowMultipleFiles:!0}),n.buttonView.set({label:e("Insert image"),icon:rl.image,tooltip:!0}),n.buttonView.bind("isEnabled").to(o),n.on("done",(e,i)=>{const n=Array.from(i).filter(t=>s.test(t.type));n.length&&t.execute("uploadImage",{file:n})}),n};t.ui.componentFactory.add("uploadImage",i),t.ui.componentFactory.add("imageUpload",i)}}i(88),i(90),i(92);class Ep extends Mt{static get pluginName(){return"ImageUploadProgress"}constructor(t){super(t),this.placeholder="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 250"><rect rx="4"/></svg>')}init(){const t=this.editor;t.plugins.has("ImageBlockEditing")&&t.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",(...t)=>this.uploadStatusChange(...t)),t.plugins.has("ImageInlineEditing")&&t.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",(...t)=>this.uploadStatusChange(...t))}uploadStatusChange(t,e,i){const n=this.editor,o=e.item,r=o.getAttribute("uploadId");if(!i.consumable.consume(e.item,t.name))return;const s=n.plugins.get("ImageUtils"),a=n.plugins.get(Du),l=r?e.attributeNewValue:null,c=this.placeholder,h=n.editing.mapper.toViewElement(o),d=i.writer;if("reading"==l)return Tp(h,d),void Sp(s,c,h,d);if("uploading"==l){const t=a.loaders.get(r);return Tp(h,d),void(t?(Ap(h,d),function(t,e,i,n){const o=function(t){const e=t.createUIElement("div",{class:"ck-progress-bar"});return t.setCustomProperty("progressBar",!0,e),e}(e);e.insert(e.createPositionAt(t,"end"),o),i.on("change:uploadedPercent",(t,e,i)=>{n.change(t=>{t.setStyle("width",i+"%",o)})})}(h,d,t,n.editing.view),function(t,e,i,n){if(n.data){const o=t.findViewImgElement(e);i.setAttribute("src",n.data,o)}}(s,h,d,t)):Sp(s,c,h,d))}"complete"==l&&a.loaders.get(r)&&function(t,e,i){const n=e.createUIElement("div",{class:"ck-image-upload-complete-icon"});e.insert(e.createPositionAt(t,"end"),n),setTimeout(()=>{i.change(t=>t.remove(t.createRangeOn(n)))},3e3)}(h,d,n.editing.view),function(t,e){Ip(t,e,"progressBar")}(h,d),Ap(h,d),function(t,e){e.removeClass("ck-appear",t)}(h,d)}}function Tp(t,e){t.hasClass("ck-appear")||e.addClass("ck-appear",t)}function Sp(t,e,i,n){i.hasClass("ck-image-upload-placeholder")||n.addClass("ck-image-upload-placeholder",i);const o=t.findViewImgElement(i);o.getAttribute("src")!==e&&n.setAttribute("src",e,o),Op(i,"placeholder")||n.insert(n.createPositionAfter(o),function(t){const e=t.createUIElement("div",{class:"ck-upload-placeholder-loader"});return t.setCustomProperty("placeholder",!0,e),e}(n))}function Ap(t,e){t.hasClass("ck-image-upload-placeholder")&&e.removeClass("ck-image-upload-placeholder",t),Ip(t,e,"placeholder")}function Op(t,e){for(const i of t.getChildren())if(i.getCustomProperty(e))return i}function Ip(t,e,i){const n=Op(t,i);n&&e.remove(e.createRangeOn(n))}class Pp extends Nt{refresh(){const t=this.editor,e=t.plugins.get("ImageUtils"),i=t.model.document.selection.getSelectedElement();this.isEnabled=e.isImageAllowed()||e.isImage(i)}execute(t){const e=Je(t.file),i=this.editor.model.document.selection,n=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());e.forEach((t,e)=>{const r=i.getSelectedElement();if(e&&r&&n.isImage(r)){const e=this.editor.model.createPositionAfter(r);this._uploadImage(t,o,e)}else this._uploadImage(t,o)})}_uploadImage(t,e,i){const n=this.editor,o=n.plugins.get(Du).createLoader(t),r=n.plugins.get("ImageUtils");o&&r.insertImage({...e,uploadId:o.id},i)}}class Mp extends Mt{static get requires(){return[Du,fc,yh,Tf]}static get pluginName(){return"ImageUploadEditing"}constructor(t){super(t),t.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}init(){const t=this.editor,e=t.model.document,i=t.conversion,n=t.plugins.get(Du),o=t.plugins.get("ImageUtils"),r=kp(t.config.get("image.upload.types")),s=new Pp(t);t.commands.add("uploadImage",s),t.commands.add("imageUpload",s),i.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(t.editing.view.document,"clipboardInput",(e,i)=>{if(n=i.dataTransfer,Array.from(n.types).includes("text/html")&&""!==n.getData("text/html"))return;var n;const o=Array.from(i.dataTransfer.files).filter(t=>!!t&&r.test(t.type));o.length&&(e.stop(),t.model.change(e=>{i.targetRanges&&e.setSelection(i.targetRanges.map(e=>t.editing.mapper.toModelRange(e))),t.model.enqueueChange("default",()=>{t.execute("uploadImage",{file:o})})}))}),this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",(e,i)=>{const r=Array.from(t.editing.view.createRangeIn(i.content)).filter(t=>function(t,e){return!(!t.isInlineImageView(e)||!e.getAttribute("src"))&&(e.getAttribute("src").match(/^data:image\/\w+;base64,/g)||e.getAttribute("src").match(/^blob:/g))}(o,t.item)&&!t.item.getAttribute("uploadProcessed")).map(t=>({promise:_p(t.item),imageElement:t.item}));if(!r.length)return;const s=new Wc(t.editing.view.document);for(const t of r){s.setAttribute("uploadProcessed",!0,t.imageElement);const e=n.createLoader(t.promise);e&&(s.setAttribute("src","",t.imageElement),s.setAttribute("uploadId",e.id,t.imageElement))}}),t.editing.view.document.on("dragover",(t,e)=>{e.preventDefault()}),e.on("change",()=>{const i=e.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),o=new Set;for(const e of i)if("insert"==e.type&&"$text"!=e.name){const i=e.position.nodeAfter,r="$graveyard"==e.position.root.rootName;for(const e of Dp(t,i)){const t=e.getAttribute("uploadId");if(!t)continue;const i=n.loaders.get(t);i&&(r?o.has(t)||i.abort():(o.add(t),this._uploadImageElements.set(t,e),"idle"==i.status&&this._readAndUpload(i)))}}}),this.on("uploadComplete",(t,{imageElement:e,data:i})=>{const n=i.urls?i.urls:i;this.editor.model.change(t=>{t.setAttribute("src",n.default,e),this._parseAndSetSrcsetAttributeOnImage(n,e,t)})},{priority:"low"})}afterInit(){const t=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&t.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&t.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(t){const e=this.editor,i=e.model,n=e.locale.t,o=e.plugins.get(Du),r=e.plugins.get(fc),s=e.plugins.get("ImageUtils"),a=this._uploadImageElements;return i.enqueueChange("transparent",e=>{e.setAttribute("uploadStatus","reading",a.get(t.id))}),t.read().then(()=>{const n=t.upload(),o=a.get(t.id);if(mn){const t=e.editing.mapper.toViewElement(o),i=s.findViewImgElement(t);e.editing.view.once("render",()=>{if(!i.parent)return;const t=e.editing.view.domConverter.mapViewToDom(i.parent);if(!t)return;const n=t.style.display;t.style.display="none",t._ckHack=t.offsetHeight,t.style.display=n})}return i.enqueueChange("transparent",t=>{t.setAttribute("uploadStatus","uploading",o)}),n}).then(e=>{i.enqueueChange("transparent",i=>{const n=a.get(t.id);i.setAttribute("uploadStatus","complete",n),this.fire("uploadComplete",{data:e,imageElement:n})}),l()}).catch(e=>{if("error"!==t.status&&"aborted"!==t.status)throw e;"error"==t.status&&e&&r.showWarning(e,{title:n("Upload failed"),namespace:"upload"}),i.enqueueChange("transparent",e=>{e.remove(a.get(t.id))}),l()});function l(){i.enqueueChange("transparent",e=>{const i=a.get(t.id);e.removeAttribute("uploadId",i),e.removeAttribute("uploadStatus",i),a.delete(t.id)}),o.destroyLoader(t)}}_parseAndSetSrcsetAttributeOnImage(t,e,i){let n=0;const o=Object.keys(t).filter(t=>{const e=parseInt(t,10);if(!isNaN(e))return n=Math.max(n,e),!0}).map(e=>`${t[e]} ${e}w`).join(", ");""!=o&&i.setAttribute("srcset",{data:o,width:n},e)}}function Dp(t,e){const i=t.plugins.get("ImageUtils");return Array.from(t.model.createRangeOn(e)).filter(t=>i.isImage(t.item)).map(t=>t.item)}class Np extends Mt{static get pluginName(){return"IndentEditing"}init(){const t=this.editor;t.commands.add("indent",new zt(t)),t.commands.add("outdent",new zt(t))}}var Rp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',zp='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>';class Fp extends Mt{static get pluginName(){return"IndentUI"}init(){const t=this.editor,e=t.locale,i=t.t,n="ltr"==e.uiLanguageDirection?Rp:zp,o="ltr"==e.uiLanguageDirection?zp:Rp;this._defineButton("indent",i("Increase indent"),n),this._defineButton("outdent",i("Decrease indent"),o)}_defineButton(t,e,i){const n=this.editor;n.ui.componentFactory.add(t,o=>{const r=n.commands.get(t),s=new Dl(o);return s.set({label:e,icon:i,tooltip:!0}),s.bind("isOn","isEnabled").to(r,"value","isEnabled"),this.listenTo(s,"execute",()=>{n.execute(t),n.editing.view.focus()}),s})}}class Lp extends Nt{constructor(t,e){super(t),this._indentBehavior=e}refresh(){const t=this.editor.model,e=fr(t.document.selection.getSelectedBlocks());this.isEnabled=!(!e||!t.schema.checkAttribute(e,"blockIndent"))&&this._indentBehavior.checkEnabled(e.getAttribute("blockIndent"))}execute(){const t=this.editor.model,e=function(t){const e=t.schema;return Array.from(t.document.selection.getSelectedBlocks()).filter(t=>e.checkAttribute(t,"blockIndent"))}(t);t.change(t=>{for(const i of e){const e=i.getAttribute("blockIndent"),n=this._indentBehavior.getNextIndent(e);n?t.setAttribute("blockIndent",n,i):t.removeAttribute("blockIndent",i)}})}}class Bp{constructor(t){this.isForward="forward"===t.direction,this.offset=t.offset,this.unit=t.unit}checkEnabled(t){const e=parseFloat(t||0);return this.isForward||e>0}getNextIndent(t){const e=parseFloat(t||0);if(t&&!t.endsWith(this.unit))return this.isForward?this.offset+this.unit:void 0;const i=e+(this.isForward?this.offset:-this.offset);return i>0?i+this.unit:void 0}}class jp{constructor(t){this.isForward="forward"===t.direction,this.classes=t.classes}checkEnabled(t){const e=this.classes.indexOf(t);return this.isForward?e<this.classes.length-1:e>=0}getNextIndent(t){const e=this.classes.indexOf(t);return this.classes[e+(this.isForward?1:-1)]}}const Vp=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class Hp{constructor(){this._definitions=new Set}get length(){return this._definitions.size}add(t){Array.isArray(t)?t.forEach(t=>this._definitions.add(t)):this._definitions.add(t)}getDispatcher(){return t=>{t.on("attribute:linkHref",(t,e,i)=>{if(!i.consumable.test(e.item,"attribute:linkHref"))return;const n=i.writer,o=n.document.selection;for(const r of this._definitions){const t=n.createAttributeElement("a",r.attributes,{priority:5});r.classes&&n.addClass(r.classes,t);for(const e in r.styles)n.setStyle(e,r.styles[e],t);n.setCustomProperty("link",!0,t),r.callback(e.attributeNewValue)?e.item.is("selection")?n.wrap(o.getFirstRange(),t):n.wrap(i.mapper.toViewRange(e.range),t):n.unwrap(i.mapper.toViewRange(e.range),t)}},{priority:"high"})}}getDispatcherForLinkedImage(){return t=>{t.on("attribute:linkHref:imageBlock",(t,e,{writer:i,mapper:n})=>{const o=n.toViewElement(e.item),r=Array.from(o.getChildren()).find(t=>"a"===t.name);for(const s of this._definitions){const t=hi(s.attributes);if(s.callback(e.attributeNewValue)){for(const[e,n]of t)"class"===e?i.addClass(n,r):i.setAttribute(e,n,r);s.classes&&i.addClass(s.classes,r);for(const t in s.styles)i.setStyle(t,s.styles[t],r)}else{for(const[e,n]of t)"class"===e?i.removeClass(n,r):i.removeAttribute(e,r);s.classes&&i.removeClass(s.classes,r);for(const t in s.styles)i.removeStyle(t,r)}}})}}}var Wp=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),qp=function(t){return Wp.test(t)},Up="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Yp="\\ud83c[\\udffb-\\udfff]",Gp="[^\\ud800-\\udfff]",Zp="(?:\\ud83c[\\udde6-\\uddff]){2}",$p="[\\ud800-\\udbff][\\udc00-\\udfff]",Xp="(?:"+Up+"|"+Yp+")?",Kp="[\\ufe0e\\ufe0f]?"+Xp+"(?:\\u200d(?:"+[Gp,Zp,$p].join("|")+")[\\ufe0e\\ufe0f]?"+Xp+")*",Qp="(?:"+[Gp+Up+"?",Up,Zp,$p,"[\\ud800-\\udfff]"].join("|")+")",Jp=RegExp(Yp+"(?="+Yp+")|"+Qp+Kp,"g"),tg=function(t){t=Ei(t);var e=qp(t)?function(t){return qp(t)?function(t){return t.match(Jp)||[]}(t):function(t){return t.split("")}(t)}(t):void 0,i=e?e[0]:t.charAt(0),n=e?function(t,e,i){var n=t.length;return Oi(t,1,i=void 0===i?n:i)}(e).join(""):t.slice(1);return i.toUpperCase()+n};const eg=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,ig=/^(?:(?:https?|ftps?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))/i,ng=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,og=/^((\w+:(\/{2,})?)|(\W))/i;function rg(t,{writer:e}){const i=e.createAttributeElement("a",{href:t},{priority:5});return e.setCustomProperty("link",!0,i),i}function sg(t){return function(t){return t.replace(eg,"").match(ig)}(t=String(t))?t:"#"}function ag(t,e){return!!t&&e.checkAttribute(t.name,"linkHref")}function lg(t,e){const i=ng.test(t)?"mailto:":e,n=!!i&&!og.test(t);return t&&n?i+t:t}class cg extends Nt{constructor(t){super(t),this.manualDecorators=new Ke,this.automaticDecorators=new Hp}restoreManualDecoratorStates(){for(const t of this.manualDecorators)t.value=this._getDecoratorStateFromModel(t.id)}refresh(){const t=this.editor.model,e=t.document.selection,i=e.getSelectedElement()||fr(e.getSelectedBlocks());ag(i,t.schema)?(this.value=i.getAttribute("linkHref"),this.isEnabled=t.schema.checkAttribute(i,"linkHref")):(this.value=e.getAttribute("linkHref"),this.isEnabled=t.schema.checkAttributeInSelection(e,"linkHref"));for(const n of this.manualDecorators)n.value=this._getDecoratorStateFromModel(n.id)}execute(t,e={}){const i=this.editor.model,n=i.document.selection,o=[],r=[];for(const s in e)e[s]?o.push(s):r.push(s);i.change(e=>{if(n.isCollapsed){const s=n.getFirstPosition();if(n.hasAttribute("linkHref")){const a=jd(s,"linkHref",n.getAttribute("linkHref"),i);e.setAttribute("linkHref",t,a),o.forEach(t=>{e.setAttribute(t,!0,a)}),r.forEach(t=>{e.removeAttribute(t,a)}),e.setSelection(e.createPositionAfter(a.end.nodeBefore))}else if(""!==t){const r=hi(n.getAttributes());r.set("linkHref",t),o.forEach(t=>{r.set(t,!0)});const{end:a}=i.insertContent(e.createText(t,r),s);e.setSelection(a)}["linkHref",...o,...r].forEach(t=>{e.removeSelectionAttribute(t)})}else{const s=i.schema.getValidRanges(n.getRanges(),"linkHref"),a=[];for(const t of n.getSelectedBlocks())i.schema.checkAttribute(t,"linkHref")&&a.push(e.createRangeOn(t));const l=a.slice();for(const t of s)this._isRangeToUpdate(t,a)&&l.push(t);for(const i of l)e.setAttribute("linkHref",t,i),o.forEach(t=>{e.setAttribute(t,!0,i)}),r.forEach(t=>{e.removeAttribute(t,i)})}})}_getDecoratorStateFromModel(t){const e=this.editor.model,i=e.document.selection,n=i.getSelectedElement();return ag(n,e.schema)?n.getAttribute(t):i.getAttribute(t)}_isRangeToUpdate(t,e){for(const i of e)if(i.containsRange(t))return!1;return!0}}class hg extends Nt{refresh(){const t=this.editor.model,e=t.document.selection,i=e.getSelectedElement();this.isEnabled=ag(i,t.schema)?t.schema.checkAttribute(i,"linkHref"):t.schema.checkAttributeInSelection(e,"linkHref")}execute(){const t=this.editor.model,e=t.document.selection,i=this.editor.commands.get("link");t.change(n=>{const o=e.isCollapsed?[jd(e.getFirstPosition(),"linkHref",e.getAttribute("linkHref"),t)]:t.schema.getValidRanges(e.getRanges(),"linkHref");for(const t of o)if(n.removeAttribute("linkHref",t),i)for(const e of i.manualDecorators)n.removeAttribute(e.id,t)})}}class dg{constructor({id:t,label:e,attributes:i,classes:n,styles:o,defaultValue:r}){this.id=t,this.set("value"),this.defaultValue=r,this.label=e,this.attributes=i,this.classes=n,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}Pt(dg,Et),i(94);const ug=/^(https?:)?\/\//;class fg extends Mt{static get pluginName(){return"LinkEditing"}static get requires(){return[Td,_d,yh]}constructor(t){super(t),t.config.define("link",{addTargetToExternalLinks:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:"linkHref"}),t.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:rg}),t.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(t,e)=>rg(sg(t),e)}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:t=>t.getAttribute("href")}}),t.commands.add("link",new cg(t)),t.commands.add("unlink",new hg(t));const e=function(t,e){const i={"Open in a new tab":t("Open in a new tab"),Downloadable:t("Downloadable")};return e.forEach(t=>(t.label&&i[t.label]&&(t.label=i[t.label]),t)),e}(t.t,function(t){const e=[];if(t)for(const[i,n]of Object.entries(t)){const t=Object.assign({},n,{id:"link"+tg(i)});e.push(t)}return e}(t.config.get("link.decorators")));this._enableAutomaticDecorators(e.filter(t=>"automatic"===t.mode)),this._enableManualDecorators(e.filter(t=>"manual"===t.mode)),t.plugins.get(Td).registerAttribute("linkHref"),function(t,e,i,n){const o=t.editing.view,r=new Set;o.document.registerPostFixer(i=>{const o=t.model.document.selection;let s=!1;if(o.hasAttribute(e)){const a=jd(o.getFirstPosition(),e,o.getAttribute(e),t.model),l=t.editing.mapper.toViewRange(a);for(const t of l.getItems())t.is("element","a")&&!t.hasClass(n)&&(i.addClass(n,t),r.add(t),s=!0)}return s}),t.conversion.for("editingDowncast").add(t=>{function e(){o.change(t=>{for(const e of r.values())t.removeClass(n,e),r.delete(e)})}t.on("insert",e,{priority:"highest"}),t.on("remove",e,{priority:"highest"}),t.on("attribute",e,{priority:"highest"}),t.on("selection",e,{priority:"highest"})})}(t,"linkHref",0,"ck-link_selected"),this._enableInsertContentSelectionAttributesFixer(),this._enableClickingAfterLink(),this._enableTypingOverLink(),this._handleDeleteContentAfterLink()}_enableAutomaticDecorators(t){const e=this.editor,i=e.commands.get("link").automaticDecorators;e.config.get("link.addTargetToExternalLinks")&&i.add({id:"linkIsExternal",mode:"automatic",callback:t=>ug.test(t),attributes:{target:"_blank",rel:"noopener noreferrer"}}),i.add(t),i.length&&e.conversion.for("downcast").add(i.getDispatcher())}_enableManualDecorators(t){if(!t.length)return;const e=this.editor,i=e.commands.get("link").manualDecorators;t.forEach(t=>{e.model.schema.extend("$text",{allowAttributes:t.id}),t=new dg(t),i.add(t),e.conversion.for("downcast").attributeToElement({model:t.id,view:(e,{writer:i})=>{if(e){const e=i.createAttributeElement("a",t.attributes,{priority:5});t.classes&&i.addClass(t.classes,e);for(const n in t.styles)i.setStyle(n,t.styles[n],e);return i.setCustomProperty("link",!0,e),e}}}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",...t._createPattern()},model:{key:t.id}})})}_enableInsertContentSelectionAttributesFixer(){const t=this.editor.model,e=t.document.selection;this.listenTo(t,"insertContent",()=>{const i=e.anchor.nodeBefore,n=e.anchor.nodeAfter;e.hasAttribute("linkHref")&&i&&i.hasAttribute("linkHref")&&(n&&n.hasAttribute("linkHref")||t.change(e=>{pg(e,mg(t.schema))}))},{priority:"low"})}_enableClickingAfterLink(){const t=this.editor,e=t.model;t.editing.view.addObserver(Hc);let i=!1;this.listenTo(t.editing.view.document,"mousedown",()=>{i=!0}),this.listenTo(t.editing.view.document,"selectionChange",()=>{if(!i)return;i=!1;const t=e.document.selection;if(!t.isCollapsed)return;if(!t.hasAttribute("linkHref"))return;const n=t.getFirstPosition(),o=jd(n,"linkHref",t.getAttribute("linkHref"),e);(n.isTouching(o.start)||n.isTouching(o.end))&&e.change(t=>{pg(t,mg(e.schema))})})}_enableTypingOverLink(){const t=this.editor;let e,i;this.listenTo(t.editing.view.document,"delete",()=>{i=!0},{priority:"high"}),this.listenTo(t.model,"deleteContent",()=>{const n=t.model.document.selection;n.isCollapsed||(i?i=!1:gg(t)&&function(t){const e=t.document.selection,i=e.getFirstPosition(),n=e.getLastPosition(),o=i.nodeAfter;return!!o&&!!o.is("$text")&&!!o.hasAttribute("linkHref")&&(o===(n.textNode||n.nodeBefore)||jd(i,"linkHref",o.getAttribute("linkHref"),t).containsRange(t.createRange(i,n),!0))}(t.model)&&(e=n.getAttributes()))},{priority:"high"}),this.listenTo(t.model,"insertContent",(n,[o])=>{i=!1,gg(t)&&e&&(t.model.change(t=>{for(const[i,n]of e)t.setAttribute(i,n,o)}),e=null)},{priority:"high"})}_handleDeleteContentAfterLink(){const t=this.editor,e=t.model,i=e.document.selection;let n=!1,o=!1;this.listenTo(t.editing.view.document,"delete",(t,e)=>{o=e.domEvent.keyCode===_n.backspace},{priority:"high"}),this.listenTo(e,"deleteContent",()=>{n=!1;const t=i.getFirstPosition(),o=i.getAttribute("linkHref");if(!o)return;const r=jd(t,"linkHref",o,e);n=r.containsPosition(t)||r.end.isEqual(t)},{priority:"high"}),this.listenTo(e,"deleteContent",()=>{o&&(o=!1,n||t.model.enqueueChange(t=>{pg(t,mg(e.schema))}))},{priority:"low"})}}function pg(t,e){t.removeSelectionAttribute("linkHref");for(const i of e)t.removeSelectionAttribute(i)}function gg(t){return t.plugins.get("Input").isInput(t.model.change(t=>t.batch))}function mg(t){return t.getDefinition("$text").allowAttributes.filter(t=>t.startsWith("link"))}i(96);class vg extends hl{constructor(t,e){super(t);const i=t.t;this.focusTracker=new pr,this.keystrokes=new gr,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),rl.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(i("Cancel"),rl.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(e),this.children=this._createFormChildren(e.manualDecorators),this._focusables=new cl,this._focusCycler=new Fl({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const n=["ck","ck-link-form","ck-responsive-form"];e.manualDecorators.length&&n.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:n,tabindex:"-1"},children:this.children}),al(this)}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((t,e)=>(t[e.name]=e.isOn,t),{})}render(){super.render(),ll({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createUrlInput(){const t=this.locale.t,e=new dc(this.locale,uc);return e.label=t("Link URL"),e}_createButton(t,e,i,n){const o=new Dl(this.locale);return o.set({label:t,icon:e,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}_createManualDecoratorSwitches(t){const e=this.createCollection();for(const i of t.manualDecorators){const n=new Nl(this.locale);n.set({name:i.id,label:i.label,withText:!0}),n.bind("isOn").toMany([i,t],"value",(t,e)=>void 0===e&&void 0===t?i.defaultValue:t),n.on("execute",()=>{i.set("value",!n.isOn)}),e.add(n)}return e}_createFormChildren(t){const e=this.createCollection();if(e.add(this.urlInputView),t.length){const t=new hl;t.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(t=>({tag:"li",children:[t],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),e.add(t)}return e.add(this.saveButtonView),e.add(this.cancelButtonView),e}}i(98);class yg extends hl{constructor(t){super(t);const e=t.t;this.focusTracker=new pr,this.keystrokes=new gr,this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(e("Unlink"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>',"unlink"),this.editButtonView=this._createButton(e("Edit link"),rl.pencil,"edit"),this.set("href"),this._focusables=new cl,this._focusCycler=new Fl({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}_createButton(t,e,i){const n=new Dl(this.locale);return n.set({label:t,icon:e,tooltip:!0}),n.delegate("execute").to(this,i),n}_createPreviewButton(){const t=new Dl(this.locale),e=this.bindTemplate,i=this.t;return t.set({withText:!0,tooltip:i("Open link in new tab")}),t.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:e.to("href",t=>t&&sg(t)),target:"_blank",rel:"noopener noreferrer"}}),t.bind("label").to(this,"href",t=>t||i("This link has no URL")),t.bind("isEnabled").to(this,"href",t=>!!t),t.template.tag="a",t.template.eventListeners={},t}}class bg extends Mt{static get requires(){return[_c]}static get pluginName(){return"LinkUI"}init(){const t=this.editor;t.editing.view.addObserver(Vc),this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._balloon=t.plugins.get(_c),this._createToolbarLinkButton(),this._enableUserBalloonInteractions(),t.conversion.for("editingDowncast").markerToHighlight({model:"link-ui",view:{classes:["ck-fake-link-selection"]}}),t.conversion.for("editingDowncast").markerToElement({model:"link-ui",view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}})}destroy(){super.destroy(),this.formView.destroy()}_createActionsView(){const t=this.editor,e=new yg(t.locale),i=t.commands.get("link"),n=t.commands.get("unlink");return e.bind("href").to(i,"value"),e.editButtonView.bind("isEnabled").to(i),e.unlinkButtonView.bind("isEnabled").to(n),this.listenTo(e,"edit",()=>{this._addFormView()}),this.listenTo(e,"unlink",()=>{t.execute("unlink"),this._hideUI()}),e.keystrokes.set("Esc",(t,e)=>{this._hideUI(),e()}),e.keystrokes.set("Ctrl+K",(t,e)=>{this._addFormView(),e()}),e}_createFormView(){const t=this.editor,e=t.commands.get("link"),i=t.config.get("link.defaultProtocol"),n=new vg(t.locale,e);return n.urlInputView.fieldView.bind("value").to(e,"value"),n.urlInputView.bind("isReadOnly").to(e,"isEnabled",t=>!t),n.saveButtonView.bind("isEnabled").to(e),this.listenTo(n,"submit",()=>{const{value:e}=n.urlInputView.fieldView.element,o=lg(e,i);t.execute("link",o,n.getDecoratorSwitchesState()),this._closeFormView()}),this.listenTo(n,"cancel",()=>{this._closeFormView()}),n.keystrokes.set("Esc",(t,e)=>{this._closeFormView(),e()}),n}_createToolbarLinkButton(){const t=this.editor,e=t.commands.get("link"),i=t.t;t.keystrokes.set("Ctrl+K",(t,i)=>{i(),e.isEnabled&&this._showUI(!0)}),t.ui.componentFactory.add("link",t=>{const n=new Dl(t);return n.isEnabled=!0,n.label=i("Link"),n.icon='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>',n.keystroke="Ctrl+K",n.tooltip=!0,n.isToggleable=!0,n.bind("isEnabled").to(e,"isEnabled"),n.bind("isOn").to(e,"value",t=>!!t),this.listenTo(n,"execute",()=>this._showUI(!0)),n})}_enableUserBalloonInteractions(){this.listenTo(this.editor.editing.view.document,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),this.editor.keystrokes.set("Tab",(t,e)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),e())},{priority:"high"}),this.editor.keystrokes.set("Esc",(t,e)=>{this._isUIVisible&&(this._hideUI(),e())}),sl({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this._areActionsInPanel||this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this._isFormInPanel)return;const t=this.editor.commands.get("link");this.formView.disableCssTransitions(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions(),this.formView.urlInputView.fieldView.element.value=t.value||""}_closeFormView(){const t=this.editor.commands.get("link");t.restoreManualDecoratorStates(),void 0!==t.value?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(t=!1){this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),t&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),t&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const t=this.editor;this.stopListening(t.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),t.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const t=this.editor,e=t.editing.view.document;let i=this._getSelectedLinkElement(),n=r();const o=()=>{const t=this._getSelectedLinkElement(),e=r();i&&!t||!i&&e!==n?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),i=t,n=e};function r(){return e.selection.focus.getAncestors().reverse().find(t=>t.is("element"))}this.listenTo(t.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return this._balloon.hasView(this.formView)}get _areActionsInPanel(){return this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){return this._balloon.visibleView==this.formView||this._areActionsVisible}_getBalloonPositionData(){const t=this.editor.editing.view,e=t.document;let i=null;if(this.editor.model.markers.has("link-ui")){const e=Array.from(this.editor.editing.mapper.markerNameToElements("link-ui")),n=t.createRange(t.createPositionBefore(e[0]),t.createPositionAfter(e[e.length-1]));i=t.domConverter.viewRangeToDom(n)}else i=()=>{const i=this._getSelectedLinkElement();return i?t.domConverter.mapViewToDom(i):t.domConverter.viewRangeToDom(e.selection.getFirstRange())};return{target:i}}_getSelectedLinkElement(){const t=this.editor.editing.view,e=t.document.selection,i=e.getSelectedElement();if(e.isCollapsed||i&&Mh(i))return wg(e.getFirstPosition());{const i=e.getFirstRange().getTrimmed(),n=wg(i.start),o=wg(i.end);return n&&n==o&&t.createRangeIn(n).getTrimmed().isEqual(i)?n:null}}_showFakeVisualSelection(){const t=this.editor.model;t.change(e=>{const i=t.document.selection.getFirstRange();if(t.markers.has("link-ui"))e.updateMarker("link-ui",{range:i});else if(i.start.isAtEnd){const n=i.start.getLastMatchingPosition(({item:e})=>!t.schema.isContent(e),{boundaries:i});e.addMarker("link-ui",{usingOperation:!1,affectsData:!1,range:e.createRange(n,i.end)})}else e.addMarker("link-ui",{usingOperation:!1,affectsData:!1,range:i})})}_hideFakeVisualSelection(){const t=this.editor.model;t.markers.has("link-ui")&&t.change(t=>{t.removeMarker("link-ui")})}}function wg(t){return t.getAncestors().find(t=>{return(e=t).is("attributeElement")&&!!e.getCustomProperty("link");var e})}const kg=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i");class _g extends Mt{static get requires(){return[Sh]}static get pluginName(){return"AutoLink"}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling()}_enableTypingHandling(){const t=this.editor,e=new Ed(t.model,t=>{if(!function(t){return t.length>4&&" "===t[t.length-1]&&" "!==t[t.length-2]}(t))return;const e=xg(t.substr(0,t.length-1));return e?{url:e}:void 0}),i=t.plugins.get("Input");e.on("matched:data",(e,n)=>{const{batch:o,range:r,url:s}=n;if(!i.isInput(o))return;const a=r.end.getShiftedBy(-1),l=a.getShiftedBy(-s.length),c=t.model.createRange(l,a);this._applyAutoLink(s,c)}),e.bind("isEnabled").to(this)}_enableEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("enter");i&&i.on("execute",()=>{const t=e.document.selection.getFirstPosition();if(!t.parent.previousSibling)return;const i=e.createRangeIn(t.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(i)})}_enableShiftEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("shiftEnter");i&&i.on("execute",()=>{const t=e.document.selection.getFirstPosition(),i=e.createRange(e.createPositionAt(t.parent,0),t.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(i)})}_checkAndApplyAutoLinkOnRange(t){const e=this.editor.model,{text:i,range:n}=Cd(t,e),o=xg(i);if(o){const t=e.createRange(n.end.getShiftedBy(-o.length),n.end);this._applyAutoLink(o,t)}}_applyAutoLink(t,e){const i=this.editor.model,n=this.editor.plugins.get("Delete");this.isEnabled&&function(t,e){return e.schema.checkAttributeInSelection(e.createSelection(t),"linkHref")}(e,i)&&i.enqueueChange(o=>{const r=this.editor.config.get("link.defaultProtocol"),s=lg(t,r);o.setAttribute("linkHref",s,e),i.enqueueChange(()=>{n.requestUndoOnBackspace()})})}}function xg(t){const e=kg.exec(t);return e?e[2]:null}class Cg extends Nt{constructor(t,e){super(t),this.type=e}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const e=this.editor.model,i=Array.from(e.document.selection.getSelectedBlocks()).filter(t=>Tg(t,e.schema)),n=void 0!==t.forceValue?!t.forceValue:this.value;e.change(t=>{if(n){let e=i[i.length-1].nextSibling,n=Number.POSITIVE_INFINITY,o=[];for(;e&&"listItem"==e.name&&0!==e.getAttribute("listIndent");){const t=e.getAttribute("listIndent");t<n&&(n=t),o.push({element:e,listIndent:t-n}),e=e.nextSibling}o=o.reverse();for(const i of o)t.setAttribute("listIndent",i.listIndent,i.element)}if(!n){let t=Number.POSITIVE_INFINITY;for(const e of i)e.is("element","listItem")&&e.getAttribute("listIndent")<t&&(t=e.getAttribute("listIndent"));t=0===t?1:t,Eg(i,!0,t),Eg(i,!1,t)}for(const e of i.reverse())n&&"listItem"==e.name?t.rename(e,"paragraph"):n||"listItem"==e.name?n||"listItem"!=e.name||e.getAttribute("listType")==this.type||t.setAttribute("listType",this.type,e):(t.setAttributes({listType:this.type,listIndent:0},e),t.rename(e,"listItem"));this.fire("_executeCleanup",i)})}_getValue(){const t=fr(this.editor.model.document.selection.getSelectedBlocks());return!!t&&t.is("element","listItem")&&t.getAttribute("listType")==this.type}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.schema,e=fr(this.editor.model.document.selection.getSelectedBlocks());return!!e&&Tg(e,t)}}function Eg(t,e,i){const n=e?t[0]:t[t.length-1];if(n.is("element","listItem")){let o=n[e?"previousSibling":"nextSibling"],r=n.getAttribute("listIndent");for(;o&&o.is("element","listItem")&&o.getAttribute("listIndent")>=i;)r>o.getAttribute("listIndent")&&(r=o.getAttribute("listIndent")),o.getAttribute("listIndent")==r&&t[e?"unshift":"push"](o),o=o[e?"previousSibling":"nextSibling"]}}function Tg(t,e){return e.checkChild(t.parent,"listItem")&&!e.isObject(t)}class Sg extends Nt{constructor(t,e){super(t),this._indentBy="forward"==e?1:-1}refresh(){this.isEnabled=this._checkEnabled()}execute(){const t=this.editor.model;let e=Array.from(t.document.selection.getSelectedBlocks());t.change(t=>{const i=e[e.length-1];let n=i.nextSibling;for(;n&&"listItem"==n.name&&n.getAttribute("listIndent")>i.getAttribute("listIndent");)e.push(n),n=n.nextSibling;this._indentBy<0&&(e=e.reverse());for(const o of e){const e=o.getAttribute("listIndent")+this._indentBy;e<0?t.rename(o,"paragraph"):t.setAttribute("listIndent",e,o)}this.fire("_executeCleanup",e)})}_checkEnabled(){const t=fr(this.editor.model.document.selection.getSelectedBlocks());if(!t||!t.is("element","listItem"))return!1;if(this._indentBy>0){const e=t.getAttribute("listIndent"),i=t.getAttribute("listType");let n=t.previousSibling;for(;n&&n.is("element","listItem")&&n.getAttribute("listIndent")>=e;){if(n.getAttribute("listIndent")==e)return n.getAttribute("listType")==i;n=n.previousSibling}return!1}return!0}}function Ag(t,e,i,n){const o=e.parent,r=i.mapper,s=i.writer;let a=r.toViewPosition(n.createPositionBefore(t));const l=Pg(t.previousSibling,{sameIndent:!0,smallerIndent:!0,listIndent:t.getAttribute("listIndent")}),c=t.previousSibling;if(l&&l.getAttribute("listIndent")==t.getAttribute("listIndent")){const t=r.toViewElement(l);a=s.breakContainer(s.createPositionAfter(t))}else if(c&&"listItem"==c.name){a=r.toViewPosition(n.createPositionAt(c,"end"));const t=r.findMappedViewAncestor(a),e=function(t){for(const e of t.getChildren())if("ul"==e.name||"ol"==e.name)return e;return null}(t);a=e?s.createPositionBefore(e):s.createPositionAt(t,"end")}else a=r.toViewPosition(n.createPositionBefore(t));if(a=Ig(a),s.insert(a,o),c&&"listItem"==c.name){const t=r.toViewElement(c),i=s.createRange(s.createPositionAt(t,0),a).getWalker({ignoreElementEnd:!0});for(const n of i)if(n.item.is("element","li")){const t=s.breakContainer(s.createPositionBefore(n.item)),o=n.item.parent,r=s.createPositionAt(e,"end");Og(s,r.nodeBefore,r.nodeAfter),s.move(s.createRangeOn(o),r),i.position=t}}else{const i=o.nextSibling;if(i&&(i.is("element","ul")||i.is("element","ol"))){let n=null;for(const e of i.getChildren()){const i=r.toModelElement(e);if(!(i&&i.getAttribute("listIndent")>t.getAttribute("listIndent")))break;n=e}n&&(s.breakContainer(s.createPositionAfter(n)),s.move(s.createRangeOn(n.parent),s.createPositionAt(e,"end")))}}Og(s,o,o.nextSibling),Og(s,o.previousSibling,o)}function Og(t,e,i){return!e||!i||"ul"!=e.name&&"ol"!=e.name||e.name!=i.name||e.getAttribute("class")!==i.getAttribute("class")?null:t.mergeContainers(t.createPositionAfter(e))}function Ig(t){return t.getLastMatchingPosition(t=>t.item.is("uiElement"))}function Pg(t,e){const i=!!e.sameIndent,n=!!e.smallerIndent,o=e.listIndent;let r=t;for(;r&&"listItem"==r.name;){const t=r.getAttribute("listIndent");if(i&&o==t||n&&o>t)return r;r="forward"===e.direction?r.nextSibling:r.previousSibling}return null}function Mg(t,e,i,n){t.ui.componentFactory.add(e,o=>{const r=t.commands.get(e),s=new Dl(o);return s.set({label:i,icon:n,tooltip:!0,isToggleable:!0}),s.bind("isOn","isEnabled").to(r,"value","isEnabled"),s.on("execute",()=>{t.execute(e),t.editing.view.focus()}),s})}function Dg(t,e){const i=[],n=t.parent,o={ignoreElementEnd:!0,startPosition:t,shallow:!0,direction:e},r=n.getAttribute("listIndent"),s=[...new Dr(o)].filter(t=>t.item.is("element")).map(t=>t.item);for(const a of s){if(!a.is("element","listItem"))break;if(a.getAttribute("listIndent")<r)break;if(!(a.getAttribute("listIndent")>r)){if(a.getAttribute("listType")!==n.getAttribute("listType"))break;if(a.getAttribute("listStyle")!==n.getAttribute("listStyle"))break;"backward"===e?i.unshift(a):i.push(a)}}return i}function Ng(){const t=!this.isEmpty&&("ul"==this.getChild(0).name||"ol"==this.getChild(0).name);return this.isEmpty||t?0:Hi.call(this)}function Rg(t){return(e,i,n)=>{const o=n.consumable;if(!o.test(i.item,"insert")||!o.test(i.item,"attribute:listType")||!o.test(i.item,"attribute:listIndent"))return;o.consume(i.item,"insert"),o.consume(i.item,"attribute:listType"),o.consume(i.item,"attribute:listIndent");const r=i.item;Ag(r,function(t,e){const i=e.mapper,n=e.writer,o="numbered"==t.getAttribute("listType")?"ol":"ul",r=function(t){const e=t.createContainerElement("li");return e.getFillerOffset=Ng,e}(n),s=n.createContainerElement(o,null);return n.insert(n.createPositionAt(s,0),r),i.bindElements(t,r),r}(r,n),n,t)}}function zg(t,e,i){if(!i.consumable.consume(e.item,"attribute:listType"))return;const n=i.mapper.toViewElement(e.item),o=i.writer;o.breakContainer(o.createPositionBefore(n)),o.breakContainer(o.createPositionAfter(n)),o.rename("numbered"==e.attributeNewValue?"ol":"ul",n.parent)}function Fg(t,e,i){const n=i.mapper.toViewElement(e.item).parent,o=i.writer;Og(o,n,n.nextSibling),Og(o,n.previousSibling,n);for(const r of e.item.getChildren())i.consumable.consume(r,"insert")}function Lg(t,e,i){if("listItem"!=e.item.name){let t=i.mapper.toViewPosition(e.range.start);const n=i.writer,o=[];for(;("ul"==t.parent.name||"ol"==t.parent.name)&&(t=n.breakContainer(t),"li"==t.parent.name);){const e=t,i=n.createPositionAt(t.parent,"end");if(!e.isEqual(i)){const t=n.remove(n.createRange(e,i));o.push(t)}t=n.createPositionAfter(t.parent)}if(o.length>0){for(let e=0;e<o.length;e++){const i=t.nodeBefore;if(t=n.insert(t,o[e]).end,e>0){const e=Og(n,i,i.nextSibling);e&&e.parent==i&&t.offset--}}Og(n,t.nodeBefore,t.nodeAfter)}}}function Bg(t,e,i){const n=i.mapper.toViewPosition(e.position);Og(i.writer,n.nodeBefore,n.nodeAfter)}function jg(t,e,i){if(i.consumable.consume(e.viewItem,{name:!0})){const t=i.writer,n=t.createElement("listItem"),o=function(t){let e=0,i=t.parent;for(;i;){if(i.is("element","li"))e++;else{const t=i.previousSibling;t&&t.is("element","li")&&e++}i=i.parent}return e}(e.viewItem);if(t.setAttribute("listIndent",o,n),t.setAttribute("listType",e.viewItem.parent&&"ol"==e.viewItem.parent.name?"numbered":"bulleted",n),!i.safeInsert(n,e.modelCursor))return;const r=function(t,e,i){const{writer:n,schema:o}=i;let r=n.createPositionAfter(t);for(const s of e)if("ul"==s.name||"ol"==s.name)r=i.convertItem(s,r).modelCursor;else{const e=i.convertItem(s,n.createPositionAt(t,"end")),a=e.modelRange.start.nodeAfter;a&&a.is("element")&&!o.checkChild(t,a.name)&&(t=e.modelCursor.parent.is("element","listItem")?e.modelCursor.parent:Ug(e.modelCursor),r=n.createPositionAfter(t))}return r}(n,e.viewItem.getChildren(),i);e.modelRange=t.createRange(e.modelCursor,r),i.updateConversionResult(n,e)}}function Vg(t,e,i){if(i.consumable.test(e.viewItem,{name:!0})){const t=Array.from(e.viewItem.getChildren());for(const e of t)!e.is("element","li")&&!Gg(e)&&e._remove()}}function Hg(t,e,i){if(i.consumable.test(e.viewItem,{name:!0})){if(0===e.viewItem.childCount)return;const t=[...e.viewItem.getChildren()];let i=!1;for(const e of t)i&&!Gg(e)&&e._remove(),Gg(e)&&(i=!0)}}function Wg(t){return(e,i)=>{if(i.isPhantom)return;const n=i.modelPosition.nodeBefore;if(n&&n.is("element","listItem")){const e=i.mapper.toViewElement(n),o=e.getAncestors().find(Gg),r=t.createPositionAt(e,0).getWalker();for(const t of r){if("elementStart"==t.type&&t.item.is("element","li")){i.viewPosition=t.previousPosition;break}if("elementEnd"==t.type&&t.item==o){i.viewPosition=t.nextPosition;break}}}}}function qg(t,[e,i]){let n,o=e.is("documentFragment")?e.getChild(0):e;if(n=i?this.createSelection(i):this.document.selection,o&&o.is("element","listItem")){const t=n.getFirstPosition();let e=null;if(t.parent.is("element","listItem")?e=t.parent:t.nodeBefore&&t.nodeBefore.is("element","listItem")&&(e=t.nodeBefore),e){const t=e.getAttribute("listIndent");if(t>0)for(;o&&o.is("element","listItem");)o._setAttribute("listIndent",o.getAttribute("listIndent")+t),o=o.nextSibling}}}function Ug(t){const e=new Dr({startPosition:t});let i;do{i=e.next()}while(!i.value.item.is("element","listItem"));return i.value.item}function Yg(t,e,i,n,o,r){const s=Pg(e.nodeBefore,{sameIndent:!0,smallerIndent:!0,listIndent:t,foo:"b"}),a=o.mapper,l=o.writer,c=s?s.getAttribute("listIndent"):null;let h;if(s)if(c==t){const t=a.toViewElement(s).parent;h=l.createPositionAfter(t)}else{const t=r.createPositionAt(s,"end");h=a.toViewPosition(t)}else h=i;h=Ig(h);for(const d of[...n.getChildren()])Gg(d)&&(h=l.move(l.createRangeOn(d),h).end,Og(l,d,d.nextSibling),Og(l,d.previousSibling,d))}function Gg(t){return t.is("element","ol")||t.is("element","ul")}class Zg extends Mt{static get pluginName(){return"ListEditing"}static get requires(){return[xh,Sh]}init(){const t=this.editor;t.model.schema.register("listItem",{inheritAllFrom:"$block",allowAttributes:["listType","listIndent"]});const e=t.data,i=t.editing;var n;t.model.document.registerPostFixer(e=>function(t,e){const i=t.document.differ.getChanges(),n=new Map;let o=!1;for(const l of i)if("insert"==l.type&&"listItem"==l.name)r(l.position);else if("insert"==l.type&&"listItem"!=l.name){if("$text"!=l.name){const i=l.position.nodeAfter;i.hasAttribute("listIndent")&&(e.removeAttribute("listIndent",i),o=!0),i.hasAttribute("listType")&&(e.removeAttribute("listType",i),o=!0),i.hasAttribute("listStyle")&&(e.removeAttribute("listStyle",i),o=!0);for(const e of Array.from(t.createRangeIn(i)).filter(t=>t.item.is("element","listItem")))r(e.previousPosition)}r(l.position.getShiftedBy(l.length))}else"remove"==l.type&&"listItem"==l.name?r(l.position):("attribute"==l.type&&"listIndent"==l.attributeKey||"attribute"==l.type&&"listType"==l.attributeKey)&&r(l.range.start);for(const l of n.values())s(l),a(l);return o;function r(t){const e=t.nodeBefore;if(e&&e.is("element","listItem")){let t=e;if(n.has(t))return;for(let e=t.previousSibling;e&&e.is("element","listItem");e=t.previousSibling)if(t=e,n.has(t))return;n.set(e,t)}else{const e=t.nodeAfter;e&&e.is("element","listItem")&&n.set(e,e)}}function s(t){let i=0,n=null;for(;t&&t.is("element","listItem");){const r=t.getAttribute("listIndent");if(r>i){let s;null===n?(n=r-i,s=i):(n>r&&(n=r),s=r-n),e.setAttribute("listIndent",s,t),o=!0}else n=null,i=t.getAttribute("listIndent")+1;t=t.nextSibling}}function a(t){let i=[],n=null;for(;t&&t.is("element","listItem");){const r=t.getAttribute("listIndent");if(n&&n.getAttribute("listIndent")>r&&(i=i.slice(0,r+1)),0!=r)if(i[r]){const n=i[r];t.getAttribute("listType")!=n&&(e.setAttribute("listType",n,t),o=!0)}else i[r]=t.getAttribute("listType");n=t,t=t.nextSibling}}}(t.model,e)),i.mapper.registerViewToModelLength("li",$g),e.mapper.registerViewToModelLength("li",$g),i.mapper.on("modelToViewPosition",Wg(i.view)),i.mapper.on("viewToModelPosition",(n=t.model,(t,e)=>{const i=e.viewPosition,o=i.parent,r=e.mapper;if("ul"==o.name||"ol"==o.name){if(i.isAtEnd){const t=r.toModelElement(i.nodeBefore),o=r.getModelLength(i.nodeBefore);e.modelPosition=n.createPositionBefore(t).getShiftedBy(o)}else{const t=r.toModelElement(i.nodeAfter);e.modelPosition=n.createPositionBefore(t)}t.stop()}else if("li"==o.name&&i.nodeBefore&&("ul"==i.nodeBefore.name||"ol"==i.nodeBefore.name)){const s=r.toModelElement(o);let a=1,l=i.nodeBefore;for(;l&&Gg(l);)a+=r.getModelLength(l),l=l.previousSibling;e.modelPosition=n.createPositionBefore(s).getShiftedBy(a),t.stop()}})),e.mapper.on("modelToViewPosition",Wg(i.view)),t.conversion.for("editingDowncast").add(e=>{e.on("insert",Lg,{priority:"high"}),e.on("insert:listItem",Rg(t.model)),e.on("attribute:listType:listItem",zg,{priority:"high"}),e.on("attribute:listType:listItem",Fg,{priority:"low"}),e.on("attribute:listIndent:listItem",function(t){return(e,i,n)=>{if(!n.consumable.consume(i.item,"attribute:listIndent"))return;const o=n.mapper.toViewElement(i.item),r=n.writer;r.breakContainer(r.createPositionBefore(o)),r.breakContainer(r.createPositionAfter(o));const s=o.parent,a=s.previousSibling,l=r.createRangeOn(s);r.remove(l),a&&a.nextSibling&&Og(r,a,a.nextSibling),Yg(i.attributeOldValue+1,i.range.start,l.start,o,n,t),Ag(i.item,o,n,t);for(const t of i.item.getChildren())n.consumable.consume(t,"insert")}}(t.model)),e.on("remove:listItem",function(t){return(e,i,n)=>{const o=n.mapper.toViewPosition(i.position).getLastMatchingPosition(t=>!t.item.is("element","li")).nodeAfter,r=n.writer;r.breakContainer(r.createPositionBefore(o)),r.breakContainer(r.createPositionAfter(o));const s=o.parent,a=s.previousSibling,l=r.createRangeOn(s),c=r.remove(l);a&&a.nextSibling&&Og(r,a,a.nextSibling),Yg(n.mapper.toModelElement(o).getAttribute("listIndent")+1,i.position,l.start,o,n,t);for(const t of r.createRangeIn(c).getItems())n.mapper.unbindViewElement(t);e.stop()}}(t.model)),e.on("remove",Bg,{priority:"low"})}),t.conversion.for("dataDowncast").add(e=>{e.on("insert",Lg,{priority:"high"}),e.on("insert:listItem",Rg(t.model))}),t.conversion.for("upcast").add(t=>{t.on("element:ul",Vg,{priority:"high"}),t.on("element:ol",Vg,{priority:"high"}),t.on("element:li",Hg,{priority:"high"}),t.on("element:li",jg)}),t.model.on("insertContent",qg,{priority:"high"}),t.commands.add("numberedList",new Cg(t,"numbered")),t.commands.add("bulletedList",new Cg(t,"bulleted")),t.commands.add("indentList",new Sg(t,"forward")),t.commands.add("outdentList",new Sg(t,"backward"));const o=i.view.document;this.listenTo(o,"enter",(t,e)=>{const i=this.editor.model.document,n=i.selection.getLastPosition().parent;i.selection.isCollapsed&&"listItem"==n.name&&n.isEmpty&&(this.editor.execute("outdentList"),e.preventDefault(),t.stop())},{context:"li"}),this.listenTo(o,"delete",(t,e)=>{if("backward"!==e.direction)return;const i=this.editor.model.document.selection;if(!i.isCollapsed)return;const n=i.getFirstPosition();if(!n.isAtStart)return;const o=n.parent;"listItem"===o.name&&(o.previousSibling&&"listItem"===o.previousSibling.name||(this.editor.execute("outdentList"),e.preventDefault(),t.stop()))},{context:"li"});const r=t=>(e,i)=>{this.editor.commands.get(t).isEnabled&&(this.editor.execute(t),i())};t.keystrokes.set("Tab",r("indentList")),t.keystrokes.set("Shift+Tab",r("outdentList"))}afterInit(){const t=this.editor.commands,e=t.get("indent"),i=t.get("outdent");e&&e.registerChildCommand(t.get("indentList")),i&&i.registerChildCommand(t.get("outdentList"))}}function $g(t){let e=1;for(const i of t.getChildren())if("ul"==i.name||"ol"==i.name)for(const t of i.getChildren())e+=$g(t);return e}var Xg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',Kg='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>';class Qg extends Mt{static get pluginName(){return"ListUI"}init(){const t=this.editor.t;Mg(this.editor,"numberedList",t("Numbered List"),Xg),Mg(this.editor,"bulletedList",t("Bulleted List"),Kg)}}class Jg extends Nt{constructor(t,e){super(t),this._defaultType=e}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const e=this.editor.model;let i=[...e.document.selection.getSelectedBlocks()].filter(t=>t.is("element","listItem")).map(t=>{const i=e.change(e=>e.createPositionAt(t,0));return[...Dg(i,"backward"),...Dg(i,"forward")]}).flat();i=[...new Set(i)],i.length&&e.change(e=>{for(const n of i)e.setAttribute("listStyle",t.type||this._defaultType,n)})}_getValue(){const t=this.editor.model.document.selection.getFirstPosition().parent;return t&&t.is("element","listItem")?t.getAttribute("listStyle"):null}_checkEnabled(){const t=this.editor,e=t.commands.get("numberedList"),i=t.commands.get("bulletedList");return e.isEnabled||i.isEnabled}}class tm extends Mt{static get requires(){return[Zg]}static get pluginName(){return"ListStyleEditing"}init(){const t=this.editor,e=t.model;e.schema.extend("listItem",{allowAttributes:["listStyle"]}),t.commands.add("listStyle",new Jg(t,"default")),this.listenTo(t.commands.get("indentList"),"_executeCleanup",function(t){return(e,i)=>{let n;const o=i[0],r=o.getAttribute("listIndent"),s=i.filter(t=>t.getAttribute("listIndent")===r);if(o.previousSibling.getAttribute("listIndent")+1===r)n="default";else{const t=Pg(o.previousSibling,{sameIndent:!0,direction:"backward",listIndent:r});n=t.getAttribute("listStyle")}t.model.change(t=>{for(const e of s)t.setAttribute("listStyle",n,e)})}}(t)),this.listenTo(t.commands.get("outdentList"),"_executeCleanup",function(t){return(e,i)=>{if(!(i=i.reverse().filter(t=>t.is("element","listItem"))).length)return;const n=i[0].getAttribute("listIndent"),o=i[0].getAttribute("listType");let r=i[0].previousSibling;if(r.is("element","listItem"))for(;r.getAttribute("listIndent")!==n;)r=r.previousSibling;else r=null;r||(r=i[i.length-1].nextSibling),r&&r.is("element","listItem")&&r.getAttribute("listType")===o&&t.model.change(t=>{const e=i.filter(t=>t.getAttribute("listIndent")===n);for(const i of e)t.setAttribute("listStyle",r.getAttribute("listStyle"),i)})}}(t)),this.listenTo(t.commands.get("bulletedList"),"_executeCleanup",nm(t)),this.listenTo(t.commands.get("numberedList"),"_executeCleanup",nm(t)),e.document.registerPostFixer(function(t){return e=>{let i=!1;const n=om(t.model.document.differ.getChanges()).filter(t=>"todo"!==t.getAttribute("listType"));if(!n.length)return i;let o=n[n.length-1].nextSibling;if((!o||!o.is("element","listItem"))&&(o=n[n.length-1].previousSibling,o)){const t=n[0].getAttribute("listIndent");for(;o.is("element","listItem")&&o.getAttribute("listIndent")!==t&&(o=o.previousSibling,o););}for(const t of n)if(t.hasAttribute("listStyle")){const n=t.previousSibling;im(n,t)&&(e.setAttribute("listStyle",n.getAttribute("listStyle"),t),i=!0)}else em(o,t)?e.setAttribute("listStyle",o.getAttribute("listStyle"),t):e.setAttribute("listStyle","default",t),i=!0;return i}}(t)),t.conversion.for("upcast").add(t=>{t.on("element:li",(t,e,i)=>{const n=e.viewItem.parent;if(!n)return;const o=n.getStyle("list-style-type")||"default";i.writer.setAttribute("listStyle",o,e.modelRange.start.nodeAfter||e.modelRange.end.nodeBefore)},{priority:"low"})}),t.conversion.for("downcast").add(t=>{t.on("attribute:listStyle:listItem",(t,e,i)=>{const n=i.writer,o=e.item,r=Pg(o.previousSibling,{sameIndent:!0,listIndent:o.getAttribute("listIndent"),direction:"backward"}),s=i.mapper.toViewElement(o);var a,l,c,h,d;a=o,(l=r)&&a.getAttribute("listType")===l.getAttribute("listType")&&a.getAttribute("listIndent")===l.getAttribute("listIndent")&&a.getAttribute("listStyle")===l.getAttribute("listStyle")||n.breakContainer(n.createPositionBefore(s)),c=n,d=s.parent,(h=e.attributeNewValue)&&"default"!==h?c.setStyle("list-style-type",h,d):c.removeStyle("list-style-type",d)},{priority:"low"})}),this._mergeListStyleAttributeWhileMergingLists()}afterInit(){const t=this.editor;t.commands.get("todoList")&&t.model.document.registerPostFixer(function(t){return e=>{const i=om(t.model.document.differ.getChanges()).filter(t=>"todo"===t.getAttribute("listType")&&t.hasAttribute("listStyle"));if(!i.length)return!1;for(const t of i)e.removeAttribute("listStyle",t);return!0}}(t))}_mergeListStyleAttributeWhileMergingLists(){const t=this.editor.model;let e;this.listenTo(t,"deleteContent",(t,[i])=>{const n=i.getFirstPosition(),o=i.getLastPosition();if(n.parent===o.parent)return;if(!n.parent.is("element","listItem"))return;const r=o.parent.nextSibling;if(!r||!r.is("element","listItem"))return;const s=Pg(n.parent,{sameIndent:!0,listIndent:r.getAttribute("listIndent")});s&&s.getAttribute("listType")===r.getAttribute("listType")&&(e=s)},{priority:"high"}),this.listenTo(t,"deleteContent",()=>{e&&(t.change(t=>{const i=Pg(e.nextSibling,{sameIndent:!0,listIndent:e.getAttribute("listIndent"),direction:"forward"}),n=[i,...Dg(t.createPositionAt(i,0),"forward")];for(const o of n)t.setAttribute("listStyle",e.getAttribute("listStyle"),o)}),e=null)},{priority:"low"})}}function em(t,e){if(!t)return!1;const i=t.getAttribute("listStyle");return!!i&&"default"!==i&&t.getAttribute("listType")===e.getAttribute("listType")}function im(t,e){if(!t||!t.is("element","listItem"))return!1;if(e.getAttribute("listType")!==t.getAttribute("listType"))return!1;const i=t.getAttribute("listIndent");if(i<1||i!==e.getAttribute("listIndent"))return!1;const n=t.getAttribute("listStyle");return!(!n||n===e.getAttribute("listStyle"))}function nm(t){return(e,i)=>{i=i.filter(t=>t.is("element","listItem")),t.model.change(t=>{for(const e of i)t.removeAttribute("listStyle",e)})}}function om(t){const e=[];for(const i of t){const t=rm(i);t&&t.is("element","listItem")&&e.push(t)}return e}function rm(t){return"attribute"===t.type?t.range.start.nodeAfter:"insert"===t.type?t.position.nodeAfter:null}i(100);class sm extends Mt{static get pluginName(){return"ListStyleUI"}init(){const t=this.editor,e=t.locale.t;t.ui.componentFactory.add("bulletedList",am({editor:t,parentCommandName:"bulletedList",buttonLabel:e("Bulleted List"),buttonIcon:Kg,toolbarAriaLabel:e("Bulleted list styles toolbar"),styleDefinitions:[{label:e("Toggle the disc list style"),tooltip:e("Disc"),type:"disc",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>'},{label:e("Toggle the circle list style"),tooltip:e("Circle"),type:"circle",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>'},{label:e("Toggle the square list style"),tooltip:e("Square"),type:"square",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>'}]})),t.ui.componentFactory.add("numberedList",am({editor:t,parentCommandName:"numberedList",buttonLabel:e("Numbered List"),buttonIcon:Xg,toolbarAriaLabel:e("Numbered list styles toolbar"),styleDefinitions:[{label:e("Toggle the decimal list style"),tooltip:e("Decimal"),type:"decimal",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>'},{label:e("Toggle the decimal with leading zero list style"),tooltip:e("Decimal with leading zero"),type:"decimal-leading-zero",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>'},{label:e("Toggle the lower\u2013roman list style"),tooltip:e("Lower\u2013roman"),type:"lower-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:e("Toggle the upper\u2013roman list style"),tooltip:e("Upper-roman"),type:"upper-roman",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>'},{label:e("Toggle the lower\u2013latin list style"),tooltip:e("Lower-latin"),type:"lower-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>'},{label:e("Toggle the upper\u2013latin list style"),tooltip:e("Upper-latin"),type:"upper-latin",icon:'<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>'}]}))}}function am({editor:t,parentCommandName:e,buttonLabel:i,buttonIcon:n,toolbarAriaLabel:o,styleDefinitions:r}){const s=t.commands.get(e),a=t.commands.get("listStyle");return l=>{const c=nc(l,Hl),h=c.buttonView,d=function({editor:t,listStyleCommand:e,parentCommandName:i}){const n=t.locale,o=t.commands.get(i);return({label:r,type:s,icon:a,tooltip:l})=>{const c=new Dl(n);return c.set({label:r,icon:a,tooltip:l}),e.on("change:value",()=>{c.isOn=e.value===s}),c.on("execute",()=>{o.value?t.execute("listStyle",e.value!==s?{type:s}:{type:e._defaultType}):t.model.change(()=>{t.execute(i),t.execute("listStyle",{type:s})}),t.editing.view.focus()}),c}}({editor:t,parentCommandName:e,listStyleCommand:a});return oc(c,r.map(d)),c.bind("isEnabled").to(s),c.toolbarView.ariaLabel=o,c.class="ck-list-styles-dropdown",h.on("execute",()=>{t.execute(e),t.editing.view.focus()}),h.set({label:i,icon:n,tooltip:!0,isToggleable:!0}),h.bind("isOn").to(s,"value",t=>!!t),c}}function lm(t,e){return t=>{t.on("attribute:url:media",i)};function i(i,n,o){if(!o.consumable.consume(n.item,i.name))return;const r=n.attributeNewValue,s=o.writer,a=o.mapper.toViewElement(n.item),l=[...a.getChildren()].find(t=>t.getCustomProperty("media-content"));s.remove(l);const c=t.getMediaViewElement(s,r,e);s.insert(s.createPositionAt(a,0),c)}}function cm(t,e,i,n){const o=t.createContainerElement("figure",{class:"media"});return t.insert(t.createPositionAt(o,0),e.getMediaViewElement(t,i,n)),o}function hm(t){const e=t.getSelectedElement();return e&&e.is("element","media")?e:null}function dm(t,e,i){t.change(n=>{const o=n.createElement("media",{url:e});t.insertContent(o,i),n.setSelection(o,"on")})}class um extends Nt{refresh(){const t=this.editor.model,e=t.document.selection,i=hm(e);this.value=i?i.getAttribute("url"):null,this.isEnabled=function(t){const e=t.getSelectedElement();return!!e&&"media"===e.name}(e)||function(t,e){let i=Bh(t,e).start.parent;return i.isEmpty&&!e.schema.isLimit(i)&&(i=i.parent),e.schema.checkChild(i,"media")}(e,t)}execute(t){const e=this.editor.model,i=e.document.selection,n=hm(i);n?e.change(e=>{e.setAttribute("url",t,n)}):dm(e,t,Bh(i,e))}}class fm{constructor(t,e){const i=e.providers,n=e.extraProviders||[],o=new Set(e.removeProviders),r=i.concat(n).filter(t=>{const e=t.name;return e?!o.has(e):(Object(a.b)("media-embed-no-provider-name",{provider:t}),!1)});this.locale=t,this.providerDefinitions=r}hasMedia(t){return!!this._getMedia(t)}getMediaViewElement(t,e,i){return this._getMedia(e).getViewElement(t,i)}_getMedia(t){if(!t)return new pm(this.locale);t=t.trim();for(const e of this.providerDefinitions){const i=e.html,n=Je(e.url);for(const e of n){const n=this._getUrlMatches(t,e);if(n)return new pm(this.locale,t,n,i)}}return null}_getUrlMatches(t,e){let i=t.match(e);if(i)return i;let n=t.replace(/^https?:\/\//,"");return i=n.match(e),i||(n=n.replace(/^www\./,""),i=n.match(e),i||null)}}class pm{constructor(t,e,i,n){this.url=this._getValidUrl(e),this._t=t.t,this._match=i,this._previewRenderer=n}getViewElement(t,e){const i={};let n;if(e.renderForEditingView||e.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),e.renderForEditingView&&(i.class="ck-media__wrapper");const o=this._getPreviewHtml(e);n=t.createRawElement("div",i,(t,e)=>{e.setContentOf(t,o)})}else this.url&&(i.url=this.url),n=t.createEmptyElement(e.elementName,i);return t.setCustomProperty("media-content",!0,n),n}_getPreviewHtml(t){return this._previewRenderer?this._previewRenderer(this._match):this.url&&t.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const t=new Ml,e=new Pl;return t.text=this._t("Open media in new tab"),e.content='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>',e.viewBox="0 0 64 42",new dl({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[e]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]},t]}]}).render().outerHTML}_getValidUrl(t){return t?t.match(/^https?/)?t:"https://"+t:null}}i(102);class gm extends Mt{static get pluginName(){return"MediaEmbedEditing"}constructor(t){super(t),t.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:/^dailymotion\.com\/video\/(\w+)/,html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)/,/^youtube\.com\/embed\/([\w-]+)/,/^youtu\.be\/([\w-]+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:t=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${t[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new fm(t.locale,t.config.get("mediaEmbed"))}init(){const t=this.editor,e=t.model.schema,i=t.t,n=t.conversion,o=t.config.get("mediaEmbed.previewsInData"),r=t.config.get("mediaEmbed.elementName"),s=this.registry;t.commands.add("mediaEmbed",new um(t)),e.register("media",{isObject:!0,isBlock:!0,allowWhere:"$block",allowAttributes:["url"]}),n.for("dataDowncast").elementToElement({model:"media",view:(t,{writer:e})=>{const i=t.getAttribute("url");return cm(e,s,i,{elementName:r,renderMediaPreview:i&&o})}}),n.for("dataDowncast").add(lm(s,{elementName:r,renderMediaPreview:o})),n.for("editingDowncast").elementToElement({model:"media",view:(t,{writer:e})=>{const n=t.getAttribute("url");return function(t,e,i){return e.setCustomProperty("media",!0,t),Dh(t,e,{label:i})}(cm(e,s,n,{elementName:r,renderForEditingView:!0}),e,i("media widget"))}}),n.for("editingDowncast").add(lm(s,{elementName:r,renderForEditingView:!0})),n.for("upcast").elementToElement({view:t=>["oembed",r].includes(t.name)&&t.getAttribute("url")?{name:!0}:null,model:(t,{writer:e})=>{const i=t.getAttribute("url");if(s.hasMedia(i))return e.createElement("media",{url:i})}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(t,{writer:e})=>{const i=t.getAttribute("data-oembed-url");if(s.hasMedia(i))return e.createElement("media",{url:i})}}).add(t=>{t.on("element:figure",function(t,e,i){if(!i.consumable.test(e.viewItem,{name:!0,classes:"media"}))return;const{modelRange:n,modelCursor:o}=i.convertChildren(e.viewItem,e.modelCursor);e.modelRange=n,e.modelCursor=o,fr(n.getItems())&&i.consumable.consume(e.viewItem,{name:!0,classes:"media"})})})}}const mm=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class vm extends Mt{static get requires(){return[rd,Sh,Kd]}static get pluginName(){return"AutoMediaEmbed"}constructor(t){super(t),this._timeoutId=null,this._positionToInsert=null}init(){const t=this.editor,e=t.model.document;this.listenTo(t.plugins.get("ClipboardPipeline"),"inputTransformation",()=>{const t=e.selection.getFirstRange(),i=Ra.fromPosition(t.start);i.stickiness="toPrevious";const n=Ra.fromPosition(t.end);n.stickiness="toNext",e.once("change:data",()=>{this._embedMediaBetweenPositions(i,n),i.detach(),n.detach()},{priority:"high"})}),t.commands.get("undo").on("execute",()=>{this._timeoutId&&(co.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(t,e){const i=this.editor,n=i.plugins.get(gm).registry,o=new Qr(t,e),r=o.getWalker({ignoreElementEnd:!0});let s="";for(const a of r)a.item.is("$textProxy")&&(s+=a.item.data);s=s.trim(),s.match(mm)&&n.hasMedia(s)&&i.commands.get("mediaEmbed").isEnabled?(this._positionToInsert=Ra.fromPosition(t),this._timeoutId=co.window.setTimeout(()=>{i.model.change(t=>{let e;this._timeoutId=null,t.remove(o),o.detach(),"$graveyard"!==this._positionToInsert.root.rootName&&(e=this._positionToInsert),dm(i.model,s,e),this._positionToInsert.detach(),this._positionToInsert=null}),i.plugins.get("Delete").requestUndoOnBackspace()},100)):o.detach()}}i(104);class ym extends hl{constructor(t,e){super(e);const i=e.t;this.focusTracker=new pr,this.keystrokes=new gr,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(i("Save"),rl.check,"ck-button-save"),this.saveButtonView.type="submit",this.saveButtonView.bind("isEnabled").to(this,"mediaURLInputValue",t=>!!t),this.cancelButtonView=this._createButton(i("Cancel"),rl.cancel,"ck-button-cancel","cancel"),this._focusables=new cl,this._focusCycler=new Fl({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this._validators=t,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView,this.saveButtonView,this.cancelButtonView]}),al(this)}render(){super.render(),ll({view:this}),[this.urlInputView,this.saveButtonView,this.cancelButtonView].forEach(t=>{this._focusables.add(t),this.focusTracker.add(t.element)}),this.keystrokes.listenTo(this.element);const t=t=>t.stopPropagation();this.keystrokes.set("arrowright",t),this.keystrokes.set("arrowleft",t),this.keystrokes.set("arrowup",t),this.keystrokes.set("arrowdown",t),this.listenTo(this.urlInputView.element,"selectstart",(t,e)=>{e.stopPropagation()},{priority:"high"})}focus(){this._focusCycler.focusFirst()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(t){this.urlInputView.fieldView.element.value=t.trim()}isValid(){this.resetFormStatus();for(const t of this._validators){const e=t(this);if(e)return this.urlInputView.errorText=e,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const t=this.locale.t,e=new dc(this.locale,uc),i=e.fieldView;return this._urlInputViewInfoDefault=t("Paste the media URL in the input."),this._urlInputViewInfoTip=t("Tip: Paste the URL into the content to embed faster."),e.label=t("Media URL"),e.infoText=this._urlInputViewInfoDefault,i.on("input",()=>{e.infoText=i.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=i.element.value.trim()}),e}_createButton(t,e,i,n){const o=new Dl(this.locale);return o.set({label:t,icon:e,tooltip:!0}),o.extendTemplate({attributes:{class:i}}),n&&o.delegate("execute").to(this,n),o}}class bm extends Mt{static get requires(){return[gm]}static get pluginName(){return"MediaEmbedUI"}init(){const t=this.editor,e=t.commands.get("mediaEmbed"),i=t.plugins.get(gm).registry;t.ui.componentFactory.add("mediaEmbed",n=>{const o=nc(n),r=new ym(function(t,e){return[e=>{if(!e.url.length)return t("The URL must not be empty.")},i=>{if(!e.hasMedia(i.url))return t("This media URL is not supported.")}]}(t.t,i),t.locale);return this._setUpDropdown(o,r,e,t),this._setUpForm(o,r,e),o})}_setUpDropdown(t,e,i){const n=this.editor,o=n.t,r=t.buttonView;function s(){n.editing.view.focus(),t.isOpen=!1}t.bind("isEnabled").to(i),t.panelView.children.add(e),r.set({label:o("Insert media"),icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M18.68 3.03c.6 0 .59-.03.59.55v12.84c0 .59.01.56-.59.56H1.29c-.6 0-.59.03-.59-.56V3.58c0-.58-.01-.55.6-.55h17.38zM15.77 15V5H4.2v10h11.57zM2 4v1h1V4H2zm0 2v1h1V6H2zm0 2v1h1V8H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zm0 2v1h1v-1H2zM17 4v1h1V4h-1zm0 2v1h1V6h-1zm0 2v1h1V8h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zm0 2v1h1v-1h-1zM7.5 7.177a.4.4 0 0 1 .593-.351l5.133 2.824a.4.4 0 0 1 0 .7l-5.133 2.824a.4.4 0 0 1-.593-.35V7.176v.001z"/></svg>',tooltip:!0}),r.on("open",()=>{e.disableCssTransitions(),e.url=i.value||"",e.urlInputView.fieldView.select(),e.focus(),e.enableCssTransitions()},{priority:"low"}),t.on("submit",()=>{e.isValid()&&(n.execute("mediaEmbed",e.url),s())}),t.on("change:isOpen",()=>e.resetFormStatus()),t.on("cancel",()=>s())}_setUpForm(t,e,i){e.delegate("submit","cancel").to(t),e.urlInputView.bind("value").to(i,"value"),e.urlInputView.bind("isReadOnly").to(i,"isEnabled",t=>!t)}}function wm(t){switch(t){case"arabic-leading-zero":return"decimal-leading-zero";case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return t;default:return null}}function km(t,e,i){const n=e.parent,o=i.createElement(t.type),r=n.getChildIndex(e)+1;return i.insertChild(r,o,n),t.style&&i.setStyle("list-style-type",t.style,o),o}function _m(t){const e={},i=t.getStyle("mso-list");if(i){const t=i.match(/(^|\s{1,100})l(\d+)/i),n=i.match(/\s{0,100}lfo(\d+)/i),o=i.match(/\s{0,100}level(\d+)/i);t&&n&&o&&(e.id=t[2],e.order=n[1],e.indent=o[1])}return e}i(106);const xm=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class Cm{constructor(t){this.document=t}isActive(t){return xm.test(t)}execute(t){const e=new Wc(this.document),{body:i}=t._parsedData;!function(t,e){for(const i of t.getChildren())if(i.is("element","b")&&"normal"===i.getStyle("font-weight")){const n=t.getChildIndex(i);e.remove(i),e.insertChild(n,i.getChildren(),t)}}(i,e),function(t,e){for(const i of e.createRangeIn(t)){const t=i.item;if(t.is("element","li")){const i=t.getChild(0);i&&i.is("element","p")&&e.unwrapElement(i)}}}(i,e),t.content=i}}const Em=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,Tm=/xmlns:o="urn:schemas-microsoft-com/i;class Sm{constructor(t){this.document=t}isActive(t){return Em.test(t)||Tm.test(t)}execute(t){const{body:e,stylesString:i}=t._parsedData;(function(t,e){if(!t.childCount)return;const i=new Wc(t.document),n=function(t,e){const i=e.createRangeIn(t),n=new di({name:/^p|h\d+$/,styles:{"mso-list":/.*/}}),o=[];for(const r of i)if("elementStart"===r.type&&n.match(r.item)){const t=_m(r.item);o.push({element:r.item,id:t.id,order:t.order,indent:t.indent})}return o}(t,i);if(!n.length)return;let o=null,r=1;n.forEach((t,s)=>{const a=function(t,e){if(!t)return!0;if(t.id!==e.id)return e.indent-t.indent!=1;const i=e.element.previousSibling;return!i||!((n=i).is("element","ol")||n.is("element","ul"));var n}(n[s-1],t),l=(h=t,(c=a?null:n[s-1])?h.indent-c.indent:h.indent-1);var c,h;if(a&&(o=null,r=1),!o||0!==l){const n=function(t,e){const i=/mso-level-number-format:([^;]{0,100});/gi,n=new RegExp(`@list l${t.id}:level${t.indent}\\s*({[^}]*)`,"gi").exec(e);let o="decimal",r="ol";if(n&&n[1]){const e=i.exec(n[1]);if(e&&e[1]&&(o=e[1].trim(),r="bullet"!==o&&"image"!==o?"ol":"ul"),"bullet"===o){const e=function(t){const e=function(t){if(t.getChild(0).is("$text"))return null;for(const e of t.getChildren()){if(!e.is("element","span"))continue;const t=e.getChild(0);return t.is("$text")?t:t.getChild(0)}}(t);if(!e)return null;const i=e._data;return"o"===i?"circle":"\xb7"===i?"disc":"\xa7"===i?"square":null}(t.element);e&&(o=e)}}return{type:r,style:wm(o)}}(t,e);if(o)if(t.indent>r){const t=o.getChild(o.childCount-1),e=t.getChild(t.childCount-1);o=km(n,e,i),r+=1}else t.indent<r&&(o=function(t,e){const i=t.getAncestors({parentFirst:!0});let n=null,o=0;for(const r of i)if("ul"!==r.name&&"ol"!==r.name||o++,o===e){n=r;break}return n}(o,r-t.indent),r=parseInt(t.indent));else o=km(n,t.element,i);t.indent<=r&&(o.is("element",n.type)||(o=i.rename(n.type,o)))}const d=function(t,e){return function(t,e){const i=new di({name:"span",styles:{"mso-list":"Ignore"}}),n=e.createRangeIn(t);for(const o of n)"elementStart"===o.type&&i.match(o.item)&&e.remove(o.item)}(t,e),e.rename("li",t)}(t.element,i);i.appendChild(d,o)})})(e,i),function(t,e){if(!t.childCount)return;const i=new Wc;!function(t,e,i){const n=i.createRangeIn(e),o=new di({name:"img"}),r=[];for(const s of n)if(o.match(s.item)){const e=s.item,i=e.getAttribute("v:shapes")?e.getAttribute("v:shapes").split(" "):[];i.length&&i.every(e=>t.indexOf(e)>-1)?r.push(e):e.getAttribute("src")||r.push(e)}for(const s of r)i.remove(s)}(function(t,e){const i=e.createRangeIn(t),n=new di({name:/v:(.+)/}),o=[];for(const r of i){if("elementStart"!=r.type)continue;const t=r.item,e=t.previousSibling&&t.previousSibling.name||null;n.match(t)&&t.getAttribute("o:gfxdata")&&"v:shapetype"!==e&&o.push(r.item.getAttribute("id"))}return o}(t,i),t,i),function(t,e){const i=e.createRangeIn(t),n=new di({name:/v:(.+)/}),o=[];for(const r of i)"elementStart"==r.type&&n.match(r.item)&&o.push(r.item);for(const r of o)e.remove(r)}(t,i);const n=function(t,e){const i=e.createRangeIn(t),n=new di({name:"img"}),o=[];for(const r of i)n.match(r.item)&&r.item.getAttribute("src").startsWith("file://")&&o.push(r.item);return o}(t,i);n.length&&function(t,e,i){if(t.length===e.length)for(let o=0;o<t.length;o++){const r=`data:${e[o].type};base64,${n=e[o].hex,btoa(n.match(/\w{2}/g).map(t=>String.fromCharCode(parseInt(t,16))).join(""))}`;i.setAttribute("src",r,t[o])}var n}(n,function(t){if(!t)return[];const e=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,i=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),n=t.match(i),o=[];if(n)for(const r of n){let t=!1;r.includes("\\pngblip")?t="image/png":r.includes("\\jpegblip")&&(t="image/jpeg"),t&&o.push({hex:r.replace(e,"").replace(/[^\da-fA-F]/g,""),type:t})}return o}(e),i)}(e,t.dataTransfer.getData("text/rtf")),t.content=e}}function Am(t){return t.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>1===e.length?" ":Array(e.length+1).join("\xa0 ").substr(0,e.length))}function Om(t,e,i,n,o=1){e>o?n.setAttribute(t,e,i):n.removeAttribute(t,i)}function Im(t,e,i={}){const n=t.createElement("tableCell",i);return t.insertElement("paragraph",n),t.insert(n,e),n}function Pm(t,e){const i=parseInt(e.parent.parent.getAttribute("headingColumns")||0),{column:n}=t.getCellLocation(e);return!!i&&n<i}function Mm(t){return e=>{e.on("element:"+t,(t,e,i)=>{if(e.modelRange&&e.viewItem.isEmpty){const t=i.writer.createPositionAt(e.modelRange.start.nodeAfter,0);i.writer.insertElement("paragraph",t)}},{priority:"low"})}}function Dm(t){let e=0,i=0;const n=Array.from(t.getChildren()).filter(t=>"th"===t.name||"td"===t.name);for(;i<n.length&&"th"===n[i].name;)e+=parseInt(n[i].getAttribute("colspan")||1),i++;return e}class Nm{constructor(t,e={}){this._table=t,this._startRow=void 0!==e.row?e.row:e.startRow||0,this._endRow=void 0!==e.row?e.row:e.endRow,this._startColumn=void 0!==e.column?e.column:e.startColumn||0,this._endColumn=void 0!==e.column?e.column:e.endColumn,this._includeAllSlots=!!e.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){const t=this._table.getChild(this._rowIndex);if(!t||this._isOverEndRow())return{done:!0};if(!t.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let e=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(e=this._formatOutValue(i.cell,i.row,i.column));else{const i=t.getChild(this._cellIndex);if(!i)return this._advanceToNextRow();const n=parseInt(i.getAttribute("colspan")||1),o=parseInt(i.getAttribute("rowspan")||1);(n>1||o>1)&&this._recordSpans(i,o,n),this._shouldSkipSlot()||(e=this._formatOutValue(i)),this._nextCellAtColumn=this._column+n}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,e||this.next()}skipRow(t){this._skipRows.add(t)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return void 0!==this._endRow&&this._row>this._endRow}_isOverEndColumn(){return void 0!==this._endColumn&&this._column>this._endColumn}_formatOutValue(t,e=this._row,i=this._column){return{done:!1,value:new Rm(this,t,e,i)}}_shouldSkipSlot(){return this._skipRows.has(this._row)||this._row<this._startRow||this._column<this._startColumn||void 0!==this._endColumn&&this._column>this._endColumn}_getSpanned(){const t=this._spannedCells.get(this._row);return t&&t.get(this._column)||null}_recordSpans(t,e,i){const n={cell:t,row:this._row,column:this._column};for(let o=this._row;o<this._row+e;o++)for(let t=this._column;t<this._column+i;t++)o==this._row&&t==this._column||this._markSpannedCell(o,t,n)}_markSpannedCell(t,e,i){this._spannedCells.has(t)||this._spannedCells.set(t,new Map),this._spannedCells.get(t).set(e,i)}}class Rm{constructor(t,e,i,n){this.cell=e,this.row=t._row,this.column=t._column,this.cellAnchorRow=i,this.cellAnchorColumn=n,this._cellIndex=t._cellIndex,this._rowIndex=t._rowIndex,this._table=t._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||1)}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||1)}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function zm(t={}){return e=>e.on("insert:table",(e,i,n)=>{const o=i.item;if(!n.consumable.consume(o,"insert"))return;n.consumable.consume(o,"attribute:headingRows:table"),n.consumable.consume(o,"attribute:headingColumns:table");const r=t&&t.asWidget,s=n.writer.createContainerElement("figure",{class:"table"}),a=n.writer.createContainerElement("table");let l;var c,h;n.writer.insert(n.writer.createPositionAt(s,0),a),r&&((h=n.writer).setCustomProperty("table",!0,c=s),l=Dh(c,h,{hasSelectionHandle:!0}));const d=new Nm(o),u={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},f=new Map;for(const g of d){const{row:e,cell:i}=g,r=o.getChild(e),s=f.get(e)||Vm(a,r,e,u,n);f.set(e,s),n.consumable.consume(i,"insert"),jm(g,u,n.writer.createPositionAt(s,"end"),n,t)}for(const t of o.getChildren()){const e=t.index;t.is("element","tableRow")&&!f.has(e)&&f.set(e,Vm(a,t,e,u,n))}const p=n.mapper.toViewPosition(i.range.start);n.mapper.bindElements(o,r?l:s),n.writer.insert(p,r?l:s)})}function Fm(t,e){const{writer:i}=e;if(t.parent.is("element","tableCell"))return Lm(t)?i.createContainerElement("span",{class:"ck-table-bogus-paragraph"}):i.createContainerElement("p")}function Lm(t){return 1===t.parent.childCount&&!Um(t)}function Bm(t,e,i){const{cell:n}=t,o=Hm(t,e),r=i.mapper.toViewElement(n);r&&r.name!==o&&function(t,e,i){const n=i.writer,o=i.mapper.toViewElement(t),r=Lh(n.createEditableElement(e,o.getAttributes()),n);n.insert(n.createPositionAfter(o),r),n.move(n.createRangeIn(o),n.createPositionAt(r,0)),n.remove(n.createRangeOn(o)),i.mapper.unbindViewElement(o),i.mapper.bindElements(t,r)}(n,o,i)}function jm(t,e,i,n,o){const r=o&&o.asWidget,s=Hm(t,e),a=r?Lh(n.writer.createEditableElement(s),n.writer):n.writer.createContainerElement(s),l=t.cell,c=l.getChild(0),h=1===l.childCount&&"paragraph"===c.name;if(n.writer.insert(i,a),n.mapper.bindElements(l,a),!r&&h&&!Um(c)){const t=l.getChild(0);n.consumable.consume(t,"insert"),n.mapper.bindElements(t,a)}}function Vm(t,e,i,n,o){o.consumable.consume(e,"insert");const r=e.isEmpty?o.writer.createEmptyElement("tr"):o.writer.createContainerElement("tr");o.mapper.bindElements(e,r);const s=n.headingRows,a=function(t,e,i){return Wm(t,e)||function(t,e,i){const n=i.writer.createContainerElement(t),o=i.writer.createPositionAt(e,"tbody"==t?"end":0);return i.writer.insert(o,n),n}(t,e,i)}(function(t,e){return t<e.headingRows?"thead":"tbody"}(i,n),t,o),l=o.writer.createPositionAt(a,s>0&&i>=s?i-s:i);return o.writer.insert(l,r),r}function Hm(t,e){const{row:i,column:n}=t,{headingColumns:o,headingRows:r}=e;return r&&r>i||o&&o>n?"th":"td"}function Wm(t,e){for(const i of e.getChildren())if(i.name==t)return i}function qm(t,e,i){const n=Wm(t,e);n&&0===n.childCount&&i.writer.remove(i.writer.createRangeOn(n))}function Um(t){return!![...t.getAttributeKeys()].length}class Ym extends Nt{refresh(){const t=this.editor.model;this.isEnabled=function(t,e){const i=t.getFirstPosition().parent;return e.checkChild(i===i.root?i:i.parent,"table")}(t.document.selection,t.schema)}execute(t={}){const e=this.editor.model,i=e.document.selection,n=this.editor.plugins.get("TableUtils"),o=this.editor.config.get("table"),r=Bh(i,e),s=o.defaultHeadings.rows,a=o.defaultHeadings.columns;void 0===t.headingRows&&s&&(t.headingRows=s),void 0===t.headingColumns&&a&&(t.headingColumns=a),e.change(i=>{const o=n.createTable(i,t);e.insertContent(o,r),i.setSelection(i.createPositionAt(o.getNodeByPath([0,0,0]),0))})}}function Gm(t){const e=[];for(const i of Jm(t.getRanges())){const t=i.getContainedElement();t&&t.is("element","tableCell")&&e.push(t)}return e}function Zm(t){const e=[];for(const i of t.getRanges()){const t=i.start.findAncestor("tableCell");t&&e.push(t)}return e}function $m(t){const e=Gm(t);return e.length?e:Zm(t)}function Xm(t){return tv(t.map(t=>t.parent.index))}function Km(t){const e=t[0].findAncestor("table");return tv([...new Nm(e)].filter(e=>t.includes(e.cell)).map(t=>t.column))}function Qm(t,e){if(t.length<2||!function(t){const e=t[0].findAncestor("table");if(!iv(Xm(t),parseInt(e.getAttribute("headingRows")||0)))return!1;const i=parseInt(e.getAttribute("headingColumns")||0);return iv(Km(t),i)}(t))return!1;const i=new Set,n=new Set;let o=0;for(const r of t){const{row:t,column:s}=e.getCellLocation(r),a=parseInt(r.getAttribute("rowspan")||1),l=parseInt(r.getAttribute("colspan")||1);i.add(t),n.add(s),a>1&&i.add(t+a-1),l>1&&n.add(s+l-1),o+=a*l}return function(t,e){const i=Array.from(t.values()),n=Array.from(e.values());return(Math.max(...i)-Math.min(...i)+1)*(Math.max(...n)-Math.min(...n)+1)}(i,n)==o}function Jm(t){return Array.from(t).sort(ev)}function tv(t){const e=t.sort((t,e)=>t-e);return{first:e[0],last:e[e.length-1]}}function ev(t,e){return t.start.isBefore(e.start)?-1:1}function iv({first:t,last:e},i){return t<i==e<i}class nv extends Nt{constructor(t,e={}){super(t),this.order=e.order||"below"}refresh(){const t=!!$m(this.editor.model.document.selection).length;this.isEnabled=t}execute(){const t=this.editor,e=t.model.document.selection,i=t.plugins.get("TableUtils"),n="above"===this.order,o=$m(e),r=Xm(o),s=n?r.first:r.last,a=o[0].findAncestor("table");i.insertRows(a,{at:n?s:s+1,copyStructureFromAbove:!n})}}class ov extends Nt{constructor(t,e={}){super(t),this.order=e.order||"right"}refresh(){const t=!!$m(this.editor.model.document.selection).length;this.isEnabled=t}execute(){const t=this.editor,e=t.model.document.selection,i=t.plugins.get("TableUtils"),n="left"===this.order,o=$m(e),r=Km(o),s=n?r.first:r.last,a=o[0].findAncestor("table");i.insertColumns(a,{columns:1,at:n?s:s+1})}}class rv extends Nt{constructor(t,e={}){super(t),this.direction=e.direction||"horizontally"}refresh(){const t=$m(this.editor.model.document.selection);this.isEnabled=1===t.length}execute(){const t=$m(this.editor.model.document.selection)[0],e="horizontally"===this.direction,i=this.editor.plugins.get("TableUtils");e?i.splitCellHorizontally(t,2):i.splitCellVertically(t,2)}}function sv(t,e,i){const{startRow:n,startColumn:o,endRow:r,endColumn:s}=e,a=i.createElement("table"),l=r-n+1;for(let h=0;h<l;h++)i.insertElement("tableRow",a,"end");const c=[...new Nm(t,{startRow:n,endRow:r,startColumn:o,endColumn:s,includeAllSlots:!0})];for(const{row:h,column:d,cell:u,isAnchor:f,cellAnchorRow:p,cellAnchorColumn:g}of c){const t=a.getChild(h-n);if(f){const e=i.cloneElement(u);i.append(e,t),dv(e,h,d,r,s,i)}else(p<n||g<o)&&Im(i,i.createPositionAt(t,"end"))}return function(t,e,i,n,o){const r=parseInt(e.getAttribute("headingRows")||0);r>0&&Om("headingRows",r-i,t,o,0);const s=parseInt(e.getAttribute("headingColumns")||0);s>0&&Om("headingColumns",s-n,t,o,0)}(a,t,n,o,i),a}function av(t,e,i=0){const n=[],o=new Nm(t,{startRow:i,endRow:e-1});for(const r of o){const{row:t,cellHeight:i}=r,o=t+i-1;t<e&&e<=o&&n.push(r)}return n}function lv(t,e,i){const n=t.parent,o=n.parent,r=n.index,s=e-r,a={},l=parseInt(t.getAttribute("rowspan"))-s;l>1&&(a.rowspan=l);const c=parseInt(t.getAttribute("colspan")||1);c>1&&(a.colspan=c);const h=r+s,d=[...new Nm(o,{startRow:r,endRow:h,includeAllSlots:!0})];let u,f=null;for(const p of d){const{row:e,column:n,cell:o}=p;o===t&&void 0===u&&(u=n),void 0!==u&&u===n&&e===h&&(f=Im(i,p.getPositionBefore(),a))}return Om("rowspan",s,t,i),f}function cv(t,e){const i=[],n=new Nm(t);for(const o of n){const{column:t,cellWidth:n}=o,r=t+n-1;t<e&&e<=r&&i.push(o)}return i}function hv(t,e,i,n){const o=i-e,r={},s=parseInt(t.getAttribute("colspan"))-o;s>1&&(r.colspan=s);const a=parseInt(t.getAttribute("rowspan")||1);a>1&&(r.rowspan=a);const l=Im(n,n.createPositionAfter(t),r);return Om("colspan",o,t,n),l}function dv(t,e,i,n,o,r){const s=parseInt(t.getAttribute("colspan")||1),a=parseInt(t.getAttribute("rowspan")||1);i+s-1>o&&Om("colspan",o-i+1,t,r,1),e+a-1>n&&Om("rowspan",n-e+1,t,r,1)}function uv(t,e){const i=e.getColumns(t),n=new Array(i).fill(0);for(const{column:r}of new Nm(t))n[r]++;const o=n.reduce((t,e,i)=>e?t:[...t,i],[]);return o.length>0&&(e.removeColumns(t,{at:o[o.length-1]}),!0)}function fv(t,e){const i=[],n=e.getRows(t);for(let o=0;o<n;o++)t.getChild(o).isEmpty&&i.push(o);return i.length>0&&(e.removeRows(t,{at:i[i.length-1]}),!0)}function pv(t,e){uv(t,e)||fv(t,e)}function gv(t,e){const i=Array.from(new Nm(t,{startColumn:e.firstColumn,endColumn:e.lastColumn,row:e.lastRow}));return i.every(({cellHeight:t})=>1===t)?e.lastRow:e.lastRow+(i[0].cellHeight-1)}function mv(t,e){const i=Array.from(new Nm(t,{startRow:e.firstRow,endRow:e.lastRow,column:e.lastColumn}));return i.every(({cellWidth:t})=>1===t)?e.lastColumn:e.lastColumn+(i[0].cellWidth-1)}class vv extends Nt{constructor(t,e){super(t),this.direction=e.direction,this.isHorizontal="right"==this.direction||"left"==this.direction}refresh(){const t=this._getMergeableCell();this.value=t,this.isEnabled=!!t}execute(){const t=this.editor.model,e=Zm(t.document.selection)[0],i=this.value,n=this.direction;t.change(t=>{const o="right"==n||"down"==n,r=o?e:i,s=o?i:e,a=s.parent;!function(t,e,i){yv(t)||(yv(e)&&i.remove(i.createRangeIn(e)),i.move(i.createRangeIn(t),i.createPositionAt(e,"end"))),i.remove(t)}(s,r,t);const l=this.isHorizontal?"colspan":"rowspan",c=parseInt(e.getAttribute(l)||1),h=parseInt(i.getAttribute(l)||1);t.setAttribute(l,c+h,r),t.setSelection(t.createRangeIn(r));const d=this.editor.plugins.get("TableUtils");pv(a.findAncestor("table"),d)})}_getMergeableCell(){const t=Zm(this.editor.model.document.selection)[0];if(!t)return;const e=this.editor.plugins.get("TableUtils"),i=this.isHorizontal?function(t,e,i){const n="right"==e?t.nextSibling:t.previousSibling,o=(t.parent.parent.getAttribute("headingColumns")||0)>0;if(!n)return;const r="right"==e?t:n,s="right"==e?n:t,{column:a}=i.getCellLocation(r),{column:l}=i.getCellLocation(s),c=parseInt(r.getAttribute("colspan")||1),h=Pm(i,r),d=Pm(i,s);return o&&h!=d?void 0:a+c===l?n:void 0}(t,this.direction,e):function(t,e,i){const n=t.parent,o=n.parent,r=o.getChildIndex(n);if("down"==e&&r===i.getRows(o)-1||"up"==e&&0===r)return;const s=parseInt(t.getAttribute("rowspan")||1),a=o.getAttribute("headingRows")||0;if(a&&("down"==e&&r+s===a||"up"==e&&r===a))return;const l=parseInt(t.getAttribute("rowspan")||1),c="down"==e?r+l:r,h=[...new Nm(o,{endRow:c})],d=h.find(e=>e.cell===t).column,u=h.find(({row:t,cellHeight:i,column:n})=>n===d&&("down"==e?t===c:c===t+i));return u&&u.cell}(t,this.direction,e);if(!i)return;const n=this.isHorizontal?"rowspan":"colspan",o=parseInt(t.getAttribute(n)||1);return parseInt(i.getAttribute(n)||1)===o?i:void 0}}function yv(t){return 1==t.childCount&&t.getChild(0).is("element","paragraph")&&t.getChild(0).isEmpty}class bv extends Nt{refresh(){const t=$m(this.editor.model.document.selection),e=t[0];if(e){const i=e.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getRows(i)-1,o=Xm(t);this.isEnabled=!(0===o.first&&o.last===n)}else this.isEnabled=!1}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=$m(t.document.selection),n=Xm(i),o=i[0],r=o.findAncestor("table"),s=e.getCellLocation(o).column;t.change(t=>{e.removeRows(r,{at:n.first,rows:n.last-n.first+1});const i=function(t,e,i,n){const o=t.getChild(Math.min(e,n-1));let r=o.getChild(0),s=0;for(const a of o.getChildren()){if(s>i)return r;r=a,s+=parseInt(a.getAttribute("colspan")||1)}return r}(r,n.first,s,e.getRows(r));t.setSelection(t.createPositionAt(i,0))})}}class wv extends Nt{refresh(){const t=$m(this.editor.model.document.selection),e=t[0];if(e){const i=e.findAncestor("table"),n=this.editor.plugins.get("TableUtils").getColumns(i),{first:o,last:r}=Km(t);this.isEnabled=r-o<n-1}else this.isEnabled=!1}execute(){const[t,e]=function(t){const e=$m(t),i=e[0],n=e.pop(),o=[i,n];return i.isBefore(n)?o:o.reverse()}(this.editor.model.document.selection),i=t.parent.parent,n=[...new Nm(i)],o={first:n.find(e=>e.cell===t).column,last:n.find(t=>t.cell===e).column},r=function(t,e,i,n){return parseInt(i.getAttribute("colspan")||1)>1?i:e.previousSibling||i.nextSibling?i.nextSibling||e.previousSibling:n.first?t.reverse().find(({column:t})=>t<n.first).cell:t.reverse().find(({column:t})=>t>n.last).cell}(n,t,e,o);this.editor.model.change(t=>{const e=o.last-o.first+1;this.editor.plugins.get("TableUtils").removeColumns(i,{at:o.first,columns:e}),t.setSelection(t.createPositionAt(r,0))})}}class kv extends Nt{refresh(){const t=$m(this.editor.model.document.selection),e=t.length>0;this.isEnabled=e,this.value=e&&t.every(t=>this._isInHeading(t,t.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.model,i=$m(e.document.selection),n=i[0].findAncestor("table"),{first:o,last:r}=Xm(i),s=this.value?o:r+1,a=n.getAttribute("headingRows")||0;e.change(t=>{if(s){const e=av(n,s,s>a?a:0);for(const{cell:i}of e)lv(i,s,t)}Om("headingRows",s,n,t,0)})}_isInHeading(t,e){const i=parseInt(e.getAttribute("headingRows")||0);return!!i&&t.parent.index<i}}class _v extends Nt{refresh(){const t=$m(this.editor.model.document.selection),e=this.editor.plugins.get("TableUtils"),i=t.length>0;this.isEnabled=i,this.value=i&&t.every(t=>Pm(e,t))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.model,i=$m(e.document.selection),n=i[0].findAncestor("table"),{first:o,last:r}=Km(i),s=this.value?o:r+1;e.change(t=>{if(s){const e=cv(n,s);for(const{cell:i,column:n}of e)hv(i,n,s,t)}Om("headingColumns",s,n,t,0)})}}class xv extends Mt{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(t){const e=t.parent,i=e.parent,n=i.getChildIndex(e),o=new Nm(i,{row:n});for(const{cell:r,row:s,column:a}of o)if(r===t)return{row:s,column:a}}createTable(t,e){const i=t.createElement("table"),n=parseInt(e.rows)||2,o=parseInt(e.columns)||2;return Cv(t,i,0,n,o),e.headingRows&&Om("headingRows",Math.min(e.headingRows,n),i,t,0),e.headingColumns&&Om("headingColumns",Math.min(e.headingColumns,o),i,t,0),i}insertRows(t,e={}){const i=this.editor.model,n=e.at||0,o=e.rows||1,r=void 0!==e.copyStructureFromAbove,s=e.copyStructureFromAbove?n-1:n,l=this.getRows(t),c=this.getColumns(t);if(n>l)throw new a.a("tableutils-insertrows-insert-out-of-range",this,{options:e});i.change(e=>{const i=t.getAttribute("headingRows")||0;if(i>n&&Om("headingRows",i+o,t,e,0),!r&&(0===n||n===l))return void Cv(e,t,n,o,c);const a=r?Math.max(n,s):n,h=new Nm(t,{endRow:a}),d=new Array(c).fill(1);for(const{row:t,column:l,cellHeight:c,cellWidth:u,cell:f}of h){const i=t+c-1,a=t<=s&&s<=i;t<n&&n<=i?(e.setAttribute("rowspan",c+o,f),d[l]=-u):r&&a&&(d[l]=u)}for(let r=0;r<o;r++){const i=e.createElement("tableRow");e.insert(i,t,n);for(let t=0;t<d.length;t++){const n=d[t],o=e.createPositionAt(i,"end");n>0&&Im(e,o,n>1?{colspan:n}:null),t+=Math.abs(n)-1}}})}insertColumns(t,e={}){const i=e.at||0,n=e.columns||1;this.editor.model.change(e=>{const o=t.getAttribute("headingColumns");i<o&&e.setAttribute("headingColumns",o+n,t);const r=this.getColumns(t);if(0===i||r===i){for(const o of t.getChildren())o.is("element","tableRow")&&Ev(n,e,e.createPositionAt(o,i?"end":0));return}const s=new Nm(t,{column:i,includeAllSlots:!0});for(const t of s){const{row:o,cell:r,cellAnchorColumn:a,cellAnchorRow:l,cellWidth:c,cellHeight:h}=t;if(a<i){e.setAttribute("colspan",c+n,r);const t=l+h-1;for(let e=o;e<=t;e++)s.skipRow(e)}else Ev(n,e,t.getPositionBefore())}})}removeRows(t,e){const i=this.editor.model,n=e.rows||1,o=this.getRows(t),r=e.at,s=r+n-1;if(s>o-1)throw new a.a("tableutils-removerows-row-index-out-of-range",this,{table:t,options:e});i.change(e=>{const{cellsToMove:i,cellsToTrim:n}=function(t,e,i){const n=new Map,o=[];for(const{row:r,column:s,cellHeight:a,cell:l}of new Nm(t,{endRow:i})){const t=r+a-1;if(r>=e&&r<=i&&t>i&&n.set(s,{cell:l,rowspan:a-(i-r+1)}),r<e&&t>=e){let n;n=t>=i?i-e+1:t-e+1,o.push({cell:l,rowspan:a-n})}}return{cellsToMove:n,cellsToTrim:o}}(t,r,s);i.size&&function(t,e,i,n){const o=[...new Nm(t,{includeAllSlots:!0,row:e})],r=t.getChild(e);let s;for(const{column:a,cell:l,isAnchor:c}of o)if(i.has(a)){const{cell:t,rowspan:e}=i.get(a),o=s?n.createPositionAfter(s):n.createPositionAt(r,0);n.move(n.createRangeOn(t),o),Om("rowspan",e,t,n),s=t}else c&&(s=l)}(t,s+1,i,e);for(let o=s;o>=r;o--)e.remove(t.getChild(o));for(const{rowspan:t,cell:o}of n)Om("rowspan",t,o,e);!function(t,e,i,n){const o=t.getAttribute("headingRows")||0;e<o&&Om("headingRows",i<o?o-(i-e+1):e,t,n,0)}(t,r,s,e),uv(t,this)||fv(t,this)})}removeColumns(t,e){const i=e.at,n=e.at+(e.columns||1)-1;this.editor.model.change(e=>{!function(t,e,i){const n=t.getAttribute("headingColumns")||0;if(n&&e.first<n){const o=Math.min(n-1,e.last)-e.first+1;i.setAttribute("headingColumns",n-o,t)}}(t,{first:i,last:n},e);for(let o=n;o>=i;o--)for(const{cell:i,column:n,cellWidth:r}of[...new Nm(t)])n<=o&&r>1&&n+r>o?Om("colspan",r-1,i,e):n===o&&e.remove(i);fv(t,this)||uv(t,this)})}splitCellVertically(t,e=2){const i=this.editor.model,n=t.parent.parent,o=parseInt(t.getAttribute("rowspan")||1),r=parseInt(t.getAttribute("colspan")||1);i.change(i=>{if(r>1){const{newCellsSpan:n,updatedSpan:s}=Tv(r,e);Om("colspan",s,t,i);const a={};n>1&&(a.colspan=n),o>1&&(a.rowspan=o),Ev(r>e?e-1:r-1,i,i.createPositionAfter(t),a)}if(r<e){const s=e-r,a=[...new Nm(n)],{column:l}=a.find(({cell:e})=>e===t),c=a.filter(({cell:e,cellWidth:i,column:n})=>e!==t&&n===l||n<l&&n+i>l);for(const{cell:t,cellWidth:e}of c)i.setAttribute("colspan",e+s,t);const h={};o>1&&(h.rowspan=o),Ev(s,i,i.createPositionAfter(t),h);const d=n.getAttribute("headingColumns")||0;d>l&&Om("headingColumns",d+s,n,i)}})}splitCellHorizontally(t,e=2){const i=this.editor.model,n=t.parent,o=n.parent,r=o.getChildIndex(n),s=parseInt(t.getAttribute("rowspan")||1),a=parseInt(t.getAttribute("colspan")||1);i.change(i=>{if(s>1){const n=[...new Nm(o,{startRow:r,endRow:r+s-1,includeAllSlots:!0})],{newCellsSpan:l,updatedSpan:c}=Tv(s,e);Om("rowspan",c,t,i);const{column:h}=n.find(({cell:e})=>e===t),d={};l>1&&(d.rowspan=l),a>1&&(d.colspan=a);for(const t of n){const{column:e,row:n}=t,o=e===h,s=(n+r+c)%l==0;n>=r+c&&o&&s&&Ev(1,i,t.getPositionBefore(),d)}}if(s<e){const n=e-s,l=[...new Nm(o,{startRow:0,endRow:r})];for(const{cell:e,cellHeight:o,row:s}of l)e!==t&&s+o>r&&i.setAttribute("rowspan",o+n,e);const c={};a>1&&(c.colspan=a),Cv(i,o,r+1,n,1,c);const h=o.getAttribute("headingRows")||0;h>r&&Om("headingRows",h+n,o,i)}})}getColumns(t){return[...t.getChild(0).getChildren()].reduce((t,e)=>t+parseInt(e.getAttribute("colspan")||1),0)}getRows(t){return Array.from(t.getChildren()).reduce((t,e)=>e.is("element","tableRow")?t+1:t,0)}}function Cv(t,e,i,n,o,r={}){for(let s=0;s<n;s++){const n=t.createElement("tableRow");t.insert(n,e,i),Ev(o,t,t.createPositionAt(n,"end"),r)}}function Ev(t,e,i,n={}){for(let o=0;o<t;o++)Im(e,i,n)}function Tv(t,e){if(t<e)return{newCellsSpan:1,updatedSpan:1};const i=Math.floor(t/e);return{newCellsSpan:i,updatedSpan:t-i*e+i}}class Sv extends Nt{refresh(){const t=Gm(this.editor.model.document.selection);this.isEnabled=Qm(t,this.editor.plugins.get(xv))}execute(){const t=this.editor.model,e=this.editor.plugins.get(xv);t.change(i=>{const n=Gm(t.document.selection),o=n.shift(),{mergeWidth:r,mergeHeight:s}=function(t,e,i){let n=0,o=0;for(const a of e){const{row:t,column:e}=i.getCellLocation(a);n=Iv(a,e,n,"colspan"),o=Iv(a,t,o,"rowspan")}const{row:r,column:s}=i.getCellLocation(t);return{mergeWidth:n-s,mergeHeight:o-r}}(o,n,e);Om("colspan",r,o,i),Om("rowspan",s,o,i);for(const t of n)Av(t,o,i);pv(o.findAncestor("table"),e),i.setSelection(o,"in")})}}function Av(t,e,i){Ov(t)||(Ov(e)&&i.remove(i.createRangeIn(e)),i.move(i.createRangeIn(t),i.createPositionAt(e,"end"))),i.remove(t)}function Ov(t){return 1==t.childCount&&t.getChild(0).is("element","paragraph")&&t.getChild(0).isEmpty}function Iv(t,e,i,n){const o=parseInt(t.getAttribute(n)||1);return Math.max(i,e+o)}class Pv extends Nt{constructor(t){super(t),this.affectsData=!1}refresh(){const t=$m(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,e=$m(t.document.selection),i=Xm(e),n=e[0].findAncestor("table"),o=[];for(let r=i.first;r<=i.last;r++)for(const e of n.getChild(r).getChildren())o.push(t.createRangeOn(e));t.change(t=>{t.setSelection(o)})}}class Mv extends Nt{constructor(t){super(t),this.affectsData=!1}refresh(){const t=$m(this.editor.model.document.selection);this.isEnabled=t.length>0}execute(){const t=this.editor.model,e=$m(t.document.selection),i=e[0],n=e.pop(),o=i.findAncestor("table"),r=this.editor.plugins.get("TableUtils"),s=r.getCellLocation(i),a=r.getCellLocation(n),l=Math.min(s.column,a.column),c=Math.max(s.column,a.column),h=[];for(const d of new Nm(o,{startColumn:l,endColumn:c}))h.push(t.createRangeOn(d.cell));t.change(t=>{t.setSelection(h)})}}function Dv(t,e){let i=!1;const n=function(t){const e=parseInt(t.getAttribute("headingRows")||0),i=Array.from(t.getChildren()).reduce((t,e)=>e.is("element","tableRow")?t+1:t,0),n=[];for(const{row:o,cell:r,cellHeight:s}of new Nm(t)){if(s<2)continue;const t=o<e?e:i;o+s>t&&n.push({cell:r,rowspan:t-o})}return n}(t);if(n.length){i=!0;for(const t of n)Om("rowspan",t.rowspan,t.cell,e,1)}return i}function Nv(t,e){let i=!1;const n=function(t){const e=new Array(t.childCount).fill(0);for(const{rowIndex:i}of new Nm(t,{includeAllSlots:!0}))e[i]++;return e}(t),o=[];for(const[a,l]of n.entries())!l&&t.getChild(a).is("element","tableRow")&&o.push(a);if(o.length){i=!0;for(const i of o.reverse())e.remove(t.getChild(i)),n.splice(i,1)}const r=n.filter((e,i)=>t.getChild(i).is("element","tableRow")),s=r[0];if(!r.every(t=>t===s)){const n=r.reduce((t,e)=>e>t?e:t,0);for(const[o,s]of r.entries()){const r=n-s;if(r){for(let i=0;i<r;i++)Im(e,e.createPositionAt(t.getChild(o),"end"));i=!0}}}return i}function Rv(t){const e=t.attributeKey;return"attribute"===t.type&&("headingRows"===e||"colspan"===e||"rowspan"===e)}function zv(t,e){let i=!1;for(const n of t.getChildren())n.is("element","tableRow")&&(i=Fv(n,e)||i);return i}function Fv(t,e){let i=!1;for(const n of t.getChildren())i=Lv(n,e)||i;return i}function Lv(t,e){if(0==t.childCount)return e.insertElement("paragraph",t),!0;const i=Array.from(t.getChildren()).filter(t=>t.is("$text"));for(const n of i)e.wrap(e.createRangeOn(n),"paragraph");return!!i.length}function Bv(t){return!(!t.position||!t.position.parent.is("element","tableCell"))&&("insert"==t.type&&"$text"==t.name||"remove"==t.type)}function jv(t,e){if(!t.is("element","paragraph"))return!1;const i=e.toViewElement(t);return!!i&&Lm(t)!==i.is("element","span")}i(108);class Vv extends Mt{static get pluginName(){return"TableEditing"}init(){const t=this.editor,e=t.model,i=e.schema,n=t.conversion;i.register("table",{allowWhere:"$block",allowAttributes:["headingRows","headingColumns"],isObject:!0,isBlock:!0}),i.register("tableRow",{allowIn:"table",isLimit:!0}),i.register("tableCell",{allowIn:"tableRow",allowChildren:"$block",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),n.for("upcast").add(t=>{t.on("element:figure",(t,e,i)=>{if(!i.consumable.test(e.viewItem,{name:!0,classes:"table"}))return;const n=function(t){for(const e of t.getChildren())if(e.is("element","table"))return e}(e.viewItem);if(!n||!i.consumable.test(n,{name:!0}))return;const o=fr(i.convertItem(n,e.modelCursor).modelRange.getItems());o&&(i.consumable.consume(e.viewItem,{name:!0,classes:"table"}),i.convertChildren(e.viewItem,i.writer.createPositionAt(o,"end")),i.updateConversionResult(o,e))})}),n.for("upcast").add(t=>{t.on("element:table",(t,e,i)=>{const n=e.viewItem;if(!i.consumable.test(n,{name:!0}))return;const{rows:o,headingRows:r,headingColumns:s}=function(t){const e={headingRows:0,headingColumns:0},i=[],n=[];let o;for(const r of Array.from(t.getChildren()))if("tbody"===r.name||"thead"===r.name||"tfoot"===r.name){"thead"!==r.name||o||(o=r);const t=Array.from(r.getChildren()).filter(t=>t.is("element","tr"));for(const r of t)if("thead"===r.parent.name&&r.parent===o)e.headingRows++,i.push(r);else{n.push(r);const t=Dm(r);t>e.headingColumns&&(e.headingColumns=t)}}return e.rows=[...i,...n],e}(n),a={};s&&(a.headingColumns=s),r&&(a.headingRows=r);const l=i.writer.createElement("table",a);if(i.safeInsert(l,e.modelCursor)){if(i.consumable.consume(n,{name:!0}),o.forEach(t=>i.convertItem(t,i.writer.createPositionAt(l,"end"))),i.convertChildren(n,i.writer.createPositionAt(l,"end")),l.isEmpty){const t=i.writer.createElement("tableRow");i.writer.insert(t,i.writer.createPositionAt(l,"end")),Im(i.writer,i.writer.createPositionAt(t,"end"))}i.updateConversionResult(l,e)}})}),n.for("editingDowncast").add(zm({asWidget:!0})),n.for("dataDowncast").add(zm()),n.for("upcast").elementToElement({model:"tableRow",view:"tr"}),n.for("upcast").add(t=>{t.on("element:tr",(t,e)=>{e.viewItem.isEmpty&&0==e.modelCursor.index&&t.stop()},{priority:"high"})}),n.for("editingDowncast").add(t=>t.on("insert:tableRow",(t,e,i)=>{const n=e.item;if(!i.consumable.consume(n,"insert"))return;const o=n.parent,r=function(t){for(const e of t.getChildren())if("table"===e.name)return e}(i.mapper.toViewElement(o)),s=o.getChildIndex(n),a=new Nm(o,{row:s}),l={headingRows:o.getAttribute("headingRows")||0,headingColumns:o.getAttribute("headingColumns")||0},c=new Map;for(const h of a){const t=c.get(s)||Vm(r,n,s,l,i);c.set(s,t),i.consumable.consume(h.cell,"insert"),jm(h,l,i.writer.createPositionAt(t,"end"),i,{asWidget:!0})}})),n.for("editingDowncast").add(t=>t.on("remove:tableRow",(t,e,i)=>{t.stop();const n=i.writer,o=i.mapper,r=o.toViewPosition(e.position).getLastMatchingPosition(t=>!t.item.is("element","tr")).nodeAfter,s=r.parent.parent,a=n.createRangeOn(r),l=n.remove(a);for(const c of n.createRangeIn(l).getItems())o.unbindViewElement(c);qm("thead",s,i),qm("tbody",s,i)},{priority:"higher"})),n.for("upcast").elementToElement({model:"tableCell",view:"td"}),n.for("upcast").elementToElement({model:"tableCell",view:"th"}),n.for("upcast").add(Mm("td")),n.for("upcast").add(Mm("th")),n.for("editingDowncast").add(t=>t.on("insert:tableCell",(t,e,i)=>{const n=e.item;if(!i.consumable.consume(n,"insert"))return;const o=n.parent,r=o.parent,s=r.getChildIndex(o),a=new Nm(r,{row:s}),l={headingRows:r.getAttribute("headingRows")||0,headingColumns:r.getAttribute("headingColumns")||0};for(const c of a)if(c.cell===n){const t=i.mapper.toViewElement(o);return void jm(c,l,i.writer.createPositionAt(t,o.getChildIndex(n)),i,{asWidget:!0})}})),n.for("editingDowncast").elementToElement({model:"paragraph",view:Fm,converterPriority:"high"}),n.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),n.for("upcast").attributeToAttribute({model:{key:"colspan",value:Hv("colspan")},view:"colspan"}),n.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),n.for("upcast").attributeToAttribute({model:{key:"rowspan",value:Hv("rowspan")},view:"rowspan"}),n.for("editingDowncast").add(t=>t.on("attribute:headingColumns:table",(t,e,i)=>{const n=e.item;if(!i.consumable.consume(e.item,t.name))return;const o={headingRows:n.getAttribute("headingRows")||0,headingColumns:n.getAttribute("headingColumns")||0},r=e.attributeOldValue,s=e.attributeNewValue,a=(r>s?r:s)-1;for(const l of new Nm(n,{endColumn:a}))Bm(l,o,i)})),t.data.mapper.on("modelToViewPosition",(t,e)=>{const i=e.modelPosition.parent,n=e.modelPosition.nodeBefore;if(!i.is("element","tableCell"))return;if(!n||!n.is("element","paragraph"))return;const o=e.mapper.toViewElement(n),r=e.mapper.toViewElement(i);o===r&&(e.viewPosition=e.mapper.findPositionIn(r,n.maxOffset))}),t.config.define("table.defaultHeadings.rows",0),t.config.define("table.defaultHeadings.columns",0),t.commands.add("insertTable",new Ym(t)),t.commands.add("insertTableRowAbove",new nv(t,{order:"above"})),t.commands.add("insertTableRowBelow",new nv(t,{order:"below"})),t.commands.add("insertTableColumnLeft",new ov(t,{order:"left"})),t.commands.add("insertTableColumnRight",new ov(t,{order:"right"})),t.commands.add("removeTableRow",new bv(t)),t.commands.add("removeTableColumn",new wv(t)),t.commands.add("splitTableCellVertically",new rv(t,{direction:"vertically"})),t.commands.add("splitTableCellHorizontally",new rv(t,{direction:"horizontally"})),t.commands.add("mergeTableCells",new Sv(t)),t.commands.add("mergeTableCellRight",new vv(t,{direction:"right"})),t.commands.add("mergeTableCellLeft",new vv(t,{direction:"left"})),t.commands.add("mergeTableCellDown",new vv(t,{direction:"down"})),t.commands.add("mergeTableCellUp",new vv(t,{direction:"up"})),t.commands.add("setTableColumnHeader",new _v(t)),t.commands.add("setTableRowHeader",new kv(t)),t.commands.add("selectTableRow",new Pv(t)),t.commands.add("selectTableColumn",new Mv(t)),function(t){t.document.registerPostFixer(()=>function(t){const e=t.document.differ,i=new Set;for(const n of e.getChanges())if("attribute"===n.type){const t=n.range.start.nodeAfter;t&&t.is("element","table")&&"headingRows"===n.attributeKey&&i.add(t)}else if("insert"===n.type||"remove"===n.type)if("tableRow"===n.name){const t=n.position.findAncestor("table"),e=t.getAttribute("headingRows")||0;n.position.offset<e&&i.add(t)}else if("tableCell"===n.name){const t=n.position.findAncestor("table"),e=t.getAttribute("headingColumns")||0;n.position.offset<e&&i.add(t)}if(i.size){for(const t of i.values())e.refreshItem(t);return!0}return!1}(t))}(e),function(t){t.document.registerPostFixer(e=>function(t,e){const i=e.document.differ.getChanges();let n=!1;const o=new Set;for(const r of i){let e;"table"==r.name&&"insert"==r.type&&(e=r.position.nodeAfter),"tableRow"!=r.name&&"tableCell"!=r.name||(e=r.position.findAncestor("table")),Rv(r)&&(e=r.range.start.findAncestor("table")),e&&!o.has(e)&&(n=Dv(e,t)||n,n=Nv(e,t)||n,o.add(e))}return n}(e,t))}(e),function(t,e){t.document.registerPostFixer(()=>function(t,e){const i=new Set;for(const n of t.getChanges()){const t="attribute"==n.type?n.range.start.parent:n.position.parent;t.is("element","tableCell")&&i.add(t)}for(const n of i.values())for(const i of[...n.getChildren()].filter(t=>jv(t,e)))t.refreshItem(i);return!1}(t.document.differ,e))}(e,t.editing.mapper),function(t){t.document.registerPostFixer(e=>function(t,e){const i=e.document.differ.getChanges();let n=!1;for(const o of i)"insert"==o.type&&"table"==o.name&&(n=zv(o.position.nodeAfter,t)||n),"insert"==o.type&&"tableRow"==o.name&&(n=Fv(o.position.nodeAfter,t)||n),"insert"==o.type&&"tableCell"==o.name&&(n=Lv(o.position.nodeAfter,t)||n),Bv(o)&&(n=Lv(o.position.parent,t)||n);return n}(e,t))}(e)}static get requires(){return[xv]}}function Hv(t){return e=>{const i=parseInt(e.getAttribute(t));return Number.isNaN(i)||i<=0?null:i}}i(110);class Wv extends hl{constructor(t){super(t);const e=this.bindTemplate;this.items=this._createGridCollection(),this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(t,e)=>`${e} \xd7 ${t}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":e.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck-insert-table-dropdown__label"]},children:[{text:e.to("label")}]}],on:{mousedown:e.to(t=>{t.preventDefault()}),click:e.to(()=>{this.fire("execute")})}}),this.on("boxover",(t,e)=>{const{row:i,column:n}=e.target.dataset;this.set({rows:parseInt(i),columns:parseInt(n)})}),this.on("change:columns",()=>{this._highlightGridBoxes()}),this.on("change:rows",()=>{this._highlightGridBoxes()})}focus(){}focusLast(){}_highlightGridBoxes(){const t=this.rows,e=this.columns;this.items.map((i,n)=>{const o=Math.floor(n/10)<t&&n%10<e;i.set("isOn",o)})}_createGridCollection(){const t=[];for(let e=0;e<100;e++){const i=Math.floor(e/10);t.push(new qv(this.locale,i+1,e%10+1))}return this.createCollection(t)}}class qv extends hl{constructor(t,e,i){super(t);const n=this.bindTemplate;this.set("isOn",!1),this.setTemplate({tag:"div",attributes:{class:["ck-insert-table-dropdown-grid-box",n.if("isOn","ck-on")],"data-row":e,"data-column":i}})}}class Uv extends Mt{static get pluginName(){return"TableUI"}init(){const t=this.editor,e=this.editor.t,i="ltr"===t.locale.contentLanguageDirection;t.ui.componentFactory.add("insertTable",i=>{const n=t.commands.get("insertTable"),o=nc(i);let r;return o.bind("isEnabled").to(n),o.buttonView.set({icon:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 6v3h4V6H3zm0 4v3h4v-3H3zm0 4v3h4v-3H3zm5 3h4v-3H8v3zm5 0h4v-3h-4v3zm4-4v-3h-4v3h4zm0-4V6h-4v3h4zm1.5 8a1.5 1.5 0 0 1-1.5 1.5H3A1.5 1.5 0 0 1 1.5 17V4c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13zM12 13v-3H8v3h4zm0-4V6H8v3h4z"/></svg>',label:e("Insert table"),tooltip:!0}),o.on("change:isOpen",()=>{r||(r=new Wv(i),o.panelView.children.add(r),r.delegate("execute").to(o),o.buttonView.on("open",()=>{r.rows=0,r.columns=0}),o.on("execute",()=>{t.execute("insertTable",{rows:r.rows,columns:r.columns}),t.editing.view.focus()}))}),o}),t.ui.componentFactory.add("tableColumn",t=>{const n=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:e("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:i?"insertTableColumnLeft":"insertTableColumnRight",label:e("Insert column left")}},{type:"button",model:{commandName:i?"insertTableColumnRight":"insertTableColumnLeft",label:e("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:e("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:e("Select column")}}];return this._prepareDropdown(e("Column"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',n,t)}),t.ui.componentFactory.add("tableRow",t=>{const i=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:e("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:e("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:e("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:e("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:e("Select row")}}];return this._prepareDropdown(e("Row"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',i,t)}),t.ui.componentFactory.add("mergeTableCells",t=>{const n=[{type:"button",model:{commandName:"mergeTableCellUp",label:e("Merge cell up")}},{type:"button",model:{commandName:i?"mergeTableCellRight":"mergeTableCellLeft",label:e("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:e("Merge cell down")}},{type:"button",model:{commandName:i?"mergeTableCellLeft":"mergeTableCellRight",label:e("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:e("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:e("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(e("Merge cells"),'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>',n,t)})}_prepareDropdown(t,e,i,n){const o=this.editor,r=nc(n),s=this._fillDropdownWithListOptions(r,i);return r.buttonView.set({label:t,icon:e,tooltip:!0}),r.bind("isEnabled").toMany(s,"isEnabled",(...t)=>t.some(t=>t)),this.listenTo(r,"execute",t=>{o.execute(t.source.commandName),o.editing.view.focus()}),r}_prepareMergeSplitButtonDropdown(t,e,i,n){const o=this.editor,r=nc(n,Hl),s=o.commands.get("mergeTableCells"),a=this._fillDropdownWithListOptions(r,i);return r.buttonView.set({label:t,icon:e,tooltip:!0,isEnabled:!0}),r.bind("isEnabled").toMany([s,...a],"isEnabled",(...t)=>t.some(t=>t)),this.listenTo(r.buttonView,"execute",()=>{o.execute("mergeTableCells"),o.editing.view.focus()}),this.listenTo(r,"execute",t=>{o.execute(t.source.commandName),o.editing.view.focus()}),r}_fillDropdownWithListOptions(t,e){const i=this.editor,n=[],o=new Ke;for(const r of e)Yv(r,i,n,o);return rc(t,o),n}}function Yv(t,e,i,n){const o=t.model=new pc(t.model),{commandName:r,bindIsOn:s}=t.model;if("button"===t.type||"switchbutton"===t.type){const t=e.commands.get(r);i.push(t),o.set({commandName:r}),o.bind("isEnabled").to(t),s&&o.bind("isOn").to(t,"value")}o.set({withText:!0}),n.add(t)}i(112);class Gv extends Mt{static get pluginName(){return"TableSelection"}static get requires(){return[xv]}init(){this.listenTo(this.editor.model,"deleteContent",(t,e)=>this._handleDeleteContent(t,e),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const t=Gm(this.editor.model.document.selection);return 0==t.length?null:t}getSelectionAsFragment(){const t=this.getSelectedTableCells();return t?this.editor.model.change(e=>{const i=e.createDocumentFragment(),n=this.editor.plugins.get("TableUtils"),{first:o,last:r}=Km(t),{first:s,last:a}=Xm(t),l=t[0].findAncestor("table");let c=a,h=r;if(Qm(t,n)){const t={firstColumn:o,lastColumn:r,firstRow:s,lastRow:a};c=gv(l,t),h=mv(l,t)}const d=sv(l,{startRow:s,startColumn:o,endRow:c,endColumn:h},e);return e.insert(d,i,0),i}):null}setCellSelection(t,e){const i=this._getCellsToSelect(t,e);this.editor.model.change(t=>{t.setSelection(i.cells.map(e=>t.createRangeOn(e)),{backward:i.backward})})}getFocusCell(){const t=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return t&&t.is("element","tableCell")?t:null}getAnchorCell(){const t=fr(this.editor.model.document.selection.getRanges()).getContainedElement();return t&&t.is("element","tableCell")?t:null}_defineSelectionConverter(){const t=this.editor,e=new Set;t.conversion.for("editingDowncast").add(t=>t.on("selection",(t,i,n)=>{const o=n.writer;!function(t){for(const i of e)t.removeClass("ck-editor__editable_selected",i);e.clear()}(o);const r=this.getSelectedTableCells();if(!r)return;for(const a of r){const t=n.mapper.toViewElement(a);o.addClass("ck-editor__editable_selected",t),e.add(t)}const s=n.mapper.toViewElement(r[r.length-1]);o.setSelection(s,0)},{priority:"lowest"}))}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const e=this.getSelectedTableCells();if(!e)return;t.model.change(i=>{const n=i.createPositionAt(e[0],0),o=t.model.schema.getNearestSelectionRange(n);i.setSelection(o)})}})}_handleDeleteContent(t,e){const[i,n]=e,o=this.editor.model,r=!n||"backward"==n.direction,s=Gm(i);s.length&&(t.stop(),o.change(t=>{const e=s[r?s.length-1:0];o.change(t=>{for(const e of s)o.deleteContent(t.createSelection(e,"in"))});const n=o.schema.getNearestSelectionRange(t.createPositionAt(e,0));i.is("documentSelection")?t.setSelection(n):i.setTo(n)}))}_getCellsToSelect(t,e){const i=this.editor.plugins.get("TableUtils"),n=i.getCellLocation(t),o=i.getCellLocation(e),r=Math.min(n.row,o.row),s=Math.max(n.row,o.row),a=Math.min(n.column,o.column),l=Math.max(n.column,o.column),c=new Array(s-r+1).fill(null).map(()=>[]),h={startRow:r,endRow:s,startColumn:a,endColumn:l};for(const{row:f,cell:p}of new Nm(t.findAncestor("table"),h))c[f-r].push(p);const d=o.row<n.row,u=o.column<n.column;return d&&c.reverse(),u&&c.forEach(t=>t.reverse()),{cells:c.flat(),backward:d||u}}}class Zv extends Mt{static get pluginName(){return"TableClipboard"}static get requires(){return[Gv,xv]}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"copy",(t,e)=>this._onCopyCut(t,e)),this.listenTo(e,"cut",(t,e)=>this._onCopyCut(t,e)),this.listenTo(t.model,"insertContent",(t,e)=>this._onInsertContent(t,...e),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(t,e){const i=this.editor.plugins.get(Gv);if(!i.getSelectedTableCells())return;if("cut"==t.name&&this.editor.isReadOnly)return;e.preventDefault(),t.stop();const n=this.editor.editing.view.document,o=this.editor.data.toView(i.getSelectionAsFragment());n.fire("clipboardOutput",{dataTransfer:e.dataTransfer,content:o,method:t.name})}_onInsertContent(t,e,i){if(i&&!i.is("documentSelection"))return;const n=this.editor.model,o=this.editor.plugins.get(xv);let r=function(t,e){if(!t.is("documentFragment")&&!t.is("element"))return null;if(t.is("element","table"))return t;if(1==t.childCount&&t.getChild(0).is("element","table"))return t.getChild(0);const i=e.createRangeIn(t);for(const n of i.getItems())if(n.is("element","table")){const t=e.createRange(i.start,e.createPositionBefore(n));if(e.hasContent(t,{ignoreWhitespaces:!0}))return null;const o=e.createRange(e.createPositionAfter(n),i.end);return e.hasContent(o,{ignoreWhitespaces:!0})?null:n}return null}(e,n);if(!r)return;const s=$m(n.document.selection);s.length?(t.stop(),n.change(t=>{const e={width:o.getColumns(r),height:o.getRows(r)},i=function(t,e,i,n){const o=t[0].findAncestor("table"),r=Km(t),s=Xm(t),a={firstColumn:r.first,lastColumn:r.last,firstRow:s.first,lastRow:s.last},l=1===t.length;return l&&(a.lastRow+=e.height-1,a.lastColumn+=e.width-1,function(t,e,i,n){const o=n.getColumns(t),r=n.getRows(t);i>o&&n.insertColumns(t,{at:o,columns:i-o}),e>r&&n.insertRows(t,{at:r,rows:e-r})}(o,a.lastRow+1,a.lastColumn+1,n)),l||!Qm(t,n)?function(t,e,i){const{firstRow:n,lastRow:o,firstColumn:r,lastColumn:s}=e,a={first:n,last:o},l={first:r,last:s};Xv(t,r,a,i),Xv(t,s+1,a,i),$v(t,n,l,i),$v(t,o+1,l,i,n)}(o,a,i):(a.lastRow=gv(o,a),a.lastColumn=mv(o,a)),a}(s,e,t,o),n=i.lastColumn-i.firstColumn+1,a={startRow:0,startColumn:0,endRow:Math.min(i.lastRow-i.firstRow+1,e.height)-1,endColumn:Math.min(n,e.width)-1};r=sv(r,a,t);const l=s[0].findAncestor("table"),c=this._replaceSelectedCellsWithPasted(r,e,l,i,t);if(this.editor.plugins.get("TableSelection").isEnabled){const e=Jm(c.map(e=>t.createRangeOn(e)));t.setSelection(e)}else t.setSelection(c[0],0)})):pv(r,o)}_replaceSelectedCellsWithPasted(t,e,i,n,o){const{width:r,height:s}=e,a=function(t,e,i){const n=new Array(i).fill(null).map(()=>new Array(e).fill(null));for(const{column:o,row:r,cell:s}of new Nm(t))n[r][o]=s;return n}(t,r,s),l=[...new Nm(i,{startRow:n.firstRow,endRow:n.lastRow,startColumn:n.firstColumn,endColumn:n.lastColumn,includeAllSlots:!0})],c=[];let h;for(const p of l){const{row:t,column:e}=p;e===n.firstColumn&&(h=p.getPositionBefore());const i=a[(t-n.firstRow)%s][(e-n.firstColumn)%r],l=i?o.cloneElement(i):null,d=this._replaceTableSlotCell(p,l,h,o);d&&(dv(d,t,e,n.lastRow,n.lastColumn,o),c.push(d),h=o.createPositionAfter(d))}const d=parseInt(i.getAttribute("headingRows")||0),u=parseInt(i.getAttribute("headingColumns")||0),f=n.firstColumn<u&&u<=n.lastColumn;if(n.firstRow<d&&d<=n.lastRow){const t=$v(i,d,{first:n.firstColumn,last:n.lastColumn},o,n.firstRow);c.push(...t)}if(f){const t=Xv(i,u,{first:n.firstRow,last:n.lastRow},o);c.push(...t)}return c}_replaceTableSlotCell(t,e,i,n){const{cell:o,isAnchor:r}=t;return r&&n.remove(o),e?(n.insert(e,i),e):null}}function $v(t,e,i,n,o=0){if(!(e<1))return av(t,e,o).filter(({column:t,cellWidth:e})=>Kv(t,e,i)).map(({cell:t})=>lv(t,e,n))}function Xv(t,e,i,n){if(!(e<1))return cv(t,e).filter(({row:t,cellHeight:e})=>Kv(t,e,i)).map(({cell:t,column:i})=>hv(t,i,e,n))}function Kv(t,e,i){const n=t+e-1,{first:o,last:r}=i;return t>=o&&t<=r||t<o&&n>=o}class Qv extends Mt{static get pluginName(){return"TableKeyboard"}static get requires(){return[Gv]}init(){const t=this.editor.editing.view.document;this.editor.keystrokes.set("Tab",(...t)=>this._handleTabOnSelectedTable(...t),{priority:"low"}),this.editor.keystrokes.set("Tab",this._getTabHandler(!0),{priority:"low"}),this.editor.keystrokes.set("Shift+Tab",this._getTabHandler(!1),{priority:"low"}),this.listenTo(t,"arrowKey",(...t)=>this._onArrowKey(...t),{context:"table"})}_handleTabOnSelectedTable(t,e){const i=this.editor,n=i.model.document.selection.getSelectedElement();n&&n.is("element","table")&&(e(),i.model.change(t=>{t.setSelection(t.createRangeIn(n.getChild(0).getChild(0)))}))}_getTabHandler(t){const e=this.editor;return(i,n)=>{let o=Zm(e.model.document.selection)[0];if(o||(o=this.editor.plugins.get("TableSelection").getFocusCell()),!o)return;n();const r=o.parent,s=r.parent,a=s.getChildIndex(r),l=r.getChildIndex(o),c=0===l;if(!t&&c&&0===a)return void e.model.change(t=>{t.setSelection(t.createRangeOn(s))});const h=this.editor.plugins.get("TableUtils"),d=l===r.childCount-1,u=a===h.getRows(s)-1;if(t&&u&&d&&(e.execute("insertTableRowBelow"),a===h.getRows(s)-1))return void e.model.change(t=>{t.setSelection(t.createRangeOn(s))});let f;if(t&&d){const t=s.getChild(a+1);f=t.getChild(0)}else if(!t&&c){const t=s.getChild(a-1);f=t.getChild(t.childCount-1)}else f=r.getChild(l+(t?1:-1));e.model.change(t=>{t.setSelection(t.createRangeIn(f))})}}_onArrowKey(t,e){const i=Sn(e.keyCode,this.editor.locale.contentLanguageDirection);this._handleArrowKeys(i,e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),t.stop())}_handleArrowKeys(t,e){const i=this.editor.model,n=i.document.selection,o=["right","down"].includes(t),r=Gm(n);if(r.length){let i;return i=e?this.editor.plugins.get("TableSelection").getFocusCell():o?r[r.length-1]:r[0],this._navigateFromCellInDirection(i,t,e),!0}const s=n.focus.findAncestor("tableCell");if(!s)return!1;if(!n.isCollapsed)if(e){if(n.isBackward==o&&!n.containsEntireContent(s))return!1}else{const t=n.getSelectedElement();if(!t||!i.schema.isObject(t))return!1}return!!this._isSelectionAtCellEdge(n,s,o)&&(this._navigateFromCellInDirection(s,t,e),!0)}_isSelectionAtCellEdge(t,e,i){const n=this.editor.model,o=this.editor.model.schema,r=i?t.getLastPosition():t.getFirstPosition();if(!o.getLimitElement(r).is("element","tableCell"))return n.createPositionAt(e,i?"end":0).isTouching(r);const s=n.createSelection(r);return n.modifySelection(s,{direction:i?"forward":"backward"}),r.isEqual(s.focus)}_navigateFromCellInDirection(t,e,i=!1){const n=this.editor.model,o=t.findAncestor("table"),r=[...new Nm(o,{includeAllSlots:!0})],{row:s,column:a}=r[r.length-1],l=r.find(({cell:e})=>e==t);let{row:c,column:h}=l;switch(e){case"left":h--;break;case"up":c--;break;case"right":h+=l.cellWidth;break;case"down":c+=l.cellHeight}if(c<0||c>s||h<0&&c<=0||h>a&&c>=s)return void n.change(t=>{t.setSelection(t.createRangeOn(o))});h<0?(h=i?0:a,c--):h>a&&(h=i?a:0,c++);const d=r.find(t=>t.row==c&&t.column==h).cell,u=["right","down"].includes(e),f=this.editor.plugins.get("TableSelection");if(i&&f.isEnabled){const e=f.getAnchorCell()||t;f.setCellSelection(e,d)}else{const t=n.createPositionAt(d,u?0:"end");n.change(e=>{e.setSelection(t)})}}}class Jv extends Bo{constructor(t){super(t),this.domEventType=["mousemove","mouseleave"]}onDomEvent(t){this.fire(t.type,t)}}class ty extends Mt{static get pluginName(){return"TableMouse"}static get requires(){return[Gv]}init(){this.editor.editing.view.addObserver(Jv),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const t=this.editor;let e=!1;const i=t.plugins.get(Gv);this.listenTo(t.editing.view.document,"mousedown",(n,o)=>{if(!this.isEnabled||!i.isEnabled)return;if(!o.domEvent.shiftKey)return;const r=i.getAnchorCell()||Zm(t.model.document.selection)[0];if(!r)return;const s=this._getModelTableCellFromDomEvent(o);s&&ey(r,s)&&(e=!0,i.setCellSelection(r,s),o.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{e=!1}),this.listenTo(t.editing.view.document,"selectionChange",t=>{e&&t.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let e,i,n=!1,o=!1;const r=t.plugins.get(Gv);this.listenTo(t.editing.view.document,"mousedown",(t,i)=>{this.isEnabled&&r.isEnabled&&(i.domEvent.shiftKey||i.domEvent.ctrlKey||i.domEvent.altKey||(e=this._getModelTableCellFromDomEvent(i)))}),this.listenTo(t.editing.view.document,"mousemove",(t,s)=>{if(!s.domEvent.buttons)return;if(!e)return;const a=this._getModelTableCellFromDomEvent(s);a&&ey(e,a)&&(i=a,n||i==e||(n=!0)),n&&(o=!0,r.setCellSelection(e,i),s.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{n=!1,o=!1,e=null,i=null}),this.listenTo(t.editing.view.document,"selectionChange",t=>{o&&t.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(t){const e=this.editor.editing.view.createPositionAt(t.target,0);return this.editor.editing.mapper.toModelPosition(e).parent.findAncestor("tableCell",{includeSelf:!0})}}function ey(t,e){return t.parent.parent==e.parent.parent}function iy(t){const e=t.getSelectedElement();return e&&oy(e)?e:null}function ny(t){let e=t.getFirstPosition().parent;for(;e;){if(e.is("element")&&oy(e))return e;e=e.parent}return null}function oy(t){return!!t.getCustomProperty("table")&&Mh(t)}i(114);const ry={autoRefresh:!0};class sy{constructor(t,e=ry){if(!t)throw new a.a("token-missing-token-url",this);e.initValue&&this._validateTokenValue(e.initValue),this.set("value",e.initValue),this._refresh="function"==typeof t?t:()=>{return e=t,new Promise((t,i)=>{const n=new XMLHttpRequest;n.open("GET",e),n.addEventListener("load",()=>{const e=n.status,o=n.response;return e<200||e>299?i(new a.a("token-cannot-download-new-token",null)):t(o)}),n.addEventListener("error",()=>i(new Error("Network Error"))),n.addEventListener("abort",()=>i(new Error("Abort"))),n.send()});var e},this._options=Object.assign({},ry,e)}init(){return new Promise((t,e)=>{this.value?(this._options.autoRefresh&&this._registerRefreshTokenTimeout(),t(this)):this.refreshToken().then(t).catch(e)})}refreshToken(){return this._refresh().then(t=>{this._validateTokenValue(t),this.set("value",t),this._options.autoRefresh&&this._registerRefreshTokenTimeout()}).then(()=>this)}destroy(){clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(t){const e="string"==typeof t,i=!/^".*"$/.test(t),n=e&&3===t.split(".").length;if(!i||!n)throw new a.a("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(){const t=this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},t)}_getTokenRefreshTimeoutTime(){try{const[,t]=this.value.split("."),{exp:e}=JSON.parse(atob(t));return e?Math.floor((1e3*e-Date.now())/2):36e5}catch(t){return 36e5}}static create(t,e=ry){return new sy(t,e).init()}}Pt(sy,Et);var ay=sy;const ly=/^data:(\S*?);base64,/;class cy{constructor(t,e,i){if(!t)throw new a.a("fileuploader-missing-file",null);if(!e)throw new a.a("fileuploader-missing-token",null);if(!i)throw new a.a("fileuploader-missing-api-address",null);this.file=function(t){if("string"!=typeof t)return!1;const e=t.match(ly);return!(!e||!e.length)}(t)?function(t,e=512){try{const i=t.match(ly)[1],n=atob(t.replace(ly,"")),o=[];for(let t=0;t<n.length;t+=e){const i=n.slice(t,t+e),r=new Array(i.length);for(let t=0;t<i.length;t++)r[t]=i.charCodeAt(t);o.push(new Uint8Array(r))}return new Blob(o,{type:i})}catch(t){throw new a.a("fileuploader-decoding-image-data-error",null)}}(t):t,this._token=e,this._apiAddress=i}onProgress(t){return this.on("progress",(e,i)=>t(i)),this}onError(t){return this.once("error",(e,i)=>t(i)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const t=new XMLHttpRequest;t.open("POST",this._apiAddress),t.setRequestHeader("Authorization",this._token.value),t.responseType="json",this.xhr=t}_attachXHRListeners(){const t=this,e=this.xhr;function i(e){return()=>t.fire("error",e)}e.addEventListener("error",i("Network Error")),e.addEventListener("abort",i("Abort")),e.upload&&e.upload.addEventListener("progress",t=>{t.lengthComputable&&this.fire("progress",{total:t.total,uploaded:t.loaded})}),e.addEventListener("load",()=>{const t=e.status,i=e.response;if(t<200||t>299)return this.fire("error",i.message||i.error)})}_sendRequest(){const t=new FormData,e=this.xhr;return t.append("file",this.file),new Promise((i,n)=>{e.addEventListener("load",()=>{const t=e.status,o=e.response;return t<200||t>299?n(o.message?new a.a("fileuploader-uploading-data-failed",this,{message:o.message}):o.error):i(o)}),e.addEventListener("error",()=>n(new Error("Network Error"))),e.addEventListener("abort",()=>n(new Error("Abort"))),e.send(t)})}}Pt(cy,h);class hy{constructor(t,e){if(!t)throw new a.a("uploadgateway-missing-token",null);if(!e)throw new a.a("uploadgateway-missing-api-address",null);this._token=t,this._apiAddress=e}upload(t){return new cy(t,this._token,this._apiAddress)}}class dy extends oi{static get pluginName(){return"CloudServicesCore"}createToken(t,e){return new ay(t,e)}createUploadGateway(t,e){return new hy(t,e)}}class uy extends Nt{refresh(){const t=this.editor.model;this.isEnabled=t.schema.checkAttributeInSelection(t.document.selection,"mention")}execute(t){const e=this.editor.model,i=e.document.selection,n="string"==typeof t.mention?{id:t.mention}:t.mention,o=n.id,r=t.range||i.getFirstRange(),s=t.text||o,l=py({_text:s,id:o},n);if(1!=t.marker.length)throw new a.a("mentioncommand-incorrect-marker",this);if(o.charAt(0)!=t.marker)throw new a.a("mentioncommand-incorrect-id",this);e.change(t=>{const n=hi(i.getAttributes()),o=new Map(n.entries());o.set("mention",l),e.insertContent(t.createText(s,o),r),e.insertContent(t.createText(" ",n),r.start.getShiftedBy(s.length))})}}class fy extends Mt{static get pluginName(){return"MentionEditing"}init(){const t=this.editor,e=t.model,i=e.document;e.schema.extend("$text",{allowAttributes:"mention"}),t.conversion.for("upcast").elementToAttribute({view:{name:"span",key:"data-mention",classes:"mention"},model:{key:"mention",value:t=>gy(t)}}),t.conversion.for("downcast").attributeToElement({model:"mention",view:vy}),t.conversion.for("downcast").add(my),i.registerPostFixer(t=>function(t,e,i){const n=e.differ.getChanges();let o=!1;for(const r of n){const e=r.position;if("$text"==r.name){const i=e.textNode&&e.textNode.nextSibling;o=by(e.textNode,t)||o,o=by(i,t)||o,o=by(e.nodeBefore,t)||o,o=by(e.nodeAfter,t)||o}if("$text"!=r.name&&"insert"==r.type){const i=e.nodeAfter;for(const e of t.createRangeIn(i).getItems())o=by(e,t)||o}if("insert"==r.type&&i.isInline(r.name)){const i=e.nodeAfter&&e.nodeAfter.nextSibling;o=by(e.nodeBefore,t)||o,o=by(i,t)||o}}return o}(t,i,e.schema)),i.registerPostFixer(t=>function(t,e){const i=e.differ.getChanges();let n=!1;for(const o of i)if("attribute"===o.type&&"mention"!=o.attributeKey){const e=o.range.start.nodeBefore,i=o.range.end.nodeAfter;for(const r of[e,i])yy(r)&&r.getAttribute(o.attributeKey)!=o.attributeNewValue&&(t.setAttribute(o.attributeKey,o.attributeNewValue,r),n=!0)}return n}(t,i)),i.registerPostFixer(t=>function(t,e){const i=e.selection,n=i.focus;if(i.isCollapsed&&i.hasAttribute("mention")&&function(t){const e=t.isAtStart;return t.nodeBefore&&t.nodeBefore.is("$text")||e}(n))return t.removeSelectionAttribute("mention"),!0}(t,i)),t.commands.add("mention",new uy(t))}}function py(t,e){return Object.assign({uid:r()},t,e||{})}function gy(t,e){const i=t.getAttribute("data-mention"),n=t.getChild(0);if(n)return py({id:i,_text:n.data},e)}function my(t){t.on("attribute:mention",(t,e,i)=>{const n=e.attributeNewValue;if(!e.item.is("$textProxy")||!n)return;const o=e.range.start;(o.textNode||o.nodeAfter).data!=n._text&&i.consumable.consume(e.item,t.name)},{priority:"highest"})}function vy(t,{writer:e}){if(t)return e.createAttributeElement("span",{class:"mention","data-mention":t.id},{id:t.uid,priority:20})}function yy(t){return!(!t||!t.is("$text")&&!t.is("$textProxy")||!t.hasAttribute("mention"))&&t.data!=t.getAttribute("mention")._text}function by(t,e){return!!yy(t)&&(e.removeAttribute("mention",t),!0)}i(116);class wy extends tc{constructor(t){super(t),this.extendTemplate({attributes:{class:["ck-mentions"],tabindex:"-1"}})}selectFirst(){this.select(0)}selectNext(){const t=this.items.getIndex(this.selected);this.select(t+1)}selectPrevious(){const t=this.items.getIndex(this.selected);this.select(t-1)}select(t){let e=0;t>0&&t<this.items.length?e=t:t<0&&(e=this.items.length-1);const i=this.items.get(e);this.selected!==i&&(this.selected&&this.selected.removeHighlight(),i.highlight(),this.selected=i,this._isItemVisibleInScrolledArea(i)||(this.element.scrollTop=i.element.offsetTop))}executeSelected(){this.selected.fire("execute")}_isItemVisibleInScrolledArea(t){return new ar(this.element).contains(new ar(t.element))}}class ky extends hl{constructor(t,e){super(t),this.template=!1,this.domElement=e,this.domElement.classList.add("ck-button"),this.set("isOn",!1),this.on("change:isOn",(t,e,i)=>{i?(this.domElement.classList.add("ck-on"),this.domElement.classList.remove("ck-off")):(this.domElement.classList.add("ck-off"),this.domElement.classList.remove("ck-on"))}),this.listenTo(this.domElement,"click",()=>{this.fire("execute")})}render(){super.render(),this.element=this.domElement}}class _y extends ec{highlight(){this.children.first.isOn=!0}removeHighlight(){this.children.first.isOn=!1}}const xy=[_n.arrowup,_n.arrowdown,_n.esc],Cy=[_n.enter,_n.tab];class Ey extends Mt{static get pluginName(){return"MentionUI"}static get requires(){return[_c]}constructor(t){super(t),this._mentionsView=this._createMentionView(),this._mentionsConfigurations=new Map,this._requestFeedDebounced=Ko(this._requestFeed,100),t.config.define("mention",{feeds:[]})}init(){const t=this.editor,e=t.config.get("mention.commitKeys")||Cy,i=xy.concat(e);this._balloon=t.plugins.get(_c),t.editing.view.document.on("keydown",(t,n)=>{i.includes(n.keyCode)&&this._isUIVisible&&(n.preventDefault(),t.stop(),n.keyCode==_n.arrowdown&&this._mentionsView.selectNext(),n.keyCode==_n.arrowup&&this._mentionsView.selectPrevious(),e.includes(n.keyCode)&&this._mentionsView.executeSelected(),n.keyCode==_n.esc&&this._hideUIAndRemoveMarker())},{priority:"highest"}),sl({emitter:this._mentionsView,activator:()=>this._isUIVisible,contextElements:[this._balloon.view.element],callback:()=>this._hideUIAndRemoveMarker()});const n=t.config.get("mention.feeds");for(const o of n){const t=o.feed,e=o.marker;if(!Oy(e))throw new a.a("mentionconfig-incorrect-marker",null,{marker:e});const i=o.minimumCharacters||0,n="function"==typeof t?t.bind(this.editor):Ay(t),r={watcher:this._setupTextWatcherForFeed(e,i),marker:e,feedCallback:n,itemRenderer:o.itemRenderer};this._mentionsConfigurations.set(e,r)}this.listenTo(t,"change:isReadOnly",()=>{this._hideUIAndRemoveMarker()}),this.on("requestFeed:response",(t,e)=>this._handleFeedResponse(e)),this.on("requestFeed:error",()=>this._hideUIAndRemoveMarker())}destroy(){super.destroy(),this._mentionsView.destroy()}get _isUIVisible(){return this._balloon.visibleView===this._mentionsView}_createMentionView(){const t=this.editor.locale,e=new wy(t);return this._items=new Ke,e.items.bindTo(this._items).using(i=>{const{item:n,marker:o}=i,r=this.editor.config.get("mention.dropdownLimit")||10;if(e.items.length>=r)return;const s=new _y(t),a=this._renderItem(n,o);return a.delegate("execute").to(s),s.children.add(a),s.item=n,s.marker=o,s.on("execute",()=>{e.fire("execute",{item:n,marker:o})}),s}),e.on("execute",(t,e)=>{const i=this.editor,n=i.model,o=e.item,r=e.marker,s=i.model.markers.get("mention"),a=n.createPositionAt(n.document.selection.focus),l=n.createPositionAt(s.getStart()),c=n.createRange(l,a);this._hideUIAndRemoveMarker(),i.execute("mention",{mention:o,text:o.text,marker:r,range:c}),i.editing.view.focus()}),e}_getItemRenderer(t){const{itemRenderer:e}=this._mentionsConfigurations.get(t);return e}_requestFeed(t,e){this._lastRequested=e;const{feedCallback:i}=this._mentionsConfigurations.get(t),n=i(e);n instanceof Promise?n.then(i=>{this.fire(this._lastRequested==e?"requestFeed:response":"requestFeed:discarded",{feed:i,marker:t,feedText:e})}).catch(e=>{this.fire("requestFeed:error",{error:e}),Object(a.b)("mention-feed-callback-error",{marker:t})}):this.fire("requestFeed:response",{feed:n,marker:t,feedText:e})}_setupTextWatcherForFeed(t,e){const i=this.editor,n=new Ed(i.model,function(t,e){const i=Sy(t,e);return t=>i.test(t)}(t,e));n.on("matched",(e,n)=>{const o=i.model.document.selection.focus;if(function(t){const e=t.textNode&&t.textNode.hasAttribute("mention"),i=t.nodeBefore;return e||i&&i.is("$text")&&i.hasAttribute("mention")}(o))return void this._hideUIAndRemoveMarker();const r=function(t,e){const i=Sy(t,0);return e.match(i)[2]}(t,n.text),s=o.getShiftedBy(-(t.length+r.length)),a=o.getShiftedBy(-r.length),l=i.model.createRange(s,a);if(Iy(i)){const t=i.model.markers.get("mention");i.model.change(e=>{e.updateMarker(t,{range:l})})}else i.model.change(t=>{t.addMarker("mention",{range:l,usingOperation:!1,affectsData:!1})});this._requestFeedDebounced(t,r)}),n.on("unmatched",()=>{this._hideUIAndRemoveMarker()});const o=i.commands.get("mention");return n.bind("isEnabled").to(o),n}_handleFeedResponse(t){const{feed:e,marker:i}=t;if(!Iy(this.editor))return;this._items.clear();for(const o of e)this._items.add({item:"object"!=typeof o?{id:o,text:o}:o,marker:i});const n=this.editor.model.markers.get("mention");this._items.length?this._showOrUpdateUI(n):this._hideUIAndRemoveMarker()}_showOrUpdateUI(t){this._isUIVisible?this._balloon.updatePosition(this._getBalloonPanelPositionData(t,this._mentionsView.position)):this._balloon.add({view:this._mentionsView,position:this._getBalloonPanelPositionData(t,this._mentionsView.position),singleViewMode:!0}),this._mentionsView.position=this._balloon.view.position,this._mentionsView.selectFirst()}_hideUIAndRemoveMarker(){this._balloon.hasView(this._mentionsView)&&this._balloon.remove(this._mentionsView),Iy(this.editor)&&this.editor.model.change(t=>t.removeMarker("mention")),this._mentionsView.position=void 0}_renderItem(t,e){const i=this.editor;let n,o=t.id;const r=this._getItemRenderer(e);if(r){const e=r(t);"string"!=typeof e?n=new ky(i.locale,e):o=e}if(!n){const t=new Dl(i.locale);t.label=o,t.withText=!0,n=t}return n}_getBalloonPanelPositionData(t,e){const i=this.editor,n=i.editing,o=n.view.domConverter,r=n.mapper;return{target:()=>{let e=t.getRange();"$graveyard"==e.start.root.rootName&&(e=i.model.document.selection.getFirstRange());const n=r.toViewRange(e);return ar.getDomRangeRects(o.viewRangeToDom(n)).pop()},limiter:()=>{const t=this.editor.editing.view,e=t.document.selection.editableElement;return e?t.domConverter.mapViewToDom(e.root):null},positions:Ty(e)}}}function Ty(t){const e={caret_se:t=>({top:t.bottom+3,left:t.right,name:"caret_se",config:{withArrow:!1}}),caret_ne:(t,e)=>({top:t.top-e.height-3,left:t.right,name:"caret_ne",config:{withArrow:!1}}),caret_sw:(t,e)=>({top:t.bottom+3,left:t.right-e.width,name:"caret_sw",config:{withArrow:!1}}),caret_nw:(t,e)=>({top:t.top-e.height-3,left:t.right-e.width,name:"caret_nw",config:{withArrow:!1}})};return Object.prototype.hasOwnProperty.call(e,t)?[e[t]]:[e.caret_se,e.caret_sw,e.caret_ne,e.caret_nw]}function Sy(t,e){return new RegExp(`(?:^|[ ${bn?"\\p{Ps}\\p{Pi}\"'":"\\(\\[{\"'"}])([${t}])([\\S]${0==e?"*":`{${e},}`})$`,"u")}function Ay(t){return e=>t.filter(t=>("string"==typeof t?t:String(t.id)).toLowerCase().includes(e.toLowerCase()))}function Oy(t){return t&&1==t.length}function Iy(t){return t.model.markers.has("mention")}i(118);class Py extends ph{}Py.builtinPlugins=[class extends Mt{static get requires(){return[rd,xh,gd,cd,xd,Kd]}static get pluginName(){return"Essentials"}},class extends Mt{static get requires(){return[nu,ru]}static get pluginName(){return"Alignment"}},class extends Mt{static get requires(){return[vu,yu]}static get pluginName(){return"FontSize"}},class extends Mt{static get requires(){return[xu,Cu]}static get pluginName(){return"FontFamily"}},class extends Mt{static get requires(){return[Tu,Au]}static get pluginName(){return"FontColor"}},class extends Mt{static get requires(){return[Iu,Pu]}static get pluginName(){return"FontBackgroundColor"}},class extends Mt{static get requires(){return[Du]}static get pluginName(){return"CKFinderUploadAdapter"}init(){const t=this.editor.config.get("ckfinder.uploadUrl");t&&(this.editor.plugins.get(Du).createUploadAdapter=e=>new Lu(e,t,this.editor.t))}},class extends Mt{static get requires(){return[Sh]}static get pluginName(){return"Autoformat"}afterInit(){this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats()}_addListAutoformats(){const t=this.editor.commands;t.get("bulletedList")&&Bu(this.editor,this,/^[*-]\s$/,"bulletedList"),t.get("numberedList")&&Bu(this.editor,this,/^1[.|)]\s$/,"numberedList"),t.get("todoList")&&Bu(this.editor,this,/^\[\s?\]\s$/,"todoList"),t.get("checkTodoList")&&Bu(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const t=this.editor.commands;if(t.get("bold")){const t=Hu(this.editor,"bold");ju(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,t),ju(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,t)}if(t.get("italic")){const t=Hu(this.editor,"italic");ju(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,t),ju(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,t)}if(t.get("code")){const t=Hu(this.editor,"code");ju(this.editor,this,/(`)([^`]+)(`)$/g,t)}if(t.get("strikethrough")){const t=Hu(this.editor,"strikethrough");ju(this.editor,this,/(~~)([^~]+)(~~)$/g,t)}}_addHeadingAutoformats(){const t=this.editor.commands.get("heading");t&&t.modelElements.filter(t=>t.match(/^heading[1-6]$/)).forEach(e=>{const i=new RegExp(`^(#{${e[7]}})\\s$`);Bu(this.editor,this,i,()=>{if(!t.isEnabled||t.value===e)return!1;this.editor.execute("heading",{value:e})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&Bu(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const t=this.editor,e=t.model.document.selection;t.commands.get("codeBlock")&&Bu(t,this,/^```$/,()=>{if(e.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&Bu(this.editor,this,/^---$/,"horizontalLine")}},class extends Mt{static get requires(){return[qu,Uu]}static get pluginName(){return"Bold"}},class extends Mt{static get requires(){return[Yu,Gu]}static get pluginName(){return"Italic"}},class extends Mt{static get requires(){return[Zu,$u]}static get pluginName(){return"Strikethrough"}},class extends Mt{static get requires(){return[Xu,Ku]}static get pluginName(){return"Underline"}},class extends Mt{static get requires(){return[nf,of]}static get pluginName(){return"BlockQuote"}},class extends Mt{static get requires(){return[rf,"ImageUpload"]}init(){const t=this.editor;t.plugins.has("ImageBlockEditing")||t.plugins.has("ImageInlineEditing")||Object(a.b)("easy-image-image-feature-missing",t)}static get pluginName(){return"EasyImage"}},class extends oi{static get pluginName(){return"CloudServices"}static get requires(){return[dy]}init(){const t=this.context.config.get("cloudServices")||{};for(const e in t)this[e]=t[e];if(this._tokens=new Map,this.tokenUrl)return this.token=this.context.plugins.get("CloudServicesCore").createToken(this.tokenUrl),this._tokens.set(this.tokenUrl,this.token),this.token.init();this.token=null}registerTokenUrl(t){if(this._tokens.has(t))return Promise.resolve(this.getTokenFor(t));const e=this.context.plugins.get("CloudServicesCore").createToken(t);return this._tokens.set(t,e),e.init()}getTokenFor(t){const e=this._tokens.get(t);if(!e)throw new a.a("cloudservices-token-not-registered",this);return e}destroy(){super.destroy();for(const t of this._tokens.values())t.destroy()}},class extends Mt{static get requires(){return[ff,pf]}static get pluginName(){return"Heading"}},class extends Mt{static get requires(){return[jf,Hf]}static get pluginName(){return"Image"}},class extends Mt{static get requires(){return[Yf,Zf]}static get pluginName(){return"ImageCaption"}},class extends Mt{static get requires(){return[Xf,ep,Qf]}static get pluginName(){return"ImageResize"}},class extends Mt{static get requires(){return[mp,vp]}static get pluginName(){return"ImageStyle"}},class extends Mt{static get requires(){return[gf,Tf]}static get pluginName(){return"ImageToolbar"}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(gf),n=t.plugins.get("ImageUtils");var o;i.register("image",{ariaLabel:e("Image toolbar"),items:(o=t.config.get("image.toolbar")||[],o.map(t=>y(t)?t.name:t)),getRelatedElement:t=>n.getClosestSelectedImageWidget(t)})}},class extends Mt{static get pluginName(){return"ImageUpload"}static get requires(){return[Mp,Cp,Ep]}},class extends Mt{static get pluginName(){return"Indent"}static get requires(){return[Np,Fp]}},class extends Mt{constructor(t){super(t),t.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}init(){const t=this.editor,e=t.config.get("indentBlock"),i=!e.classes||!e.classes.length,n=Object.assign({direction:"forward"},e),o=Object.assign({direction:"backward"},e);i?(t.data.addStyleProcessorRules(dh),this._setupConversionUsingOffset(t.conversion),t.commands.add("indentBlock",new Lp(t,new Bp(n))),t.commands.add("outdentBlock",new Lp(t,new Bp(o)))):(this._setupConversionUsingClasses(e.classes),t.commands.add("indentBlock",new Lp(t,new jp(n))),t.commands.add("outdentBlock",new Lp(t,new jp(o))))}afterInit(){const t=this.editor,e=t.model.schema,i=t.commands.get("indent"),n=t.commands.get("outdent"),o=t.config.get("heading.options");(o&&o.map(t=>t.model)||Vp).forEach(t=>{e.isRegistered(t)&&e.extend(t,{allowAttributes:"blockIndent"})}),e.setAttributeProperties("blockIndent",{isFormatting:!0}),i.registerChildCommand(t.commands.get("indentBlock")),n.registerChildCommand(t.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const t=this.editor.conversion,e="rtl"===this.editor.locale.contentLanguageDirection?"margin-right":"margin-left";t.for("upcast").attributeToAttribute({view:{styles:{[e]:/[\s\S]+/}},model:{key:"blockIndent",value:t=>t.getStyle(e)}}),t.for("downcast").attributeToAttribute({model:"blockIndent",view:t=>({key:"style",value:{[e]:t}})})}_setupConversionUsingClasses(t){const e={model:{key:"blockIndent",values:[]},view:{}};for(const i of t)e.model.values.push(i),e.view[i]={key:"class",value:[i]};this.editor.conversion.attributeToAttribute(e)}},class extends Mt{static get requires(){return[fg,bg,_g]}static get pluginName(){return"Link"}},class extends Mt{static get requires(){return[Zg,Qg]}static get pluginName(){return"List"}},class extends Mt{static get requires(){return[tm,sm]}static get pluginName(){return"ListStyle"}},class extends Mt{static get requires(){return[gm,bm,vm,Xh]}static get pluginName(){return"MediaEmbed"}},hf,class extends Mt{static get pluginName(){return"PasteFromOffice"}static get requires(){return[yh]}init(){const t=this.editor,e=t.editing.view.document,i=[];i.push(new Sm(e)),i.push(new Cm(e)),t.plugins.get("ClipboardPipeline").on("inputTransformation",(t,n)=>{if(n._isTransformedWithPasteFromOffice)return;const o=n.dataTransfer.getData("text/html"),r=i.find(t=>t.isActive(o));r&&(n._parsedData=function(t,e){const i=new DOMParser,n=function(t){return Am(Am(t)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/ <\//g,"\xa0</").replace(/ <o:p><\/o:p>/g,"\xa0<o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}(function(t){const e=t.indexOf("</body>");if(e<0)return t;const i=t.indexOf("</html>",e+"</body>".length);return t.substring(0,e+"</body>".length)+(i>=0?t.substring(i):"")}(t=t.replace(/<!--\[if gte vml 1]>/g,""))),o=i.parseFromString(n,"text/html");!function(t){t.querySelectorAll("span[style*=spacerun]").forEach(t=>{const e=t.innerText.length||0;t.innerHTML=Array(e+1).join("\xa0 ").substr(0,e)})}(o);const r=o.body.innerHTML,s=function(t,e){const i=new an(e),n=new mo(i,{renderingMode:"data"}),o=t.createDocumentFragment(),r=t.body.childNodes;for(;r.length>0;)o.appendChild(r[0]);return n.domToView(o,{skipComments:!0})}(o,e),a=function(t){const e=[],i=[],n=Array.from(t.getElementsByTagName("style"));for(const o of n)o.sheet&&o.sheet.cssRules&&o.sheet.cssRules.length&&(e.push(o.sheet),i.push(o.innerHTML));return{styles:e,stylesString:i.join(" ")}}(o);return{body:s,bodyString:r,styles:a.styles,stylesString:a.stylesString}}(o,e.stylesProcessor),r.execute(n),n._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}},class extends Mt{static get requires(){return[Vv,Uv,Gv,ty,Qv,Zv,Xh]}static get pluginName(){return"Table"}},class extends Mt{static get requires(){return[gf]}static get pluginName(){return"TableToolbar"}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(gf),n=t.config.get("table.contentToolbar"),o=t.config.get("table.tableToolbar");n&&i.register("tableContent",{ariaLabel:e("Table toolbar"),items:n,getRelatedElement:ny}),o&&i.register("table",{ariaLabel:e("Table toolbar"),items:o,getRelatedElement:iy})}},class extends Mt{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(t){super(t),t.config.define("typing",{transformations:{include:Rd}})}init(){const t=this.editor.model.document.selection;t.on("change:range",()=>{this.isEnabled=!t.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const t=this.editor,e=t.model,i=t.plugins.get("Input"),n=t.plugins.get("Delete"),o=function(t){const e=t.remove||[],i=t=>!e.includes(t);return function(t){const e=new Set;for(const i of t)if(Nd[i])for(const t of Nd[i])e.add(t);else e.add(i);return Array.from(e)}(t.include.concat(t.extra||[]).filter(i)).filter(i).map(t=>Dd[t]||t).map(t=>({from:zd(t.from),to:Fd(t.to)}))}(t.config.get("typing.transformations")),r=new Ed(t.model,t=>{for(const e of o)if(e.from.test(t))return{normalizedTransformation:e}});r.on("matched:data",(t,o)=>{if(!i.isInput(o.batch))return;const{from:r,to:s}=o.normalizedTransformation,a=r.exec(o.text),l=s(a.slice(1)),c=o.range;let h=a.index;e.enqueueChange(t=>{for(let i=1;i<a.length;i++){const n=a[i],o=l[i-1];if(null==o){h+=n.length;continue}const r=c.start.getShiftedBy(h),s=e.createRange(r,r.getShiftedBy(n.length)),d=Ld(r);e.insertContent(t.createText(o,d),s),h+=o.length}e.enqueueChange(()=>{n.requestUndoOnBackspace()})})}),r.bind("isEnabled").to(this)}},class extends Mt{static get requires(){return[Du]}static get pluginName(){return"Base64UploadAdapter"}init(){this.editor.plugins.get(Du).createUploadAdapter=t=>new Fu(t)}},class extends Mt{toMentionAttribute(t,e){return gy(t,e)}static get pluginName(){return"Mention"}static get requires(){return[fy,Ey]}}],Py.defaultConfig={toolbar:{items:["heading","|","fontfamily","fontsize","fontColor","fontBackgroundColor","|","bold","italic","underline","strikethrough","|","alignment","|","numberedList","bulletedList","|","outdent","indent","|","link","blockquote","uploadImage","insertTable","mediaEmbed","|","undo","redo"]},image:{resizeUnit:"px",toolbar:["imageStyle:inline","imageStyle:wrapText","imageStyle:breakText","|","toggleImageCaption","imageTextAlternative"]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"]},language:"en"}}]).default}}]);