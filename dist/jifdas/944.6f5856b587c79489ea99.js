(self.webpackChunkjifdas=self.webpackChunkjifdas||[]).push([[944],{7463:()=>{var t,e;t=window,e=document,L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e);var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire(L.Draw.Event.CREATED,{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(t,e){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=e.getLatLngs(),n=i.splice(-1,1)[0];this._poly.setLatLngs(i),this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(n,!1)}},addVertex:function(t){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(t,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var t=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),e=this._poly.newLatLngIntersects(t[t.length-1]);!this.options.allowIntersection&&e||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),i=this._map.layerPointToLatLng(e);this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent;this._startPoint.call(this,e.clientX,e.clientY)}},_startPoint:function(t,e){this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){var e=t.originalEvent;this._endPoint.call(this,e.clientX,e.clientY,t),this._clickHandled=null},_endPoint:function(e,i,n){if(this._mouseDownOrigin){var o=L.point(e,i).distanceTo(this._mouseDownOrigin),a=this._calculateFinishDistance(n.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(n.latlng),this._finishShape()):a<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(t.devicePixelRatio||1)&&this.addVertex(n.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,i,n=t.originalEvent;!n.touches||!n.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=n.touches[0].clientX,i=n.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,i),this._endPoint.call(this,e,i,t),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var i;if(this.type===L.Draw.Polyline.TYPE)i=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;i=this._markers[0]}var n=this._map.latLngToContainerPoint(i.getLatLng()),o=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),a=this._map.latLngToContainerPoint(o.getLatLng());e=n.distanceTo(a)}else e=1/0;return e},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers?this._markers.length:0;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,n,o,a=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),r=this.options.maxGuideLineLength,s=a>r?a-r:this.options.guidelineDistance;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));s<a;s+=this.options.guidelineDistance)i=s/a,n={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},(o=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(o,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=this.options.showLength?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,n,o=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=o-(e?2:1),n=L.GeometryUtil.isVersion07x()?t.distanceTo(this._markers[i].getLatLng())*(this.options.factor||1):this._map.distance(t,this._markers[i].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=n*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=L.GeometryUtil.isVersion07x()?i&&e&&e.distanceTo?this._measurementRunningTotal+e.distanceTo(i)*(this.options.factor||1):this._measurementRunningTotal||0:i&&e?this._measurementRunningTotal+this._map.distance(e,i)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(t,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(t=L.drawLocal.draw.handlers.polygon.tooltip.cont,e=this._getMeasurementString()):(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area,e="";return t||this.options.showLength?(this.options.showLength&&(e=L.Draw.Polyline.prototype._getMeasurementString.call(this)),t&&(e+="<br>"+L.GeometryUtil.readableArea(t,this.options.metric,this.options.precision)),e):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(t,e){var i;!this.options.allowIntersection&&this.options.showArea&&(i=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(i)),L.Draw.Polyline.prototype._vertexChanged.call(this,t,e)},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(t){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function(t,e){for(;(t=t.parentElement)&&!t.classList.contains("leaflet-pane"););return t}(t.target)||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_getTooltipText:function(){var t,e,i,n=L.Draw.SimpleShape.prototype._getTooltipText.call(this),o=this.options.showArea;return this._shape&&(t=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),e=L.GeometryUtil.geodesicArea(t),i=o?L.GeometryUtil.readableArea(e,this.options.metric):""),{text:n.text,subtext:i}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=this._createMarker(e),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(t){return new L.Marker(t,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(t){this._onMouseMove(t),this._onClick()},_fireCreatedEvent:function(){var t=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,t,e)},_fireCreatedEvent:function(){var t=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)},_createMarker:function(t){return new L.CircleMarker(t,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){if(L.GeometryUtil.isVersion07x())var e=this._startLatLng.distanceTo(t);else e=this._map.distance(this._startLatLng,t);this._shape?this._shape.setRadius(e):(this._shape=new L.Circle(this._startLatLng,e,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,n=this.options.showRadius,o=this.options.metric;if(this._tooltip.updatePosition(i),this._isDrawing){this._drawShape(i),e=this._shape.getRadius().toFixed(1);var a="";n&&(a=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(e,o,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:a})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(t,e){this._marker=t,L.setOptions(this,e)},addHooks:function(){var t=this._marker;t.dragging.enable(),t.on("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},removeHooks:function(){var t=this._marker;t.dragging.disable(),t.off("dragend",this._onDragEnd,t),this._toggleMarkerHighlight()},_onDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_toggleMarkerHighlight:function(){var t=this._marker._icon;t&&(t.style.display="none",L.DomUtil.hasClass(t,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,-4)):(L.DomUtil.addClass(t,"leaflet-edit-marker-selected"),this._offsetMarker(t,4)),t.style.display="")},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,n=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=n+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(t){this.latlngs=[t._latlngs],t._holes&&(this.latlngs=this.latlngs.concat(t._holes)),this._poly=t,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(t){for(var e=0;e<this._verticesHandlers.length;e++)t(this._verticesHandlers[e])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(t){t.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(t){t.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(t){t.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var t=0;t<this.latlngs.length;t++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[t],this._poly.options.poly))},_updateLatLngs:function(t){this.latlngs=[t.layer._latlngs],t.layer._holes&&(this.latlngs=this.latlngs.concat(t.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(t,e,i){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=t,i&&i.drawError&&(i.drawError=L.Util.extend({},this.options.drawError,i.drawError)),this._latlngs=e,L.setOptions(this,i)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var t=this._poly,e=t._path;t instanceof L.Polygon||(t.options.fill=!1,t.options.editing&&(t.options.editing.fill=!1)),e&&t.options.editing&&t.options.editing.className&&(t.options.original.className&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var t=this._poly,e=t._path;e&&t.options.editing&&t.options.editing.className&&(t.options.editing.className.split(" ").forEach(function(t){L.DomUtil.removeClass(e,t)}),t.options.original.className&&t.options.original.className.split(" ").forEach(function(t){L.DomUtil.addClass(e,t)})),t.setStyle(t.options.original),t._map&&(t._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,n,o,a,r=this._defaultShape();for(t=0,i=r.length;t<i;t++)(n=this._createMarker(r[t],t)).on("click",this._onMarkerClick,this),n.on("contextmenu",this._onContextMenu,this),this._markers.push(n);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(this._createMiddleMarker(o=this._markers[e],a=this._markers[t]),this._updatePrevNext(o,a))},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(i),i},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var t=this._defaultShape(),e=[].splice.apply(t,arguments);return this._poly._convertLatLngs(t,!0),this._poly.redraw(),e},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(t){var e=t.target,i=this._poly,n=L.LatLngUtil.cloneLatLng(e._origLatLng);if(L.extend(e._origLatLng,e._latlng),i.options.poly){var o=i._map._editTooltip;if(!i.options.poly.allowIntersection&&i.intersects()){L.extend(e._origLatLng,n),e.setLatLng(n);var a=i.options.color;i.setStyle({color:this.options.drawError.color}),o&&o.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){i.setStyle({color:a}),o&&o.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var r=this._poly.getLatLngs();this._poly._convertLatLngs(r,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._defaultShape().length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(t){this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t.target,layers:this._markerGroup,poly:this._poly}),L},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e),n=t.target;L.extend(n._origLatLng,i),n._middleLeft&&n._middleLeft.setLatLng(this._getMiddleLatLng(n._prev,n)),n._middleRight&&n._middleRight.setLatLng(this._getMiddleLatLng(n,n._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,n,o,a=this._getMiddleLatLng(t,e),r=this._createMarker(a);r.setOpacity(.6),t._middleRight=e._middleLeft=r,n=function(){r.off("touchmove",n,this);var o=e._index;r._index=o,r.off("click",i,this).on("click",this._onMarkerClick,this),a.lat=r.getLatLng().lat,a.lng=r.getLatLng().lng,this._spliceLatLngs(o,0,a),this._markers.splice(o,0,r),r.setOpacity(1),this._updateIndexes(o,1),e._index++,this._updatePrevNext(t,r),this._updatePrevNext(r,e),this._poly.fire("editstart")},o=function(){r.off("dragstart",n,this),r.off("dragend",o,this),r.off("touchmove",n,this),this._createMiddleMarker(t,r),this._createMiddleMarker(r,e)},r.on("click",i=function(){n.call(this),o.call(this),this._fireEdit()},this).on("dragstart",n,this).on("dragend",o,this).on("touchmove",n,this),this._markerGroup.addLayer(r)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,n=i.project(t.getLatLng()),o=i.project(e.getLatLng());return i.unproject(n._add(o)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(t,e){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){var t=this._shape;this._shape._map&&(this._map=this._shape._map,t.setStyle(t.options.editing),t._map&&(this._map=t._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var t=this._shape;if(t.setStyle(t.options.original),t._map){this._unbindMarker(this._moveMarker);for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._unbindMarker(this._resizeMarkers[e]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker.Touch(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(t){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t),"function"==typeof this._getCorners){var e=this._getCorners(),i=t.target,n=i._cornerIndex;i.setOpacity(0),this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)}this._shape.fire("editstart")},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.touches[0]),i=this._map.layerPointToLatLng(e);return t.target===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw(),!1},_onTouchEnd:function(t){t.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target._cornerIndex;this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)},_onMarkerDragEnd:function(t){var e,i=t.target;i===this._moveMarker&&(e=this._shape.getBounds().getCenter(),i.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),n=this._shape.getBounds().getCenter(),o=[],a=0,r=i.length;a<r;a++)o.push([t.lat+(e=[i[a].lat-n.lat,i[a].lng-n.lng])[0],t.lng+e[1]]);this._shape.setLatLngs(o),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(t){if(this._resizeMarkers.length){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e)}this._shape.setLatLng(t),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_resize:function(t){var e=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=e.distanceTo(t):radius=this._map.distance(e,t),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(t,e){var i={};if(void 0!==t.touches){if(!t.touches.length)return;i=t.touches[0]}else{if("touch"!==t.pointerType)return;if(i=t,!this._filterClick(t))return}var n=this._map.mouseEventToContainerPoint(i),o=this._map.mouseEventToLayerPoint(i),a=this._map.layerPointToLatLng(o);this._map.fire(e,{latlng:a,layerPoint:o,containerPoint:n,pageX:i.pageX,pageY:i.pageY,originalEvent:t})},_filterClick:function(t){var e=t.timeStamp||t.originalEvent.timeStamp,i=L.DomEvent._lastClick&&e-L.DomEvent._lastClick;return i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?(L.DomEvent.stop(t),!1):(L.DomEvent._lastClick=e,!0)},_onTouchStart:function(t){this._map._loaded&&this._touchEvent(t,"touchstart")},_onTouchEnd:function(t){this._map._loaded&&this._touchEvent(t,"touchend")},_onTouchCancel:function(t){if(this._map._loaded){var e="touchcancel";this._detectIE()&&(e="pointercancel"),this._touchEvent(t,e)}},_onTouchLeave:function(t){this._map._loaded&&this._touchEvent(t,"touchleave")},_onTouchMove:function(t){this._map._loaded&&this._touchEvent(t,"touchmove")},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var o=e.indexOf("Edge/");return o>0&&parseInt(e.substring(o+5,e.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];e.concat(this._detectIE?["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]:["touchcancel"]),L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this),L.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var e=t.navigator.userAgent,i=e.indexOf("MSIE ");if(i>0)return parseInt(e.substring(i+5,e.indexOf(".",i)),10);if(e.indexOf("Trident/")>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var o=e.indexOf("Edge/");return o>0&&parseInt(e.substring(o+5,e.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,n=t.length;i<n;i++)Array.isArray(t[i])?e.push(L.LatLngUtil.cloneLatLngs(t[i])):e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},function(){var t={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,n=t.length,o=0,a=Math.PI/180;if(n>2){for(var r=0;r<n;r++)o+=((i=t[(r+1)%n]).lng-(e=t[r]).lng)*a*(2+Math.sin(e.lat*a)+Math.sin(i.lat*a));o=6378137*o*6378137/2}return Math.abs(o)},formattedNumber:function(t,e){var i=parseFloat(t).toFixed(e),n=L.drawLocal.format&&L.drawLocal.format.numeric,o=n&&n.delimiters,a=o&&o.thousands,r=o&&o.decimal;if(a||r){var s=i.split(".");i=a?s[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+a):s[0],r=r||".",s.length>1&&(i=i+r+s[1])}return i},readableArea:function(e,i,n){var o,a;return n=L.Util.extend({},t,n),i?(a=["ha","m"],type=typeof i,"string"===type?a=[i]:"boolean"!==type&&(a=i),o=e>=1e6&&-1!==a.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*e,n.km)+" km\xb2":e>=1e4&&-1!==a.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*e,n.ha)+" ha":L.GeometryUtil.formattedNumber(e,n.m)+" m\xb2"):o=(e/=.836127)>=3097600?L.GeometryUtil.formattedNumber(e/3097600,n.mi)+" mi\xb2":e>=4840?L.GeometryUtil.formattedNumber(e/4840,n.ac)+" acres":L.GeometryUtil.formattedNumber(e,n.yd)+" yd\xb2",o},readableDistance:function(e,i,n,o,a){var r;switch(a=L.Util.extend({},t,a),i?"string"==typeof i?i:"metric":n?"feet":o?"nauticalMile":"yards"){case"metric":r=e>1e3?L.GeometryUtil.formattedNumber(e/1e3,a.km)+" km":L.GeometryUtil.formattedNumber(e,a.m)+" m";break;case"feet":e*=3.28083,r=L.GeometryUtil.formattedNumber(e,a.ft)+" ft";break;case"nauticalMile":e*=.53996,r=L.GeometryUtil.formattedNumber(e/1e3,a.nm)+" nm";break;case"yards":default:r=(e*=1.09361)>1760?L.GeometryUtil.formattedNumber(e/1760,a.mi)+" miles":L.GeometryUtil.formattedNumber(e,a.yd)+" yd"}return r},isVersion07x:function(){var t=L.version.split(".");return 0===parseInt(t[0],10)&&7===parseInt(t[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,n){return this._checkCounterclockwise(t,i,n)!==this._checkCounterclockwise(e,i,n)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,n)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e=this._getProjectedPoints(),i=e?e.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=i-1;t>=3;t--)if(this._lineSegmentsIntersectsRange(e[t-1],e[t],t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._getProjectedPoints(),n=i?i.length:0,o=i?i[n-1]:null,a=n-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(o,t,a,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._getProjectedPoints(),i=e?e.length:0;return!e||(i+=t||0)<=3},_lineSegmentsIntersectsRange:function(t,e,i,n){var o=this._getProjectedPoints();n=n||0;for(var a=i;a>n;a--)if(L.LineUtil.segmentsIntersect(t,e,o[a-1],o[a]))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var t=[],e=this._defaultShape(),i=0;i<e.length;i++)t.push(this._map.latLngToLayerPoint(e[i]));return t}}),L.Polygon.include({intersects:function(){var t,e=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||this._lineSegmentsIntersectsRange(e[(t=e.length)-1],e[0],t-2,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(e=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=e,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(e=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=e,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),n=!1;for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&(e=this._toolbars[o].addToolbar(t))&&(n||(L.DomUtil.hasClass(e,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(e.childNodes[0],"leaflet-draw-toolbar-top"),n=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=t.target;for(var i in this._toolbars)this._toolbars[i]!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null;var e=L.version.split(".");1===parseInt(e[0],10)&&parseInt(e[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),n=0,o=this._toolbarClass||"",a=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<a.length;e++)a[e].enabled&&this._initModeHandler(a[e].handler,this._toolbarContainer,n++,o,a[e].title);if(n)return this._lastButtonIndex=--n,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,n,o){var a=t.type;this._modes[a]={},this._modes[a].handler=t,this._modes[a].button=this._createButton({type:a,title:o,className:n+"-"+a,container:e,callback:this._modes[a].handler.enable,context:this._modes[a].handler}),this._modes[a].buttonIndex=i,this._modes[a].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!t.MSStream},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container),i=L.DomUtil.create("span","sr-only",t.container);e.href="#",e.appendChild(i),t.title&&(e.title=t.title,i.innerHTML=t.title),t.text&&(e.innerHTML=t.text,i.innerHTML=t.text);var n=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"touchstart",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,n,t.callback,t.context),e},_disposeButton:function(t,e){var i=this._detectIOS()?"touchstart":"click";L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"touchstart",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,i,e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,n,o,a=this._actionsContainer,r=this.getActions(t),s=r.length;for(i=0,n=this._actionButtons.length;i<n;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];a.firstChild;)a.removeChild(a.firstChild);for(var l=0;l<s;l++)"enabled"in r[l]&&!r[l].enabled||(e=L.DomUtil.create("li","",a),o=this._createButton({title:r[l].title,text:r[l].text,container:e,callback:r[l].callback,context:r[l].context}),this._actionButtons.push({button:o,callback:r[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._visible=!1,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",t.text||t.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(this._visible&&(i.style.visibility="inherit"),L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(t,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(t){return[{enabled:t.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:t.completeShape,context:t},{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,t.edit.selectedPathOptions)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),t.poly&&(t.poly=L.extend({},this.options.poly,t.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(t){var e=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return t.removeAllLayers&&e.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),e},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.setOptions(this,e),this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),t._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:(t instanceof L.Marker||t instanceof L.CircleMarker)&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):(t instanceof L.Marker||t instanceof L.CircleMarker)&&t.setLatLng(this._uneditedLayerProps[e].latlng),t.fire("revert-edited",{layer:t}))},_enableLayerEdit:function(t){var e,i,n=t.layer||t.target||t;this._backupLayer(n),this.options.poly&&(i=L.Util.extend({},this.options.poly),n.options.poly=i),this.options.selectedPathOptions&&((e=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(e.color=n.options.color,e.fillColor=n.options.fillColor),n.options.original=L.extend({},n.options),n.options.editing=e),n instanceof L.Marker?(n.editing&&n.editing.enable(),n.dragging.enable(),n.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):n.editing.enable()},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,e.editing&&e.editing.disable(),delete e.options.editing,delete e.options.original,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):e.editing.disable()},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:e})},_onTouchMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent.changedTouches[0]),i=this._map.layerPointToLatLng(e);t.target.setLatLng(i)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var i=L.version.split(".");1===parseInt(i[0],10)&&parseInt(i[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t),t.fire("revert-deleted",{layer:t})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(t){this._removeLayer({layer:t})},this),this.save()},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e),e.fire("deleted")},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})},2512:(t,e,i)=>{"use strict";i.d(e,{M:()=>c});var n=i(3219),o=i(5366),a=i(1116);function r(t,e){if(1&t&&(o.TgZ(0,"tr"),o.TgZ(1,"td",7),o._uU(2),o.qZA(),o.TgZ(3,"td"),o._uU(4),o.qZA(),o.qZA()),2&t){const t=e.$implicit;o.xp6(2),o.Oqu(t.Field),o.xp6(2),o.Oqu(t.FieldValue)}}function s(t,e){1&t&&(o.TgZ(0,"tr"),o.TgZ(1,"td",21),o._UZ(2,"i",22),o.TgZ(3,"span",7),o._uU(4,"No metadata has been added for this incident"),o.qZA(),o.qZA(),o.qZA())}function l(t,e){if(1&t&&(o.TgZ(0,"div",23),o.TgZ(1,"div",24),o._UZ(2,"img",25),o.TgZ(3,"div",26),o.TgZ(4,"a",27),o._UZ(5,"i",28),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t){const t=e.$implicit;o.xp6(2),o.MGl("src","data:image/png;base64,",t,"",o.LSH),o.xp6(2),o.MGl("href","file://data:image/png;base64,",t,"",o.LSH)}}let c=(()=>{class t{constructor(){this.incidentData={}}ngOnInit(){}initMap(){this.map=n.map("incident-poi").setView([0,0],13);let t={"Street Map":n.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),"Aerial View":n.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]})},e=n.control.layers(t);this.marker=n.marker([0,0],{icon:n.icon({iconSize:[25,41],iconAnchor:[13,41],iconUrl:"assets/marker-icon.png",shadowUrl:"assets/marker-shadow.png"})}),t["Street Map"].addTo(this.map),e.addTo(this.map),this.marker.addTo(this.map)}invalidateSize(){setTimeout(()=>{this.map.invalidateSize()},500)}ngOnChanges(t){const e=t.incidentData;if(this.initMap(),void 0!==e.currentValue.IncidentId){let t=e.currentValue.IncidentPointOfInterest;t=t.replace("POINT(","").replace(")","").split(" "),this.invalidateSize(),this.map.setView(t),this.marker.setLatLng(t),this.marker.bindPopup(e.currentValue.IncidentTypeName)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-view-single-field-report"]],inputs:{incidentData:"incidentData"},features:[o.TTD],decls:64,vars:14,consts:[["id","kt_content_container",1,"container"],[1,"card"],[1,"card-body"],[1,"mb-5"],[1,"mb-1"],[1,"text-center","mb-5"],[1,"fs-2hx","text-dark"],[1,"text-muted"],[1,"fs-5","text-muted"],[1,"fw-bold"],[1,"row","mb-10"],["id","incident-poi",2,"height","20vh"],[1,"col-6"],[1,"fs-5","fw-bold"],[1,"table-responsive","mb-4"],[1,"table"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"col-12"],["class","col-12 mb-5",4,"ngFor","ngForOf"],[1,"fs-5","mb-4"],["colspan","2",1,"fs-4","text-align-center"],[1,"fa","fa-exclamation-circle","text-warning"],[1,"col-12","mb-5"],[1,"overlay"],["alt","",1,"w-100","card-rounded",3,"src"],[1,"overlay-layer","bg-dark","card-rounded","bg-opacity-25"],["target","_blank",1,"btn","btn-link",3,"href"],[1,"bi","bi-eye-fill","fs-2x","text-white"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"div",3),o.TgZ(4,"div",4),o.TgZ(5,"div",5),o.TgZ(6,"h3",6),o.TgZ(7,"span",7),o._uU(8),o.qZA(),o._uU(9),o.qZA(),o.TgZ(10,"div",8),o.TgZ(11,"span",9),o._uU(12),o.qZA(),o._UZ(13,"br"),o.TgZ(14,"span"),o._uU(15),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(16,"div",10),o._UZ(17,"div",11),o.qZA(),o.TgZ(18,"div",10),o.TgZ(19,"div",12),o.TgZ(20,"div",13),o.TgZ(21,"div",14),o.TgZ(22,"table",15),o.TgZ(23,"tr"),o.TgZ(24,"td",7),o._uU(25,"Country"),o.qZA(),o.TgZ(26,"td"),o._uU(27),o.qZA(),o.qZA(),o.TgZ(28,"tr"),o.TgZ(29,"td",7),o._uU(30,"Region"),o.qZA(),o.TgZ(31,"td"),o._uU(32),o.qZA(),o.qZA(),o.TgZ(33,"tr"),o.TgZ(34,"td",7),o._uU(35,"State"),o.qZA(),o.TgZ(36,"td"),o._uU(37),o.qZA(),o.qZA(),o.TgZ(38,"tr"),o.TgZ(39,"td",7),o._uU(40,"LGA"),o.qZA(),o.TgZ(41,"td"),o._uU(42),o.qZA(),o.qZA(),o.TgZ(43,"tr"),o.TgZ(44,"td",7),o._uU(45,"Ward"),o.qZA(),o.TgZ(46,"td"),o._uU(47),o.qZA(),o.qZA(),o.TgZ(48,"tr"),o.TgZ(49,"td",7),o._uU(50,"Village"),o.qZA(),o.TgZ(51,"td"),o._uU(52),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(53,"div",12),o.TgZ(54,"div",13),o.TgZ(55,"div",14),o.TgZ(56,"table",15),o.YNc(57,r,5,2,"tr",16),o.YNc(58,s,5,0,"tr",17),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(59,"div",18),o.YNc(60,l,6,2,"div",19),o.qZA(),o.TgZ(61,"div",18),o.TgZ(62,"p",20),o._uU(63),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(8),o.hij("#",e.incidentData.IncidentId,":"),o.xp6(1),o.hij(" ",e.incidentData.IncidentTypeName,""),o.xp6(3),o.Oqu(e.incidentData.AccountName),o.xp6(3),o.hij("Reported on ",e.incidentData.DateReported,""),o.xp6(12),o.Oqu(e.incidentData.Country),o.xp6(5),o.Oqu(e.incidentData.Region),o.xp6(5),o.Oqu(e.incidentData.State),o.xp6(5),o.Oqu(e.incidentData.LGA),o.xp6(5),o.Oqu(e.incidentData.Ward),o.xp6(5),o.Oqu(e.incidentData.Village),o.xp6(5),o.Q6J("ngForOf",e.incidentData.metadata),o.xp6(1),o.Q6J("ngIf",0==e.incidentData.metadata.length),o.xp6(2),o.Q6J("ngForOf",e.incidentData.IncidentImages),o.xp6(3),o.Oqu(e.incidentData.IncidentName))},directives:[a.sg,a.O5],styles:[""]}),t})()},9944:(t,e,i)=>{"use strict";i.r(e),i.d(e,{DataManagersModule:()=>se});var n=i(1116),o=i(1462),a=i(5425),r=i(7349),s=i(7703),l=i(549),c=i(5366),d=i(3458),h=i(570);let p=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-shell"]],decls:5,vars:0,consts:[[1,"d-flex","flex-column","flex-root"],[1,"page","d-flex","flex-row","flex-column-fluid"],["title","Info Officers Dashboard"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c._UZ(2,"app-sidebar"),c._UZ(3,"app-header",2),c._UZ(4,"router-outlet"),c.qZA(),c.qZA())},directives:[d.k,h.G,s.lC],styles:[""]}),t})();var u=i(3559),g=i(4733),f=i(7320),_=i(3295),m=i(9151),v=i(2512),L=i(9609),Z=i(8135),y=i(5943),w=i(8281),b=i(9130);function T(t,e){if(1&t&&(c.TgZ(0,"option",30),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.s9C("value",t.id),c.xp6(1),c.Oqu(t.text)}}function x(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"td"),c._uU(2),c.qZA(),c.TgZ(3,"td"),c._uU(4),c.qZA(),c.TgZ(5,"td",34),c.NdJ("click",function(){const e=c.CHM(t).index;return c.oxw(2).removeMetadataField(e)}),c.TgZ(6,"span",35),c._UZ(7,"i",36),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(2),c.Oqu(t.field),c.xp6(2),c.Oqu(t.value)}}function M(t,e){if(1&t&&(c.TgZ(0,"div",4),c.TgZ(1,"div",31),c.TgZ(2,"table",32),c.TgZ(3,"thead"),c.TgZ(4,"th"),c._uU(5,"Metadata"),c.qZA(),c.TgZ(6,"th"),c._uU(7,"Value"),c.qZA(),c.TgZ(8,"th"),c._uU(9,"Action"),c.qZA(),c.qZA(),c.TgZ(10,"tbody"),c.YNc(11,x,8,2,"tr",33),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(11),c.Q6J("ngForOf",t.metadataFields)}}function D(t,e){if(1&t&&(c.TgZ(0,"option",30),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.s9C("value",t.key),c.xp6(1),c.Oqu(t.key)}}function k(t,e){if(1&t&&(c.TgZ(0,"option",30),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.s9C("value",t.FieldName),c.xp6(1),c.Oqu(t.FieldName)}}let C=(()=>{class t{constructor(t,e,i,n,o){this.serverRequest=t,this.modalService=e,this.toastService=i,this.storage=n,this.events=o,this.incidentData={},this.metadataFields=[],this.incidentTypeList=[],this.selectedMetadataGroup="",this.selectedMetadata={field:"",value:""},this.select2Options={containerCssClass:"form-control",width:"100%"},this.select2Options_metadata={containerCssClass:"form-control",width:"100%"},this.select2Data={countryList:[],regionList:[],stateList:[],lgaList:[],wardList:[],villageList:[],localityList:[],incidentCategoryList:[],incidentTypeList:[],factionList:[],friendlyForcesList:[],terrainList:[],associatedFeatureList:[],metadataList:[]},this.formData={}}ngOnInit(){this.storage.getItem("sessionInfo").subscribe(t=>{t=JSON.parse(t),this.userId=t.userId}),this.initFormData(),this.loadCountries(),this.loadIncidentTypes(),this.loadMetadataFields(),this.events.getEvent("approve-reviewed-incident").subscribe(t=>{null!=t&&t.IncidentId==this.incidentData.IncidentId&&this.saveIncidence()})}saveIncidence(){void 0!==this.formData.poiLatitude&&""!=this.formData.poiLatitude||(this.formData.poiLatitude=0),void 0!==this.formData.poiLongitude&&""!=this.formData.poiLongitude||(this.formData.poiLongitude=0);let t={name:this.formData.incidentTitle,type:this.formData.incidentType,location:{country:this.formData.country,region:this.formData.region,state:this.formData.state,lga:this.formData.lga,ward:this.formData.ward,village:this.formData.village,locality:this.formData.locality},date:L(this.formData.incidentDate+"T"+this.formData.incidentTime).format("D/M/YYYY HH:mm:ss"),pointOfInterest:"POINT("+this.formData.poiLatitude+" "+this.formData.poiLongitude+")",description:this.formData.comments,images:this.formData.files,metadata:{}};this.metadataFields.forEach(e=>{t.metadata[e.field]=e.value}),this.serverRequest.post("incidents/incident/edit-incident",{userId:this.userId,incidentId:this.incidentData.IncidentId,incidentData:t}).subscribe(t=>{alert("Incidence has been reviewed and approved successfully"),this.initFormData(),this.modalService.dismissAll()},t=>{this.toastService.show("An error occurred. Incidence record not reported successfully",{classname:"bg-danger text-white",delay:1e4})})}addMetadataField(){this.metadataFields.push({field:this.selectedMetadata.field,value:this.selectedMetadata.value}),this.selectedMetadata={field:"",value:""}}removeMetadataField(t){this.metadataFields.splice(t,1)}initFormData(){this.formData={country:"",region:"",state:"",lga:"",ward:"",village:"",locality:"",incidentTitle:"",incidentCategory:"",incidentType:"",comments:"",files:[],metadata:[]}}loadCountries(){this.loadSpatialEntityList("countryList","spatial-entity/entity/view-entities-by-type?entityType=1")}loadSpatialEntityChildren(t,e){""!=e&&this.loadSpatialEntityList(t,"spatial-entity/entity/view-entity-children?entityId="+e)}loadSpatialEntityList(t,e){this.serverRequest.get(e).subscribe(e=>{this.select2Data[t]=[],e.contentData.forEach(e=>{this.select2Data[t].push(e.EntityName)})})}loadRegions(t){this.loadSpatialEntityChildren("regionList",this.formData.country)}loadStates(t){this.loadSpatialEntityChildren("stateList",this.formData.region)}loadLgas(t){this.loadSpatialEntityChildren("lgaList",this.formData.state)}loadWards(t){this.loadSpatialEntityChildren("wardList",this.formData.lga)}loadVillages(t){this.loadSpatialEntityChildren("villageList",this.formData.ward)}loadLocalities(t){this.loadSpatialEntityChildren("localityList",this.formData.village)}loadIncidentTypes(){this.serverRequest.get("incidents/incident-type/view-incident-types?resourceId=1").subscribe(t=>{this.select2Data.incidentTypeList=[],t.contentData.forEach(t=>{this.select2Data.incidentTypeList.push({id:t.IncidentTypeId,text:t.IncidentTypeName})})})}getLatLon(t){return t.replace("POINT(","").replace(")","").split(" ")}loadMetadataFields(){this.serverRequest.get("incidents/metadata/get-list").subscribe(t=>{this.select2Data.metadataList=t.contentData})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.I),c.Y36(_.FF),c.Y36(Z.k),c.Y36(y.V),c.Y36(m.n))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-edit-field-report"]],inputs:{incidentData:"incidentData"},decls:131,vars:42,consts:[["id","kt_content_container",1,"container"],[1,"card"],[1,"card-body"],[1,"mb-5"],[1,"row"],[1,"col-5","form-group"],[1,"font-weight-semibold"],[1,"badge","badge-light-primary","fs-7","fw-bold"],["name","incidentType",1,"form-select",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-4","form-group"],["type","date","name","incidentDate",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-3","form-group"],["type","time","name","incidentTime",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-6","form-group"],["name","country",3,"ngModel","data","options","ngModelChange"],["name","region",3,"ngModel","data","options","ngModelChange"],["name","state",3,"ngModel","data","options","ngModelChange"],["name","lga",3,"ngModel","data","options","ngModelChange"],["name","ward",3,"ngModel","data","options","ngModelChange"],["type","text","name","village",1,"form-control",3,"ngModel","ngModelChange","change"],["type","text","name","locality",1,"form-control",3,"ngModel","ngModelChange"],["class","row",4,"ngIf"],[1,"row","more-height"],["name","selectedMetadataField",1,"form-select",3,"ngModel","ngModelChange"],["type","number","name","selectedMetadataValue",1,"form-control",3,"ngModel","ngModelChange"],[1,"row","d-flex","justify-content-center"],["type","button",1,"btn","btn-primary","col-4",3,"click"],[1,"fa","fa-plus"],["aria-live","polite","aria-atomic","true"],[3,"value"],[1,"table-responsive"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[3,"click"],[1,"btn","btn-link","btn-sm"],[1,"text-danger","fa","fa-times"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"form"),c.TgZ(5,"div",4),c.TgZ(6,"div",5),c.TgZ(7,"label",6),c._uU(8,"Incident Type "),c._UZ(9,"br"),c.TgZ(10,"span",7),c._uU(11),c.qZA(),c._uU(12,":"),c.qZA(),c.TgZ(13,"select",8),c.NdJ("ngModelChange",function(t){return e.formData.incidentType=t}),c._UZ(14,"option"),c.YNc(15,T,2,2,"option",9),c.qZA(),c.qZA(),c.TgZ(16,"div",10),c.TgZ(17,"label",6),c._uU(18,"Date "),c._UZ(19,"br"),c.TgZ(20,"span",7),c._uU(21),c.qZA(),c._uU(22,":"),c.qZA(),c.TgZ(23,"input",11),c.NdJ("ngModelChange",function(t){return e.formData.incidentDate=t}),c.qZA(),c.qZA(),c.TgZ(24,"div",12),c.TgZ(25,"label",6),c._uU(26,"Time "),c._UZ(27,"br"),c.TgZ(28,"span",7),c._uU(29,"\xa0"),c.qZA(),c._uU(30,":"),c.qZA(),c.TgZ(31,"input",13),c.NdJ("ngModelChange",function(t){return e.formData.incidentTime=t}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(32,"div",4),c.TgZ(33,"div",14),c.TgZ(34,"label",6),c._uU(35,"Country "),c._UZ(36,"br"),c.TgZ(37,"span",7),c._uU(38),c.qZA(),c._uU(39,":"),c.qZA(),c.TgZ(40,"ng-select2",15),c.NdJ("ngModelChange",function(t){return e.formData.country=t})("ngModelChange",function(t){return e.loadRegions(t)}),c.qZA(),c.qZA(),c.TgZ(41,"div",14),c.TgZ(42,"label",6),c._uU(43,"Region "),c._UZ(44,"br"),c.TgZ(45,"span",7),c._uU(46),c.qZA(),c._uU(47,":"),c.qZA(),c.TgZ(48,"ng-select2",16),c.NdJ("ngModelChange",function(t){return e.formData.region=t})("ngModelChange",function(t){return e.loadStates(t)}),c.qZA(),c.qZA(),c.TgZ(49,"div",14),c.TgZ(50,"label",6),c._uU(51,"State "),c._UZ(52,"br"),c.TgZ(53,"span",7),c._uU(54),c.qZA(),c._uU(55,":"),c.qZA(),c.TgZ(56,"ng-select2",17),c.NdJ("ngModelChange",function(t){return e.formData.state=t})("ngModelChange",function(t){return e.loadLgas(t)}),c.qZA(),c.qZA(),c.TgZ(57,"div",14),c.TgZ(58,"label",6),c._uU(59,"LGA "),c._UZ(60,"br"),c.TgZ(61,"span",7),c._uU(62),c.qZA(),c._uU(63,":"),c.qZA(),c.TgZ(64,"ng-select2",18),c.NdJ("ngModelChange",function(t){return e.formData.lga=t})("ngModelChange",function(t){return e.loadWards(t)}),c.qZA(),c.qZA(),c.TgZ(65,"div",14),c.TgZ(66,"label",6),c._uU(67,"Ward "),c._UZ(68,"br"),c.TgZ(69,"span",7),c._uU(70),c.qZA(),c._uU(71,":"),c.qZA(),c.TgZ(72,"ng-select2",19),c.NdJ("ngModelChange",function(t){return e.formData.ward=t})("ngModelChange",function(t){return e.loadVillages(t)}),c.qZA(),c.qZA(),c.TgZ(73,"div",14),c.TgZ(74,"label",6),c._uU(75,"Village "),c._UZ(76,"br"),c.TgZ(77,"span",7),c._uU(78),c.qZA(),c._uU(79,":"),c.qZA(),c.TgZ(80,"input",20),c.NdJ("ngModelChange",function(t){return e.formData.village=t})("change",function(t){return e.loadLocalities(t)}),c.qZA(),c.qZA(),c.TgZ(81,"div",14),c.TgZ(82,"label",6),c._uU(83,"Locality / Area "),c._UZ(84,"br"),c.TgZ(85,"span",7),c._uU(86),c.qZA(),c._uU(87,":"),c.qZA(),c.TgZ(88,"input",21),c.NdJ("ngModelChange",function(t){return e.formData.locality=t}),c.qZA(),c.qZA(),c.TgZ(89,"div",12),c.TgZ(90,"label",6),c._uU(91,"POI Latitude "),c._UZ(92,"br"),c.TgZ(93,"span",7),c._uU(94),c.qZA(),c._uU(95,":"),c.qZA(),c.TgZ(96,"input",21),c.NdJ("ngModelChange",function(t){return e.formData.poiLatitude=t}),c.qZA(),c.qZA(),c.TgZ(97,"div",12),c.TgZ(98,"label",6),c._uU(99,"POI Longitude "),c._UZ(100,"br"),c.TgZ(101,"span",7),c._uU(102),c.qZA(),c._uU(103,":"),c.qZA(),c.TgZ(104,"input",21),c.NdJ("ngModelChange",function(t){return e.formData.poiLongitude=t}),c.qZA(),c.qZA(),c.qZA(),c.YNc(105,M,12,1,"div",22),c.TgZ(106,"div",23),c.TgZ(107,"div",10),c.TgZ(108,"label",6),c._uU(109,"Category:"),c.qZA(),c.TgZ(110,"select",24),c.NdJ("ngModelChange",function(t){return e.selectedMetadataGroup=t}),c.TgZ(111,"option"),c._uU(112,"Select"),c.qZA(),c.YNc(113,D,2,2,"option",9),c.ALo(114,"keyvalue"),c.qZA(),c.qZA(),c.TgZ(115,"div",5),c.TgZ(116,"label",6),c._uU(117,"Metadata:"),c.qZA(),c.TgZ(118,"select",24),c.NdJ("ngModelChange",function(t){return e.selectedMetadata.field=t}),c.TgZ(119,"option"),c._uU(120,"Select"),c.qZA(),c.YNc(121,k,2,2,"option",9),c.qZA(),c.qZA(),c.TgZ(122,"div",12),c.TgZ(123,"label",6),c._uU(124,"Value:"),c.qZA(),c.TgZ(125,"input",25),c.NdJ("ngModelChange",function(t){return e.selectedMetadata.value=t}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(126,"div",26),c.TgZ(127,"button",27),c.NdJ("click",function(){return e.addMetadataField()}),c._UZ(128,"i",28),c._uU(129," Add Metadata"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(130,"app-toast-container",29)),2&t&&(c.xp6(11),c.Oqu(e.incidentData.IncidentTypeName),c.xp6(2),c.Q6J("ngModel",e.formData.incidentType),c.xp6(2),c.Q6J("ngForOf",e.select2Data.incidentTypeList),c.xp6(6),c.Oqu(e.incidentData.IncidentDate),c.xp6(2),c.Q6J("ngModel",e.formData.incidentDate),c.xp6(8),c.Q6J("ngModel",e.formData.incidentTime),c.xp6(7),c.Oqu(e.incidentData.Country),c.xp6(2),c.Q6J("ngModel",e.formData.country)("data",e.select2Data.countryList)("options",e.select2Options),c.xp6(6),c.Oqu(e.incidentData.Region),c.xp6(2),c.Q6J("ngModel",e.formData.region)("data",e.select2Data.regionList)("options",e.select2Options),c.xp6(6),c.Oqu(e.incidentData.State),c.xp6(2),c.Q6J("ngModel",e.formData.state)("data",e.select2Data.stateList)("options",e.select2Options),c.xp6(6),c.Oqu(e.incidentData.LGA),c.xp6(2),c.Q6J("ngModel",e.formData.lga)("data",e.select2Data.lgaList)("options",e.select2Options),c.xp6(6),c.Oqu(e.incidentData.Ward),c.xp6(2),c.Q6J("ngModel",e.formData.ward)("data",e.select2Data.wardList)("options",e.select2Options),c.xp6(6),c.Oqu(e.incidentData.Village),c.xp6(2),c.Q6J("ngModel",e.formData.village),c.xp6(6),c.Oqu(e.incidentData.Locality),c.xp6(2),c.Q6J("ngModel",e.formData.locality),c.xp6(6),c.Oqu(e.getLatLon(e.incidentData.IncidentPointOfInterest)[0]),c.xp6(2),c.Q6J("ngModel",e.formData.poiLatitude),c.xp6(6),c.Oqu(e.getLatLon(e.incidentData.IncidentPointOfInterest)[1]),c.xp6(2),c.Q6J("ngModel",e.formData.poiLongitude),c.xp6(1),c.Q6J("ngIf",e.metadataFields.length>0),c.xp6(5),c.Q6J("ngModel",e.selectedMetadataGroup),c.xp6(3),c.Q6J("ngForOf",c.lcZ(114,40,e.select2Data.metadataList)),c.xp6(5),c.Q6J("ngModel",e.selectedMetadata.field),c.xp6(3),c.Q6J("ngForOf",e.select2Data.metadataList[e.selectedMetadataGroup]),c.xp6(4),c.Q6J("ngModel",e.selectedMetadata.value))},directives:[o._Y,o.JL,o.F,o.EJ,o.JJ,o.On,o.YN,o.Kr,n.sg,o.Fj,w.c,n.O5,o.wV,b.J],pipes:[n.Nd],styles:[".more-height[_ngcontent-%COMP%] > .form-group[_ngcontent-%COMP%] > .form-control[_ngcontent-%COMP%]{height:45px}"]}),t})(),A=(()=>{class t{constructor(){this.incidentData={}}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-decline-field-report"]],inputs:{incidentData:"incidentData"},decls:10,vars:0,consts:[["id","kt_content_container",1,"container"],[1,"card"],[1,"card-body"],[1,"mb-5"],[1,"row"],[1,"col-12","form-group"],[1,"font-weight-semibold"],["rows","10",1,"form-control"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"form"),c.TgZ(5,"div",4),c.TgZ(6,"div",5),c.TgZ(7,"label",6),c._uU(8,"Comments:"),c.qZA(),c._UZ(9,"textarea",7),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA())},directives:[o._Y,o.JL,o.F],styles:[""]}),t})();function E(t,e){if(1&t&&(c.TgZ(0,"span",55),c.TgZ(1,"span",56),c._uU(2),c.qZA(),c.TgZ(3,"span",57),c._uU(4,"Area"),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.hij("",t.Locality," ")}}function q(t,e){if(1&t&&(c.TgZ(0,"span",55),c.TgZ(1,"span",56),c._uU(2),c.qZA(),c.TgZ(3,"span",57),c._uU(4,"Ward"),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.hij("",t.Ward," ")}}function O(t,e){if(1&t&&(c.TgZ(0,"span",55),c.TgZ(1,"span",56),c._uU(2),c.qZA(),c.TgZ(3,"span",57),c._uU(4,"Village"),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.hij("",t.Village," ")}}function P(t,e){1&t&&(c.TgZ(0,"span",58),c._uU(1,"Unreviewed"),c.qZA())}function U(t,e){1&t&&(c.TgZ(0,"span",59),c._uU(1,"Approved"),c.qZA())}function I(t,e){if(1&t&&(c.TgZ(0,"span",47),c._UZ(1,"br"),c._uU(2),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Oqu(t.ReviewedByAccountName)}}function S(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"td"),c.TgZ(1,"span",60),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncidentForReview(e,n)}),c._UZ(2,"i",61),c._uU(3,"\xa0 "),c.qZA(),c.TgZ(4,"span",60),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncidentForDecline(e,n)}),c._UZ(5,"i",62),c._uU(6,"\xa0 "),c.qZA(),c.qZA()}}function N(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"td"),c.TgZ(1,"span",63),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c._uU(2," view "),c.qZA(),c.qZA()}}function z(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c._uU(2),c.qZA(),c.TgZ(3,"td",44),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c.TgZ(4,"div",45),c._uU(5),c.qZA(),c.qZA(),c.TgZ(6,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c.TgZ(7,"div",3),c.TgZ(8,"div",46),c.TgZ(9,"span",47),c._uU(10),c.qZA(),c.TgZ(11,"span",48),c._uU(12),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(13,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c.TgZ(14,"span",49),c._uU(15),c.qZA(),c.YNc(16,E,5,1,"span",50),c.YNc(17,q,5,1,"span",50),c.YNc(18,O,5,1,"span",50),c.TgZ(19,"span",51),c._uU(20),c.qZA(),c.qZA(),c.TgZ(21,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c._uU(22),c.qZA(),c.TgZ(23,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c._uU(24),c.qZA(),c.TgZ(25,"td",43),c.NdJ("click",function(){const e=c.CHM(t).$implicit,i=c.oxw(2),n=c.MAs(67);return i.openIncident(e,n)}),c.YNc(26,P,2,0,"span",52),c.YNc(27,U,2,0,"span",53),c.YNc(28,I,3,1,"span",54),c.qZA(),c.YNc(29,S,7,0,"td",39),c.YNc(30,N,3,0,"td",39),c.qZA()}if(2&t){const t=e.$implicit;c.xp6(2),c.Oqu(t.IncidentId),c.xp6(3),c.Oqu(t.IncidentName),c.xp6(5),c.Oqu(t.AccountName),c.xp6(2),c.AsE("",t.FirstName," ",t.LastName,""),c.xp6(3),c.AsE("",t.LGA,", ",t.State,""),c.xp6(1),c.Q6J("ngIf","UNKNOWN LOCALITY"!=t.Locality),c.xp6(1),c.Q6J("ngIf","UNKNOWN WARD"!=t.Ward),c.xp6(1),c.Q6J("ngIf","UNKNOWN VILLAGE"!=t.Village),c.xp6(2),c.Oqu(t.Country),c.xp6(2),c.Oqu(t.IncidentTypeName),c.xp6(2),c.Oqu(t.IncidentDate),c.xp6(2),c.Q6J("ngIf",0!=t.StatusCode),c.xp6(1),c.Q6J("ngIf",0==t.StatusCode),c.xp6(1),c.Q6J("ngIf",0==t.StatusCode),c.xp6(1),c.Q6J("ngIf",0!=t.StatusCode),c.xp6(1),c.Q6J("ngIf",0==t.StatusCode)}}function R(t,e){if(1&t&&(c.TgZ(0,"tbody",41),c.YNc(1,z,31,18,"tr",42),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("ngForOf",t.currentData)}}function J(t,e){1&t&&(c.TgZ(0,"tbody"),c.TgZ(1,"tr"),c.TgZ(2,"td",64),c._uU(3,"No incidences available"),c.qZA(),c.qZA(),c.qZA())}function F(t,e){if(1&t&&(c.TgZ(0,"div",75),c._UZ(1,"app-edit-field-report",72),c.qZA()),2&t){const t=c.oxw(2);c.xp6(1),c.Q6J("incidentData",t.currentView)}}function Y(t,e){if(1&t&&(c.TgZ(0,"div",75),c._UZ(1,"app-decline-field-report",72),c.qZA()),2&t){const t=c.oxw(2);c.xp6(1),c.Q6J("incidentData",t.currentView)}}function G(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",76),c.TgZ(1,"button",77),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).initForReview()}),c._uU(2,"Review & Approve"),c.qZA(),c.TgZ(3,"button",78),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).initForDecline()}),c._uU(4,"Decline"),c.qZA(),c.qZA()}}function H(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",76),c.TgZ(1,"button",79),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).sendApproveEvent()}),c._uU(2,"Approve Report"),c.qZA(),c.qZA()}}function Q(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",76),c.TgZ(1,"button",78),c.NdJ("click",function(){return c.CHM(t),c.oxw(2).sendDeclineEvent()}),c._uU(2,"Decline Report"),c.qZA(),c.qZA()}}const V=function(t,e){return{"col-12":t,"col-5":e}};function B(t,e){if(1&t&&(c.TgZ(0,"div",65),c.TgZ(1,"h4",66),c._uU(2,"Field Incident Report"),c.qZA(),c.TgZ(3,"button",67),c.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),c.TgZ(4,"span",68),c._uU(5,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"div",69),c.TgZ(7,"div",70),c.TgZ(8,"div",71),c._UZ(9,"app-view-single-field-report",72),c.qZA(),c.YNc(10,F,2,1,"div",73),c.YNc(11,Y,2,1,"div",73),c.qZA(),c.qZA(),c.YNc(12,G,5,0,"div",74),c.YNc(13,H,3,0,"div",74),c.YNc(14,Q,3,0,"div",74)),2&t){const t=c.oxw();c.xp6(8),c.Q6J("ngClass",c.WLB(7,V,!t.forReview&&!t.forDecline,t.forReview||t.forDecline)),c.xp6(1),c.Q6J("incidentData",t.currentView),c.xp6(1),c.Q6J("ngIf",t.forReview),c.xp6(1),c.Q6J("ngIf",t.forDecline),c.xp6(1),c.Q6J("ngIf",!t.forReview&&!t.forDecline),c.xp6(1),c.Q6J("ngIf",t.forReview),c.xp6(1),c.Q6J("ngIf",t.forDecline)}}let W=(()=>{class t{constructor(t,e,i){this.serverRequest=t,this.modalService=e,this.events=i,this.globalDateRange={startDate:"",endDate:""},this.currentData=[],this.currentView={},this.forReview=!1,this.forDecline=!1,this.dtOptions={paging:!1,lengthChange:!1,pagingType:"full_numbers",pageLength:100,serverSide:!0,processing:!0,ajax:(t,e)=>{this.serverRequest.get("incidents/incident/view-raw-data?length="+t.length+"&start="+t.start+"&search="+t.search.value+"&startDate="+this.globalDateRange.startDate+"&endDate="+this.globalDateRange.endDate).subscribe(t=>{this.currentData=[],this.currentData=t.contentData.data,e({recordsTotal:t.contentData.recordsTotal,recordsFiltered:t.contentData.recordsFiltered,data:[]})})}},this.dtTrigger=new u.xQ}ngOnInit(){this.dtTrigger.next(),setTimeout(()=>{this.rerender()},500)}ngAfterViewInit(){this.dtTrigger.next()}ngOnDestroy(){this.dtTrigger.unsubscribe()}rerender(){this.dtElement.dtInstance.then(t=>{t.destroy(),this.dtTrigger.next()})}openIncident(t,e){this.forReview=!1,this.forDecline=!1,this.currentView=t,this.modalRef=this.modalService.open(e,{backdropClass:"modal-backdrop",size:"xl",scrollable:!0})}openIncidentForReview(t,e){this.initForReview(),this.currentView=t,this.modalRef=this.modalService.open(e,{backdropClass:"modal-backdrop",size:"xl",scrollable:!0})}openIncidentForDecline(t,e){this.initForDecline(),this.currentView=t,this.modalRef=this.modalService.open(e,{backdropClass:"modal-backdrop",size:"xl",scrollable:!0})}initForReview(){this.forReview=!0,this.forDecline=!1}initForDecline(){this.forDecline=!0,this.forReview=!1}sendApproveEvent(){this.events.broadcast("approve-reviewed-incident",{IncidentId:this.currentView.IncidentId})}sendDeclineEvent(){this.events.broadcast("decline-reviewed-incident",{status:!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.I),c.Y36(_.FF),c.Y36(m.n))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-view-field-reports"]],viewQuery:function(t,e){if(1&t&&c.Gf(g.G,5),2&t){let t;c.iGM(t=c.CRH())&&(e.dtElement=t.first)}},decls:68,vars:4,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"d-flex","flex-column"],[1,"d-lg-flex","align-lg-items-center"],[1,"rounded","d-flex","flex-column","flex-lg-row","align-items-lg-center","bg-white","p-5","w-xxl-850px","h-lg-60px","me-lg-10","my-5"],[1,"row","flex-grow-1","mb-5","mb-lg-0"],[1,"col-lg-4","d-flex","align-items-center","mb-3","mb-lg-0"],[1,"svg-icon","svg-icon-1","svg-icon-gray-400","me-1"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","24px","height","24px","viewBox","0 0 24 24","version","1.1"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["x","0","y","0","width","24","height","24"],["d","M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z","fill","#000000","fill-rule","nonzero","opacity","0.3"],["d","M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z","fill","#000000","fill-rule","nonzero"],["type","text","name","search","value","","placeholder","Keyword",1,"form-control","form-control-flush","flex-grow-1"],[1,"col-lg-4","d-flex","align-items-center","mb-5","mb-lg-0"],[1,"bullet","bg-secondary","d-none","d-lg-block","h-30px","w-2px","me-5"],["x","5","y","5","width","5","height","5","rx","1","fill","#000000"],["x","14","y","5","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],["x","5","y","14","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],["x","14","y","14","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],["data-control","select2","data-placeholder","Incident Type","data-hide-search","true",1,"form-select","border-0","flex-grow-1"],["value",""],["value","1","selected","selected"],[1,"col-lg-4","d-flex","align-items-center"],[1,"svg-icon","svg-icon-1","svg-icon-gray-400","me-3"],["d","M5,10.5 C5,6 8,3 12.5,3 C17,3 20,6.75 20,10.5 C20,12.8325623 17.8236613,16.03566 13.470984,20.1092932 C12.9154018,20.6292577 12.0585054,20.6508331 11.4774555,20.1594925 C7.15915182,16.5078313 5,13.2880005 5,10.5 Z M12.5,12 C13.8807119,12 15,10.8807119 15,9.5 C15,8.11928813 13.8807119,7 12.5,7 C11.1192881,7 10,8.11928813 10,9.5 C10,10.8807119 11.1192881,12 12.5,12 Z","fill","#000000","fill-rule","nonzero"],["type","text","name","search","value","","placeholder","Location",1,"form-control","form-control-flush","flex-grow-1"],[1,"min-w-150px","text-end"],["type","submit","id","kt_advanced_search_button_1",1,"btn","btn-dark"],[1,"col-md-12","table-responsive"],["datatable","",1,"table","table-hover","align-middle","gs-0","gy-4",3,"dtOptions","dtTrigger"],[1,"fw-bolder","text-muted","bg-light"],[1,"min-w-200px"],[1,"text-center"],["style","max-height: 80vh; overflow: scroll;",4,"ngIf"],[4,"ngIf"],["content",""],[2,"max-height","80vh","overflow","scroll"],[4,"ngFor","ngForOf"],[3,"click"],[1,"min-w-200px",3,"click"],[1,"wrap-text"],[1,"d-flex","justify-content-start","flex-column"],[1,"text-dark","fw-bolder","text-hover-primary","mb-1","fs-6"],[1,"text-muted","fw-bold","text-muted","d-block","fs-7"],[1,"text-dark","fw-bolder","text-hover-primary","d-block","mb-1","fs-6"],["class","text-muted d-block fs-7",4,"ngIf"],[1,"text-muted","text-small","text-muted","d-block","fs-7"],["class","badge badge-light-primary fs-7 fw-bold",4,"ngIf"],["class","badge badge-success fs-7 fw-bold",4,"ngIf"],["class","text-dark fw-bolder text-hover-primary mb-1 fs-6",4,"ngIf"],[1,"text-muted","d-block","fs-7"],[1,"text-muted","fw-bold"],[1,"text-small"],[1,"badge","badge-light-primary","fs-7","fw-bold"],[1,"badge","badge-success","fs-7","fw-bold"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-primary","btn-sm","me-1",3,"click"],[1,"fa","fa-edit"],[1,"fa","fa-times","text-danger"],[1,"btn","btn-icon","btn-bg-light","btn-active-color-success","btn-sm","me-1",3,"click"],["colspan","10"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row"],[3,"ngClass"],[3,"incidentData"],["class","col-7 left-border",4,"ngIf"],["class","modal-footer",4,"ngIf"],[1,"col-7","left-border"],[1,"modal-footer"],["type","button",1,"btn","btn-info",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],["type","button",1,"btn","btn-success",3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"h1",4),c._uU(5,"Reported Field Incidents"),c.qZA(),c.TgZ(6,"span",5),c._uU(7,"Data Management Portal"),c.qZA(),c.qZA(),c.TgZ(8,"div",6),c.TgZ(9,"div",7),c.TgZ(10,"div",8),c.TgZ(11,"div",9),c.TgZ(12,"div",10),c.TgZ(13,"span",11),c.O4$(),c.TgZ(14,"svg",12),c.TgZ(15,"g",13),c._UZ(16,"rect",14),c._UZ(17,"path",15),c._UZ(18,"path",16),c.qZA(),c.qZA(),c.qZA(),c.kcU(),c._UZ(19,"input",17),c.qZA(),c.TgZ(20,"div",18),c._UZ(21,"div",19),c.TgZ(22,"span",11),c.O4$(),c.TgZ(23,"svg",12),c.TgZ(24,"g",13),c._UZ(25,"rect",20),c._UZ(26,"rect",21),c._UZ(27,"rect",22),c._UZ(28,"rect",23),c.qZA(),c.qZA(),c.qZA(),c.kcU(),c.TgZ(29,"select",24),c._UZ(30,"option",25),c.TgZ(31,"option",26),c._uU(32,"Incident Type"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(33,"div",27),c._UZ(34,"div",19),c.TgZ(35,"span",28),c.O4$(),c.TgZ(36,"svg",12),c.TgZ(37,"g",13),c._UZ(38,"rect",14),c._UZ(39,"path",29),c.qZA(),c.qZA(),c.qZA(),c.kcU(),c._UZ(40,"input",30),c.qZA(),c.qZA(),c.TgZ(41,"div",31),c.TgZ(42,"button",32),c._uU(43,"Search"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(44,"div",33),c.TgZ(45,"table",34),c.TgZ(46,"thead"),c.TgZ(47,"tr",35),c.TgZ(48,"th"),c._uU(49,"ID"),c.qZA(),c.TgZ(50,"th",36),c._uU(51,"Incident"),c.qZA(),c.TgZ(52,"th"),c._uU(53,"Account"),c.qZA(),c.TgZ(54,"th"),c._uU(55,"Location"),c.qZA(),c.TgZ(56,"th"),c._uU(57,"Incident Type"),c.qZA(),c.TgZ(58,"th"),c._uU(59,"Date"),c.qZA(),c.TgZ(60,"th"),c._uU(61,"Status"),c.qZA(),c.TgZ(62,"th",37),c._uU(63,"Actions"),c.qZA(),c.qZA(),c.qZA(),c.YNc(64,R,2,1,"tbody",38),c.YNc(65,J,4,0,"tbody",39),c.qZA(),c.qZA(),c.qZA(),c.YNc(66,B,15,10,"ng-template",null,40,c.W1O)),2&t&&(c.xp6(45),c.Q6J("dtOptions",e.dtOptions)("dtTrigger",e.dtTrigger),c.xp6(19),c.Q6J("ngIf",0!=(null==e.currentData?null:e.currentData.length)),c.xp6(1),c.Q6J("ngIf",0==(null==e.currentData?null:e.currentData.length)))},directives:[o.YN,o.Kr,g.G,n.O5,n.sg,n.mk,v.M,C,A],styles:[".wrapper[_ngcontent-%COMP%]{width:95vw;padding-left:0}.modal-backdrop[_ngcontent-%COMP%]{background-color:#4b5320}.w-50[_ngcontent-%COMP%]{width:50%!important}.left-border[_ngcontent-%COMP%]{min-height:100vh;border-left:1px solid #4b5320;border-radius:25px 0}.wrap-text[_ngcontent-%COMP%]{max-height:60px;overflow:hidden;text-overflow:ellipsis}"]}),t})();var j=i(2617);function X(t,e,i,n){return new(i||(i=Promise))(function(o,a){function r(t){try{l(n.next(t))}catch(e){a(e)}}function s(t){try{l(n.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(r,s)}l((n=n.apply(t,e||[])).next())})}function K(t){return X(this,void 0,void 0,function*(){const e=new ClipboardItem({[t.type]:t});yield navigator.clipboard.write([e])})}var tt=i(4866);let et=(()=>{class t{constructor(){this.categoriesData={},this.chartOption={title:{text:"Bar Chart",subtext:"",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:[],axisTick:{alignWithLabel:!0}}],yAxis:[{type:"value"}],series:[]}}ngOnInit(){}ngOnChanges(t){const e=t.categoriesData;null!==e.currentValue&&(this.categoriesData=e.currentValue,void 0!==this.categoriesData.data&&setTimeout(()=>{this.loadData()},500))}onChartInit(t){this.chart=t}loadData(){if(void 0!==this.categoriesData.data){let t=[];for(let e in this.categoriesData.data){let i={name:e,type:"bar",barGap:0,label:[],emphasis:{focus:"series"},data:Object.values(this.categoriesData.data[e])};t.push(i)}this.chart.setOption({legend:{bottom:0,data:this.categoriesData.legends},xAxis:{data:this.categoriesData.values},yAxis:[{type:"value"}],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},series:t,title:{text:"Bar Chart",subtext:this.categoriesData.legends.length+" Locations",left:"center"}},!0)}else this.chart.clear()}copyToClipboard(){const t=this.chart.getDataURL({pixelRatio:2,backgroundColor:"#fff"});(new Image).src=t;try{(function(t){return X(this,void 0,void 0,function*(){const e=yield function(t){return X(this,void 0,void 0,function*(){const e=yield fetch(`${t}`);return yield e.blob()})}(t);if(function(t){return t.type.includes("jpeg")}(e)){const t=yield function(t){return X(this,void 0,void 0,function*(){const e=URL.createObjectURL(t),i=yield function(t){return X(this,void 0,void 0,function*(){return new Promise(function(e,i){const n=document.createElement("img");n.crossOrigin="anonymous",n.src=t,n.onload=function(t){e(t.target)},n.onabort=i,n.onerror=i})})}(e);return yield function(t){return X(this,void 0,void 0,function*(){return new Promise(function(e,i){const n=document.createElement("canvas"),o=n.getContext("2d");if(o){const{width:a,height:r}=t;n.width=a,n.height=r,o.drawImage(t,0,0,a,r),n.toBlob(function(t){t?e(t):i("Cannot get blob from image element")},"image/png",1)}})})}(i)})}(e);return yield K(t),e}if(function(t){return t.type.includes("png")}(e))return yield K(e),e;throw new Error("Cannot copy this type of image to clipboard")})})(t).then(()=>{console.log("Image Copied")}).catch(t=>{console.log("Error: ",t.message)})}catch(e){console.error(e)}console.log(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-bar-chart"]],inputs:{categoriesData:"categoriesData"},features:[c.TTD],decls:6,vars:1,consts:[[1,"btn","btn-default",3,"click"],[1,"card"],[1,"card-body"],[1,"chart-container"],["echarts","",3,"options","chartInit"]],template:function(t,e){1&t&&(c.TgZ(0,"button",0),c.NdJ("click",function(){return e.copyToClipboard()}),c._uU(1,"Copy"),c.qZA(),c.TgZ(2,"div",1),c.TgZ(3,"div",2),c.TgZ(4,"div",3),c.TgZ(5,"div",4),c.NdJ("chartInit",function(t){return e.onChartInit(t)}),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(5),c.Q6J("options",e.chartOption))},directives:[tt._w],styles:[""]}),t})(),it=(()=>{class t{constructor(){this.categoriesData={},this.chartOption={title:{text:"Pie Chart",subtext:"",left:"center"},tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:[]}}ngOnInit(){}ngOnChanges(t){const e=t.categoriesData;null!==e.currentValue&&(this.categoriesData=e.currentValue,void 0!==this.categoriesData.data&&setTimeout(()=>{this.loadData()},500))}onChartInit(t){this.chart=t}loadData(){if(void 0!==this.categoriesData.data){let t=[];for(let e in this.categoriesData.data){let i=this.categoriesData.data[e],n=[];for(let t in i)n.push({name:t,value:i[t]});t.push({name:e,type:"pie",radius:"50%",emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},data:n})}this.chart.setOption({tooltip:{trigger:"item"},legend:{orient:"vertical",left:"left"},series:t,title:{text:"Pie Chart",subtext:this.categoriesData.legends.length+" Locations",left:"center"}},!0)}else this.chart.clear()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-pie-chart"]],inputs:{categoriesData:"categoriesData"},features:[c.TTD],decls:4,vars:1,consts:[[1,"card"],[1,"card-body"],[1,"chart-container"],["echarts","",3,"options","chartInit"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.NdJ("chartInit",function(t){return e.onChartInit(t)}),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(3),c.Q6J("options",e.chartOption))},directives:[tt._w],styles:[""]}),t})();var nt=i(3219),ot=i(2693),at=i(1882),rt=(i(7463),function(){function t(){}return t.deepLiteralCopy=function(t,e){var i=t;if(null!=e)for(var n in e)e.hasOwnProperty(n)&&("string"==typeof e[n]||e[n]instanceof String?i[n]=e[n]:this.deepLiteralCopy(i[n],e[n]));return i},t}()),st=function(){function t(t,e){this.zone=e,this.drawOptions=null,this.drawLocal=null,this.drawReady=new c.vpe,this.onDrawCreated=new c.vpe,this.onDrawEdited=new c.vpe,this.onDrawDeleted=new c.vpe,this.onDrawStart=new c.vpe,this.onDrawStop=new c.vpe,this.onDrawVertex=new c.vpe,this.onDrawEditStart=new c.vpe,this.onDrawEditMove=new c.vpe,this.onDrawEditResize=new c.vpe,this.onDrawEditVertex=new c.vpe,this.onDrawEditStop=new c.vpe,this.onDrawDeleteStart=new c.vpe,this.onDrawDeleteStop=new c.vpe,this.onDrawToolbarOpened=new c.vpe,this.onDrawToolbarClosed=new c.vpe,this.onDrawMarkerContext=new c.vpe,this.leafletDirective=new at.lr(t)}return t.prototype.ngOnInit=function(){var t=this;this.leafletDirective.init(),null!=this.drawLocal&&rt.deepLiteralCopy(nt.drawLocal,this.drawLocal),this.drawControl=new nt.Control.Draw(this.drawOptions),this.leafletDirective.getMap().addControl(this.drawControl);var e=this.leafletDirective.getMap();e.on(nt.Draw.Event.CREATED,function(e){return at.eB.handleEvent(t.zone,t.onDrawCreated,e)}),e.on(nt.Draw.Event.EDITED,function(e){return at.eB.handleEvent(t.zone,t.onDrawEdited,e)}),e.on(nt.Draw.Event.DELETED,function(e){return at.eB.handleEvent(t.zone,t.onDrawDeleted,e)}),e.on(nt.Draw.Event.DRAWSTART,function(e){return at.eB.handleEvent(t.zone,t.onDrawStart,e)}),e.on(nt.Draw.Event.DRAWSTOP,function(e){return at.eB.handleEvent(t.zone,t.onDrawStop,e)}),e.on(nt.Draw.Event.EDITSTART,function(e){return at.eB.handleEvent(t.zone,t.onDrawEditStart,e)}),e.on(nt.Draw.Event.EDITMOVE,function(e){return at.eB.handleEvent(t.zone,t.onDrawEditMove,e)}),e.on(nt.Draw.Event.EDITRESIZE,function(e){return at.eB.handleEvent(t.zone,t.onDrawEditResize,e)}),e.on(nt.Draw.Event.EDITVERTEX,function(e){return at.eB.handleEvent(t.zone,t.onDrawEditVertex,e)}),e.on(nt.Draw.Event.EDITSTOP,function(e){return at.eB.handleEvent(t.zone,t.onDrawEditStop,e)}),e.on(nt.Draw.Event.DELETESTART,function(e){return at.eB.handleEvent(t.zone,t.onDrawDeleteStart,e)}),e.on(nt.Draw.Event.DELETESTOP,function(e){return at.eB.handleEvent(t.zone,t.onDrawDeleteStop,e)}),e.on(nt.Draw.Event.TOOLBAROPENED,function(e){return at.eB.handleEvent(t.zone,t.onDrawToolbarOpened,e)}),e.on(nt.Draw.Event.TOOLBARCLOSED,function(e){return at.eB.handleEvent(t.zone,t.onDrawToolbarClosed,e)}),this.drawReady.emit(this.drawControl)},t.prototype.ngOnDestroy=function(){this.leafletDirective.getMap().removeControl(this.drawControl)},t.prototype.getDrawControl=function(){return this.drawControl},t.\u0275fac=function(e){return new(e||t)(c.Y36(at.je),c.Y36(c.R0b))},t.\u0275dir=c.lG2({type:t,selectors:[["","leafletDraw",""]],inputs:{drawOptions:["leafletDrawOptions","drawOptions"],drawLocal:["leafletDrawLocal","drawLocal"]},outputs:{drawReady:"leafletDrawReady",onDrawCreated:"leafletDrawCreated",onDrawEdited:"leafletDrawEdited",onDrawDeleted:"leafletDrawDeleted",onDrawStart:"leafletDrawStart",onDrawStop:"leafletDrawStop",onDrawVertex:"leafletDrawVertex",onDrawEditStart:"leafletDrawEditStart",onDrawEditMove:"leafletDrawEditMove",onDrawEditResize:"leafletDrawEditResize",onDrawEditVertex:"leafletDrawEditVertex",onDrawEditStop:"leafletDrawEditStop",onDrawDeleteStart:"leafletDrawDeleteStart",onDrawDeleteStop:"leafletDrawDeleteStop",onDrawToolbarOpened:"leafletDrawToolbarOpened",onDrawToolbarClosed:"leafletDrawToolbarClosed",onDrawMarkerContext:"leafletDrawMarkerContext"}}),t}(),lt=function(){function t(){}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[at.UO]]}),t}();function ct(t,e=null){return{type:4,styles:e,timings:t}}function dt(t){return{type:6,styles:t,offset:null}}function ht(t){return{type:5,steps:t}}function pt(t,e,i=null){return{type:1,expr:t,animation:e,options:i}}const ut=["eventsWrapper"],gt=["fillingLine"],ft=["timelineEvents"],_t=function(t,e){return{selected:t,"older-event":e}};function mt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"li"),c.TgZ(1,"a",12,13),c.NdJ("click",function(e){const i=c.CHM(t).$implicit;return c.oxw().onEventClick(e,i)}),c._uU(3),c.ALo(4,"date"),c.qZA(),c.TgZ(5,"span"),c._uU(6),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw();c.xp6(1),c.Q6J("ngClass",c.WLB(6,_t,t.selected,i<n.selectedIndex)),c.xp6(2),c.Oqu(c.xi3(4,3,t.date,n.dateFormat)),c.xp6(3),c.Oqu(t.caption)}}function vt(t,e){if(1&t&&(c.TgZ(0,"li"),c.TgZ(1,"h2"),c._uU(2),c.qZA(),c.TgZ(3,"em"),c._uU(4),c.ALo(5,"date"),c.qZA(),c.TgZ(6,"p"),c._uU(7),c.qZA(),c.qZA()),2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.Q6J("@contentState",t.selected?"active":i<n.selectedIndex?"left":"right"),c.xp6(2),c.Oqu(t.title),c.xp6(2),c.Oqu(c.xi3(5,4,t.date,n.dateFormat)),c.xp6(3),c.Oqu(t.content)}}function Lt(t,e){if(1&t&&(c.TgZ(0,"div",14),c.TgZ(1,"ol"),c.YNc(2,vt,8,7,"li",5),c.qZA(),c.qZA()),2&t){const t=c.oxw();c.xp6(2),c.Q6J("ngForOf",t.timelineElements)}}const Zt=function(t){return{loaded:t}},yt=function(t){return{inactive:t}};let wt=(()=>{class t{constructor(t,e){this._cdr=t,this.eventsService=e,this.prevLinkInactive=!0,this.nextLinkInactive=!1,this.loaded=!1,this.selectedIndex=0,this.eventsWrapperWidth=0,this._viewInitialized=!1,this._timelineWrapperWidth=720,this._eventsMinDistance=80,this._dateFormat="dd.MM.yyyy",this._disabled=!1,this._showContent=!1}set timelineWrapperWidth(t){this._timelineWrapperWidth=t,this._cdr.detectChanges()}set eventsMinDistance(t){this._eventsMinDistance=t,this.initView()}get timelineElements(){return this._timelineElements}set timelineElements(t){this._timelineElements=t,this.initView()}get dateFormat(){return this._dateFormat}set dateFormat(t){this._dateFormat=t,this.initView()}set disabled(t){this._disabled=t}get showContent(){return this._showContent}set showContent(t){this._showContent=t,this._cdr.detectChanges()}static pxToNumber(t){return Number(t.replace("px",""))}static getElementWidth(e){const i=window.getComputedStyle(e);return i.width?t.pxToNumber(i.width):0}static parentElement(t,e){if(!t||!t.parentNode)return null;let i=t.parentNode;for(;;){if(i.tagName.toLowerCase()==e)return i;if(i=i.parentNode,!i)return null}}static getTranslateValue(t){let e=window.getComputedStyle(t),i=e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform"),n=0;if(i.indexOf("(")>=0){let t=i.split("(")[1].split(")")[0].split(",")[4];n=Number(t)}return n}static setTransformValue(t,e,i){t.style["-webkit-transform"]=e+"("+i+")",t.style["-moz-transform"]=e+"("+i+")",t.style["-ms-transform"]=e+"("+i+")",t.style["-o-transform"]=e+"("+i+")",t.style.transform=e+"("+i+")"}static dayDiff(t,e){return Math.round(e.getTime()-t.getTime())}static minLapse(e){if(e&&e.length&&1===e.length)return 0;let i=0;for(let n=1;n<e.length;n++){let o=t.dayDiff(e[n-1].date,e[n].date);i=i?Math.min(i,o):o}return i}ngAfterViewInit(){this._cdr.detach(),this._viewInitialized=!0,this.initView()}onScrollClick(t,e){t.preventDefault(),this.updateSlide(this.eventsWrapperWidth,e),this._cdr.detectChanges()}onEventClick(t,e){if(t.preventDefault(),this._disabled)return;this.eventsService.broadcast("timeline-element-selected",e);let i=t.target,n=this._timelineElements[0];this._timelineElements.forEach(function(t){t.selected&&t!=e&&(n=t,t.selected=!1)}),this.selectedIndex=this._timelineElements.indexOf(e),e.selected=!0,this.updateFilling(i),this._cdr.detectChanges()}initTimeline(e){let i=t.minLapse(e);this.setDatePosition(e,this._eventsMinDistance,i),this.setTimelineWidth(e,this._eventsMinDistance,i),this.loaded=!0}updateSlide(e,i){let n=t.getTranslateValue(this.eventsWrapper.nativeElement);i?this.translateTimeline(n-this._timelineWrapperWidth+this._eventsMinDistance,this._timelineWrapperWidth-e):this.translateTimeline(n+this._timelineWrapperWidth-this._eventsMinDistance,null)}updateTimelinePosition(e){if(void 0!==e){let i=window.getComputedStyle(e),n=t.pxToNumber(i.getPropertyValue("left")),o=t.getTranslateValue(this.eventsWrapper.nativeElement);n>this._timelineWrapperWidth-o&&this.translateTimeline(this._timelineWrapperWidth/2-n,this._timelineWrapperWidth-this.eventsWrapperWidth)}}translateTimeline(e,i){e=e>0?0:e,t.setTransformValue(this.eventsWrapper.nativeElement,"translateX",(e=null!==i&&e<i?i:e)+"px"),this.prevLinkInactive=0===e,this.nextLinkInactive=e===i}setTimelineWidth(e,i,n){let o=100;e.length>1&&(o=t.dayDiff(e[0].date,e[e.length-1].date));let a=o/n;a=Math.round(a)+4,this.eventsWrapperWidth=a*i;let r=this.eventsWrapper.nativeElement.querySelectorAll("a.selected")[0];return this.updateFilling(r),this.updateTimelinePosition(r),this.eventsWrapperWidth}updateFilling(e){if(void 0!==e){let i=window.getComputedStyle(e),n=i.getPropertyValue("left"),o=i.getPropertyValue("width"),a=t.pxToNumber(n)+t.pxToNumber(o)/2;t.setTransformValue(this.fillingLine.nativeElement,"scaleX",a/this.eventsWrapperWidth)}}initView(){if(this._viewInitialized){if(this._timelineElements&&this._timelineElements.length){for(let t=0;t<this._timelineElements.length;t++)if(this._timelineElements[t].selected){this.selectedIndex=t;break}this.initTimeline(this._timelineElements)}this._cdr.detectChanges()}}setDatePosition(e,i,n){let o=this.timelineEvents.toArray(),a=0;for(let r of e){let s=t.dayDiff(e[0].date,r.date),l=Math.round(s/n);o[a].nativeElement.style.left=l*i+"px";let c=o[a].nativeElement.parentElement.children[1],d=t.getElementWidth(c);c.style.left=l*i+d/2+"px",a++}}}var e,i,o;return t.\u0275fac=function(e){return new(e||t)(c.Y36(c.sBO),c.Y36(m.n))},t.\u0275cmp=c.Xpm({type:t,selectors:[["horizontal-timeline"]],viewQuery:function(t,e){if(1&t&&(c.Gf(ut,5),c.Gf(gt,5),c.Gf(ft,5)),2&t){let t;c.iGM(t=c.CRH())&&(e.eventsWrapper=t.first),c.iGM(t=c.CRH())&&(e.fillingLine=t.first),c.iGM(t=c.CRH())&&(e.timelineEvents=t)}},inputs:{timelineWrapperWidth:"timelineWrapperWidth",eventsMinDistance:"eventsMinDistance",timelineElements:"timelineElements",dateFormat:"dateFormat",disabled:"disabled",showContent:"showContent"},decls:17,vars:13,consts:[[1,"cd-horizontal-timeline",3,"ngClass"],[1,"timeline"],[1,"events-wrapper"],[1,"events"],["eventsWrapper",""],[4,"ngFor","ngForOf"],["aria-hidden","true",1,"filling-line"],["fillingLine",""],[1,"cd-timeline-navigation"],["href","#",1,"prev",3,"ngClass","click"],["href","#",1,"next",3,"ngClass","click"],["class","events-content",4,"ngIf"],["href","#",3,"ngClass","click"],["timelineEvents",""],[1,"events-content"]],template:function(t,e){1&t&&(c.TgZ(0,"section",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3,4),c.TgZ(5,"ol"),c.YNc(6,mt,7,9,"li",5),c.qZA(),c._UZ(7,"span",6,7),c.qZA(),c.qZA(),c.TgZ(9,"ul",8),c.TgZ(10,"li"),c.TgZ(11,"a",9),c.NdJ("click",function(t){return e.onScrollClick(t,!1)}),c._uU(12,"Prev"),c.qZA(),c.qZA(),c.TgZ(13,"li"),c.TgZ(14,"a",10),c.NdJ("click",function(t){return e.onScrollClick(t,!0)}),c._uU(15,"Next"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(16,Lt,3,1,"div",11),c.qZA()),2&t&&(c.Q6J("ngClass",c.VKq(7,Zt,e.loaded)),c.xp6(3),c.Udp("width",e.eventsWrapperWidth,"px"),c.xp6(3),c.Q6J("ngForOf",e.timelineElements),c.xp6(5),c.Q6J("ngClass",c.VKq(9,yt,e.prevLinkInactive)),c.xp6(3),c.Q6J("ngClass",c.VKq(11,yt,e.nextLinkInactive)),c.xp6(2),c.Q6J("ngIf",e.showContent))},directives:[n.mk,n.sg,n.O5],pipes:[n.uU],styles:['ol[_ngcontent-%COMP%], ul[_ngcontent-%COMP%]{list-style:none;font-weight:bolder}.cd-horizontal-timeline[_ngcontent-%COMP%]{opacity:0;margin:2em auto;transition:opacity .2s}.cd-horizontal-timeline[_ngcontent-%COMP%]:before{content:"mobile";display:none}.cd-horizontal-timeline.loaded[_ngcontent-%COMP%]{opacity:1}.cd-horizontal-timeline[_ngcontent-%COMP%]   .timeline[_ngcontent-%COMP%]{position:relative;height:50px;width:90%;max-width:900px;margin:0 auto}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-wrapper[_ngcontent-%COMP%]{position:relative;height:100%;margin:0 40px;overflow:hidden}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-wrapper[_ngcontent-%COMP%]:before{left:0;background-image:linear-gradient(90deg,#fff,#f8f8f800)}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-wrapper[_ngcontent-%COMP%]:after{right:0;background-image:linear-gradient(270deg,#fff,#f8f8f800)}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]{position:absolute;z-index:1;left:0;top:29px;height:2px;background:#dfdfdf;transition:transform .4s}.cd-horizontal-timeline[_ngcontent-%COMP%]   .filling-line[_ngcontent-%COMP%]{position:absolute;z-index:1;left:0;top:0;height:100%;width:100%;background-color:#7b9d6f;transform:scaleX(0);transform-origin:left center;transition:transform .3s}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:absolute;bottom:0;z-index:2;text-align:center;font-size:12px;text-decoration:none;padding-bottom:15px;color:#383838;transform:translateZ(0)}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;left:50%;right:auto;transform:translateX(-50%);bottom:-5px;height:8px;width:8px;border-radius:50%;border:2px solid #dfdfdf;background-color:#f8f8f8;transition:background-color .3s,border-color .3s}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover:after{background-color:#7b9d6f;border-color:#7b9d6f}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a.selected[_ngcontent-%COMP%]{pointer-events:none}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a.selected[_ngcontent-%COMP%]:after{background-color:#7b9d6f;border-color:#7b9d6f}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events[_ngcontent-%COMP%]   a.older-event[_ngcontent-%COMP%]:after{border-color:#7b9d6f}@media only screen and (min-width:1100px){.cd-horizontal-timeline[_ngcontent-%COMP%]{margin:.5em auto}.cd-horizontal-timeline[_ngcontent-%COMP%]:before{content:"desktop"}}.cd-horizontal-timeline[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;left:1700px;bottom:-30px;font-size:12px}.cd-timeline-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:absolute;z-index:1;top:50%;bottom:auto;transform:translateY(-50%);height:34px;width:34px;border-radius:50%;border:2px solid #dfdfdf;overflow:hidden;color:#0000;text-indent:100%;white-space:nowrap;transition:border-color .3s}.cd-timeline-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:after{content:"";position:absolute;height:16px;width:16px;left:50%;top:50%;bottom:auto;right:auto;transform:translateX(-50%) translateY(-50%);background:url(/assets/images/cd-arrow.svg) no-repeat 0 0}.cd-timeline-navigation[_ngcontent-%COMP%]   a.prev[_ngcontent-%COMP%]{left:0;transform:translateY(-50%) rotate(180deg)}.cd-timeline-navigation[_ngcontent-%COMP%]   a.next[_ngcontent-%COMP%]{right:0}.cd-timeline-navigation[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{border-color:#7b9d6f}.cd-timeline-navigation[_ngcontent-%COMP%]   a.inactive[_ngcontent-%COMP%]{cursor:not-allowed}.cd-timeline-navigation[_ngcontent-%COMP%]   a.inactive[_ngcontent-%COMP%]:after{background-position:0 -16px}.cd-timeline-navigation[_ngcontent-%COMP%]   a.inactive[_ngcontent-%COMP%]:hover{border-color:#dfdfdf}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]{position:relative;width:100%;margin:2em 0;overflow:hidden;transition:height .4s}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{position:absolute;z-index:1;width:100%;left:0;top:0;padding:0 5%;opacity:0}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700;font-size:2.6rem;line-height:1.2}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{display:block;font-style:italic;margin:10px auto}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]:before{content:"- "}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.4rem;color:#959595}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%], .cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{line-height:1.6}@media only screen and (min-width:768px){.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:7rem}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   em[_ngcontent-%COMP%]{font-size:2rem}.cd-horizontal-timeline[_ngcontent-%COMP%]   .events-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.8rem}}'],data:{animation:[(i="contentState",o=[(e=dt({position:"relative","z-index":2,opacity:1}),{type:0,name:"active",styles:e,options:void 0}),pt("right => active",[dt({transform:"translateX(100%)"}),ct("400ms ease-in-out",ht([dt({opacity:0,transform:"translateX(100%)",offset:0}),dt({opacity:1,transform:"translateX(0%)",offset:1})]))]),pt("active => right",[dt({transform:"translateX(-100%)"}),ct("400ms ease-in-out",ht([dt({opacity:1,transform:"translateX(0%)",offset:0}),dt({opacity:0,transform:"translateX(100%)",offset:1})]))]),pt("active => left",[dt({transform:"translateX(-100%)"}),ct("400ms ease-in-out",ht([dt({opacity:1,transform:"translateX(0%)",offset:0}),dt({opacity:0,transform:"translateX(-100%)",offset:1})]))]),pt("left => active",[dt({transform:"translateX(100%)"}),ct("400ms ease-in-out",ht([dt({opacity:0,transform:"translateX(-100%)",offset:0}),dt({opacity:1,transform:"translateX(0%)",offset:1})]))])],{type:7,name:i,definitions:o,options:{}})]},changeDetection:0}),t})();function bt(t,e){if(1&t&&(c.TgZ(0,"div",11),c._UZ(1,"horizontal-timeline",12),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("timelineElements",t.timeline)("showContent",!1)("dateFormat","dd MMM, yyyy")}}function Tt(t,e){if(1&t&&(c.TgZ(0,"tr"),c.TgZ(1,"td",13),c._UZ(2,"span",14),c._uU(3),c.qZA(),c.qZA()),2&t){const t=e.$implicit;c.xp6(2),c.Jzz("background-color: ",t.value,""),c.xp6(1),c.hij("\xa0\xa0",t.key,"")}}let xt=(()=>{class t{constructor(t,e,i){this.http=t,this.serverRequest=e,this.eventsService=i,this.typeColors={},this.globalDateRange={startDate:"",endDate:""},this.leafletOptions={layers:[nt.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]})],zoom:5,center:nt.latLng(11,6)},this.timeline=[],this.drawnItems=nt.featureGroup(),this.drawOptions={draw:{position:"topleft",circle:{shapeOptions:{color:"#d4af37"}},rectangle:!1,polygon:!1,marker:!1,circlemarker:!1},edit:{featureGroup:this.drawnItems,edit:!1}}}ngOnInit(){this.eventsService.getEvent("timeline-element-selected").subscribe(t=>{null!=t&&this.loadGeoJson(t)}),this.eventsService.getEvent("date-selected").subscribe(t=>{null!=t&&(this.globalDateRange=t),setTimeout(()=>{this.loadTimelineDates()},500)})}getIncidentTypeColor(t){if(t in this.typeColors)return this.typeColors[t];var e,i,n,o=Math.floor(Math.random()*this.json.features.length)/this.json.features.length,a=~~(6*o),r=6*o-a,s=1-r;switch(a%6){case 0:e=1,i=r,n=0;break;case 1:e=s,i=1,n=0;break;case 2:e=0,i=1,n=r;break;case 3:e=0,i=s,n=1;break;case 4:e=r,i=0,n=1;break;case 5:e=1,i=0,n=s}var l="#"+("00"+(~~(255*e)).toString(16)).slice(-2)+("00"+(~~(255*i)).toString(16)).slice(-2)+("00"+(~~(255*n)).toString(16)).slice(-2);return this.typeColors[t]=l,l}getIncidentTypeStyle(t){return{radius:5,fillColor:this.getIncidentTypeColor(t.properties.type),color:"#f00",weight:.8,opacity:.9,fillOpacity:.8}}onMapReady(t){this.map=t;let e={"Default Map":nt.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,attribution:"..."}),"Street Map":nt.tileLayer("http://{s}.google.com/vt/lyrs=m&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]}),"Aerial View":nt.tileLayer("http://{s}.google.com/vt/lyrs=s&x={x}&y={y}&z={z}",{maxZoom:20,subdomains:["mt0","mt1","mt2","mt3"]})};nt.control.layers(e,{},{position:"topleft"}).addTo(this.map),nt.icon({iconUrl:"assets/media/marker.png",shadowUrl:"",iconSize:[38,38],shadowSize:[50,64],iconAnchor:[22,94],shadowAnchor:[4,62],popupAnchor:[-3,-76]}),this.eventsLayer=nt.geoJSON(this.json,{pointToLayer:(t,e)=>{let i=this.getIncidentTypeStyle(t);return nt.circleMarker(e,i)}}),this.infoLayer=new nt.Control,this.infoLayer.onAdd=t=>(this.infoText=nt.DomUtil.create("div","leaflet-info-bar"),this.infoText),t.addLayer(this.eventsLayer),this.infoLayer.addTo(t),$(".leaflet-info-bar").addClass("hidden")}loadTimelineDates(){this.serverRequest.get("incidents/timeline/get-dates?startDate="+this.globalDateRange.startDate+"&endDate="+this.globalDateRange.endDate).subscribe(t=>{this.timeline=[],t.contentData.forEach(t=>{let e={date:new Date(t.IncidentDate),title:t.TotalIncidences+" Incidences"};this.timeline.push(e)})})}loadGeoJson(t){const e=L(t.date).format("YYYY-MM-DD");this.serverRequest.get("incidents/timeline/get-incidents-geojson?startDate="+e+"&endDate="+e).subscribe(t=>{this.json=t.contentData,this.map.removeLayer(this.eventsLayer),this.eventsLayer=nt.geoJSON(this.json,{pointToLayer:(t,e)=>{let i=this.getIncidentTypeStyle(t);return nt.circleMarker(e,i)},onEachFeature:function(t,e){e.on({click:e=>{$(".leaflet-info-bar").removeClass("hidden");const i="<h1>"+t.properties.type+" ("+t.properties.category+")&nbsp;&nbsp;&nbsp;&nbsp;<button class='btn btn-link pull-right text-primary' onclick='$(\".leaflet-info-bar\").addClass(\"hidden\")'>&times;<small> close</small></button></h1><p>"+t.properties.title+"</p>";$(".leaflet-info-bar").html(i)}})}});const i="<h4>"+L(e).format("DD MMMM, YYYY")+"</h4><h6 class='font-weight-semibold' style='line-height: 0;'>Total Incidences = "+this.json.features.length+"</h6>";$(".leaflet-control-zoom").html(i),this.map.addLayer(this.eventsLayer)})}onDrawCreated(t){if("circle"==t.layerType){var e=t.layer.getRadius();this.drawnItems.addLayer(t.layer),this.drawnItems.bringToBack(),this.drawnItems.bindPopup("Radius: "+Math.round(e/1e3*100)/100+" KM"),this.drawnItems.openPopup()}}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(ot.eN),c.Y36(f.I),c.Y36(m.n))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-incidence-timeline"]],decls:15,vars:7,consts:[[1,"page-content",2,"padding","1rem !important"],[1,"content-wrapper"],[1,"content"],[1,"row"],["class","col-md-12",4,"ngIf"],[1,"col-md-10"],["leaflet","","leafletDraw","",2,"height","100vh","margin-bottom","10px",3,"leafletOptions","leafletDrawOptions","leafletDrawCreated","leafletMapReady"],[3,"leafletLayer"],[1,"col-md-2",2,"overflow-x","hidden","background-color","rgba(255, 255, 255, 0.4)","padding-top","5px"],[1,"font-weight-semibold","text-center"],[4,"ngFor","ngForOf"],[1,"col-md-12"],[3,"timelineElements","showContent","dateFormat"],[2,"padding","0.6em","line-height","1.25","font-weight","500"],[1,"dot"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.YNc(4,bt,2,3,"div",4),c.qZA(),c.TgZ(5,"div",3),c.TgZ(6,"div",5),c.TgZ(7,"div",6),c.NdJ("leafletDrawCreated",function(t){return e.onDrawCreated(t)})("leafletMapReady",function(t){return e.onMapReady(t)}),c._UZ(8,"div",7),c.qZA(),c.qZA(),c.TgZ(9,"div",8),c.TgZ(10,"h6",9),c._uU(11,"LEGEND"),c.qZA(),c.TgZ(12,"table"),c.YNc(13,Tt,4,4,"tr",10),c.ALo(14,"keyvalue"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(4),c.Q6J("ngIf",e.timeline.length>0),c.xp6(3),c.Q6J("leafletOptions",e.leafletOptions)("leafletDrawOptions",e.drawOptions),c.xp6(1),c.Q6J("leafletLayer",e.drawnItems),c.xp6(5),c.Q6J("ngForOf",c.lcZ(14,5,e.typeColors)))},directives:[n.O5,at.je,st,at.qT,n.sg,wt],pipes:[n.Nd],styles:[".dot[_ngcontent-%COMP%]{height:15px;width:15px;background-color:#bbb;border-radius:50%;display:inline-block}"]}),t})();function Mt(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",41),c.TgZ(2,"label",42),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.hij(" ",t.key,"")}}function Dt(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Mt,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function kt(t,e){if(1&t&&(c.TgZ(0,"div",34),c.TgZ(1,"p",35),c._uU(2,"Country"),c.qZA(),c.TgZ(3,"div",36),c.YNc(4,Dt,2,1,"div",37),c.ALo(5,"keyvalue"),c.qZA(),c._UZ(6,"div",38),c.qZA()),2&t){const t=c.oxw();c.xp6(4),c.Q6J("ngForOf",c.lcZ(5,1,t.selectedLocations.country))}}function Ct(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",41),c.TgZ(2,"label",42),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.hij(" ",t.key,"")}}function At(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Ct,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function Et(t,e){if(1&t&&(c.TgZ(0,"div",34),c.TgZ(1,"p",35),c._uU(2,"Region"),c.qZA(),c.TgZ(3,"div",36),c.YNc(4,At,2,1,"div",37),c.ALo(5,"keyvalue"),c.qZA(),c._UZ(6,"div",38),c.qZA()),2&t){const t=c.oxw();c.xp6(4),c.Q6J("ngForOf",c.lcZ(5,1,t.selectedLocations.region))}}function qt(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",41),c.TgZ(2,"label",42),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.hij(" ",t.key,"")}}function Ot(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,qt,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function Pt(t,e){if(1&t&&(c.TgZ(0,"div",34),c.TgZ(1,"p",35),c._uU(2,"State"),c.qZA(),c.TgZ(3,"div",36),c.YNc(4,Ot,2,1,"div",37),c.ALo(5,"keyvalue"),c.qZA(),c._UZ(6,"div",38),c.qZA()),2&t){const t=c.oxw();c.xp6(4),c.Q6J("ngForOf",c.lcZ(5,1,t.selectedLocations.state))}}function Ut(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",41),c.TgZ(2,"label",42),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.hij(" ",t.key,"")}}function It(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Ut,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function St(t,e){if(1&t&&(c.TgZ(0,"div",34),c.TgZ(1,"p",35),c._uU(2,"LGA"),c.qZA(),c.TgZ(3,"div",36),c.YNc(4,It,2,1,"div",37),c.ALo(5,"keyvalue"),c.qZA(),c._UZ(6,"div",38),c.qZA()),2&t){const t=c.oxw();c.xp6(4),c.Q6J("ngForOf",c.lcZ(5,1,t.selectedLocations.lga))}}function Nt(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",41),c.TgZ(2,"label",42),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.Oqu(t.key)}}function zt(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Nt,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function Rt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"div",14),c.TgZ(2,"label",15),c._uU(3,"Filter Metadata"),c.qZA(),c.TgZ(4,"input",43),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(),i=c.MAs(61);return e.openMetadataModal(i)}),c.qZA(),c.qZA(),c.TgZ(5,"div",44),c.YNc(6,zt,2,1,"div",37),c.ALo(7,"keyvalue"),c._UZ(8,"div",38),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(6),c.Q6J("ngForOf",c.lcZ(7,1,t.selectedMetadata))}}function Jt(t,e){if(1&t&&(c.TgZ(0,"div",40),c._UZ(1,"input",45),c.TgZ(2,"label",46),c._uU(3),c.qZA(),c.qZA()),2&t){const t=c.oxw().$implicit;c.xp6(3),c.Oqu(t.key)}}function Ft(t,e){if(1&t&&(c.TgZ(0,"div"),c.YNc(1,Jt,4,1,"div",39),c.qZA()),2&t){const t=e.$implicit;c.xp6(1),c.Q6J("ngIf",1==t.value)}}function Yt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"div",14),c.TgZ(2,"label",15),c._uU(3,"Filter Incident"),c.qZA(),c.TgZ(4,"input",43),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(),i=c.MAs(63);return e.openIncidentModal(i)}),c.qZA(),c.qZA(),c.TgZ(5,"div",44),c.YNc(6,Ft,2,1,"div",37),c.ALo(7,"keyvalue"),c._UZ(8,"div",38),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(6),c.Q6J("ngForOf",c.lcZ(7,1,t.selectedIncidents))}}function Gt(t,e){1&t&&(c.TgZ(0,"div",47),c.TgZ(1,"p"),c._uU(2,"Loading..."),c.qZA(),c.qZA())}function Ht(t,e){if(1&t&&(c.TgZ(0,"div",47),c._UZ(1,"app-bar-chart",48),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("categoriesData",t.chartData)}}function Qt(t,e){if(1&t&&(c.TgZ(0,"div",47),c._UZ(1,"app-pie-chart",48),c.qZA()),2&t){const t=c.oxw();c.xp6(1),c.Q6J("categoriesData",t.chartData)}}function Vt(t,e){1&t&&(c.TgZ(0,"div",47),c._UZ(1,"app-incidence-timeline"),c.qZA())}function Bt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",40),c.TgZ(1,"input",70),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(2).selectedLocations.country[i]=e}),c.qZA(),c.TgZ(2,"label",71),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(1),c.MGl("id","loc_search_country_",i,""),c.MGl("name","loc_search_country_",i,""),c.Q6J("ngModel",n.selectedLocations.country[t]),c.xp6(1),c.MGl("for","loc_search_country_",i,""),c.xp6(1),c.Oqu(t)}}function Wt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",40),c.TgZ(1,"input",70),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(2).selectedLocations.region[i]=e}),c.qZA(),c.TgZ(2,"label",71),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(1),c.MGl("id","loc_search_region_",i,""),c.MGl("name","loc_search_region_",i,""),c.Q6J("ngModel",n.selectedLocations.region[t]),c.xp6(1),c.MGl("for","loc_search_region_",i,""),c.xp6(1),c.Oqu(t)}}function $t(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",40),c.TgZ(1,"input",70),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(2).selectedLocations.state[i]=e}),c.qZA(),c.TgZ(2,"label",71),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(1),c.MGl("id","loc_search_state_",i,""),c.MGl("name","loc_search_state_",i,""),c.Q6J("ngModel",n.selectedLocations.state[t]),c.xp6(1),c.MGl("for","loc_search_state_",i,""),c.xp6(1),c.Oqu(t)}}function jt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",40),c.TgZ(1,"input",70),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(2).selectedLocations.lga[i]=e}),c.qZA(),c.TgZ(2,"label",71),c._uU(3),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(1),c.MGl("id","loc_search_lga_",i,""),c.MGl("name","loc_search_lga_",i,""),c.Q6J("ngModel",n.selectedLocations.lga[t]),c.xp6(1),c.MGl("for","loc_search_lga_",i,""),c.xp6(1),c.Oqu(t)}}function Xt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",49),c.TgZ(1,"h4",50),c._uU(2,"Search Locations"),c.qZA(),c.TgZ(3,"button",51),c.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),c.TgZ(4,"span",52),c._uU(5,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"div",53),c.TgZ(7,"div",54),c.TgZ(8,"div",55),c.TgZ(9,"div",20),c.TgZ(10,"span",56),c.O4$(),c.TgZ(11,"svg",57),c.TgZ(12,"g",58),c._UZ(13,"rect",59),c._UZ(14,"path",60),c._UZ(15,"path",61),c.qZA(),c.qZA(),c.qZA(),c.kcU(),c.TgZ(16,"input",62),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw().locationKeyword=e})("change",function(){return c.CHM(t),c.oxw().searchLocation()}),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(17,"div",63),c.TgZ(18,"div",64),c.TgZ(19,"div",65),c.TgZ(20,"label",15),c._uU(21,"COUNTRY"),c.qZA(),c.qZA(),c.TgZ(22,"div",66),c.YNc(23,Bt,4,5,"div",67),c.qZA(),c.qZA(),c.TgZ(24,"div",64),c.TgZ(25,"div",65),c.TgZ(26,"label",15),c._uU(27,"REGION"),c.qZA(),c.qZA(),c.TgZ(28,"div",66),c.YNc(29,Wt,4,5,"div",67),c.qZA(),c.qZA(),c.TgZ(30,"div",64),c.TgZ(31,"div",65),c.TgZ(32,"label",15),c._uU(33,"STATE"),c.qZA(),c.qZA(),c.TgZ(34,"div",66),c.YNc(35,$t,4,5,"div",67),c.qZA(),c.qZA(),c.TgZ(36,"div",64),c.TgZ(37,"div",65),c.TgZ(38,"label",15),c._uU(39,"LGA"),c.qZA(),c.qZA(),c.TgZ(40,"div",66),c.YNc(41,jt,4,5,"div",67),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(42,"div",68),c.TgZ(43,"button",69),c.NdJ("click",function(){return c.CHM(t),c.oxw().closeModal()}),c._uU(44,"Close"),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(16),c.Q6J("ngModel",t.locationKeyword),c.xp6(7),c.Q6J("ngForOf",t.searchedLocations.country),c.xp6(6),c.Q6J("ngForOf",t.searchedLocations.region),c.xp6(6),c.Q6J("ngForOf",t.searchedLocations.state),c.xp6(6),c.Q6J("ngForOf",t.searchedLocations.lga)}}function Kt(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"div",40),c.TgZ(2,"input",81),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(3).selectedMetadata[i.FieldName]=e}),c.qZA(),c.TgZ(3,"label",71),c._uU(4),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw().index,o=c.oxw(2);c.xp6(2),c.hYB("id","kt_m_",n,"_",i,""),c.Q6J("ngModel",o.selectedMetadata[t.FieldName]),c.xp6(1),c.hYB("for","kt_m_",n,"_",i,""),c.xp6(1),c.hij(" ",t.FieldName,"")}}function te(t,e){if(1&t&&(c.TgZ(0,"div",65),c.TgZ(1,"div",74),c.TgZ(2,"span",75),c.O4$(),c.TgZ(3,"svg",57),c.TgZ(4,"g",58),c._UZ(5,"polygon",76),c._UZ(6,"rect",77),c._UZ(7,"path",78),c.qZA(),c.qZA(),c.qZA(),c.kcU(),c.TgZ(8,"h3",79),c._uU(9),c.qZA(),c.qZA(),c.TgZ(10,"div",80),c.YNc(11,Kt,5,6,"div",37),c.qZA(),c.qZA()),2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(1),c.uIk("data-bs-target","#kt_accordion_metadata_item_"+i),c.xp6(8),c.Oqu(t.key),c.xp6(1),c.MGl("id","kt_accordion_metadata_item_",i,""),c.xp6(1),c.Q6J("ngForOf",n.toArray(t.value))}}function ee(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",49),c.TgZ(1,"h4",50),c._uU(2,"Select Metadata"),c.qZA(),c.TgZ(3,"button",51),c.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),c.TgZ(4,"span",52),c._uU(5,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"div",53),c.TgZ(7,"div",72),c.YNc(8,te,12,4,"div",73),c.ALo(9,"keyvalue"),c.qZA(),c.qZA(),c.TgZ(10,"div",68),c.TgZ(11,"button",69),c.NdJ("click",function(){return c.CHM(t),c.oxw().closeModal()}),c._uU(12,"Close"),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(8),c.Q6J("ngForOf",c.lcZ(9,1,t.metadataList))}}function ie(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"div",40),c.TgZ(2,"input",81),c.NdJ("ngModelChange",function(e){const i=c.CHM(t).$implicit;return c.oxw(2).selectedIncidents[i.text]=e}),c.qZA(),c.TgZ(3,"label",71),c._uU(4),c.qZA(),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index,n=c.oxw(2);c.xp6(2),c.MGl("id","kt_type_",i,""),c.Q6J("ngModel",n.selectedIncidents[t.text]),c.xp6(1),c.MGl("for","kt_type_",i,""),c.xp6(1),c.hij(" ",t.text,"")}}function ne(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",49),c.TgZ(1,"h4",50),c._uU(2,"Select Incident Type"),c.qZA(),c.TgZ(3,"button",51),c.NdJ("click",function(){return e.$implicit.dismiss("Cross click")}),c.TgZ(4,"span",52),c._uU(5,"\xd7"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(6,"div",53),c.TgZ(7,"div",65),c.YNc(8,ie,5,4,"div",37),c.qZA(),c.qZA(),c.TgZ(9,"div",68),c.TgZ(10,"button",69),c.NdJ("click",function(){return c.CHM(t),c.oxw().closeModal()}),c._uU(11,"Close"),c.qZA(),c.qZA()}if(2&t){const t=c.oxw();c.xp6(8),c.Q6J("ngForOf",t.incidentTypeList)}}const oe=[{path:"",component:p,canActivate:[l.P],children:[{path:"field-reports",component:W},{path:"charts",component:(()=>{class t{constructor(t,e,i,n){this.serverRequest=t,this.storage=e,this.events=i,this.modalService=n,this.requiredSearchType="metadata",this.chartData={},this.performGlobalSearch=!1,this.searchParams={type:"basic",keyword:"",incidentType:"",location:""},this.locationKeyword="Nigeria",this.searchedLocations={country:[],state:[],lga:[],region:[]},this.selectedLocations={country:{},state:{},lga:{},region:{}},this.requestingData=!1,this.regions=[],this.globalDateRange={startDate:"",endDate:""},this.metadataList=[],this.selectedMetadata={},this.selectedIncidents={},this.incidentTypeList=[]}ngOnInit(){this.loadMetadataFields(),this.searchLocation(),this.loadIncidentTypes(),this.events.getEvent("perform-global-search").subscribe(t=>{null!=t&&""!=t.type&&(this.searchParams=t,""!=this.searchParams.dateRange.startDate&&(this.globalDateRange.startDate=this.searchParams.dateRange.startDate.format("YYYY-MM-DD"),this.globalDateRange.endDate=this.searchParams.dateRange.endDate.format("YYYY-MM-DD")))})}loadIncidentTypes(){this.serverRequest.get("incidents/incident-type/view-incident-types?resourceId=1").subscribe(t=>{this.incidentTypeList=[],t.contentData.forEach(t=>{this.incidentTypeList.push({id:t.IncidentTypeId,text:t.IncidentTypeName})})})}loadMetadataFields(){this.serverRequest.get("incidents/metadata/get-list").subscribe(t=>{this.metadataList=t.contentData})}loadIncidencesByRegionData(){this.serverRequest.get("incidents/stats/load-incidences-by-region?startDate="+this.globalDateRange.startDate+"&endDate="+this.globalDateRange.endDate).subscribe(t=>{const e=t.contentData;this.categoriesData=e.types.categories,this.trendsData=e.trends.categories,this.regions=Object.keys(this.categoriesData)})}stringify(t){return JSON.stringify(t)}openLocationSearch(t){this.modal=this.modalService.open(t,{backdropClass:"modal-backdrop",size:"lg",scrollable:!0})}closeModal(){this.modal.close()}searchLocation(){this.searchedLocations={country:[],state:[],lga:[],region:[]},this.serverRequest.get("incidents/search/location?keyword="+this.locationKeyword).subscribe(t=>{const e=t.contentData;for(let i in e){const t=e[i];this.searchedLocations.country.includes(t.Country)||this.searchedLocations.country.push(t.Country),this.searchedLocations.region.includes(t.Region)||this.searchedLocations.region.push(t.Region),this.searchedLocations.state.includes(t.State)||this.searchedLocations.state.push(t.State),this.searchedLocations.lga.includes(t.LGA)||this.searchedLocations.lga.push(t.LGA)}})}openMetadataModal(t){this.modal=this.modalService.open(t,{backdropClass:"modal-backdrop",size:"md",scrollable:!0})}openIncidentModal(t){this.modal=this.modalService.open(t,{backdropClass:"modal-backdrop",size:"md",scrollable:!0})}toArray(t){return Object.keys(t).map(e=>t[e])}loadData(){this.requestingData=!0;const t=this.globalDateRange.startDate,e=this.globalDateRange.endDate;let i="incidents/stats/load-by-metadata",n={locations:this.selectedLocations,startDate:t,endDate:e};"metadata"==this.requiredSearchType?n={locations:this.selectedLocations,startDate:t,endDate:e,metadata:this.selectedMetadata}:(n={locations:this.selectedLocations,startDate:t,endDate:e,incidentTypes:this.selectedIncidents},i="incidents/stats/load-by-incident-types"),this.serverRequest.post(i,n).subscribe(t=>{this.requestingData=!1,this.chartData=t.contentData})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(f.I),c.Y36(y.V),c.Y36(m.n),c.Y36(_.FF))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-charts"]],decls:64,vars:20,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"d-flex","flex-column"],[1,"d-lg-flex","align-lg-items-center"],["id","kt_content",1,"content","d-flex","flex-column","flex-column-fluid"],["id","kt_content_container",1,"container"],[1,"d-flex","flex-column","flex-lg-row"],[1,"flex-column","flex-lg-row-auto","w-100","w-lg-250px","w-xxl-325px","mb-8","mb-lg-0","me-lg-9","me-5"],[1,"card"],[1,"card-body"],[1,"mb-5","mt-5"],[1,"fs-6","form-label","fw-bolder","text-dark"],[1,"form-select","form-select-solid",3,"ngModel","ngModelChange"],["value",""],["value","incident"],["value","metadata"],[1,"position-relative"],[1,"btn","btn-light","btn-active-light-primary","btn-color-gray-400","me-3",3,"click"],["class","me-n5 pe-5 mt-5",4,"ngIf"],[4,"ngIf"],["value","bar-chart"],["value","pie-chart"],["value","map"],[1,"d-flex","align-items-center","justify-content-end"],[1,"btn","btn-primary",3,"click"],[1,"flex-lg-row-fluid"],["class","col-md-12",4,"ngIf"],["content",""],["metadataContent",""],["incidentContent",""],[1,"me-n5","pe-5","mt-5"],[1,"form-check-label","flex-grow-1","fw-bold","text-gray-700","fs-7"],["id","kt_explore_scroll","data-kt-scroll","true","data-kt-scroll-height","auto","data-kt-scroll-wrappers","#kt_explore_body","data-kt-scroll-offset","5px",1,"scroll-y"],[4,"ngFor","ngForOf"],[1,"separator","separator-dashed","my-2"],["class","form-check form-check-custom form-check-solid mb-5",4,"ngIf"],[1,"form-check","form-check-custom","form-check-solid","mb-5"],["type","checkbox","id","kt_search_category_1",1,"form-check-input"],["for","kt_search_category_1",1,"form-check-label","flex-grow-1","fw-bold","text-gray-700","fs-7",2,"padding-left","20px"],["type","text","name","city",1,"form-control","form-control","form-control-solid",3,"click"],[1,"mb-10"],["type","checkbox","id","kt_search_category__",1,"form-check-input"],["for","kt_search_category__",1,"form-check-label","flex-grow-1","fw-bold","text-gray-700","fs-7",2,"padding-left","20px"],[1,"col-md-12"],[3,"categoriesData"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"row","mb-10"],[1,"col-5"],[1,"svg-icon","svg-icon-3","svg-icon-gray-500","position-absolute","top-50","translate-middle","ms-6"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","24px","height","24px","viewBox","0 0 24 24","version","1.1"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["x","0","y","0","width","24","height","24"],["d","M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z","fill","#000000","fill-rule","nonzero","opacity","0.3"],["d","M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z","fill","#000000","fill-rule","nonzero"],["type","text","name","searchLocation","value","","placeholder","Search",1,"form-control","form-control-solid","ps-10",3,"ngModel","ngModelChange","change"],[1,"row"],[1,"col-md-3"],[1,"mb-5"],[1,"mb-1"],["class","form-check form-check-custom form-check-solid mb-5",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-success",3,"click"],["type","checkbox",1,"form-check-input",3,"id","name","ngModel","ngModelChange"],[1,"form-check-label","flex-grow-1","fw-bold","text-gray-700","fs-7",2,"padding-left","20px",3,"for"],["id","kt_accordion_metadata",1,"accordion","accordion-icon-toggle"],["class","mb-5",4,"ngFor","ngForOf"],["data-bs-toggle","collapse",1,"accordion-header","py-3","d-flex"],[1,"accordion-icon"],["points","0 0 24 0 24 24 0 24"],["fill","#000000","opacity","0.5","transform","translate(8.500000, 12.000000) rotate(-90.000000) translate(-8.500000, -12.000000)","x","7.5","y","7.5","width","2","height","9","rx","1"],["d","M9.70710318,15.7071045 C9.31657888,16.0976288 8.68341391,16.0976288 8.29288961,15.7071045 C7.90236532,15.3165802 7.90236532,14.6834152 8.29288961,14.2928909 L14.2928896,8.29289093 C14.6714686,7.914312 15.281055,7.90106637 15.675721,8.26284357 L21.675721,13.7628436 C22.08284,14.136036 22.1103429,14.7686034 21.7371505,15.1757223 C21.3639581,15.5828413 20.7313908,15.6103443 20.3242718,15.2371519 L15.0300721,10.3841355 L9.70710318,15.7071045 Z","fill","#000000","fill-rule","nonzero","transform","translate(14.999999, 11.999997) scale(1, -1) rotate(90.000000) translate(-14.999999, -11.999997)"],[1,"fs-4","fw-bold","mb-0","ms-4"],["data-bs-parent","#kt_accordion_metadata",1,"fs-6","collapse","show","ps-10",3,"id"],["type","checkbox",1,"form-check-input",3,"id","ngModel","ngModelChange"]],template:function(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"h1",4),c._uU(5,"Data Visualization"),c.qZA(),c.TgZ(6,"span",5),c._uU(7,"Generate statistical charts to better understand incident data"),c.qZA(),c.qZA(),c.TgZ(8,"div",6),c.TgZ(9,"div",7),c._UZ(10,"app-global-search"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(11,"div",8),c.TgZ(12,"div",9),c.TgZ(13,"div",10),c.TgZ(14,"div",11),c.TgZ(15,"div",12),c.TgZ(16,"div",13),c.TgZ(17,"div",14),c.TgZ(18,"label",15),c._uU(19,"Search type"),c.qZA(),c.TgZ(20,"select",16),c.NdJ("ngModelChange",function(t){return e.requiredSearchType=t}),c._UZ(21,"option",17),c.TgZ(22,"option",18),c._uU(23,"Incident Type"),c.qZA(),c.TgZ(24,"option",19),c._uU(25,"Metadata"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(26,"div",20),c.TgZ(27,"button",21),c.NdJ("click",function(){c.CHM(t);const i=c.MAs(59);return e.openLocationSearch(i)}),c._uU(28,"Search Locations"),c.qZA(),c.qZA(),c.YNc(29,kt,7,3,"div",22),c.ALo(30,"keyvalue"),c.YNc(31,Et,7,3,"div",22),c.ALo(32,"keyvalue"),c.YNc(33,Pt,7,3,"div",22),c.ALo(34,"keyvalue"),c.YNc(35,St,7,3,"div",22),c.ALo(36,"keyvalue"),c.YNc(37,Rt,9,3,"div",23),c.YNc(38,Yt,9,3,"div",23),c.TgZ(39,"div",14),c.TgZ(40,"label",15),c._uU(41,"Chart Type"),c.qZA(),c.TgZ(42,"select",16),c.NdJ("ngModelChange",function(t){return e.requiredChartType=t}),c._UZ(43,"option",17),c.TgZ(44,"option",24),c._uU(45,"Bar Chart"),c.qZA(),c.TgZ(46,"option",25),c._uU(47,"Pie Chart"),c.qZA(),c.TgZ(48,"option",26),c._uU(49,"Map"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(50,"div",27),c.TgZ(51,"button",28),c.NdJ("click",function(){return e.loadData()}),c._uU(52,"Apply Filter"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(53,"div",29),c.YNc(54,Gt,3,0,"div",30),c.YNc(55,Ht,2,1,"div",30),c.YNc(56,Qt,2,1,"div",30),c.YNc(57,Vt,2,0,"div",30),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(58,Xt,45,5,"ng-template",null,31,c.W1O),c.YNc(60,ee,13,3,"ng-template",null,32,c.W1O),c.YNc(62,ne,12,1,"ng-template",null,33,c.W1O)}if(2&t){let t,i,n,o;c.xp6(20),c.Q6J("ngModel",e.requiredSearchType),c.xp6(9),c.Q6J("ngIf",(null==(t=c.lcZ(30,12,e.selectedLocations.country))?null:t.length)>0),c.xp6(2),c.Q6J("ngIf",(null==(i=c.lcZ(32,14,e.selectedLocations.region))?null:i.length)>0),c.xp6(2),c.Q6J("ngIf",(null==(n=c.lcZ(34,16,e.selectedLocations.state))?null:n.length)>0),c.xp6(2),c.Q6J("ngIf",(null==(o=c.lcZ(36,18,e.selectedLocations.lga))?null:o.length)>0),c.xp6(2),c.Q6J("ngIf","metadata"==e.requiredSearchType),c.xp6(1),c.Q6J("ngIf","incident"==e.requiredSearchType),c.xp6(4),c.Q6J("ngModel",e.requiredChartType),c.xp6(12),c.Q6J("ngIf",e.requestingData),c.xp6(1),c.Q6J("ngIf","bar-chart"==e.requiredChartType&&!e.requestingData),c.xp6(1),c.Q6J("ngIf","pie-chart"==e.requiredChartType&&!e.requestingData),c.xp6(1),c.Q6J("ngIf","map"==e.requiredChartType&&!e.requestingData)}},directives:[j.v,o.EJ,o.JJ,o.On,o.YN,o.Kr,n.O5,n.sg,et,it,xt,o.Fj,o.Wl],pipes:[n.Nd],styles:[".wrapper[_ngcontent-%COMP%]{width:91vw;padding-left:0}"]}),t})()},{path:"timeline",component:(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-incidence-map"]],decls:13,vars:0,consts:[[1,"wrapper","d-flex","flex-column","flex-row-fluid"],[1,"card","rounded-0","bgi-no-repeat","bgi-position-x-end","bgi-size-cover",2,"background-color","#4b5320","background-size","auto 100%"],[1,"card-body","container","pt-10","pb-8"],[1,"d-flex","align-items-center"],[1,"fw-bold","me-3","text-white"],[1,"fw-bold","text-white","opacity-50"],[1,"d-flex","flex-column"],[1,"d-lg-flex","align-lg-items-center"],["id","kt_content",1,"content","d-flex","flex-column","flex-column-fluid"],["id","kt_content_container",1,"container"]],template:function(t,e){1&t&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"div",3),c.TgZ(4,"h1",4),c._uU(5,"Incidence Timeline"),c.qZA(),c._UZ(6,"span",5),c.qZA(),c.TgZ(7,"div",6),c.TgZ(8,"div",7),c._UZ(9,"app-global-search"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(10,"div",8),c.TgZ(11,"div",9),c._UZ(12,"app-incidence-timeline"),c.qZA(),c.qZA())},directives:[j.v,xt],styles:[".wrapper[_ngcontent-%COMP%]{width:91vw;padding-left:0}.modal-backdrop[_ngcontent-%COMP%]{background-color:#4b5320}.w-50[_ngcontent-%COMP%]{width:50%!important}.left-border[_ngcontent-%COMP%]{min-height:100vh;border-left:1px solid #4b5320;border-radius:25px 0}.right-border[_ngcontent-%COMP%]{min-height:100vh;border-right:1px solid #4b5320;border-radius:0 25px}#edit-container[_ngcontent-%COMP%]{background:#fff;border-radius:8px;min-height:100vh}.wrap-text[_ngcontent-%COMP%]{max-height:60px;overflow:hidden;text-overflow:ellipsis}"]}),t})()}]}];let ae=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[s.Bz.forChild(oe)],s.Bz]}),t})();var re=i(66);let se=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[n.ez,ae,a.m,r.T,tt.Ns.forRoot({echarts:()=>i.e(175).then(i.bind(i,8175))}),w.I,o.u5,re.$,at.UO,lt]]}),t})()},2617:(t,e,i)=>{"use strict";i.d(e,{v:()=>p});var n=i(9609),o=i(5366),a=i(7320),r=i(5943),s=i(9151),l=i(1462),c=i(1116),d=i(9347);function h(t,e){if(1&t&&(o.TgZ(0,"option",28),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.s9C("value",t.id),o.xp6(1),o.Oqu(t.text)}}let p=(()=>{class t{constructor(t,e,i){this.serverRequest=t,this.storage=e,this.events=i,this.searchParams={type:"",keyword:"",incidentType:"",location:"",dateRange:{startDate:"",endDate:""}},this.ranges={Today:[n(),n()],Yesterday:[n().subtract(1,"days"),n().subtract(1,"days")],"Last 7 Days":[n().subtract(6,"days"),n()],"Last 30 Days":[n().subtract(29,"days"),n()],"This Month":[n().startOf("month"),n().endOf("month")],"Last Month":[n().subtract(1,"month").startOf("month"),n().subtract(1,"month").endOf("month")]},this.incidentTypeList=[],this.loadIncidentTypes()}ngOnInit(){}loadIncidentTypes(){this.serverRequest.get("incidents/incident-type/view-incident-types?resourceId=1").subscribe(t=>{this.incidentTypeList=[],t.contentData.forEach(t=>{this.incidentTypeList.push({id:t.IncidentTypeId,text:t.IncidentTypeName})})})}broadcastSearchRequest(){this.searchParams.type="basic",this.events.broadcast("perform-global-search",this.searchParams)}changed(t){void 0!==this.searchParams.dateRange&&null!==this.searchParams.dateRange.endDate&&this.broadcastSearchRequest()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(a.I),o.Y36(r.V),o.Y36(s.n))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-global-search"]],decls:37,vars:10,consts:[[1,"rounded","d-flex","flex-column","flex-lg-row","align-items-lg-center","bg-white","p-5","w-xxl-850px","h-lg-60px","my-5"],[1,"row","flex-grow-1","mb-5","mb-lg-0"],[1,"col-lg-4","d-flex","align-items-center","mb-3","mb-lg-0"],[1,"svg-icon","svg-icon-1","svg-icon-gray-400","me-1"],["xmlns","http://www.w3.org/2000/svg",0,"xmlns","xlink","http://www.w3.org/1999/xlink","width","24px","height","24px","viewBox","0 0 24 24","version","1.1"],["stroke","none","stroke-width","1","fill","none","fill-rule","evenodd"],["x","0","y","0","width","24","height","24"],["d","M14.2928932,16.7071068 C13.9023689,16.3165825 13.9023689,15.6834175 14.2928932,15.2928932 C14.6834175,14.9023689 15.3165825,14.9023689 15.7071068,15.2928932 L19.7071068,19.2928932 C20.0976311,19.6834175 20.0976311,20.3165825 19.7071068,20.7071068 C19.3165825,21.0976311 18.6834175,21.0976311 18.2928932,20.7071068 L14.2928932,16.7071068 Z","fill","#000000","fill-rule","nonzero","opacity","0.3"],["d","M11,16 C13.7614237,16 16,13.7614237 16,11 C16,8.23857625 13.7614237,6 11,6 C8.23857625,6 6,8.23857625 6,11 C6,13.7614237 8.23857625,16 11,16 Z M11,18 C7.13400675,18 4,14.8659932 4,11 C4,7.13400675 7.13400675,4 11,4 C14.8659932,4 18,7.13400675 18,11 C18,14.8659932 14.8659932,18 11,18 Z","fill","#000000","fill-rule","nonzero"],["type","text","name","search","value","","placeholder","Keyword",1,"form-control","form-control-flush","flex-grow-1",3,"ngModel","ngModelChange"],[1,"col-lg-4","d-flex","align-items-center","mb-5","mb-lg-0"],[1,"bullet","bg-secondary","d-none","d-lg-block","h-30px","w-2px","me-5"],["x","5","y","5","width","5","height","5","rx","1","fill","#000000"],["x","14","y","5","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],["x","5","y","14","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],["x","14","y","14","width","5","height","5","rx","1","fill","#000000","opacity","0.3"],[1,"form-select","border-0","flex-grow-1",3,"ngModel","ngModelChange"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-lg-4","d-flex","align-items-center"],[1,"svg-icon","svg-icon-1","svg-icon-gray-400","me-3"],["d","M5,10.5 C5,6 8,3 12.5,3 C17,3 20,6.75 20,10.5 C20,12.8325623 17.8236613,16.03566 13.470984,20.1092932 C12.9154018,20.6292577 12.0585054,20.6508331 11.4774555,20.1594925 C7.15915182,16.5078313 5,13.2880005 5,10.5 Z M12.5,12 C13.8807119,12 15,10.8807119 15,9.5 C15,8.11928813 13.8807119,7 12.5,7 C11.1192881,7 10,8.11928813 10,9.5 C10,10.8807119 11.1192881,12 12.5,12 Z","fill","#000000","fill-rule","nonzero"],["type","text","name","search","value","","placeholder","Location",1,"form-control","form-control-flush","flex-grow-1",3,"ngModel","ngModelChange"],[1,"min-w-150px","text-end"],["type","submit","id","kt_advanced_search_button_1",1,"btn","btn-dark",3,"click"],[1,"row","text-center","align-items-center"],[1,"col-lg-12"],["type","text","ngxDaterangepickerMd","","name","dateRange","value","","placeholder","click here to select date range to filter data",1,"form-control","datePickerStyle",3,"ngModel","showCustomRangeLabel","alwaysShowCalendars","ranges","linkedCalendars","showClearButton","ngModelChange","change"],[3,"value"]],template:function(t,e){1&t&&(o.TgZ(0,"div",0),o.TgZ(1,"div",1),o.TgZ(2,"div",2),o.TgZ(3,"span",3),o.O4$(),o.TgZ(4,"svg",4),o.TgZ(5,"g",5),o._UZ(6,"rect",6),o._UZ(7,"path",7),o._UZ(8,"path",8),o.qZA(),o.qZA(),o.qZA(),o.kcU(),o.TgZ(9,"input",9),o.NdJ("ngModelChange",function(t){return e.searchParams.keyword=t}),o.qZA(),o.qZA(),o.TgZ(10,"div",10),o._UZ(11,"div",11),o.TgZ(12,"span",3),o.O4$(),o.TgZ(13,"svg",4),o.TgZ(14,"g",5),o._UZ(15,"rect",12),o._UZ(16,"rect",13),o._UZ(17,"rect",14),o._UZ(18,"rect",15),o.qZA(),o.qZA(),o.qZA(),o.kcU(),o.TgZ(19,"select",16),o.NdJ("ngModelChange",function(t){return e.searchParams.incidentType=t}),o.TgZ(20,"option",17),o._uU(21,"Select Incident Type"),o.qZA(),o.YNc(22,h,2,2,"option",18),o.qZA(),o.qZA(),o.TgZ(23,"div",19),o._UZ(24,"div",11),o.TgZ(25,"span",20),o.O4$(),o.TgZ(26,"svg",4),o.TgZ(27,"g",5),o._UZ(28,"rect",6),o._UZ(29,"path",21),o.qZA(),o.qZA(),o.qZA(),o.kcU(),o.TgZ(30,"input",22),o.NdJ("ngModelChange",function(t){return e.searchParams.location=t}),o.qZA(),o.qZA(),o.qZA(),o.TgZ(31,"div",23),o.TgZ(32,"button",24),o.NdJ("click",function(){return e.broadcastSearchRequest()}),o._uU(33,"Search"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(34,"div",25),o.TgZ(35,"div",26),o.TgZ(36,"input",27),o.NdJ("ngModelChange",function(t){return e.searchParams.dateRange=t})("change",function(t){return e.changed(t)}),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(9),o.Q6J("ngModel",e.searchParams.keyword),o.xp6(10),o.Q6J("ngModel",e.searchParams.incidentType),o.xp6(3),o.Q6J("ngForOf",e.incidentTypeList),o.xp6(8),o.Q6J("ngModel",e.searchParams.location),o.xp6(6),o.Q6J("ngModel",e.searchParams.dateRange)("showCustomRangeLabel",!0)("alwaysShowCalendars",!0)("ranges",e.ranges)("linkedCalendars",!0)("showClearButton",!0))},directives:[l.Fj,l.JJ,l.On,l.EJ,l.YN,l.Kr,c.sg,d.SP],styles:[".datePickerStyle[_ngcontent-%COMP%]{text-align:center;border:0;border-bottom:1px solid #fff;background-color:initial;color:#fff}"]}),t})()},9151:(t,e,i)=>{"use strict";i.d(e,{n:()=>a});var n=i(8512),o=i(5366);let a=(()=>{class t{constructor(){this.behaviorSubjects=new Map}getBehaviorSubject(t){let e=this.behaviorSubjects.get(t);return e||(e=new n.X(null),this.behaviorSubjects.set(t,e)),e}broadcast(t,e){this.getBehaviorSubject(t).next(e)}getEvent(t){return this.getBehaviorSubject(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);